! -*- f90 -*-
      SUBROUTINE dSITCR (TIDEP, TIDEV, USITEP, USITEV, XLOADP, XLOADV,  &
     &                   EPBASE, SITEP, SITEV, POLTDP, POLTDV,          &
     &                   OPTLOADP, OPTLOADV)
      IMPLICIT None
!
! 1.    SITCR
!
! 1.1   SITCR PROGRAM SPECIFICATION
!
! 1.1.1 SITCR computes the instantaneous J2000.0 geocentric site position and
!       velocity vectors by adding in the effects of Earth tides, the pole tide,
!       ocean loading and ocean ploe tide loading. The J2000.0 geocentric 
!       baseline position and velocity vectors are similiarly corrected.
!       --- difx version ---
!
! 1.2   SITCR PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!
!          INPUT VARIABLES:
!            1. TIDEP(3,2)   -  THE CORRECTIONS TO THE 2000.0 GEOCENTRIC SITE
!                               POSITION VECTORS DUE TO EARTH TIDAL EFFECTS. (M)
!            2. TIDEV(3,2)   -  THE CORRECTIONS TO THE 2000.0 GEOCENTRIC SITE
!                               VELOCITY VECTORS DUE TO EARTH TIDAL EFFECTS.
!                               (M/SEC)
!            3. USITEP(3,2)  -  THE 2000.0 GEOCENTRIC SITE POSITION VECTORS
!                               UNCORRECTED FOR EARTH TIDAL AND OCEAN LOADING
!                               EFFECTS. (M)
!            4. USITEV(3,2)  -  THE 2000.0 GEOCENTRIC SITE VELOCITY VECTORS
!                               UNCORRECTED FOR EARTH TIDAL AND OCEAN LOADING
!                               EFFECTS. (M/SEC)
!            5. XLOADP(3,2)  -  THE CORRECTIONS TO THE 2000.0 GEOCENTRIC SITE
!                               POSITION VECTORS DUE TO OCEAN LOADING EFFECTS.
!                               (M)
!            6. XLOADV(3,2)  -  THE CORRECTIONS TO THE 2000.0 GEOCENTRIC SITE
!                               VELOCITY VECTORS DUE TO OCEAN LOADING EFFECTS.
!                              (M/SEC)
!            7. POLTDP(3,2)  -  GEOCENTRIC 2000.0 SITE POSITION CORRECTION FOR
!                               THE EFFECTS OF THE POLE TIDE. (METERS)
!            8. POLTDV(3,2)  -  GEOCENTRIC 2000.0 SITE VELOCITY CORRECTION FOR
!                               THE EFFECTS OF THE POLE TIDE. (M/SEC)
!
!           OUTPUT VARIABLES:
!            1. EPBASE(3,2)  -  THE 2000.0 GEOCENTRIC BASELINE POSITION AND
!                               VELOCITY VECTORS CORRECTED FOR EARTH TIDAL
!                               EFFECTS.(M, M/SEC)
!            2. SITEP(3,2)   -  THE 2000.0 GEOCENTRIC SITE POSITION VECTORS
!                               CORRECTED FOR EARTH TIDAL EFFECTS. (M)
!            3. SITEV(3,2)   -  THE 2000.0 GEOCENTRIC SITE VELOCITY VECTORS
!                               CORRECTED FOR EARTH TIDAL EFFECTS. (M/SEC)
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KSTEC  -  THE SITCR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2. KSTED  -  THE SITCR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
       INCLUDE 'cuser11.i'
!       Variables from:
!            1. Calc_user   - Calc user type. 'A' for Calc/SOLVE analysis.
!                             'C' for VLBI correlator.
!            2. Apply_ocean - Switch to apply ocean loading to theoreticals
!                             for correlator usage. 'Y' to apply (recommended),
!                             'N' for do not apply.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
      Real*8 CSITEP(3,2), CSITEV(3,2), EPBASE(3,2), SITEP(3,2),         &
     &       SITEV(3,2), TIDEP(3,2), TIDEV(3,2), USITEP(3,2),           &
     &       USITEV(3,2), XLOADP(3,2), XLOADV(3,2), POLTDP(3,2),        &
     &       POLTDV(3,2), TX(3,2), TV(3,2), OPTLOADP(3,2),              &
     &       OPTLOADV(3,2), XOP(3,2), XOV(3,2)
      Integer*4 L
!
! 1.2.5 EXTERNAL INPUT/OUTPUT -  POSSIBLE DEBUG OUTPUT
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: VECAD, VECSB
!
! 1.2.7 CONSTANTS USED - NONE
!
! 1.2.8 PROGRAM VARIABLES -
!             1. CSITEP(3,2) - THE INSTANTANEOUS CORRECTIONS TO THE J2000.0
!                              SITE POSITION VECTORS DUE TO EARTH TIDE, POLE
!                              TIDE AND OCEAN LOADING EFFECTS. (M)
!             2. CSITEV(3,2) - THE INSTANTANEOUS CORRECTIONS TO THE J2000.0
!                              SITE VELOCITY VECTORS DUE TO EARTH TIDE, POLE
!                              TIDE AND OCEAN LOADING EFFECTS. (M/SEC)
!             3. TX(3,2)     - TEMPORARY STORAGE VECTOR FOR THE SUM OF THE
!                              EARTH TIDE AND THE OCEAN LOADING SITE POSITION
!                              CORRECTIONS. (M)
!             4. TV(3,2)     - TEMPORARY STORAGE VECTOR FOR THE SUM OF THE
!                              EARTH TIDE AND THE OCEAN LOADING SITE VELOCITY
!                              CORRECTIONS. (M)
!
! 1.2.9 PROGRAMMER - DALE MARKHAM   01/17/77
!                    PETER DENATALE 07/18/77
!                    DAVID GORDON   07/12/84
!                    SAVITA GOEL    06/04/87 (CDS FOR A900)
!                    Jim Ryan 89.07.27 Documetation simplified.
!                    David Gordon 94.04.18 Converted to Implicit None.
!                    David Gordon Jan. 2013. Added ocean pole tide loading.
!                                 Added decision wheter to apply ocean and
!                                 ocean pole tide corrections (formerly in
!                                 OCEG).
!
!     SITCR Program Structure
!
!  Add together ocean loading and ocean pole tide loading.
        DO L = 1,2
         CALL VECAD ( XLOADP(1,L), OPTLOADP(1,L), XOP(1,L)     )
         CALL VECAD ( XLOADV(1,L), OPTLOADV(1,L), XOV(1,L)     )
        ENDDO
!
!   Compute the Earth tide, ocean loading, and pole tide
!   corrections to the J2000.0 geocentric site vectors.
      DO 100 L = 1,2
!       Add tide and ocean/ocean pole tide, then add pole tide. 
!         Positions then velocities.
        CALL VECAD ( TIDEP(1,L), XOP(1,L),    TX(1,L)     )
        CALL VECAD ( TX(1,L)   , POLTDP(1,L), CSITEP(1,L) )
!
        CALL VECAD ( TIDEV(1,L), XOV(1,L),    TV(1,L)     )
        CALL VECAD ( TV(1,L)   , POLTDV(1,L), CSITEV(1,L) )
  100 CONTINUE
!
!   Compute the corrected J2000.0 geocentric site vectors.
      DO 200  L = 1,2
        CALL VECAD ( USITEP(1,L), CSITEP(1,L), SITEP(1,L) )
        CALL VECAD ( USITEV(1,L), CSITEV(1,L), SITEV(1,L) )
  200 CONTINUE
!
!   Compute the corrected J2000.0 geocentric baseline vectors.
      CALL VECSB ( SITEP(1,1), SITEP(1,2), EPBASE(1,1) )
      CALL VECSB ( SITEV(1,1), SITEV(1,2), EPBASE(1,2) )
!
!   Check KSTED for debug output.
      IF ( KSTED .EQ. 0 )  GO TO 500
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility SITCR." )
      WRITE ( 6, 9200 )  CSITEP, CSITEV, EPBASE, SITEP, SITEV,          &
     &                   TIDEP, TIDEV, USITEP, USITEV, XLOADP, XLOADV,  &
     &           POLTDP, POLTDV, OPTLOADP, OPTLOADV, XOP, XOV, TX, TV
 9200 FORMAT (1X, "CSITEP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CSITEV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPBASE = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "SITEP  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "SITEV  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "TIDEP  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "TIDEV  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "USITEP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "USITEV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "XLOADP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "XLOADV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "POLTDP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "POLTDV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &          "OPTLOADP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &          "OPTLOADV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "XOP    = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "XOV    = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "TX     = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "TV     = ", 2 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  500 RETURN
      END
      SUBROUTINE DRIVR(Iscan,J2m)
      IMPLICIT None
!
! 1.    DRIVR
!
! 1.1   DRIVR PROGRAM SPECIFICATION
!
! 1.1.1 DRIVR is the main calculation subroutine. It calculates the theoretical
!       delays and delay rates, the contributions of each model module to the
!       delays and delay rates, the partials of the delays and delay rates with
!       respect to model module parameters, and the coordinate time at site #1.
!
! 1.1.2 RESTRICTIONS - NONE
!
! 1.1.3 REFERENCES - PEP MANUAL, GREENBOOK, D. ROBERTSON'S THESIS,
!                    P. McCLURES X-DOCUMENT.
!
! 1.2   DRIVR PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE - CALL DRIVR
!       INPUT VARIABLES  -NONE
!       OUTPUT VARIABLES - NONE
!
! 1.2.2 COMMON BLOCKS USED 
!
      INCLUDE 'd_input.i'
!       Variables from:
!        1. NumEpochs  - Number of epochs for this calc run. Each will
!                        be d_interval seconds apart.
!        2. d_interval - Interval between Calc epochs (seconds). 
!                        Nominally Calc is run every 24 seconds for the
!                        difx correlator, and then a fifth degree 
!                        polynomial is fit to the delays for each 
!                        minute interval to obtain the correlator
!                        model. 
!        3. Base_mode  - If 'geocenter ' mode, first station is always
!                        the geocenter. If 'baseline  ' mode, will do
!                        all baselines (site2->site3, ..., site2->siten,
!                        site3->site4, ..., siten-1->siten). 
!                        If limited baseline mode, will do site2->site3,
!                        site2->site4, ..., site2->siten only.
!        4. Near_Far   - Character*10 variable specifying whether to 
!                        use the 'Far-field ' or the 'Near-field model.
!
      INCLUDE 'get2s.i'
!       Variables from:
!         1. LNBASE(4,2) - THE EIGHT CHARACTER SITE NAMES OF THE BASELINE
!                          OF THE CURRENT OBSERVATION. (ALPHAMERIC)
!
      INCLUDE 'put2s.i'
!       Variables from:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
       INCLUDE 'cmxut11.i'
!            Variables 'to':
!              1. Xintv(2)    - First and last Julian Date of data in the
!                               current data base.
!              2. Intrvl(5,2) - First and last time tag of data in the current
!                               data base. (First index: year, month, day,
!                               hour, minute. Second index: first, last.)
!
      INCLUDE 'cmxst11.i'
!            Variables 'to':
!              1. NUMSIT - The total number of sites in the data base.
!
       INCLUDE 'cuser11.i'
!       Variables from:
!            1. Calc_user   - Calc user type. 'A' for Calc/SOLVE analysis.
!                             'C' for VLBI correlator.
!            2. Apply_ocean - Switch to apply ocean loading to theoreticals
!                             for correlator usage. 'Y' to apply (recommended),
!                             'N' for do not apply.
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           Variables 'from' :
!             1. CONVD -
!
       INCLUDE 'c2poly.i'
!
!
! 1.2.3 PROGRAM SPECIFICATIONS -
      Character*50 Buf1, Buf2
      REAL*8 EPSMD, CENT, JDY2K
      Real*8 AXOFF(2), CFBASE(3), CFLAT(3,2), CFLON(3,2),               &
     &       CFSITE(3,2), CFSITN(3,2), DIONC(2),                        &
     &       EARTH(3,3), EPBASE(3,2), SUN(3,2),                         &
     &       EPLATP(3,2), EPLATV(3,2), EPLONP(3,2), EPLONV(3,2),        &
     &       EPS(2), EPSITN(3,2), OCEAMP(11,3,2),                       &
     &       OCEPHS(11,3,2), SITEA(3,2),SITEP(3,2),                     &
     &       SITEV(3,2), SITLAT(2), SITLON(2), SITRAD(2), STAR(3),      &
     &       SUNCU(3), TCTOCF(3,3,2), DATMC(2,2), ZPATH(2),             &
     &       TIDEP(3,2), TIDEV(3,2), USITEP(3,2), USITEV(3,2),          &
     &       XLOADP(3,2), XLOADV(3,2), XMOON(3,2), STARdt(3),           &
     &       POLTDP(3,2), POLTDV(3,2), SITEP1(3,2), SITEV1(3,2),        &
     &       SITHEIGHT(2), RTTOCF(3,3,2), GEOLAT(2), STAR12dt(3,2),     &
     &       AXTILT(2,2), ROTAXIS(3,3,2), OPTLcoef(6,2), STAR12(3,2),   &
     &       WOBXds, WOBYds, OPTLOADP(3,2), OPTLOADV(3,2)
      Real*8 R1(3), R2(3), R1dt(3), R2dt(3), R1mag, R2mag, R1magdt,     &
     &       R2magdt, T0_T1, STARff(3), RIGHT_ASC, DECLINATION,         &
     &       R1_TDB(3), R2_TDB(3), R1mag_TDB, R2mag_TDB, Site2_TDB(3)
      Real*8 AXIS2000(3,2), DAXIS2000(3,2), STAR_ABERRATED(3,2),        &
     &       dATMCdh(2,2), STAR_ABERRATEDdt(3,2)
      Real*8 UTC, XJD, AT, DUTCAT, CT, DATDCT, DLPGR, DUT1AT, UT1,      &
     &       EPSMNR, DIURNV, WOBXR, WOBYR, CD, CRA, SD, SRA,            &
     &       NUTDIF(2,2), SJD, TJD, OBSDIF
      Real*8 WOBXD,WOBYD,THETA,RPOM(3,3),RBPN(3,3),RT2C(3,3),           &
     &       RBPNC(3,3),RT2CC(3,3)
      Real*8 DAS2R, APC2R, RPNKK(3,3,2), DR1(3,3), DR2(3,3)
      Real*8 RPN2K(3,3,2),X,Y,   ERA2K,DERA2K,RS2K(3,3,3),              &
     &       SP,DSP,RW2K(3,3,2),R2K(3,3,3), RPC2K(3,3,2), FA2K(14),     &
     &       FAD2K(14), GAST2K(2), RSC2K(3,3,3), RNC2K(3,3,2),          &
     &       RC2K (3,3,3),                                GMST2K(2),    &
     &       RFR2K(3,3), pERA2K, DNUpe(2,2), Xn(2), Yn(2), Sn(2)
      Real*8 RPN2K6(3,3,2), X06(2), Y06(2), S06(2), RS2K6(3,3,3),       &
     &       R2K6(3,3,3), R2K6m1(3,3,3), R2K6p1(3,3,3)
      Real*8 Xti, Yti, UT1ti, dXti, dYti, dUT1ti, Xli, Yli,             &
     &                 dXli, dYli, UT1li, dUT1li, TAG_SEC
      Real*8 RS2Km1(3,3,3), RS2Kp1(3,3,3),                              &
     &       RPNm1(3,3,2), RWm1(3,3,2), RPNp1(3,3,2), RWp1(3,3,2)
      Real*8 tg2_tg1, dtg2_tg1, delta_t_grav, d_delta_t_grav,           &
     &       delta_t_grav_Sun, d_delta_t_grav_Sun
      Real*8 Xscale, Dt, Rt, DOTP
!     Real*8 UT1td
!     Real*8 R2Kdif(3,3)
      Real*8 TDBminusTT
      Real*8 TT,TDBmTT,TDB,TDBg,Elong,Udist,Vdist
      Real*8 delay6(6), poly6(6)
      Real*8 Ph_Dec, Ph_RA, CD1, SD1, CRA1, SRA1
      Real*8 tr2_tr1, dtr2_tr1, td2_td1, dtd2_td1
      Real*8 C2000STR(3)
      Real*8 K_EWNS(3,4), K_EWNS_ab(3,4), dKew, dKns, AZ_ab(4),         &
     &       EL_ab(4), gmfh(2), gmfw(2), Datmc_h_EWNS(4),               &
     &       Datmc_w_EWNS(4), STAR2(3,4), STAR2_ab(3,4), tg2_tg1ewns(4) 
!
      Character*8 Baseline(2), Sourc8
      Character*20 Sourc20
      Equivalence (LNBASE(1,1), Baseline(1))
!
      Integer*4 TSKIP, I, J, ierc2, c_out2, c_out, c2_out, get4unit,    &
     &          LC, ios, IDEC, IRA, I_ph, I_mid, Iscan, J2m, IS1, IS2
      Integer*4 IYY, IM, ID, JTAG(5), K, L, I11, I12, I21, I22, K1, K2 
      Integer*4 Itime, Istation1, Istation2, Isource, Isrc, IndexB
      Integer*2 KAXIS(2)
!
      DATA SJD /-999.D6/
!
! 1.2.3.1   SAVE BLOCK -
       SAVE SITEA, SITEP,                                              &
     &      SITEV, SITLAT, STAR, SUNCU, TCTOCF, TIDEP, SITRAD,         &
     &      TIDEV, XLOADP, XLOADV, ZPATH, EPS,                         &
     &      POLTDP, POLTDV, SUN, AXOFF, CFBASE, DIURNV, DLPGR, EPBASE, &
     &      CFSITE, CFSITN, CFLON, CFLAT, SITLON, OCEAMP, OCEPHS,      &
     &                       KAXIS, EARTH, EPSMNR, STAR_ABERRATED,     &
     &      EPSMD,        XMOON, SITHEIGHT, FA2K, FAD2K,               &
     &      NUTDIF, XJD, CT, SJD, TJD, OBSDIF, CENT, UT1, DUT1AT,      &
     &      RTTOCF, GEOLAT, WOBXR, WOBYR, UTC, AT, DUTCAT, DATDCT,     &
     &      RPN2K, Xn, Yn, Sn, ERA2K, RS2K, SP, RW2K, R2K,             &
     &      WOBXD, WOBYD, DERA2K, RPC2K, GAST2K, RSC2K,                &
     &      RNC2K, RC2K, RFR2K,                 GMST2K, pERA2K,        &
     &      AXTILT, ROTAXIS, DNUpe, Xti, Yti, UT1ti, dXti, dYti,       &
     &      dUT1ti, TT, RPN2K6, X06, Y06, S06, R2K6, TDB, TDBg,        &
     &      Xli, Yli, dXli, dYli, UT1li, dUT1li, OPTLcoef, WOBXds,     &
     &      WOBYds, OPTLOADP, OPTLOADV, STARdt, STAR12, STAR12dt,      &
     &      STAR_ABERRATEDdt, RS2Km1, RS2Kp1, R2K6m1, R2K6p1, STARff,  &
     &      Sourc20, Sourc8
!
! 1.2.4 DATA BASE ACCESS - NONE
!
! 1.2.5 EXTERNAL INPUT/OUTPUT - NONE
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: MAIN
!             CALLED SUBROUTINES: INITL, OBSNT, START, TOCUP, WRIDR,
!                                 ATIME, ATMG, AXOG, CTIMG, RMPAR,
!                                 DIURNL, ETDG, M2000, NUTG, OCEG,
!                                 PEP, PREG, PTDG, RELG, ROSIT, SITG,
!                                 SITCOR, STRCOR, STRG, SUNCOR, UT1G,
!                                 UTCTME, WOBG, PLXG, ATMP, AXOP, ETDP,
!                                 NUTP, OCEP, PREP, RELP, SITP, STRP,
!                                 UT1P, WOBP, PLXP, PTDP, ATMC, AXOC,
!                                 ETDC, OCEC, PTDC, RELC, CSTAR, WOBC
!
! 1.2.7 CONSTANTS USED - NONE
!
! 1.2.8 PROGRAM VARIABLES -
!             1. AXOFF(2)      - THE ANTENNA AXIS OFFSETS AT EACH OBSERVATION
!                                SITE.  (M)
!             2. CFBASE(3)     - THE GEOCENTRIC CRUST FIXED BASELINE VECTOR. (M)
!             3. DATMC(2,2)    - THE CONTRIBUTIONS TO THE DELAY AND DELAY
!                                RATE DUE TO TROPOSPHERIC REFRACTION AT EACH
!                                OBSERVATION SITE. (SEC, SEC/SEC)
!             4. DAXOC(2,2)    - THE CONTRIBUTIONS TO THE DELAY AND DELAY
!                                RATE DUE TO THE ANTENNA AXIS OFFSETS AT EACH
!                                OBSERVATION SITE. (SEC, SEC/SEC)
!             7. DIONC(2)      - THE CONTRIBUTIONS TO THE DELAY AND DELAY
!                                RATE DUE TO IONOSPHERE EFFECTS. (SEC, SEC/SEC)
!                                Dummy variables!
!             8. DIURNV        - THE DIURNAL ANGULAR VELOCITY OF THE EARTH.
!                                (RAD/SEC)
!                                --- No longer computed !!!!
!             9. DLPGR         - THE CT TIME DERIVATIVE OF THE LONG PERIOD
!                                TERMS IN THE 'AT MINUS CT' OFFSET. (SEC/SEC)
!            10. EARTH(3,3)    - THE SOLAR SYSTEM BARYCENTRIC EARTH POSITION,
!                                VELOCITY, AND ACCELERATION VECTORS.
!                                (M, M/SEC, M/SEC**2)
!            11. EPBASE(3,2)   - THE J2000.0 GEOCENTRIC BASELINE POSITION AND
!                                VELOCITY VECTORS. (M, M/SEC)
!            12. EPS(2)        - THE TRUE OBLIQUITY OF THE ECLIPTIC AND ITS CT
!                                TIME DERIVATIVE. (RAD, RAD/SEC)
!            13. EPSMNR        - MEAN OBLIQUITY AT EPOCH J2000.0. (RAD)
!            14. EPSMD         - Mean obliquity of date (radians)
!            15. FA2K(14)      - The Fundamental arguments (5 Luni-solar,
!                                8 planetary, accumulated precession)
!                                (Radians)
!            16. FAD2K(14)     - Time derivative of the fundamental arguments
!                                (Radians/second)
!            17. CENT          - Number of Julian centuries elapsed since the
!                                epoch January 1.5, 2000. (centuries)
!            18. KEND          - THE 'END OF DATA' FLAG. KEND = 0 IF THERE IS
!                                MORE DATA TO BE PROCESSED. KEND = 1 IF THE END
!                                OF THE DATA HAS BEEN REACHED.
!            19. KOUNT         - THE FLAG WHICH INITIALIZES THE COUNTING OF THE
!                                OBSERVATION ITEMS.
!            20. PANGL(2)      - THE PARALLACTIC ANGLE DUE TO FEED BOX ROTATION
!                                AT EACH OBSERVATION SITE. (RAD)
!            21. POLTDP(3,2)   - GEOCENTRIC J2000.0 SITE POSITION CORRECTION FOR
!                                THE EFFECTS OF THE POLE TIDE. (M)
!            22. POLTDV(3,2)   - GEOCENTRIC J2000.0 SITE VELOCITY CORRECTION FOR
!                                THE EFFECTS OF THE POLE TIDE. (M/SEC)
!            23. RPC2K(3,3,2)  - THE PRECESSION PORTION OF THE COMPLETE CRUST
!                                FIXED TO J2000.0 ROTATION MATRIX AND ITS CT
!                                TIME DERIVATIVE, consistent with the IERS
!                                Conventions (2003). (UNITLESS, 1/SEC)
!            24. RS2K(3,3,3)   - THE DIURNAL SPIN PORTION OF THE COMPLETE CRUST
!                                FIXED TO J2000.0 ROTATION MATRIX AND ITS FIRST
!                                TWO CT TIME DERIVATIVES, consistent with the
!                                IERS Conventions (2003) - CEO based version.
!                                (UNITLESS, 1/SEC, 1/SEC**2)
!            25. RSC2K(3,3,3)  - THE DIURNAL SPIN PORTION OF THE COMPLETE CRUST
!                                FIXED TO J2000.0 ROTATION MATRIX AND ITS FIRST
!                                TWO CT TIME DERIVATIVES, consistent with the
!                                IERS Conventions (2003) - Classical version.
!                                (UNITLESS, 1/SEC, 1/SEC**2)
!            26. RW2K(3,3,2)   - THE WOBBLE PORTION OF THE COMPLETE CRUST FIXED
!                                TO J2000.0 ROTATION MATRIX and its time
!                                derivative, consistent with the IERS
!                                Conventions (2003). (unitless, 1/sec)
!            27. SITEA(3,2)    - THE J2000.0 GEOCENTRIC ACCELERATION VECTORS OF
!                                EACH OBSERVATION SITE. (M/SEC**2)
!            28. SITEP(3,2)    - THE J2000.0 GEOCENTRIC POSITION VECTORS OF EACH
!                                OBSERVATION SITE. (M)
!            29. SITEV(3,2)    - THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF EACH
!                                OBSERVATION SITE. (M/SEC)
!            30. SITLAT(2)     - THE SITE GEODETIC LATITUDES. (RAD)
!            31. SITLON(2)     - The site East longitudes. (rad)
!            32. SITHEIGHT(2)  - The site heights above the geoid. (m)
!            33. STAR(3)       - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!            33.5 STAR12(3,2)  - The J2000.0 source unit vectors from stations
!                                1 and 2. (unitless). For Far-field sources,
!                                these are the same as STAR(3). 
!            34. SUN(3,2)      - THE J2000.0 GEOCENTRIC SUN POSITION AND
!                                VELOCITY VECTORS. (M, M/SEC)
!            35. TCTOCF(3,3,2) - THE ROTATION MATRIX WHICH ROTATES THE
!                                TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST FIXED
!                                REFERENCE SYSTEM AT EACH OBSERVATION SITE.
!            36. TIDEP(3,2)    - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                                POSITION VECTORS DUE TO EARTH TIDE EFFECTS. (M)
!            37. TIDEV(3,2)    - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                                VELOCITY VECTORS DUE TO EARTH TIDES. (M/SEC)
!            38. WOBX          - THE LONG PERIOD WOBBLE X-OFFSET. (RAD)
!            39. WOBY          - THE LONG PERIOD WOBBLE Y-OFFSET. (RAD)
!                                (NOTE: WOBY IS LEFT HANDED.)
!            40. XLOADP(3,2)   - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                                POSITION VECTORS DUE TO OCEAN LOADING. (M)
!            41. XLOADV(3,2)   - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                                VELOCTY VECTORS DUE TO OCEAN LOADING. (M/SEC)
!            42. ZPATH(2)      - THE ZENITH ELECTRICAL PATH LENGTH AT EACH
!                                OBSERVATION SITE. (SEC)
!            43. STAR_ABERRATED(3,2) - THE J2000.0 SOURCE UNIT VECTOR AT EACH
!                                SITE CORRECTED FOR ABERRATION. (UNITLESS)
!            44. axis2000(3,2) - Vector axis offset of antenna in the J2000.0
!                                frame (effect on baseline). First index is
!                                X,Y,Z (meters), second runs over sites.
!            45. daxis2000(3,2) -Time derivative of axis2000, rate of change
!                                of vector axis offset of antenna in the
!                                J2000.0 frame (effect on baseline). First
!                                index is velocity, second runs over sites.
!            46. ELEV(2,2)     - The elevation angle of the source corrrected
!                                for aberration and its CT time derivative at
!                                each site (rad,rad/sec)
!            47. AZ(2,2)       - The azimuth angle of the source corrrected
!                                for aberration and its CT time derivative
!                                at each site (rad,rad/sec)
!****        48. DSTRP(2,2)    - Partial derivatives of the delay and delay
!****                            rate with respect to source RA and Dec. First
!****                            runs over RA and Dec, second runs over delay
!****                            and delay rate. (sec/rad, sec/sec-rad
!                                difference. (radians, radians/sec)
!            51. RTTOCF(3,3,2) - The rotation matrix which rotates the
!                                'radial-transverse' reference system to the
!                                crust fixed reference system at each site.
!            52. GEOLAT(2)     - The geocentric latitude at each site. (rad)
!            53. SJD           - Time of the previous observation.
!            54. XJD           - The Julian Date at zero hours UTC of the
!                                observation.
!            55. UTC           - UTC time fraction of the UTC day.
!            56. RPN2K(3,3,2)  - The Bias Precession Nutation portion of
!                                the complete Fixed to J2000.0 rotation
!                                matrix and its CT time derivative,
!                                consistent with the IERS Conventions
!                                (2003). (unitless, 1/sec)
!           56.5 RPN2K6(3,3,2) - The Bias Precession Nutation portion of
!                                the complete Fixed to J2000.0 rotation
!                                matrix and its CT time derivative,
!                                consistent with the IERS Conventions
!                                (2010). (unitless, 1/sec)
!            57. RNC2K(3,3,2)  - The IAU200A Nutation portion of
!                                the complete Fixed to J2000.0 rotation
!                                matrix and its CT time derivative,
!                                consistent with the IERS Conventions
!                                (2003). (unitless, 1/sec)
!            58. Xn(2)         - X-component of the CIP (Celestial
!                                Intermediate Pole) in the GCRS (Geocentric
!                                Celestial Reference System), and its time
!                                derivative. (Radians, Radians/sec)
!            59. Yn(2)         - Y-component of the CIP (Celestial
!                                Intermediate Pole) in the GCRS (Geocentric
!                                Celestial Reference System), and its time
!                                derivative. (Radians, Radians/sec)
!            60. Sn(2)         - Position of the CEO (Celestial Ephemeris
!                                Origin) on the equator of the CIP, and its
!                                time derivative. (Radians, Radians/sec)
!            61. ERA2K         - The Earth Rotation Angle, angle between
!                                the CEO Celestial Ephemeris Origin) and
!                                the TEO (Terrestrial Ephemeris Origin)
!                                on the equator of the the CIP at the
!                                observation epoch. (Radians)
!            62. DERA2K        - Time derivative of ERA2K (Radians/sec)
!            63. SP            - S-prime, position of the TEO (Terrestrial
!                                Ephemeris Origin) on the equator of the
!                                CIP. (Radians)
!            64. DSP           - Time derivative of SP. (Radians/sec)
!            65. R2K(3,3,3)    - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                                MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                                CEO-based version. (UNITLESS, 1/SEC, 1/SEC**2)
!           65.5 R2K6(3,3,3)   - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                                MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                                CEO-based version. (UNITLESS, 1/SEC, 1/SEC**2)
!                                Updated for IERS Conventions (2010).
!            66. RC2K(3,3,3)   - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                                MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                                Classical version. (UNITLESS, 1/SEC, 1/SEC**2)
!            67. RSC2K(3,3,3)  - THE DIURNAL SPIN PORTION OF THE COMPLETE CRUST
!                                FIXED TO J2000.0 ROTATION MATRIX AND ITS FIRST
!                                TWO CT TIME DERIVATIVES. (UNITLESS, 1/SEC,
!                                1/SEC**2)
!            68. GAST2K(2)     - THE GREENWICH APPARENT SIDEREAL TIME AND
!                                ITS CT TIME DERIVATIVE. (RAD, RAD/SEC)
!            69. AXTILT(2,2)   - Antenna fixed axis tilts (arc-seconds).
!                                First index runs over the two orthogonal
!                                tilt directions (Alt-Az: 1 => East,
!                                2 => North; (X-Y (N-S or E-W fixed) and
!                                Equatorial: 1 => Az error, 2 => Elev error).
!                                Second index runs over the two stations.
!            70. ROTAXIS(3,3,2)- Topocentric rotation matrices representing
!                                the fixed axis tilts for station 1 and
!                                station 2 of the current observation.
!            71. RFR2K(3,3)   -  The frame bias rotation matrix
!            72  OPTLcoef(6,2) - The 6 coefficients for computing the ocean 
!                                pole tide loading offsets at each site, and
!                                in the following order: Up-real, Up-imaginary,
!                                North-real, North-imaginary, East-real, and
!                                East-imaginary.
!            73. C2000STR(3)   - Aberrated/refracted source unit vector in the
!                                J2000.0 frame.
!                               
!
! 1.2.9 PROGRAMMER - David Gordon Jan. 2013
!        January 2015  D. Gordon  Difx version: updated for multi-phase
!                                 centers and multiple scans.             
!
! PROGRAM STRUCTURE
!
!  Perform the geometry and time calculations.
!     The basic coordinate system is referenced to the Epoch of 2000.0 and is a
!     right-handed Cartesian system oriented to the mean celestial pole and mean
!     equator of that epoch. The nominal origin is the solar system barycenter.
!     There is also an Earth fixed coordinate system which is a right-handed
!     Cartesian system oriented to the mean geographic pole of 1900-1906 and the
!     Greenwich Meridian. The nominal origin is the Earth's center of mass. The
!     basic unit of time is the coordinate second as used by the PEP Tape. UTC,
!     AT, AND UT1 are also used. The geometry of the observation is calculated
!     with an accuracy goal of 0.1 picoseconds of delay. In doing the
!     calculations for the geometry, much of the work neccesary for the
!     computation of model contributions to delay and delay rate and partials of
!     delay and delay rate with respect to model parameters is also done.
!     Matrices which represent coordinate rotations (precession, nutation,
!     diurnal spin, diurnal polar motion, and wobble) and their CT time
!     derivatives are stored as (3,3,N) arrays, where N indixes the N-1'th time
!     derivative. The subroutines suffixed G are sections of model modules. The
!     other subroutines may be considered utilities and either superseed or
!     incorporate many present PEP routines.
!
!      write(6,*) ' !!!! ddrvr/UVW = ', UVW
!  Pass # of sites to c2poly.i. 
      Numsite = Numsit
!
!  UTC epoch at start of current 2-minute interval
       JTAG(1) = Intrvl(1,1)    ! year
       JTAG(2) = Intrvl(2,1)    ! month
       JTAG(3) = Intrvl(3,1)    ! day 
       JTAG(4) = Intrvl(4,1)    ! hour
       JTAG(5) = Intrvl(5,1) + (J2m-1)*2   ! minute
       TAG_SEC = 0.D0
         IF (JTAG(5) .ge. 60) Call FixEpoch2(JTAG, TAG_SEC)
!
! Start the loop over time. We do all observations at each epoch before 
!  moving to the next epoch because it is the most efficient in terms of
!  CPU time.
!

      DO Itime = 1, epoch2m                     ! Start of epoch loop
!
!  Define UTC for this epoch
        If (Itime .gt. 1) TAG_SEC = TAG_SEC +  d_interval     ! seconds
       IF (TAG_SEC .ge. 59.999999999D0) Call FixEpoch2(JTAG, TAG_SEC)
        TAGSEC = TAG_SEC
!
!  Compute the Julian date at 0 hours UTC for the year, month, day.
!  Use function JDY2K to convert year, month, day to Julian date.
!  Year can be either 2-digit or 4-digit.
      IYY = JTAG(1)
      IM  = JTAG(2)
      ID  = JTAG(3)
      XJD = JDY2K(IYY,IM,ID)
!     write(6,*) '   '
!     write(6,'("ddrvr: JTAG,TAGSEC,XJD = ",5I5,F5.1,F12.2)')         &
!    &      JTAG,TAGSEC,XJD
!     write(6,*) '   '
!  Fill output time array
       Iymdhms_f(Itime,1) = JTAG(1)
       Iymdhms_f(Itime,2) = JTAG(2)
       Iymdhms_f(Itime,3) = JTAG(3)
       Iymdhms_f(Itime,4) = JTAG(4)
       Iymdhms_f(Itime,5) = JTAG(5)
       Iymdhms_f(Itime,6) = TAGSEC 
!
!     Compute the UTC time as a fraction of the UTC day.
      UTC = ( DFLOAT ( JTAG(4) ) * 3600.D0                              &
     &      + DFLOAT ( JTAG(5) ) * 60.D0                                &
     &      + TAGSEC ) / 86400.D0
!
!     write(6,'("ddrvr: UTC ",F15.10)')  UTC
!
!     Call ATIME for the atomic time fraction of the atomic time day (AT) and
!     for the partial derivative of the UTC time with respect to the atomic
!     time (DUTCAT).
      CALL ATIME (UTC, XJD, AT, DUTCAT, TT)
!     write(6,*) ' ATIME: UTC,XJD,AT,DUTCAT,TT ', UTC,XJD,AT,DUTCAT,TT
!
!     Call CTIMG for the coordinate time fraction of the coordinate time day at
!     site #1 (CT), the partial derivative of the atomic time with respect to
!     the coordinate time (DATDCT), and the partial derivative of the long
!     period terms in the 'AT minus CT' offset with respect to the coordinate
!     time (DLPGR).
      CALL CTIMG (AT, TT, CFSITE, SITLON, UTC, XJD, CT, DATDCT, DLPGR,  &
     &     TDB, TDBg )
!     write(6,*) ' CTIME: CFSITE,SITLON,CT,DATDCT,DLPGR,TDB,TDBg ',     &
!    &            CFSITE,SITLON,CT,DATDCT,DLPGR,TDB,TDBg
!
!     Compute epoch and compare with previous observation. If same, set
!     TSKIP=1, otherwise TSKIP=0. If TSKIP=1, then we can skip many steps in
!     the geometry subroutines.
       TJD = XJD + TT
       OBSDIF = DABS(TJD - SJD)
       IF (OBSDIF .lt. 1.D-16) THEN
          TSKIP = 1
       ELSE
          TSKIP = 0
          SJD = TJD
       ENDIF
!
!     Call PEP for the J2000.0 geocentric Sun (SUN) and Moon (XMOON) position
!     and velocity vectors; the J2000.0 solar system barycentric Earth
!     position, velocity, and acceleration vectors (EARTH); the other planets'
!     (except Pluto) barycentric and geocentric positions and velocities.
!     The solar system info comes from the DE421 JPL Ephemeris.
      CALL PEP (XJD, TDBg, TSKIP, EARTH, SUN, XMOON)
!     write(6,*) ' PEP: EARTH,SUN,XMOON ', EARTH,SUN,XMOON
!
!     Call NUTFA before NUTG and before UT1G to get epoch in centuries and
!     the fundamental arguments for the nutation series.
          CALL NUTFA (XJD, TT, CT, CENT, FA2K, FAD2K)
!     write(6,*) ' NUTFA: FA2K, FAD2K ', FA2K, FAD2K
!
!     Call UT1G for the UT1 fraction of the UT1 day (UT1) and for the partial
!     derivative of the UT1 time with respect to the atomic time (DUT1AT).
      CALL UT1G (AT, DUTCAT, UTC, XJD, CT, TT, FA2K, FAD2K,             &
     &     CENT, TSKIP, DUT1AT, UT1, Xti, Yti, UT1ti,                   &
     &     dXti, dYti, dUT1ti)
!     write(6,*) ' UT1G: DUT1AT, UT1 ', DUT1AT, UT1
!     write(6,*) ' UT1G: Xti,Yti,dXti,dYti(mas) ', Xti,Yti,dXti,dYti 
!     write(6,*) ' UT1G: UT1ti,dUT1ti(msec) ',  UT1ti,dUT1ti 
!
!     Call NUTG for the nutation portion of the complete crust fixed to
!     J2000.0 rotation matrices and their CT time derivatives (RPN2K6),
!     the true obliquity of the ecliptic and its CT time derivative,
!     (EPS), the mean obliquity at J2000.0 (EPSMNR), and the CEO-based
!     nutation offsets (X06, Y06, S06).
      CALL NUTG (CENT, FA2K, FAD2K, XJD, TT, TSKIP, EPS,                &
     &          EPSMNR, RPN2K6, X06, Y06, S06)
!     write(6,*) ' NUTG: X06, Y06, S06 ', X06, Y06, S06 
!     write(6,*) ' NUTG: RPN2K6 ', RPN2K6 
!
!     Call DIRNL for the diurnal spin portion of the complete crust fixed to
!     J2000.0 rotation matrices and their first two CT time derivatives (RS2K
!     and RSC2K), the Earth rotation angle and its CT time derivative
!     (ERA2K and DERA2K), the Greenwich apparent siderial time and its CT
!     time derivative (GAST2K), the Greenwich mean siderial time (GMST2K),
!     and the diurnal rotational velocity of the Earth (DIURNV).
!            ---> DIURNV removed, not used
!
       CALL DIRNL (DATDCT, DUT1AT, EPS, FA2K, FAD2K, UT1,               &
     &       XJD, CT, DUTCAT, CENT,                                     &
     &       RPN2K6, S06,                                               &
     &       ERA2K, DERA2K, pERA2K, RS2K,  RS2Km1, RS2Kp1,              &
     &       GAST2K, GMST2K, RSC2K)
!!!!!! GMST2K updated, GAST2K not updated !!!!!!!!!
!     write(6,*) ' DIRNL: ERA2K, DERA2K ', ERA2K, DERA2K 
!
!     Call WOBG for the wobble portion of the complete crust fixed to J2000.0
!     rotation matrix and its first time derivative (RW2K), and the long period
!     wobble X and Y OFFSETS. (NOTE: Right-handed coordinate system.)
      CALL WOBG (CENT, TT, UTC, XJD, GMST2K, TSKIP, FA2K, FAD2K,        &
     &           UT1, DUT1AT, Xti, Yti, dXti, dYti, Xli, Yli,           &
     &           dXli, dYli, UT1li, dUT1li, UT1ti, dUT1ti,              &
     &           WOBXR, WOBYR, WOBXD, WOBYD, SP, DSP, RW2K)
!     write(6,*) ' WOBG: WOBXR,WOBYR,WOBXD,WOBYD ', WOBXR,WOBYR,WOBXD,WOBYD
!
!     Call M2K to complete the IERS 2010 CEO-based TRF ==> CRF
!      tranformation matrix and its first two time derivatives.
      CALL M2K (RPN2K6, RS2K, RW2K, TSKIP, R2K6 )

!!    IF (NumSpace .ge. 1) THEN
      IF (Near_Far .eq. 'Near-field') THEN
       TSKIP = 0
!      Rotation matrix at -1 second.
         CALL MSUB2 (RPN2K6(1,1,1), RPN2K6(1,1,2), RPNm1(1,1,1))
         CALL MATEQ (RPN2K6(1,1,2), RPNm1(1,1,2))
         CALL MSUB2 (RW2K  (1,1,1), RW2K  (1,1,2), RWm1(1,1,1))
         CALL MATEQ (RW2K  (1,1,2), RWm1(1,1,2))
        CALL M2K (RPNm1, RS2Km1, RWm1, TSKIP, R2K6m1)
!
!      Rotation matrix at +1 second.
         CALL MADD2 (RPN2K6(1,1,1), RPN2K6(1,1,2), RPNp1(1,1,1))
         CALL MATEQ (RPN2K6(1,1,2), RPNp1(1,1,2))
         CALL MADD2 (RW2K  (1,1,1), RW2K  (1,1,2), RWp1(1,1,1))
         CALL MATEQ (RW2K  (1,1,2), RWp1(1,1,2))
        CALL M2K (RPNp1, RS2Kp1, RWp1, TSKIP, R2K6p1)
!      Write(6,1037) R2K6
 1037  Format(1x,'DRIVR/R2K6 : ',(9(/,3E25.15)))
!      Write(6,1047) R2K6m1
 1047  Format(1x,'DRIVR/R2K6m1: ',(9(/,3E25.15)))
!      Write(6,1057) R2K6p1
 1057  Format(1x,'DRIVR/R2K6p1: ',(9(/,3E25.15)))
      ENDIF
!
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Set up baseline definitions
      If (Base_mode .eq. 'geocenter ') Then 
!    Station 1 is always the geocenter
       I11 = 1 
       I12 = 1 
!    Station 2 runs over all antennas 
       I21 = 2 
       I22 = Numsite
      Endif
!
      If (Base_mode .eq. 'master-stn') Then 
!    Station 1 is always the first antenna 
       I11 = 2 
       I12 = 2 
!    Station 2 runs over all other antennas 
       I21 = 3 
       I22 = Numsite
      Endif
!
      If (Base_mode .eq. 'baseline  ') Then 
!    Station 1 runs from first to next-to-last antenna 
       I11 = 2 
       I12 = Numsite - 1
      Endif
!
!    Assign a unique baseline index number
       IndexB = 0
!
!  Begin Station Loops. Process all the baselines for the current epoch.
!
      DO Istation1 = I11, I12                     ! Start of station 1 loop
!
        If (Base_mode .eq. 'baseline  ') Then 
!      Station 2 runs from next antenna to the last antenna
         I21 = Istation1 + 1
         I22 = Numsite 
        Endif
!
      DO Istation2 = I21, I22                     ! Start of station 2 loop
!
!  Define baseline.
       Baseline(1) = Sites(Istation1)
       Baseline(2) = Sites(Istation2)
!    Assign a unique baseline index number
       IndexB = IndexB + 1
       Site1(IndexB,Itime) = Baseline(1)
       Site2(IndexB,Itime) = Baseline(2)
        Numbaseline = IndexB
!
!     write(6,*) '   '
!     write(6,'(5I5,F5.1,2X,A8,1X,A8)') JTAG, TAGSEC, Baseline(1),      &
!    &      Baseline(2)
!
!     Call SITG for the geographical site data. SITG provides the following
!     geocentric information for each observing site: the antenna axis offsets
!     (AXOFF), the antenna types (KAXIS), the crust fixed site vectors (CFSITE),
!     the crust fixed baseline vector (CFBASE), the crust fixed site normal unit
!     vectors (CFSITN), the geodetic latitudes (SITLAT), the site east
!     longitudes (SITLON), the spherical Earth radii, the partial derivatives of
!     the crust fixed site vector components with respect to the geodetic
!     latitudes (CFLAT) and east longitudes (CFLON), the rotation matrices which
!     rotate the topocentric site reference system to the geocentric system at
!     each site (TCTOCF), and the zenith tropospheric path delays at each
!     observing site. SITG is the only routine which 'knows' which two sites are
!     involved in the observation. All other routines merely work with site #1
!     and site #2.
      CALL SITG (AXOFF, CFBASE, CFLAT, CFLON, CFSITE, CFSITN, KAXIS,    &
     &     OCEAMP, OCEPHS, SITLAT, SITLON, SITRAD, TCTOCF, RTTOCF,      &
     &     ZPATH, SITHEIGHT, GEOLAT, AXTILT, ROTAXIS, OPTLcoef )
!
!     Call ROT2K to rotate the crust fixed site data into the J2000.0 inertial
!     reference system. The following variables are output for each observing
!     site in J2000.0 coordinates: the site position vectors (USITEP) and
!     velocity vectors (USITEV) uncorrected for Earth tidal and ocean loading
!     effects; the site accelerations (SITEA); the site normal unit vectors
!     (EPSITN); and the partial derivatives of the site position and velocity
!     vector components with respect to the site geodetic latitudes (EPLATP
!     and EPLATV) and east longitudes (EPLONP and EPLONV).
!  IERS 2010 version:
      CALL ROT2K (CFLAT, CFLON, CFSITE, CFSITN, R2K6, EPLATP, EPLATV,   &
     &     EPLONP, EPLONV, EPSITN, SITEA, USITEP, USITEV)
!     write(6,237) USITEP, USITEV, SITEA
 237  format(' USITEP, USITEV, SITEA',/,6(3D30.16,/))
!
!     Call ETDG for the corrections to the J2000 site position vectors (TIDEP)
!     and velocity vectors (TIDEV) due to Earth tide effects.
      CALL ETDG ( R2K6, SITLAT, SITLON, SUN, TCTOCF, RTTOCF,            &
     &            USITEP, USITEV, XMOON, EARTH, GAST2K,                 &
     &                FA2K, FAD2K, CENT, GEOLAT, TIDEP, TIDEV)
!
!     Call 'PTDG' for the corrections to the J2000.0 site positions
!      and site velocity vectors due to the solid Earth pole tide.
      CALL PTDG (SITLAT, SITLON, SITRAD, WOBXR, WOBYR, &
     &     TCTOCF, R2K6, CENT, POLTDP, POLTDV, WOBXds, WOBYds)
!
!     Call OCEG for the corrections to the J2000.0 site position vectors
!      (XLOADP) and velocity vectors (XLOADV) due to ocean loading effects.
      CALL OCEG (CFSITE, UT1, OCEAMP, OCEPHS, R2K6, XJD, TCTOCF, TSKIP, &
     &     FA2K, CENT, UTC, XLOADP, XLOADV)
!
!     Call OCPTG for the corrections to the J2000.0 site position vectors
!      (XLOADP) and velocity vectors (XLOADV) due to ocean pole tide 
!      loading effects.
      CALL OPTLG (WOBXds, WOBYds, OPTLcoef, R2K6, TCTOCF, TSKIP,        &
     &           OPTLOADP, OPTLOADV)
!
!     Call dSITCR to apply the Earth tide, ocean loading, and pole tide
!      corrections to the J2000.0 site position vectors (SITEP), site
!      velocity vectors (SITEV), and the J2000.0 baseline position and
!      velocity vectors (EPBASE).
      CALL dSITCR (TIDEP, TIDEV, USITEP, USITEV, XLOADP, XLOADV,        &
     &     EPBASE, SITEP, SITEV, POLTDP, POLTDV, OPTLOADP, OPTLOADV)
!     write(6,238) SITEP
 238  format(' Site positions:',/,3D26.16,/,3D26.16)
!     write(6,239) SITEV
 239  format(' Site velocities:',/,3D26.16,/,3D26.16)
!
!
      DO Isrc = 1, (NumPhCntr+1)           ! Start of source/phase center loop
!
       If (Isrc .eq. 1) Isource = PointingSrc
       If (Isrc .gt. 1) Isource = PhCntr(Isrc-1) 
!       write(6,*) 'ddrvr: Isrc, Isource ', Isrc, Isource

!
!     Call STRG for the J2000.0 unit vector in the direction of the
!     radio source. (STAR)
!        Far-field:
      IF (Near_Far .eq. 'Far-field ') Then 
          CALL STRG (XJD, UTC, Isource,                                 &
     &           STAR, STAR12, RIGHT_ASC, DECLINATION, Sourc20)
!
       If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
!          write (6,*) 'Itime, ANT, Isrc: ', Itime, (Istation2-2), Isrc 
          Call STAR_NSEW (STAR, K_EWNS, RIGHT_ASC,DECLINATION, STAR12,  &
     &                    dKew,dKns)
       Endif
      Endif
!
!        Near-field:
      If (Near_Far .eq. 'Near-field') Then
        CALL NFSTRG (XJD, UTC, Isource, EARTH,  &
     &    SITEP, SITEV, SUN, XMOON,R2K6,STAR, STARdt, STAR12, STAR12dt, &
     &    T0_T1, R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag,             &
     &    R2magdt, STARff, R1_TDB, R2_TDB, R1mag_TDB, R2mag_TDB,        &
     &    Site2_TDB, Sourc20)
!       write(6,*) 'ddrvr1/R1mag,R1magdt ',  R1mag,R1magdt
!       write(6,*) 'ddrvr1/R2mag,R2magdt ',  R2mag,R2magdt
!       write(6,'(" R1mag: ",F20.7," AU")') R2mag/1.4959787D11
!       write(6,*) 'STARff: ',  STARff
       If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
        Call NFSTewns( R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag,       &
     &       R2magdt, STAR, STARdt, STAR12, STAR12dt, SITEP, SITEV,     &
     &       R1_TDB, R2_TDB, R1mag_TDB, R2mag_TDB, Site2_TDB, K_EWNS,   &
     &       STAR2           )
!       Write (6,*) '*** ddrvr *** '
!       Write (6,*) 'STAR2(n,1): ', STAR2(1,1), STAR2(2,1), STAR2(3,1)
!       Write (6,*) 'STAR2(n,2): ', STAR2(1,2), STAR2(2,2), STAR2(3,2)
!       Write (6,*) 'STAR2(n,3): ', STAR2(1,3), STAR2(2,3), STAR2(3,3)
!       Write (6,*) 'STAR2(n,4): ', STAR2(1,4), STAR2(2,4), STAR2(3,4)
!       Write (6,*) '************* '
       Endif
      Endif
!
!       xSource = Sourc8
        xSource = Sourc20
!       write(6,*) 'ddrvr: Sourc20,xSource,RIGHT_ASC, DECLINATION',     &
!    &    Sourc20,xSource,RIGHT_ASC, DECLINATION
!
!
!     Call ATMG for the aberrated elevation and azimuth angles of the
!      source and their CT time derivatives, and the aberrated source
!      unit vector.
!!    IF (NumSpace .eq. 0) Then
      IF (Near_Far .eq. 'Far-field ') Then
         CALL ATMG (R2K6, STAR, STAR12, EARTH, TCTOCF, SITEV,           &
     &     STAR_ABERRATED)
       DO I = 1,3
        DO J = 1,2
          STAR_ABERRATEDdt(I,J) = 0.D0
        ENDDO
       ENDDO 
        If (UVW .eq. 'exact ')  Then
          CALL ATMGuv (R2K6, K_EWNS, EARTH, TCTOCF, SITEV, K_EWNS_ab,   &
     &         AZ_ab, EL_ab)
        Endif

      ENDIF
!
!!    IF (NumSpace .ge. 1)                                              &
      IF (Near_Far .eq. 'Near-field') Then  
        CALL NFATM (R2K6, STAR, STAR12, STAR12dt, EARTH, TCTOCF, SITEV, &
     &       SITEA, R2K6m1, R2K6p1, R1mag, R2mag,                       &
     &       STAR_ABERRATED, STAR_ABERRATEDdt)
!       write(6,*) 'ddrvr2/R1mag,R1magdt ',  R1mag,R1magdt
!       write(6,*) 'ddrvr2/R2mag,R2magdt ',  R2mag,R2magdt
!
       If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
        Call NFATMuv (R2K6, STAR2, TCTOCF, SITEV, STAR12, STAR2_ab,      &
     &         AZ_ab, EL_ab)
       Endif
      ENDIF
!
!     Call AXOG for the J2000.0 vector axis offsets of the antennas and
!      their time derivatives at each site.
      CALL AXOG (KAXIS, R2K6, SITLAT, STAR, TCTOCF, SITEV, AXOFF,       &
     &     EARTH, STAR_ABERRATED, STAR_ABERRATEDdt, SITHEIGHT, AXTILT,  &
     &     ROTAXIS, AXIS2000, DAXIS2000, C2000STR)
!  C2000STR(3) = Aberrated/refracted source unit vector in the J2000.0 frame.
!
!    Add axis offset to the baseline instead of computing a contribution 
      Do J=1,2
       Do I=1,3
        SITEP1(I,J) = SITEP(I,J) +  AXIS2000(I,J)
        SITEV1(I,J) = SITEV(I,J) + DAXIS2000(I,J)
       Enddo
      Enddo
       Do I=1,3
        EPBASE(I,1) = SITEP1(I,1) - SITEP1(I,2)
        EPBASE(I,2) = SITEV1(I,1) - SITEV1(I,2)
       Enddo
!
!    Call UVG to compute the (U,V) coordinates of the baseline.
      If (UVW .eq. 'uncorr') Then 
       CALL UVG_un (STAR, EPBASE) ! [ABERRATION CORR = UNCORRECTED]
!      Write (6,*) 'UVG_un: U,V,W   ', U_V, Wb
      Endif
!
!    Call UVG_ab to compute the (U,V) coordinates of the baseline,
!    using the aberrated source unit vector. 
      If (UVW .eq. 'approx') Then 
       CALL UVG_ab (STAR_ABERRATED, EPBASE) ! [ABERRATION CORR = APPROXIMATE]
!      Write (6,*) 'UVG_ab: U,V,W   ', U_V, Wb
      Endif
!
!    Call UVG_no to compute the (U,V) coordinates of the baseline,
!    using the partial derivative technique without atmosphere 
!#    CALL UVG_plus (EPBASE, STAR, STAR_ABERRATED, EARTH, SITEV1) ! [ABERRATION CORR = NO ATMOS]
!!!!  CALL UVG_plus (EPBASE, STAR, STAR          , EARTH, SITEV1) ! [ABERRATION CORR = NO ATMOS??]
!!!!!! Write (6,*) 'UVG_noatmo: U,V ', U_V
!
!    Call UVG_exact to compute the (U,V) coordinates of the baseline,
!    using the partial derivative technique with atmosphere 
!#    CALL UVG_plus (EPBASE, STAR, C2000STR, EARTH, SITEV1) ! [ABERRATION CORR = EXACT ]
!#     Write (6,*) 'UVG_exact: U,V  ', U_V
!
!  Load U,V,W coordinates:
!       Ubase_f(Itime,Istation1,(Istation2-1),Isrc) = U_V(1)
!       Vbase_f(Itime,Istation1,(Istation2-1),Isrc) = U_V(2)
!       Wbase_f(Itime,Istation1,(Istation2-1),Isrc) = Wb 
!
!
!   Perform the partial derivatives calculations.
!    For difx, only the atmosphere partials are needed.
!    The others are left for future use but commented out.
!
!     Compute the atmosphere partials.
      CALL ATMP (SITLAT, SITLON, SITHEIGHT, XJD, CT, dATMCdh,           &
     &     gmfh, gmfw)
!
!     Compute the axis offset partials.
!**   CALL AXOP (AXOFF, STAR12, EARTH, SITEV1)
!
!     Compute the Earth tide partials.
!**   CALL ETDP (R2K6, SITLAT, STAR, TCTOCF)
!
!     Compute the pole tide partials.
!**   CALL PTDP (STAR)
!
!     Compute the nutation partials. (IERS 2010)
!**   CALL NUTP (CFBASE,      X06,Y06,S06,                              &
!    &      STAR, RPN2K6, RS2K, RW2K, TSKIP)
!
!     Compute the ocean loading partials.
!**   CALL OCEP()
!
!     Compute the site partials.
!**   CALL SITP (R2K6, STAR, STAR12, EARTH, SITEV1)
!
!     Compute the star partials.
      CALL STRP (EPBASE, STAR, EARTH, SITEV1,        CD, CRA, SD, SRA)
!*    Write(6,'(" U,V,W: ",7x,3D22.14)')  U_V(1), U_V(2), Wb
!     WRITE(6,'(" DSTRP*Vlight: ",4D22.14)') DSTRP(1,1)*Vlight/CD,      &
!    &  DSTRP(2,1)*Vlight, DSTRP(1,2)*Vlight/CD, DSTRP(2,2)*Vlight

!
!     Compute the UT1 partials.
!**   CALL UT1P (CFBASE, STAR,EARTH, RPN2K6, RW2K, ERA2K, dERA2K,        &
!**  &           pERA2K, SITEV       )
!
!     Compute the wobble partials.
!**   CALL WOBP (CFBASE, STAR, EARTH, RPN2K6, RS2K, SITEV1)
!
!     Compute the parallax partials.
!**   CALL PLXP (SUN, CD, CRA, SD, SRA, EARTH, STAR, EPBASE, SITEV1)
!
!
!  Perform the contributions calculations.
!    For difx, only the atmosphere contributions are needed.
!    The others are left for future use but commented out.
!
!     Compute the atmosphere contributions.
      CALL ATMC (ZPATH, DATMC)
       If (UVW .eq. 'exact ')  Then
        Call EWNS_atmC (gmfh,gmfw, EL_ab,Datmc_h_EWNS,Datmc_w_EWNS)
       Endif
!
      If (Base_mode .eq. 'geocenter ') IS2 = 1
      If (Base_mode .ne. 'geocenter ') Then
       IS1 = 1
       IS2 = 2
      Endif
!      
!    Station 2:

       ATMdryd_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = DATMC(2,1)
       ATMdryr_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = DATMC(2,2)
       ATMwetd_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = Datmc_wmf(2,1)
       ATMwetr_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = Datmc_wmf(2,2)
       El_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = ELEV(2,1) * 57.295779512D0
       Az_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = AZ(2,1) * 57.295779512D0
       StaX_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = -EPBASE(1,1)
       StaY_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = -EPBASE(2,1)
       StaZ_f(IS2,Itime,Istation1,(Istation2-1),Isrc) = -EPBASE(3,1)
!    Station 1 (usually the geocenter):
!     If (Base_mode .ne. 'geocenter ') Then
!      ATMdryd_f(IS1,Itime,Istation1,(Istation2-1),Isrc) = DATMC(1,1)
!      ATMdryr_f(IS1,Itime,Istation1,(Istation2-1),Isrc) = DATMC(1,2)
!      ATMwetd_f(IS1,Itime,Istation1,(Istation2-1),Isrc) = Datmc_wmf(1,1)
!      ATMwetr_f(IS1,Itime,Istation1,(Istation2-1),Isrc) = Datmc_wmf(1,2)
!     Endif
!
!     Compute the axis offset contributions.
!**   CALL AXOC (AXOFF)
!
!     Compute the Earth tide contributions.
!**   CALL ETDC (TIDEP1, TIDEV1, STAR)
!
!     Compute the pole tide contributions.
!**   CALL PTDC (STAR)
!
!     Compute the ocean loading contributions.
!**   CALL OCEC (STAR)
!
!     Compute the ocean pole tide loading contributions.
!**   CALL OPTLC(OPTLOADP, OPTLOADV, STAR)
!
!     Compute the UT1 contributions.
!**   CALL UT1C (       UT1ti, dUT1ti, UT1li, dUT1li)
!
!     Compute the wobble contributions.
!**   CALL WOBC(Xti,Yti,dXti,dYti)
!
!     Compute the parallax contributions.
!**   CALL PLXC()
!
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     Perform the calculation for the complete theoretical delay and rate.
!     Also do all the work of all elements of the Relativity Module,
!     including the contributions and partials. This now includes only
!     the Consensus relativity model computations:
!!!   IF (NumSpace .le. 0)                                              &
      IF (Near_Far .eq. 'Far-field ')  THEN
       Call CONSEN ( DATMC, EARTH, EPBASE, SITEP1, SITEV1,              &
     &      SITEA, SUN, XMOON, STAR, K_EWNS, Datmc_h_EWNS,Datmc_w_EWNS, &
     &      tg2_tg1, dtg2_tg1,                                          &
     &      delta_t_grav, d_delta_t_grav, delta_t_grav_Sun,             &
     &      d_delta_t_grav_Sun )
       write(6,*) "Consensus model"   
      Endif
!
!       write(6,*) 'ddrvr3/R1mag,R1magdt ',  R1mag,R1magdt
!       write(6,*) 'ddrvr3/R2mag,R2magdt ',  R2mag,R2magdt
!
!     IF (NumSpace .ge. 1) THEN 
      IF (Near_Far .eq. 'Near-field') THEN
!
       If (NF_model .eq. 'Sekido  ') Then
        Call SEKIDO ( DATMC, EARTH, EPBASE, SITEP1, SITEV1, SITEA, SUN, &
     &      XMOON, STAR, STARdt, T0_T1, R1, R1dt, R1mag, R1magdt,       &
     &      R2, R2dt, R2mag, R2magdt, STAR12, STAR12dt,                 &
     &      tg2_tg1, dtg2_tg1) 
!      write(6,*) 'tg2_tg1,dtg2_tg1 ', tg2_tg1,dtg2_tg1
        If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
!         write (6,*) ' tg2_tg1      ', tg2_tg1
         Call  SEKIDOewns ( Datmc_h_EWNS, Datmc_w_EWNS, EARTH, EPBASE,  &
     &         SITEP, SITEV,  SITEA, SUN, XMOON, T0_T1 )
        Endif
       Endif
!
       If (NF_model .eq. 'Ranging ') Then
        Call RANGE (DATMC, SITEP, SITEV, SITEA, SUN,                    &
     &      T0_T1, R1, R1dt, R1mag, R1magdt,                            &
     &      R2, R2dt, R2mag, R2magdt,                                   &
     &      tr2_tr1, dtr2_tr1)
         tg2_tg1 = tr2_tr1
         dtg2_tg1 = 0.D0
        If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
!         write(6,*) 'tr2_tr1 ', tr2_tr1
        Call  RANGEewns (Datmc_h_EWNS, Datmc_w_EWNS, SITEP, SITEV,      &
     &      SITEA, SUN, T0_T1,                                          &
     &      R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag, R2magdt)
        Endif
       Endif
!
       If (NF_model .eq. 'Duev    ') Then
        CALL DUEV (DATMC, SITEP, SITEV, SITEA, SUN, T0_T1,              &
     &     EARTH, XMOON, UTC, TT, TDB, TDBg, td2_td1, dtd2_td1)
         tg2_tg1 = td2_td1
         dtg2_tg1 = 0.D0
!       write(6,*) 'td2_td1 ', td2_td1
        If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
         Call DUEVewns (Datmc_h_EWNS, Datmc_w_EWNS, SITEP, SITEV,       &
     &      SITEA, SUN, T0_T1, EARTH, XMOON, UTC, TT, TDB, TDBg)
        Endif
       Endif
!
!      write(6,*) 'tg2_tg1,tr2_tr1,td2_td1 ', tg2_tg1,tr2_tr1,td2_td1
!      write(6,*) 'diffs: ', tg2_tg1-tr2_tr1, tg2_tg1-td2_td1, tr2_tr1-td2_td1 
!      write(6,*) '       ' 
!
      ENDIF
!
!   Load delay and rate arrays
      write(6,*) 'tg2_tg1,dtg2_tg1 ', tg2_tg1, dtg2_tg1
        Delay_f(Itime,Istation1,(Istation2-1),Isrc) = tg2_tg1 
         Rate_f(Itime,Istation1,(Istation2-1),Isrc) = dtg2_tg1
!        write(6,*) 'ddrvr: ', Iscan,J2m,Itime,Istation1,(Istation2-1), &
!    &     Isrc, Delay_f(Itime,Istation1,(Istation2-1),Isrc),DATMC(1,1), DATMC(2,1) 
!
       If (Atmdr .eq. 'Add-dry   ')  Then
        Delay_f(Itime,Istation1,(Istation2-1),Isrc)  =                  &
     &     Delay_f(Itime,Istation1,(Istation2-1),Isrc) +                &
     &      DATMC(1,1) + DATMC(2,1)
         Rate_f(Itime,Istation1,(Istation2-1),Isrc)  =                  &
     &     Rate_f(Itime,Istation1,(Istation2-1),Isrc)   +               &
     &     DATMC(1,2) + DATMC(2,2)
       Endif
!
       If (Atmwt .eq. 'Add-wet   ')  Then
        Delay_f(Itime,Istation1,(Istation2-1),Isrc)  =                  &
     &     Delay_f(Itime,Istation1,(Istation2-1),Isrc) +                &
     &     Datmc_wmf(1,1) + Datmc_wmf(2,1)
         Rate_f(Itime,Istation1,(Istation2-1),Isrc)  =                  &
     &     Rate_f(Itime,Istation1,(Istation2-1),Isrc) +                 &
     &     Datmc_wmf(1,2) + Datmc_wmf(2,2)
       Endif
!
! W coordinate of UVW:
      If (UVW .eq. 'noatmo')  Then
       Wb = tg2_tg1 * VLIGHT
!      Write (6,*) 'noatmo: U,V,W   ', U_V, Wb
      Endif
!
      If (UVW .eq. 'exact ') Then 
        Wb = (tg2_tg1 + DATMC(1,1) + DATMC(2,1) +                       &
     &       Datmc_wmf(1,1) + Datmc_wmf(2,1)) * VLIGHT
!      Write (6,*) 'exact: U,V,W   ', U_V, Wb
      Endif
!
!  Load U,V,W coordinates:
        Ubase_f(Itime,Istation1,(Istation2-1),Isrc) = U_V(1)
        Vbase_f(Itime,Istation1,(Istation2-1),Isrc) = U_V(2)
        Wbase_f(Itime,Istation1,(Istation2-1),Isrc) = Wb 
!         
!     If (I_out .eq. 1) Then 
!      L = Itime
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write (LC,1016) RIGHT_ASC, DECLINATION, IRA,IDec, Ph_RA, Ph_Dec  
!1016  Format('  RA/Dec: ',2F20.15,'  Phase Center(',I3,',',I3,'):',2F20.15)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      If (Base_mode .eq. 'geocenter ') Then 
!       write (LC,1011) IndexB, Iymdhms_f(L,1), Iymdhms_f(L,2),          &
!    &        Iymdhms_f(L,3),                                           &
!    &        Iymdhms_f(L,4), Iymdhms_f(L,5), Iymdhms_f(L,6),           &
!    &        Site1(IndexB,L), Site2(IndexB,L), xSource,                &
!    &        Delay_f(IndexB,L)*1.D6, Rate_f(IndexB,L)*1.D6,            &
!    &        Atmdryd_f(IndexB,2,L)*1.D6, Atmdryr_f(IndexB,2,L)*1.D6,   &
!    &        Atmwetd_f(IndexB,2,L)*1.D6, Atmwetr_f(IndexB,2,L)*1.D6,   &
!             Ubase_f(IndexB,L), Vbase_f(IndexB,L), Wbase_f(IndexB,L)
!1011 Format(I3,I7,5I3,3X,A8,2X,A8,3X,A8,/,'Delay(us):   ',2E25.16,/,   &
 1011 Format(I3,I7,5I3,3X,A8,2X,A8,3X,A20,/,'Delay(us):   ',2E25.16,/,   &
     &       'Atm-dry(us): ', 2E25.16,/, 'Atm-wet(us): ', 2E25.16,/,    &
     &       'U,V,W(m):    ', 3E25.16,/) 
!      Endif
!
!      If (Base_mode .eq. 'master-stn' .or. Base_mode .eq. 'baseline  ') Then 
!!       Write(LC,'("KdotB/C(us): ",2E25.16)') (DOTP(STAR,EPBASE(1,1)))/VLIGHT*1.D6,   &
!!   &        (Delay_f(IndexB,L) - (DOTP(STAR,EPBASE(1,1)))/VLIGHT)*1.D6
!!       Write(LC,'("R2-R1/C(us): ",2E25.16)') (R2mag - R1mag)/VLIGHT*1.D6,    &
!!   &        (Delay_f(IndexB,L) - (R2mag - R1mag)/VLIGHT)*1.D6
!      write (LC,1012) IndexB, Iymdhms_f(L,1), Iymdhms_f(L,2),          &
!    &        Iymdhms_f(L,3),                                           &
!    &        Iymdhms_f(L,4), Iymdhms_f(L,5), Iymdhms_f(L,6),           &
!    &        Site1(IndexB,L), Site2(IndexB,L), xSource,                &
!    &        Delay_f(IndexB,L)*1.D6, Rate_f(IndexB,L)*1.D6,            &
!    &        DATMC(1,1)*1.D6, DATMC(1,2)*1.D6,                         &
!    &        Datmc_wmf(1,1)*1.D6, Datmc_wmf(1,2)*1.D6,                 &
!    &        DATMC(2,1)*1.D6, DATMC(2,2)*1.D6,                         &
!    &        Datmc_wmf(2,1)*1.D6, Datmc_wmf(2,2)*1.D6,                 &
!             Ubase_f(IndexB,L), Vbase_f(IndexB,L), Wbase_f(IndexB,L)
!1012 Format(I3,I7,5I3,3X,A8,2X,A8,3X,A8,/,'Delay(us):   ',2E25.16,/,   &
 1012 Format(I3,I7,5I3,3X,A8,2X,A8,3X,A20,/,'Delay(us):   ',2E25.16,/,   &
     &       'Atm-dry(us): ', 2E25.16,/, 'Atm-wet(us): ', 2E25.16,/,    &
     &       'Atm-dry(us): ', 2E25.16,/, 'Atm-wet(us): ', 2E25.16,/,    &
     &       'U,V,W(m):    ', 3E25.16,/)
!      Endif
!
!     Endif
!
!
!      write (6,*) '               '
!     Write(6,'("NF: Elev:",4F15.10)') Elev(1,1)/CONVD,Elev(2,1)/CONVD, &
!    &         Elev(1,2)/CONVD,Elev(2,2)/CONVD
!     Write(6,'("NF: AZ:  ",4F15.10)') AZ(1,1)/CONVD, AZ(2,1)/CONVD,    &
!    &         AZ(1,2)/CONVD, AZ(2,2)/CONVD
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!! Compare near-field to far-field:
!     IF (NumSpace .ge. 1) THEN
!       write(6,*) '                     '
!       write(6,*) ' Switching to far-field model '
!       write(6,*) '                     '
!      CALL STRG (XJD, UTC, Isource, STAR, STAR12, Sourc8)
!       write(6,*) 'STAR: ',  STAR
!       write(6,*) 'STAR12: ',  STAR12
!      CALL ATMG (R2K6, STAR, STAR12, EARTH, TCTOCF, SITEV,           &
!    &     STAR_ABERRATED)
!      write (6,*) '               '
!     Write(6,'("FF: Elev:",4F15.10)') Elev(1,1)/CONVD,Elev(2,1)/CONVD, &
!    &         Elev(1,2)/CONVD,Elev(2,2)/CONVD
!     Write(6,'("FF: AZ:  ",4F15.10)') AZ(1,1)/CONVD, AZ(2,1)/CONVD,    &
!    &         AZ(1,2)/CONVD, AZ(2,2)/CONVD
!      DO I = 1,3
!       DO J = 1,2
!         STAR_ABERRATEDdt(I,J) = 0.D0
!       ENDDO
!      ENDDO 
!      CALL AXOG (KAXIS, R2K6, SITLAT, STAR, TCTOCF, SITEV, AXOFF,       &
!    &     EARTH, STAR_ABERRATED, STAR_ABERRATEDdt, SITHEIGHT, AXTILT,  &
!    &     ROTAXIS, AXIS2000, DAXIS2000)
!      CALL ATMP (          SITLAT, SITHEIGHT, XJD, CT, dATMCdh)
!      CALL AXOP (AXOFF, STAR12, EARTH, SITEV)
!      CALL ATMC (ZPATH, DATMC)
!      CALL AXOC (AXOFF       )
!      CALL UVG_ab (STAR_ABERRATED, EPBASE)
!      CALL THERY (DATMC, DIONC, DLPGR, EARTH, EPBASE, SITEP, SITEV,    &
!    &            SITEA, SUN, STAR, XMOON, AT)
!     Call  CONSEN ( DATMC, EARTH, EPBASE, SITEP, SITEV,                &
!    &      SITEA, SUN, XMOON, STAR, tg2_tg1, dtg2_tg1,                 &
!    &      delta_t_grav, d_delta_t_grav, delta_t_grav_Sun,             &
!    &      d_delta_t_grav_Sun )    
!
!      Dt = tg2_tg1 + DATMC(1,1) + DATMC(2,1) + Datmc_wmf(1,1) +        &
!    &                Datmc_wmf(2,1)
!      Rt = dtg2_tg1 + DATMC(1,2) + DATMC(2,2) + Datmc_wmf(1,2) +       &
!    &                 Datmc_wmf(2,2)
!
!     Write(6,1021) Dt*1.D6, Rt*1.D6, DATMC(2,1)*1.D6, DATMC(2,2)*1.D6, &
!    &    Datmc_wmf(2,1)*1.D6, Datmc_wmf(2,2)*1.D6, U_V(1), U_V(2), Wb
!      Write(6,1022)  (Dt - Delay_f(IndexB,L))*1.D12,                   &
!    &  (Rt - Rate_f(IndexB,L))*1.D12,                                  &
!    &  (DATMC(2,1) - Atmdryd_f(IndexB,2,L))*1.D12,                     &
!    &  (DATMC(2,2) - Atmdryr_f(IndexB,2,L))*1.D12,                     &
!    &  (Datmc_wmf(2,1) - Atmwetd_f(IndexB,2,L))*1.D12,                 &
!    &  (Datmc_wmf(2,2) - Atmwetr_f(IndexB,2,L))*1.D12,                 &
!    &  U_V(1) - Ubase_f(IndexB,L),                                     &
!    &  U_V(2) - Vbase_f(IndexB,L),                                     &
!    &  Wb - Wbase_f(IndexB,L)
!1021  Format(6E25.16,/,3E25.16)
!1022  Format(2F12.4,1X,2F12.4,1X,2F12.4,1X,3F10.4)
!     ENDIF
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      ENDDO                        ! End of source/phase center loop
!
      ENDDO                        ! End of station2 loop
      ENDDO                        ! End of station1 loop
      ENDDO                        ! End of epoch loop
!
!     If (I_out .eq. 1) Close (LC)
!
!      write (6,*) '               '
!      write (6,*) ' Numbaseline = ', Numbaseline
!      write (6,*) '               '
!
!
!      write (6,*) '               '
!        Call c_out2(delay_f(1,1))
!           delay6(1) = Delay_f(1,1)
!           delay6(2) = Delay_f(1,2)
!        ierc2 = c_out(delay6, poly6)
!      write (6,*) ' poly6 ', poly6
!!!       call  f2c1(delay6)
!      write (6,*) '               '
!        ierc2 = c2_out( %REF(delay_f(I11,I21,1)))
!        ierc2 = c_out2( )
!      write (6,*) '               '
!
!
!     Go back to the main.
      RETURN
      END
      SUBROUTINE ATIME ( UTC, XJD, AT, DUTCAT, TT )
      IMPLICIT None
!
! 3.    ATIME
! 3.1   ATIME PROGRAM SPECIFICATION
! 3.1.1 ATIME IS THE UTILITY ROUTINE WHICH COMPUTES THE ATOMIC TIME
!       FROM THE UTC TIME AND ALSO CALCULATES THE PARTIAL DERIVATIVE
!       OF THE UTC TIME WITH RESPECT TO THE ATOMIC TIME.
!
! 3.2   ATIME PROGRAM INTERFACE
      Real*8 UTC, XJD, AT, DUTCAT, TT
!
! 3.2.1 CALLING SEQUENCE -
!          INPUT VARIABLES:
!            1. UTC - THE UTC FRACTION OF THE UTC DAY. (SEC/SEC)
!            2. XJD - THE JULIAN DATE AT 0:00 UTC OF THE DATE IN QUESTION.
!          OUTPUT VARIABLES:
!            1. AT     - THE ATOMIC TIME FRACTION OF THE ATOMIC TIME DAY. (DAYS)
!            2. DUTCAT - THE PARTIAL DERIVATIVE OF THE UTC TIME WITH RESPECT TO
!                        THE ATOMIC TIME. (SEC/SEC)
!            3. TT     - Terrestrial Time (days).
!
! 3.2.2 COMMON BLOCKS USED -
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!           VARIABLES 'FROM':
!             1. SECDAY - THE CONVERSION FACTOR OF COORDINATE TIME SECONDS PER
!                         COORDINATE TIME DAY. (SEC/DAY)
!
      Real*8  ATMUTC(3), ROTEPH(2,20), A1UTC(3), A1DIFF(3)
      COMMON / EOPCM / ATMUTC, ROTEPH, A1UTC, A1DIFF
!           VARIABLES 'TO/FROM':
!             1. ATMUTC(3) - THE 'TAI MINUS UTC' INFORMATION ARRAY. CONTAINS
!                            RESPECTIVELY THE EPOCH, VALUE, AND TIME RATE OF
!                            CHANGE OF 'TAI MINUS UTC'. (DAYS, SEC, SEC/SEC)
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1. KATIC - THE ATIME UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KATID - THE ATIME UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 3.2.3 PROGRAM SPECIFICATIONS -
! 3.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: NONE
! 3.2.7 CONSTANTS USED - SECDAY
! 3.2.8 PROGRAM VARIABLES - NONE
! 3.2.9 PROGRAMMER - DALE MARKHAM  02/04/77
!                    PETER DENATALE 07/18/77
!                    BRUCE SCHUPLER 02/07/78
!                    Jim Ryan 89.07.25 Documentaton simplified.
!                    Jim Ryan 02Sept Integer*4 mods.
!                    D. Gordon 2012  TT added.
!
!   ATIME Program Structure
!
!     Compute the atomic time fraction of the atomic time day.
      AT = + ATMUTC(2) / SECDAY                                         &
     &     + ATMUTC(3) * ( XJD  -  ATMUTC(1) )                          &
     &     + UTC
!
!     Compute the partial derivative of the UTC time with respect
!     to atomic time.
      DUTCAT = 1.D0 / ( 1.D0  +  ATMUTC(3) )
!
!     Compute TT, Terrestrial Time. 
       TT = AT + 32.184D0/86400.D0
!       write (6,*) 'ATIME: AT,TT (sec)', AT*86400.D0, TT*86400.D0
!
!     Check KATIC to see if the utility is to be turned off.
      IF ( KATIC .NE. 1 )  GO TO 399
        AT     = UTC
        DUTCAT = 1.D0
!
!     Check KATID for debug output.
 399  Continue
  400 IF ( KATID .EQ. 0 )  GO TO 500
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility ATIME." )
!
      WRITE(6,8)' ATMUTC  ',ATMUTC
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' SECDAY  ',SECDAY
      WRITE ( 6, 9200 )  UTC, XJD, AT, TT, DUTCAT
 9200 FORMAT (1X, "UTC    = ", D30.16, /, 1X,                           &
     &            "XJD    = ", D30.16, /, 1X,                           &
     &            "AT     = ", D30.16, /, 1X,                           &
     &            "TT     = ", D30.16, /, 1X,                           &
     &            "DUTCAT = ", D30.16 )
!
  500 RETURN
      END
      SUBROUTINE XY2K6 (XJD, TT, CENT, DCENT, FA2K, FAD2K, X, Y)
!
!  - - - - - - - - -
!   XY2K6 - Modified version of iau_XY06 from the SOFA software 
!           collection (IAU's Standards of Fundamental Astronomy
!           software collection).
!           Modifications made, April 2012: 
!            -Converted to Fortran 90.
!            -Fundamental arguments passed in, rather than computed.
!            -Time in centuries passed in, rather than computed.
!            -Name changed to XY2K6.
!            -Time derivatives added.
!  - - - - - - - - -
!
!  X,Y coordinates of celestial intermediate pole from series based
!  on IAU 2006 precession and IAU 2000A nutation.
!
!  1. CENT      -  The number of Julian centuries elapsed since the
!                  epoch January 1.5, 2000. (centuries) Uses TT time.
!  2. FA2K(14)  -  The fundamental arguments (arcsec)
!  3. FAD2K(14) -  The CT time derivatives of the fundamental
!                  arguments. (arcsec/century)
!  4. XJD       -  The Julian Date at zero hours UTC of the
!                  observation. (Not used.)
!  5. TT        -  Terrestrial Time fraction of the day. (Not used.)
!
!  Returned:
!     X,Y       -  CIP X,Y coordinates (Note 2)
!
!  Notes:
!
!  1) The time argument is in Julian centuries since January 1.5, 
!     2000, using time in TT.
!
!  2) The X,Y coordinates are those of the unit vector towards the
!     celestial intermediate pole.  They represent the combined effects
!     of frame bias, precession and nutation.
!
!  3) The fundamental arguments used are as adopted in IERS Conventions
!     (2003) and are from Simon et al. (1994) and Souchay et al. (1999).
!
!  4) This is an alternative to the angles-based method, via the SOFA
!     routine iau_FW2XY and as used in iau_XYS06A for example. The
!     two methods agree at the 1 microarcsecond level (at present),
!     a negligible amount compared with the intrinsic accuracy of the
!     models. However, it would be unwise to mix the two methods
!     (angles-based and series-based) in a single application.
!
!  References:
!
!     Capitaine, N., Wallace, P.T. & Chapront, J., 2003,
!     Astron.Astrophys., 412, 567
!
!     Capitaine, N. & Wallace, P.T., 2006, Astron.Astrophys. 450, 855
!
!     McCarthy, D. D., Petit, G. (eds.), 2004, IERS Conventions (2003),
!     IERS Technical Note No. 32, BKG
!
!     Simon, J.L., Bretagnon, P., Chapront, J., Chapront-Touze, M.,
!     Francou, G. & Laskar, J., Astron.Astrophys., 1994, 282, 663
!
!     Souchay, J., Loysel, B., Kinoshita, H., Folgueira, M., 1999,
!     Astron.Astrophys.Supp.Ser. 135, 111
!
!     Wallace, P.T. & Capitaine, N., 2006, Astron.Astrophys. 459, 981
!
!  This revision:  2009 December 15
!
!  SOFA release 2010-12-01
!
!  Copyright (C) 2010 IAU SOFA Board.  See notes at end.
!
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
      REAL*8 DATE1, DATE2, X(2), Y(2)
      REAL*8 CENT, DCENT, FA2K(14), FAD2K(14), XJD, CT
      REAL*8 TT, TT_CENT, DTT_CENT
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!  Arcseconds to radians
      REAL*8            DAS2R
      PARAMETER ( DAS2R = 4.848136811095359935899141D-6 )
!
!  Microarcseconds to radians
      REAL*8            UAS2R
      PARAMETER ( UAS2R = DAS2R*1D-6 )
!
!  2Pi.
      REAL*8            D2PI
      PARAMETER ( D2PI = 6.283185307179586476925287D0 )
!
!  Reference epoch (J2000.0), JD
      REAL*8            DJ00
      PARAMETER ( DJ00 = 2451545D0 )
!
!  Days per Julian century
      REAL*8            DJC
      PARAMETER ( DJC = 36525D0 )
!
!  Maximum power of T in the polynomials for X and Y
      INTEGER MAXPT
      PARAMETER ( MAXPT = 5 )
!
!  Numbers of frequencies:  luni-solar, planetary, total
      INTEGER NFLS, NFPL, NF
      PARAMETER ( NFLS = 653, NFPL = 656, NF = NFLS+NFPL )
!
!  Number of amplitude coefficients
      INTEGER NA
      PARAMETER ( NA = 4755 )
!
!  Polynomial coefficients
      REAL*8            XYP(0:MAXPT,0:1)
!
!  Fundamental-argument multipliers:  luni-solar and planetary terms
      INTEGER MFALS(5,NFLS), MFAPL(14,NFPL)
!
!  Pointers into amplitudes array, one pointer per frequency
      INTEGER NC(NF)
!
!  Amplitude coefficients (microarcsec);  indexed using the NC array
      REAL*8            A(NA)
!
!  Amplitude usage
      INTEGER JAXY(0:MAXPT*4-1), JASC(0:MAXPT*4-1), JAPT(0:MAXPT*4-1)
!
!  Miscellaneous
      REAL*8  T, dTdt, W, PT(0:MAXPT), FA(14), XYPR(0:1), XYPL(0:1),    &
     &        XYLS(0:1), ARG, SC(0:1)
      REAL*8  d_PT(0:MAXPT), d_XYPR(0:1), d_XYPL(0:1),           &
     &        d_XYLS(0:1), d_ARG, d_SC(0:1)
      INTEGER JPT, I, J, JXY, IALAST, IFREQ, M, IA, JSC
!
!  Functions
!     REAL*8           iau_FAL03, iau_FALP03, iau_FAF03, iau_FAD03,     &
!    &                 iau_FAOM03, iau_FAME03, iau_FAVE03, iau_FAE03,   &
!    &                 iau_FAMA03, iau_FAJU03, iau_FASA03, iau_FAUR03,  &
!    &                 iau_FANE03, iau_FAPA03
!
!  Polynomial coefficients (arcsec).
      DATA ((XYP(I,JXY),I=0,MAXPT),JXY=0,1) /                           &
     &             -0.016617D0,                                    &
     &          +2004.191898D0,                                    &
     &             -0.4297829D0,                                    &
     &             -0.19861834D0,                                    &
     &             +0.000007578D0,                                    &
     &             +0.0000059285D0,                                    &
     &             -0.006951D0,                                    &
     &             -0.025896D0,                                    &
     &            -22.4072747D0,                                    &
     &             +0.00190059D0,                                    &
     &             +0.001112526D0,                                    &
     &             +0.0000001358D0 /
!
!  Fundamental-argument multipliers:  luni-solar terms.
      DATA ((MFALS(I,J),I=1,5),J=1,10) /                                &
     &   0,  0,  0,  0,  1,                                             &
     &   0,  0,  2, -2,  2,                                             &
     &   0,  0,  2,  0,  2,                                             &
     &   0,  0,  0,  0,  2,                                             &
     &   0,  1,  0,  0,  0,                                             &
     &   0,  1,  2, -2,  2,                                             &
     &   1,  0,  0,  0,  0,                                             &
     &   0,  0,  2,  0,  1,                                             &
     &   1,  0,  2,  0,  2,                                             &
     &   0,  1, -2,  2, -2 /
      DATA ((MFALS(I,J),I=1,5),J=11,20) /                               &
     &   0,  0,  2, -2,  1,                                             &
     &   1,  0, -2,  0, -2,                                             &
     &   1,  0,  0, -2,  0,                                             &
     &   1,  0,  0,  0,  1,                                             &
     &   1,  0,  0,  0, -1,                                             &
     &   1,  0, -2, -2, -2,                                             &
     &   1,  0,  2,  0,  1,                                             &
     &   2,  0, -2,  0, -1,                                             &
     &   0,  0,  0,  2,  0,                                             &
     &   0,  0,  2,  2,  2 /
      DATA ((MFALS(I,J),I=1,5),J=21,30) /                               &
     &   2,  0,  0, -2,  0,                                             &
     &   0,  2, -2,  2, -2,                                             &
     &   2,  0,  2,  0,  2,                                             &
     &   1,  0,  2, -2,  2,                                             &
     &   1,  0, -2,  0, -1,                                             &
     &   2,  0,  0,  0,  0,                                             &
     &   0,  0,  2,  0,  0,                                             &
     &   0,  1,  0,  0,  1,                                             &
     &   1,  0,  0, -2, -1,                                             &
     &   0,  2,  2, -2,  2 /
      DATA ((MFALS(I,J),I=1,5),J=31,40) /                               &
     &   0,  0,  2, -2,  0,                                             &
     &   1,  0,  0, -2,  1,                                             &
     &   0,  1,  0,  0, -1,                                             &
     &   0,  2,  0,  0,  0,                                             &
     &   1,  0, -2, -2, -1,                                             &
     &   1,  0,  2,  2,  2,                                             &
     &   0,  1,  2,  0,  2,                                             &
     &   2,  0, -2,  0,  0,                                             &
     &   0,  0,  2,  2,  1,                                             &
     &   0,  1, -2,  0, -2 /
      DATA ((MFALS(I,J),I=1,5),J=41,50) /                               &
     &   0,  0,  0,  2,  1,                                             &
     &   1,  0,  2, -2,  1,                                             &
     &   2,  0,  0, -2, -1,                                             &
     &   2,  0,  2, -2,  2,                                             &
     &   2,  0,  2,  0,  1,                                             &
     &   0,  0,  0,  2, -1,                                             &
     &   0,  1, -2,  2, -1,                                             &
     &   1,  1,  0, -2,  0,                                             &
     &   2,  0,  0, -2,  1,                                             &
     &   1,  0,  0,  2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=51,60) /                               &
     &   0,  1,  2, -2,  1,                                             &
     &   1, -1,  0,  0,  0,                                             &
     &   0,  1, -1,  1, -1,                                             &
     &   2,  0, -2,  0, -2,                                             &
     &   0,  1,  0, -2,  0,                                             &
     &   1,  0,  0, -1,  0,                                             &
     &   3,  0,  2,  0,  2,                                             &
     &   0,  0,  0,  1,  0,                                             &
     &   1, -1,  2,  0,  2,                                             &
     &   1,  1, -2, -2, -2 /
      DATA ((MFALS(I,J),I=1,5),J=61,70) /                               &
     &   1,  0, -2,  0,  0,                                             &
     &   2,  0,  0,  0, -1,                                             &
     &   0,  1, -2, -2, -2,                                             &
     &   1,  1,  2,  0,  2,                                             &
     &   2,  0,  0,  0,  1,                                             &
     &   1,  1,  0,  0,  0,                                             &
     &   1,  0, -2,  2, -1,                                             &
     &   1,  0,  2,  0,  0,                                             &
     &   1, -1,  0, -1,  0,                                             &
     &   1,  0,  0,  0,  2 /
      DATA ((MFALS(I,J),I=1,5),J=71,80) /                               &
     &   1,  0, -1,  0, -1,                                             &
     &   0,  0,  2,  1,  2,                                             &
     &   1,  0, -2, -4, -2,                                             &
     &   1, -1,  0, -1, -1,                                             &
     &   1,  0,  2,  2,  1,                                             &
     &   0,  2, -2,  2, -1,                                             &
     &   1,  0,  0,  0, -2,                                             &
     &   2,  0, -2, -2, -2,                                             &
     &   1,  1,  2, -2,  2,                                             &
     &   2,  0, -2, -4, -2 /
      DATA ((MFALS(I,J),I=1,5),J=81,90) /                               &
     &   1,  0, -4,  0, -2,                                             &
     &   2,  0,  2, -2,  1,                                             &
     &   1,  0,  0, -1, -1,                                             &
     &   2,  0,  2,  2,  2,                                             &
     &   3,  0,  0,  0,  0,                                             &
     &   1,  0,  0,  2,  1,                                             &
     &   0,  0,  2, -2, -1,                                             &
     &   3,  0,  2, -2,  2,                                             &
     &   0,  0,  4, -2,  2,                                             &
     &   1,  0,  0, -4,  0 /
      DATA ((MFALS(I,J),I=1,5),J=91,100) /                              &
     &   0,  1,  2,  0,  1,                                             &
     &   2,  0,  0, -4,  0,                                             &
     &   1,  1,  0, -2, -1,                                             &
     &   2,  0, -2,  0,  1,                                             &
     &   0,  0,  2,  0, -1,                                             &
     &   0,  1, -2,  0, -1,                                             &
     &   0,  1,  0,  0,  2,                                             &
     &   0,  0,  2, -1,  2,                                             &
     &   0,  0,  2,  4,  2,                                             &
     &   2,  1,  0, -2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=101,110) /                             &
     &   1,  1,  0, -2,  1,                                             &
     &   1, -1,  0, -2,  0,                                             &
     &   1, -1,  0, -1, -2,                                             &
     &   1, -1,  0,  0,  1,                                             &
     &   0,  1, -2,  2,  0,                                             &
     &   0,  1,  0,  0, -2,                                             &
     &   1, -1,  2,  2,  2,                                             &
     &   1,  0,  0,  2, -1,                                             &
     &   1, -1, -2, -2, -2,                                             &
     &   3,  0,  2,  0,  1 /
      DATA ((MFALS(I,J),I=1,5),J=111,120) /                             &
     &   0,  1,  2,  2,  2,                                             &
     &   1,  0,  2, -2,  0,                                             &
     &   1,  1, -2, -2, -1,                                             &
     &   1,  0,  2, -4,  1,                                             &
     &   0,  1, -2, -2, -1,                                             &
     &   2, -1,  2,  0,  2,                                             &
     &   0,  0,  0,  2,  2,                                             &
     &   1, -1,  2,  0,  1,                                             &
     &   1, -1, -2,  0, -2,                                             &
     &   0,  1,  0,  2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=121,130) /                             &
     &   0,  1,  2, -2,  0,                                             &
     &   0,  0,  0,  1,  1,                                             &
     &   1,  0, -2, -2,  0,                                             &
     &   0,  3,  2, -2,  2,                                             &
     &   2,  1,  2,  0,  2,                                             &
     &   1,  1,  0,  0,  1,                                             &
     &   2,  0,  0,  2,  0,                                             &
     &   1,  1,  2,  0,  1,                                             &
     &   1,  0,  0, -2, -2,                                             &
     &   1,  0, -2,  2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=131,140) /                             &
     &   1,  0, -1,  0, -2,                                             &
     &   0,  1,  0, -2,  1,                                             &
     &   0,  1,  0,  1,  0,                                             &
     &   0,  0,  0,  1, -1,                                             &
     &   1,  0, -2,  2, -2,                                             &
     &   1, -1,  0,  0, -1,                                             &
     &   0,  0,  0,  4,  0,                                             &
     &   1, -1,  0,  2,  0,                                             &
     &   1,  0,  2,  1,  2,                                             &
     &   1,  0,  2, -1,  2 /
      DATA ((MFALS(I,J),I=1,5),J=141,150) /                             &
     &   0,  0,  2,  1,  1,                                             &
     &   1,  0,  0, -2,  2,                                             &
     &   1,  0, -2,  0,  1,                                             &
     &   1,  0, -2, -4, -1,                                             &
     &   0,  0,  2,  2,  0,                                             &
     &   1,  1,  2, -2,  1,                                             &
     &   1,  0, -2,  1, -1,                                             &
     &   0,  0,  1,  0,  1,                                             &
     &   2,  0, -2, -2, -1,                                             &
     &   4,  0,  2,  0,  2 /
      DATA ((MFALS(I,J),I=1,5),J=151,160) /                             &
     &   2, -1,  0,  0,  0,                                             &
     &   2,  1,  2, -2,  2,                                             &
     &   0,  1,  2,  1,  2,                                             &
     &   1,  0,  4, -2,  2,                                             &
     &   1,  1,  0,  0, -1,                                             &
     &   2,  0,  2,  0,  0,                                             &
     &   2,  0, -2, -4, -1,                                             &
     &   1,  0, -1,  0,  0,                                             &
     &   1,  0,  0,  1,  0,                                             &
     &   0,  1,  0,  2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=161,170) /                             &
     &   1,  0, -4,  0, -1,                                             &
     &   1,  0,  0, -4, -1,                                             &
     &   2,  0,  2,  2,  1,                                             &
     &   2,  1,  0,  0,  0,                                             &
     &   0,  0,  2, -3,  2,                                             &
     &   1,  2,  0, -2,  0,                                             &
     &   0,  3,  0,  0,  0,                                             &
     &   0,  0,  4,  0,  2,                                             &
     &   0,  0,  2, -4,  1,                                             &
     &   2,  0,  0, -2, -2 /
      DATA ((MFALS(I,J),I=1,5),J=171,180) /                             &
     &   1,  1, -2, -4, -2,                                             &
     &   0,  1,  0, -2, -1,                                             &
     &   0,  0,  0,  4,  1,                                             &
     &   3,  0,  2, -2,  1,                                             &
     &   1,  0,  2,  4,  2,                                             &
     &   1,  1, -2,  0, -2,                                             &
     &   0,  0,  4, -2,  1,                                             &
     &   2, -2,  0, -2,  0,                                             &
     &   2,  1,  0, -2, -1,                                             &
     &   0,  2,  0, -2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=181,190) /                             &
     &   1,  0,  0, -1,  1,                                             &
     &   1,  1,  2,  2,  2,                                             &
     &   3,  0,  0,  0, -1,                                             &
     &   2,  0,  0, -4, -1,                                             &
     &   3,  0,  2,  2,  2,                                             &
     &   0,  0,  2,  4,  1,                                             &
     &   0,  2, -2, -2, -2,                                             &
     &   1, -1,  0, -2, -1,                                             &
     &   0,  0,  2, -1,  1,                                             &
     &   2,  0,  0,  2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=191,200) /                             &
     &   1, -1, -2,  2, -1,                                             &
     &   0,  0,  0,  2, -2,                                             &
     &   2,  0,  0, -4,  1,                                             &
     &   1,  0,  0, -4,  1,                                             &
     &   2,  0,  2, -4,  1,                                             &
     &   4,  0,  2, -2,  2,                                             &
     &   2,  1, -2,  0, -1,                                             &
     &   2,  1, -2, -4, -2,                                             &
     &   3,  0,  0, -4,  0,                                             &
     &   1, -1,  2,  2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=201,210) /                             &
     &   1, -1, -2,  0, -1,                                             &
     &   0,  2,  0,  0,  1,                                             &
     &   1,  2, -2, -2, -2,                                             &
     &   1,  1,  0, -4,  0,                                             &
     &   2,  0,  0, -2,  2,                                             &
     &   0,  2,  2, -2,  1,                                             &
     &   1,  0,  2,  0, -1,                                             &
     &   2,  1,  0, -2,  1,                                             &
     &   2, -1, -2,  0, -1,                                             &
     &   1, -1, -2, -2, -1 /
      DATA ((MFALS(I,J),I=1,5),J=211,220) /                             &
     &   0,  1, -2,  1, -2,                                             &
     &   1,  0, -4,  2, -2,                                             &
     &   0,  1,  2,  2,  1,                                             &
     &   3,  0,  0,  0,  1,                                             &
     &   2, -1,  2,  2,  2,                                             &
     &   0,  1, -2, -4, -2,                                             &
     &   1,  0, -2, -3, -2,                                             &
     &   2,  0,  0,  0,  2,                                             &
     &   1, -1,  0, -2, -2,                                             &
     &   2,  0, -2,  2, -1 /
      DATA ((MFALS(I,J),I=1,5),J=221,230) /                             &
     &   0,  2, -2,  0, -2,                                             &
     &   3,  0, -2,  0, -1,                                             &
     &   2, -1,  2,  0,  1,                                             &
     &   1,  0, -2, -1, -2,                                             &
     &   0,  0,  2,  0,  3,                                             &
     &   2,  0, -4,  0, -2,                                             &
     &   2,  1,  0, -4,  0,                                             &
     &   1,  1, -2,  1, -1,                                             &
     &   0,  2,  2,  0,  2,                                             &
     &   1, -1,  2, -2,  2 /
      DATA ((MFALS(I,J),I=1,5),J=231,240) /                             &
     &   1, -1,  0, -2,  1,                                             &
     &   2,  1,  2,  0,  1,                                             &
     &   1,  0,  2, -4,  2,                                             &
     &   1,  1, -2,  0, -1,                                             &
     &   1,  1,  0,  2,  0,                                             &
     &   1,  0,  0, -3,  0,                                             &
     &   2,  0,  2, -1,  2,                                             &
     &   0,  2,  0,  0, -1,                                             &
     &   2, -1,  0, -2,  0,                                             &
     &   4,  0,  0,  0,  0 /
      DATA ((MFALS(I,J),I=1,5),J=241,250) /                             &
     &   2,  1, -2, -2, -2,                                             &
     &   0,  2, -2,  2,  0,                                             &
     &   1,  0,  2,  1,  1,                                             &
     &   1,  0, -1,  0, -3,                                             &
     &   3, -1,  2,  0,  2,                                             &
     &   2,  0,  2, -2,  0,                                             &
     &   1, -2,  0,  0,  0,                                             &
     &   2,  0,  0,  0, -2,                                             &
     &   1,  0,  0,  4,  0,                                             &
     &   0,  1,  0,  1,  1 /
      DATA ((MFALS(I,J),I=1,5),J=251,260) /                             &
     &   1,  0,  2,  2,  0,                                             &
     &   0,  1,  0,  2, -1,                                             &
     &   0,  1,  0,  1, -1,                                             &
     &   0,  0,  2, -2,  3,                                             &
     &   3,  1,  2,  0,  2,                                             &
     &   1,  1,  2,  1,  2,                                             &
     &   1,  1, -2,  2, -1,                                             &
     &   2, -1,  2, -2,  2,                                             &
     &   1, -2,  2,  0,  2,                                             &
     &   1,  0,  2, -4,  0 /
      DATA ((MFALS(I,J),I=1,5),J=261,270) /                             &
     &   0,  0,  1,  0,  0,                                             &
     &   1,  0,  2, -3,  1,                                             &
     &   1, -2,  0, -2,  0,                                             &
     &   2,  0,  0,  2, -1,                                             &
     &   1,  1,  2, -4,  1,                                             &
     &   4,  0,  2,  0,  1,                                             &
     &   0,  1,  2,  1,  1,                                             &
     &   1,  2,  2, -2,  2,                                             &
     &   2,  0,  2,  1,  2,                                             &
     &   2,  1,  2, -2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=271,280) /                             &
     &   1,  0,  2, -1,  1,                                             &
     &   1,  0,  4, -2,  1,                                             &
     &   1, -1,  2, -2,  1,                                             &
     &   0,  1,  0, -4,  0,                                             &
     &   3,  0, -2, -2, -2,                                             &
     &   0,  0,  4, -4,  2,                                             &
     &   2,  0, -4, -2, -2,                                             &
     &   2, -2,  0, -2, -1,                                             &
     &   1,  0,  2, -2, -1,                                             &
     &   2,  0, -2, -6, -2 /
      DATA ((MFALS(I,J),I=1,5),J=281,290) /                             &
     &   1,  0, -2,  1, -2,                                             &
     &   1,  0, -2,  2,  1,                                             &
     &   1, -1,  0,  2, -1,                                             &
     &   1,  0, -2,  1,  0,                                             &
     &   2, -1,  0, -2,  1,                                             &
     &   1, -1,  0,  2,  1,                                             &
     &   2,  0, -2, -2,  0,                                             &
     &   1,  0,  2, -3,  2,                                             &
     &   0,  0,  0,  4, -1,                                             &
     &   2, -1,  0,  0,  1 /
      DATA ((MFALS(I,J),I=1,5),J=291,300) /                             &
     &   2,  0,  4, -2,  2,                                             &
     &   0,  0,  2,  3,  2,                                             &
     &   0,  1,  4, -2,  2,                                             &
     &   0,  1, -2,  2,  1,                                             &
     &   1,  1,  0,  2,  1,                                             &
     &   1,  0,  0,  4,  1,                                             &
     &   0,  0,  4,  0,  1,                                             &
     &   2,  0,  0, -3,  0,                                             &
     &   1,  0,  0, -1, -2,                                             &
     &   1, -2, -2, -2, -2 /
      DATA ((MFALS(I,J),I=1,5),J=301,310) /                             &
     &   3,  0,  0,  2,  0,                                             &
     &   2,  0,  2, -4,  2,                                             &
     &   1,  1, -2, -4, -1,                                             &
     &   1,  0, -2, -6, -2,                                             &
     &   2, -1,  0,  0, -1,                                             &
     &   2, -1,  0,  2,  0,                                             &
     &   0,  1,  2, -2, -1,                                             &
     &   1,  1,  0,  1,  0,                                             &
     &   1,  2,  0, -2, -1,                                             &
     &   1,  0,  0,  1, -1 /
      DATA ((MFALS(I,J),I=1,5),J=311,320) /                             &
     &   0,  0,  1,  0,  2,                                             &
     &   3,  1,  2, -2,  2,                                             &
     &   1,  0, -4, -2, -2,                                             &
     &   1,  0,  2,  4,  1,                                             &
     &   1, -2,  2,  2,  2,                                             &
     &   1, -1, -2, -4, -2,                                             &
     &   0,  0,  2, -4,  2,                                             &
     &   0,  0,  2, -3,  1,                                             &
     &   2,  1, -2,  0,  0,                                             &
     &   3,  0, -2, -2, -1 /
      DATA ((MFALS(I,J),I=1,5),J=321,330) /                             &
     &   2,  0,  2,  4,  2,                                             &
     &   0,  0,  0,  0,  3,                                             &
     &   2, -1, -2, -2, -2,                                             &
     &   2,  0,  0, -1,  0,                                             &
     &   3,  0,  2, -4,  2,                                             &
     &   2,  1,  2,  2,  2,                                             &
     &   0,  0,  3,  0,  3,                                             &
     &   1,  1,  2,  2,  1,                                             &
     &   2,  1,  0,  0, -1,                                             &
     &   1,  2,  0, -2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=331,340) /                             &
     &   3,  0,  2,  2,  1,                                             &
     &   1, -1, -2,  2, -2,                                             &
     &   1,  1,  0, -1,  0,                                             &
     &   1,  2,  0,  0,  0,                                             &
     &   1,  0,  4,  0,  2,                                             &
     &   1, -1,  2,  4,  2,                                             &
     &   2,  1,  0,  0,  1,                                             &
     &   1,  0,  0,  2,  2,                                             &
     &   1, -1, -2,  2,  0,                                             &
     &   0,  2, -2, -2, -1 /
      DATA ((MFALS(I,J),I=1,5),J=341,350) /                             &
     &   2,  0, -2,  0,  2,                                             &
     &   5,  0,  2,  0,  2,                                             &
     &   3,  0, -2, -6, -2,                                             &
     &   1, -1,  2, -1,  2,                                             &
     &   3,  0,  0, -4, -1,                                             &
     &   1,  0,  0,  1,  1,                                             &
     &   1,  0, -4,  2, -1,                                             &
     &   0,  1,  2, -4,  1,                                             &
     &   1,  2,  2,  0,  2,                                             &
     &   0,  1,  0, -2, -2 /
      DATA ((MFALS(I,J),I=1,5),J=351,360) /                             &
     &   0,  0,  2, -1,  0,                                             &
     &   1,  0,  1,  0,  1,                                             &
     &   0,  2,  0, -2,  1,                                             &
     &   3,  0,  2,  0,  0,                                             &
     &   1,  1, -2,  1,  0,                                             &
     &   2,  1, -2, -4, -1,                                             &
     &   3, -1,  0,  0,  0,                                             &
     &   2, -1, -2,  0,  0,                                             &
     &   4,  0,  2, -2,  1,                                             &
     &   2,  0, -2,  2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=361,370) /                             &
     &   1,  1,  2, -2,  0,                                             &
     &   1,  0, -2,  4, -1,                                             &
     &   1,  0, -2, -2,  1,                                             &
     &   2,  0,  2, -4,  0,                                             &
     &   1,  1,  0, -2, -2,                                             &
     &   1,  1, -2, -2,  0,                                             &
     &   1,  0,  1, -2,  1,                                             &
     &   2, -1, -2, -4, -2,                                             &
     &   3,  0, -2,  0, -2,                                             &
     &   0,  1, -2, -2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=371,380) /                             &
     &   3,  0,  0, -2, -1,                                             &
     &   1,  0, -2, -3, -1,                                             &
     &   0,  1,  0, -4, -1,                                             &
     &   1, -2,  2, -2,  1,                                             &
     &   0,  1, -2,  1, -1,                                             &
     &   1, -1,  0,  0,  2,                                             &
     &   2,  0,  0,  1,  0,                                             &
     &   1, -2,  0,  2,  0,                                             &
     &   1,  2, -2, -2, -1,                                             &
     &   0,  0,  4, -4,  1 /
      DATA ((MFALS(I,J),I=1,5),J=381,390) /                             &
     &   0,  1,  2,  4,  2,                                             &
     &   0,  1, -4,  2, -2,                                             &
     &   3,  0, -2,  0,  0,                                             &
     &   2, -1,  2,  2,  1,                                             &
     &   0,  1, -2, -4, -1,                                             &
     &   4,  0,  2,  2,  2,                                             &
     &   2,  0, -2, -3, -2,                                             &
     &   2,  0,  0, -6,  0,                                             &
     &   1,  0,  2,  0,  3,                                             &
     &   3,  1,  0,  0,  0 /
      DATA ((MFALS(I,J),I=1,5),J=391,400) /                             &
     &   3,  0,  0, -4,  1,                                             &
     &   1, -1,  2,  0,  0,                                             &
     &   1, -1,  0, -4,  0,                                             &
     &   2,  0, -2,  2, -2,                                             &
     &   1,  1,  0, -2,  2,                                             &
     &   4,  0,  0, -2,  0,                                             &
     &   2,  2,  0, -2,  0,                                             &
     &   0,  1,  2,  0,  0,                                             &
     &   1,  1,  0, -4,  1,                                             &
     &   1,  0,  0, -4, -2 /
      DATA ((MFALS(I,J),I=1,5),J=401,410) /                             &
     &   0,  0,  0,  1,  2,                                             &
     &   3,  0,  0,  2,  1,                                             &
     &   1,  1,  0, -4, -1,                                             &
     &   0,  0,  2,  2, -1,                                             &
     &   1,  1,  2,  0,  0,                                             &
     &   1, -1,  2, -4,  1,                                             &
     &   1,  1,  0,  0,  2,                                             &
     &   0,  0,  2,  6,  2,                                             &
     &   4,  0, -2, -2, -1,                                             &
     &   2,  1,  0, -4, -1 /
      DATA ((MFALS(I,J),I=1,5),J=411,420) /                             &
     &   0,  0,  0,  3,  1,                                             &
     &   1, -1, -2,  0,  0,                                             &
     &   0,  0,  2,  1,  0,                                             &
     &   1,  0,  0,  2, -2,                                             &
     &   3, -1,  2,  2,  2,                                             &
     &   3, -1,  2, -2,  2,                                             &
     &   1,  0,  0, -1,  2,                                             &
     &   1, -2,  2, -2,  2,                                             &
     &   0,  1,  0,  2,  2,                                             &
     &   0,  1, -2, -1, -2 /
      DATA ((MFALS(I,J),I=1,5),J=421,430) /                             &
     &   1,  1, -2,  0,  0,                                             &
     &   0,  2,  2, -2,  0,                                             &
     &   3, -1, -2, -1, -2,                                             &
     &   1,  0,  0, -6,  0,                                             &
     &   1,  0, -2, -4,  0,                                             &
     &   2,  1,  0, -4,  1,                                             &
     &   2,  0,  2,  0, -1,                                             &
     &   2,  0, -4,  0, -1,                                             &
     &   0,  0,  3,  0,  2,                                             &
     &   2,  1, -2, -2, -1 /
      DATA ((MFALS(I,J),I=1,5),J=431,440) /                             &
     &   1, -2,  0,  0,  1,                                             &
     &   2, -1,  0, -4,  0,                                             &
     &   0,  0,  0,  3,  0,                                             &
     &   5,  0,  2, -2,  2,                                             &
     &   1,  2, -2, -4, -2,                                             &
     &   1,  0,  4, -4,  2,                                             &
     &   0,  0,  4, -1,  2,                                             &
     &   3,  1,  0, -4,  0,                                             &
     &   3,  0,  0, -6,  0,                                             &
     &   2,  0,  0,  2,  2 /
      DATA ((MFALS(I,J),I=1,5),J=441,450) /                             &
     &   2, -2,  2,  0,  2,                                             &
     &   1,  0,  0, -3,  1,                                             &
     &   1, -2, -2,  0, -2,                                             &
     &   1, -1, -2, -3, -2,                                             &
     &   0,  0,  2, -2, -2,                                             &
     &   2,  0, -2, -4,  0,                                             &
     &   1,  0, -4,  0,  0,                                             &
     &   0,  1,  0, -1,  0,                                             &
     &   4,  0,  0,  0, -1,                                             &
     &   3,  0,  2, -1,  2 /
      DATA ((MFALS(I,J),I=1,5),J=451,460) /                             &
     &   3, -1,  2,  0,  1,                                             &
     &   2,  0,  2, -1,  1,                                             &
     &   1,  2,  2, -2,  1,                                             &
     &   1,  1,  0,  2, -1,                                             &
     &   0,  2,  2,  0,  1,                                             &
     &   3,  1,  2,  0,  1,                                             &
     &   1,  1,  2,  1,  1,                                             &
     &   1,  1,  0, -1,  1,                                             &
     &   1, -2,  0, -2, -1,                                             &
     &   4,  0,  0, -4,  0 /
      DATA ((MFALS(I,J),I=1,5),J=461,470) /                             &
     &   2,  1,  0,  2,  0,                                             &
     &   1, -1,  0,  4,  0,                                             &
     &   0,  1,  0, -2,  2,                                             &
     &   0,  0,  2,  0, -2,                                             &
     &   1,  0, -1,  0,  1,                                             &
     &   3,  0,  2, -2,  0,                                             &
     &   2,  0,  2,  2,  0,                                             &
     &   1,  2,  0, -4,  0,                                             &
     &   1, -1,  0, -3,  0,                                             &
     &   0,  1,  0,  4,  0 /
      DATA ((MFALS(I,J),I=1,5),J=471,480) /                             &
     &   0,  1, -2,  0,  0,                                             &
     &   2,  2,  2, -2,  2,                                             &
     &   0,  0,  0,  1, -2,                                             &
     &   0,  2, -2,  0, -1,                                             &
     &   4,  0,  2, -4,  2,                                             &
     &   2,  0, -4,  2, -2,                                             &
     &   2, -1, -2,  0, -2,                                             &
     &   1,  1,  4, -2,  2,                                             &
     &   1,  1,  2, -4,  2,                                             &
     &   1,  0,  2,  3,  2 /
      DATA ((MFALS(I,J),I=1,5),J=481,490) /                             &
     &   1,  0,  0,  4, -1,                                             &
     &   0,  0,  0,  4,  2,                                             &
     &   2,  0,  0,  4,  0,                                             &
     &   1,  1, -2,  2,  0,                                             &
     &   2,  1,  2,  1,  2,                                             &
     &   2,  1,  2, -4,  1,                                             &
     &   2,  0,  2,  1,  1,                                             &
     &   2,  0, -4, -2, -1,                                             &
     &   2,  0, -2, -6, -1,                                             &
     &   2, -1,  2, -1,  2 /
      DATA ((MFALS(I,J),I=1,5),J=491,500) /                             &
     &   1, -2,  2,  0,  1,                                             &
     &   1, -2,  0, -2,  1,                                             &
     &   1, -1,  0, -4, -1,                                             &
     &   0,  2,  2,  2,  2,                                             &
     &   0,  2, -2, -4, -2,                                             &
     &   0,  1,  2,  3,  2,                                             &
     &   0,  1,  0, -4,  1,                                             &
     &   3,  0,  0, -2,  1,                                             &
     &   2,  1, -2,  0,  1,                                             &
     &   2,  0,  4, -2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=501,510) /                             &
     &   2,  0,  0, -3, -1,                                             &
     &   2, -2,  0, -2,  1,                                             &
     &   2, -1,  2, -2,  1,                                             &
     &   1,  0,  0, -6, -1,                                             &
     &   1, -2,  0,  0, -1,                                             &
     &   1, -2, -2, -2, -1,                                             &
     &   0,  1,  4, -2,  1,                                             &
     &   0,  0,  2,  3,  1,                                             &
     &   2, -1,  0, -1,  0,                                             &
     &   1,  3,  0, -2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=511,520) /                             &
     &   0,  3,  0, -2,  0,                                             &
     &   2, -2,  2, -2,  2,                                             &
     &   0,  0,  4, -2,  0,                                             &
     &   4, -1,  2,  0,  2,                                             &
     &   2,  2, -2, -4, -2,                                             &
     &   4,  1,  2,  0,  2,                                             &
     &   4, -1, -2, -2, -2,                                             &
     &   2,  1,  0, -2, -2,                                             &
     &   2,  1, -2, -6, -2,                                             &
     &   2,  0,  0, -1,  1 /
      DATA ((MFALS(I,J),I=1,5),J=521,530) /                             &
     &   2, -1, -2,  2, -1,                                             &
     &   1,  1, -2,  2, -2,                                             &
     &   1,  1, -2, -3, -2,                                             &
     &   1,  0,  3,  0,  3,                                             &
     &   1,  0, -2,  1,  1,                                             &
     &   1,  0, -2,  0,  2,                                             &
     &   1, -1,  2,  1,  2,                                             &
     &   1, -1,  0,  0, -2,                                             &
     &   1, -1, -4,  2, -2,                                             &
     &   0,  3, -2, -2, -2 /
      DATA ((MFALS(I,J),I=1,5),J=531,540) /                             &
     &   0,  1,  0,  4,  1,                                             &
     &   0,  0,  4,  2,  2,                                             &
     &   3,  0, -2, -2,  0,                                             &
     &   2, -2,  0,  0,  0,                                             &
     &   1,  1,  2, -4,  0,                                             &
     &   1,  1,  0, -3,  0,                                             &
     &   1,  0,  2, -3,  0,                                             &
     &   1, -1,  2, -2,  0,                                             &
     &   0,  2,  0,  2,  0,                                             &
     &   0,  0,  2,  4,  0 /
      DATA ((MFALS(I,J),I=1,5),J=541,550) /                             &
     &   1,  0,  1,  0,  0,                                             &
     &   3,  1,  2, -2,  1,                                             &
     &   3,  0,  4, -2,  2,                                             &
     &   3,  0,  2,  1,  2,                                             &
     &   3,  0,  0,  2, -1,                                             &
     &   3,  0,  0,  0,  2,                                             &
     &   3,  0, -2,  2, -1,                                             &
     &   2,  0,  4, -4,  2,                                             &
     &   2,  0,  2, -3,  2,                                             &
     &   2,  0,  0,  4,  1 /
      DATA ((MFALS(I,J),I=1,5),J=551,560) /                             &
     &   2,  0,  0, -3,  1,                                             &
     &   2,  0, -4,  2, -1,                                             &
     &   2,  0, -2, -2,  1,                                             &
     &   2, -2,  2,  2,  2,                                             &
     &   2, -2,  0, -2, -2,                                             &
     &   2, -1,  0,  2,  1,                                             &
     &   2, -1,  0,  2, -1,                                             &
     &   1,  1,  2,  4,  2,                                             &
     &   1,  1,  0,  1,  1,                                             &
     &   1,  1,  0,  1, -1 /
      DATA ((MFALS(I,J),I=1,5),J=561,570) /                             &
     &   1,  1, -2, -6, -2,                                             &
     &   1,  0,  0, -3, -1,                                             &
     &   1,  0, -4, -2, -1,                                             &
     &   1,  0, -2, -6, -1,                                             &
     &   1, -2,  2,  2,  1,                                             &
     &   1, -2, -2,  2, -1,                                             &
     &   1, -1, -2, -4, -1,                                             &
     &   0,  2,  0,  0,  2,                                             &
     &   0,  1,  2, -4,  2,                                             &
     &   0,  1, -2,  4, -1 /
      DATA ((MFALS(I,J),I=1,5),J=571,580) /                             &
     &   5,  0,  0,  0,  0,                                             &
     &   3,  0,  0, -3,  0,                                             &
     &   2,  2,  0, -4,  0,                                             &
     &   1, -1,  2,  2,  0,                                             &
     &   0,  1,  0,  3,  0,                                             &
     &   4,  0, -2,  0, -1,                                             &
     &   3,  0, -2, -6, -1,                                             &
     &   3,  0, -2, -1, -1,                                             &
     &   2,  1,  2,  2,  1,                                             &
     &   2,  1,  0,  2,  1 /
      DATA ((MFALS(I,J),I=1,5),J=581,590) /                             &
     &   2,  0,  2,  4,  1,                                             &
     &   2,  0,  2, -6,  1,                                             &
     &   2,  0,  2, -2, -1,                                             &
     &   2,  0,  0, -6, -1,                                             &
     &   2, -1, -2, -2, -1,                                             &
     &   1,  2,  2,  0,  1,                                             &
     &   1,  2,  0,  0,  1,                                             &
     &   1,  0,  4,  0,  1,                                             &
     &   1,  0,  2, -6,  1,                                             &
     &   1,  0,  2, -4, -1 /
      DATA ((MFALS(I,J),I=1,5),J=591,600) /                             &
     &   1,  0, -1, -2, -1,                                             &
     &   1, -1,  2,  4,  1,                                             &
     &   1, -1,  2, -3,  1,                                             &
     &   1, -1,  0,  4,  1,                                             &
     &   1, -1, -2,  1, -1,                                             &
     &   0,  1,  2, -2,  3,                                             &
     &   3,  0,  0, -2,  0,                                             &
     &   1,  0,  1, -2,  0,                                             &
     &   0,  2,  0, -4,  0,                                             &
     &   0,  0,  2, -4,  0 /
      DATA ((MFALS(I,J),I=1,5),J=601,610) /                             &
     &   0,  0,  1, -1,  0,                                             &
     &   0,  0,  0,  6,  0,                                             &
     &   0,  2,  0,  0, -2,                                             &
     &   0,  1, -2,  2, -3,                                             &
     &   4,  0,  0,  2,  0,                                             &
     &   3,  0,  0, -1,  0,                                             &
     &   3, -1,  0,  2,  0,                                             &
     &   2,  1,  0,  1,  0,                                             &
     &   2,  1,  0, -6,  0,                                             &
     &   2, -1,  2,  0,  0 /
      DATA ((MFALS(I,J),I=1,5),J=611,620) /                             &
     &   1,  0,  2, -1,  0,                                             &
     &   1, -1,  0,  1,  0,                                             &
     &   1, -1, -2, -2,  0,                                             &
     &   0,  1,  2,  2,  0,                                             &
     &   0,  0,  2, -3,  0,                                             &
     &   2,  2,  0, -2, -1,                                             &
     &   2, -1, -2,  0,  1,                                             &
     &   1,  2,  2, -4,  1,                                             &
     &   0,  1,  4, -4,  2,                                             &
     &   0,  0,  0,  3,  2 /
      DATA ((MFALS(I,J),I=1,5),J=621,630) /                             &
     &   5,  0,  2,  0,  1,                                             &
     &   4,  1,  2, -2,  2,                                             &
     &   4,  0, -2, -2,  0,                                             &
     &   3,  1,  2,  2,  2,                                             &
     &   3,  1,  0, -2,  0,                                             &
     &   3,  1, -2, -6, -2,                                             &
     &   3,  0,  0,  0, -2,                                             &
     &   3,  0, -2, -4, -2,                                             &
     &   3, -1,  0, -3,  0,                                             &
     &   3, -1,  0, -2,  0 /
      DATA ((MFALS(I,J),I=1,5),J=631,640) /                             &
     &   2,  1,  2,  0,  0,                                             &
     &   2,  1,  2, -4,  2,                                             &
     &   2,  1,  2, -2,  0,                                             &
     &   2,  1,  0, -3,  0,                                             &
     &   2,  1, -2,  0, -2,                                             &
     &   2,  0,  0, -4,  2,                                             &
     &   2,  0,  0, -4, -2,                                             &
     &   2,  0, -2, -5, -2,                                             &
     &   2, -1,  2,  4,  2,                                             &
     &   2, -1,  0, -2,  2 /
      DATA ((MFALS(I,J),I=1,5),J=641,650) /                             &
     &   1,  3, -2, -2, -2,                                             &
     &   1,  1,  0,  0, -2,                                             &
     &   1,  1,  0, -6,  0,                                             &
     &   1,  1, -2,  1, -2,                                             &
     &   1,  1, -2, -1, -2,                                             &
     &   1,  0,  2,  1,  0,                                             &
     &   1,  0,  0,  3,  0,                                             &
     &   1,  0,  0, -4,  2,                                             &
     &   1,  0, -2,  4, -2,                                             &
     &   1, -2,  0, -1,  0 /
      DATA ((MFALS(I,J),I=1,5),J=651,NFLS) /                            &
     &   0,  1, -4,  2, -1,                                             &
     &   1,  0, -2,  0, -3,                                             &
     &   0,  0,  4, -4,  4 /
!
!  Fundamental-argument multipliers:  planetary terms.
      DATA ((MFAPL(I,J),I=1,14),J=1,10) /                               &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -1,  2,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=11,20) /                              &
     &   0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  2, -5,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -8,  3,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6, -8,  3,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=21,30) /                              &
     &   0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  1, -1,  1,  0,  0,  0, -2,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=31,40) /                              &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  1,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -1,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=41,50) /                              &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  0,  0,  0,  0, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4,  0, -2,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  2,         &
     &   1,  0,  0,  0,  0,  0,-18, 16,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  1,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=51,60) /                              &
     &   0,  0,  1, -1,  1,  0, -5,  7,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,-10,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  0,  0, -5,  6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  2,         &
     &   1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1,         &
     &   1,  0, -2,  0, -2,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  2,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=61,70) /                              &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0, -2,         &
     &   0,  0,  1, -1,  1,  0,  0,  3, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=71,80) /                              &
     &   0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  2,         &
     &   0,  0,  1, -1,  1,  0,  0, -5,  8, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=81,90) /                              &
     &   2,  0,  0, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -1,         &
     &   2,  0,  0, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  8,-13,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  0,  0, -2,  5,  0,  0,  0,         &
     &   1,  0,  0, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  2,         &
     &   1,  0,  0,  0, -1,  0,-18, 16,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  0,  0,  2, -5,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  0,  0,  1,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=91,100) /                             &
     &   1,  0,  0, -2,  0,  0, 19,-21,  3,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -8, 13,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  1,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  2,         &
     &   1,  0,  0,  0,  1,  0,-18, 16,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,-16,  4,  5,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  3, -7,  0,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=101,110) /                            &
     &   0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  1,         &
     &   2,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2, -1,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  2,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=111,120) /                            &
     &   0,  0,  0,  0,  1,  0,  0,  1, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  2,         &
     &   0,  0,  2, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0, -1,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0, -6,  8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=121,130) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -1,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8,-10,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, -2,         &
     &   1,  0,  0, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=131,140) /                            &
     &   0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4,  0, -3,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  1,  0,  2, -3,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=141,150) /                            &
     &   1,  0,  0, -1,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  9,-11,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -4,  5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4,  0, -1,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=151,160) /                            &
     &   1,  0,  0, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0, -4, 10,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0,  0, -1,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -2,         &
     &   0,  0,  2, -2,  1,  0, -4,  4,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=161,170) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -1,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  2,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  2,  0,         &
     &   0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -9, 13,  0,  0,  0,  0,  0,         &
     &   2,  0,  2,  0,  2,  0,  0,  2,  0, -3,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=171,180) /                            &
     &   0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  2,  0,  0,  0,         &
     &   1,  0,  0, -1, -1,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  1,         &
     &   1,  0,  2,  0,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   1,  0, -2,  0, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -2,  4,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=181,190) /                            &
     &   0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -8,  3,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  7, -8,  3,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0, -5,  7,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  1 /
      DATA ((MFAPL(I,J),I=1,14),J=191,200) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7,-10,  0,  0,  0,  0,  0, -2,         &
     &   1,  0,  0, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  2, -5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  1, -1,  1,  0,  0, -9, 15,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -1,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=201,210) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -1,  0,  0,  2,         &
     &   2,  0,  0, -2,  1,  0, -6,  8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  1, -1,  1,  0,  3, -6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  8,-14,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=211,220) /                            &
     &   0,  0,  0,  0,  1,  0,  0,  8,-15,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1,  0,  0,  2,         &
     &   2,  0, -1, -1,  0,  0,  0,  3, -7,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=221,230) /                            &
     &   2,  0,  0, -2,  0,  0,  0, -6,  8,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  0, -5,  6,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  0,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -9,  4,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=231,240) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -4,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  1,         &
     &   0,  0,  0,  0,  0,  0,  7,-11,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  3, -5,  4,  0,  0,  0,  0,  2,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0, -1,  1,  0,  0,  0,         &
     &   2,  0,  0,  0,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  2,  0,  0, -2,  2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0, -1 /
      DATA ((MFAPL(I,J),I=1,14),J=241,250) /                            &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  1,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  2, -4,  0, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  3, -5,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  2,         &
     &   0,  0,  2, -2,  2,  0, -8, 11,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -2,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=251,260) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0, -2, -2, -2,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  1 /
      DATA ((MFAPL(I,J),I=1,14),J=261,270) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  2, -5,  0,  0,  2,         &
     &   2,  0,  0, -2, -1,  0,  0, -2,  0,  0,  5,  0,  0,  0,         &
     &   2,  0,  0, -2, -1,  0, -6,  8,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8, -8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0,  2, -5,  0,  0,  2,         &
     &   0,  0,  0,  0,  1,  0,  3, -7,  4,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=271,280) /                            &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0, -2,  5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0, 11,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,-15,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0,  1,  0,  0,  0,  2,         &
     &   1,  0,  0, -1,  0,  0,  0, -3,  4,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -3,  7, -4,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5,  0, -2,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=281,290) /                            &
     &   0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  2, -2,  2,  0, -5,  6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,-11,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=291,300) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  9,-12,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  1, -1,  0,  0, -8, 12,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0, -1 /
      DATA ((MFAPL(I,J),I=1,14),J=301,310) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  1, -1, -1,  0,  0,  0, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -5,  0,  0,  0,  0, -2,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  3, -1,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=311,320) /                            &
     &   0,  0,  0,  0,  0,  0,  9, -9,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  3,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  2, -4,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  1,         &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  2,         &
     &   0,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=321,330) /                            &
     &   0,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5,  0, -3,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  0,         &
     &   2,  0, -1, -1, -1,  0,  0, -1,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  5,-10,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  2, -2,  1, -1,  0,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  2,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=331,340) /                            &
     &   0,  0,  0,  0,  1,  0,  3, -5,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  9, -9,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -8, 11,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  2,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  2,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  2, -6,  0,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=341,350) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -2,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  7,-13,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  3,  0,  0,  0,  2,         &
     &   0,  0,  2, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8, -8,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  8,-10,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  1 /
      DATA ((MFAPL(I,J),I=1,14),J=351,360) /                            &
     &   0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -4,  0,  0,  0,  0,         &
     &   2,  0,  0, -2, -1,  0,  0, -5,  6,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0, -2,         &
     &   2,  0, -1, -1, -1,  0,  0,  3, -7,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=361,370) /                            &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  4, -3,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,-11,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  1,  0,  0, -6,  8,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6, -5,  0,  0,  0,  0,  2,         &
     &   1,  0, -2, -2, -2,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0,  0,  0, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  1 /
      DATA ((MFAPL(I,J),I=1,14),J=371,380) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4,  0,  0, -2,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -2,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1, -6,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  3, -5,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  7,-13,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=381,390) /                            &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0,  0,  2,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -8, 15,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2, -2,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   2,  0, -1, -1, -1,  0,  0, -1,  0,  2,  0,  0,  0,  0,         &
     &   1,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   1,  0, -1,  1, -1,  0,-18, 17,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0,  0,  1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  2, -2, -1,  0, -5,  6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=391,400) /                            &
     &   0,  0,  0,  0,  1,  0,  2, -2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8,-16,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2,         &
     &   0,  0,  0,  0,  2,  0,  0, -1,  2,  0,  0,  0,  0,  0,         &
     &   2,  0, -1, -1, -2,  0,  0, -1,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  4,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  2,         &
     &   2,  0,  0, -2, -1,  0,  0, -2,  0,  4, -5,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=401,410) /                            &
     &   2,  0,  0, -2, -1,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   2,  0, -1, -1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -1, -1,  0,  0, -2,  2,  0,  0,  0,  0,  0,         &
     &   1,  0, -1, -1, -1,  0, 20,-20,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  1, -2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  5, -8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=411,420) /                            &
     &   0,  0,  0,  0,  0,  0,  9,-11,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -2,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0, -2,  5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=421,430) /                            &
     &   0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -6,  0,  0,  0,  0, -2,         &
     &   1,  0,  0, -2,  0,  0, 20,-21,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8,-12,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  8,-12,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  9,-17,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=431,440) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -7,  0,  0,  0,  0, -2,         &
     &   1,  0,  0, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0,         &
     &   1,  0, -2,  0, -2,  0,-10,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -9, 17,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0,  0, -2,         &
     &   1,  0, -2, -2, -2,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   1,  0, -1,  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=441,450) /                            &
     &   0,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  1,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0, -5,  7,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  2, -2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5,-10,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4,  0, -4,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0, -5,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=451,460) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -5,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  1,         &
     &   1,  0,  0, -2,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -7,  4,  0,  0,  0,  0,  0,         &
     &   2,  0,  2,  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1, -1,  0,  0, -1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  1,  0, -2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=461,470) /                            &
     &   1,  0,  0, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -3,  0,  3,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0, -5,  5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  1, -3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -4,  6,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0, -1,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=471,480) /                            &
     &   0,  0,  0,  0,  1,  0,  3, -4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7,-10,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  3, -8,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  2 /
      DATA ((MFAPL(I,J),I=1,14),J=481,490) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -8,  3,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0, -1,         &
     &   2,  0,  0, -2, -1,  0,  0, -6,  8,  0,  0,  0,  0,  0,         &
     &   2,  0, -1, -1,  1,  0,  0,  3, -7,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -7,  9,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0, -1 /
      DATA ((MFAPL(I,J),I=1,14),J=491,500) /                            &
     &   0,  0,  1, -1,  2,  0, -8, 12,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  1,  0,  0, -5,  6,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2, -1,  0,  0, -2,  0,  3, -1,  0,  0,  0,         &
     &   1,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   1,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=501,510) /                            &
     &   1,  0,  0, -1, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0,         &
     &   1,  0, -1,  0, -1,  0, -3,  5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -4,  4,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0, -8, 11,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  0,  0,  0, -9, 13,  0,  0,  0,  0,  0,         &
     &   0,  0,  1,  1,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0,  1, -4,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0,  0, -1,  0,  1, -3,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0,  7,-13,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=511,520) /                            &
     &   0,  0,  0,  0,  1,  0,  0,  2,  0, -2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  7,-11,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  1 /
      DATA ((MFAPL(I,J),I=1,14),J=521,530) /                            &
     &   0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  9,-17,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  1,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  0, -4,  8, -3,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=531,540) /                            &
     &   2,  0,  0, -2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,  0, -4,  8, -3,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0, 17,-16,  0, -2,  0,  0,  0,  0,         &
     &   1,  0,  0, -1,  0,  0,  0, -2,  2,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -4,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=541,550) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -2, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  2,         &
     &   2,  0,  0, -2,  0,  0,  0, -4,  4,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  2,  2,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0,  0, -4,  8, -3,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=551,560) /                            &
     &   1,  0,  0, -2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  0,  0, -4,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1,  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  3, -6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -2,  2,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0,  0,  1,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0, -4,  5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  2,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=561,570) /                            &
     &   0,  0,  0,  0,  0,  0,  8, -9,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,         &
     &   2,  0, -2, -2, -2,  0,  0, -2,  0,  2,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  1,  0,-10,  3,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0,  0, -1,  0,-10,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0,  2, -3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0,  2, -2,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=571,580) /                            &
     &   0,  0,  2,  0,  2,  0, -2,  3,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  0,  2,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  2,  0,  0,  0,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0,         &
     &   2,  0,  2, -2,  2,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   2,  0,  1, -3,  1,  0, -6,  7,  0,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  2, -5,  0,  0,  0,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  5, -5,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  1,  5,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  0,  5,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=581,590) /                            &
     &   2,  0,  0, -2,  0,  0,  0, -2,  0,  0,  2,  0,  0,  0,         &
     &   2,  0,  0, -2,  0,  0, -4,  4,  0,  0,  0,  0,  0,  0,         &
     &   2,  0, -2,  0, -2,  0,  0,  5, -9,  0,  0,  0,  0,  0,         &
     &   2,  0, -1, -1,  0,  0,  0, -1,  0,  3,  0,  0,  0,  0,         &
     &   1,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0,         &
     &   1,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0,         &
     &   1,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0,         &
     &   1,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=591,600) /                            &
     &   1,  0,  0,  0,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0,         &
     &   1,  0,  0, -2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0,         &
     &   1,  0, -2, -2, -2,  0,  0,  1,  0, -1,  0,  0,  0,  0,         &
     &   1,  0, -1,  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   1,  0, -1, -1,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0,         &
     &   0,  0,  2,  2,  2,  0,  0,  2,  0, -2,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0, -2,  0,  1,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  1,  0,  0,-10, 15,  0,  0,  0,  0,  0,         &
     &   0,  0,  2, -2,  0, -1,  0,  2,  0,  0,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=601,610) /                            &
     &   0,  0,  1, -1,  2,  0,  0, -1,  0,  0, -1,  0,  0,  0,         &
     &   0,  0,  1, -1,  2,  0, -3,  4,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -4,  6,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  1,  0, -1,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0,  0, -1,  0,  0, -2,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  1, -1, -1,  0, -5,  7,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=611,620) /                            &
     &   0,  0,  0,  2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  2,  0, -3,  5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  1,  0, -1,  2,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  9,-13,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  8,-14,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=621,630) /                            &
     &   0,  0,  0,  0,  0,  0,  5, -6, -4,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  3, -3,  0,  2,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  7,-12,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=631,640) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  6, -8,  1,  5,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5,  0, -4,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0, -1,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -8,  3,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  5,-16,  4,  5,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  5,-13,  0,  0,  0,  0, -2 /
      DATA ((MFAPL(I,J),I=1,14),J=641,650) /                            &
     &   0,  0,  0,  0,  0,  0,  0,  3,  0, -5,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -9,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  3, -7,  0,  0,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  2,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -3,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  2, -8,  1,  5,  0,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  1, -5,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -3,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0 /
      DATA ((MFAPL(I,J),I=1,14),J=651,NFPL) /                           &
     &   0,  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -6,  3,  0, -2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,         &
     &   0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0 /
!
!  Pointers into amplitudes array, one pointer per frequency.
      DATA (NC(I),I=1,100) /                                            &
     &    1,   21,   37,   51,   65,   79,   91,  103,  115,  127,      &
     &  139,  151,  163,  172,  184,  196,  207,  219,  231,  240,      &
     &  252,  261,  273,  285,  297,  309,  318,  327,  339,  351,      &
     &  363,  372,  384,  396,  405,  415,  423,  435,  444,  452,      &
     &  460,  467,  474,  482,  490,  498,  506,  513,  521,  528,      &
     &  536,  543,  551,  559,  566,  574,  582,  590,  597,  605,      &
     &  613,  620,  628,  636,  644,  651,  658,  666,  674,  680,      &
     &  687,  695,  702,  710,  717,  725,  732,  739,  746,  753,      &
     &  760,  767,  774,  782,  790,  798,  805,  812,  819,  826,      &
     &  833,  840,  846,  853,  860,  867,  874,  881,  888,  895 /
      DATA (NC(I),I=101,200) /                                          &
     &  901,  908,  914,  921,  928,  934,  941,  948,  955,  962,      &
     &  969,  976,  982,  989,  996, 1003, 1010, 1017, 1024, 1031,      &
     & 1037, 1043, 1050, 1057, 1064, 1071, 1078, 1084, 1091, 1098,      &
     & 1104, 1112, 1118, 1124, 1131, 1138, 1145, 1151, 1157, 1164,      &
     & 1171, 1178, 1185, 1192, 1199, 1205, 1212, 1218, 1226, 1232,      &
     & 1239, 1245, 1252, 1259, 1266, 1272, 1278, 1284, 1292, 1298,      &
     & 1304, 1310, 1316, 1323, 1329, 1335, 1341, 1347, 1353, 1359,      &
     & 1365, 1371, 1377, 1383, 1389, 1396, 1402, 1408, 1414, 1420,      &
     & 1426, 1434, 1440, 1446, 1452, 1459, 1465, 1471, 1477, 1482,      &
     & 1488, 1493, 1499, 1504, 1509, 1514, 1520, 1527, 1532, 1538 /
      DATA (NC(I),I=201,300) /                                          &
     & 1543, 1548, 1553, 1558, 1564, 1569, 1574, 1579, 1584, 1589,      &
     & 1594, 1596, 1598, 1600, 1602, 1605, 1608, 1610, 1612, 1617,      &
     & 1619, 1623, 1625, 1627, 1629, 1632, 1634, 1640, 1642, 1644,      &
     & 1646, 1648, 1650, 1652, 1654, 1658, 1660, 1662, 1664, 1668,      &
     & 1670, 1672, 1673, 1675, 1679, 1681, 1683, 1684, 1686, 1688,      &
     & 1690, 1693, 1695, 1697, 1701, 1703, 1705, 1707, 1709, 1711,      &
     & 1712, 1715, 1717, 1721, 1723, 1725, 1727, 1729, 1731, 1733,      &
     & 1735, 1737, 1739, 1741, 1743, 1745, 1747, 1749, 1751, 1753,      &
     & 1755, 1757, 1759, 1761, 1762, 1764, 1766, 1768, 1769, 1771,      &
     & 1773, 1775, 1777, 1779, 1781, 1783, 1785, 1787, 1788, 1790 /
      DATA (NC(I),I=301,400) /                                          &
     & 1792, 1794, 1796, 1798, 1800, 1802, 1804, 1806, 1807, 1809,      &
     & 1811, 1815, 1817, 1819, 1821, 1823, 1825, 1827, 1829, 1831,      &
     & 1833, 1835, 1837, 1839, 1840, 1842, 1844, 1848, 1850, 1852,      &
     & 1854, 1856, 1858, 1859, 1860, 1862, 1864, 1866, 1868, 1869,      &
     & 1871, 1873, 1875, 1877, 1879, 1881, 1883, 1885, 1887, 1889,      &
     & 1891, 1892, 1896, 1898, 1900, 1901, 1903, 1905, 1907, 1909,      &
     & 1910, 1911, 1913, 1915, 1919, 1921, 1923, 1927, 1929, 1931,      &
     & 1933, 1935, 1937, 1939, 1943, 1945, 1947, 1948, 1949, 1951,      &
     & 1953, 1955, 1957, 1958, 1960, 1962, 1964, 1966, 1968, 1970,      &
     & 1971, 1973, 1974, 1975, 1977, 1979, 1980, 1981, 1982, 1984 /
      DATA (NC(I),I=401,500) /                                          &
     & 1986, 1988, 1990, 1992, 1994, 1995, 1997, 1999, 2001, 2003,      &
     & 2005, 2007, 2008, 2009, 2011, 2013, 2015, 2017, 2019, 2021,      &
     & 2023, 2024, 2025, 2027, 2029, 2031, 2033, 2035, 2037, 2041,      &
     & 2043, 2045, 2046, 2047, 2049, 2051, 2053, 2055, 2056, 2057,      &
     & 2059, 2061, 2063, 2065, 2067, 2069, 2070, 2071, 2072, 2074,      &
     & 2076, 2078, 2080, 2082, 2084, 2086, 2088, 2090, 2092, 2094,      &
     & 2095, 2096, 2097, 2099, 2101, 2105, 2106, 2107, 2108, 2109,      &
     & 2110, 2111, 2113, 2115, 2119, 2121, 2123, 2125, 2127, 2129,      &
     & 2131, 2133, 2135, 2136, 2137, 2139, 2141, 2143, 2145, 2147,      &
     & 2149, 2151, 2153, 2155, 2157, 2159, 2161, 2163, 2165, 2167 /
      DATA (NC(I),I=501,600) /                                          &
     & 2169, 2171, 2173, 2175, 2177, 2179, 2181, 2183, 2185, 2186,      &
     & 2187, 2188, 2192, 2193, 2195, 2197, 2199, 2201, 2203, 2205,      &
     & 2207, 2209, 2211, 2213, 2217, 2219, 2221, 2223, 2225, 2227,      &
     & 2229, 2231, 2233, 2234, 2235, 2236, 2237, 2238, 2239, 2240,      &
     & 2241, 2244, 2246, 2248, 2250, 2252, 2254, 2256, 2258, 2260,      &
     & 2262, 2264, 2266, 2268, 2270, 2272, 2274, 2276, 2278, 2280,      &
     & 2282, 2284, 2286, 2288, 2290, 2292, 2294, 2296, 2298, 2300,      &
     & 2302, 2303, 2304, 2305, 2306, 2307, 2309, 2311, 2313, 2315,      &
     & 2317, 2319, 2321, 2323, 2325, 2327, 2329, 2331, 2333, 2335,      &
     & 2337, 2341, 2343, 2345, 2347, 2349, 2351, 2352, 2355, 2356 /
      DATA (NC(I),I=601,700) /                                          &
     & 2357, 2358, 2359, 2361, 2363, 2364, 2365, 2366, 2367, 2368,      &
     & 2369, 2370, 2371, 2372, 2373, 2374, 2376, 2378, 2380, 2382,      &
     & 2384, 2385, 2386, 2387, 2388, 2389, 2390, 2391, 2392, 2393,      &
     & 2394, 2395, 2396, 2397, 2398, 2399, 2400, 2401, 2402, 2403,      &
     & 2404, 2405, 2406, 2407, 2408, 2409, 2410, 2411, 2412, 2413,      &
     & 2414, 2415, 2417, 2418, 2430, 2438, 2445, 2453, 2460, 2468,      &
     & 2474, 2480, 2488, 2496, 2504, 2512, 2520, 2527, 2535, 2543,      &
     & 2550, 2558, 2566, 2574, 2580, 2588, 2596, 2604, 2612, 2619,      &
     & 2627, 2634, 2642, 2648, 2656, 2664, 2671, 2679, 2685, 2693,      &
     & 2701, 2709, 2717, 2725, 2733, 2739, 2747, 2753, 2761, 2769 /
      DATA (NC(I),I=701,800) /                                          &
     & 2777, 2785, 2793, 2801, 2809, 2817, 2825, 2833, 2841, 2848,      &
     & 2856, 2864, 2872, 2878, 2884, 2892, 2898, 2906, 2914, 2922,      &
     & 2930, 2938, 2944, 2952, 2958, 2966, 2974, 2982, 2988, 2996,      &
     & 3001, 3009, 3017, 3025, 3032, 3039, 3045, 3052, 3059, 3067,      &
     & 3069, 3076, 3083, 3090, 3098, 3105, 3109, 3111, 3113, 3120,      &
     & 3124, 3128, 3132, 3136, 3140, 3144, 3146, 3150, 3158, 3161,      &
     & 3165, 3166, 3168, 3172, 3176, 3180, 3182, 3185, 3189, 3193,      &
     & 3194, 3197, 3200, 3204, 3208, 3212, 3216, 3219, 3221, 3222,      &
     & 3226, 3230, 3234, 3238, 3242, 3243, 3247, 3251, 3254, 3258,      &
     & 3262, 3266, 3270, 3274, 3275, 3279, 3283, 3287, 3289, 3293 /
      DATA (NC(I),I=801,900) /                                          &
     & 3296, 3300, 3303, 3307, 3311, 3315, 3319, 3321, 3324, 3327,      &
     & 3330, 3334, 3338, 3340, 3342, 3346, 3350, 3354, 3358, 3361,      &
     & 3365, 3369, 3373, 3377, 3381, 3385, 3389, 3393, 3394, 3398,      &
     & 3402, 3406, 3410, 3413, 3417, 3421, 3425, 3429, 3433, 3435,      &
     & 3439, 3443, 3446, 3450, 3453, 3457, 3458, 3461, 3464, 3468,      &
     & 3472, 3476, 3478, 3481, 3485, 3489, 3493, 3497, 3501, 3505,      &
     & 3507, 3511, 3514, 3517, 3521, 3524, 3525, 3527, 3529, 3533,      &
     & 3536, 3540, 3541, 3545, 3548, 3551, 3555, 3559, 3563, 3567,      &
     & 3569, 3570, 3574, 3576, 3578, 3582, 3586, 3590, 3593, 3596,      &
     & 3600, 3604, 3608, 3612, 3616, 3620, 3623, 3626, 3630, 3632 /
      DATA (NC(I),I=901,1000) /                                         &
     & 3636, 3640, 3643, 3646, 3648, 3652, 3656, 3660, 3664, 3667,      &
     & 3669, 3671, 3675, 3679, 3683, 3687, 3689, 3693, 3694, 3695,      &
     & 3699, 3703, 3705, 3707, 3710, 3713, 3717, 3721, 3725, 3729,      &
     & 3733, 3736, 3740, 3744, 3748, 3752, 3754, 3757, 3759, 3763,      &
     & 3767, 3770, 3773, 3777, 3779, 3783, 3786, 3790, 3794, 3798,      &
     & 3801, 3805, 3809, 3813, 3817, 3821, 3825, 3827, 3831, 3835,      &
     & 3836, 3837, 3840, 3844, 3848, 3852, 3856, 3859, 3863, 3867,      &
     & 3869, 3871, 3875, 3879, 3883, 3887, 3890, 3894, 3898, 3901,      &
     & 3905, 3909, 3913, 3917, 3921, 3922, 3923, 3924, 3926, 3930,      &
     & 3932, 3936, 3938, 3940, 3944, 3948, 3952, 3956, 3959, 3963 /
      DATA (NC(I),I=1001,1100) /                                        &
     & 3965, 3969, 3973, 3977, 3979, 3981, 3982, 3986, 3989, 3993,      &
     & 3997, 4001, 4004, 4006, 4009, 4012, 4016, 4020, 4024, 4026,      &
     & 4028, 4032, 4036, 4040, 4044, 4046, 4050, 4054, 4058, 4060,      &
     & 4062, 4063, 4064, 4068, 4071, 4075, 4077, 4081, 4083, 4087,      &
     & 4089, 4091, 4095, 4099, 4101, 4103, 4105, 4107, 4111, 4115,      &
     & 4119, 4123, 4127, 4129, 4131, 4135, 4139, 4141, 4143, 4145,      &
     & 4149, 4153, 4157, 4161, 4165, 4169, 4173, 4177, 4180, 4183,      &
     & 4187, 4191, 4195, 4198, 4201, 4205, 4209, 4212, 4213, 4216,      &
     & 4217, 4221, 4223, 4226, 4230, 4234, 4236, 4240, 4244, 4248,      &
     & 4252, 4256, 4258, 4262, 4264, 4266, 4268, 4270, 4272, 4276 /
      DATA (NC(I),I=1101,1200) /                                        &
     & 4279, 4283, 4285, 4287, 4289, 4293, 4295, 4299, 4300, 4301,      &
     & 4305, 4309, 4313, 4317, 4319, 4323, 4325, 4329, 4331, 4333,      &
     & 4335, 4337, 4341, 4345, 4349, 4351, 4353, 4357, 4361, 4365,      &
     & 4367, 4369, 4373, 4377, 4381, 4383, 4387, 4389, 4391, 4395,      &
     & 4399, 4403, 4407, 4411, 4413, 4414, 4415, 4418, 4419, 4421,      &
     & 4423, 4427, 4429, 4431, 4433, 4435, 4437, 4439, 4443, 4446,      &
     & 4450, 4452, 4456, 4458, 4460, 4462, 4466, 4469, 4473, 4477,      &
     & 4481, 4483, 4487, 4489, 4491, 4493, 4497, 4499, 4501, 4504,      &
     & 4506, 4510, 4513, 4514, 4515, 4518, 4521, 4522, 4525, 4526,      &
     & 4527, 4530, 4533, 4534, 4537, 4541, 4542, 4543, 4544, 4545 /
      DATA (NC(I),I=1201,1300) /                                        &
     & 4546, 4547, 4550, 4553, 4554, 4555, 4558, 4561, 4564, 4567,      &
     & 4568, 4571, 4574, 4575, 4578, 4581, 4582, 4585, 4586, 4588,      &
     & 4590, 4592, 4596, 4598, 4602, 4604, 4608, 4612, 4613, 4616,      &
     & 4619, 4622, 4623, 4624, 4625, 4626, 4629, 4632, 4633, 4636,      &
     & 4639, 4640, 4641, 4642, 4643, 4644, 4645, 4648, 4649, 4650,      &
     & 4651, 4652, 4653, 4656, 4657, 4660, 4661, 4664, 4667, 4670,      &
     & 4671, 4674, 4675, 4676, 4677, 4678, 4681, 4682, 4683, 4684,      &
     & 4687, 4688, 4689, 4692, 4693, 4696, 4697, 4700, 4701, 4702,      &
     & 4703, 4704, 4707, 4708, 4711, 4712, 4715, 4716, 4717, 4718,      &
     & 4719, 4720, 4721, 4722, 4723, 4726, 4729, 4730, 4733, 4736 /
      DATA (NC(I),I=1301,NF) /                                          &
     & 4737, 4740, 4741, 4742, 4745, 4746, 4749, 4752, 4753 /
!
!  Amplitude coefficients (microarcsec);  indexed using the NC array.
      DATA (A(I),I=1,133) /                                             &
     &-6844318.44D0,9205236.26D0,1328.67D0,1538.18D0,205833.11D0,       &
     &153041.79D0,-3309.73D0,853.32D0,2037.98D0,-2301.27D0,81.46D0,     &
     &120.56D0,-20.39D0,-15.22D0,1.73D0,-1.61D0,-0.1D0,0.11D0,-0.02D0,  &
     &-0.02D0,-523908.04D0,573033.42D0,-544.75D0,-458.66D0,12814.01D0,  &
     &11714.49D0,198.97D0,-290.91D0,155.74D0,-143.27D0,-2.75D0,-1.03D0, &
     &-1.27D0,-1.16D0,    0D0,-0.01D0,-90552.22D0,97846.69D0,111.23D0,  &
     &137.41D0,2187.91D0,2024.68D0,41.44D0,-51.26D0,26.92D0,-24.46D0,   &
     &-0.46D0,-0.28D0,-0.22D0, -0.2D0,82168.76D0,-89618.24D0,-27.64D0,  &
     &-29.05D0,-2004.36D0,-1837.32D0,-36.07D0,48D0,-24.43D0,22.41D0,    &
     & 0.47D0, 0.24D0,  0.2D0, 0.18D0,58707.02D0,7387.02D0,470.05D0,    &
     &-192.4D0,164.33D0,-1312.21D0,-179.73D0,-28.93D0,-17.36D0,-1.83D0, &
     & -0.5D0, 3.57D0,    0D0, 0.13D0,-20557.78D0,22438.42D0,-20.84D0,  &
     &-17.4D0,501.82D0,459.68D0,59.2D0,-67.3D0,6.08D0,-5.61D0,-1.36D0,  &
     &-1.19D0,28288.28D0,-674.99D0,-34.69D0,35.8D0,-15.07D0,-632.54D0,  &
     &-11.19D0,0.78D0,-8.41D0, 0.17D0, 0.01D0, 0.07D0,-15406.85D0,      &
     &20069.5D0,15.12D0,31.8D0,448.76D0,344.5D0,-5.77D0,1.41D0,4.59D0,  &
     &-5.02D0, 0.17D0, 0.24D0,-11991.74D0,12902.66D0,32.46D0,36.7D0,    &
     &288.49D0,268.14D0,5.7D0,-7.06D0, 3.57D0,-3.23D0,-0.06D0,-0.04D0,  &
     &-8584.95D0,-9592.72D0,4.42D0,-13.2D0,-214.5D0,192.06D0,23.87D0 /
      DATA (A(I),I=134,273) /                                           &
     &29.83D0, 2.54D0,  2.4D0,  0.6D0,-0.48D0,5095.5D0,-6918.22D0,      &
     & 7.19D0, 3.92D0,-154.91D0,-113.94D0,2.86D0,-1.04D0,-1.52D0,       &
     & 1.73D0,-0.07D0, -0.1D0,-4910.93D0,-5331.13D0,0.76D0,0.4D0,       &
     &-119.21D0,109.81D0,2.16D0,3.2D0, 1.46D0, 1.33D0, 0.04D0,-0.02D0,  &
     &-6245.02D0,-123.48D0,-6.68D0,-8.2D0,-2.76D0,139.64D0,2.71D0,      &
     & 0.15D0, 1.86D0,2511.85D0,-3323.89D0,1.07D0,-0.9D0,-74.33D0,      &
     &-56.17D0,1.16D0,-0.01D0,-0.75D0, 0.83D0,-0.02D0,-0.04D0,          &
     &2307.58D0,3143.98D0,-7.52D0,7.5D0,70.31D0,-51.6D0,1.46D0,0.16D0,  &
     &-0.69D0,-0.79D0, 0.02D0,-0.05D0,2372.58D0,2554.51D0,5.93D0,       &
     & -6.6D0,57.12D0,-53.05D0,-0.96D0,-1.24D0,-0.71D0,-0.64D0,-0.01D0, &
     &-2053.16D0,2636.13D0,5.13D0,7.8D0,58.94D0,45.91D0,-0.42D0,        &
     &-0.12D0, 0.61D0,-0.66D0, 0.02D0, 0.03D0,-1825.49D0,-2423.59D0,    &
     & 1.23D0,   -2D0,-54.19D0,40.82D0,-1.07D0,-1.02D0,0.54D0, 0.61D0,  &
     &-0.04D0, 0.04D0,2521.07D0,-122.28D0,-5.97D0,2.9D0,-2.73D0,        &
     &-56.37D0,-0.82D0,0.13D0,-0.75D0,-1534.09D0,1645.01D0,6.29D0,      &
     &  6.8D0,36.78D0, 34.3D0, 0.92D0,-1.25D0, 0.46D0,-0.41D0,-0.02D0,  &
     &-0.01D0,1898.27D0,47.7D0,-0.72D0, 2.5D0, 1.07D0,-42.45D0,-0.94D0, &
     & 0.02D0,-0.56D0,-1292.02D0,-1387D0, 0D0,    0D0,-31.01D0,28.89D0, &
     & 0.68D0,    0D0, 0.38D0, 0.35D0,-0.01D0,-0.01D0,-1234.96D0 /
      DATA (A(I),I=274,415) /                                           &
     &1323.81D0,5.21D0, 5.9D0, 29.6D0,27.61D0, 0.74D0,-1.22D0, 0.37D0,  &
     &-0.33D0,-0.02D0,-0.01D0,1137.48D0,-1233.89D0,-0.04D0,-0.3D0,      &
     &-27.59D0,-25.43D0,-0.61D0,  1D0,-0.34D0, 0.31D0, 0.01D0, 0.01D0,  &
     &-813.13D0,-1075.6D0,0.4D0,0.3D0,-24.05D0,18.18D0,-0.4D0,-0.01D0,  &
     & 0.24D0, 0.27D0,-0.01D0, 0.01D0,1163.22D0,-60.9D0,-2.94D0,1.3D0,  &
     &-1.36D0,-26.01D0,-0.58D0,0.07D0,-0.35D0,1029.7D0,-55.55D0,        &
     &-2.63D0,  1.1D0,-1.25D0,-23.02D0,-0.52D0,0.06D0,-0.31D0,          &
     &-556.26D0,852.85D0,3.16D0,-4.48D0,19.06D0,12.44D0,-0.81D0,        &
     &-0.27D0, 0.17D0,-0.21D0,    0D0, 0.02D0,-603.52D0,-800.34D0,      &
     & 0.44D0,  0.1D0,-17.9D0,13.49D0,-0.08D0,-0.01D0, 0.18D0,  0.2D0,  &
     &-0.01D0, 0.01D0,-628.24D0,684.99D0,-0.64D0,-0.5D0,15.32D0,        &
     &14.05D0, 3.18D0,-4.19D0, 0.19D0,-0.17D0,-0.09D0,-0.07D0,          &
     &-866.48D0,-16.26D0,0.52D0,-1.3D0,-0.36D0,19.37D0,0.43D0,-0.01D0,  &
     & 0.26D0,-512.37D0,695.54D0,-1.47D0,-1.4D0,15.55D0,11.46D0,        &
     &-0.16D0, 0.03D0, 0.15D0,-0.17D0, 0.01D0, 0.01D0,506.65D0,         &
     &643.75D0,2.54D0,-2.62D0, 14.4D0,-11.33D0,-0.77D0,-0.06D0,-0.15D0, &
     &-0.16D0,    0D0, 0.01D0,664.57D0,16.81D0,-0.4D0,    1D0, 0.38D0,  &
     &-14.86D0,-3.71D0,-0.09D0,-0.2D0,405.91D0,522.11D0,0.99D0,-1.5D0,  &
     &11.67D0,-9.08D0,-0.25D0,-0.02D0,-0.12D0,-0.13D0,-305.78D0 /
      DATA (A(I),I=416,566) /                                           &
     &326.6D0, 1.75D0,  1.9D0,  7.3D0, 6.84D0,  0.2D0,-0.04D0,300.99D0, &
     &-325.03D0,-0.44D0,-0.5D0,-7.27D0,-6.73D0,-1.01D0,0.01D0,    0D0,  &
     & 0.08D0,    0D0, 0.02D0,438.51D0,10.47D0,-0.56D0,-0.2D0, 0.24D0,  &
     &-9.81D0,-0.24D0, 0.01D0,-0.13D0,-264.02D0,335.24D0,0.99D0,1.4D0,  &
     & 7.49D0,  5.9D0,-0.27D0,-0.02D0,284.09D0,307.03D0,0.32D0,-0.4D0,  &
     & 6.87D0,-6.35D0,-0.99D0,-0.01D0,-250.54D0,327.11D0,0.08D0,0.4D0,  &
     & 7.31D0,  5.6D0, -0.3D0,230.72D0,-304.46D0,0.08D0,-0.1D0,-6.81D0, &
     &-5.16D0, 0.27D0,229.78D0,304.17D0,-0.6D0, 0.5D0,  6.8D0,-5.14D0,  &
     & 0.33D0, 0.01D0,256.3D0,-276.81D0,-0.28D0,-0.4D0,-6.19D0,-5.73D0, &
     &-0.14D0, 0.01D0,-212.82D0,269.45D0,0.84D0,1.2D0, 6.02D0, 4.76D0,  &
     & 0.14D0,-0.02D0,196.64D0,272.05D0,-0.84D0,0.9D0, 6.08D0, -4.4D0,  &
     & 0.35D0, 0.02D0,188.95D0,272.22D0,-0.12D0,0.3D0, 6.09D0,-4.22D0,  &
     & 0.34D0,-292.37D0,-5.1D0,-0.32D0,-0.4D0,-0.11D0, 6.54D0, 0.14D0,  &
     & 0.01D0,161.79D0,-220.67D0,0.24D0,0.1D0,-4.93D0,-3.62D0,-0.08D0,  &
     &261.54D0,-19.94D0,-0.95D0,0.2D0,-0.45D0,-5.85D0,-0.13D0, 0.02D0,  &
     &142.16D0,-190.79D0,0.2D0, 0.1D0,-4.27D0,-3.18D0,-0.07D0,187.95D0, &
     &-4.11D0,-0.24D0,  0.3D0,-0.09D0, -4.2D0,-0.09D0, 0.01D0,    0D0,  &
     &    0D0,-79.08D0,167.9D0,0.04D0,    0D0, 3.75D0, 1.77D0,121.98D0, &
     &131.04D0,-0.08D0, 0.1D0, 2.93D0,-2.73D0,-0.06D0,-172.95D0 /
      DATA (A(I),I=567,713) /                                           &
     &-8.11D0, -0.4D0, -0.2D0,-0.18D0, 3.87D0, 0.09D0, 0.01D0,          &
     &-160.15D0,-55.3D0,-14.04D0,13.9D0,-1.23D0,3.58D0, 0.4D0, 0.31D0,  &
     &-115.4D0,123.2D0, 0.6D0,  0.7D0, 2.75D0, 2.58D0, 0.08D0,-0.01D0,  &
     &-168.26D0, -2D0,  0.2D0, -0.2D0,-0.04D0, 3.76D0, 0.08D0,          &
     &-114.49D0,123.2D0,0.32D0, 0.4D0, 2.75D0, 2.56D0, 0.07D0,-0.01D0,  &
     &112.14D0,120.7D0,0.28D0, -0.3D0,  2.7D0,-2.51D0,-0.07D0,-0.01D0,  &
     &161.34D0,4.03D0,  0.2D0,  0.2D0, 0.09D0,-3.61D0,-0.08D0,91.31D0,  &
     &126.64D0,-0.4D0,  0.4D0, 2.83D0,-2.04D0,-0.04D0, 0.01D0,105.29D0, &
     &112.9D0, 0.44D0, -0.5D0, 2.52D0,-2.35D0,-0.07D0,-0.01D0,98.69D0,  &
     &-106.2D0,-0.28D0,-0.3D0,-2.37D0,-2.21D0,-0.06D0, 0.01D0,86.74D0,  &
     &-112.94D0,-0.08D0,-0.2D0,-2.53D0,-1.94D0,-0.05D0,-134.81D0,       &
     & 3.51D0,  0.2D0, -0.2D0, 0.08D0, 3.01D0, 0.07D0,79.03D0,107.31D0, &
     &-0.24D0,  0.2D0,  2.4D0,-1.77D0,-0.04D0, 0.01D0,132.81D0,         &
     &-10.77D0,-0.52D0, 0.1D0,-0.24D0,-2.97D0,-0.07D0, 0.01D0,          &
     &-130.31D0,-0.9D0,0.04D0,    0D0,    0D0, 2.91D0,-78.56D0,85.32D0, &
     &    0D0,    0D0, 1.91D0, 1.76D0, 0.04D0,    0D0,    0D0,-41.53D0, &
     & 89.1D0, 0.02D0,    0D0, 1.99D0, 0.93D0,66.03D0,  -71D0, -0.2D0,  &
     & -0.2D0,-1.59D0,-1.48D0,-0.04D0, 60.5D0, 64.7D0, 0.36D0, -0.4D0,  &
     & 1.45D0,-1.35D0,-0.04D0,-0.01D0,-52.27D0,-70.01D0,  0D0,    0D0 /
      DATA (A(I),I=714,865) /                                           &
     &-1.57D0, 1.17D0, 0.03D0,-52.95D0,66.29D0,0.32D0,  0.4D0, 1.48D0,  &
     & 1.18D0, 0.04D0,-0.01D0,51.02D0,67.25D0,    0D0,    0D0,  1.5D0,  &
     &-1.14D0,-0.03D0,-55.66D0,-60.92D0,0.16D0,-0.2D0,-1.36D0, 1.24D0,  &
     & 0.03D0,-54.81D0,-59.2D0,-0.08D0, 0.2D0,-1.32D0, 1.23D0, 0.03D0,  &
     &51.32D0,-55.6D0,    0D0,    0D0,-1.24D0,-1.15D0,-0.03D0,48.29D0,  &
     & 51.8D0,  0.2D0, -0.2D0, 1.16D0,-1.08D0,-0.03D0,-45.59D0, -49D0,  &
     &-0.12D0,  0.1D0, -1.1D0, 1.02D0, 0.03D0,40.54D0,-52.69D0,-0.04D0, &
     & -0.1D0,-1.18D0,-0.91D0,-0.02D0,-40.58D0,-49.51D0, -1D0,    1D0,  &
     &-1.11D0, 0.91D0, 0.04D0, 0.02D0,-43.76D0,46.5D0, 0.36D0,  0.4D0,  &
     & 1.04D0, 0.98D0, 0.03D0,-0.01D0,62.65D0,   -5D0,-0.24D0,    0D0,  &
     &-0.11D0, -1.4D0,-0.03D0, 0.01D0,-38.57D0,49.59D0,0.08D0,  0.1D0,  &
     & 1.11D0, 0.86D0, 0.02D0,-33.22D0,-44.04D0,0.08D0,-0.1D0,-0.98D0,  &
     & 0.74D0, 0.02D0,37.15D0,-39.9D0,-0.12D0, -0.1D0,-0.89D0,-0.83D0,  &
     &-0.02D0,36.68D0,-39.5D0,-0.04D0, -0.1D0,-0.88D0,-0.82D0,-0.02D0,  &
     &-53.22D0,-3.91D0,-0.2D0,    0D0,-0.09D0, 1.19D0, 0.03D0,32.43D0,  &
     &-42.19D0,-0.04D0,-0.1D0,-0.94D0,-0.73D0,-0.02D0,  -51D0, -2.3D0,  &
     &-0.12D0, -0.1D0,    0D0, 1.14D0,-29.53D0,-39.11D0,0.04D0,   0D0,  &
     &-0.87D0, 0.66D0, 0.02D0, 28.5D0,-38.92D0,-0.08D0,-0.1D0,-0.87D0,  &
     &-0.64D0,-0.02D0,26.54D0,36.95D0,-0.12D0,  0.1D0, 0.83D0,-0.59D0 /
      DATA (A(I),I=866,1017) /                                          &
     &-0.01D0,26.54D0,34.59D0, 0.04D0, -0.1D0, 0.77D0,-0.59D0,-0.02D0,  &
     &28.35D0,-32.55D0,-0.16D0, 0.2D0,-0.73D0,-0.63D0,-0.01D0,  -28D0,  &
     & 30.4D0,    0D0,    0D0, 0.68D0, 0.63D0, 0.01D0,-27.61D0,29.4D0,  &
     &  0.2D0,  0.2D0, 0.66D0, 0.62D0, 0.02D0,40.33D0,  0.4D0,-0.04D0,  &
     &  0.1D0,    0D0, -0.9D0,-23.28D0,31.61D0,-0.08D0,-0.1D0, 0.71D0,  &
     & 0.52D0, 0.01D0,37.75D0,  0.8D0, 0.04D0,  0.1D0,    0D0,-0.84D0,  &
     &23.66D0, 25.8D0,    0D0,    0D0, 0.58D0,-0.53D0,-0.01D0,21.01D0,  &
     &-27.91D0,   0D0,    0D0,-0.62D0,-0.47D0,-0.01D0,-34.81D0,2.89D0,  &
     & 0.04D0,    0D0,    0D0, 0.78D0,-23.49D0,-25.31D0,  0D0,    0D0,  &
     &-0.57D0, 0.53D0, 0.01D0,-23.47D0,25.2D0, 0.16D0,  0.2D0, 0.56D0,  &
     & 0.52D0, 0.02D0,19.58D0, 27.5D0,-0.12D0,  0.1D0, 0.62D0,-0.44D0,  &
     &-0.01D0,-22.67D0,-24.4D0,-0.08D0, 0.1D0,-0.55D0, 0.51D0, 0.01D0,  &
     &-19.97D0,  25D0, 0.12D0,  0.2D0, 0.56D0, 0.45D0, 0.01D0,21.28D0,  &
     &-22.8D0,-0.08D0, -0.1D0,-0.51D0,-0.48D0,-0.01D0,-30.47D0,0.91D0,  &
     & 0.04D0,    0D0,    0D0, 0.68D0,18.58D0,   24D0, 0.04D0, -0.1D0,  &
     & 0.54D0,-0.42D0,-0.01D0,-18.02D0,24.4D0,-0.04D0, -0.1D0, 0.55D0,  &
     &  0.4D0, 0.01D0,17.74D0, 22.5D0, 0.08D0, -0.1D0,  0.5D0, -0.4D0,  &
     &-0.01D0,-19.41D0,20.7D0, 0.08D0,  0.1D0, 0.46D0, 0.43D0, 0.01D0,  &
     &-18.64D0,20.11D0,   0D0,    0D0, 0.45D0, 0.42D0, 0.01D0,-16.75D0 /
      DATA (A(I),I=1018,1169) /                                         &
     & 21.6D0, 0.04D0,  0.1D0, 0.48D0, 0.37D0, 0.01D0,-18.42D0, -20D0,  &
     &    0D0,    0D0,-0.45D0, 0.41D0, 0.01D0,-26.77D0,1.41D0, 0.08D0,  &
     &    0D0,    0D0,  0.6D0,-26.17D0,-0.19D0,   0D0,    0D0,    0D0,  &
     & 0.59D0,-15.52D0,20.51D0,   0D0,    0D0, 0.46D0, 0.35D0, 0.01D0,  &
     &-25.42D0,-1.91D0,-0.08D0,   0D0,-0.04D0, 0.57D0, 0.45D0,-17.42D0, &
     & 18.1D0,    0D0,    0D0,  0.4D0, 0.39D0, 0.01D0,16.39D0,-17.6D0,  &
     &-0.08D0, -0.1D0,-0.39D0,-0.37D0,-0.01D0,-14.37D0,18.91D0,   0D0,  &
     &    0D0, 0.42D0, 0.32D0, 0.01D0,23.39D0, -2.4D0,-0.12D0,    0D0,  &
     &    0D0,-0.52D0,14.32D0,-18.5D0,-0.04D0, -0.1D0,-0.41D0,-0.32D0,  &
     &-0.01D0,15.69D0,17.08D0,    0D0,    0D0, 0.38D0,-0.35D0,-0.01D0,  &
     &-22.99D0, 0.5D0, 0.04D0,    0D0,    0D0, 0.51D0,    0D0,    0D0,  &
     &14.47D0,-17.6D0,-0.01D0,    0D0,-0.39D0,-0.32D0,-13.33D0,18.4D0,  &
     &-0.04D0, -0.1D0, 0.41D0,  0.3D0,22.47D0, -0.6D0,-0.04D0,    0D0,  &
     &    0D0, -0.5D0,-12.78D0,-17.41D0,0.04D0,   0D0,-0.39D0, 0.29D0,  &
     & 0.01D0,-14.1D0,-15.31D0,0.04D0,    0D0,-0.34D0, 0.32D0, 0.01D0,  &
     &11.98D0,16.21D0,-0.04D0,    0D0, 0.36D0,-0.27D0,-0.01D0,19.65D0,  &
     & -1.9D0,-0.08D0,    0D0,    0D0,-0.44D0,19.61D0, -1.5D0,-0.08D0,  &
     &    0D0,    0D0,-0.44D0,13.41D0,-14.3D0,-0.04D0, -0.1D0,-0.32D0,  &
     & -0.3D0,-0.01D0,-13.29D0,14.4D0,    0D0,    0D0, 0.32D0,  0.3D0 /
      DATA (A(I),I=1170,1321) /                                         &
     & 0.01D0,11.14D0,-14.4D0,-0.04D0,    0D0,-0.32D0,-0.25D0,-0.01D0,  &
     &12.24D0,-13.38D0,0.04D0,    0D0, -0.3D0,-0.27D0,-0.01D0,10.07D0,  &
     &-13.81D0,0.04D0,    0D0,-0.31D0,-0.23D0,-0.01D0,10.46D0, 13.1D0,  &
     & 0.08D0, -0.1D0, 0.29D0,-0.23D0,-0.01D0,16.55D0,-1.71D0,-0.08D0,  &
     &    0D0,    0D0,-0.37D0, 9.75D0,-12.8D0,    0D0,    0D0,-0.29D0,  &
     &-0.22D0,-0.01D0, 9.11D0, 12.8D0,    0D0,    0D0, 0.29D0, -0.2D0,  &
     &    0D0,    0D0,-6.44D0,-13.8D0,    0D0,    0D0,-0.31D0, 0.14D0,  &
     &-9.19D0,  -12D0,    0D0,    0D0,-0.27D0, 0.21D0,-10.3D0, 10.9D0,  &
     & 0.08D0,  0.1D0, 0.24D0, 0.23D0, 0.01D0,14.92D0, -0.8D0,-0.04D0,  &
     &    0D0,    0D0,-0.33D0,10.02D0,-10.8D0,    0D0,    0D0,-0.24D0,  &
     &-0.22D0,-0.01D0,-9.75D0, 10.4D0, 0.04D0,    0D0, 0.23D0, 0.22D0,  &
     & 0.01D0, 9.67D0,-10.4D0,-0.04D0,    0D0,-0.23D0,-0.22D0,-0.01D0,  &
     &-8.28D0,-11.2D0, 0.04D0,    0D0,-0.25D0, 0.19D0,13.32D0,-1.41D0,  &
     &-0.08D0,    0D0,    0D0, -0.3D0, 8.27D0, 10.5D0, 0.04D0,    0D0,  &
     & 0.23D0,-0.19D0,    0D0,    0D0,13.13D0,    0D0,    0D0,    0D0,  &
     &    0D0,-0.29D0,-12.93D0, 0.7D0, 0.04D0,    0D0,    0D0, 0.29D0,  &
     & 7.91D0,-10.2D0,    0D0,    0D0,-0.23D0,-0.18D0,-7.84D0,  -10D0,  &
     &-0.04D0,    0D0,-0.22D0, 0.18D0, 7.44D0,  9.6D0,    0D0,    0D0,  &
     & 0.21D0,-0.17D0,-7.64D0,  9.4D0, 0.08D0,  0.1D0, 0.21D0, 0.17D0 /
      DATA (A(I),I=1322,1473) /                                         &
     & 0.01D0,-11.38D0, 0.6D0, 0.04D0,    0D0,    0D0, 0.25D0,-7.48D0,  &
     &  8.3D0,    0D0,    0D0, 0.19D0, 0.17D0,-10.98D0,-0.2D0,    0D0,  &
     &    0D0,    0D0, 0.25D0,10.98D0,  0.2D0,    0D0,    0D0,    0D0,  &
     &-0.25D0,  7.4D0, -7.9D0,-0.04D0,    0D0,-0.18D0,-0.17D0,-6.09D0,  &
     &  8.4D0,-0.04D0,    0D0, 0.19D0, 0.14D0,-6.94D0,-7.49D0,    0D0,  &
     &    0D0,-0.17D0, 0.16D0, 6.92D0,  7.5D0, 0.04D0,    0D0, 0.17D0,  &
     &-0.15D0,  6.2D0, 8.09D0,    0D0,    0D0, 0.18D0,-0.14D0,-6.12D0,  &
     &  7.8D0, 0.04D0,    0D0, 0.17D0, 0.14D0, 5.85D0, -7.5D0,    0D0,  &
     &    0D0,-0.17D0,-0.13D0,-6.48D0,  6.9D0, 0.08D0,  0.1D0, 0.15D0,  &
     & 0.14D0, 0.01D0, 6.32D0,  6.9D0,    0D0,    0D0, 0.15D0,-0.14D0,  &
     & 5.61D0, -7.2D0,    0D0,    0D0,-0.16D0,-0.13D0, 9.07D0,    0D0,  &
     &    0D0,    0D0,    0D0, -0.2D0, 5.25D0,  6.9D0,    0D0,    0D0,  &
     & 0.15D0,-0.12D0,-8.47D0, -0.4D0,    0D0,    0D0,    0D0, 0.19D0,  &
     & 6.32D0,-5.39D0,-1.11D0,  1.1D0,-0.12D0,-0.14D0, 0.02D0, 0.02D0,  &
     & 5.73D0, -6.1D0,-0.04D0,    0D0,-0.14D0,-0.13D0,  4.7D0,  6.6D0,  &
     &-0.04D0,    0D0, 0.15D0,-0.11D0, -4.9D0, -6.4D0,    0D0,    0D0,  &
     &-0.14D0, 0.11D0,-5.33D0,  5.6D0, 0.04D0,  0.1D0, 0.13D0, 0.12D0,  &
     & 0.01D0,-4.81D0,    6D0, 0.04D0,    0D0, 0.13D0, 0.11D0, 5.13D0,  &
     &  5.5D0, 0.04D0,    0D0, 0.12D0,-0.11D0,  4.5D0,  5.9D0,    0D0 /
      DATA (A(I),I=1474,1625) /                                         &
     &    0D0, 0.13D0, -0.1D0,-4.22D0,  6.1D0,    0D0,    0D0, 0.14D0,  &
     &-4.53D0,  5.7D0,    0D0,    0D0, 0.13D0,  0.1D0, 4.18D0,  5.7D0,  &
     &    0D0,    0D0, 0.13D0,-4.75D0,-5.19D0,    0D0,    0D0,-0.12D0,  &
     & 0.11D0,-4.06D0,  5.6D0,    0D0,    0D0, 0.13D0,-3.98D0,  5.6D0,  &
     &-0.04D0,    0D0, 0.13D0, 4.02D0, -5.4D0,    0D0,    0D0,-0.12D0,  &
     & 4.49D0, -4.9D0,-0.04D0,    0D0,-0.11D0, -0.1D0,-3.62D0, -5.4D0,  &
     &-0.16D0,  0.2D0,-0.12D0,    0D0, 0.01D0, 4.38D0,  4.8D0,    0D0,  &
     &    0D0, 0.11D0, -6.4D0, -0.1D0,    0D0,    0D0,    0D0, 0.14D0,  &
     &-3.98D0,    5D0, 0.04D0,    0D0, 0.11D0,-3.82D0,   -5D0,    0D0,  &
     &    0D0,-0.11D0,-3.71D0, 5.07D0,    0D0,    0D0, 0.11D0, 4.14D0,  &
     &  4.4D0,    0D0,    0D0,  0.1D0,-6.01D0, -0.5D0,-0.04D0,    0D0,  &
     &    0D0, 0.13D0,-4.04D0, 4.39D0,    0D0,    0D0,  0.1D0, 3.45D0,  &
     &-4.72D0,    0D0,    0D0,-0.11D0, 3.31D0, 4.71D0,    0D0,    0D0,  &
     & 0.11D0, 3.26D0, -4.5D0,    0D0,    0D0, -0.1D0,-3.26D0, -4.5D0,  &
     &    0D0,    0D0, -0.1D0,-3.34D0, -4.4D0,    0D0,    0D0, -0.1D0,  &
     &-3.74D0,   -4D0,  3.7D0,    4D0, 3.34D0, -4.3D0,  3.3D0, -4.3D0,  &
     &-3.66D0,  3.9D0, 0.04D0, 3.66D0,  3.9D0, 0.04D0,-3.62D0, -3.9D0,  &
     &-3.61D0,  3.9D0, -0.2D0,  5.3D0,    0D0,    0D0, 0.12D0, 3.06D0,  &
     &  4.3D0,  3.3D0,    4D0,  0.4D0,  0.2D0,  3.1D0,  4.1D0,-3.06D0 /
      DATA (A(I),I=1626,1777) /                                         &
     &  3.9D0, -3.3D0, -3.6D0, -3.3D0, 3.36D0, 0.01D0, 3.14D0,  3.4D0,  &
     &-4.57D0, -0.2D0,    0D0,    0D0,    0D0,  0.1D0, -2.7D0, -3.6D0,  &
     & 2.94D0, -3.2D0, -2.9D0,  3.2D0, 2.47D0, -3.4D0, 2.55D0, -3.3D0,  &
     &  2.8D0,-3.08D0, 2.51D0,  3.3D0, -4.1D0,  0.3D0,-0.12D0, -0.1D0,  &
     &  4.1D0,  0.2D0,-2.74D0,    3D0, 2.46D0, 3.23D0,-3.66D0,  1.2D0,  &
     & -0.2D0,  0.2D0, 3.74D0, -0.4D0,-2.51D0, -2.8D0,-3.74D0, 2.27D0,  &
     & -2.9D0,    0D0,    0D0, -2.5D0,  2.7D0,-2.51D0,  2.6D0, -3.5D0,  &
     &  0.2D0, 3.38D0,-2.22D0, -2.5D0, 3.26D0, -0.4D0, 1.95D0, -2.6D0,  &
     & 3.22D0, -0.4D0,-0.04D0,-1.79D0, -2.6D0, 1.91D0,  2.5D0, 0.74D0,  &
     & 3.05D0,-0.04D0, 0.08D0, 2.11D0, -2.3D0,-2.11D0,  2.2D0,-1.87D0,  &
     & -2.4D0, 2.03D0, -2.2D0,-2.03D0,  2.2D0, 2.98D0,    0D0,    0D0,  &
     & 2.98D0,-1.71D0,  2.4D0, 2.94D0, -0.1D0,-0.12D0,  0.1D0, 1.67D0,  &
     &  2.4D0,-1.79D0,  2.3D0,-1.79D0,  2.2D0,-1.67D0,  2.2D0, 1.79D0,  &
     &   -2D0, 1.87D0, -1.9D0, 1.63D0, -2.1D0,-1.59D0,  2.1D0, 1.55D0,  &
     & -2.1D0,-1.55D0,  2.1D0,-2.59D0, -0.2D0,-1.75D0, -1.9D0,-1.75D0,  &
     &  1.9D0,-1.83D0, -1.8D0, 1.51D0,    2D0,-1.51D0,   -2D0, 1.71D0,  &
     &  1.8D0, 1.31D0,  2.1D0,-1.43D0,    2D0, 1.43D0,    2D0,-2.43D0,  &
     &-1.51D0,  1.9D0,-1.47D0,  1.9D0, 2.39D0,  0.2D0,-2.39D0, 1.39D0,  &
     &  1.9D0, 1.39D0, -1.8D0, 1.47D0, -1.6D0, 1.47D0, -1.6D0, 1.43D0 /
      DATA (A(I),I=1778,1929) /                                         &
     & -1.5D0,-1.31D0,  1.6D0, 1.27D0, -1.6D0,-1.27D0,  1.6D0, 1.27D0,  &
     & -1.6D0, 2.03D0, 1.35D0,  1.5D0,-1.39D0, -1.4D0, 1.95D0, -0.2D0,  &
     &-1.27D0, 1.49D0, 1.19D0,  1.5D0, 1.27D0,  1.4D0, 1.15D0,  1.5D0,  &
     & 1.87D0, -0.1D0,-1.12D0, -1.5D0, 1.87D0,-1.11D0, -1.5D0,-1.11D0,  &
     & -1.5D0,    0D0,    0D0, 1.19D0,  1.4D0, 1.27D0, -1.3D0,-1.27D0,  &
     & -1.3D0,-1.15D0,  1.4D0,-1.23D0,  1.3D0,-1.23D0, -1.3D0, 1.22D0,  &
     &-1.29D0, 1.07D0, -1.4D0, 1.75D0, -0.2D0,-1.03D0, -1.4D0,-1.07D0,  &
     &  1.2D0,-1.03D0, 1.15D0, 1.07D0,  1.1D0, 1.51D0,-1.03D0,  1.1D0,  &
     & 1.03D0, -1.1D0,    0D0,    0D0,-1.03D0, -1.1D0, 0.91D0, -1.2D0,  &
     &-0.88D0, -1.2D0,-0.88D0,  1.2D0,-0.95D0,  1.1D0,-0.95D0, -1.1D0,  &
     & 1.43D0,-1.39D0, 0.95D0,   -1D0,-0.95D0,    1D0, -0.8D0,  1.1D0,  &
     & 0.91D0,   -1D0,-1.35D0, 0.88D0,    1D0,-0.83D0,    1D0,-0.91D0,  &
     &  0.9D0, 0.91D0,  0.9D0, 0.88D0, -0.9D0,-0.76D0,   -1D0,-0.76D0,  &
     &    1D0, 0.76D0,    1D0,-0.72D0,    1D0, 0.84D0, -0.9D0, 0.84D0,  &
     &  0.9D0, 1.23D0,    0D0,    0D0,-0.52D0, -1.1D0,-0.68D0,    1D0,  &
     & 1.19D0, -0.2D0, 1.19D0, 0.76D0,  0.9D0, 1.15D0, -0.1D0, 1.15D0,  &
     & -0.1D0, 0.72D0, -0.9D0,-1.15D0,-1.15D0, 0.68D0,  0.9D0,-0.68D0,  &
     &  0.9D0,-1.11D0,    0D0,    0D0,  0.2D0, 0.79D0,  0.8D0,-1.11D0,  &
     & -0.1D0,    0D0,    0D0,-0.48D0,   -1D0,-0.76D0, -0.8D0,-0.72D0 /
      DATA (A(I),I=1930,2081) /                                         &
     & -0.8D0,-1.07D0, -0.1D0, 0.64D0,  0.8D0,-0.64D0, -0.8D0, 0.64D0,  &
     &  0.8D0,  0.4D0,  0.6D0, 0.52D0, -0.5D0, -0.6D0, -0.8D0,-0.71D0,  &
     &  0.7D0,-0.99D0, 0.99D0, 0.56D0,  0.8D0,-0.56D0,  0.8D0, 0.68D0,  &
     & -0.7D0, 0.68D0,  0.7D0,-0.95D0,-0.64D0,  0.7D0, 0.64D0,  0.7D0,  &
     & -0.6D0,  0.7D0, -0.6D0, -0.7D0,-0.91D0, -0.1D0,-0.51D0, 0.76D0,  &
     &-0.91D0,-0.56D0,  0.7D0, 0.88D0, 0.88D0,-0.63D0, -0.6D0, 0.55D0,  &
     & -0.6D0, -0.8D0,  0.8D0, -0.8D0,-0.52D0,  0.6D0, 0.52D0,  0.6D0,  &
     & 0.52D0, -0.6D0,-0.48D0,  0.6D0, 0.48D0,  0.6D0, 0.48D0,  0.6D0,  &
     &-0.76D0, 0.44D0, -0.6D0, 0.52D0, -0.5D0,-0.52D0,  0.5D0,  0.4D0,  &
     &  0.6D0, -0.4D0, -0.6D0,  0.4D0, -0.6D0, 0.72D0,-0.72D0,-0.51D0,  &
     & -0.5D0,-0.48D0,  0.5D0, 0.48D0, -0.5D0,-0.48D0,  0.5D0,-0.48D0,  &
     &  0.5D0, 0.48D0, -0.5D0,-0.48D0, -0.5D0,-0.68D0,-0.68D0, 0.44D0,  &
     &  0.5D0,-0.64D0, -0.1D0,-0.64D0, -0.1D0, -0.4D0,  0.5D0,  0.4D0,  &
     &  0.5D0,  0.4D0,  0.5D0,    0D0,    0D0, -0.4D0, -0.5D0,-0.36D0,  &
     & -0.5D0, 0.36D0, -0.5D0,  0.6D0, -0.6D0,  0.4D0, -0.4D0,  0.4D0,  &
     &  0.4D0, -0.4D0,  0.4D0, -0.4D0,  0.4D0,-0.56D0,-0.56D0, 0.36D0,  &
     & -0.4D0,-0.36D0,  0.4D0, 0.36D0, -0.4D0,-0.36D0, -0.4D0, 0.36D0,  &
     &  0.4D0, 0.36D0,  0.4D0,-0.52D0, 0.52D0, 0.52D0, 0.32D0,  0.4D0,  &
     &-0.32D0,  0.4D0,-0.32D0,  0.4D0,-0.32D0,  0.4D0, 0.32D0, -0.4D0 /
      DATA (A(I),I=2082,2233) /                                         &
     &-0.32D0, -0.4D0, 0.32D0, -0.4D0, 0.28D0, -0.4D0,-0.28D0,  0.4D0,  &
     & 0.28D0, -0.4D0, 0.28D0,  0.4D0, 0.48D0,-0.48D0, 0.48D0, 0.36D0,  &
     & -0.3D0,-0.36D0, -0.3D0,    0D0,    0D0,  0.2D0,  0.4D0,-0.44D0,  &
     & 0.44D0,-0.44D0,-0.44D0,-0.44D0,-0.44D0, 0.32D0, -0.3D0, 0.32D0,  &
     &  0.3D0, 0.24D0,  0.3D0,-0.12D0, -0.1D0,-0.28D0,  0.3D0, 0.28D0,  &
     &  0.3D0, 0.28D0,  0.3D0, 0.28D0, -0.3D0, 0.28D0, -0.3D0, 0.28D0,  &
     & -0.3D0, 0.28D0,  0.3D0,-0.28D0,  0.3D0,  0.4D0,  0.4D0,-0.24D0,  &
     &  0.3D0, 0.24D0, -0.3D0, 0.24D0, -0.3D0,-0.24D0, -0.3D0, 0.24D0,  &
     &  0.3D0, 0.24D0, -0.3D0,-0.24D0,  0.3D0, 0.24D0, -0.3D0,-0.24D0,  &
     & -0.3D0, 0.24D0, -0.3D0, 0.24D0,  0.3D0,-0.24D0,  0.3D0,-0.24D0,  &
     &  0.3D0,  0.2D0, -0.3D0,  0.2D0, -0.3D0,  0.2D0, -0.3D0,  0.2D0,  &
     &  0.3D0,  0.2D0, -0.3D0,  0.2D0, -0.3D0,  0.2D0,  0.3D0,  0.2D0,  &
     &  0.3D0, -0.2D0, -0.3D0,  0.2D0, -0.3D0,  0.2D0, -0.3D0,-0.36D0,  &
     &-0.36D0,-0.36D0,-0.04D0,  0.3D0, 0.12D0, -0.1D0,-0.32D0,-0.24D0,  &
     &  0.2D0, 0.24D0,  0.2D0,  0.2D0, -0.2D0, -0.2D0, -0.2D0, -0.2D0,  &
     & -0.2D0,  0.2D0,  0.2D0,  0.2D0, -0.2D0,  0.2D0,  0.2D0,  0.2D0,  &
     &  0.2D0, -0.2D0, -0.2D0,    0D0,    0D0, -0.2D0, -0.2D0, -0.2D0,  &
     &  0.2D0, -0.2D0,  0.2D0,  0.2D0, -0.2D0, -0.2D0, -0.2D0,  0.2D0,  &
     &  0.2D0,  0.2D0,  0.2D0,  0.2D0, -0.2D0,  0.2D0, -0.2D0, 0.28D0 /
      DATA (A(I),I=2234,2385) /                                         &
     & 0.28D0, 0.28D0, 0.28D0, 0.28D0, 0.28D0,-0.28D0, 0.28D0, 0.12D0,  &
     &    0D0, 0.24D0, 0.16D0, -0.2D0, 0.16D0, -0.2D0, 0.16D0, -0.2D0,  &
     & 0.16D0,  0.2D0,-0.16D0,  0.2D0, 0.16D0,  0.2D0,-0.16D0,  0.2D0,  &
     &-0.16D0,  0.2D0,-0.16D0,  0.2D0, 0.16D0, -0.2D0, 0.16D0,  0.2D0,  &
     & 0.16D0, -0.2D0,-0.16D0,  0.2D0,-0.16D0, -0.2D0,-0.16D0,  0.2D0,  &
     & 0.16D0,  0.2D0, 0.16D0, -0.2D0, 0.16D0, -0.2D0, 0.16D0,  0.2D0,  &
     & 0.16D0,  0.2D0, 0.16D0,  0.2D0,-0.16D0, -0.2D0, 0.16D0,  0.2D0,  &
     &-0.16D0,  0.2D0, 0.16D0,  0.2D0,-0.16D0, -0.2D0, 0.16D0, -0.2D0,  &
     & 0.16D0, -0.2D0,-0.16D0, -0.2D0, 0.24D0,-0.24D0,-0.24D0, 0.24D0,  &
     & 0.24D0, 0.12D0,  0.2D0, 0.12D0,  0.2D0,-0.12D0, -0.2D0, 0.12D0,  &
     & -0.2D0, 0.12D0, -0.2D0,-0.12D0,  0.2D0,-0.12D0,  0.2D0,-0.12D0,  &
     & -0.2D0, 0.12D0,  0.2D0, 0.12D0,  0.2D0, 0.12D0, -0.2D0,-0.12D0,  &
     &  0.2D0, 0.12D0, -0.2D0,-0.12D0,  0.2D0, 0.12D0,  0.2D0,    0D0,  &
     &    0D0,-0.12D0,  0.2D0,-0.12D0,  0.2D0, 0.12D0, -0.2D0,-0.12D0,  &
     &  0.2D0, 0.12D0,  0.2D0,    0D0,-0.21D0, -0.2D0,    0D0,    0D0,  &
     &  0.2D0, -0.2D0, -0.2D0, -0.2D0,  0.2D0,-0.16D0, -0.1D0,    0D0,  &
     & 0.17D0, 0.16D0, 0.16D0, 0.16D0, 0.16D0,-0.16D0, 0.16D0, 0.16D0,  &
     &-0.16D0, 0.16D0,-0.16D0, 0.16D0, 0.12D0,  0.1D0, 0.12D0, -0.1D0,  &
     &-0.12D0,  0.1D0,-0.12D0,  0.1D0, 0.12D0, -0.1D0,-0.12D0, 0.12D0 /
      DATA (A(I),I=2386,2537) /                                         &
     &-0.12D0, 0.12D0,-0.12D0, 0.12D0,-0.12D0,-0.12D0,-0.12D0,-0.12D0,  &
     &-0.12D0,-0.12D0,-0.12D0, 0.12D0, 0.12D0, 0.12D0, 0.12D0,-0.12D0,  &
     &-0.12D0, 0.12D0, 0.12D0, 0.12D0,-0.12D0, 0.12D0,-0.12D0,-0.12D0,  &
     &-0.12D0, 0.12D0,-0.12D0,-0.12D0, 0.12D0,    0D0, 0.11D0, 0.11D0,  &
     &-122.67D0,164.7D0,203.78D0,273.5D0,3.58D0,2.74D0,6.18D0,-4.56D0,  &
     &    0D0,-0.04D0,    0D0,-0.07D0,57.44D0,-77.1D0,95.82D0,128.6D0,  &
     &-1.77D0,-1.28D0, 2.85D0,-2.14D0,82.14D0, 89.5D0,    0D0,    0D0,  &
     &    2D0,-1.84D0,-0.04D0,47.73D0,-64.1D0,23.79D0, 31.9D0,-1.45D0,  &
     &-1.07D0, 0.69D0,-0.53D0,-46.38D0,50.5D0,    0D0,    0D0, 1.13D0,  &
     & 1.04D0, 0.02D0,-18.38D0,   0D0, 63.8D0,    0D0,    0D0, 0.41D0,  &
     &    0D0,-1.43D0,59.07D0,    0D0,    0D0,    0D0,    0D0,-1.32D0,  &
     &57.28D0,    0D0,    0D0,    0D0,    0D0,-1.28D0,-48.65D0,   0D0,  &
     &-1.15D0,    0D0,    0D0, 1.09D0,    0D0, 0.03D0,-18.3D0, 24.6D0,  &
     &-17.3D0,-23.2D0, 0.56D0, 0.41D0,-0.51D0, 0.39D0,-16.91D0,26.9D0,  &
     & 8.43D0, 13.3D0,  0.6D0, 0.38D0, 0.31D0,-0.19D0, 1.23D0, -1.7D0,  &
     &-19.13D0,-25.7D0,-0.03D0,-0.03D0,-0.58D0,0.43D0,-0.72D0,  0.9D0,  &
     &-17.34D0,-23.3D0,0.03D0, 0.02D0,-0.52D0, 0.39D0,-19.49D0,-21.3D0, &
     &    0D0,    0D0,-0.48D0, 0.44D0, 0.01D0,20.57D0,-20.1D0, 0.64D0,  &
     &  0.7D0,-0.45D0,-0.46D0,    0D0,-0.01D0, 4.89D0,  5.9D0,-16.55D0 /
      DATA (A(I),I=2538,2689) /                                         &
     & 19.9D0, 0.14D0,-0.11D0, 0.44D0, 0.37D0,18.22D0, 19.8D0,    0D0,  &
     &    0D0, 0.44D0,-0.41D0,-0.01D0, 4.89D0, -5.3D0,-16.51D0, -18D0,  &
     &-0.11D0,-0.11D0,-0.41D0, 0.37D0,-17.86D0,   0D0, 17.1D0,    0D0,  &
     &    0D0,  0.4D0,    0D0,-0.38D0, 0.32D0,    0D0,24.42D0,    0D0,  &
     &    0D0,-0.01D0,    0D0,-0.55D0,-23.79D0,   0D0,    0D0,    0D0,  &
     &    0D0, 0.53D0,14.72D0,  -16D0,-0.32D0,    0D0,-0.36D0,-0.33D0,  &
     &-0.01D0, 0.01D0, 3.34D0, -4.5D0,11.86D0, 15.9D0,-0.11D0,-0.07D0,  &
     & 0.35D0,-0.27D0,-3.26D0,  4.4D0,11.62D0, 15.6D0, 0.09D0, 0.07D0,  &
     & 0.35D0,-0.26D0,-19.53D0,   0D0, 5.09D0,    0D0,    0D0, 0.44D0,  &
     &    0D0,-0.11D0,-13.48D0,14.7D0,    0D0,    0D0, 0.33D0,  0.3D0,  &
     & 0.01D0,10.86D0,-14.6D0, 3.18D0,  4.3D0,-0.33D0,-0.24D0, 0.09D0,  &
     &-0.07D0,-11.3D0,-15.1D0,    0D0,    0D0,-0.34D0, 0.25D0, 0.01D0,  &
     & 2.03D0, -2.7D0,10.82D0, 14.5D0,-0.07D0,-0.05D0, 0.32D0,-0.24D0,  &
     &17.46D0,    0D0,    0D0,    0D0,    0D0,-0.39D0,16.43D0,    0D0,  &
     & 0.52D0,    0D0,    0D0,-0.37D0,    0D0,-0.01D0, 9.35D0,    0D0,  &
     &13.29D0,    0D0,    0D0,-0.21D0,    0D0, -0.3D0,-10.42D0,11.4D0,  &
     &    0D0,    0D0, 0.25D0, 0.23D0, 0.01D0, 0.44D0,  0.5D0,-10.38D0, &
     & 11.3D0, 0.02D0,-0.01D0, 0.25D0, 0.23D0,-14.64D0,   0D0,    0D0,  &
     &    0D0,    0D0, 0.33D0, 0.56D0,  0.8D0,-8.67D0, 11.7D0, 0.02D0 /
      DATA (A(I),I=2690,2841) /                                         &
     &-0.01D0, 0.26D0, 0.19D0,13.88D0,    0D0,-2.47D0,    0D0,    0D0,  &
     &-0.31D0,    0D0, 0.06D0,-1.99D0,  2.7D0, 7.72D0, 10.3D0, 0.06D0,  &
     & 0.04D0, 0.23D0,-0.17D0, -0.2D0,    0D0,13.05D0,    0D0,    0D0,  &
     &    0D0,    0D0,-0.29D0, 6.92D0, -9.3D0, 3.34D0,  4.5D0,-0.21D0,  &
     &-0.15D0,  0.1D0,-0.07D0, -6.6D0,    0D0, 10.7D0,    0D0,    0D0,  &
     & 0.15D0,    0D0,-0.24D0,-8.04D0, -8.7D0,    0D0,    0D0,-0.19D0,  &
     & 0.18D0,-10.58D0,   0D0, -3.1D0,    0D0,    0D0, 0.24D0,    0D0,  &
     & 0.07D0,-7.32D0,    8D0,-0.12D0, -0.1D0, 0.18D0, 0.16D0, 1.63D0,  &
     &  1.7D0, 6.96D0, -7.6D0, 0.03D0,-0.04D0,-0.17D0,-0.16D0,-3.62D0,  &
     &    0D0, 9.86D0,    0D0,    0D0, 0.08D0,    0D0,-0.22D0,  0.2D0,  &
     & -0.2D0,-6.88D0, -7.5D0,    0D0,    0D0,-0.17D0, 0.15D0,-8.99D0,  &
     &    0D0, 4.02D0,    0D0,    0D0,  0.2D0,    0D0,-0.09D0,-1.07D0,  &
     &  1.4D0,-5.69D0, -7.7D0, 0.03D0, 0.02D0,-0.17D0, 0.13D0, 6.48D0,  &
     & -7.2D0,-0.48D0, -0.5D0,-0.16D0,-0.14D0,-0.01D0, 0.01D0, 5.57D0,  &
     & -7.5D0, 1.07D0,  1.4D0,-0.17D0,-0.12D0, 0.03D0,-0.02D0, 8.71D0,  &
     &    0D0, 3.54D0,    0D0,    0D0,-0.19D0,    0D0,-0.08D0,  0.4D0,  &
     &    0D0, 9.27D0,    0D0,    0D0,-0.01D0,    0D0,-0.21D0,-6.13D0,  &
     &  6.7D0,-1.19D0, -1.3D0, 0.15D0, 0.14D0,-0.03D0, 0.03D0, 5.21D0,  &
     & -5.7D0,-2.51D0, -2.6D0,-0.13D0,-0.12D0,-0.06D0, 0.06D0, 5.69D0 /
      DATA (A(I),I=2842,2993) /                                         &
     & -6.2D0,-0.12D0, -0.1D0,-0.14D0,-0.13D0,-0.01D0, 2.03D0, -2.7D0,  &
     & 4.53D0,  6.1D0,-0.06D0,-0.05D0, 0.14D0, -0.1D0, 5.01D0,  5.5D0,  &
     &-2.51D0,  2.7D0, 0.12D0,-0.11D0, 0.06D0, 0.06D0,-1.91D0,  2.6D0,  &
     &-4.38D0, -5.9D0, 0.06D0, 0.04D0,-0.13D0,  0.1D0, 4.65D0, -6.3D0,  &
     &    0D0,    0D0,-0.14D0, -0.1D0,-5.29D0,  5.7D0,    0D0,    0D0,  &
     & 0.13D0, 0.12D0,-2.23D0,   -4D0,-4.65D0,  4.2D0,-0.09D0, 0.05D0,  &
     &  0.1D0,  0.1D0,-4.53D0,  6.1D0,    0D0,    0D0, 0.14D0,  0.1D0,  &
     & 2.47D0,  2.7D0,-4.46D0,  4.9D0, 0.06D0,-0.06D0, 0.11D0,  0.1D0,  &
     &-5.05D0,  5.5D0, 0.84D0,  0.9D0, 0.12D0, 0.11D0, 0.02D0,-0.02D0,  &
     & 4.97D0, -5.4D0,-1.71D0,    0D0,-0.12D0,-0.11D0,    0D0, 0.04D0,  &
     &-0.99D0, -1.3D0, 4.22D0, -5.7D0,-0.03D0, 0.02D0,-0.13D0,-0.09D0,  &
     & 0.99D0,  1.4D0, 4.22D0, -5.6D0, 0.03D0,-0.02D0,-0.13D0,-0.09D0,  &
     &-4.69D0, -5.2D0,    0D0,    0D0,-0.12D0,  0.1D0,-3.42D0,    0D0,  &
     & 6.09D0,    0D0,    0D0, 0.08D0,    0D0,-0.14D0,-4.65D0, -5.1D0,  &
     &    0D0,    0D0,-0.11D0,  0.1D0,    0D0,    0D0,-4.53D0,   -5D0,  &
     &    0D0,    0D0,-0.11D0,  0.1D0,-2.43D0, -2.7D0,-3.82D0,  4.2D0,  &
     &-0.06D0, 0.05D0,  0.1D0, 0.09D0,    0D0,    0D0,-4.53D0,  4.9D0,  &
     &    0D0,    0D0, 0.11D0,  0.1D0,-4.49D0, -4.9D0,    0D0,    0D0,  &
     &-0.11D0,  0.1D0, 2.67D0, -2.9D0,-3.62D0, -3.9D0,-0.06D0,-0.06D0 /
      DATA (A(I),I=2994,3145) /                                         &
     &-0.09D0, 0.08D0, 3.94D0, -5.3D0,    0D0,    0D0,-0.12D0,-3.38D0,  &
     &  3.7D0,-2.78D0, -3.1D0, 0.08D0, 0.08D0,-0.07D0, 0.06D0, 3.18D0,  &
     & -3.5D0,-2.82D0, -3.1D0,-0.08D0,-0.07D0,-0.07D0, 0.06D0,-5.77D0,  &
     &    0D0, 1.87D0,    0D0,    0D0, 0.13D0,    0D0,-0.04D0, 3.54D0,  &
     & -4.8D0,-0.64D0, -0.9D0,-0.11D0,    0D0,-0.02D0, -3.5D0, -4.7D0,  &
     & 0.68D0, -0.9D0,-0.11D0,    0D0,-0.02D0, 5.49D0,    0D0,    0D0,  &
     &    0D0,    0D0,-0.12D0, 1.83D0, -2.5D0, 2.63D0,  3.5D0,-0.06D0,  &
     &    0D0, 0.08D0, 3.02D0, -4.1D0, 0.68D0,  0.9D0,-0.09D0,    0D0,  &
     & 0.02D0,    0D0,    0D0, 5.21D0,    0D0,    0D0,    0D0,    0D0,  &
     &-0.12D0,-3.54D0,  3.8D0,  2.7D0,  3.6D0,-1.35D0,  1.8D0, 0.08D0,  &
     &    0D0, 0.04D0, -2.9D0,  3.9D0, 0.68D0,  0.9D0, 0.09D0,    0D0,  &
     & 0.02D0,  0.8D0, -1.1D0,-2.78D0, -3.7D0,-0.02D0,    0D0,-0.08D0,  &
     &  4.1D0,    0D0,-2.39D0,    0D0,    0D0,-0.09D0,    0D0, 0.05D0,  &
     &-1.59D0,  2.1D0, 2.27D0,    3D0, 0.05D0,    0D0, 0.07D0,-2.63D0,  &
     &  3.5D0,-0.48D0, -0.6D0,-2.94D0, -3.2D0,-2.94D0,  3.2D0, 2.27D0,  &
     &   -3D0,-1.11D0, -1.5D0,-0.07D0,    0D0,-0.03D0,-0.56D0, -0.8D0,  &
     &-2.35D0,  3.1D0,    0D0, -0.6D0,-3.42D0,  1.9D0,-0.12D0, -0.1D0,  &
     & 2.63D0, -2.9D0, 2.51D0,  2.8D0,-0.64D0,  0.7D0,-0.48D0, -0.6D0,  &
     & 2.19D0, -2.9D0, 0.24D0, -0.3D0, 2.15D0,  2.9D0, 2.15D0, -2.9D0 /
      DATA (A(I),I=3146,3297) /                                         &
     & 0.52D0,  0.7D0, 2.07D0, -2.8D0, -3.1D0,    0D0, 1.79D0,    0D0,  &
     &    0D0, 0.07D0,    0D0,-0.04D0, 0.88D0,    0D0,-3.46D0, 2.11D0,  &
     &  2.8D0,-0.36D0,  0.5D0, 3.54D0, -0.2D0, -3.5D0,-1.39D0,  1.5D0,  &
     &-1.91D0, -2.1D0,-1.47D0,    2D0, 1.39D0,  1.9D0, 2.07D0, -2.3D0,  &
     & 0.91D0,    1D0, 1.99D0, -2.7D0,  3.3D0,    0D0,  0.6D0,-0.44D0,  &
     & -0.7D0,-1.95D0,  2.6D0, 2.15D0, -2.4D0, -0.6D0, -0.7D0,  3.3D0,  &
     & 0.84D0,    0D0, -3.1D0, -3.1D0,    0D0,-0.72D0,-0.32D0,  0.4D0,  &
     &-1.87D0, -2.5D0, 1.87D0, -2.5D0, 0.32D0,  0.4D0,-0.24D0,  0.3D0,  &
     &-1.87D0, -2.5D0,-0.24D0, -0.3D0, 1.87D0, -2.5D0, -2.7D0,    0D0,  &
     & 1.55D0, 2.03D0,  2.2D0,-2.98D0,-1.99D0, -2.2D0, 0.12D0, -0.1D0,  &
     & -0.4D0,  0.5D0, 1.59D0,  2.1D0,    0D0,    0D0,-1.79D0,    2D0,  &
     &-1.03D0,  1.4D0,-1.15D0, -1.6D0, 0.32D0,  0.5D0, 1.39D0, -1.9D0,  &
     & 2.35D0,-1.27D0,  1.7D0,  0.6D0,  0.8D0,-0.32D0, -0.4D0, 1.35D0,  &
     & -1.8D0, 0.44D0,    0D0, 2.23D0,-0.84D0,  0.9D0,-1.27D0, -1.4D0,  &
     &-1.47D0,  1.6D0,-0.28D0, -0.3D0,-0.28D0,  0.4D0,-1.27D0, -1.7D0,  &
     & 0.28D0, -0.4D0,-1.43D0, -1.5D0,    0D0,    0D0,-1.27D0, -1.7D0,  &
     & 2.11D0,-0.32D0, -0.4D0,-1.23D0,  1.6D0, 1.19D0, -1.3D0,-0.72D0,  &
     & -0.8D0, 0.72D0, -0.8D0,-1.15D0, -1.3D0,-1.35D0, -1.5D0,-1.19D0,  &
     & -1.6D0,-0.12D0,  0.2D0, 1.79D0,    0D0,-0.88D0,-0.28D0,  0.4D0 /
      DATA (A(I),I=3298,3449) /                                         &
     & 1.11D0,  1.5D0,-1.83D0,    0D0, 0.56D0,-0.12D0,  0.1D0,-1.27D0,  &
     & -1.4D0,    0D0,    0D0, 1.15D0,  1.5D0,-0.12D0,  0.2D0, 1.11D0,  &
     &  1.5D0, 0.36D0, -0.5D0,-1.07D0, -1.4D0,-1.11D0,  1.5D0, 1.67D0,  &
     &    0D0,  0.8D0,-1.11D0,    0D0, 1.43D0, 1.23D0, -1.3D0,-0.24D0,  &
     &-1.19D0, -1.3D0,-0.24D0,  0.2D0,-0.44D0, -0.9D0,-0.95D0,  1.1D0,  &
     & 1.07D0, -1.4D0, 1.15D0, -1.3D0, 1.03D0, -1.1D0,-0.56D0, -0.6D0,  &
     &-0.68D0,  0.9D0,-0.76D0,   -1D0,-0.24D0, -0.3D0, 0.95D0, -1.3D0,  &
     & 0.56D0,  0.7D0, 0.84D0, -1.1D0,-0.56D0,    0D0,-1.55D0, 0.91D0,  &
     & -1.3D0, 0.28D0,  0.3D0, 0.16D0, -0.2D0, 0.95D0,  1.3D0,  0.4D0,  &
     & -0.5D0,-0.88D0, -1.2D0, 0.95D0, -1.1D0,-0.48D0, -0.5D0,    0D0,  &
     &    0D0,-1.07D0,  1.2D0, 0.44D0, -0.5D0, 0.95D0,  1.1D0,    0D0,  &
     &    0D0, 0.92D0, -1.3D0, 0.95D0,    1D0,-0.52D0,  0.6D0, 1.59D0,  &
     & 0.24D0, -0.4D0, 0.91D0,  1.2D0, 0.84D0, -1.1D0,-0.44D0, -0.6D0,  &
     & 0.84D0,  1.1D0,-0.44D0,  0.6D0,-0.44D0,  0.6D0,-0.84D0, -1.1D0,  &
     & -0.8D0,    0D0, 1.35D0, 0.76D0,  0.2D0,-0.91D0,   -1D0,  0.2D0,  &
     & -0.3D0,-0.91D0, -1.2D0,-0.95D0,    1D0,-0.48D0, -0.5D0, 0.88D0,  &
     &    1D0, 0.48D0, -0.5D0,-0.95D0, -1.1D0,  0.2D0, -0.2D0,-0.99D0,  &
     &  1.1D0,-0.84D0,  1.1D0,-0.24D0, -0.3D0,  0.2D0, -0.3D0, 0.84D0,  &
     &  1.1D0,-1.39D0,    0D0,-0.28D0,-0.16D0,  0.2D0, 0.84D0,  1.1D0 /
      DATA (A(I),I=3450,3601) /                                         &
     &    0D0,    0D0, 1.39D0,    0D0,    0D0,-0.95D0,    1D0, 1.35D0,  &
     &-0.99D0,    0D0, 0.88D0,-0.52D0,    0D0,-1.19D0,  0.2D0,  0.2D0,  &
     & 0.76D0,   -1D0,    0D0,    0D0, 0.76D0,    1D0,    0D0,    0D0,  &
     & 0.76D0,    1D0,-0.76D0,    1D0,    0D0,    0D0, 1.23D0, 0.76D0,  &
     &  0.8D0,-0.32D0,  0.4D0,-0.72D0,  0.8D0, -0.4D0, -0.4D0,    0D0,  &
     &    0D0, -0.8D0, -0.9D0,-0.68D0,  0.9D0,-0.16D0, -0.2D0,-0.16D0,  &
     & -0.2D0, 0.68D0, -0.9D0,-0.36D0,  0.5D0,-0.56D0, -0.8D0, 0.72D0,  &
     & -0.9D0, 0.44D0, -0.6D0,-0.48D0, -0.7D0,-0.16D0,    0D0,-1.11D0,  &
     & 0.32D0,    0D0,-1.07D0,  0.6D0, -0.8D0,-0.28D0, -0.4D0,-0.64D0,  &
     &    0D0, 0.91D0, 1.11D0, 0.64D0, -0.9D0, 0.76D0, -0.8D0,    0D0,  &
     &    0D0,-0.76D0, -0.8D0, 1.03D0,    0D0,-0.36D0,-0.64D0, -0.7D0,  &
     & 0.36D0, -0.4D0, 1.07D0, 0.36D0, -0.5D0,-0.52D0, -0.7D0,  0.6D0,  &
     &    0D0, 0.88D0, 0.95D0,    0D0, 0.48D0, 0.16D0, -0.2D0,  0.6D0,  &
     &  0.8D0, 0.16D0, -0.2D0, -0.6D0, -0.8D0,    0D0,   -1D0, 0.12D0,  &
     &  0.2D0, 0.16D0, -0.2D0, 0.68D0,  0.7D0, 0.59D0, -0.8D0,-0.99D0,  &
     &-0.56D0, -0.6D0, 0.36D0, -0.4D0,-0.68D0, -0.7D0,-0.68D0, -0.7D0,  &
     &-0.36D0, -0.5D0,-0.44D0,  0.6D0, 0.64D0,  0.7D0,-0.12D0,  0.1D0,  &
     &-0.52D0,  0.6D0, 0.36D0,  0.4D0,    0D0,    0D0, 0.95D0,-0.84D0,  &
     &    0D0, 0.44D0, 0.56D0,  0.6D0, 0.32D0, -0.3D0,    0D0,    0D0 /
      DATA (A(I),I=3602,3753) /                                         &
     &  0.6D0,  0.7D0,    0D0,    0D0,  0.6D0,  0.7D0,-0.12D0, -0.2D0,  &
     & 0.52D0, -0.7D0,    0D0,    0D0, 0.56D0,  0.7D0,-0.12D0,  0.1D0,  &
     &-0.52D0, -0.7D0,    0D0,    0D0, 0.88D0,-0.76D0,    0D0,-0.44D0,  &
     &    0D0,    0D0,-0.52D0, -0.7D0, 0.52D0, -0.7D0, 0.36D0, -0.4D0,  &
     &-0.44D0, -0.5D0,    0D0,    0D0,  0.6D0,  0.6D0, 0.84D0,    0D0,  &
     & 0.12D0,-0.24D0,    0D0,  0.8D0,-0.56D0,  0.6D0,-0.32D0, -0.3D0,  &
     & 0.48D0, -0.5D0, 0.28D0, -0.3D0,-0.48D0, -0.5D0, 0.12D0,  0.2D0,  &
     & 0.48D0, -0.6D0, 0.48D0,  0.6D0,-0.12D0,  0.2D0, 0.24D0,    0D0,  &
     & 0.76D0,-0.52D0, -0.6D0,-0.52D0,  0.6D0, 0.48D0, -0.5D0,-0.24D0,  &
     & -0.3D0, 0.12D0, -0.1D0, 0.48D0,  0.6D0, 0.52D0, -0.2D0, 0.36D0,  &
     &  0.4D0,-0.44D0,  0.5D0,-0.24D0, -0.3D0,-0.48D0, -0.6D0,-0.44D0,  &
     & -0.6D0,-0.12D0,  0.1D0, 0.76D0, 0.76D0,  0.2D0, -0.2D0, 0.48D0,  &
     &  0.5D0,  0.4D0, -0.5D0,-0.24D0, -0.3D0, 0.44D0, -0.6D0, 0.44D0,  &
     & -0.6D0, 0.36D0,    0D0,-0.64D0, 0.72D0,    0D0,-0.12D0,    0D0,  &
     & -0.1D0, -0.4D0, -0.6D0, -0.2D0, -0.2D0,-0.44D0,  0.5D0,-0.44D0,  &
     &  0.5D0,  0.2D0,  0.2D0,-0.44D0, -0.5D0,  0.2D0, -0.2D0, -0.2D0,  &
     &  0.2D0,-0.44D0, -0.5D0, 0.64D0,    0D0, 0.32D0,-0.36D0,  0.5D0,  &
     & -0.2D0, -0.3D0, 0.12D0, -0.1D0, 0.48D0,  0.5D0,-0.12D0,  0.3D0,  &
     &-0.36D0, -0.5D0,    0D0,    0D0, 0.48D0,  0.5D0,-0.48D0,  0.5D0 /
      DATA (A(I),I=3754,3905) /                                         &
     & 0.68D0,    0D0,-0.12D0, 0.56D0, -0.4D0, 0.44D0, -0.5D0,-0.12D0,  &
     & -0.1D0, 0.24D0,  0.3D0, -0.4D0,  0.4D0, 0.64D0,    0D0,-0.24D0,  &
     & 0.64D0,    0D0, -0.2D0,    0D0,    0D0, 0.44D0, -0.5D0, 0.44D0,  &
     &  0.5D0,-0.12D0,  0.2D0,-0.36D0, -0.5D0, 0.12D0,    0D0, 0.64D0,  &
     & -0.4D0,  0.5D0,    0D0,  0.1D0,    0D0,    0D0, -0.4D0,  0.5D0,  &
     &    0D0,    0D0, -0.4D0, -0.5D0, 0.56D0,    0D0, 0.28D0,    0D0,  &
     &  0.1D0, 0.36D0,  0.5D0,    0D0, -0.1D0, 0.36D0, -0.5D0, 0.36D0,  &
     &  0.5D0,    0D0, -0.1D0, 0.24D0, -0.2D0,-0.36D0, -0.4D0, 0.16D0,  &
     &  0.2D0,  0.4D0, -0.4D0,    0D0,    0D0,-0.36D0, -0.5D0,-0.36D0,  &
     & -0.5D0,-0.32D0, -0.5D0,-0.12D0,  0.1D0,  0.2D0,  0.2D0,-0.36D0,  &
     &  0.4D0, -0.6D0,  0.6D0, 0.28D0,    0D0, 0.52D0, 0.12D0, -0.1D0,  &
     &  0.4D0,  0.4D0,    0D0, -0.5D0,  0.2D0, -0.2D0,-0.32D0,  0.4D0,  &
     & 0.16D0,  0.2D0,-0.16D0,  0.2D0, 0.32D0,  0.4D0, 0.56D0,    0D0,  &
     &-0.12D0, 0.32D0, -0.4D0,-0.16D0, -0.2D0,    0D0,    0D0,  0.4D0,  &
     &  0.4D0, -0.4D0, -0.4D0, -0.4D0,  0.4D0,-0.36D0,  0.4D0, 0.12D0,  &
     &  0.1D0,    0D0,  0.1D0, 0.36D0,  0.4D0,    0D0, -0.1D0, 0.36D0,  &
     &  0.4D0,-0.36D0,  0.4D0,    0D0,  0.1D0, 0.32D0,    0D0, 0.44D0,  &
     & 0.12D0,  0.2D0, 0.28D0, -0.4D0,    0D0,    0D0, 0.36D0,  0.4D0,  &
     & 0.32D0, -0.4D0,-0.16D0, 0.12D0,  0.1D0, 0.32D0, -0.4D0,  0.2D0 /
      DATA (A(I),I=3906,4057) /                                         &
     &  0.3D0,-0.24D0,  0.3D0,    0D0,  0.1D0, 0.32D0,  0.4D0,    0D0,  &
     & -0.1D0,-0.32D0, -0.4D0,-0.32D0,  0.4D0,    0D0,  0.1D0,-0.52D0,  &
     &-0.52D0, 0.52D0, 0.32D0, -0.4D0,    0D0,    0D0, 0.32D0,  0.4D0,  &
     & 0.32D0, -0.4D0,    0D0,    0D0,-0.32D0, -0.4D0,-0.32D0,  0.4D0,  &
     & 0.32D0,  0.4D0,    0D0,    0D0, 0.32D0,  0.4D0,    0D0,    0D0,  &
     &-0.32D0, -0.4D0,    0D0,    0D0, 0.32D0,  0.4D0, 0.16D0,  0.2D0,  &
     & 0.32D0, -0.3D0,-0.16D0,    0D0,-0.48D0, -0.2D0,  0.2D0,-0.28D0,  &
     & -0.3D0, 0.28D0, -0.4D0,    0D0,    0D0, 0.28D0, -0.4D0,    0D0,  &
     &    0D0, 0.28D0, -0.4D0,    0D0,    0D0,-0.28D0, -0.4D0, 0.28D0,  &
     &  0.4D0,-0.28D0, -0.4D0,-0.48D0, -0.2D0,  0.2D0, 0.24D0,  0.3D0,  &
     & 0.44D0,    0D0, 0.16D0, 0.24D0,  0.3D0, 0.16D0, -0.2D0, 0.24D0,  &
     &  0.3D0,-0.12D0,  0.2D0,  0.2D0,  0.3D0,-0.16D0,  0.2D0,    0D0,  &
     &    0D0, 0.44D0,-0.32D0,  0.3D0, 0.24D0,    0D0,-0.36D0, 0.36D0,  &
     &    0D0, 0.24D0, 0.12D0, -0.2D0,  0.2D0,  0.3D0,-0.12D0,    0D0,  &
     &-0.28D0,  0.3D0,-0.24D0,  0.3D0, 0.12D0,  0.1D0,-0.28D0, -0.3D0,  &
     &-0.28D0,  0.3D0,    0D0,    0D0,-0.28D0, -0.3D0,    0D0,    0D0,  &
     &-0.28D0, -0.3D0,    0D0,    0D0, 0.28D0,  0.3D0,    0D0,    0D0,  &
     &-0.28D0, -0.3D0,-0.28D0,  0.3D0,    0D0,    0D0,-0.28D0, -0.3D0,  &
     &    0D0,    0D0, 0.28D0,  0.3D0,    0D0,    0D0,-0.28D0,  0.3D0 /
      DATA (A(I),I=4058,4209) /                                         &
     & 0.28D0, -0.3D0,-0.28D0,  0.3D0,  0.4D0,  0.4D0,-0.24D0,  0.3D0,  &
     &    0D0, -0.1D0, 0.16D0,    0D0, 0.36D0, -0.2D0,  0.3D0,-0.12D0,  &
     & -0.1D0,-0.24D0, -0.3D0,    0D0,    0D0,-0.24D0,  0.3D0,-0.24D0,  &
     &  0.3D0,    0D0,    0D0,-0.24D0,  0.3D0,-0.24D0,  0.3D0, 0.24D0,  &
     & -0.3D0,    0D0,    0D0, 0.24D0, -0.3D0,    0D0,    0D0, 0.24D0,  &
     &  0.3D0, 0.24D0, -0.3D0, 0.24D0,  0.3D0,-0.24D0,  0.3D0,-0.24D0,  &
     &  0.3D0, -0.2D0,  0.2D0,-0.16D0, -0.2D0,    0D0,    0D0,-0.32D0,  &
     &  0.2D0,    0D0,  0.1D0,  0.2D0, -0.3D0,  0.2D0, -0.2D0, 0.12D0,  &
     &  0.2D0,-0.16D0,  0.2D0, 0.16D0,  0.2D0,  0.2D0,  0.3D0,  0.2D0,  &
     &  0.3D0,    0D0,    0D0, -0.2D0,  0.3D0,    0D0,    0D0,  0.2D0,  &
     &  0.3D0, -0.2D0, -0.3D0, -0.2D0, -0.3D0,  0.2D0, -0.3D0,    0D0,  &
     &    0D0,  0.2D0,  0.3D0,    0D0,    0D0,  0.2D0,  0.3D0,    0D0,  &
     &    0D0,  0.2D0,  0.3D0,    0D0,    0D0,  0.2D0,  0.3D0,    0D0,  &
     &    0D0,  0.2D0, -0.3D0,    0D0,    0D0, -0.2D0, -0.3D0,    0D0,  &
     &    0D0, -0.2D0,  0.3D0,    0D0,    0D0, -0.2D0,  0.3D0,    0D0,  &
     &    0D0, 0.36D0,    0D0,    0D0, 0.36D0, 0.12D0,  0.1D0,-0.24D0,  &
     &  0.2D0, 0.12D0, -0.2D0,-0.16D0, -0.2D0,-0.13D0,  0.1D0, 0.22D0,  &
     & 0.21D0,  0.2D0,    0D0,-0.28D0, 0.32D0,    0D0,-0.12D0, -0.2D0,  &
     & -0.2D0, 0.12D0, -0.1D0, 0.12D0,  0.1D0, -0.2D0,  0.2D0,    0D0 /
      DATA (A(I),I=4210,4361) /                                         &
     &    0D0,-0.32D0, 0.32D0,    0D0,    0D0, 0.32D0, 0.32D0,    0D0,  &
     &    0D0,-0.24D0, -0.2D0, 0.24D0,  0.2D0,  0.2D0,    0D0,-0.24D0,  &
     &    0D0,    0D0,-0.24D0, -0.2D0,    0D0,    0D0, 0.24D0,  0.2D0,  &
     &-0.24D0, -0.2D0,    0D0,    0D0,-0.24D0,  0.2D0, 0.16D0, -0.2D0,  &
     & 0.12D0,  0.1D0,  0.2D0,  0.2D0,    0D0, -0.1D0,-0.12D0,  0.1D0,  &
     &-0.16D0, -0.2D0,-0.12D0, -0.1D0,-0.16D0,  0.2D0,  0.2D0,  0.2D0,  &
     &    0D0,    0D0, -0.2D0,  0.2D0, -0.2D0,  0.2D0, -0.2D0,  0.2D0,  &
     & -0.2D0,  0.2D0,  0.2D0, -0.2D0, -0.2D0, -0.2D0,    0D0,    0D0,  &
     & -0.2D0,  0.2D0,  0.2D0,    0D0, -0.2D0,    0D0,    0D0, -0.2D0,  &
     &  0.2D0, -0.2D0,  0.2D0, -0.2D0, -0.2D0, -0.2D0, -0.2D0,    0D0,  &
     &    0D0,  0.2D0,  0.2D0,  0.2D0,  0.2D0, 0.12D0, -0.2D0,-0.12D0,  &
     & -0.1D0, 0.28D0,-0.28D0, 0.16D0, -0.2D0,    0D0, -0.1D0,    0D0,  &
     &  0.1D0,-0.16D0,  0.2D0,    0D0, -0.1D0,-0.16D0, -0.2D0,    0D0,  &
     & -0.1D0, 0.16D0, -0.2D0, 0.16D0, -0.2D0,    0D0,    0D0, 0.16D0,  &
     &  0.2D0,-0.16D0,  0.2D0,    0D0,    0D0, 0.16D0,  0.2D0, 0.16D0,  &
     & -0.2D0, 0.16D0, -0.2D0,-0.16D0,  0.2D0, 0.16D0, -0.2D0,    0D0,  &
     &    0D0, 0.16D0,  0.2D0,    0D0,    0D0, 0.16D0,  0.2D0,    0D0,  &
     &    0D0,-0.16D0, -0.2D0, 0.16D0, -0.2D0,-0.16D0, -0.2D0,    0D0,  &
     &    0D0,-0.16D0, -0.2D0,    0D0,    0D0,-0.16D0,  0.2D0,    0D0 /
      DATA (A(I),I=4362,4513) /                                         &
     &    0D0, 0.16D0, -0.2D0, 0.16D0,  0.2D0, 0.16D0,  0.2D0,    0D0,  &
     &    0D0,-0.16D0, -0.2D0,    0D0,    0D0,-0.16D0, -0.2D0,    0D0,  &
     &    0D0, 0.16D0,  0.2D0, 0.16D0,  0.2D0,    0D0,    0D0, 0.16D0,  &
     &  0.2D0, 0.16D0, -0.2D0, 0.16D0,  0.2D0,    0D0,    0D0,-0.16D0,  &
     &  0.2D0,    0D0,  0.1D0, 0.12D0, -0.2D0, 0.12D0, -0.2D0,    0D0,  &
     & -0.1D0,    0D0, -0.1D0, 0.12D0,  0.2D0,    0D0, -0.1D0,-0.12D0,  &
     &  0.2D0,-0.15D0,  0.2D0,-0.24D0, 0.24D0,    0D0,    0D0, 0.24D0,  &
     & 0.24D0, 0.12D0, -0.2D0,-0.12D0, -0.2D0,    0D0,    0D0, 0.12D0,  &
     &  0.2D0, 0.12D0, -0.2D0, 0.12D0,  0.2D0, 0.12D0,  0.2D0, 0.12D0,  &
     &  0.2D0, 0.12D0, -0.2D0,-0.12D0,  0.2D0,    0D0,    0D0, 0.12D0,  &
     &  0.2D0, 0.12D0,    0D0, -0.2D0,    0D0,    0D0,-0.12D0, -0.2D0,  &
     & 0.12D0, -0.2D0,    0D0,    0D0, 0.12D0,  0.2D0,-0.12D0,  0.2D0,  &
     &-0.12D0,  0.2D0, 0.12D0, -0.2D0,    0D0,    0D0, 0.12D0,  0.2D0,  &
     &  0.2D0,    0D0, 0.12D0,    0D0,    0D0,-0.12D0,  0.2D0,    0D0,  &
     &    0D0,-0.12D0, -0.2D0,    0D0,    0D0,-0.12D0, -0.2D0,-0.12D0,  &
     & -0.2D0,    0D0,    0D0, 0.12D0, -0.2D0, 0.12D0, -0.2D0, 0.12D0,  &
     &  0.2D0,-0.12D0, -0.2D0,    0D0,    0D0, 0.12D0, -0.2D0, 0.12D0,  &
     & -0.2D0, 0.12D0,  0.2D0, 0.12D0,    0D0,  0.2D0,-0.12D0, -0.2D0,  &
     &    0D0,    0D0, 0.12D0,  0.2D0,-0.16D0,    0D0, 0.16D0, -0.2D0 /
      DATA (A(I),I=4514,4665) /                                         &
     &  0.2D0,    0D0,    0D0, -0.2D0,    0D0,    0D0, -0.2D0,  0.2D0,  &
     &    0D0,    0D0,  0.2D0,  0.2D0, -0.2D0,    0D0,    0D0, -0.2D0,  &
     & 0.12D0,    0D0,-0.16D0,  0.2D0,    0D0,    0D0,  0.2D0, 0.12D0,  &
     & -0.1D0,    0D0,  0.1D0, 0.16D0,-0.16D0,-0.16D0,-0.16D0,-0.16D0,  &
     &-0.16D0,    0D0,    0D0,-0.16D0,    0D0,    0D0,-0.16D0,-0.16D0,  &
     &-0.16D0,    0D0,    0D0,-0.16D0,    0D0,    0D0, 0.16D0,    0D0,  &
     &    0D0, 0.16D0,    0D0,    0D0, 0.16D0, 0.16D0,    0D0,    0D0,  &
     &-0.16D0,    0D0,    0D0,-0.16D0,-0.16D0,    0D0,    0D0, 0.16D0,  &
     &    0D0,    0D0,-0.16D0,-0.16D0,    0D0,    0D0,-0.16D0,-0.16D0,  &
     & 0.12D0,  0.1D0, 0.12D0, -0.1D0, 0.12D0,  0.1D0,    0D0,    0D0,  &
     & 0.12D0,  0.1D0,-0.12D0,  0.1D0,    0D0,    0D0, 0.12D0,  0.1D0,  &
     & 0.12D0, -0.1D0,    0D0,    0D0,-0.12D0, -0.1D0,    0D0,    0D0,  &
     & 0.12D0,  0.1D0, 0.12D0,    0D0,    0D0, 0.12D0,    0D0,    0D0,  &
     &-0.12D0,    0D0,    0D0, 0.12D0, 0.12D0, 0.12D0, 0.12D0, 0.12D0,  &
     &    0D0,    0D0, 0.12D0,    0D0,    0D0, 0.12D0, 0.12D0,    0D0,  &
     &    0D0, 0.12D0,    0D0,    0D0, 0.12D0,-0.12D0,-0.12D0, 0.12D0,  &
     & 0.12D0,-0.12D0,-0.12D0,    0D0,    0D0, 0.12D0,-0.12D0, 0.12D0,  &
     & 0.12D0,-0.12D0,-0.12D0,    0D0,    0D0,-0.12D0,-0.12D0,    0D0,  &
     &    0D0,-0.12D0, 0.12D0,    0D0,    0D0, 0.12D0,    0D0,    0D0 /
      DATA (A(I),I=4666,NA) /                                           &
     & 0.12D0,    0D0,    0D0, 0.12D0,-0.12D0,    0D0,    0D0,-0.12D0,  &
     & 0.12D0,-0.12D0,-0.12D0, 0.12D0,    0D0,    0D0, 0.12D0, 0.12D0,  &
     & 0.12D0,-0.12D0,    0D0,    0D0,-0.12D0,-0.12D0,-0.12D0,    0D0,  &
     &    0D0,-0.12D0,-0.12D0,    0D0,    0D0, 0.12D0, 0.12D0,    0D0,  &
     &    0D0,-0.12D0,-0.12D0,-0.12D0,-0.12D0, 0.12D0,    0D0,    0D0,  &
     & 0.12D0,-0.12D0,    0D0,    0D0,-0.12D0,-0.12D0,    0D0,    0D0,  &
     & 0.12D0,-0.12D0,-0.12D0,-0.12D0,-0.12D0, 0.12D0, 0.12D0,-0.12D0,  &
     &-0.12D0,    0D0,    0D0,-0.12D0,    0D0,    0D0,-0.12D0, 0.12D0,  &
     &    0D0,    0D0, 0.12D0,    0D0,    0D0,-0.12D0,-0.12D0,    0D0,  &
     &    0D0,-0.12D0,-0.12D0, 0.12D0,    0D0,    0D0, 0.12D0, 0.12D0,  &
     &    0D0,    0D0, 0.12D0,    0D0,    0D0, 0.12D0, 0.12D0, 0.08D0,  &
     &    0D0, 0.04D0 /
!
!  Amplitude usage: X or Y, sin or cos, power of T.
      DATA JAXY / 0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1 /
      DATA JASC / 0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0 /
      DATA JAPT / 0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4 /
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!!    DATE1 = XJD
!!    DATE2 = TT
!  Interval between fundamental date J2000.0 and given date (JC).
!!    T = ( ( DATE1-DJ00 ) + DATE2 ) / DJC
!
       T = CENT
       dTdt = DCENT
!     Write(6,1899) CENT, DCENT 
 1899 Format (' CENT, DCENT: ',2E25.15)
!
!  Powers of T.
!     W = 1D0
!     DO 1 JPT=0,MAXPT
!        PT(JPT) = W
!        W = W*T
!1    CONTINUE
!
      PT(0) = 1.D0
       d_PT(0) = 0.D0
      PT(1) = T 
       d_PT(1) = dTdt
      PT(2) = T*T 
       d_PT(2) = 2.D0*T*dTdt
      PT(3) = T*T*T 
       d_PT(3) = 3.D0*T*T*dTdt
      PT(4) = T*T*T*T 
       d_PT(4) = 4.D0*T*T*T*dTdt
      PT(5) = T*T*T*T*T
       d_PT(5) = 5.D0*T*T*T*T*dTdt
!
!     Write(6,1901) PT(0),PT(1),PT(2),PT(3),PT(4),PT(5) 
 1901 Format ('PT:   ',6E25.15)
!     Write(6,1902) d_PT(0),d_PT(1),d_PT(2),d_PT(3),d_PT(4),d_PT(5)
 1902 Format ('d_PT: ',6E25.15)
!
!  --------------------------------------
!  Polynomial part of precession-nutation
!  --------------------------------------
!
      DO 3 JXY=0,1
         XYPR(JXY) = 0.D0
         d_XYPR(JXY) = 0.D0
         DO 2 J=MAXPT,0,-1
            XYPR(JXY) = XYPR(JXY) + XYP(J,JXY)*PT(J)
!              Compute time derivative of XYPR.
            d_XYPR(JXY) = d_XYPR(JXY) + XYP(J,JXY)*d_PT(J)
 2       CONTINUE
 3    CONTINUE
!     Write(6,1903) XYPR(0), XYPR(1), d_XYPR(0), d_XYPR(1) 
 1903 Format ('XYPR,d_XYPR: ',4E25.15)
!
!  ----------------------------------
!  Nutation periodic terms, planetary
!  ----------------------------------
!
!  Initialize totals in X and Y.
      DO 4 JXY=0,1
         XYPL(JXY) = 0.D0
          d_XYPL(JXY) = 0.D0
 4    CONTINUE
!
!  Work backwards through the coefficients per frequency list.
      IALAST = NA
      DO 7 IFREQ=NFPL,1,-1
!
!     Obtain the argument functions.
         ARG = 0.D0
          d_ARG = 0.D0
         DO 5 I=1,14
            M = MFAPL(I,IFREQ)
            IF ( M.NE.0 ) ARG = ARG + DBLE(M)*FA2K(I)
!              Compute time derivative of ARG.
             IF ( M.NE.0 ) d_ARG = d_ARG + DBLE(M)*FAD2K(I)
 5       CONTINUE
         SC(0) = SIN(ARG)
         SC(1) = COS(ARG)
!              Compute time derivatives.
          d_SC(0) =  COS(ARG)*d_ARG
          d_SC(1) = -SIN(ARG)*d_ARG
!
!     Work backwards through the amplitudes at this frequency.
         IA = NC(IFREQ+NFLS)
         DO 6 I=IALAST,IA,-1
!
!        Coefficient number (0 = 1st).
            J = I-IA
!
!        X or Y.
            JXY = JAXY(J)
!
!        Sin or cos.
            JSC = JASC(J)
!
!        Power of T.
            JPT = JAPT(J)
!
!        Accumulate the component.
            XYPL(JXY) = XYPL(JXY) + A(I)*SC(JSC)*PT(JPT)
!              Compute time derivative.
             d_XYPL(JXY) = d_XYPL(JXY) + A(I)*d_SC(JSC)*PT(JPT)         &
     &                  + A(I)*SC(JSC)*d_PT(JPT)
 6       CONTINUE
         IALAST = IA-1
 7    CONTINUE
!
!     Write(6,1913) ARG, D_ARG 
 1913 Format ('ARG, D_ARG: ',2E25.15)
!     Write(6,1914) SC(0),SC(1),d_SC(0),d_SC(1) 
 1914 Format ('SC(0),SC(1),d_SC(0),d_SC(1): ',4E25.15)
!     Write(6,1904) XYPL(0), XYPL(1), d_XYPL(0), d_XYPL(1) 
 1904 Format ('XYPL,d_XYPL: ',4E25.15)
!
!  -----------------------------------
!  Nutation periodic terms, luni-solar
!  -----------------------------------
!
!  Initialize totals in X and Y.
      DO 8 JXY=0,1
         XYLS(JXY) = 0.D0
          d_XYLS(JXY) = 0.D0
 8    CONTINUE
!
!  Continue working backwards through the number of coefficients list.
      DO 11 IFREQ=NFLS,1,-1
!
!     Obtain the argument functions.
         ARG = 0D0
          d_ARG = 0.D0
         DO 9 I=1,5
            M = MFALS(I,IFREQ)
            IF ( M.NE.0 ) ARG = ARG + DBLE(M)*FA2K(I)
!              Compute time derivative of ARG.
             IF ( M.NE.0 ) d_ARG = d_ARG + DBLE(M)*FAD2K(I)
 9       CONTINUE
         SC(0) = SIN(ARG)
         SC(1) = COS(ARG)
!              Compute time derivatives.
          d_SC(0) =  COS(ARG)*d_ARG
          d_SC(1) = -SIN(ARG)*d_ARG
!
!     Work backwards through the amplitudes at this frequency.
         IA = NC(IFREQ)
         DO 10 I=IALAST,IA,-1
!
!        Coefficient number (0 = 1st).
            J = I-IA
!
!        X or Y.
            JXY = JAXY(J)
!
!        Sin or cos.
            JSC = JASC(J)
!
!        Power of T.
            JPT = JAPT(J)
!
!        Accumulate the component.
            XYLS(JXY) = XYLS(JXY) + A(I)*SC(JSC)*PT(JPT)
!              Compute time derivative.
             d_XYLS(JXY) = d_XYLS(JXY) + A(I)*d_SC(JSC)*PT(JPT)         &
     &                  + A(I)*SC(JSC)*d_PT(JPT)
 10      CONTINUE
         IALAST = IA-1
 11   CONTINUE
!
!     Write(6,1923) ARG, D_ARG 
 1923 Format ('ARG, D_ARG: ',2E25.15)
!     Write(6,1924) SC(0),SC(1),d_SC(0),d_SC(1) 
 1924 Format ('SC(0),SC(1),d_SC(0),d_SC(1): ',4E25.15)
!     Write(6,1906) XYLS(0), XYLS(1), d_XYLS(0), d_XYLS(1) 
 1906 Format ('XYLS,d_XYLS: ',4E25.15)
!
!  -------
!  Results
!  -------
!
!  CIP unit vector components.
      X(1) = DAS2R * ( XYPR(0) + ( XYLS(0) + XYPL(0) )/1D6 )
      Y(1) = DAS2R * ( XYPR(1) + ( XYLS(1) + XYPL(1) )/1D6 )
!              Compute time derivatives.
      X(2) = DAS2R * ( d_XYPR(0) + ( d_XYLS(0) + d_XYPL(0) )/1D6 )
      Y(2) = DAS2R * ( d_XYPR(1) + ( d_XYLS(1) + d_XYPL(1) )/1D6 )
!
!  Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2010
!  Standards Of Fundamental Astronomy Board
!  of the International Astronomical Union.
!
!  =====================
!  SOFA Software License
!  =====================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING TERMS AND CONDITIONS
!  WHICH APPLY TO ITS USE.
!
!  1. The Software is owned by the IAU SOFA Board ("SOFA").
!
!  2. Permission is granted to anyone to use the SOFA software for any
!     purpose, including commercial applications, free of charge and
!     without payment of royalties, subject to the conditions and
!     restrictions listed below.
!
!  3. You (the user) may copy and distribute SOFA source code to others,
!     and use and adapt its code and algorithms in your own software,
!     on a world-wide, royalty-free basis.  That portion of your
!     distribution that does not consist of intact and unchanged copies
!     of SOFA source code files is a "derived work" that must comply
!     with the following requirements:
!
!     a) Your work shall be marked or carry a statement that it
!        (i) uses routines and computations derived by you from
!        software provided by SOFA under license to you; and
!        (ii) does not itself constitute software provided by and/or
!        endorsed by SOFA.
!
!     b) The source code of your derived work must contain descriptions
!        of how the derived work is based upon, contains and/or differs
!        from the original SOFA software.
!
!     c) The name(s) of all routine(s) in your derived work shall not
!        include the prefix "iau".
!
!     d) The origin of the SOFA components of your derived work must
!        not be misrepresented;  you must not claim that you wrote the
!        original software, nor file a patent application for SOFA
!        software or algorithms embedded in the SOFA software.
!
!     e) These requirements must be reproduced intact in any source
!        distribution and shall apply to anyone to whom you have
!        granted a further right to modify the source code of your
!        derived work.
!
!     Note that, as originally distributed, the SOFA software is
!     intended to be a definitive implementation of the IAU standards,
!     and consequently third-party modifications are discouraged.  All
!     variations, no matter how minor, must be explicitly marked as
!     such, as explained above.
!
!  4. In any published work or commercial products which includes
!     results achieved by using the SOFA software, you shall
!     acknowledge that the SOFA software was used in obtaining those
!     results.
!
!  5. You shall not cause the SOFA software to be brought into
!     disrepute, either by misuse, or use for inappropriate tasks, or
!     by inappropriate modification.
!
!  6. The SOFA software is provided "as is" and SOFA makes no warranty
!     as to its use or performance.   SOFA does not and cannot warrant
!     the performance or results which the user may obtain by using the
!     SOFA software.  SOFA makes no warranties, express or implied, as
!     to non-infringement of third party rights, merchantability, or
!     fitness for any particular purpose.  In no event will SOFA be
!     liable to the user for any consequential, incidental, or special
!     damages, including any lost profits or lost savings, even if a
!     SOFA representative has been advised of such damages, or for any
!     claim by any third party.
!
!  7. The provision of any version of the SOFA software under the terms
!     and conditions specified herein does not imply that future
!     versions will also be made available under the same terms and
!     conditions.
!
!  Correspondence concerning SOFA software should be addressed as
!  follows:
!
!      By email:  sofa@ukho.gov.uk
!      By post:   IAU SOFA Center
!                 HM Nautical Almanac Office
!                 UK Hydrographic Office
!                 Admiralty Way, Taunton
!                 Somerset, TA1 2DN
!                 United Kingdom
!
!----------------------------------------------------------------------
!
      END
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      SUBROUTINE S02K6 (XJD,TT,CENT,DCENT,FA2K,FAD2K,X,Y,S06)
!     REAL*8   FUNCTION iau_S06 ( DATE1, DATE2, X, Y, FA2K, FAD2K )
! 
!  The CIO locator s, positioning the Celestial Intermediate Origin on
!  the equator of the Celestial Intermediate Pole, given the CIP's X,Y
!  coordinates.  Compatible with IAU 2006/2000A precession-nutation.
!
!  - - - - - - - - -
!   S02K6 - Modified version of function iau_S06 from the SOFA software 
!           collection (IAU's Standards of Fundamental Astronomy
!           software collection).
!           Modifications made, April 2012: 
!            -Converted to Fortran 90.
!            -Converted to a subroutine.
!            -Fundamental arguments passed in, rather than computed.
!            -Time in centuries passed in, rather than computed.
!            -Name changed to S02K6.
!            -Time derivatives added.
!  - - - - - - - - -
!
!  Given:
!     X,Y            d      CIP coordinates (Note 3)
!
!  Returned:
!     S06        d      the CIO locator s in radians (Note 2)
!
!  Notes:
!
!  1) The time argument is in Julian centuries since January 1.5, 
!     2000, using time in TT.
!
!  2) The CIO locator s is the difference between the right ascensions
!     of the same point in two systems: the two systems are the GCRS
!     and the CIP,CIO, and the point is the ascending node of the
!     CIP equator.  The quantity s remains below 0.1 arcsecond
!     throughout 1900-2100.
!
!  3) The series used to compute s is in fact for s+XY/2, where X and Y
!     are the x and y components of the CIP unit vector;  this series is
!     more compact than a direct series for s would be.  This routine
!     requires X,Y to be supplied by the caller, who is responsible for
!     providing values that are consistent with the supplied date.
!
!  4) The model is consistent with the "P03" precession (Capitaine et
!     al. 2003), adopted by IAU 2006 Resolution 1, 2006, and the
!     IAU 2000A nutation (with P03 adjustments).
!
!  References:
!
!     Capitaine, N., Wallace, P.T. & Chapront, J., 2003, Astron.
!     Astrophys. 432, 355
!
!     McCarthy, D.D., Petit, G. (eds.) 2004, IERS Conventions (2003),
!     IERS Technical Note No. 32, BKG
!
!  This revision:   2009 December 15
!
!  SOFA release 2010-12-01
!
!  Copyright (C) 2010 IAU SOFA Board.  See notes at end.
!
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
!
      REAL*8 DATE1, DATE2, X(2), Y(2), FA2K(14), FAD2K(14), XJD, TT,    &
     &       CENT, DCENT, S06(2)
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!  Arcseconds to radians
      REAL*8            DAS2R
      PARAMETER ( DAS2R = 4.848136811095359935899141D-6 )
!
!  Reference epoch (J2000.0), JD
      REAL*8            DJ00
      PARAMETER ( DJ00 = 2451545D0 )
!
!  Days per Julian century
      REAL*8            DJC
      PARAMETER ( DJC = 36525D0 )
!
!  Time since J2000.0, in Julian centuries
      REAL*8            T
!
!  Miscellaneous
      INTEGER I, J
      REAL*8  A, S0, S1, S2, S3, S4, S5
      REAL*8  dTdt, d_A, d_S0, d_S1, d_S2, d_S3, d_S4, d_S5,            &
     &        T2, T3, T4, T5
!
!  Fundamental arguments (6,7,8 not in regular order)
      REAL*8   FA(8), FAD(8)
!
!  ---------------------
!  The series for s+XY/2
!  ---------------------
!
!  Number of terms in the series
      INTEGER NSP, NS0, NS1, NS2, NS3, NS4
      PARAMETER ( NSP=6, NS0=33, NS1=3, NS2=25, NS3=4, NS4=1 )
!
!  Polynomial coefficients
      REAL*8  SP (NSP)
!
!  Coefficients of l,l',F,D,Om,LVe,LE,pA
      INTEGER KS0 ( 8, NS0 ),                                           &
     &        KS1 ( 8, NS1 ),                                           &
     &        KS2 ( 8, NS2 ),                                           &
     &        KS3 ( 8, NS3 ),                                           &
     &        KS4 ( 8, NS4 )
!
!  Sine and cosine coefficients
      REAL*8           SS0 ( 2, NS0 ),                                  &
     &                 SS1 ( 2, NS1 ),                                  &
     &                 SS2 ( 2, NS2 ),                                  &
     &                 SS3 ( 2, NS3 ),                                  &
     &                 SS4 ( 2, NS4 )
!
!  Polynomial coefficients
      DATA SP /    94D-6,                                              &
     &           3808.65D-6,                                           &
     &           -122.68D-6,                                           &
     &         -72574.11D-6,                                           &
     &             27.98D-6,                                           &
     &             15.62D-6 /
!
!  Argument coefficients for t^0
      DATA ( ( KS0(I,J), I=1,8), J=1,10 ) /                             &
     &  0,  0,  0,  0,  1,  0,  0,  0,                                  &
     &  0,  0,  0,  0,  2,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  3,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  1,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  2,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  3,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  1,  0,  0,  0,                                  &
     &  0,  0,  0,  0,  3,  0,  0,  0,                                  &
     &  0,  1,  0,  0,  1,  0,  0,  0,                                  &
     &  0,  1,  0,  0, -1,  0,  0,  0 /
      DATA ( ( KS0(I,J), I=1,8), J=11,20 ) /                            &
     &  1,  0,  0,  0, -1,  0,  0,  0,                                  &
     &  1,  0,  0,  0,  1,  0,  0,  0,                                  &
     &  0,  1,  2, -2,  3,  0,  0,  0,                                  &
     &  0,  1,  2, -2,  1,  0,  0,  0,                                  &
     &  0,  0,  4, -4,  4,  0,  0,  0,                                  &
     &  0,  0,  1, -1,  1, -8, 12,  0,                                  &
     &  0,  0,  2,  0,  0,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  2,  0,  0,  0,                                  &
     &  1,  0,  2,  0,  3,  0,  0,  0,                                  &
     &  1,  0,  2,  0,  1,  0,  0,  0 /
      DATA ( ( KS0(I,J), I=1,8), J=21,30 ) /                            &
     &  0,  0,  2, -2,  0,  0,  0,  0,                                  &
     &  0,  1, -2,  2, -3,  0,  0,  0,                                  &
     &  0,  1, -2,  2, -1,  0,  0,  0,                                  &
     &  0,  0,  0,  0,  0,  8,-13, -1,                                  &
     &  0,  0,  0,  2,  0,  0,  0,  0,                                  &
     &  2,  0, -2,  0, -1,  0,  0,  0,                                  &
     &  0,  1,  2, -2,  2,  0,  0,  0,                                  &
     &  1,  0,  0, -2,  1,  0,  0,  0,                                  &
     &  1,  0,  0, -2, -1,  0,  0,  0,                                  &
     &  0,  0,  4, -2,  4,  0,  0,  0 /
      DATA ( ( KS0(I,J), I=1,8), J=31,NS0 ) /                           &
     &  0,  0,  2, -2,  4,  0,  0,  0,                                  &
     &  1,  0, -2,  0, -3,  0,  0,  0,                                  &
     &  1,  0, -2,  0, -1,  0,  0,  0 /
!
!  Argument coefficients for t^1
      DATA ( ( KS1(I,J), I=1,8), J=1,NS1 ) /                            &
     &  0,  0,  0,  0,  2,  0,  0,  0,                                  &
     &  0,  0,  0,  0,  1,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  3,  0,  0,  0 /
!
!  Argument coefficients for t^2
      DATA ( ( KS2(I,J), I=1,8), J=1,10 ) /                             &
     &  0,  0,  0,  0,  1,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  2,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  2,  0,  0,  0,                                  &
     &  0,  0,  0,  0,  2,  0,  0,  0,                                  &
     &  0,  1,  0,  0,  0,  0,  0,  0,                                  &
     &  1,  0,  0,  0,  0,  0,  0,  0,                                  &
     &  0,  1,  2, -2,  2,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  1,  0,  0,  0,                                  &
     &  1,  0,  2,  0,  2,  0,  0,  0,                                  &
     &  0,  1, -2,  2, -2,  0,  0,  0 /
      DATA ( ( KS2(I,J), I=1,8), J=11,20 ) /                            &
     &  1,  0,  0, -2,  0,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  1,  0,  0,  0,                                  &
     &  1,  0, -2,  0, -2,  0,  0,  0,                                  &
     &  0,  0,  0,  2,  0,  0,  0,  0,                                  &
     &  1,  0,  0,  0,  1,  0,  0,  0,                                  &
     &  1,  0, -2, -2, -2,  0,  0,  0,                                  &
     &  1,  0,  0,  0, -1,  0,  0,  0,                                  &
     &  1,  0,  2,  0,  1,  0,  0,  0,                                  &
     &  2,  0,  0, -2,  0,  0,  0,  0,                                  &
     &  2,  0, -2,  0, -1,  0,  0,  0 /
      DATA ( ( KS2(I,J), I=1,8), J=21,NS2 ) /                           &
     &  0,  0,  2,  2,  2,  0,  0,  0,                                  &
     &  2,  0,  2,  0,  2,  0,  0,  0,                                  &
     &  2,  0,  0,  0,  0,  0,  0,  0,                                  &
     &  1,  0,  2, -2,  2,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^3
      DATA ( ( KS3(I,J), I=1,8), J=1,NS3 ) /                            &
     &  0,  0,  0,  0,  1,  0,  0,  0,                                  &
     &  0,  0,  2, -2,  2,  0,  0,  0,                                  &
     &  0,  0,  2,  0,  2,  0,  0,  0,                                  &
     &  0,  0,  0,  0,  2,  0,  0,  0 /
!
!  Argument coefficients for t^4
      DATA ( ( KS4(I,J), I=1,8), J=1,NS4 ) /                            &
     &  0,  0,  0,  0,  1,  0,  0,  0 /
!
!  Sine and cosine coefficients for t^0
      DATA ( ( SS0(I,J), I=1,2), J=1,10 ) /                             &
     &            -2640.73D-6,          +0.39D-6,                       &
     &              -63.53D-6,          +0.02D-6,                       &
     &              -11.75D-6,          -0.01D-6,                       &
     &              -11.21D-6,          -0.01D-6,                       &
     &               +4.57D-6,           0.00D-6,                       &
     &               -2.02D-6,           0.00D-6,                       &
     &               -1.98D-6,           0.00D-6,                       &
     &               +1.72D-6,           0.00D-6,                       &
     &               +1.41D-6,          +0.01D-6,                       &
     &               +1.26D-6,          +0.01D-6 /
      DATA ( ( SS0(I,J), I=1,2), J=11,20 ) /                            &
     &               +0.63D-6,           0.00D-6,                       &
     &               +0.63D-6,           0.00D-6,                       &
     &               -0.46D-6,           0.00D-6,                       &
     &               -0.45D-6,           0.00D-6,                       &
     &               -0.36D-6,           0.00D-6,                       &
     &               +0.24D-6,          +0.12D-6,                       &
     &               -0.32D-6,           0.00D-6,                       &
     &               -0.28D-6,           0.00D-6,                       &
     &               -0.27D-6,           0.00D-6,                       &
     &               -0.26D-6,           0.00D-6 /
      DATA ( ( SS0(I,J), I=1,2), J=21,30 ) /                            &
     &               +0.21D-6,           0.00D-6,                       &
     &               -0.19D-6,           0.00D-6,                       &
     &               -0.18D-6,           0.00D-6,                       &
     &               +0.10D-6,          -0.05D-6,                       &
     &               -0.15D-6,           0.00D-6,                       &
     &               +0.14D-6,           0.00D-6,                       &
     &               +0.14D-6,           0.00D-6,                       &
     &               -0.14D-6,           0.00D-6,                       &
     &               -0.14D-6,           0.00D-6,                       &
     &               -0.13D-6,           0.00D-6 /
      DATA ( ( SS0(I,J), I=1,2), J=31,NS0 ) /                           &
     &               +0.11D-6,           0.00D-6,                       &
     &               -0.11D-6,           0.00D-6,                       &
     &               -0.11D-6,           0.00D-6 /
!
!  Sine and cosine coefficients for t^1
      DATA ( ( SS1(I,J), I=1,2), J=1,NS1 ) /                            &
     &               -0.07D-6,          +3.57D-6,                       &
     &               +1.73D-6,          -0.03D-6,                       &
     &                0.00D-6,          +0.48D-6 /
!
!  Sine and cosine coefficients for t^2
      DATA ( ( SS2(I,J), I=1,2), J=1,10 ) /                             &
     &             +743.52D-6,          -0.17D-6,                       &
     &              +56.91D-6,          +0.06D-6,                       &
     &               +9.84D-6,          -0.01D-6,                       &
     &               -8.85D-6,          +0.01D-6,                       &
     &               -6.38D-6,          -0.05D-6,                       &
     &               -3.07D-6,           0.00D-6,                       &
     &               +2.23D-6,           0.00D-6,                       &
     &               +1.67D-6,           0.00D-6,                       &
     &               +1.30D-6,           0.00D-6,                       &
     &               +0.93D-6,           0.00D-6 /
      DATA ( ( SS2(I,J), I=1,2), J=11,20 ) /                            &
     &               +0.68D-6,           0.00D-6,                       &
     &               -0.55D-6,           0.00D-6,                       &
     &               +0.53D-6,           0.00D-6,                       &
     &               -0.27D-6,           0.00D-6,                       &
     &               -0.27D-6,           0.00D-6,                       &
     &               -0.26D-6,           0.00D-6,                       &
     &               -0.25D-6,           0.00D-6,                       &
     &               +0.22D-6,           0.00D-6,                       &
     &               -0.21D-6,           0.00D-6,                       &
     &               +0.20D-6,           0.00D-6 /
      DATA ( ( SS2(I,J), I=1,2), J=21,NS2 ) /                           &
     &               +0.17D-6,           0.00D-6,                       &
     &               +0.13D-6,           0.00D-6,                       &
     &               -0.13D-6,           0.00D-6,                       &
     &               -0.12D-6,           0.00D-6,                       &
     &               -0.11D-6,           0.00D-6 /
!
!  Sine and cosine coefficients for t^3
      DATA ( ( SS3(I,J), I=1,2), J=1,NS3 ) /                            &
     &               +0.30D-6,         -23.42D-6,                       &
     &               -0.03D-6,          -1.46D-6,                       &
     &               -0.01D-6,          -0.25D-6,                       &
     &                0.00D-6,          +0.23D-6 /
!
!  Sine and cosine coefficients for t^4
      DATA ( ( SS4(I,J), I=1,2), J=1,NS4 ) /                            &
     &               -0.26D-6,          -0.01D-6 /
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!  Interval between fundamental epoch J2000.0 and current date (JC).
!      T = ( ( DATE1-DJ00 ) + DATE2 ) / DJC
      T = CENT
      dTdt = DCENT
!
!  Fundamental Arguments. Last 3 are out of order, so we have to copy 
!   them to FA and FAD.
!
!  Mean anomaly of the Moon.
       FA(1) =  FA2K(1) 
      FAD(1) = FAD2K(1) 
!  Mean anomaly of the Sun.
       FA(2) =  FA2K(2) 
      FAD(2) = FAD2K(2) 
!  Mean longitude of the Moon minus that of the ascending node.
       FA(3) =  FA2K(3) 
      FAD(3) = FAD2K(3) 
!  Mean elongation of the Moon from the Sun.
       FA(4) =  FA2K(4) 
      FAD(4) = FAD2K(4) 
!  Mean longitude of the ascending node of the Moon.
       FA(5) =  FA2K(5) 
      FAD(5) = FAD2K(5) 
!  Mean longitude of Venus.
       FA(6) =  FA2K(7) 
      FAD(6) = FAD2K(7) 
!  Mean longitude of Earth.
       FA(7) =  FA2K(8) 
      FAD(7) = FAD2K(8) 
!  General precession in longitude.
       FA(8) =  FA2K(14) 
      FAD(8) = FAD2K(14) 
!
!  Evaluate s.
      S0 = SP(1)
      S1 = SP(2)
      S2 = SP(3)
      S3 = SP(4)
      S4 = SP(5)
      S5 = SP(6)
       d_S0 = 0.D0
       d_S1 = 0.D0
       d_S2 = 0.D0
       d_S3 = 0.D0
       d_S4 = 0.D0
       d_S5 = 0.D0
!
      DO 2 I = NS0,1,-1
         A = 0.D0
          d_A = 0.D0
         DO 1 J=1,8
            A = A + DBLE(KS0(J,I))*FA(J)
!             Time derivative
             d_A =  d_A + DBLE(KS0(J,I))*FAD(J)
 1       CONTINUE
         S0 = S0 + ( SS0(1,I)*SIN(A) + SS0(2,I)*COS(A) )
!             Time derivative
          d_S0 =  d_S0 + (SS0(1,I)*COS(A)*d_A + SS0(2,I)*(-SIN(A))*d_A)
 2    CONTINUE
!     Write(6,1913) A, D_A 
 1913 Format ('A, D_A: ',2E25.15)
!     Write(6,1914) S0, d_S0 
 1914 Format ('S0, d_S0: ',2E25.15)
!
      DO 4 I = NS1,1,-1
         A = 0.D0
          d_A = 0.D0
         DO 3 J=1,8
            A = A + DBLE(KS1(J,I))*FA(J)
!             Time derivative
             d_A = d_A + DBLE(KS1(J,I))*FAD(J)
 3       CONTINUE
         S1 = S1 + ( SS1(1,I)*SIN(A) + SS1(2,I)*COS(A) )
!             Time derivative
          d_S1 = d_S1 + (SS1(1,I)*COS(A)*d_A + SS1(2,I)*(-SIN(A))*d_A)
 4    CONTINUE
!     Write(6,1923) A, D_A 
 1923 Format ('A, D_A: ',2E25.15)
!     Write(6,1924) S1, d_S1 
 1924 Format ('S1, d_S1: ',2E25.15)
!
      DO 6 I = NS2,1,-1
         A = 0.D0
          d_A = 0.D0
         DO 5 J=1,8
            A = A + DBLE(KS2(J,I))*FA(J)
!             Time derivative
             d_A = d_A + DBLE(KS2(J,I))*FAD(J)
 5       CONTINUE
         S2 = S2 + ( SS2(1,I)*SIN(A) + SS2(2,I)*COS(A) )
!             Time derivative
          d_S2 = d_S2 + (SS2(1,I)*COS(A)*d_A + SS2(2,I)*(-SIN(A))*d_A)
 6    CONTINUE
!     Write(6,1933) A, D_A 
 1933 Format ('A, D_A: ',2E25.15)
!     Write(6,1934) S2, d_S2 
 1934 Format ('S2, d_S2: ',2E25.15)
!
      DO 8 I = NS3,1,-1
         A = 0.D0
          d_A = 0.D0
         DO 7 J=1,8
            A = A + DBLE(KS3(J,I))*FA(J)
!             Time derivative
             d_A = d_A + DBLE(KS3(J,I))*FAD(J)
 7       CONTINUE
         S3 = S3 + ( SS3(1,I)*SIN(A) + SS3(2,I)*COS(A) )
!             Time derivative
          d_S3 = d_S3 + (SS3(1,I)*COS(A)*d_A + SS3(2,I)*(-SIN(A))*d_A)
 8    CONTINUE
!     Write(6,1943) A, D_A 
 1943 Format ('A, D_A: ',2E25.15)
!     Write(6,1944) S3, d_S3 
 1944 Format ('S3, d_S3: ',2E25.15)
!
      DO 10 I = NS4,1,-1
         A = 0.D0
          d_A = 0.D0
         DO 9 J=1,8
            A = A + DBLE(KS4(J,I))*FA(J)
!             Time derivative
             d_A = d_A + DBLE(KS4(J,I))*FAD(J)
 9       CONTINUE
         S4 = S4 + ( SS4(1,I)*SIN(A) + SS4(2,I)*COS(A) )
!             Time derivative
          d_S4 =  d_S4 + (SS4(1,I)*COS(A)*d_A + SS4(2,I)*(-SIN(A))*d_A)
 10   CONTINUE
!     Write(6,1953) A, D_A 
 1953 Format ('A, D_A: ',2E25.15)
!     Write(6,1954) S4, d_S4 
 1954 Format ('S4, d_S4: ',2E25.15)
!
!     iau_S06 = ( S0 +                                                  &
!    &          ( S1 +                                                  &
!    &          ( S2 +                                                  &
!    &          ( S3 +                                                  &
!    &          ( S4 +                                                  &
!    &            S5 * T ) * T ) * T ) * T ) * T ) * DAS2R - X*Y/2D0
!
        T2 = T*T
        T3 = T2*T
        T4 = T2*T2
        T5 = T4*T
        S06(1) = (S0 + S1*T + S2*T2 + S3*T3 + S4*T4 + S5*T5)*DAS2R -   &
     &             X(1)*Y(1)/2.D0
        S06(2) = (d_S0 + d_S1*T + S1*dTdt + d_S2*T2 + S2*2.D0*T*dTdt +   &
     &            d_S3*T3 + S3*3.D0*T2*dTdt +                          &
     &            d_S4*T4 + S4*4.D0*T3*dTdt +                          &
     &            d_S5*T5 + S5*5.D0*T4*dTdt) * DAS2R -                 &
     &            (X(2)*Y(1)/2.D0 + X(1)*Y(2)/2.D0)
!     Write(6,1964) S06      
 1964 Format ('S06: ',2E25.15)
!  Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2010
!  Standards Of Fundamental Astronomy Board
!  of the International Astronomical Union.
!
!  =====================
!  SOFA Software License
!  =====================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING TERMS AND CONDITIONS
!  WHICH APPLY TO ITS USE.
!
!  1. The Software is owned by the IAU SOFA Board ("SOFA").
!
!  2. Permission is granted to anyone to use the SOFA software for any
!     purpose, including commercial applications, free of charge and
!     without payment of royalties, subject to the conditions and
!     restrictions listed below.
!
!  3. You (the user) may copy and distribute SOFA source code to others,
!     and use and adapt its code and algorithms in your own software,
!     on a world-wide, royalty-free basis.  That portion of your
!     distribution that does not consist of intact and unchanged copies
!     of SOFA source code files is a "derived work" that must comply
!     with the following requirements:
!
!     a) Your work shall be marked or carry a statement that it
!        (i) uses routines and computations derived by you from
!        software provided by SOFA under license to you; and
!        (ii) does not itself constitute software provided by and/or
!        endorsed by SOFA.
!
!     b) The source code of your derived work must contain descriptions
!        of how the derived work is based upon, contains and/or differs
!        from the original SOFA software.
!
!     c) The name(s) of all routine(s) in your derived work shall not
!        include the prefix "iau".
!
!     d) The origin of the SOFA components of your derived work must
!        not be misrepresented;  you must not claim that you wrote the
!        original software, nor file a patent application for SOFA
!        software or algorithms embedded in the SOFA software.
!
!     e) These requirements must be reproduced intact in any source
!        distribution and shall apply to anyone to whom you have
!        granted a further right to modify the source code of your
!        derived work.
!
!     Note that, as originally distributed, the SOFA software is
!     intended to be a definitive implementation of the IAU standards,
!     and consequently third-party modifications are discouraged.  All
!     variations, no matter how minor, must be explicitly marked as
!     such, as explained above.
!
!  4. In any published work or commercial products which includes
!     results achieved by using the SOFA software, you shall
!     acknowledge that the SOFA software was used in obtaining those
!     results.
!
!  5. You shall not cause the SOFA software to be brought into
!     disrepute, either by misuse, or use for inappropriate tasks, or
!     by inappropriate modification.
!
!  6. The SOFA software is provided "as is" and SOFA makes no warranty
!     as to its use or performance.   SOFA does not and cannot warrant
!     the performance or results which the user may obtain by using the
!     SOFA software.  SOFA makes no warranties, express or implied, as
!     to non-infringement of third party rights, merchantability, or
!     fitness for any particular purpose.  In no event will SOFA be
!     liable to the user for any consequential, incidental, or special
!     damages, including any lost profits or lost savings, even if a
!     SOFA representative has been advised of such damages, or for any
!     claim by any third party.
!
!  7. The provision of any version of the SOFA software under the terms
!     and conditions specified herein does not imply that future
!     versions will also be made available under the same terms and
!     conditions.
!
!  Correspondence concerning SOFA software should be addressed as
!  follows:
!
!      By email:  sofa@ukho.gov.uk
!      By post:   IAU SOFA Center
!                 HM Nautical Almanac Office
!                 UK Hydrographic Office
!                 Admiralty Way, Taunton
!                 Somerset, TA1 2DN
!                 United Kingdom
!
!----------------------------------------------------------------------
!
      END
      SUBROUTINE dINITL (Kjob)
      IMPLICIT None
!
! 1.    INITL
!
! 1.1   INITL PROGRAM SPECIFICATION
!
! 1.1.1 INITL obtains the mathematical and physical constants from the database
!       and elsewhere and loads them into the common block 'cphys' for their
!       use throughout the program. INITL also calls the input and
!       initialization sections of the model modules and the necessary utility
!       routines. Each section will obtain internally the model module parameter
!       values from the database and initialize all such variables in the local
!       common block. Each section will also put into the header a text message
!       for each model module and necessary utility routine. INITL also
!       initializes a counter which counts the observation number and writes a
!       header text for the observation number, time tag, baseline
!       identification, and source identification.
!       SUBROUTINE INITL IS CALLED ONLY ONCE PER DATA BASE.
!
! 1.2   INITL PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!             OUTPUT VARIABLES:
!               1. KOUNT - THE VARIABLE WHICH INITIALIZES THE COUNTER
!                          OF THE OBSERVATION ITEMS TO ZERO. (UNITLESS)
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!            VARIABLES 'TO':
!              2. EFLAT   - THE FLATTENNING OF THE ELLIPSOID WHICH APPROXIMATES
!                           THE SHAPE OF THE EARTH. (UNITLESS)  (Site module)
!              3. GMMOON  - THE MASS OF THE MOON MULTIPLIED BY THE NEWTONIAN
!                           GRAVITATIONAL CONSTANT. (M**3/SEC**2)
!              4. GMSUN   - THE MASS OF THE SUN MULTIPLIED BY THE NEWTONIAN
!                           GRAVITATIONAL CONSTANT. (M**3/SEC**2)
!              5. GMEARTH - THE MASS OF THE EARTH MULTIPLIED BY THE NEWTONIAN
!                           GRAVITATIONAL CONSTANT. (M**3/SEC**2)
!              6. REARTH  - THE EQUATORIAL RADIUS OF THE EARTH. (M)
!              7. SECPAU  - THE NUMBER OF LIGHT-SECONDS PER ASTRONOMICAL UNIT.
!                           (SEC/A.U.)
!              8. GAMMA   - THE POST NEWTONIAN EXPANSION PARAMETER WHICH AFFECTS
!                           LIGHT BENDING. (1.0 FOR EINSTEIN).
!              9. VLIGHT  - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!             10. VLIGHT2 - THE VELOCITY OF LIGHT SQUARED. ((M/SEC)**2)
!             11. VLIGHT3 - THE VELOCITY OF LIGHT CUBED. ((M/SEC)**3)
!             12. GMPLANET(7)-The masses of 7 of the planets multiplied by the
!                           gravitational constant. (1=Mercury, 2=Venus, 3=Mars,
!                           4=Jupiter, 5=Saturn, 6=Uranus, and 7=Neptune)
!             13. AU_meters-The Astronomical unit. (meters)
!
      INCLUDE 'ccon.i'
!       Variables 'from':
!              1. ILUOUT  - Output control flag.
!
!      INCLUDE 'cuser11.i'
!            Variables 'from':
!              1. Calc_user - Character denoting the user type:
!                             'A' = Analysis center, using the old Mark3 
!                                   database handler.
!                             'N' = Future analysis mode, to work with nuSolve
!                                   and NetCDF files. -Not yet implemented-
!                             'C' = Correlator user. Interfaces with some
!                                   type of calc server.
!                             'D' = Difx correlator user. Similar to type C,
!                                   but will get input from a '.calc' 
!                                   correlator file.
!
      INCLUDE 'd_input.i'
!       Variables 'from':
!              1. NumSpace - Number of spacecrafts. If .ge. 1, we switch to 
!                            the near field mode and call subroutine SpaceI
!                            for spline initialization of the spacecraft 
!                            positions and veloxcities. 
!
!
!       PROGRAM SPECIFICATIONS -
      Integer*4  KOUNT, Kjob
!
!       PROGRAM VARIABLES -
!           1. Kjob - .calc job number. Used to conserve LU numbers.
!
!       PROGRAMMER - David Gordon Jan. 2013 
!                    DG, 2016-Jul-06  Added Kjob 
!
!
! Physical constants from IERS Conventions (2003)
!  Revised 2012-NOV-08 FROM IAU 2009 Resolution B2.
          VLIGHT  = 299792458.0D0
          GMSUN   = 1.32712442099D20
          SECPAU  = 499.0047838061D0
          REARTH  = 6378136.6D0
          GMEARTH = 3.986004418D14
          GMMOON  = GMEARTH * .0123000371D0
          EFLAT   = 1.D0/298.25642D0
          GAMMA   = 1.0D0
          AU_meters = 1.49597870700D11
!
! GM's of the planets. From IAU 2009 Resolution B2. 
!  Updated 2012-Nov-08
      GMPLANET(1) = GMSUN / 6.0236D6          ! Mercury
      GMPLANET(2) = GMSUN / 4.08523719D5      ! Venus
      GMPLANET(3) = GMSUN / 3.09870359D6      ! Mars
      GMPLANET(4) = GMSUN / 1.047348644D3     ! Jupiter
      GMPLANET(5) = GMSUN / 3.4979018D3       ! Saturn
      GMPLANET(6) = GMSUN / 2.290298D4        ! Uranus
      GMPLANET(7) = GMSUN / 1.941226D4        ! Neptune
!     GMPLANET( ) = GMSUN / 1.36566D8         ! Pluto   
!
! GM's of the planets. From IERS 2010 and DE421 ephemeris
!     GMPLANET(1) = GMSUN / 6023597.400017D0      ! Mercury
!     GMPLANET(2) = GMSUN / 408523.718655D0       ! Venus
!     GMPLANET(3) = GMSUN / 3098703.590267D0      ! Mars
!     GMPLANET(4) = GMSUN / 1047.348625D0         ! Jupiter
!     GMPLANET(5) = GMSUN / 3497.901768D0         ! Saturn
!     GMPLANET(6) = GMSUN / 22902.981613D0        ! Uranus
!     GMPLANET(7) = GMSUN / 19412.237346D0        ! Neptune
!     GMPLANET(8) = GMSUN / 135836683.767599D0    ! Pluto   
!
!  Compute square and cube of velocity of light. 93MAY06, D. Gordon
      VLIGHT2 = VLIGHT * VLIGHT
      VLIGHT3 = VLIGHT2 * VLIGHT
!
!  Provide for the input and initializations of the model modules and of the
!  necessary utility routines and for the adding to the header of the
!  corresponding text messages.
!
!**    CALL dSTAI()    ! Do we need the Calc control flags?
!
       CALL dSITI(Kjob) ! Get Ocean loading coefficients.
!                       ! Get Ocean pole tide loading coefficients.
!                       ! Get tilt angles. Get Axis types. Compute tilt topo matrices.
!                       ! Compute latitudes and longitudes, and topo matrices. 
!
       CALL dUT1I()    ! Initialize 
!
       CALL dWOBI()    ! Initialize 
!
!   Initialization of spacecraft ephemeris moved to subroutine dScan. 
!!!    If (NumSpace .ge. 1) CALL SPACEI(1)
!
!  Initialize the observation counter to 0.
      KOUNT = 0
!
!
!     Normal conclusion.
      RETURN
      END
!
!*************************************************************************
      SUBROUTINE dSITI(Kjob)
      IMPLICIT None
!
! 3.    SITI
!
! 3.1   SITI PROGRAM SPECIFICATION
!
! 3.1.1 SITI is the Site Module input and initialization section.
!
! 3.1.3 REFERENCES - SMART, W.M., 'TEXTBOOK ON SPHERICAL ASTRONOMY',
!                    1965, P. 195-198
!                    MARKHAM'S X-DOCUMENT
!
! 3.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!            VARIABLES 'FROM':
!              1. EFLAT  - THE FLATTENNING OF THE ELLIPSOID APPROXIMATING
!                          THE SHAPE OF THE EARTH.  (UNITLESS)
!              2. REARTH - THE EQUATORIAL RADIUS OF THE EARTH. (M)
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
      INCLUDE 'cmxst11.i'
!            Variables to:
!       1. CFRAD(Max_Stat)      -  THE SITE SPHERICAL EARTH RADII.  (M)
!       2. PLAT(3,Max_Stat)     -  THE PARTIAL DERIVATIVES OF THE SITE CRUST
!                                  FIXED VECTOR COMPONENTS WITH RESPECT TO THE
!                                  GEODETIC LATITUDES. (M/RAD)
!       3. PLON(3,Max_Stat)     -  THE PARTIAL DERIVATIVES OF THE SITE CRUST
!                                  FIXED VECTOR COMPONENTS WITH RESPECT TO THE
!                                  EAST LONGITUDES. (M/RAD)
!       4. SITAXO(Max_Stat)     -  THE SITE ANTENNA AXIS OFFSETS. (M)
!       5. SITOAM(11,Max_Stat)  -  THE SITE VERTICAL OCEAN LOADING AMPLITUDES.
!                                  (M)
!       6. SITOPH(11,Max_Stat)  -  THE SITE VERTICAL OCEAN LOADING PHASES.
!                                  (RAD)
!**     7. SITXYZ(3,Max_Stat)   -  THE SITE CRUST FIXED X, Y, & Z
!**                                COORDINATES. (M, M, M )
!       8. SNRM(3,Max_Stat)     -  THE X, Y, AND Z COMPONENTS OF THE SITE
!                                  NORMAL UNIT VECTORS. (UNITLESS)
!**     9. SITZEN(Max_Stat)     -  THE ZENITH ELECTRICAL PATH LENGTH AT EACH
!**                                OBSERVATION SITE. (SEC)
!      10. TCROT(3,3,Max_Stat)  -  THE ROTATION MATRICES WHICH ROTATE THE
!                                  TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST
!                                  FIXED REFERENCE SYSTEM FOR EACH SITE.
!                                  (UNITLESS)
!      11. XLAT(Max_Stat)       -  THE SITE GEODETIC LATITUDES. (RAD)
!      12. XLON(Max_Stat)       -  THE SITE EAST LONGITUDES. (RAD)
!      13. KTYPE(Max_Stat)      -  THE SITE ANTENNA AXIS TYPES. (UNITLESS)
!      14. NLAST(2)             -  THE INTEGER VARIABLE WHICH DETERMINES IF
!                                  THE BASELINE ID HAS CHANGED FROM ONE
!                                  OBSERVATION TO THE NEXT.
!                                  (NOTE: THE SITE GEOMETRY NEED NOT BE
!                                  RELOADED FOR EACH OBSERVATION IF THE
!                                  BASELINE ID DOES NOT CHANGE. NLAST MUST BE
!                                  INITIALIZED TO ZERO IN THE INITIALIZATION
!                                  SECTION AND PASSED TO THE GEOMETRY SECTION
!                                  SO THAT IT WILL HAVE ZERO VALUES UNTIL
!                                  AFTER THE FIRST OBSERVATION IS PROCESSED.)
!**    15. NUMSIT               -  THE NUMBER OF SITES IN THE SITE CATALOG.
!      16. LNSITE(4,Max_Stat)   -  THE EIGHT CHARACTER SITE NAMES OF THE
!                                  SITES IN THE SITE CATALOG. (ALPHAMERIC)
!      17. SITHOA(11,2,Max_Stat) - THE SITE HORIZONTAL OCEAN LOADING
!                                  AMPLITUDES. (M)
!      18. SITHOP(11,2,Max_Stat) - THE SITE HORIZONTAL OCEAN LOADING PHASES.
!                                  (RAD)
!      19. HEIGHT(Max_Stat)     -  Height above the geoid. (meters)
!      20. RTROT(3,3,Max_Stat)  -  The rotation matrices which rotate the
!                                  'radial-transverse' reference system to the
!                                  crust fixed reference system for each site.
!                                  (Unitless). The 'radial-transverse' ref.
!                                  system is nearly identical to the
!                                  topocentric system. 'Up' is in the radial
!                                  direction from the center of the Earth;
!                                  'East' is East; and 'North' is perpendicular
!                                  to the radial in the north direction.
!      21. GLAT(Max_Stat)       -  The geocentric latitude at each site. (rad)
!      22. Zero_site            -  The site number of the site at the
!                                  geocenter, if there is one in this data
!                                  set. For correlator usage.
!      23. Dbtilt(Max_Stat,2)   -  Antenna fixed axis tilts, in arc-minutes.
!                                  For alt-az mounts, 1 => East tilt,
!                                  2 => North tilt.
!      24. Rotilt(3,3,Max_Stat) -  Rotation matrices representing the antenna
!                                  fixed axis tilts, in the local topocentric
!                                  station frame. X = Up, Y = East, Z = North.
!      25. OPTL6(6,Max_stat)    -  The site ocean pole tide loading 
!                                  coefficients, interpolated from the Desai
!                                  lat/lon table.
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KSITC - THE SITE MODULE FLOW CONTROL FLAG.
!              2. KSITD - THE SITE MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cuser11.i'
!       Variables from:
!         1. Calc_user  - Calc user type. 'A' for Calc/SOLVE analysis.
!                         'C' for VLBI correlator.
!
      INCLUDE 'cmxut11.i'
!        Variables 'to':
!**         1. Intrvl(5,2) - First and last time tag of data in the current
!                            data base. (First index: year, month, day,
!                            hour, minute. Second index: first, last.)
      INCLUDE 'param11.i'
!       Variables from:
!           1. A_tilts   - Antenna tilts file name (default file).
!           2. OPTL_file - Ocean pole tide loading file (default file).
!
      INCLUDE 'd_input.i'
!
!
! 3.2.3 PROGRAM SPECIFICATIONS -
!
      Character*80 xtlt
      CHARACTER*40 C_LSITM(2)
      Character*8 Ch_Sites(Max_Stat)
      REAL*8 XLAT_DUMMY,XLON_DUMMY, RY(3,3), RZ(3,3), TCROT_DUMMY(3,3), &
     &       RGY(3,3), GLAT_DUMMY,RTROT_DUMMY(3,3),Sitxyzv(7,Max_stat), &
     &       T1(3,3), T2(3,3)
      Real*8 xlatlonht(3),Pie,A,Fl,Xyz(3), Xdoy1, Xepoch, X_frac
      Integer*4 N, I, J, K, L, ik, kj, Imdoy(12), Intmov, Krr, Kjob
      Integer*2 KERR(12), LSITM(40), NDO(3), NDI(3), NN, numsit_local,  &
     &                       KERX(2)
      EQUIVALENCE (LSITM,C_LSITM)
      CHARACTER*1 ITEST, idum(3)
      Equivalence (LNSITE(1,1), Ch_Sites(1))
!     Logical*4 Input_sites, Input_ocean
!
      Data Imdoy /0,31,59,90,120,151,181,212,243,273,304,334/
!
! 3.2.6 SUBROUTINE INTERFACE -
!           CALLER SUBROUTINES: INITL
!           CALLED SUBROUTINES: DCOS, DSIN, DSQRT, GETA, GETI,
!                    GET4, TERMINATE_CALC, MMUL2, PUTA, ROTATE, bkplh
!
! 3.2.7 CONSTANTS USED - EFLAT, REARTH
!
! 3.2.8 PROGRAM VARIABLES -
!           1. KERR(12) - THE DATA BASE ERROR RETURN FLAGS.
!           2. NDO(3)   - THE DATA BASE RETURN ARRAY INDICES.
!           3. RY(3,3)  - THE ROTATION MATRIX WHICH PERFORMS A COORDINATE
!                         SYSTEM ROTATION ABOUT THE TOPOCENTRIC Y-AXIS (EAST)
!                         THROUGH AN ANGLE EQUAL TO THE GEODETIC LATITUDE OF
!                         THE CURRENT SITE. (UNITLESS)
!           4. RZ(3,3)  - THE ROTATION MATRIX WHICH PERFORMS A COORDINATE
!                         SYSTEM ROTATION ABOUT THE TOPOCENTRIC Z-AXIS (NORTH)
!                         THROUGH AN ANGLE EQUAL TO THE NEGATIVE EAST LONGITUDE
!                         OF THE CURRENT SITE. (UNITLESS)
!
! 3.2.9 PROGRAMMER - David Gordon    Jan. 2013  
!                    DG, 2016-July-06  Added Kjob
!
! 3.3   dSITI PROGRAM STRUCTURE
!
       Krr = 0
!
!  Fill LNSITE array from SITES array
      Do J = 1, Numsit
       Ch_Sites(J) = Sites(J)
      Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      Write (6,*) 'dSITI: Sites   ', Sites  
!      Write (6,*) 'dSITI: LNSITE  ', LNSITE 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!
!***********************************************
!  Set geocenter station flag 
        Zero_site = 1
!***********************************************
!
!  Define axis types:
      Do J = 2, Numsit
       If (AXIS(J) .eq. 'AZEL') KTYPE(J) = 3
       If (AXIS(J) .eq. 'EQUA') KTYPE(J) = 1
       If (AXIS(J) .eq. 'XYNS') KTYPE(J) = 2
       If (AXIS(J) .eq. 'XYEW') KTYPE(J) = 4
       If (AXIS(J) .eq. 'RICH') KTYPE(J) = 5
      Enddo 
! Set GEOCENTR site to avoid problems:
       KTYPE(1) = 3
!
!  External file input for ocean loading
       CALL dOCNIN(Kjob,Krr)
!
!  External file input for antenna tilts
       CALL dANTILT(Kjob,Krr)
!      If (KRR .ne. 0) Then
!       Do I = 1, Max_stat
!        Dbtilt(1,I) = 0.0
!        Dbtilt(2,I) = 0.0
!       Enddo
!      Endif
!
!  External file input for ocean pole tide loading
       CALL dOPTLIN(Kjob,Krr)
!***********************************************
!
!  Compute topocentric rotation matrices for each antenna axis tilt.
       Do I = 1, NUMSIT
!
!           Alt-Az case:
        If (KTYPE(I) .eq. 3) Then
         Call ROTAT(-Dbtilt(1,I)*CONVD/60.D0, int2(3), T1)
         Call ROTAT( Dbtilt(2,I)*CONVD/60.D0, int2(2), T2)
         Call MMUL2(T1, T2, Rotilt(1,1,I))
        Endif
!
!           Equatorial, X/Y N-S, or Richmond case:
        If (KTYPE(I) .eq. 1 .or. KTYPE(I) .eq. 2 .or.     &
     &      KTYPE(I) .eq. 5) Then
         Call ROTAT( Dbtilt(1,I)*CONVD/60.D0, int2(1), T1)
         Call ROTAT(-Dbtilt(2,I)*CONVD/60.D0, int2(2), T2)
         Call MMUL2(T1, T2, Rotilt(1,1,I))
        Endif
!
!           X/Y E-W case:
        If (KTYPE(I) .eq. 4) Then
         Call ROTAT( Dbtilt(1,I)*CONVD/60.D0, int2(1), T1)
         Call ROTAT( Dbtilt(2,I)*CONVD/60.D0, int2(3), T2)
         Call MMUL2(T1, T2, Rotilt(1,1,I))
        Endif
!
       Enddo
!
!-----------------------------------------------------------------------------
!
!
!?    If only one site zenith path delay, copy for all stations.
!?     IF( NDO(1) .NE. NUMSIT ) THEN
!?       DO 210 N = 2,NUMSIT
!?10       SITZEN(N) = SITZEN(1)
!?     ENDIF
!
!
!     Calculate the neccesary site geometry.
!      Mod added 98JAN22: Dummy out topocentric type variables for station at
!      or near the geocenter, for correlator usage.
!
!     Loop once for each station in the site catalog.
      DO 490  N = 1,NUMSIT
!
!   Check for geocenter
         If (Zero_site .eq. N) Go to 491
!
!       Compute the site spherical radii.
        CFRAD(N) = DSQRT ( SITXYZ(1,N)**2  +  SITXYZ(2,N)**2  +         &
     &                     SITXYZ(3,N)**2  )
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       If (CFRAD(N) .le. 0.D0) Write(6,1077) N, CFRAD(N), SITXYZ(1,N),  &
     &        SITXYZ(2,N), SITXYZ(3,N)
 1077  Format('SITI: N,CFRAD,SITXYZ(N): 'I2,4F14.4)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!   Compute geocentric latitudes
         GLAT(N) = DASIN( SITXYZ(3,N) / CFRAD(N) )
!
!   93OCT12. Call subroutine bkplh to compute
!    geodetic latitude, geodetic longitude, and height. DG
         Pie = PI
         Fl = Eflat
         A = Rearth
         do i=1,3
          XYZ(i)=SITXYZ(i,N)
         enddo
        call bkplh(xyz,xlatlonht,pie,a,fl)
! Keep longitudes between -PI and +PI
         if (xlatlonht(2) .gt. pi) &
     &       xlatlonht(2) = xlatlonht(2) - 2.D0*pi
         XLAT(N)  =  xlatlonht(1)
         XLON(N)  =  xlatlonht(2)
         Height(N) = xlatlonht(3)     ! height in meters
!
!       Compute the site normal unit vectors.
        SNRM(1,N) = DCOS ( XLAT(N) ) * DCOS ( XLON(N) )
        SNRM(2,N) = DCOS ( XLAT(N) ) * DSIN ( XLON(N) )
        SNRM(3,N) = DSIN ( XLAT(N) )
!
!       Compute the partial derivatives of the crust fixed site
!       coordinates with respect to the East longitudes.
        PLON(1,N) = - SITXYZ(2,N)
        PLON(2,N) =   SITXYZ(1,N)
        PLON(3,N) =   0.D0
!
!       Compute the partial derivatives of the crust fixed site
!       coordinates with respect to the geodetic latitudes.
!       (NOTE: The following equations are actually for the geocentric partial
!       derivatives, however, these partials are sufficiently close to the
!       geodetic partials for the purposes of CALC use.)
        PLAT(1,N) = - SITXYZ(3,N) * DCOS (XLON(N) )
        PLAT(2,N) = - SITXYZ(3,N) * DSIN (XLON(N) )
        PLAT(3,N) = + CFRAD(N) * DCOS (XLAT(N) )
!
!     Compute the topocentric-to-crust-fixed rotation matrices by rotating
!     about the geodetic latitude and longitude. Also now compute a
!     "radial-transverse" rotation matrix by rotating about the geocentric
!     latitude and the longitude.
!
        XLAT_DUMMY = XLAT(N)
        CALL ROTAT ( XLAT_DUMMY, int2(2), RY)
!      write(6,8) ' XLAT? ',  xlat(n)*57.29578
!
        XLON_DUMMY = XLON(N)
        CALL ROTAT ( -XLON_DUMMY, int2(3), RZ)
!      write(6,8) ' XLON? ',  xlon(n)*57.29578
!
        GLAT_DUMMY = GLAT(N)
        CALL ROTAT ( GLAT_DUMMY, int2(2), RGY)
!      write(6,8) ' GLAT? ',  glat(n)*57.29578
!
!       DO I=1,3
!         DO J=1,3
!           TCROT_DUMMY(I,J) = TCROT(I,J,N)
!           RTROT_DUMMY(I,J) = RTROT(I,J,N)
!         ENDDO
!       ENDDO
        CALL MMUL2 ( RZ, RY, TCROT_DUMMY(1,1) )
        CALL MMUL2 ( RZ, RGY,RTROT_DUMMY(1,1) )
        DO I=1,3
          DO J=1,3
            TCROT(I,J,N) = TCROT_DUMMY(I,J)
            RTROT(I,J,N) = RTROT_DUMMY(I,J)
          ENDDO
        ENDDO
!      write(6,8) ' TCROT ',  TCROT_DUMMY
!      write(6,8) ' RTROT ',  RTROT_DUMMY
!
      IF (KSITD .ne. 0) Then  !Station debug printout
       if (N.eq.1) Then
        WRITE ( 6, 1)
        WRITE(6,8)' EFLAT   ',EFLAT
        WRITE(6,8)' REARTH  ',REARTH
        WRITE(6,7)' NUMSIT  ',NUMSIT
       endif
    1  FORMAT (1X, 'Debug output for subroutine SITI.' )
       write(6,'(" For site #",i2)') N
       WRITE(6,4)' RY   ',((RY(J,K),J=1,3),K=1,3)
       WRITE(6,4)' RZ   ',((RZ(J,K),J=1,3),K=1,3)
       WRITE(6,4)' RGY  ',((RGY(J,K),J=1,3),K=1,3)
       WRITE (6,8)' Geoid Height  ',  xlatlonht(3)
      Endif          !Station debug printout
      GO TO 490
!
  491 CONTINUE
!    Dummy out the above topocentric quantities, they have no meaning at the
!     geocenter
        XLAT(N)   = -999.D0
        XLON(N)   = -999.D0
        Height(N) = -999.D0
        SNRM(1,N) = 0.D0
        SNRM(2,N) = 0.D0
        SNRM(3,N) = 0.D0
        GLAT(N)   = -999.D0
        PLON(1,N) = 0.D0
        PLON(2,N) = 0.D0
        PLON(3,N) = 0.D0
        PLAT(1,N) = 0.D0
        PLAT(2,N) = 0.D0
        PLAT(3,N) = 0.D0
        SITAXO(N) = 0.D0
        KTYPE(N)  = 0
        SITZEN(N) = 0.D0
        DO I=1,3
         DO J=1,3
          TCROT(I,J,N) = 0.D0
          RTROT(I,J,N) = 0.D0
         ENDDO
        ENDDO
        DO I=1,11
          SITOAM(I,N) = 0.D0
          SITHOA(I,1,N) = 0.D0
          SITHOA(I,2,N) = 0.D0
          SITOPH(I,N) = 0.D0
          SITHOP(I,1,N) = 0.D0
          SITHOP(I,2,N) = 0.D0
        ENDDO
!
!     Close the loop which runs over the sites in the catalog.
  490 CONTINUE
!
!     Initialize the integer variable NLAST to zero.
      NLAST(1) = 0
      NLAST(2) = 0
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     WRITE ( 6, 11)
!      Do I = 1, NUMSIT
!        Write(6,1012) I, Dbtilt(1,I), Dbtilt(2,I),                     &
!    &     ((Rotilt(kj,ik,I), ik=1,3), kj=1,3)
!      Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     Check KSITD for debug output.
      IF ( KSITD .ne. 0 ) Then  !Debug printout
      WRITE ( 6, 11)
   11 FORMAT (1X, 'Station Debug for subroutine dSITI.' )
      WRITE(6,8)' CFRAD   ',(CFRAD(J),J=1,NUMSIT)
    8 FORMAT(A,4D25.16/(1X,5D25.16))
      WRITE(6,7)' KTYPE   ',(KTYPE(J),J=1,NUMSIT)
    7 FORMAT(/,A,15I3/(1X,15I3))
      WRITE(6,7)' NLAST   ',NLAST
      WRITE(6,4)' PLAT    ',(( PLAT(J,K),J=1,3),K=1,NUMSIT)
    4 FORMAT(/,A,3D25.16/(9X,3D25.16))
      WRITE(6,4)' PLON    ',(( PLON(J,K),J=1,3),K=1,NUMSIT)
      WRITE(6,8)' SITAXO  ',( SITAXO(J),J=1,NUMSIT)
      WRITE(6,9)' SITOAM, ',((SITOAM(J,K),J=1,11),K=1,NUMSIT)
      WRITE(6,9)' SITOPH, ',((SITOPH(J,K),J=1,11),K=1,NUMSIT)
      WRITE(6,9)' SITHOA, ',(((SITHOA(J,L,K),J=1,11),L=1,2),K=1,        &
     & NUMSIT)
      WRITE(6,9)' SITHOP, ',(((SITHOP(J,L,K),J=1,11),L=1,2),K=1,        &
     & NUMSIT)
    9 FORMAT(/,A,11F9.4,/,(9X,11F9.4))
      WRITE(6,6)' SITXYZ  ',((SITXYZ(J,K),J=1,3),K=1,NUMSIT)
    6 FORMAT(/,A,3F20.4,/,(9X,3F20.4))
      WRITE(6,8)' SITZEN  ',(SITZEN(K),K=1,NUMSIT)
      WRITE(6,4)' SNRM    ',((SNRM(I,J),I=1,3),J=1,NUMSIT)
      WRITE(6,4)' TCROT   ',(((TCROT(I,J,K),I=1,3),J=1,3),K=1,          &
     & NUMSIT)
    5 FORMAT(/,A,/,3(3F20.4,/)/)
      WRITE(6,8)' XLAT    ',(XLAT(J),J=1,NUMSIT)
      WRITE(6,8)' XLON    ',(XLON(J),J=1,NUMSIT)
      WRITE(6,8)' HEIGHT    ',(HEIGHT(J),J=1,NUMSIT)
      WRITE(6,*)' LNSITE: '
      WRITE(6,3)  ((LNSITE(J,K),J=1,4),K=1,NUMSIT)
    3 FORMAT (8(2X,4A2))
       Do I = 1, NUMSIT
         Write(6,1012) I, Dbtilt(1,I), Dbtilt(2,I),                     &
     &     ((Rotilt(kj,ik,I), ik=1,3), kj=1,3)
 1012    Format('Station #',I2,2x,2F10.5,/,'Rotilt: ',3F20.10,          &
     &          /,8X,3F20.10,/,8X,3F20.10)
       Enddo
!
!
      Endif          !Debug printout
!
!     Normal conclusion.
      RETURN
      END
!
!*************************************************************************
      SUBROUTINE dUT1I()
      IMPLICIT None
!
!     UT1I is the UT1 module input and initialization section.
!     The input UT1 table MUST be a 1-day
!     series of 'TAI-UT1'. Tidal terms should not be removed!
!
!     Common blocks used -
!
      INCLUDE 'cmxut11.i'
!            Variables 'from':
!              1. IEPOCH   - The number of epochs at which TAI - UT1 is desired.
!              2. ASKKER   - The database error return code from ASK.
!              3. Leap_fix - Used in external input mode. .True. means
!                            correct the input EOP series for accumluated
!                            leap seconds. .False. means do not correct.
!              4. UT1type  - UT1 data type: 'UT1-TAI ' or 'UT1-UTC '.
!                            For 'UT1-UTC ', leap second corrections
!                            must be made.
!              5. EOP_time_scale - EOP table time scale, allowed values:
!                            'TAI     ', 'TCG     ', 'TDB     ',
!                            'TDT     ', 'UTC     ', 'UNDEF   '.
!
!            Variables 'to':
!              1. UT1IF(4)  - The final UT1 information array. This array
!                             contains respectively: 1) The Julian date of the
!                             first tabular point, 2) The increment in days of
!                             the tabular points, 3) The number of tabular
!                             points, 4) The units of the UT1 tabular array per
!                             second. (days, days, unitless, sec/table unit)
!              2. UT1PT(20) - The tabular values of 'TAI minus UT1'.
!                             (table units)
!              3. UT1RS(20) - The table of either 'TAI-UT1' (default 
!                             beginning with Calc 10) or 'TAI-UT1S'
!                             depending on the value of KUT1C. For
!                             'TAI-UT1S', the tidal terms are removed 
!                             using the model of Defrainge and Smits, 1999,
!                             from the IERS Conventions (2003)]. (seconds)
!              4. ISHRTFL   - The short period tidal terms flag, (unitless).
!                             = 1 --> UT1 table coming from input database is
!                             true UT1, (that is, fortnightly tidal terms have
!                             not been removed, as in the IERS series).
!                             [This is the normal case.]
!                             = -2 --> UT1 table coming from input database
!                             is UT1S (tidal terms removed).
!                             This mode no longer supported and should not
!                             be used. It will cause Calc 10 to abort!!!!
!                             = -1 --> UT1R (old Yoder fortnightly terms
!                             removed). This mode no longer supported and
!                             will cause Calc to abort!!!!!
!             5. Usecubic   - Set to true if cubic interpolation to be used.
!             6. Uselinear  - Set to true if linear interpolation to be used.
!             7. Usespline  - Set to true if spline interpolation to be used.
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!             1. KUT1C - UT1 module flow control flag, controls the
!                        temporary removal of periodic terms (UT1S)
!                        and the type of interpolation (spline or cubic)
!                        in the UT1 tables. Revised Sept. 2005.
!                        = 0. Leave table as TAI-UT1. Do spline 
!                           interpolation for a 1-day series. 
!                           5-day series no longer allowed!
!                        = 1. Module completely off, that is, UT1 set equal
!                           to AT.
!                        = 2. Use TAI-UT1; use cubic interpolation for a
!                           1-day series. 5-day series no longer allowed!
!                        = 3. Use TAI-UT1; use linear interpolation for a
!                           1-day series. 5-day series no longer allowed!
!                        = 4. Convert table to TAI-UT1S. Do spline 
!                           interpolation for a 1-day series, then 
!                           restore to true UT1 using the UT1S model of
!                           Defrainge and Smits, 1999. 
!                           5-day series no longer allowed!
!             2. KUT1D - The UT1 module debug output flag.
!
      INCLUDE 'd_input.i'
!           1. Xleap_sec - Number of leap seconds from the .calc file
!                          in difx mode.
!
      INCLUDE 'cuser11.i'
!           1. C_mode - Calc 'mode'. Either 'difx  ' or 'mark3 ' or
!                       'nusolv', etc.
!
      Real*8  ATMUTC(3), ROTEPH(2,20), A1UTC(3), A1DIFF(3)
      COMMON / EOPCM / ATMUTC, ROTEPH, A1UTC, A1DIFF
!           VARIABLES 'TO':
!            1. ATMUTC(3)   - THE 'TAI MINUS UTC' INFORMATION ARRAY. THIS ARRAY
!                             CONTAINS RESPECTIVELY THE EPOCH, VALUE, AND TIME
!                             RATE OF CHANGE OF 'TAI MINUS UTC'. Used in the
!                             atomic time module. (DAYS, SEC, SEC/SEC)
!            2. ROTEPH(2,20)- The array which contains the epochs at which
!                             TAI - UT1 is desired. The entries are:
!                             1) JD at 0:00 hours UTC,
!                             2) The fraction of a UTC day from 0:00 hours
!                                to the desired epoch.
!            3. A1UTC(3)    - A1 - UTC array ???? 
!            4. A1DIFF(3)   - THE ARRAY CONTAINING THE EPOCH, OFFSET AND RATE
!                             OF CHANGE OF THE OFFSET BETWEEN A1 AND TAI
!                             (DAYS, SECONDS, SECONDS/DAY)
!
!     Program Specifications -
!
      REAL*8     UT1TAB(2,20)
      REAL*8     XJD, CT, TC2000, FA2K(14), FAD2K(14), TT0
      Real*8     yp1, ypn, xleap(5), tol, xntv
      Real*8     Dut, Dlod, Domega, Dutr, Dlodr, Domegar, Duts, Dlods, &
     &           Domegas, Atmut1, Shortp, Divutc, tab_time
      INTEGER*4  get_leapsec, ierr, ierr4
      INTEGER*4  Increment, max_ut1_pts
      Integer*4  N, Itab, II, I
      INTEGER*2  KERR(8), NDO(3), Tab_len
      INTEGER*2  LUT1M(40), LOFF(40), LUT1S(40), LUT1(40)
      CHARACTER*40 C_LOFF(2), C_LUT1S(2), C_LUT1M(2), C_LUT1(2)
      Equivalence (LUT1S,C_LUT1S), (C_LUT1M,LUT1M), (LOFF,C_LOFF ), &
     &            (LUT1,C_LUT1)
!
      Character*20 C_LFI, C_LPR, C_LEX
      Integer*2    LFI(10), LPR(10), LEX(10)
      Equivalence (C_LFI,LFI), (C_LPR,LPR), (C_LEX,LEX)
!
      Integer*2    Lutext(40)
      Character*80 Utext
      Equivalence (Utext,Lutext)
!
      Integer*2    mess_linear(30), mess_cubic(30), mess_spline(3)
      Character*60 mess_linear_c , mess_cubic_c, mess_spline_c
      Equivalence (mess_linear,mess_linear_c),(mess_cubic,mess_cubic_c), &
     &            (mess_spline,mess_spline_c)
      Character*1 type_found, cdum1(3)
!
      Integer*2    L_EOPSCALE(4)
      Character*8  C_EOPSCALE
      Equivalence (L_EOPSCALE, C_EOPSCALE)
!
      Integer*2 Mxepch, MEPOCH
      DATA MXEPCH /20/
!     DATA C_LUT1M / &
!    & 'UT1 Module - Last Modified 2005.09.23, D', &
!    & '. Gordon/GSFC:                          '/
!
!     DATA C_LUT1   / &
!    & 'UT1 Module ON. Interpolation in TAI-UT1.', &
!    & '                                        '/
!
!     DATA C_LUT1S  / &
!    & 'UT1 Module ON. Tidal terms restored usin', &
!    & 'g Defraigne and Smits 1999 (IERS 2003). '/
!
!     DATA C_LOFF / &
!    & 'UT1 Module is turned OFF.               ', &
!    & '                                        '/
!
!     DATA  C_LFI /' Final Values       '/
!     DATA  C_LPR /' Preliminary Values '/
!     DATA  C_LEX /' Extrapolated Values'/
!
!     Data mess_cubic_c  / &
!    & 'UT1 table interpolated with 4 point, 3rd order polynomial.  '/
!
!     Data mess_linear_c / &
!    & 'UT1 table interpolated with 2 point, linear interpolation.  '/
!
!     Data mess_spline_c / &
!    & 'UT1 table interpolated with 15 point cubic spline.          '/
!
      Data Max_ut1_pts /20/
!
!*2.2.4 DATA BASE ACCESS -
!**         'GET' VARIABLES:
!**            1. UT1IF(4)   -   The UT1 information array. (See above.)
!**            2. UT1PT(20)  -   The tabular values of 'TAI minus UT1'.
!**                              (table units)
!**            3. ROTEPH(2,20) - The array which contains the epochs at which
!**                              TAI - UT1 is desired. The entries are:
!**                              1) JD at 0:00 hours UTC,
!**                              2) The fraction of a UTC day from 0:00 hours
!**                              to the desired epoch.
!**            4. ISHRTFL    -   The short period tidal terms flag. (See above.)
!**         'PUT' Variables:
!**            1. LUT1M(40)    - The UT1 module text message.
!**            2. LON(40)      - The UT1 module 'turned on' message.
!**            3. LOFF(40)     - The UT1 module 'turned off' message.
!**            4. UT1TAB(2,20) - The array which contains the TAI - UT1 
!**                              values (complete) and the fortnightly 
!**                              corrections to TAI - UT1 (s,s).
!**         Access codes:
!**            1. 'UT1 MESS'  -  UT1 module text message code.
!**            2. 'FUT1 INF'  -  The access code for the Final UT1 
!**                              information array.
!**            3. 'FUT1 PTS'  -  Final UT1 points access code.
!**            4. 'PUT1 INF'  -  Like above but preliminary.
!**            5. 'PUT1 PTS'  -  Like above but preliminary.
!**            6. 'UT1 CFLG'  -  Module control flag access code.
!**            7. 'EUT1 INF'  -  Like above but for extropolated data.
!**            8. 'EUT1 PTS'  -  Like above but for extropolated data.
!**            9. 'UT1EPOCH'  -  Access code for the UT1 epochs array.
!**           10. 'ROTEPOCH'  -  Access code for the array of epochs at which
!**                              TAI - UT1 is desired.
!**           11. 'TIDALUT1'  -  The access code for the flag indicating
!**                              whether the fortightly terms in UT1 are in
!**                              the input UT1 series. (See below.)
!
!     Subroutine Interface -
!             Caller subroutines: INITL
!             Called subroutines: GETI, GET4, TERMINATE_CALC, PUTA, PUT4,
!                                 NUTFA, UT1RZT, UT1SZT, spline
!
!     Program variables:
!           1. Tab_len     - The number of tabular points in the UT1
!                            information array in the database
!           2. KERR(8)     - The database error return flags.
!           3. LUT1F(4)    - The message inserted into the UT1 module text
!                            message if the final UT1 information are used.
!           4. LUT1P(4)    - The message if preliminary data is used.
!           5. NDO(3)      - Database return array indices.
!           6. LUT1E(3)    - The message if extropolated data is used.
!           7. UT1TAB(2,20)- THe array which contains the values of TAI - UT1
!                            and the short period corrections. (s,s).
!           8. MEPOCH      - This is IEPOCH checked to be certain that it is no
!                            greater than MXEPCH.
!           9. MXEPCH      - The maximum number of TAI - UT1 EPOCHS allowed.
!          10. XJD         - The Julian date at 0 hours UTC of the epoch in
!                            question (days).
!          11. UTC         - The UTC fraction of day of the observation. (days)
!          12. ATMUT1      - The complete computed value of TAI - UT1 (s)
!          13. SHORTP      - 'UT1S - UT1' depending on KUT1C.
!                            (s). Notice the sense!
!          14. Increment   - The increment of the UT1 table in the database
!                            (days).
!          15. max_ut1_pts - The maximum size of the UT1 table from the
!                            database.
!          16. type_found  - Tracks the type of UT1 table in the database.
!
!     Programmer - Dale Markham   02/14/77
!      77.07.14  Peter Denatale
!      78.03.28  Bruch Schupler
!      78.07.03  Bruce Schupler
!      84.06.05  David Gordon
!      87.06.03  Savita Goel   CDS FOR A900
!      88.12.21  Gregg Cooke   CALC 7.0 mods.
!      89.06.08  Jim Ryan      Short period logic modified.
!      89.07.11  Jim Ryan      Documentation simplified.
!      89.12.12  Jim Ryan      UNIX-like database interface implimented.
!      90.11.30  Jim Ryan      Bug in short period UT1 control logic fixed
!                              again.
!      91.05.30  Jim Ryan      Documentation furthur simplilfied.
!      91.06.05  Jim Ryan      Mods to support linear interpolation.
!      91.06.19  Jim Ryan      Code added to construct UT1R table from UT1
!                              table. Needed for linear interpolation. For CALC
!                              7.4+ the scaling law for the UT1 table MUST be
!                              1, because SOLVE doesn't know about that law.
!      93.03.17  David Gordon  Code added to use UT1S, new control flag scheme.
!      93.09.07  Norbert Zacharias  Moved calculation of fundamental argumuments
!                              to subroutine NUTFA.
!      93 Dec.   David Gordon  Cubic spline interpolation added, modified
!                              control flag scheme for type of interpolation.
!      93.12.30  David Gordon  Cleaned up 'UT1 MESS'.
!      94.04.06  David Gordon  Changed to 'Implicit None'.
!      94.09.26  David Gordon  Added some debug printout, changed some I*2's to
!                              I*4's, documentation corrections, cosmetic mods.
!      94.09.27  David Gordon  Removed unused 'XLOVEK' Love number.
!      95.06.08  David Gordon  Corrected debug printout, wrong format statement
!                              used.
!      98.01.27  David Gordon  Removed Yoder (UT1R) model interpolation option.
!                              KUT1C values redefined. TERMINATE_CALC if no
!                              TIDALUT1
!                              Lcode (old database, UT1R assumed) or if ISHRTFL
!                              equals -1.
!      98.04.l3  David Gordon  Common /UT1CM/ moved to 'cmxut.i' include file.
!      98.05.01  David Gordon  Mods for external file input of EOP info.
!     2001.01.02 David Gordon  CT replaced with tab_time in UT1MU argument.
!                              Code added to PUT 'EOPSCALE'.
!      2002.09    Jim Ryan     Integer*2/4 mods.
!     2003-2004  David Gordon  Updated for IERS Conventions (2003).
!      2005.10   David Gordon  Change default to interpolate in 'TAI-UT1',
!                              i.e. Do NOT remove fortnightly, etc terms.
!                              Only for KUTC1=4 are the fortnightly terms
!                              removed/restored.
!
!     UT1I Program Structure
!
!----------------------------------------------------------------------------
!
      If(DABS(UT1IF(4)-1.D0) .gt. .00001D0) Then
        Write(6,'( &
     &  "In UT1I: The scaling law for UT1 table must be 1.0! ",/, &
     &  "It is not.  Quitting!")')
        Call TERMINATE_CALC('UT1I  ', int2(0), int2(0))
      Endif
!
      Increment = UT1IF(2) + .01
      Tab_len   = UT1IF(3) + .01
!
      If(Tab_len .gt. Max_ut1_pts) Then
        Write(6,'( &
     &  "The maximum allowable UT1 table is ",I5," points.",/, &
     &  "The table in the database contains ",I5," points.", &
     &  "Quitting.")') max_ut1_pts, Tab_len
        Call TERMINATE_CALC( 'UT1I  ', int2(0), int2(0))
      Endif
!
!  Get the EOP timescale definition. If not present, we call it undefined,
!   but assume the EOP table epochs to be in TDB (= CT).
        If(KERR(1).ne.0)  C_EOPSCALE = 'UNDEF   '
       EOP_time_scale = 'UNDEF   '
!
!
      Increment = UT1IF(2) + .01
      Tab_len   = UT1IF(3) + .01
!
          xntv = xintv(1)
!       WRITE ( 6, * )  ' UT1I/xintv: ', xintv
!   Get leap seconds, then load TAI - UTC array.
      If (C_mode .eq. 'difx  ') Then 
        ATMUTC(1) = UT1IF(1)
        ATMUTC(2) = Xleap_sec
        ATMUTC(3) = 0.0D0 
!       WRITE (6,*)  ' ATMUTC: ', ATMUTC
      Else
       ierr = get_leapsec(xintv(1),xleap)
!       WRITE ( 6, * )  ' UT1I/xintv: ', xintv
!       WRITE ( 6, * )  ' UT1I/xleap: ', xleap
!      If (ierr .ne. 0) go to ????
       ATMUTC(1) = xleap(1)
       ATMUTC(2) = xleap(2)
       ATMUTC(3) = xleap(4)
       tol = 1.D-8
!??    If (Dabs(ATMUTC(3)).gt.tol) ATMUTC(1) = xleap(3) + 2400000.5D0
       ATMUTC(3) = ATMUTC(3) / 8.64D4
!       WRITE (6,*)  ' ATMUTC: ', ATMUTC
      Endif
!
!  Remove leap seconds if input table was UT1-UTC
!*     If (Leap_fix .eq. 'True') Then
!
!*       WRITE ( 6, * )  '!!! Removing leap seconds !!!'
!
!*      Do I = 1,Tab_len
!*       UT1PT(I) = UT1PT(I) + ATMUTC(2)
!*      Enddo
!*     Endif
!
       Do I = 1,3
        A1utc(i) = ATMUTC(i)
       Enddo
        A1utc(2) = a1utc(2) + 0.03439D0
!
       A1DIFF(1) = ATMUTC(1)
       A1DIFF(2) =  0.03439D0
       A1DIFF(3) =  0.0D0
!
!
!----------------------------------------------------------------------------
!  Mod 2005.09.23. Allow use of 1-day series only. There is no longer
!   any reason to use a 5-day series.
       IF (Increment .NE. 1) THEN
        Write(6,'("UT1I: The UT1 table increment must be 1 day! ",/, &
     &  "Instead it is ",I3," days. Calc is quitting!")') Increment
        Call TERMINATE_CALC('UT1I  ', int2(0), int2(0))
       ENDIF
!
!  Determine interpolation method. Options are cubic spline or 
!    cubic polynomial for a 1-day series.
          Usespline = .true.
!
!----------------------------------------------------------------------------
!
!  Construct the table of TAI-UT1 (note the sense).
!    Default: leave tables as true TAI-UT1 
       Do Itab = 1, Tab_len
          UT1RS(Itab) = UT1PT(Itab) 
       Enddo
!
!---------------------------------------------------------------------
!   Code for spline interpolation initialization, 93DEC08  -DG-
      If (Usespline) Then       ! Initialize spline routine
       Nspline = tab_len
!
       Do ii=1,Nspline
        Ya(ii) = UT1RS(ii)
       Enddo
!
       Do ii = 1, Nspline
        XT(ii) =  UT1IF(1) + (ii-1)*UT1IF(2)
       Enddo
!
!   Take first derivatives at endpoints
       yp1 = (ya(2)-ya(1)) / UT1IF(2)
       ypn = (ya(Nspline)-ya(Nspline-1))/ UT1IF(2)
!
!  Call spline initialization subroutine
       CALL SPLINE(XT,ya,Nspline,yp1,ypn,y2s,ierr4)
!
      Endif                      ! Initialize spline routine
! ***************
!
!
!     If there is a ROTEPH array already in the database, get it.
!     Otherwise bypass this step. Also, protect yourself in case
!     there are more than MXEPCH (currently 20) entries in ROTEPH.
!
!    ?????
        MEPOCH = ndays
!    ?????
!??   IF (.not. Input_EOP) THEN   ! Already have ROTEPH?
!??     IF (ASKKER .NE. 0) GO TO 400
!??     MEPOCH = IEPOCH
!??     IF (MEPOCH .GT. MXEPCH) MEPOCH = MXEPCH
!??     CALL GET4 ('ROTEPOCH      ',ROTEPH,int2(2),MEPOCH,int2(1),NDO, &
!??  &   KERR(8))
!??     IF (KERR(8).NE.0) CALL TERMINATE_CALC('UT1I  ',int2(8),KERR(8))
!??   ENDIF                       ! Already have ROTEPH?
!
!     Compute TAI - UT1 and the short period tidal correction for the
!     desired epochs and place them in UT1TAB.
!??   DO  N=1,MEPOCH
!??     XJD = ROTEPH(1,N)
!??     CT  = ROTEPH(2,N)
!??     TT0 = ROTEPH(2,N)
!??     tab_time  = ROTEPH(2,N)
!
!??     If(KUT1C.ne.1) Then
!??       CALL NUTFA (XJD, TT0, CT, TC2000, FA2K, FAD2K)
!??       CALL UT1MU (XJD,tab_time,FA2K,FAD2K,TC2000,ATMUT1, &
!??  &              SHORTP,DIVUTC)
!??     Else
!??       ATMUT1 = 0.D0
!??       SHORTP = 0.D0
!??     Endif
!
!??     UT1TAB(1,N) = ATMUT1
!??     UT1TAB(2,N) = SHORTP
!??   ENDDO
!
!     PUT the UT1TAB array into the database.
!??   CALL PUT4 ('UT1EPOCH      ', UT1TAB, int2(2), MEPOCH, int2(1))
!
!     Go here if we are bypassing the updating of UT1TAB.
  400 CONTINUE
!
!     Check KUT1D for debug output.
    9 FORMAT (1X, "Debug output for subroutine dUT1I.")
    7 FORMAT(A,15I8,/,(9X,15I8))
    8 FORMAT(A,4D25.16,/,(9X,4D25.16))
      IF ( KUT1D .ne. 0 ) Then
       WRITE ( 6, 9)
       WRITE(6,8)' UT1IF   ', UT1IF
       WRITE(6,8)' UT1PT   ', UT1PT
       WRITE(6,8)' UT1RS   ', UT1RS
       If (Usespline) Write(6,8)' XT      ', XT
       If (Usespline) Write(6,8)' ya      ', ya
       If (Usespline) Write(6,8)' y2s     ', y2s
       If (Usespline) Write(6,8)' yp1, ypn', yp1, ypn
       If (Usespline) Write(6,7)' Nspline, ierr4 ', Nspline, ierr4
       WRITE(6,8)' UT1TAB  ', UT1TAB
       WRITE(6,*)' tab_len ', tab_len
       WRITE(6,7)' IEPOCH  ', IEPOCH
       WRITE(6,7)' MEPOCH  ', MEPOCH
       WRITE(6,7)' MXEPCH  ', MXEPCH
       WRITE(6,7)' ASKKER  ', ASKKER
!
      ENDIF
!
!     Normal conclusion.
      RETURN
      END
!*************************************************************************
      SUBROUTINE dWOBI()
      Implicit None
!
!     WOBI is the wobble module input and initialization section.
!
!     Common blocks used -
!
      INCLUDE 'cmwob11.i'
!            Variables 'from':
!              1) KERASK - The database return code from the 'ASK' for
!                          the rotation epochs array.
!              2) NEPOCH - The number of epochs in the rotation epochs array.
!            Variables 'to':
!              1. WOBIF(3)  -  The wobble information array. Contains
!                              respectively: 1) The Julian date of the first
!                              tabular point, 2) The increment in days of the
!                              tabular points, 3) The number of tabular points.
!                              (days, days, unitless)
!              2. XYWOB(2,20)- The wobble tabular points for the polar motion
!                              (wobble) X & Y offsets. (milliarcsec)
!                              (Note: Based on old BIH conventions, offsets
!                              are assumed to be left-handed.)
!
      INCLUDE 'cmxut11.i'
!            Variables 'from':
!              1. Ndays - number of days in the ROTEPH array.
!
      INCLUDE 'ccon.i'
!            Variables 'from':
!              1.  KWOBC  -  The Wobble Module flow control flag.
!                            0 --> Default, module on; spline interpolation
!                                  for 1-day series, cubic for 5-day series.
!                            1 --> Module off. No polar motion applied.
!                            2 --> Module on; linear interpolation for any
!                                  series.
!                            3 --> Module on; cubic interpolation for 1-day
!                                  series, spline for 5-day series.
!              2.  KWOBD  -  The Wobble Module debug output flag.
!
      Real*8  ATMUTC(3), ROTEPH(2,20), A1UTC(3), A1DIFF(3)
      COMMON / EOPCM / ATMUTC, ROTEPH, A1UTC, A1DIFF
!           VARIABLES 'TO':
!            2. ROTEPH(2,20)- The array which contains the epochs at which
!                             TAI - UT1 is desired. The entries are:
!                             1) JD at 0:00 hours UTC,
!                             2) The fraction of a UTC day from 0:00 hours
!                                to the desired epoch.
!
!   Program specifications -
!
      Real*8 yp1x,ypnx,yp1y,ypny
      Integer*4 ierr4
      INTEGER*2  KERR(7), NDO(3), Increment, Tab_len
      INTEGER*2      LWOBM(40)
      CHARACTER*40 C_LWOBM(2)
      EQUIVALENCE (C_LWOBM,LWOBM)
      INTEGER*2      LON(40) ,   LOFF(40)
      CHARACTER*40 C_LON(2)  , C_LOFF(2)
      EQUIVALENCE(C_LON,LON),(C_LOFF,LOFF)
      REAL*8 WOBTAB(2,20), XJD, UTC, WOBXL, WOBYL, tab_time, &
     &       DWOBXL, DWOBYL
      Integer*2    mess_linear(30), mess_cubic(30), mess_spline(30)
      Character*60 mess_linear_c , mess_cubic_c, mess_spline_c
      Equivalence(mess_linear,mess_linear_c),(mess_cubic,mess_cubic_c), &
     &           (mess_spline,mess_spline_c)
!     logical*4 table_found
      Character*1 type_found, cdumm(3)
!
      Character*20 C_LFI, C_LPR, C_LEX
      Integer*2 LFI(10), LPR(10), LEX(10)
      Equivalence (C_LFI,LFI), (C_LPR,LPR), (C_LEX,LEX)
      Integer*2 MEPOCH, mdum1
      Integer*4 MXEPCH, N, II
!
      Integer*2 lwtext(40)
      Character wtext*80
      Equivalence  (wtext,lwtext)
!
      DATA LEN_WOB_TABLE /20/
      data roteph /40*0.0d0/
      data wobtab /40*0.0d0/
!
!*    DATA C_LWOBM / &
!*   &'Wobble Module - Last Modified 2004.04.21', &
!*   &', D. Gordon/GSFC:                       '/
!
      DATA  C_LFI /' Final Values       '/
      DATA  C_LPR /' Preliminary Values '/
      DATA  C_LEX /' Extrapolated Values'/
!
!*    DATA C_LON   / &
!*   &'Wobble Module is turned on.             ', &
!*   &'                                        '/
!
!*    DATA C_LOFF  / &
!*   &'Wobble Module is turned off.            ', &
!*   &'                                        '/
!
!*    Data mess_cubic_c  / &
!*   &'Polar motion table interp. w. 4 pt, 3rd order polynomial.   '/
!
!*    Data mess_linear_c/ &
!*   &'Polar motion table interp. w. 2 pt, linear interpolator.    '/
!
!*    Data mess_spline_c / &
!*   &'Polar motion table interpolated with 5 point cubic spline.  '/
!
      DATA MXEPCH /20/
!
!*   Database access  -
!*          'GET' Variables:
!*            1. WOBIF(3)   -  The wobble information array. Contains
!*                             respectively: 1) The Julian date of the first
!*                             tabular point, 2) The increment in days of the
!*                             tabular points, 3) The number of tabular points.
!*                             (days, days, unitless)
!*            2. XYWOB(2,20) - The tabular points for the long period
!*                             wobble X & Y-offsets. (milli-arc-sec)
!*                             (NOTE: in old BIH convention UT1, X-pole, Y-pole
!*                             system is left handed.)
!*            3. ROTEPH(2,20)- The epochs at which the interpolated WOBBLE are
!*                             desired. The first entry is the Julian date at
!*                             0:00 hours UTC of the day desired. The second
!*                             entry is the UTC fraction of the UTC day of the
!*                             desired epoch (days,days)
!*          'PUT' Variables:
!*            1. LWOBM(40)    - The Wobble Module text message.
!*            2. LON(40)      - The Wobble Module 'TURNED ON' message.
!*            3. LOFF(40)     - The Wobble Module 'TURNED OFF' message.
!*            4. WOBTAB(2,20) - The array which contains the interpolated
!*                              wobble in a left-handed system. The first entry
!*                              is the X wobble. The second entry is the Y
!*                              wobble. (milliarcsec, milliarcsec)
!*          ACCESS CODES:
!*            1. 'WOB MESS'  -  The database access code for the Wobble Module
!*                              text message.
!*            2. 'FWOB INF'  -  The database access code for the final wobble
!*                              information array.
!*            3. 'FWOBX&YT'  -  The database access code for the final wobble
!*                              X & Y offsets.
!*            4. 'PWOB INF'  -  The database access code for the preliminary
!*                              wobble information array.
!*            6. 'PWOBX&YT'  -  The database access code for the preliminary
!*                              wobble X & Y offsets.
!*            7. 'WOB CFLG'  -  The database access code for the Wobble Module
!*                              flow control message.
!*            8. 'ROTEPOCH'  -  The database access code for the epochs at
!*                              which the interpolated values are computed.
!*            9. 'WOBEPOCH'  -  The database access code for the interpolated
!*                              wobble array.
!*           10. 'EWOB INF'  -  The database access code for the extrapolated
!*                              wobble information array.
!*           11. 'EWOBX&YT'  -  The database access code for the extrapolated
!*                              wobble X & Y offsets.
!*           12. 'WOBINTRP'  -  The database access code for the polar motion
!*                              interpolation message.
!
!     Subroutine interface -
!             Caller subroutines: INITL
!             Called subroutines: GET4, TERMINATE_CALC, PUTA, PUT4, WOBMU
!
!     Program Variables -
!           1. Increment -  The increment of the wobble table. (days)
!           2. KERR(7)   -  Database error return flags.
!           3. NDO(3)    -  Database return array indices.
!           4. MXEPCH    -  The maximum number of interpolated wobble epochs.
!           5. WOBXL     -  The interpolated X-wobble (left-handed).
!                           (milliarcsec)
!           6. WOBYL     -  The interpolated Y-wobble (left-handed).
!                           (milliarcsec)
!           7. DWOBXL    -  The time derivative of the interpolated X-wobble.
!                           (left-handed) (milliarcsec/sec)
!           8. DWOBYL    -  The time derivative of the interpolated Y-wobble.
!                           (left-handed) (milliarcsec/sec)
!           9. MEPOCH    -  The number of epochs at which the wobble
!                           is interpolated.
!          10. XJD       -  The Julian date at 0:00 hours UTC of the
!                           interpolation epoch. (days)
!          11. UTC       -  The UTC fraction of the UTC day of the
!                           interpolation epoch. (days)
!          12. Tab_len   -  The length of the Wobble table in the database.
!          13. type_found-  Tracks the type of wobble table in database.
!          14. tab_time  -  The fraction of the day of the interpolation epoch
!                           in WOBMU. (days)
!
! 3.2.9 PROGRAMMER - DALE MARKHAM  02/17/77
!     77.07.14 Peter Denatale
!     78.01.11 Bruce Schupler
!     89.07.26 Jim Ryan  Documentation simplifed and strings.
!     89.08.16 Jim Ryan  Use of LEN_WOB_TALBE implimented.
!     89.12.12 Jim Ryan  UNIX-like database interface implimented.
!     90.06.05 Jim Ryan  Mods for linear interpolation and more clean up.
!     92.07.17 Jim Ryan  Roteph and Wobtab initialized to avoid debug problem.
!     93.12.17 D. Gordon Spline interpolation added, new flow control logic.
!     93.12.30 D. Gordon Cleaned up 'WOB MESS'.
!     94.04.15 D. Gordon Converted to Implicit None.
!     94.05.23 D. Gordon Fixed bug - use_cubic, use_linear, use_spline were
!                        being dimensioned both Logical*2 and Real*8.
!     95.10.05 D. Gordon Skip interpolation if module OFF (KWOBC=1); set
!                        WOBXL and WOBYL equal to zero (previously undefined).
!     95.12.04 D. Gordon Interpolation epoch variable changed from UTC to
!                        tab_time.
!     95.12.11 D. Gordon Adding DWOBXL and DWOBYL, derivatives of X-wobble and
!                        Y-wobble, to WOBMU argument list. Not used here.
!     98.05.01 D.Gordon  Put Common /WOBCM/ into include file 'cmwob.i'.
!                        Added include files 'inputs.i' and 'cmxut.i', and
!                        common block EOPCM. Extensive mods for external
!                        EOP input.
!     99.10.27 D.Gordon  Corrected error in ADD/PUT of 'WOBEPOCH' when
!                        external input being used.
!     2002 Sept Jim Ryan Integer*2/4 mods.
!
!     WOBI Program Structure
!
!
      Increment = WOBIF(2) + 0.01
      Tab_len   = WOBIF(3) + 0.01
! ---------------------------------------------------------------------------
!
!  Determine interpolation method. Defaults are cubic spline for a 1-day series.
        use_spline = .true.
!
!   Code for spline interpolation initialization, 93DEC17  -DG-
      If (use_spline) Then       ! Initialize spline routine
!
      n_spline = tab_len
      do ii=1,n_spline
       yax(ii) = XYWOB(1,ii)
       yay(ii) = XYWOB(2,ii)
      enddo
!
      xa(1) = WOBIF(1)
      do ii=2,n_spline
       xa(ii) = xa(ii-1) + WOBIF(2)
      enddo
!
!   If interval (WOBIF(2)) not 1.0 days, then divide by interval
      if ( Abs(WOBIF(2) - 1.D0) .gt. 1.D-10) then
        do ii=1,n_spline
         xa(ii) = xa(ii) / WOBIF(2)
        enddo
      endif
!
!   Take first derivatives at endpoints for X-wobble
      yp1x = (yax(2)-yax(1)) / (xa(2)-xa(1))
      ypnx = (yax(n_spline)-yax(n_spline-1))/ &
     &       (xa(n_spline)-xa(n_spline-1))
!  call spline initialization subroutine for X-wobble
      call spline(xa,yax,n_spline,yp1x,ypnx,y2sx,ierr4)
!
!   Take first derivatives at endpoints for Y-wobble
      yp1y = (yay(2)-yay(1)) / (xa(2)-xa(1))
      ypny = (yay(n_spline)-yay(n_spline-1))/ &
     &       (xa(n_spline)-xa(n_spline-1))
!  call spline initialization subroutine for Y-wobble
      call spline(xa,yay,n_spline,yp1y,ypny,y2sy,ierr4)
!
      Endif                      ! Initialize spline routine
!
!    If there is a ROTEPH array in the database, GET it. Otherwise,
!    bypass this step. Also, check in case there are more than MXEPCH
!    entries in ROTEPH.
!
!**   IF (.not. Input_EOP) THEN
        IF (KERASK .NE. 0) GO TO 400
        MEPOCH = NEPOCH
        IF (MEPOCH .GT. MXEPCH) MEPOCH = MXEPCH
!@        mepoch = 2
!??     CALL GET4 ('ROTEPOCH      ', ROTEPH, int2(2), MEPOCH, int2(1), &
!??  &       NDO, KERR(7))
!??     IF (KERR(7) .NE. 0) write ( 6, * ) 'Failure to retreieve lcode '// &
!??  &      ' ROTEPOCH  MEPOCH =', MEPOCH,' NEPOCH =',NEPOCH, ' MXEPCH = ', &
!??  &        MXEPCH, ' kerr(7) = ', kerr(7) ! %%%%%%%%%
!??     IF (KERR(7) .NE. 0) CALL TERMINATE_CALC('WOBI  ', int2(7), &
!??  &       KERR(7))
!**   ELSE
!**     MEPOCH = ndays
!**   ENDIF
!
!   Compute the interpolated values of the wobble with a call to WOBMU.
!??   DO N=1,MEPOCH
!??     XJD = ROTEPH(1,N)
!??     tab_time = ROTEPH(2,N)
!??      If (KWOBC.ne.1) then             ! Module ON
!??       CALL WOBMU (XJD,tab_time,WOBXL,WOBYL,DWOBXL,DWOBYL)
!??      Else                             ! Module OFF
!??       WOBXL = 0.D0
!??       WOBYL = 0.D0
!??      Endif
!??     WOBTAB(1,N) = WOBXL
!??     WOBTAB(2,N) = WOBYL
!??   Enddo
!
!    'PUT' the WOBTAB array into the database.
!**   CALL PUT4 ('WOBEPOCH      ', WOBTAB, int2(2), MEPOCH, int2(1))
!
!    Go here if bypassing the interpolation step.
  400 CONTINUE
!
!    Check KWOBD for debug output.
      IF ( KWOBD .EQ. 0 ) GO TO 500
       WRITE ( 6, 9)
    9  FORMAT (1X, 'Debug output for subroutine dWOBI.' )
    7  FORMAT(A,15I8/(9X,15I8))
       WRITE(6,8)' WOBIF ',WOBIF
    8  FORMAT(A,4D25.16/(8X,5D25.16))
       WRITE(6,8)' XYWOB   ',XYWOB
       WRITE(6,8)' ROTEPH  ',ROTEPH
       WRITE(6,8)' WOBTAB  ',WOBTAB
!
!     Normal conclusion.
  500 RETURN
      END
!
!*************************************************************************
      SUBROUTINE SPACEI(I)
      Implicit None
!
!     SPACEI is the spacecraft module input and initialization section.
!
!     Common blocks used -
!
      INCLUDE 'd_input.i'
!        Variables 'from':
!          1. SpcIF(3)     - The spacecraft information array for the  
!                               current near-field sources. Contains
!                               1) The Julian date of the first tabular 
!                               point, 2) The increment in fractional days
!                               of the tabular points, 3) The number of 
!                               tabular points.  (days, days, unitless)
!          2. SpTag(NF_row,10) - The time tags for the spacecraft positions
!                               and velocities, for up to 10 near-field sources.
!          3. SpPos(NF_row,3,10) - The X,Y,Z tabular points of the spacecraft
!                               geocentric J2000 position (meters).
!          4. SpVel(NF_row,3,10) - The X,Y,Z tabular points of the spacecraft
!                               geocentric J2000 velocity (meters/sec).
!
!   Program specifications -
!
      Real*8  xa(NF_row), xb(NF_row)
      Real*8 yp1x,ypnx,yp1y,ypny
      REAL*8 XJD, UTC, tab_time, X_Sp
      Integer*4 I, Ierr4, Ix, Ia(NF_row)
      INTEGER*4  Increment, Tab_len, I_Sp
!
      Integer*4 MXEPCH, N, II
!
!
!     Program Variables -
!           1. I         -  The spacecraft index number, usually 1.
!           2. Increment -  The increment of the wobble table. (days)
!                           (milliarcsec)
!           3. XJD       -  The Julian date at 0:00 hours UTC of the
!                           interpolation epoch. (days)
!           4. UTC       -  The UTC fraction of the UTC day of the
!                           interpolation epoch. (days)
!           5. Tab_len   -  The length of the Wobble table in the database.
!           6. tab_time  -  The fraction of the day of the interpolation epoch
!                           in WOBMU. (days)
!
! 3.2.9 PROGRAMMER - David Gordon Feb. 2013
!       2015-JUL-16 D.G.  Updated with spacecraft index number for jobs 
!                         with both near- and far-field sources.
!
!
!  Create the SpcIF array
!       SpcIF(1) = SpTag(1,I) + 2400000.5D0   ! Full Julian Date
        SpcIF(1) = SpTag(1,I)                 ! MJD 
          X_Sp = (SpTag(2,I) - SpTag(1,I))*86400.D0 + .01
          I_Sp = X_Sp 
        SpcIF(2) = I_Sp/86400.D0
        SpcIF(3) = Numrows(I)
!      write(6,*) 'SPACEI: I,SpcIF,Numrows: ', I, SpcIF, Numrows(I)
!
      Increment = SpcIF(2) + 0.01
      Tab_len   = SpcIF(3) + 0.01
!
!   Code for spline interpolation initialization.
!
       S_spline = tab_len
      do ii=1, S_spline
       ySPxp(ii) = SpPos(ii,1,I)
       ySPyp(ii) = SpPos(ii,2,I)
       ySPzp(ii) = SpPos(ii,3,I)
       ySPxv(ii) = SpVel(ii,1,I)
       ySPyv(ii) = SpVel(ii,2,I)
       ySPzv(ii) = SpVel(ii,3,I)
      enddo
!
      xa(1) = SpcIF(1)
      do ii=2, S_spline
       xa(ii) = xa(ii-1) + SpcIF(2)
      enddo
!
!   If interval is not 1.0 days, then divide by interval
      If ( Abs(SpcIF(2) - 1.D0) .gt. 1.D-10) then
        do ii=1, S_spline
         xb(ii) = (xa(ii)-SpcIF(1)) / SpcIF(2)  + .001D0
         Ia(ii) = xb(ii)
         xc(ii) = Ia(ii)
        enddo
      endif
!
!   Take first derivatives at endpoints for X-positions
      yp1x = (ySPxp(2)-ySPxp(1)) / (xc(2)-xa(1))
      ypnx = (ySPxp(S_spline)-ySPxp(S_spline-1))/                       &
     &       (xc(S_spline)-xc(S_spline-1))
!   Call spline initialization subroutine for X-positions
      call splyne(xc,ySPxp,S_spline,yp1x,ypnx,y2SPxp,ierr4)
!
!   Take first derivatives at endpoints for Y-positions
      yp1x = (ySPyp(2)-ySPyp(1)) / (xc(2)-xc(1))
      ypnx = (ySPyp(S_spline)-ySPyp(S_spline-1))/                       &
     &       (xc(S_spline)-xc(S_spline-1))
!   Call spline initialization subroutine for Y-positions
      call splyne(xc,ySPyp,S_spline,yp1x,ypnx,y2SPyp,ierr4)
!
!   Take first derivatives at endpoints for Z-positions
      yp1x = (ySPzp(2)-ySPzp(1)) / (xc(2)-xc(1))
      ypnx = (ySPzp(S_spline)-ySPzp(S_spline-1))/                       &
     &       (xc(S_spline)-xc(S_spline-1))
!   Call spline initialization subroutine for Z-positions
      call splyne(xc,ySPzp,S_spline,yp1x,ypnx,y2SPzp,ierr4)
!
!   Take first derivatives at endpoints for X-velocities
      yp1x = (ySPxv(2)-ySPxv(1)) / (xc(2)-xc(1))
      ypnx = (ySPxv(S_spline)-ySPxv(S_spline-1))/                       &
     &       (xc(S_spline)-xc(S_spline-1))
!   Call spline initialization subroutine for X-velocities
      call splyne(xc,ySPxv,S_spline,yp1x,ypnx,y2SPxv,ierr4)
!
!   Take first derivatives at endpoints for Y-velocities
      yp1x = (ySPyv(2)-ySPyv(1)) / (xc(2)-xc(1))
      ypnx = (ySPyv(S_spline)-ySPyv(S_spline-1))/                       &
     &       (xc(S_spline)-xc(S_spline-1))
!   Call spline initialization subroutine for Y-velocities
      call splyne(xc,ySPyv,S_spline,yp1x,ypnx,y2SPyv,ierr4)
!
!   Take first derivatives at endpoints for Z-velocities
      yp1x = (ySPzv(2)-ySPzv(1)) / (xc(2)-xc(1))
      ypnx = (ySPzv(S_spline)-ySPzv(S_spline-1))/                       &
     &       (xc(S_spline)-xc(S_spline-1))
!   Call spline initialization subroutine for Z-velocities
      call splyne(xc,ySPzv,S_spline,yp1x,ypnx,y2SPzv,ierr4)
!
!
!    Check debug output.
!     IF ( KWOBD .EQ. 0 ) GO TO 500
!      WRITE ( 6, 9)
    9  FORMAT (1X, 'Debug output for subroutine SPACEI.' )
    7  FORMAT(A,15I8/(9X,15I8))
    8  FORMAT(A,4D25.16/(8X,5D25.16))
!      WRITE(6,8)' SpcIF  ', SpcIF
!      WRITE(6,8)' SpTag  ', (SpTag(ix,I), ix=1,S_spline)
!      WRITE(6,*) ' S_spline: ', S_spline
!      WRITE(6,8)' xa     ', (xa(ix),ix=1,S_spline)   
!      WRITE(6,8)' xb     ', (xb(ix),ix=1,S_spline)   
!      WRITE(6,8)' xc     ', (xc(ix),ix=1,S_spline)   
!      WRITE(6,*)' Ia     ', (Ia(ix),ix=1,S_spline)   
!      WRITE(6,8)' SpPosX ', (SpPos(ix,1,I), ix=1,S_spline)
!      WRITE(6,8)' SpPosY ', (SpPos(ix,2,I), ix=1,S_spline)
!      WRITE(6,8)' SpPosZ ', (SpPos(ix,3,I), ix=1,S_spline)
!      WRITE(6,8)' SpVelX ', (SpVel(ix,1,I), ix=1,S_spline)
!      WRITE(6,8)' SpVelY ', (SpVel(ix,2,I), ix=1,S_spline)
!      WRITE(6,8)' SpVelZ ', (SpVel(ix,3,I), ix=1,S_spline)
!
!      WRITE(6,8)' ySPxp  ', (ySPxp(ix), ix=1,S_spline) 
!      WRITE(6,8)' ySPyp  ', (ySPyp(ix), ix=1,S_spline) 
!      WRITE(6,8)' ySPzp  ', (ySPzp(ix), ix=1,S_spline) 
!      WRITE(6,8)' ySPxv  ', (ySPxv(ix), ix=1,S_spline) 
!      WRITE(6,8)' ySPyv  ', (ySPyv(ix), ix=1,S_spline) 
!      WRITE(6,8)' ySPzv  ', (ySPzv(ix), ix=1,S_spline) 
!
!      WRITE(6,8)' y2SPxp ', (y2SPxp(ix), ix=1,S_spline) 
!      WRITE(6,8)' y2SPyp ', (y2SPyp(ix), ix=1,S_spline) 
!      WRITE(6,8)' y2SPzp ', (y2SPzp(ix), ix=1,S_spline) 
!      WRITE(6,8)' y2SPxv ', (y2SPxv(ix), ix=1,S_spline) 
!      WRITE(6,8)' y2SPyv ', (y2SPyv(ix), ix=1,S_spline) 
!      WRITE(6,8)' y2SPzv ', (y2SPzv(ix), ix=1,S_spline) 
!
!     Normal conclusion.
  500 RETURN
      END
!
!*************************************************************************
!
      SUBROUTINE dOCNIN(Kjob,Kerr)
      Implicit None
!
      INCLUDE 'cmxst11.i'
!
      INCLUDE 'param11.i'
!       1. OC_file - Name of the ocean loading coefficients file
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!         VARIABLES 'FROM':
!            1. CONVD - THE CONVERSION FACTOR FROM DEGREES TO RADIANS (RAD/DEG)
!
      Real*8    OC11(11)
      Integer*4 I, II, Jsite(Max_stat), Iunit, ios, Iquit, Index, K
      Integer*4 Get4unit, Kjob,  Kerr
!     Integer*2 Kerr(10)
!
      Character*80 Inbuf
      Character*8  Dbsites(Max_stat)
      Equivalence (LNSITE(1,1), Dbsites(1))
!
      Character*4 Ocestat(Max_stat)
      Integer*2 L_ocestat(2,Max_stat)
      Equivalence (Ocestat,L_ocestat)
      Save Iunit
!
!  Programmer/History:
!       David Gordon 98.03.17 - Program created.
!       David Gordon 99.11.19 - Bug fix - corrected ocean loading external
!                               file site name.
!       David Gordon 2000.01.05 - Determine ocean loading statuses (must be
!                               'YES' for all stations) and PUT them into
!                               the type 1 records, Lcode 'OCE STAT'.
!       David Gordon 2006.03.30 Revised missing station message.
!       David Gordon 2006.04.03 Revised missing station message again.
!       David Gordon 2013 Jan/April - Modified for correlator usage.
!       David Gordon 2016 July 06   - Kjob added to conserve LU numbers.
!
!   Initialize station counter
       Do I = 1, Max_stat
         Jsite(i) = 0
       Enddo
!
!  Open the Ocean loading data file
       If (Kjob .eq. 1) Iunit = get4unit()
       Open (Unit=Iunit, File=OC_file, Status='old', Action='READ',     &
     &       Err=240, Iostat=ios)
!
      If ( Index(OC_file,'blokq') .gt. 0) Then
!  Blokq.dat file, find the ocean loading coefficients catalog
  50   Continue
       Read(iunit,'(A80)') Inbuf
       If (Inbuf(1:2) .eq. '//') Go to 100
       Go to 50
 100   Continue
      Endif
!
 110   Continue
       Read(iunit,'(A80)',end=200) Inbuf
!   Skip comments and illegal lines
       If (Inbuf(1:2) .eq. '$$') Go to 110
       If (Inbuf(1:2) .ne. '  ') Go to 110
!      If (Inbuf(11:11) .ne. ' ' ) Go to 110
!
!   Finished site catalog
       If (Inbuf(1:2) .eq. '//') Go to 200
!
! See if this station is in the database list
       Do I = 1, Numsit
         If (Inbuf(3:10) .eq. Dbsites(I) .or.                           &
     &       Inbuf(13:20) .eq. Dbsites(I) .or.                          &
     &       Inbuf(23:30) .eq. Dbsites(I) ) Then
!    &       Inbuf(13:14) .eq. Dbsites(I)(1:2) .or.                     &
!    &       Inbuf(23:24) .eq. Dbsites(I)(1:2) ) Then
!**       print *, 'dOCNIN: Site ', Dbsites(I)
!  Matched I'th station in data base station list, save station particulars
           II = I
!
!  Skip comments
 170    Continue
        Read(iunit,'(A80)',end=200) Inbuf
        If (Inbuf(1:2) .eq. '$$') Go to 170
!
!   Read 6 data lines
        Read(Inbuf,*,err=180) OC11
          Do k=1,11
           SITOAM(k,II) = OC11(k)
          Enddo
!
        Read(Iunit,*,err=180) OC11
          Do k=1,11
           SITHOA(k,1,II) = OC11(k)
          Enddo
        Read(Iunit,*,err=180) OC11
          Do k=1,11
           SITHOA(k,2,II) = OC11(k)
          Enddo
!
        Read(Iunit,*,err=180) OC11
          Do k=1,11
           SITOPH(k,II) = OC11(k) * CONVD
          Enddo
        Read(Iunit,*,err=180) OC11
          Do k=1,11
           SITHOP(k,1,II) = OC11(k) * CONVD
          Enddo
        Read(Iunit,*,err=180) OC11
          Do k=1,11
           SITHOP(k,2,II) = OC11(k) * CONVD
          Enddo
!
           Jsite(II)    = II
!
         Endif
       Enddo
!
       Go to 110
!
 200   Continue
!
       Close(Iunit)
!
!   Verify that we have ocean loading a priori's for all stations, except any
!    site at the geocenter. If not, we must quit here and tell the user to fix
!    the problem.
!
        Iquit = 0
!
      DO I = 1, Numsit
        If (Jsite(i) .eq. 0) Then
           If (I .ne. Zero_site) Then
            If (iquit.eq.0) Write(6,'(/)')
            Write(6,'("Warning - No ocean loading coefficients for ",   &
     &         A8,/, "Will continue but you really should update file ", &
     &         A128,/)')  Dbsites(I), OC_file
            Iquit = Iquit + 1
             Do k = 1, 11
              SITOAM(k,I)   = 0.D0
              SITHOA(k,1,I) = 0.D0
              SITHOA(k,2,I) = 0.D0
              SITOPH(k,I)   = 0.D0
              SITHOP(k,1,I) = 0.D0
              SITHOP(k,2,I) = 0.D0
             Enddo
           Endif
        Endif
!        If (Iquit .gt. 0) Then
!            Write(6,'(/,"!!! Missing ocean loading!!! Update file ",/,   &
!    &       10X, A80,/,3X, " and rerun Calc!!!",/ )') OC_file 
!            Call TERMINATE_CALC( 'dOCNIN ',int2(0), int2(0))
!        Endif
      ENDDO
!
       Go to 270
!
!   Error on Read
 180  Continue
      WRITE (6,*)  'dOCNIN: Error on read of ocean loading file '
        Call TERMINATE_CALC('dOCNIN ', int2(0), int2(0))
!
!   Error on OPEN
 240  Continue
      WRITE ( 6, * )  'OCNIN: Error on OPEN of ocean loading file '
        Call TERMINATE_CALC('OCNIN ', int2(0), int2(0))
!
 270  Continue
!
      Return
      End
!*************************************************************************
      SUBROUTINE dANTILT(Kjob, Krr)
      Implicit None
!
      INCLUDE 'cmxst11.i'
!        Variables 'from':
!           1. LNSITE(4,Max_Stat)  - THE EIGHT CHARACTER SITE NAMES
!                                    IN THE DATABASE. (ALPHAMERIC)
!           2. NUMSIT             -  THE NUMBER OF SITES IN THE DATABASE.
!        Variables 'to':
!           2. Dbtilt(2,Max_Stat)  - Antenna fixed axis tilts, in arc-minutes.
!                                    For alt-az mounts, 1 => East tilt,
!                                    2 => North tilt.
      INCLUDE 'param11.i'
!        Variables 'from':
!           1. A_tilts -  Ascii name of the antenna fixed axis tilts file.
!
      INCLUDE 'cmxut11.i'
!        Variables 'to':
!           1. Intrvl(5,2) - First and last time tag of data in the current
!                            data base. (First index: year, month, day,
!                            hour, minute. Second index: first, last.)
!
      Character*80 Inbuf
      Character*8  Dbsites(Max_stat), Asite, Bsite, slash, Ablnk, &
     &             Bblnk
      Equivalence (LNSITE(1,1), Dbsites(1))
!
      Real*4 Tyear, Tdate, Tilt1, Tilt2, Tilt1a, Tilt2a, Tilt1b, &
     &       Tilt2b, Tdatea, Tdateb
      Real*4 XDOY, XYR
      Integer*4 Iyear, Imonth, Iday, Krr, Nsites, Mstat, Kjob
      Integer*4 I, II, Iunit, Ios, Index, I4, ICAL(12), LCAL(12)
      Integer*4 Get4unit
      Save Iunit
!
      DATA ICAL /0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334/
      DATA LCAL /0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335/
!
!  Programmer/History:
!       David Gordon 2004.05.17 Program created.
!       David Gordon 2016.07.06 Kjob added to conserve LU numbers.
!
!   Use Integer*4 quantities
       Nsites = Numsit
       Mstat = Max_stat
!
!   Initialize station tilts
       Do I = 1, Mstat
         Dbtilt(1,I) = 0.0D0
         Dbtilt(2,I) = 0.0D0
       Enddo
!
        Iyear  = Intrvl(1,1)
        Imonth = Intrvl(2,1)
        Iday   = Intrvl(3,1)
         If (Iyear .ge.  0 .and. Iyear .le. 69) Iyear = Iyear+2000
         If (Iyear .ge. 70 .and. Iyear .le. 99) Iyear = Iyear+1900
!         Write (6,*) 'dANTILT: Intrvl ', Intrvl
!         Write (6,*) 'dANTILT: Iyear,Imonth,Iday ', Iyear,Imonth,Iday
!
!   Find epoch, in years at start of session.
!    Get day of year number
        IF (MOD(Iyear,4).NE. 0) Then
          XDOY = ICAL(Imonth) + Iday
          XYR = 365.
        Else
          XDOY = LCAL(Imonth) + Iday
          XYR = 366.
        Endif
         Tyear = Float(Iyear) + XDOY/XYR
!          Write ( 6, * ) ' XDOY,XYR,Tyear ', XDOY,XYR,Tyear
!
!  Open the input file of antenna tilts
       If (Kjob .eq. 1) Iunit = get4unit()
       Open (Unit=Iunit, File=A_tilts, Status='old', Action='READ',     &
     &       Err=240, Iostat=ios)
!
!   Skip first 4 lines
       Do I = 1, 4
        Read (Iunit,'(A80)') Inbuf
       Enddo
!
 110   Continue
       Read(iunit,1001,end=300) Asite, Bsite, Tdate, Tilt1,             &
     &                                  Tilt2, slash
 1001   Format(2X,A8,1X,A8,F11.3,6X,F8.2,7X,F8.2,A8)
!
       IF ( Index(slash, '/') .gt. 0) Then
          Tilt1a = Tilt1
          Tilt2a = Tilt2
          Tdatea = Tdate
          Tilt1b = Tilt1
          Tilt2b = Tilt2
          Tdateb = Tdate
          Go to 200
       Endif
!
!             More lines for this station
          Tilt1a = Tilt1
          Tilt2a = Tilt2
          Tdatea = Tdate
       If (Tyear .le. Tdate) Then
          Tilt1b = Tilt1
          Tilt2b = Tilt2
          Tdateb = Tdate
!           Read till '/' found
  180     Continue
          Read(iunit,1001) Ablnk, Bblnk, Tdate, Tilt1, Tilt2, slash
          IF (Index(slash, '/') .gt. 0) Go to 200
          Go to 180
       Endif
!
  182      Continue
          Read(Iunit,1001) Ablnk, Bblnk, Tdate, Tilt1, Tilt2, slash
          If (Tyear .le. Tdate) Then
          Tilt1b = Tilt1
          Tilt2b = Tilt2
          Tdateb = Tdate
          IF (Index(slash, '/') .gt. 0) Go to 200
  184      Continue
           Read(iunit,1001) Ablnk, Bblnk, Tdate, Tilt1, Tilt2, slash
           IF (Index(slash, '/') .gt. 0) Go to 200
           Go to 184
!
          Else
            IF (Index(slash, '/') .le. 0) Then
             Tilt1a = Tilt1
             Tilt2a = Tilt2
             Tdatea = Tdate
             Go to 182
            Else
             Tilt1b = Tilt1
             Tilt2b = Tilt2
             Tdateb = Tdate
            Endif
!
          Endif
!
 200   Continue
!       Write (6,*) ' Asite, Bsite, Tyear: ', Asite, Bsite, Tyear
!       Write (6,*) ' Tdatea,Tilt1a,Tilt2a: ', Tdatea,Tilt1a,Tilt2a
!       Write (6,*) ' Tdateb,Tilt1b,Tilt2b: ', Tdateb,Tilt1b,Tilt2b
!
!  Match I'th station and find its tilt for this epoch.
      Do I = 1, Nsites
       If (Asite .eq. Dbsites(I) .or. Bsite .eq. Dbsites(I)) Then
         II = I
         Go to 155
       Endif
      Enddo
       Go to 110
!
 155  Continue
        If ( ABS(Tdateb-Tdatea) .lt. .002 ) Then
          Dbtilt(1,II) = Tilt1a
          Dbtilt(2,II) = Tilt2a
        Else
          Dbtilt(1,II) = Tilt1a + (Tyear-Tdatea)*(Tilt1b-Tilt1a)/       &
     &                   (Tdateb-Tdatea)
          Dbtilt(2,II) = Tilt2a + (Tyear-Tdatea)*(Tilt2b-Tilt2a)/       &
     &                   (Tdateb-Tdatea)
        Endif
!       Write (6,*) 'dANTILT: ', II,Dbsites(II),Dbtilt(1,II),Dbtilt(2,II)
!
       Go to 110
!
 300   Continue
       Close(Iunit)
!
       Krr = 0
       Go to 270
!
!   Error on OPEN
 240  Continue
      Krr = -1
      WRITE (6,*)  'Error on OPEN of blokq file '
!
 270  Continue
      Return
      End

!*************************************************************************
      SUBROUTINE dOPTLIN(Kjob, Kerr)
      Implicit None
!
      INCLUDE 'cmxst11.i'
!
      INCLUDE 'param11.i'
!       1. OPTL_file - Name of the ocean pole tide loading coefficients
!                      file.
!
      Character*80 Inbuf
!     Real*8    OPTL6(6,Max_stat)
      Real*8 Vlon, Vlat, XYZ(3), u_rR, u_rI, u_nR, u_nI, u_eR, u_eI
      Character*8  Vsite, Dbsites(Max_stat)
      Equivalence (LNSITE(1,1), Dbsites(1))
      Integer*4 I, II, Jsite(Max_stat), Iunit, Ios, Iquit, Index, J
      Integer*4 Get4unit, Kjob, Kerr
!     Integer*2 Kerr(10)
      Character*3 C3, dum1, dum2, dum3
      Save Iunit
!
!  Programmer/History:
!       David Gordon 2012.11.28 - Program created.
!       David Gordon 2016.07.06 - Kjob added to conserve LU numbers.
!
!   Initialize station counter
       Do I = 1, Max_stat
         Jsite(i) = 0
         Do J = 1,6
          OPTL6(J,I) = 0.0D0
         Enddo
       Enddo
!
!  Open the Ocean pole tide loading data file
       If (Kjob .eq. 1) Iunit = get4unit()
       Open (Unit=Iunit, File=OPTL_file, Status='old', Action='READ',   &
     &       Err=240, Iostat=Ios)
!
  50   Continue
       Read(Iunit,'(A80)',Err=180,End=250) Inbuf
!       Write(6,*) Inbuf
       If (Inbuf(1:36) .eq. 'Ocean Pole Tide Loading Coefficients')     &
     &     Go to 100
       Go to 50
 100   Continue
!  Skip 4 lines
       Do I = 1,4
        Read(iunit,'(A80)') Inbuf
       Enddo
!
 110   Continue
       Read(iunit,1001,err=110,end=200) Vsite, C3, Vlat, Vlon, u_rR,    &
     &        u_rI, u_nR, u_nI, u_eR, u_eI
 1001  Format(1x,A8,1X,A3,1x,F6.2,3X,F8.2,6(2X,F10.6))
!
! see if this station is in the database list
       do I = 1, Numsit
         If (Vsite .eq. Dbsites(I) .or. C3 .eq. Dbsites(I)(1:3)) Then
!         print *, 'OPTLIN: Site matched - ', Dbsites(I)
!  matched I'th station in data base station list, save station particulars
           II = I
          OPTL6(1,II) =  u_rR
          OPTL6(2,II) =  u_rI
          OPTL6(3,II) =  u_nR
          OPTL6(4,II) =  u_nI
          OPTL6(5,II) =  u_eR
          OPTL6(6,II) =  u_eI
           Jsite(II) = II
!
         Endif
       enddo
!
       go to 110
!
 200   continue
!
       close(Iunit)
!
!   Verify that we have ocean pole tide loading coefficients for all stations,
!    except any site at the geocenter. If not, we must quit here and tell the 
!    user to fix the problem.
!
        iquit = 0
!
      do I = 1, Numsit
        if (Jsite(I) .eq. 0 .and. I .ne. Zero_site) Then
          If (iquit.eq.0) Write(6,'(/)')
          Write(6,'("Warning - No ocean pole tide loading coefficients for ",  &
     &         A8,/, "Will continue but you really should update file ", &
     &         A50,/)')  Dbsites(I), OPTL_file
          Iquit = Iquit + 1
        endif
!        If (Iquit .gt. 0) Then
!            Write(6,'(/,"!!! Missing ocean pole tide loading!!! You"   &
!    &       " really should update file ",/, A80, /,                   &
!    &       " and rerun Calc!!!",/ )') OPTL_file 
!!!!!        Call TERMINATE_CALC( 'OPTLIN ',int2(0), int2(0))
!        Endif
      enddo
!
!
!      Write(6,'(" OPTLIN: Ocean pole tide loading coefficients: ")')
!     Do I=1,Numsit
!      Write (6,1073) Dbsites(I), OPTL6(1,I), OPTL6(2,I), OPTL6(3,I),   &
!    &                OPTL6(4,I), OPTL6(5,I), OPTL6(6,I)
!1073  Format(1x,A8,3X,6(2X,F10.6))
!     Enddo
!   
!
       Go To 270
!
!   error on Read
 180  continue
      Write (6,*)  'OPTLIN: Error on read of ocean loading file '
        call TERMINATE_CALC('OPTLIN ', int2(0), int2(0))
!
!   error on OPEN
 240  continue
       close (Iunit)
      wriTE (6,*)  'OPTLIN: Ocean Pole Tide Loading not found '
        call TERMINATE_CALC('OPTLIN ', int2(0), int2(0))
!
 250  continue
       close (Iunit)
      Write(6,*) 'OPTLIN: Ocean Pole Tide Loading section was not found'
        call TERMINATE_CALC('OPTLIN ', int2(0), int2(0))
!
 270  continue
       close (Iunit)
      return
      end
      SUBROUTINE VECAD ( A, B, C )
      IMPLICIT None
!
! 1.    VECAD
!
! 1.1   VECAD PROGRAM SPECIFICATION
!
! 1.1.1 VECAD IS THE VECTOR UTILITY ROUTINE WHICH ADDS TOGETHER
!       TWO VECTORS PRODUCING A SUM VECTOR.
!
! 1.1.2 RESTRICTIONS - NONE
!
! 1.1.3 REFERENCES - NONE
!
! 1.2   VECAD PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1.  A(3,3)  -  THE FIRST VECTOR.
!             2.  B(3,3)  -  THE SECOND VECTOR.
!
!           OUTPUT VARIABLES:
!             1.  C(3,3)  -  THE SUM OF VECTORS A AND B.
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES "TO": NONE
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), B(3), C(3)
      Integer*4 I
!
! 1.2.4 DATA BASE ACCESS - NONE
!
! 1.2.5 EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG OUTPUT
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: ETDG, ETDP, SITCR, STRCR
!             CALLED SUBROUTINES: NONE
!
! 1.2.7 CONSTANTS USED - NONE
!
! 1.2.8 PROGRAM VARIABLES - NONE
!
! 1.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    SAVITA GOEL    06/04/97 (CDS FOR A900)
!                    David Gordon 94.04.18 Converted to Implicit None.
!
! 1.3   VECAD PROGRAM STRUCTURE
!
!   1.    PERFORM THE ADDITION.
!
      DO 100  I = 1,3
           C(I) = A(I) + B(I)
  100 CONTINUE
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE VECAD." )
!
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'B   = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'C   = ', 3 ( D30.16, 10X ) )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!*****************************************************************************
      SUBROUTINE VECSB ( A, B, C )
      IMPLICIT None
!
! 2.    VECSB
!
! 2.1   VECSB PROGRAM SPECIFICATION
!
! 2.1.1 VECSB IS THE VECTOR UTILITY ROUTINE WHICH SUBTRACTS
!       TWO VECTORS PRODUCING A DIFFERENCE VECTOR.
!
! 2.1.2 RESTRICTIONS - NONE
!
! 2.1.3 REFERENCES - NONE
!
! 2.2   VECSB PROGRAM INTERFACE
!
! 2.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1.  A(3,3)  -  THE FIRST VECTOR.
!             2.  B(3,3)  -  THE SECOND VECTOR.
!
!           OUTPUT VARIABLES:
!             1.  C(3,3)  -  THE DIFFERENCE OF VECTORS A AND B.
!
! 2.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES "TO": NONE
!
! 2.2.2 PROGRAM SPECIFICATIONS -
!
      Real*8  A(3), B(3), C(3)
      Integer*4 I
!
! 2.2.4 DATA BASE ACCESS - NONE
!
! 2.2.5 EXTERNAL INPUT/OUTPUT -  POSSIBLE DEBUG OUTPUT
!
! 2.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: ETDC, ETDG, SITCR, SITG
!             CALLED SUBROUTINES: NONE
!
! 2.2.7 CONSTANTS USED - NONE
!
! 2.2.8 PROGRAM VARIABLES - NONE
!
! 2.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    David Gordon 94.04.18 Converted to Implicit None.
!
! 2.3   VECSB PROGRAM STRUCTURE
!
!   1.    PERFORM THE SUBTRACTION.
!
      DO 100  I = 1,3
           C(I) = A(I) - B(I)
  100 CONTINUE
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE VECSB." )
!
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A    = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'B    = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'C    = ', 3 ( D30.16, 10X ) )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!******************************************************************************
      Real*8 FUNCTION DOTP ( A, B )
      IMPLICIT None
!
! 3.    DOTP
!
! 3.1   DOTP PROGRAM SPECIFICATION
!
! 3.1.1 DOTP IS THE VECTOR UTILITY ROUTINE WHICH COMPUTES THE DOT
!       PRODUCT BETWEEN TWO VECTORS.
!
! 3.1.2 RESTRICTIONS - NONE
!
! 3.1.3 REFERENCES - NONE
!
! 3.2   DOTP PROGRAM INTERFACE
!
! 3.2.1 CALLING SEQUENCE - NONE
!
!           INPUT VARIABLES:
!             1.  A(3)  -  THE FIRST VECTOR.
!             2.  B(3)  -  THE SECOND VECTOR.
!
!           OUTPUT VARIABLES:
!             1.  DOTP  -  THE DOT PRODUCT BETWEEN VECTORS A AND B.
!
! 3.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES "TO": NONE
!
! 3.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), B(3)
!
! 3.2.4 DATA BASE ACCESS - NONE
!
! 3.2.5 EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG OUTPUT
!
! 3.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: AXOG, ETDC, ETDG, ETDP, PREP, RELP,
!                                 SITP, SUNCR, UT1P, WOBP, etc., etc.
!             CALLED SUBROUTINES: NONE
!
! 3.2.7 CONSTANTS USED - NONE
!
! 3.2.8 PROGRAM VARIABLES - NONE
!
! 3.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    David Gordon 94.04.18 Converted to Implicit None.
!
! 3.3   DOTP PROGRAM STRUCTURE
!
!   1.    COMPUTE THE DOT PRODUCT.
!
      DOTP = A(1) * B(1) &
     &     + A(2) * B(2) &
     &     + A(3) * B(3)
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR FUNCTION DOTP." )
!
      WRITE ( 6, 9200 )  A, B, DOTP
 9200 FORMAT (1X, "A   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'B   = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'DOTP   = ', D30.16 )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!******************************************************************************
      Real*8 FUNCTION VECMG ( A )
      IMPLICIT None
!
! 4.    VECMG
!
! 4.1   VECMG PROGRAM SPECIFICATION
!
! 4.1.1 VECMG IS THE VECTOR UTILITY ROUTINE WHICH COMPUTES THE
!       MAGNITUDE OF A VECTOR.
!
! 4.1.2 RESTRICTIONS - NONE
!
! 4.1.3 REFERENCES - NONE
!
! 4.2   VECMG PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE - NONE
!
!           INPUT VARIABLES:
!             1.  A(3)  -  THE VECTOR IN QUESTION.
!
!           OUTPUT VARIABLES:
!             1.  VECMG  -  THE MAGNITUDE OF THE VECTOR A.
!
! 4.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES "TO": NONE
!
! 4.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), DOTP
!
! 4.2.4 DATA BASE ACCESS - NONE
!
! 4.2.5 EXTERNAL INPUT/OUTPUT -  POSSIBLE DEBUG OUTPUT
!
! 4.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: ETDG, SUNCR, et., etc.
!             CALLED SUBROUTINES: DOTP, DSQRT
!
! 4.2.7 CONSTANTS USED - NONE
!
! 4.2.8 PROGRAM VARIABLES - NONE
!
! 4.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    David Gordon 94.04.18 Converted to Implicit None.
!
! 4.3   VECMG PROGRAM STRUCTURE
!
!   1.    PERFORM THE COMPUTATION.
!
      VECMG = DSQRT ( DOTP ( A, A ) )
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR FUNCTION VECMG." )
!
      WRITE ( 6, 9200 )  A, VECMG
 9200 FORMAT (1X, "A    = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'VECMG = ', D30.16 )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!******************************************************************************
      SUBROUTINE VUNIT ( A, B )
      IMPLICIT None
!
! 5.    VUNIT
!
! 5.1   VUNIT PROGRAM SPECIFICATION
!
! 5.1.1 VUNIT IS THE VECTOR UTILITY ROUTINE WHICH NORMALIZES A
!       VECTOR TO PRODUCE A UNIT VECTOR.
!
! 5.1.2 RESTRICTIONS - NONE
!
! 5.1.3 REFERENCES - NONE
!
! 5.2   VUNIT PROGRAM INTERFACE
!
! 5.2.1 CALLING SEQUENCE - NONE
!
!           INPUT VARIABLES:
!             1.  A(3)  -  THE UNNORMALIZED VECTOR.
!
!           OUTPUT VARIABLES:
!             1.  B(3)  -  THE NORMALIZED UNIT VECTOR.
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES "TO": NONE
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), B(3), Amag, Vecmg
      Integer*4 I
!
! 5.2.4 DATA BASE ACCESS - NONE
!
! 5.2.5 EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG OUTPUT
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: STRCR, SUNCR, THERR
!             CALLED SUBROUTINES: VECMG
!
! 5.2.7 CONSTANTS USED - NONE
!
! 5.2.8 PROGRAM VARIABLES -
!           1.  AMAG  -  THE MAGNITUDE OF THE VECTOR A.
!
! 5.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    David Gordon 94.04.18 Converted to Implicit None.
!
! 5.3   VUNIT PROGRAM STRUCTURE
!
!   1.    PERFORM THE NORMALIZATION.
!
      AMAG = VECMG ( A )
      DO 100  I = 1,3
           B(I) = A(I) / AMAG
  100 CONTINUE
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE VUNIT." )
!
      WRITE ( 6, 9200 )  A, B, AMAG
 9200 FORMAT (1X, "A    = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'B    = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'AMAG = ', D30.16 )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!******************************************************************************
      SUBROUTINE CROSP ( A, B, C )
      IMPLICIT None
!
! 6.    CROSP
!
! 6.1   CROSP PROGRAM SPECIFICATION
!
! 6.1.1 CROSP IS THE VECTOR UTILITY ROUTINE WHICH COMPUTES THE
!       CROSS PRODUCT OF TWO VECTORS.
!
! 6.1.2 RESTRICTIONS - NONE
!
! 6.1.3 REFERENCES - NONE
!
! 6.2   CROSP PROGRAM INTERFACE
!
! 6.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1.  A(3)  -  THE FIRST VECTOR.
!             2.  B(3)  -  THE SECOND VECTOR.
!
!           OUTPUT VARIABLES:
!             3.  C(3)  -  THE VECTOR REPRESENTING THE CROSS PRODUCT OF A x B.
!
! 6.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES "TO": NONE
!
! 6.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), B(3), C(3)
!
! 6.2.4 DATA BASE ACCESS - NONE
!
! 6.2.5 EXTERNAL INPUT/OUTPUT -  POSSIBLE DEBUG OUTPUT
!
! 6.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: SUNCR
!             CALLED SUBROUTINES: NONE
!
! 6.2.7 CONSTANTS USED - NONE
!
! 6.2.8 PROGRAM VARIABLES - NONE
!
! 6.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    David Gordon 94.04.18 Converted to Implicit None.
!
! 6.3   CROSP PROGRAM STRUCTURE
!
!   1.    PERFORM THE CROSS PRODUCT.
!
      C(1) = A(2) * B(3)  -  B(2) * A(3)
      C(2) = A(3) * B(1)  -  B(3) * A(1)
      C(3) = A(1) * B(2)  -  B(1) * A(2)
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE CROSP." )
!
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A    = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'B    = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'C    = ', 3 ( D30.16, 10X ) )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!**********************************************************************
      SUBROUTINE VECEQ ( A, C )
      IMPLICIT None
!
! 1.    VECEQ
!
! 1.1   VECEQ PROGRAM SPECIFICATION
!
! 1.1.1 VECEQ IS THE VECTOR UTILITY ROUTINE WHICH SETS AN INPUT VECTOR
!       EQUAL TO AN OUTPUT VECTOR.
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3) - INPUT VECTOR.
!           OUTPUT VARIABLES:
!             1. C(3,3) - OUTPUT VECTOR.
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), C(3)
      Integer*4 I
!
! 1.2.9 PROGRAMMER - David Gordon  Feb. 2013 
!
! 1.3   VECEQ PROGRAM STRUCTURE
!
!   1. PERFORM THE EQUALIZATION.
!
      DO 100  I = 1,3
           C(I) = A(I)
  100 CONTINUE
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE VECAD." )
!
      WRITE ( 6, 9200 )  A, C
 9200 FORMAT (1X, "A   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'C   = ', 3 ( D30.16, 10X ) )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!
!*****************************************************************************
      SUBROUTINE VECDV ( A, D, C )
      IMPLICIT None
!
! 1.    VECDV
!
! 1.1   VECDV PROGRAM SPECIFICATION
!
! 1.1.1 VECDV IS THE VECTOR UTILITY ROUTINE WHICH DIVIDES A VECTOR
!       BY A CONSTANT.
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3) - INPUT VECTOR.
!             2. D      - Constanat to divide by.
!           OUTPUT VARIABLES:
!             1. C(3,3) - OUTPUT VECTOR.
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), C(3), D
      Integer*4 I
!
! 1.2.9 PROGRAMMER - David Gordon  Feb. 2013 
!
! 1.3   VECDV PROGRAM STRUCTURE
!
!   1. PERFORM THE DIVISION.
!
      DO 100  I = 1,3
           C(I) = A(I)/D
  100 CONTINUE
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE VECDV." )
!
      WRITE ( 6, 9200 )  A, D, C
 9200 FORMAT (1X, "A   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'D   = ', ( D30.16, 10X ), /, 1X, &
     &            'C   = ', 3 ( D30.16, 10X ) )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!
!*****************************************************************************
      SUBROUTINE VECMU ( A, M, C )
      IMPLICIT None
!
! 1.    VECMU
!
! 1.1   VECMU PROGRAM SPECIFICATION
!
! 1.1.1 VECMU IS THE VECTOR UTILITY ROUTINE WHICH MULTIPLIES A VECTOR
!       BY A CONSTANT.
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3) - INPUT VECTOR.
!             2. M      - Constanat to multiply by.
!           OUTPUT VARIABLES:
!             1. C(3,3) - OUTPUT VECTOR.
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!            VARIABLES "FROM":
!              1.  KVECC  -  THE VECTOR UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KVECD  -  THE VECTOR UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3), C(3), M
      Integer*4 I
!
! 1.2.9 PROGRAMMER - David Gordon  Feb. 2013 
!
! 1.3   VECMU PROGRAM STRUCTURE
!
!   1. PERFORM THE MULTIPLICATION
!
      DO 100  I = 1,3
           C(I) = A(I) * M
  100 CONTINUE
!
!   2.    CHECK KVECD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
!
      IF ( KVECD .EQ. 0 )  GO TO 300
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE VECMU." )
!
      WRITE ( 6, 9200 )  A, M, C
 9200 FORMAT (1X, "A   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            'M   = ', ( D30.16, 10X ), /, 1X, &
     &            'C   = ', 3 ( D30.16, 10X ) )
!
!   3.    NORMAL PROGRAM CONCLUSION.
!
  300 RETURN
      END
!*****************************************************************************
      SUBROUTINE AXOG (KAXIS, R2K, SITLAT, STAR, TCTOCF, SITEV, AXOFF,  &
     &           EARTH, STAR_ABERRATED, STAR_ABERRATEDdt, SITHEIGHT,    &
     &           AXTILT, ROTAXIS, axis2000, daxis2000, C2000STR )
      IMPLICIT None
!
! 3.    AXOG
!
! 3.1   AXOG PROGRAM SPECIFICATION
!
! 3.1.1 AXOG is the geometry section of the Axis Offset Module. AXOG computes
!       the 3 dimensional axis offset vector and its time derivative corrected
!       for aberration and atmospheric refraction at each site.
!       Beginning with Calc 9.0, AXOG also computes the feedbox rotation
!       angle and the group delay and phase delay corrections, using a new
!       algorithm that replaces subroutine PANG.
!
! 3.1.2 REFERENCES - NINER, EDGAR P., 'MEMORANDUM FOR RECORD', 25 OCTOBER
!                    1967 (REFRACTION CORRECTION).
!                    SMART, W.M., "TEXTBOOK ON SPHERICAL ASTRONOMY", 1965,
!                    P. 68.
!
! 3.2   AXOG PROGRAM INTERFACE
!
! 3.2.1 CALLING SEQUENCE -
!          INPUT VARIABLES:
!             1. KAXIS(2)       -  THE ANTENNA AXIS TYPES AT EACH OBSERVATION
!                                  SITE. (UNITLESS)
!             2. R2K(3,3,3)     -  THE ROTATION MATRIX WHICH ROTATES THE CRUST
!                                  FIXED REFERENCE FRAME TO THE J2000.0 FRAME
!                                  AND ITS FIRST TWO CT TIME DERIVATIVES.
!                                  (UNITLESS, 1/SEC, 1/SEC**2)
!             3. SITLAT(2)      -  THE GEODETIC LATITUDES AT EACH OBSERVATION
!                                  SITE. (RAD)
!             4. STAR(3)        -  THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!             5. TCTOCF(3,3,2)  -  THE ROTATION MATRIX WHICH ROTATES THE
!                                  TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST
!                                  FIXED GEOCENTRIC REFERENCE SYSTEM AT EACH
!                                  OBSERVATION SITE. (UNITLESS)
!             6. SITEV(3,2)     -  THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF
!                                  EACH OBSERVATION SITE. (M/SEC)
!             7. AXOFF(2)       -  THE ANTENNA AXIS OFFSETS AT EACH OBSERVATION
!                                  SITE. (M)
!             8. EARTH(3,3)     -  THE SSBC EARTH POSITION, VELOCITY, AND
!                                  ACCELERATION VECTORS. (M, M/SEC, M/SEC**2)
!            11. STAR_ABERRATED(3,2) - The J2000 source unit vector corrected
!                                  for annual and diurnal aberration at each
!                                  site. (unitless)
!            12. SITHEIGHT(2)   -  Station heights above the geoid. (meters)
!            13. AXTILT(2,2)    -  Antenna fixed axis tilts (arc-seconds).
!                                  First index runs over the two orthogonal
!                                  tilt directions (Alt-Az: 1 => East,
!                                  2 => North; (X-Y (N-S or E-W fixed) and
!                                  Equatorial: 1 => Az error, 2 => Elev error).
!                                  Second index runs over the two stations.
!            14. ROTAXIS(3,3,2) -  Topocentric rotation matrices representing
!                                  the fixed axis tilts for station 1 and
!                                  station 2 of the current observation.
!
!          OUTPUT VARIABLES:
!             1. axis2000(3,2) -  Vector axis offset of antenna in the J2000.0
!                                 frame (effect on baseline). First index is
!                                 X,Y,Z (meters), second runs over sites.
!             2. daxis2000(3,2) - Time derivative of axis2000, rate of change
!                                 of vector axis offset of antenna in the
!                                 J2000.0 frame (effect on baseline). First
!                                 index is velocity, second runs over sites.
!
! 3.2.2 COMMON BLOCKS USED -
!
      Real*8  DAXOP(2,2), DCOMP(2,2), RICHM(2), Tpartl(2),              &
     &         uaxis2000(3,2), duaxis2000(3,2)
      COMMON / AXOCM / DAXOP, DCOMP, RICHM, Tpartl, uaxis2000,duaxis2000
!         VARIABLES 'TO':
!            1. DCOMP(2,2) - THE PARTIAL DERIVATIVES OF THE COMPONENT OF THE
!                            ANTENNA AXIS OFFSET IN THE APPARENT DIRECTION OF
!                            THE SOURCE AND THE CT TIME DERIVATIVE OF THAT
!                            COMPONENT WITH RESPECT TO THE ANTENNA AXIS
!                            OFFSETS AT EACH OBSERVATION SITE. THE FIRST
!                            INDEX RUNS OVER THE OBSERVATION SITES AND THE
!                            SECOND INDEX RUNS OVER THE DELAY AND THE DELAY
!                            RATE.  (UNITLESS, 1/SEC)
!            2. RICHM(2)   - THE AXES ORIENTATION FOR THE RICHMOND ANTENNA
!                            SYSTEM. IT IS ORIENTED AS FOR AN EQUATORIAL
!                            MOUNT AT LATITUDE+39.06 DEGREES AND ROTATED 0.12
!                            DEGREES WEST OF NORTH.
!
      INCLUDE 'cphys11.i'
!           VARIABLES 'FROM':
!             1. VLIGHT  -  The velocity of light in a vacuum (m/sec).
!
      INCLUDE 'ccon.i'
!       VARIABLES 'FROM':
!         KAXOC - THE AXIS OFFSET MODULE FLOW CONTROL FLAG.
!                  = 0 ==> Axis offset corrections applied to theoreticals.
!                  = 1 ==> Axis offset corrections NOT applied to theoreticals.
!         KAXOD - THE AXIS OFFSET MODULE DEBUG OUTPUT FLAG.
!         KPANC - The feedhorn rotation module flow control flag.
!         KPAND - The feedhorn rotation module debug flag (not used).
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           VARIABLES 'FROM':
!              1. HALFPI - THE VALUE OF PI/2
!              2. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS
!                          (RAD/DEG)
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
!       DATA BASE ACCESS => Moved to PUT_G.
!
      INCLUDE 'put2s.i'
!       Variables from:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!       Variables to:
!        1. PANGL(2) - Clock-wise feedbox rotation angles at site 1 and
!                      2 in degrees of phase.
!        2. FCONT(2) - The corrections to group delay and phase delay 
!                      rate for the baseline due to feedbox rotations.
!
      INCLUDE 'get2s.i'
!       Variables from:
!          5. REF_FREQ - For databases, should be the correct reference
!                        frequency. For correlator usage, set to 1.0 MHz,
!                        should be multiplied later by the correct
!                        frequency or frequencies.
!
      INCLUDE 'cuser11.i'
!        VARIABLES 'FROM'
!          1. Calc_user - 'A' for analysis centers, 'C' for correlators.
!
! 3.2.3 PROGRAM SPECIFICATIONS -
      DATA RICHM /39.06D0, 0.12D0/
      Real*8 CFSTAR(3,2), CFTOTC(3,3), CTCSTR(3), SITEV(3,2),           &
     &       R2K(3,3,3), SITLAT(2), STAR(3), TCAXIS(3),  CTCSTRdt(3),   &
     &       TCSTAR(3,2), TCTOCF(3,3,2), TR2K(3,3,2), AXTILT(2,2),      &
     &       STAR_ABERRATED(3,2), STAR_ABERRATEDdt(3,2), SITHEIGHT(2),  &
     &       ZC, ZEN,        AZMUTH, ZENCOR, ZENCORdt, ROTAXIS(3,3,2)
      Real*8 axistc(3,2), daxistc(3,2), axiscf(3,2), daxiscf(3,2),      &
     &       AXOFF(2), xnormal, ccfstr(3), dccfstr(3), vectr(3),        &
     &       daxocnew(2,2), EARTH(3,3), c2000str(3), axis2000(3,2),     &
     &       daxis2000(3,2), dctcstr(3), vec1(3), dvec1(3), absvec1,    &
     &       dabsvec1, vec2(3), vec3(3)
      Real*8 VECMG, DOTP, AMAG, TCAXnew(3), Axdiff(3), vec1d(3),        &
     &       axistcd(3,2), axiscfd(3,2), uaxisd2k(3,2), TCAXold(3),     &
     &       absvecd
      Real*8 zen_K, tanel_K, azmuth_K, zencor_K
      Real*8 El_Rad, Sithit, Temp_K, X, Press_Hg, Humid_F, sbend
      Real*8 ZENdt, AZMUTHdt, Eldt
      Real*8 TNCP(3), ZA, DZA, DAZM, RANGL, DRANGL, FEED_COR(2,2)
      Real*8 VG(3), VE(3), TT, CFST1(3), CFST2(3)
      Integer*4 I, L, LL, kx
      Integer*2 KAXIS(2), NDO(3), KERR
!
! 3.2.6 SUBROUTINE INTERFACE -
!          CALLER SUBROUTINES: DRIVG
!          CALLED SUBROUTINES: DCOS, DSIN, DTAN, MTRAN, VECRT, VECMG, VECAD,
!                              DOTP, CROSP, VECAD, FBOX
!
! 3.2.8 PROGRAM VARIABLES -
!           1. TR2K(3,3,2)    -  THE COMPLETE J2000.0 TO CRUST FIXED
!                                ROTATION MATRIX AND ITS FIRST CT
!                                TIME DERIVATIVE. (UNITLESS, 1/SEC)
!           2. CFTOTC(3,3)    -  THE 3x3 ROTATION MATRIX WHICH ROTATES
!                                THE GEOCENTRIC CRUST FIXED REFERENCE
!                                SYSTEM TO THE TOPOCENTRIC REFERENCE
!                                SYSTEM. (UNITLESS)
!           3. CFSTAR(3,2)    -  THE SOURCE UNIT VECTOR IN THE CRUST FIXED
!                                GEOCENTRIC REFERENCE SYSTEM CORRECTED FOR
!                                ABERRATION AND ITS CT TIME DERIVATIVE.
!                                (UNITLESS, 1/SEC)
!           4. TCSTAR(3,2)    -  THE SOURCE UNIT VECTOR IN THE TOPOCENTRIC
!                                SYSTEM CORRECTED FOR ABERRATION AND ITS CT
!                                TIME DERIVATIVE. (UNITLESS, 1/SEC)
!           5. CTCSTR(3)      -  THE SOURCE UNIT VECTOR IN THE TOPOCENTRIC
!                                REFERENCE SYSTEM CORRECTED FOR ABERRATION
!                                AND ATMOSPHERIC REFRACTION. (UNITLESS)
!           6. dctcstr(3)     -  Derivative of CTCSTR (above).
!           7. ccfstr(3)      -  Aberrated/refracted source unit vector in the
!                                crust fixed frame.
!           8. dccfstr(3)     -  Time derivative of ccfstr (above).
!           9. c2000str(3)    -  Aberrated/refracted source unit vector in the
!                                J2000.0 frame.
!          10. AZMUTH         -  THE AZIMUTH OF THE TOPOCENTRIC SOURCE UNIT
!                                VECTOR CORRECTED FOR ABERRATION. (RAD)
!          12. ZEN            -  THE ZENITH ANGLE OF THE SOURCE UNIT VECTOR.
!                                (RADIANS)
!          13. ZENCOR         -  THE CORRECTION ANGLE TO THE SOURCE UNIT VECTOR
!                                DUE TO ATMOSPHERIC REFRACTION. (RADIANS)
!          14. TCAXIS(3)      -  THE UNIT VECTOR REPRESENTING THE ANTENNA FIXED
!                                AXIS IN THE TOPOCENTRIC SYSTEM. (UNITLESS)
!          16. axistc(3,2)    -  Vector axis offset of the antenna in the
!                                topocentric frame (effect on baseline). First
!                                index is X,Y,Z position (meters); second runs
!                                over the sites.
!          17. daxistc(3,2)   -  Time derivative of axistc, rate of change of
!                                vector axis offset of antenna in the
!                                topocentric frame (effect on baseline). First
!                                index is velocity, second runs over sites.
!          18. axiscf(3,2)    -  Vector axis offset of the antenna in the
!                                geocentric frame (effect on baseline). First
!                                index is X,Y,Z position (meters); second runs
!                                over the sites.
!          19. daxiscf(3,2)   -  Time derivative of axiscf, rate of change of
!                                vector axis offset of the antenna in the
!                                geocentric frame (effect on baseline). First
!                                index is velocity, second runs over sites.
!          20. uaxis2000(3,2) -  Unit vector axis offset of antenna in the
!                                J2000.0 frame. First index is X,Y,Z, second
!                                runs over sites. (unitless) [See axis2000]
!          21. duaxis2000(3,2) - Time derivative of uaxis2000, rate of change
!                                of unit vector axis offset in the J2000.0
!                                frame. First index is velocity, second runs
!                                over sites. (unitless) [See daxis2000]
!          22. El_Rad          - Source elevation for use by function Sbend to
!                                compute the atmospheric bending. (radians
!          23. Sithit          - Station height above the geoid, for use in
!                                computing atmospheric bending. (meters)
!          24. Temp_K          - A priori value for absolute temperature, for
!                                use in computing atmospheric bending. (Kelvins)
!          25. Press_Hg        - A priori value for atmospheric pressure, for
!                                use in computing atmospheric bending. (mm of
!                                mercury)
!          26. Humid_F         - A priori value for station humidity (.5).
!          27. X               - Variable related to station height, for use in
!                                computing atmospheric bending.
!          29. FEED_COR(2,2)   - The corrections to group delay and phase
!                                delay rate due to feedbox rotation. First
!                                index runs over the sites, second index runs
!                                over delay and rate. Sec, Sec/sec)
!
! 3.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!                    PETER DENATALE 07/11/77
!                    DOUG ROBERTSON ??/??/84 (RICHMOND AXIS CODING)
!                    DAVID GORDON   08/14/84 (RICHMOND)
!                    Jim Ryan 89.06.29 Character stings used.
!                    David Gordon  June - Aug, 1993 Modified to compute 3-D
!                                  axis offset vector; Aberrated star vector,
!                                  and altitude and azimuth from subroutine
!                                  ATMG added; new computation of DCOMP.
!                    David Gordon  93.12.23 Corrected division by zero problem
!                                  in DCOMP.
!                    David Gordon  94.03.08 New axis offset delay computation.
!                    David Gordon  94.03.25 Second (simpler) new axis offset
!                                  delay computation.
!                    David Gordon  94.09.21 Added function Sbend to compute
!                                  atmospheric bending. Sbend comes from the
!                                  Mark III Field System. Changed computation
!                                  of second new axis offset contribution to
!                                  combine aberration and bending. SITHEIGHT(2)
!                                  added to subroutine input arguments.
!                    David Gordon  94.10.20 Changed computation of second axis
!                                  offset correction to apply aberration to
!                                  vacuum part, but not to aberrated/refracted
!                                  part.
!                    David Gordon  94.10.24 Code cleanup.
!                    David Gordon  98.08.05 Mods for geocenter station.
!                    David Gordon  98.11.12 Code added to call the new feedbox
!                                  rotation subroutine, FBOX, and to do PUT's
!                                  of the rotation angles and the group delay
!                                  and phase delay rate corrections. Code to
!                                  GET Reference frequency added.
!                    David Gordon  98.12.30 FEED.COR access code changed from
!                                  1 and 2 combined.
!                    Jim Ryan 02.Sept Integer*2/4 updates.
!                    D. Gordon     2004 May. Axis tilt and other Calc10 mods.
!                    D. Gordon     2004 Oct. Corrected delay and partial
!                                  derivative.
!                    D. Gordon     Jan. 2013. GET's moved to GET_G. 
!                                  PUT's moved to PUT_G. 
!
! 3.3   AXOG PROGRAM STRUCTURE
!
!   Get the reference frequency for use in the phase delay rate corrections.
!    Convert from MHz to Hz.
!     Moved to GET_G ('REF FREQ'/REF_FREQ).
!
      If (C_mode .eq. 'difx  ') REF_FREQ = 1.D6
!
!    Loop through twice for the calculation of the axis offset vectors and
!    their time derivatives and the partial derivatives of the component of
!    the antenna axis offsets in the apparent direction of the source and the
!    time derivative of that component with respect to the antenna axis
!    offsets at each site.
!
      DO 800  L = 1,2
           LL = L
!
!  Check for geocenter station
      IF (L .eq. Nzero) Go to 750
!
!    Identify the unit vector representing the antenna fixed axis in a
!    topocentric reference system. The topocentric reference system sits on the
!    Earth's surface at the observation site with axes pointing 1) radially Up
!    (X-AXIS), 2) East (Y-axis), and 3) North (Z-axis).
!
!  Identify the antenna axis type in order to obtain the correct algorithm:
!
!    Equatorial mount - fixed axis points at the North Celestial Pole.
         If (KAXIS(L) .EQ. 1) Then
           TCAXIS(1) = DSIN ( SITLAT(L) )
           TCAXIS(2) = 0.D0
           TCAXIS(3) = DCOS ( SITLAT(L) )
           GO TO 310
         Endif
!
!    X-Y mount - antenna fixed axis points North-South. (i.e. the antenna fixed
!      axis is in the plane of the horizon pointed North-South.)
         If (KAXIS(L) .EQ. 2) Then
           TCAXIS(1) = 0.D0
           TCAXIS(2) = 0.D0
           TCAXIS(3) = 1.D0
           GO TO 310
         Endif
!
!    Alt-Az mount - the antenna fixed axis points at the zenith.
         If (KAXIS(L) .EQ. 3) Then
           TCAXIS(1) = 1.D0
           TCAXIS(2) = 0.D0
           TCAXIS(3) = 0.D0
           GO TO 310
         Endif
!
!    X-Y mount -  antenna fixed axis pointing East-West. (i.e. The antenna
!      fixed axis is in the plane of the horizon pointed East-West.)
         If (KAXIS(L) .EQ. 4) Then
           TCAXIS(1) = 0.D0
           TCAXIS(2) = 1.D0
           TCAXIS(3) = 0.D0
           GO TO 310
         Endif
!
!    Old Richmond antenna system - axes oriented as for an equatorial mount at
!      latitude +39.06 degrees and rotated 0.12 degrees West of North.
         If (KAXIS(L) .EQ. 5) Then
           ZC        =     DCOS(RICHM(1)*CONVD)
           TCAXIS(1) =     DSIN(RICHM(1)*CONVD)
           TCAXIS(2) = -ZC*DSIN(RICHM(2)*CONVD)
           TCAXIS(3) =  ZC*DCOS(RICHM(2)*CONVD)
           GO TO 310
         Endif
!
!    Antenna axis type invalid, a message is written and the program stops.
         IF ((KAXIS(L) .le. 0 ) .OR. (KAXIS(L) .gt. 5)) Then
           WRITE (6, 9300)  LL, KAXIS(LL)
           CALL TERMINATE_CALC ('AXOG  ',int2(0),int2(0))
         Endif
 9300 FORMAT (1X, "THE PROGRAM HAS TERMINATED IN SUBROUTINE AXOG.  ", &
     &            'KAXIS (', I2, ') = ', I2, '.' )
!
  310    Continue
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!         write(6,'("AXOG: L, TCAXIS ",I2,3F10.5)')  L, TCAXIS
!
!   Rotate the fixed axis by the tilt amount.
      CALL VECRT (ROTAXIS(1,1,L), TCAXIS, TCAXnew)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!         write(6,*) 'ROTAXIS: ', ROTAXIS(1,1,L), ROTAXIS(1,2,L), ROTAXIS(1,3,L)
!         write(6,*) 'ROTAXIS: ', ROTAXIS(2,1,L), ROTAXIS(2,2,L), ROTAXIS(2,3,L)
!         write(6,*) 'ROTAXIS: ', ROTAXIS(3,1,L), ROTAXIS(3,2,L), ROTAXIS(3,3,L)
!         write(6,*) ' TCAXnew ',  TCAXnew 
!
!   Replace fixed axis with tilt-corrected fixed-axis.
       Do kx = 1, 3
        TCAXold(kx) = TCAXIS(kx)
        TCAXIS(kx) = TCAXnew(kx)
!       Axdiff(kx) = TCAXnew(kx) - TCAXold(kx)
       Enddo
!
! 310    Continue
!******************************************************************************
!    Rotate the J2000.0 source unit vector to the topocentric reference system.
!
!        Compute the rotation matrix which rotates from the geocentric crust
!        fixed reference system to the topocentric reference system.
           CALL MTRAN ( TCTOCF(1,1,L), CFTOTC )
!
!        Compute the rotation matrix which rotates from the J2000.0
!        reference system to the geocentric crust fixed system.
           CALL MTRAN ( R2K(1,1,1), TR2K(1,1,1) )
!
!        Rotate the aberrated J2000.0 source unit vector to the crust fixed
!        system and then to the topocentric system.
           CALL VECRT ( TR2K(1,1,1),STAR_ABERRATED(1,L),CFSTAR(1,1))
           CALL VECRT ( CFTOTC, CFSTAR(1,1), TCSTAR(1,1) )
!
!         write(6,*) '              '  
!         write(6,*) 'AXOG: TCSTAR  ',  TCSTAR  
!*****************************************************************************
!    Correct the aberrated topocentric source unit vector for atmospheric
!    refraction.
!
!   Compute the zenith angle of the aberrated source.
        ZEN =  HALFPI - ELEV(L,1)
         ZENdt = -ELEV(L,2)
!   Compute the azimuth of the aberrated source.
        AZMUTH = AZ(L,1)
         AZMUTHdt = AZ(L,2)
!   Compute values needed for function sbend.
        El_Rad = ELEV(L,1)
         Eldt  = ELEV(L,2)
        Sithit = Sitheight(L)
        Temp_K = 293.15 - (6.5D-3)*sithit
        X = 1.D0 - (6.5D-3)*sithit/293.15D0
        Press_Hg = 760.D0 * (X**5.26D0)
        Humid_F = .5D0
!   Compute atmospheric bending.
!       zencor = sbend(El_rad,Temp_K,Humid_F,Press_Hg)
!         Write(6,*) ' Zencor  ',  Zencor  
       CALL SBEND1 (El_rad, Eldt, Temp_K, Humid_F, Press_Hg,       &
     &                   Zencor, Zencordt)
!         Write(6,*) ' Zencor,Zencordt ', Zencor,Zencordt
! *************************************************************************
!    Compute the corrected (aberrated/refracted) topocentric star unit
!    vector. (NOTE: This corrects the vector so that it is pointing nearer
!    to the zenith).
!!!! Before refraction correction:
!       CTCSTR(1) = DCOS ( ZEN )
!       CTCSTR(2) = DSIN ( ZEN ) * DSIN ( AZMUTH )
!       CTCSTR(3) = DSIN ( ZEN ) * DCOS ( AZMUTH )
!       write(6,*) 'CTCSTR(no refraction) ',  CTCSTR  
!
        CTCSTR(1) = DCOS ( ZEN - ZENCOR )
        CTCSTR(2) = DSIN ( ZEN - ZENCOR ) * DSIN ( AZMUTH )
        CTCSTR(3) = DSIN ( ZEN - ZENCOR ) * DCOS ( AZMUTH )
! Time derivative of CTCSTR
        CTCSTRdt(1) = -DSIN(ZEN-ZENCOR) * (ZENdt-ZENCORdt)
        CTCSTRdt(2) =  DCOS(ZEN-ZENCOR)*(ZENdt-ZENCORdt)*DSIN(AZMUTH)   &
     &               + DSIN(ZEN-ZENCOR) * DCOS(AZMUTH) * AZMUTHdt
        CTCSTRdt(3) =  DCOS(ZEN-ZENCOR)*(ZENdt-ZENCORdt)*DCOS (AZMUTH)  &
     &               - DSIN(ZEN-ZENCOR) * DSIN(AZMUTH) * AZMUTHdt

!         Write(6,*) 'CTCSTR (+ refraction) ',  CTCSTR  
!         Write(6,*) 'CTCSTRdt (+ refraction) ',  CTCSTRdt
!       Make sure we still have a unit vector
          Amag = VECMG(CTCSTR)
          do kx = 1,3
           CTCSTR(kx) = CTCSTR(kx)/Amag
           CTCSTRdt(kx) = CTCSTRdt(kx)/Amag
          enddo
!         Write(6,*) ' Amag    ',  Amag    
!         Write(6,*) 'AXOG: CTCSTR(unit) ',  CTCSTR
!         Write(6,*) 'AXOG: CTCSTRdt(unit) ',  CTCSTRdt
!
!     Compute the CT time derivative of the aberrated source unit vector
!      in the topocentric reference system.
!    ---Obsolete-----
            CALL MTRAN ( R2K(1,1,2), TR2K(1,1,2) )
            CALL VECRT ( TR2K(1,1,2),STAR_ABERRATED(1,L),CFST1)
            CALL VECRT ( TR2K(1,1,1),STAR_ABERRATEDdt(1,L),CFST2)
            CALL VECAD ( CFST1, CFST2, CFSTAR(1,2) )
            CALL VECRT ( CFTOTC, CFSTAR(1,2), TCSTAR(1,2) )
!         Write(6,*) 'AXOG: CFSTAR  ',  CFSTAR  
!         Write(6,*) 'AXOG: TCSTAR  ',  TCSTAR  
!
! .............................................................................
!   Code for computing the three dimensional components of the axis offset
!    vector.  D. Gordon 93MAY13 thru 93JUL27
!
!  Compute topocentric axis offset vector (change in effective site position
!   due to axis offset orientation) and its time derivative:
!
!   DELAY COMPUTATION:
!    Take triple vector product to get direction of axis offset vector:
        call crosp(TCAXIS,CTCSTR,vectr)
        call crosp(vectr,TCAXIS,vec1)
!         write(6,*) ' vectr   ',  vectr   
!         write(6,*) ' vec1    ',  vec1    
!    Compute magnitude of vector so we can normalize it
       absvec1 = vecmg(vec1)
!         write(6,*) ' absvec1 ',  absvec1 
!    Normalize to get topocentric unit axis offset vector
       do kx=1,3
        axistc(kx,L) = vec1(kx) / absvec1
       enddo
!
!    Rotate axis offset vector to the crust fixed frame
        call vecrt(TCTOCF(1,1,L),axistc(1,L),axiscf(1,L))
!    Then rotate axis offset vector to the J2000 frame
        call vecrt(R2K(1,1,1),axiscf(1,L),uaxis2000(1,L))
!
!!????? Obsolete ????????????????????????????????????????????
!   Derivative of CTCSTR: (aberrated/refracted topocentric source unit vector)
!     Rotate atmosphere corrected aberrated source unit vector to the
!     crust fixed frame:
        call vecrt(TCTOCF(1,1,L),CTCSTR,ccfstr)
!    Then rotate to the J2000 frame:
        call vecrt(R2K(1,1,1),ccfstr,c2000str)
!
!    Take time derivative and rotate back to crust fixed frame
        call vecrt(TR2K(1,1,2),c2000str,dccfstr)
!
!    Rotate source vector time derivative back to topocentric frame
        call vecrt(CFTOTC,dccfstr,dctcstr)
!         write(6,*) '         '             
!         write(6,*) 'L, dctcstr ', L, dctcstr 
!         write(6,*) '         '             
!
!*!   RATE COMPUTATION:
!*!    Take derivative of triple vector product (TCAXIS is a constant)
!*        call crosp(TCAXIS,dctcstr,vectr)
!*        call crosp(vectr,TCAXIS,dvec1)
!*!    Derivative of magnitude of vec1
!*        dabsvec1 = Dotp(vec1,dvec1) / absvec1
!*!    Compute derivative of unit axis offset vector in topocentric frame
!*       do kx=1,3
!*        daxistc(kx,L) = dvec1(kx)/absvec1 - &
!*     &   vec1(kx) * dabsvec1 / absvec1**2
!*       enddo
!*!
!*!    Rotate axis offset time derivative to crust fixed frame
!*        call vecrt(TCTOCF(1,1,L),daxistc(1,L),daxiscf(1,L))
!*!
!*!    Then rotate to J2000 frame:
!*        call vecrt(R2K(1,1,1),daxiscf(1,L),vec2)
!*        call vecrt(R2K(1,1,2), axiscf(1,L),vec3)
!*        call vecad(vec2,vec3,duaxis2000(1,L))
!*!
!*!   Convert unit axis offset vector and its derivative to actual axis offset
!*!     vector and its derivative.
!*       do kx=1,3
!*         axis2000(kx,L) =  uaxis2000(kx,L) * AXOFF(L)
!*        daxis2000(kx,L) = duaxis2000(kx,L) * AXOFF(L)
!*       enddo
!*       Write(6,*) 'L,axis2000 ', L,axis2000(1,L),axis2000(2,L),axis2000(3,L)
!*       Write(6,*) 'L,daxis2000 ', L,daxis2000(1,L),daxis2000(2,L),daxis2000(3,L)
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! New rate computation. Should work for far-field and near-field cases.
!    Take derivative of triple vector product (TCAXIS is a constant)
        call crosp(TCAXIS,CTCSTRdt,vectr)
        call crosp(vectr,TCAXIS,dvec1)
!    Derivative of magnitude of vec1
        dabsvec1 = Dotp(vec1,dvec1) / absvec1
!    Compute derivative of unit axis offset vector in topocentric frame
       do kx=1,3
        daxistc(kx,L) = dvec1(kx)/absvec1 - &
     &   vec1(kx) * dabsvec1 / absvec1**2
       enddo
!
!    Rotate axis offset time derivative to crust fixed frame
        call vecrt(TCTOCF(1,1,L),daxistc(1,L),daxiscf(1,L))
!
!    Then rotate to J2000 frame:
        call vecrt(R2K(1,1,1),daxiscf(1,L),vec2)
        call vecrt(R2K(1,1,2), axiscf(1,L),vec3)
        call vecad(vec2,vec3,duaxis2000(1,L))
!
!   Convert unit axis offset vector and its derivative to actual axis offset
!     vector and its derivative.
       do kx=1,3
         axis2000(kx,L) =  uaxis2000(kx,L) * AXOFF(L)
        daxis2000(kx,L) = duaxis2000(kx,L) * AXOFF(L)
       enddo
!      Write(6,*) 'L,axis2000 ', L,axis2000(1,L),axis2000(2,L),axis2000(3,L)
!      Write(6,*) ' Revised axis offset rate computation: '
!      Write(6,*) 'L,daxis2000 ', L,daxis2000(1,L),daxis2000(2,L),daxis2000(3,L)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Compute offset without axis tilt correction and rotate to J2000.
!  Then compute partial component.
        call crosp(TCAXold,CTCSTR,vectr)
        call crosp(vectr,TCAXold,vec1d)
        absvecd = vecmg(vec1d)
       do kx=1,3
        axistcd(kx,L) = vec1d(kx) / absvecd
       enddo
        call vecrt(TCTOCF(1,1,L),axistcd(1,L),axiscfd(1,L))
        call vecrt(R2K(1,1,1),axiscfd(1,L),uaxisd2k(1,L))
!  Use the Consensus model definition
        DO I =1,3
          VG(I) = EARTH(I,2) + SITEV(I,2)
          VE(I) = EARTH(I,2)
        Enddo
!
         TT = 1.d0 + DOTP(STAR,VG)/VLIGHT
        Tpartl(L) = Dotp(uaxisd2k(1,L),STAR)/TT + &
     &              Dotp(uaxis2000(1,L),VE)/VLIGHT
!
!        print *,' Tpartl/new ', Tpartl(L)
!       Tpartl(L) = Dotp(c2000str,uaxisd2k(1,L))
!        print *,' Tpartl/old ', Tpartl(L)
!        print *,' vec1d    ', vec1d
!        print *,' axistcd  ', axistcd(1,L), axistcd(2,L),
!    *                        axistcd(3,L)
!        print *,' axiscfd  ', axiscfd(1,L), axiscfd(2,L),
!    *                        axiscfd(3,L)
!        print *,' uaxisd2k ', uaxisd2k(1,L), uaxisd2k(2,L),
!    *                        uaxisd2k(3,L)
!        print *,' uaxis2000 ', uaxis2000(1,L), uaxis2000(2,L),
!    *                        uaxis2000(3,L)
!
! .............................................................................
!
!          Now do feedbox rotation computations
!
        IF(KPANC.EQ.1) THEN
          PANGL(L)      = 0.0D0
          FEED_COR(L,1) = 0.0D0
          FEED_COR(L,2) = 0.0D0
          GO TO 156
         ENDIF
!
!  Define vector TNCP(3), a unit vector in the direction of the North
!   Celestial pole.
           TNCP(1) = DSIN(SITLAT(L))
           TNCP(2) = 0.D0
           TNCP(3) = DCOS(SITLAT(L))
!
        ZA = ZEN - ZENCOR
        DZA = -ELEV(L,2)
        DAZM = AZ(l,2)
       If (KAXIS(L) .NE. 1) Then
        CALL FBOX (TNCP, TCAXIS, CTCSTR, AZMUTH, DAZM, ZA, DZA, &
     &            Rangl, dRangl)
!        print *, ' L, Rangl, dRangl: ', L, Rangl, dRangl
       Else
!           Equatorial Mount, no feedbox rotation
        Rangl = 0.0D0
        dRangl = 0.0D0
       Endif
!
!  Convert the feedbox rotation angle to degrees for this site.
       PANGL(L) = RANGL/CONVD
!  Compute the feedbox rotation corrections for group delay and phase delay
!   rate for this site. The units are seconds and sec/sec.
       FEED_COR(L,1) = 0.D0
       FEED_COR(L,2) = DRANGL/TWOPI/REF_FREQ
!
!    To correct the phases, either ADD the quantity [PANGL(2) - PANGL(1)]
!     to the total or residual observed phases, or SUBTRACT it from the
!     theoretical (model) phases.
!    Note that the group delay corrections are always zero.
!    To correct the phase delay rates, either ADD the quantity
!     [FEED_COR(2,2) - FEEDCOR(1,2)] to the observed rates, or SUBTRACT
!     it from the theoretical (model) rates.
!
 156   CONTINUE
!******************************************************************************
!     See if debug is needed.
      IF ( KAXOD .ne. 0 )  Then
!
      If (L.eq.1) then
        WRITE ( 6, 9100 )
      endif
!
      If (L.eq.2) then
        WRITE ( 6, 9101 )
        WRITE ( 6, 9200 ) KAXIS, R2K, SITLAT, STAR, TCTOCF
        WRITE(6,8)' TR2K    ', TR2K
        WRITE(6,8)' STAR_ABERRATED ', STAR_ABERRATED
        WRITE(6,8)' AXOFF   ', AXOFF
        WRITE(6,8)' PANGL ', PANGL
        WRITE(6,8)' FEED_COR  ', FEED_COR
      endif
!
 9100 FORMAT (20X, "Debug output for subroutine AXOG." )
 9200   FORMAT (1X, "KAXIS  = ", 2 ( I2, 10X ), /, 1X, &
     &   "R2K    = ", 9 ( 3 ( D30.16, 10X ), /, 1X ), /, 1X, &
     &   "SITLAT = ", 2 ( D30.16, 10X ), /, 1X, &
     &   "STAR   = ", 3 ( D30.16, 4X ), /, 1X, &
     &   "TCTOCF = ", 6 ( 3 ( D30.16, 10X ), /, 1X ) )
 9101 FORMAT (1X, "Dump for both stations:          " )
    8 FORMAT(A,3D25.16,/,5(7X,3D25.16))
!
      write(6,'(/,10x," ******** DUMP FOR SITE",i2," ******** ")') L
      WRITE(6,8)' TCAXIS  ',TCAXIS
      WRITE(6,8)' CFTOTC  ',CFTOTC
      WRITE(6,8)' CFSTAR  ',CFSTAR
      WRITE(6,8)' TCSTAR  ',TCSTAR
      WRITE(6,8)' ZEN     ',ZEN
      WRITE(6,8)' AZMUTH  ',AZMUTH
      WRITE(6,8)' ZENCOR  ',ZENCOR
      write(6,'("vec1:  ",3D23.14)') vec1
      write(6,'("dvec1: ",3D23.14)') dvec1
      write(6,'("absvec1: ",3D23.14)') absvec1
      write(6,'("dabsvec1: ",3D23.14)') dabsvec1
      write(6,'("axistc:  ",3D23.14)') axistc(1,L),axistc(2,L) &
     &                                ,axistc(3,L)
      write(6,'("daxistc: ",3D23.14)') daxistc(1,L), daxistc(2,L), &
     &                                 daxistc(3,L)
      write(6,'("axiscf:  ",3D23.14)') axiscf(1,L),axiscf(2,L) &
     &                                ,axiscf(3,L)
      write(6,'("daxiscf: ",3D23.14)') daxiscf(1,L), daxiscf(2,L) &
     &                                ,daxiscf(3,L)
      write(6,'("c2000str:  ",3D23.14)') c2000str
      write(6,'("ccfstr:  ",3D23.14)') ccfstr
      write(6,'("dccfstr:  ",3D23.14)') dccfstr
      write(6,'("CTCSTR:  ",3D23.14)') CTCSTR
      write(6,'("dctcstr:  ",3D23.14)') dctcstr
      write(6,'("uaxis2000:",3D23.14)') uaxis2000(1,L),uaxis2000(2,L) &
     &                                ,uaxis2000(3,L)
      write(6,'("duaxis2000:",3D23.14)') duaxis2000(1,L),duaxis2000(2,L) &
     &                                 ,duaxis2000(3,L)
      write(6,'("axis2000:",3D23.14)') axis2000(1,L),axis2000(2,L) &
     &                                ,axis2000(3,L)
      write(6,'("daxis2000:",3D23.14)') daxis2000(1,L),daxis2000(2,L) &
     &                                 ,daxis2000(3,L)
      write(6,'("DCOMP:   ",2D23.14)') DCOMP(L,1),DCOMP(L,2)
!
      ENDIF
       Go to 800
!
  750 CONTINUE
!   Handling of geocenter station, set axis offset quantities to zero.
       do kx=1,3
         axis2000(kx,L) = 0.0D0
        daxis2000(kx,L) = 0.0D0
       enddo
        DCOMP(L,1) = 0.0D0
        DCOMP(L,2) = 0.0D0
!    Ditto for the feedbox rotation quantities.
       PANGL(L)      = 0.0D0
       FEED_COR(L,1) = 0.0D0
       FEED_COR(L,2) = 0.0D0
!
!     Close loop running over the observing sites.
  800 CONTINUE
!
!  PUT the feedbox rotation angles and delay/rate corrections in the database.
!       FCONT(1) = FEED_COR(1,1) - FEEDCOR(2,1)
        FCONT(1) = 0.D0
        FCONT(2) = FEED_COR(1,2) - FEED_COR(2,2)
! PUT's of 'PARANGLE'/PANGL and 'FEED.COR'/FCONT moved to PUT_G. 
!
!**   IF ( KAXOD .ne. 0 )  Then
!      WRITE(6,'(" KAXIS, PANGL ",2I3,2F10.2)')  KAXIS, PANGL
!      WRITE(6,'(" FEED_COR ",4D20.10)')  FEED_COR
!      WRITE(6,'(" FCONT    ",2D20.10)')  FEED_COR
!**   ENDIF
!
!     Normal conclusion.
      RETURN
      END
!**************************************************************************
      SUBROUTINE AXOP (AXOFF, STAR12, EARTH, SITEV)
      IMPLICIT None
!
! 5.    AXOP
!
! 5.1   AXOP PROGRAM SPECIFICATION
!
! 5.1.1 AXOP is the partial derivatives section of the axis offset
!       module. AXOP computes the partial derivatives of the delay
!       and rate with respect to the antenna axis offsets at the sites.
!
! 5.2   AXOP PROGRAM INTERFACE
!
! 5.2.1 CALLING SEQUENCE -
!       INPUT VARIABLES:
!          1. AXOFF(2)   - THE ANTENNA AXIS OFFSETS AT EACH SITE. (M)
!          2. STAR12(3,2) -The J2000.0 source unit vectors from stations
!                          1 and 2. (unitless). For Far-field sources,
!                          these are the same as STAR(3).
!          3. EARTH(3,3) - THE SSBC EARTH POSITION, VELOCITY, AND
!                          ACCELERATION VECTORS. (M, M/SEC, M/SEC**2)
!          4. SITEV(3,2) - THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF
!                          EACH OBSERVATION SITE. (M/SEC)
!
      Real*8 AXOFF(2), STAR12(3,2), EARTH(3,3), SITEV(3,2)
      Real*8 DOTP, VG(3), VE(3), C1, C2, TT
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!         VARIABLES 'FROM':
!            1.  VLIGHT - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!
      Real*8  DAXOP(2,2), DCOMP(2,2), RICHM(2),                         &
     &        Tpartl(2), uaxis2000(3,2), duaxis2000(3,2)
      COMMON / AXOCM / DAXOP, DCOMP, RICHM,                             &
     &                 Tpartl, uaxis2000, duaxis2000
!         VARIABLES 'FROM':
!            1. DCOMP(2,2) - THE PARTIAL DERIVATIVES OF THE COMPONENT OF
!                            THE ANTENNA AXIS OFFSET IN THE APPARENT
!                            DIRECTION OF THE SOURCE AND THE CT TIME
!                            DERIVATIVE OF THAT COMPONENT WITH RESPECT TO
!                            THE ANTENNA AXIS OFFSETS AT EACH SITE. THE
!                            FIRST INDEX RUNS OVER THE OBSERVATION SITES
!                            AND THE SECOND INDEX RUNS OVER THE DELAY AND
!                            THE DELAY RATE. (UNITLESS, 1/SEC)
!         VARIABLES 'TO':
!            1. DAXOP(2,2) - THE PARTIAL DERIVATIVES OF THE DELAY AND THE
!                            DELAY RATE WITH RESPECT TO THE ANTENNA AXIS
!                            OFFSETS AT EACH SITE (old model). FIRST INDEX
!                            RUNS OVER THE OBSERVATION SITES AND THE
!                            SECOND RUNS OVER THE DELAY AND DELAY RATE.
!                            (SEC/M, SEC/SEC-M)
!
      INCLUDE 'ccon.i'
!         VARIABLES 'FROM':
!            1. KAXOC  -  THE AXIS OFFSET MODULE FLOW CONTROL FLAG.
!            2. KAXOD  -  THE AXIS OFFSET MODULE DEBUG OUTPUT FLAG.
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
! 5.2.4 DATA BASE ACCESS - Moved to PUT_P ('AXO PART'/DAXOP).
!
! 5.2.6 SUBROUTINE INTERFACE -
!          CALLER SUBROUTINES: DRIVP
!          CALLED SUBROUTINES: PUT4
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES
      Integer*4 K, L
!
! 5.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!                    PETER DENATALE 07/11/77
!                    BRUCE SCHUPLER 03/07/78
!                    Jim Ryan 89.06.29 Character stings used.
!                    Jim Ryan 89.10.05 CPHYS common now an include file.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                    implimented.
!                    D. Gordon 94.03.25 Old partials multiplied by index of
!                              refraction and PUT into database (new, simple
!                              axis offset model). Added complete partials for
!                              more complex (3 terms) axis offset model.
!                    D. Gordon 94.08.03 Corrected old axis multiplication by
!                              N_air(site #). Was incorrrectly multiplying both
!                              delays by site 1 and both rates by site 2
!                              indices of refraction.
!                    Jim Ryan 02.Sept Integer*2/4 updates.
!                    D. Gordon 2004 October. Corrections to partials.
!                    D. Gordon Jan. 2013. Changed STAR(3) to STAR12(3,2) to
!                              enable near-field model computations. Moved 
!                              all PUT's to subroutine G_PUT.
!
! 5.3   AXOP PROGRAM STRUCTURE
!
!    Compute the partial derivatives of the delay and the delay rate with
!    respect to the axis offset at each site. First two terms in the
!    relativity model included.
!
      Do K = 1,3
        VE(K) = EARTH(K,2)
        VG(K) = EARTH(K,2) + SITEV(K,2)
      Enddo
!**   TT = 1.D0 + DOTP(Star,VG)/VLIGHT
!
!   Delay and rate partials for L'th station
       Do L = 1,2
         TT = 1.D0 + DOTP(Star12(1,L),VG)/VLIGHT
        DCOMP(L,1) = DOTP(uaxis2000(1,L),STAR12(1,L))/TT +              &
     &                  DOTP(uaxis2000(1,L),VE)/VLIGHT
        DCOMP(L,2) = DOTP(duaxis2000(1,L),STAR12(1,L))/TT +             &
     &                  DOTP(duaxis2000(1,L),VE)/VLIGHT
       Enddo
!
!   Axis offset partial compution
!    The minus sign appears due to the definition of the
!    baseline vector being the site#1 vector minus the site#2 vector.
      DO   K = 1,2                       ! looping over delay and rate
           DAXOP(1,K) = + DCOMP(1,K) / VLIGHT      ! site 1
           DAXOP(2,K) = - DCOMP(2,K) / VLIGHT      ! site 2
      ENDDO
!
!   See if debug is neccessary.
      IF (KAXOD .ne. 0) Then
       WRITE ( 6, 9100 )
 9100  FORMAT (1X, "Debug output for subroutine AXOP." )
   8   FORMAT(A,5D25.16/(9X,5D25.16))
       WRITE(6,8)' AXOFF      ', AXOFF
       WRITE(6,8)' DCOMP      ', DCOMP
       WRITE(6,8)' DAXOP      ', DAXOP
!      WRITE(6,8)' VE         ', VE
!      WRITE(6,8)' VG         ', VG
!      WRITE(6,8)' TT         ', TT
!      WRITE(6,8)' VLIGHT     ', VLIGHT
!      WRITE(6,8)' STAR12     ', STAR12
      Endif
!
      RETURN
      END
!**************************************************************************
      SUBROUTINE AXOC (AXOFF )
      IMPLICIT None
!
! 6.    AXOC
!
! 6.1   AXOC PROGRAM SPECIFICATION
!
! 6.1.1 AXOC is the contributions section of the axis offset module. It
!       computes the contributions to the delay and rate due to the antenna
!       axis offsets at each site.
!
! 6.2   AXOC PROGRAM INTERFACE
!
! 6.2.1 CALLING SEQUENCE -
!          INPUT VARIABLES:
!             1. AXOFF(2)  -  THE ANTENNA AXIS OFFSETS AT EACH SITE. (M)
!
! 6.2.2 COMMON BLOCKS USED -
!
      Real*8  DAXOP(2,2), DCOMP(2,2), RICHM(2),                         &
     &        Tpartl(2), uaxis2000(3,2), duaxis2000(3,2)
      COMMON / AXOCM / DAXOP, DCOMP, RICHM,                             &
     &                 Tpartl, uaxis2000, duaxis2000
!          VARIABLES 'FROM':
!            1. DAXOP(2,2)    -  THE PARTIAL DERIVATIVES OF THE DELAY AND THE
!                                DELAY RATE WITH RESPECT TO THE ANTENNA AXIS
!                                OFFSETS AT EACH SITE. THE FIRST INDEX RUNS
!                                OVER THE OBSERVATION SITES AND THE SECOND RUNS
!                                OVER THE DELAY AND THE DELAY RATE. (Old model)
!                                (SEC/M, SEC/SEC-M)
!
       INCLUDE 'ccon.i'
!         VARIABLES 'FROM':
!            1. KAXOC - THE AXIS OFFSET MODULE FLOW CONTROL FLAG.
!            2. KAXOD - THE AXIS OFFSET MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cphys11.i'
!         VARIABLES 'FROM':
!            1. VLIGHT - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!
     INCLUDE 'put2s.i'
!       Variables to:
!          1. DAXOC(2,2) - THE CONTRIBUTIONS TO THE DELAY AND TO THE DELAY
!                          RATE DUE TO ANTENNA AXIS OFFSETS AT EACH SITE.
!                          THE FIRST INDEX RUNS OVER THE OBSERVATION SITES
!                          AND THE SECOND RUNS OVER THE DELAY AND THE DELAY
!                          RATE. (SEC, SEC/SEC)
!          2. Tcorrmv(2) - Contribution to undue the fixed axis tilt correction
!                          (sec, sec/sec).
!
! 6.2.3 PROGRAM SPECIFICATIONS -
      Real*8  AXOFF(2)
      Real*8  Taxoc(2), DAXOC_old(2)
      Integer*4 K, L
!
! 6.2.4 DATA BASE ACCESS => PUT ('AXO CONT'/DAXOC and 'TILTRMVR'/Tcorrmv)
!                           moved to PUT_C.
!
! 6.2.6 SUBROUTINE INTERFACE -
!          CALLER SUBROUTINES: DRIVC
!          CALLED SUBROUTINES: 
!
! 6.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!                    PETER DENATALE 07/11/77
!                    BRUCE SCHUPLER 03/07/78
!                    Jim Ryan 89.06.29 Character stings used.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                    implimented.
!                    D. Gordon 94.03.25 Added computations for both new versions
!                              of the axis offset contributions. Made the
!                              simpler version the default (will be added to
!                              theoreticals in THERY). Computing corrections
!                              to convert to alternate new model and to old
!                              model ('on-the-fly' in SOLVE), and PUTting them
!                              into the database.
!                    D. Gordon 94.05.23 Changed $Include to Include.
!                    D. Gordon 94.08.04 Error corrected. Old axis offset was
!                              still the default. Corrected to make new/simple
!                              offset the default. Added variable DAXOC_old.
!                    D. Gordon 98.11.12 Removed PUT of old axis offset
!                              differential contribution.
!                    Jim Ryan 02.Sept Integer*2/4 updates.
!                    D. Gordon 2004.05.19 Tilt removing contribution added.
!                    D. Gordon 2004 October. Corrections to contributions.
!                    D. Gordon Jan. 2013  Moved PUT's into subroutine PUT_C.
!
! 6.3   AXOC PROGRAM STRUCTURE
!
!     Compute the axis offset contributions.
!      [L => site; K => delay and rate]
      DO 120  K = 1,2
           DO 110  L = 1,2
             DAXOC(L,K) = DAXOP(L,K) * AXOFF(L)
  110      CONTINUE
  120 CONTINUE
!
!     Check to determine if the axis offset module is to be turned off.
      IF (KAXOC .eq. 1) Then
       DO 320  K = 1,2
           DO 310  L = 1,2
                DAXOC(L,K) = 0.D0
  310      CONTINUE
  320  CONTINUE
      Endif
!
!   Compute small correction to remove the tilt effect
!    (Relativity terms omitted)
        Daxoc_old(1) =  Tpartl(1)*AXOFF(1)/VLIGHT
        Daxoc_old(2) = -Tpartl(2)*AXOFF(2)/VLIGHT
!
        Taxoc(1) = Daxoc_old(1) - DAXOC(1,1)
        Taxoc(2) = Daxoc_old(2) - DAXOC(2,1)
         Tcorrmv(1) = Taxoc(1) + Taxoc(2)
         Tcorrmv(2) = 0.D0
!
!     Check for debug output.
      IF (KAXOD .ne. 0)  Then
       WRITE ( 6, 9100 )
 9100  FORMAT (1X, "Debug output for subroutine AXOC." )
    8  FORMAT(A,5D25.16/(9X,5D25.16))
       WRITE(6,8)' AXOFF       ', AXOFF
       WRITE(6,8)' DAXOP       ', DAXOP
       WRITE(6,8)' DAXOC       ', DAXOC
!      WRITE(6,8)' DAXOC_OLD   ', DAXOC_OLD
!      WRITE(6,8)' Taxoc (ps)  ', Taxoc(1)*1.E12,Taxoc(2)*1.E12
!      WRITE(6,8)' Tcorrmv     ', Tcorrmv
      Endif
!
  600 RETURN
      END
!**************************************************************************
      DOUBLE PRECISION FUNCTION SBEND(El_rad,Temp_K,Humid_F,Press_Hg)
      IMPLICIT None
!
! Input:
!   El_rad   -- elevation angle in radians
!   Press_Hg -- Pressure in mm of Mercury (Hg)
!   Temp_K   -- Temperature in Kelvins
!   Humid_F  -- relative humidity (percent)
!
! output   --
!   Sbend  -- bending angle in radians.
!
      Real*8 El_rad, Temp_K, Humid_F, Press_Hg
      Real*8 e(12),wp1(4),d3
      Real*8 fp,ft,fw,u,x,ad1,ad2,bd1,bd2,zd2,r,delta
      Real*8 a1,a2,b1,b2,c1,c2,e1,e2,e3,e4,e5,e6,e7,e8,e9
      Real*8 e10,e11,e12,p1,p2,t1,t2,z1,z2,w0,w1,w2,w3
      Real*8 conv
      Integer*4 I
!
      equivalence (e( 1), e1),(e( 2), e2),(e( 3), e3),(e( 4), e4), &
     &            (e( 5), e5),(e( 6), e6),(e( 7), e7),(e( 8), e8), &
     &            (e( 9), e9),(e(10),e10),(e(11),e11),(e(12),e12)
      equivalence (wp1(1),w0),(wp1(2),w1),(wp1(3),w2),(wp1(4),w3)
!
      data a1, a2 /     0.40816d0, 112.30d0  /
      data b1, b2 /     0.12820d0, 142.88d0  /
      data c1, c2 /     0.80000d0,  99.344d0 /
      data e   /    46.625d0  ,  45.375d0 ,     4.1572d0,  1.4468d0  , &
     &               0.25391d0,   2.2716d0,    -1.3465d0, -4.3877d0  , &
     &               3.1484d0 ,   4.5201d0,    -1.8982d0,  0.89000d0 /
      data p1 /   760.0d0 /
      data t1 /   273.0d0 /
      data wp1 / 22000.0d0    ,  17.149d0 ,  4684.1d0,    38.450d0   /
      data z1 /  91.870d0 /
      data conv/57.295779512d0/
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           VARIABLES 'FROM':
!              1. HALFPI - THE VALUE OF PI/2
!              2. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS
!                          (RAD/DEG)
!
! STATEMENT FUCNTION
      delta(ad1,ad2,bd1,bd2,zd2)=(ad2-ad1)*dexp(bd1*(zd2-bd2))
!
! CONVERT UNITS
!  Zenith angle in degrees
      z2 = 90.0d0 - El_Rad/CONVD
!  Temperature in Kelvins
      t2 = Temp_K
!  Fractional humidity (0.0 -> 1.0)
      r = Humid_F
!  Pressure in mm of Hg
      p2 = Press_Hg
!
!      WRITE(6,9956) R,T2,P2,Z2                                          DEBUG
!9956  FORMAT(" R,T2,P2,Z2",4F10.4)                                      DEBUG
!
! CALCULATE CORRECTIONS FOR PRES, TEMP, AND WETNESS
!      WRITE(6,9980) Z1,Z2,C1,C2                                         DEBUG
!9980  FORMAT(" Z1,Z2,C1,C2",4D15.6)                                     DEBUG
      d3=1.0d0+delta(z1,z2,c1,c2,z2)
      fp=(p2/p1)*(1.0d0-delta(p1,p2,a1,a2,z2)/d3)
      ft=(t1/t2)*(1.0d0-delta(t1,t2,b1,b2,z2)/d3)
      fw=1.0d0+(w0*r*dexp((w1*t2-w2)/(t2-w3))/(t2*p2))
!      WRITE(6,9957) D3,FP,FT,FW                                         DEBUG
!9957  FORMAT(" D3,FP,FT,FW ",4D12.6)                                    DEBUG
!
!  CALCULATE OPTICAL REFRACTION
      u=(z2-e1)/e2
      x=e11
      do 10 i=1,8
        x=e(11-i)+u*x
10    continue
!
!  COMBINE FACTORS AND FINISH OPTICAL FACTOR
      sbend=ft*fp*fw*(dexp(x/d3)-e12)
!      WRITE(6,9958) SBEND,X,U                                           DEBUG
!9958  FORMAT(" SBEND,X,U ",3D20.10)                                     DEBUG
!
! BACK TO RADIANS FROM ARC SECONDS
      sbend=(sbend/3600.0d0)*CONVD
!      WRITE(6,9959) SBEND                                               DEBUG
!9959  FORMAT(" SBEND (RADIANS) ",D20.10)                                DEBUG
      return
      end
!**************************************************************************
      SUBROUTINE FBOX ( TNCP, TCAXIS, CTCSTR, AZ, DAZ, ZA, DZA, &
     &            RANGL, DRANGL )
      IMPLICIT NONE
!
!     FBOX computes the feedbox rotation angle, relative to the source.
!     It computes the angle, looking up at the sky and measured at the
!     source, between the North Celestial Pole and the antenna fixed axis.
!     An increase in the feedbox rotation angle means a clockwise
!     rotation of the feedbox, for an observer looking up at the sky.
!     The angle itself is arbitrary. The important quantity is the
!     difference in the feedbox rotations at the two antennas, and how it
!     changes from one observation to the next.
!
!     It's not clear what to do with these angles in all case. For RCP data
!     in geodesy, we correct the phase by adding the remote station
!     correction and subtracting the reference station correction.
!
!     The algorithm makes two coordinate rotations to put the star vector
!     along the X-axis. The azimuths of the NCP and the fixed axis in the
!     transformed Y-Z plane are then easily found and differenced.
!
!     This subroutine replaces subroutine PANG in Calc 9.0, and will handle
!     all azis types.
!
!     Input Variables:
!         1) CTCSTR(3)  - Topocentric unit vector in the direction of the
!                         source. [X = Up = COS(Zenith Angle). Y = East =
!                         SIN(Zenith Angle) * SIN(Azimuth). Z = North =
!                         SIN(Zenith Angle) * COS(Azimuth). For greatest
!                         accuracy, the effects of atmospheric refraction
!                         and aberration should be included.]
!         2) TCAXIS(3)  - Topocentric unit vector in the direction of the
!                         antenna's fixed axis. [Altazimuth: X = 1.0,
!                         Y = 0.0, Z = 0.0.  X/Y North (Gilcreek):
!                         X = 0., Y = 0., Z = 1.0.  X/Y East (HARTRAO):
!                         X = 0., Y = 1.0., Z = 0.]
!         3) TNCP(3)    - Topocentric unit vector in the direction of the
!                         North Celestial Pole. [X = SIN(Geodetic Latitude),
!                         Y = 0.0, Z = COS(Geodetic Latitude)]
!         4) AZ         - Azimuth angle of source, in radians.
!         5) DAZ        - Time derivative of Azimuth angle. (radians/sec)
!                         Zeros can be used here if the user does not care
!                         about the rate of change of the rotation angle, or
!                         about the correction to the phase delay rate.
!         6) ZA         - Zenith angle of source, in radians. Include
!                         refraction and aberration for greatest accuracy.
!         7) DZA        - Time derivative of zenith angle. (radians/sec)
!                         Zeros can be used here if the user does not care
!                         about the rate of change of the rotation angle, or
!                         about the correction to the phase delay rate.
!     Output Variables:
!         1) RANGL      - The clockwise rotation angle of the feedbox. (rad)
!         2) DRANGL     - The time derivative of RANGL. (rad/sec)
!
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           VARIABLES 'FROM':
!              1. HALFPI - THE VALUE OF PI/2
!              2. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS
!                          (RAD/DEG)
!
!    Program History:
!       D. Gordon 98.11.10 Subroutine written at GSFC. Replaces subroutine
!                 PANG.
!
!
      Real*8 TNCP(3), TCAXIS(3), CTCSTR(3), AZ, DAZ, &
     &       ZA, DZA, Rangl, dRangl
      REAL*8 P1AZ(3,3), P2ZA(3,3), P12(3,3), DP1AZ(3,3), DP2ZA(3,3), &
     &       DP12(3,3), TT1(3,3), TT2(3,3)
      REAL*8 NCP1(3), AXIS1(3), STAR1(3), DNCP1(3), DAXIS1(3)
      REAL*8 AZNCP, AZAXIS, DAZNCP, DAZAXIS
!
!  Construct rotation matrix to rotate about the X-axis by the angle -AZ
!    and its derivative.
      CALL ROTAT ( -AZ, int2(1), P1AZ)
       CALL DROTT ( -AZ, -DAZ, int2(1), DP1AZ)
!  Construct rotation matrix to rotate about the Y-axis by the angle -ZA
!    and its derivative.
      CALL ROTAT ( -ZA, int2(2), P2ZA)
       CALL DROTT ( -ZA, -DZA, int2(2), DP2ZA)
!  Combine the above rotation matrices and the derivative.
      CALL MMUL2 (P2ZA, P1AZ, P12)
       CALL MMUL2 (DP2ZA, P1AZ,  TT1)
       CALL MMUL2 (P2ZA, DP1AZ,  TT2)
       CALL MADD2 (TT1,    TT2, DP12)
!  Rotate the three topocentric vectors and take derivatives of first two.
      CALL VECRT (P12,   TNCP,  NCP1)
      CALL VECRT (P12, TCAXIS, AXIS1)
      CALL VECRT (P12, CTCSTR, STAR1)
       CALL VECRT (DP12,   TNCP,  DNCP1)
       CALL VECRT (DP12, TCAXIS, DAXIS1)
!  The STAR1 vector should now be along the X-axis.
!       print *,' STAR1  ', STAR1
!
!  Find the azimuth angle of the NCP and its time derivative in the new frame
       AZNCP = -ATAN2(NCP1(3),NCP1(2)) + HALFPI
       IF (AZNCP .LT. 0.D0) AZNCP = AZNCP + TWOPI
        IF(DABS(NCP1(2)) .GT. 1.D-16) THEN
          dAZNCP = -1.D0/(1.D0+((NCP1(3)/NCP1(2))**2)) * &
     &      ( 1.D0/NCP1(2) * DNCP1(3) - NCP1(3)/NCP1(2)**2 * DNCP1(2) )
        ELSE
          dAZNCP = 0.D0
        ENDIF
!
!  Find the azimuth angle of the fixed axis and its time derivative
       AZAXIS = -ATAN2(AXIS1(3),AXIS1(2)) + HALFPI
       IF (AZAXIS .LT. 0.D0) AZAXIS = AZAXIS + TWOPI
        IF(DABS(AXIS1(2)) .GT. 1.D-16) THEN
          dAZAXIS = -1.D0/(1.D0+((AXIS1(3)/AXIS1(2))**2)) * &
     &      ( 1.D0/AXIS1(2) * DAXIS1(3) - AXIS1(3)/AXIS1(2)**2 * &
     &                                           DAXIS1(2) )
        ELSE
          dAZAXIS = 0.D0
        ENDIF
!  Take difference (NCP to AXIS) and express as a clock-wise rotation, as
!   seen from the ground looking up
       RANGL = AZNCP - AZAXIS
        DRANGL = DAZNCP - DAZAXIS
        IF (RANGL .LT. -PI) RANGL = RANGL + PI
        IF (RANGL .GT.  PI) RANGL = RANGL - PI
!
!  That's all!
      RETURN
      END
!
!**************************************************************************
      SUBROUTINE SBEND1 (El_rad, Eldt, Temp_K, Humid_F, Press_Hg,       &
     &                   Zencor, Zencordt)
      IMPLICIT None
!
! Input:
!   El_rad   -- Elevation angle (radians).
!   Eldt     -- Time derivative of elevation angle (radians).
!   Press_Hg -- Pressure in mm of Mercury (Hg)
!   Temp_K   -- Temperature in Kelvins
!   Humid_F  -- Relative humidity (percent)
!
! output   --
!   Sbend  -- bending angle in radians.
!
      Real*8 El_rad, Temp_K, Humid_F, Press_Hg, Eldt, Zencor, Zencordt
      Real*8 e(12),wp1(4),d3
      Real*8 fp,ft,fw,u,x,ad1,ad2,bd1,bd2,zd2,r,delta
      Real*8 a1,a2,b1,b2,c1,c2,e1,e2,e3,e4,e5,e6,e7,e8,e9
      Real*8 e10,e11,e12,p1,p2,t1,t2,z1,z2,w0,w1,w2,w3
      Real*8 conv
      Real*8 z2dt, t2dt, p2dt, d3dt, rdt, z2a, z2adt, fpdt, ftdt,       &
     &       z1dt, udt, xdt, fpx, fpxdt, ftx, ftxdt,                    &
     &       c1dt, c2dt, p1dt, a1dt, a2dt, t1dt, b1dt, b2dt
      Integer*4 I
!
      equivalence (e( 1), e1),(e( 2), e2),(e( 3), e3),(e( 4), e4), &
     &            (e( 5), e5),(e( 6), e6),(e( 7), e7),(e( 8), e8), &
     &            (e( 9), e9),(e(10),e10),(e(11),e11),(e(12),e12)
      equivalence (wp1(1),w0),(wp1(2),w1),(wp1(3),w2),(wp1(4),w3)
!
      data a1, a2 /     0.40816d0, 112.30d0  /
      data b1, b2 /     0.12820d0, 142.88d0  /
      data c1, c2 /     0.80000d0,  99.344d0 /
      data e   /    46.625d0  ,  45.375d0 ,     4.1572d0,  1.4468d0  , &
     &               0.25391d0,   2.2716d0,    -1.3465d0, -4.3877d0  , &
     &               3.1484d0 ,   4.5201d0,    -1.8982d0,  0.89000d0 /
      data p1 /   760.0d0 /
      data t1 /   273.0d0 /
      data wp1 / 22000.0d0    ,  17.149d0 ,  4684.1d0,    38.450d0   /
      data z1 /  91.870d0 /
      data conv/57.295779512d0/
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           VARIABLES 'FROM':
!              1. HALFPI - THE VALUE OF PI/2
!              2. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS
!                          (RAD/DEG)
!
      z1dt = 0.D0
      c1dt = 0.D0
      c2dt = 0.D0
      p1dt = 0.D0
      a1dt = 0.D0
      a2dt = 0.D0
      t1dt = 0.D0
      b1dt = 0.D0
      b2dt = 0.D0
!
! STATEMENT FUCNTION
!!    delta(ad1,ad2,bd1,bd2,zd2)=(ad2-ad1)*dexp(bd1*(zd2-bd2))
!
! CONVERT UNITS
!  Zenith angle in degrees
      z2 = 90.0d0 - El_Rad/CONVD
      z2dt = -Eldt/CONVD
!  Temperature in Kelvins
      t2 = Temp_K
      t2dt = 0.D0
!  Fractional humidity (0.0 -> 1.0)
      r = Humid_F
      rdt = 0.D0 
!  Pressure in mm of Hg
      p2 = Press_Hg
      p2dt = 0.D0 
!
!      WRITE(6,9956) R,T2,P2,Z2                                          DEBUG
!9956  FORMAT(" R,T2,P2,Z2",4F10.4)                                      DEBUG
!
! CALCULATE CORRECTIONS FOR PRES, TEMP, AND WETNESS
!      WRITE(6,9980) Z1,Z2,C1,C2                                         DEBUG
!9980  FORMAT(" Z1,Z2,C1,C2",4D15.6)                                     DEBUG
!     d3=1.0d0+delta(z1,z2,c1,c2,z2)
!
        z2a = z2
        z2adt = z2dt
       Call DELTA1(z1, z2, c1, c2, z2a, z1dt, z2dt, c1dt, c2dt, z2adt,  &
     &                d3, d3dt  )
       d3 = 1.D0 + d3
!       Write (6,*) ' d3, d3dt ', d3, d3dt
!
!     fp=(p2/p1)*(1.0d0-delta(p1,p2,a1,a2,z2)/d3)
      Call DELTA1(p1,p2,a1,a2,z2, p1dt,p2dt,a1dt,a2dt,z2dt, fpx,fpxdt)
      fp=(p2/p1)*(1.0d0-fpx/d3)
      fpdt = (-p2/p1) * (fpxdt/d3 - (fpx*d3dt/(d3**2))) 
!       Write (6,*) ' fpx,fpxdt  ', fpx,fpxdt
!       Write (6,*) ' fp,fpdt  ', fp,fpdt
!
!     ft=(t1/t2)*(1.0d0-delta(t1,t2,b1,b2,z2)/d3)
      Call DELTA1(t1,t2,b1,b2,z2, t1dt,t2dt,b1dt,b2dt,z2dt, ftx,ftxdt)
!
      ft=(t1/t2)*(1.0d0-ftx/d3)
      ftdt = (-t1/t2) * (ftxdt/d3 - (ftx*d3dt/(d3**2)))
!       Write (6,*) ' ftx,ftxdt  ', ftx,ftxdt
!       Write (6,*) ' fp,fpdt  ', ft,ftdt
!
      fw=1.0d0+(w0*r*DEXP((w1*t2-w2)/(t2-w3))/(t2*p2))
!       Write (6,*) ' fw       ', fw 
!
!      WRITE(6,9957) D3,FP,FT,FW                                         DEBUG
!9957  FORMAT(" D3,FP,FT,FW ",4D12.6)                                    DEBUG
!
!  CALCULATE OPTICAL REFRACTION
      u = (z2-e1)/e2
      udt = z2dt/e2
      x = e11
      xdt = 0.D0
      do 10 i = 1,8
        xdt = udt*x + u*xdt
        x = e(11-i) + u*x
 10   continue
!       Write (6,*) ' u, udt   ', u, udt  
!       Write (6,*) ' x, xdt   ', x, xdt  
!
!
!  COMBINE FACTORS AND FINISH OPTICAL FACTOR
!     sbend=ft*fp*fw*(dexp(x/d3)-e12)
      Zencor = ft*fp*fw*(DEXP(x/d3)-e12)
!
      Zencordt = ftdt*fp*fw*(DEXP(x/d3)) + ft*fpdt*fw*(DEXP(x/d3)) +    &
     &           ft*fp*fw*(DEXP(x/d3))*(xdt/d3 - (x*d3dt/d3**2))  -      &
     &            ftdt*fp*fw*e12 - ft*fpdt*fw*e12
!       Write (6,*) ' Zencor, Zencordt ', Zencor, Zencordt
!
!      WRITE(6,9958) SBEND,X,U                                           DEBUG
!9958  FORMAT(" SBEND,X,U ",3D20.10)                                     DEBUG
!
! BACK TO RADIANS FROM ARC SECONDS
      Zencor = (Zencor/3600.0d0)*CONVD
      Zencordt = (Zencordt/3600.0d0)*CONVD
!
!      WRITE(6,9959) SBEND                                               DEBUG
!9959  FORMAT(" SBEND (RADIANS) ",D20.10)                                DEBUG
      Return
      End
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      SUBROUTINE DELTA1(ad1, ad2, bd1, bd2, zd2, ad1dt, ad2dt,          &
     &                bd1dt, bd2dt, zd2dt, delta, deltadt  )
      IMPLICIT None
!
      Real*8 ad1, ad2, bd1, bd2, zd2, ad1dt, ad2dt, bd1dt, bd2dt,       &
     &       zd2dt, delta, deltadt
!
      delta = (ad2 - ad1) * DEXP( bd1*(zd2-bd2) )
      deltadt = (ad2dt - ad1dt) * DEXP( bd1*(zd2-bd2) ) +               &
     &       (ad2 - ad1) * DEXP(bd1*(zd2-bd2)) * ( (bd1dt*(zd2-bd2) )  &
     &       + ( bd1*(zd2dt-bd2dt)))
!
      RETURN
      END
      SUBROUTINE START (Num_Scans, Kjob)
      IMPLICIT None
!
!           Input variables:
!             1) calc_file_name - Job file '.calc' file name.
!
!     CHARACTER*128 calc_file_name, Finite_name
      Logical*4     Finite_model
!
!      Common blocks used -
!
      INCLUDE 'ccon.i'
!       Variables 'to':
!         1. ILUOUT - A flag controlling output.
!
      INCLUDE 'cmxst11.i'
!       Variables 'to':
!         1. NUMSIT    - The total number of sites in the data base.
!         2. Zero_site - The site number of the site at the geocenter.
!
      INCLUDE 'cmxsr11.i'
!       Variables 'to':
!         1. NUMSTR - The total number of stars (radio sources) in the
!                     data base.
!
      INCLUDE 'cmxut11.i'
!       Variables 'to':
!         1. Xintv(2)    - First and last Julian Date of data in the
!                          current data base.
!         2. Intrvl(5,2) - First and last time tag of data in the current
!                          data base. (First index: year, month, day,
!                          hour, minute. Second index: first, last.)
!
      INCLUDE 'param11.i'
!       Variables from:
!         1. A_tilts    - Antenna tilts file name.
!         2. OC_file
!         3. DFLEAP
!         4. OPTL_file
!         5. JPL_DE421
!
      INCLUDE 'd_input.i'
!
      INCLUDE 'c2poly.i'
!
!
      Real*8  ATMUTC(3), ROTEPH(2,20), A1UTC(3), A1DIFF(3)
      COMMON / EOPCM / ATMUTC, ROTEPH, A1UTC, A1DIFF
!       VARIABLES 'TO':
!         1. ROTEPH(2,20)- The array which contains the epochs at which
!                          TAI - UT1 is desired. The entries are:
!                          1) JD at 0:00 hours UTC,
!                          2) The fraction of a UTC day from 0:00 hours
!                          to the desired epoch.
!
      Real*8    XCALC, FJLDY
      Integer*2 NFLAG,NFLAGC,loadm(8),LFILE(3)
      COMMON /STACM/ Computing_center,XCALC,NFLAG,NFLAGC,loadm,LFILE
!
!     Integer*4 gethostname, ierr4
      Integer*4 imode, ILU, iout, idd1, Kjob
      Character*64 Computing_center
      Character*6 C_LFILE
      Character*128 CALCON_NAME
      Character*75 Lhist1
      Equivalence (C_LFILE,LFILE)
!
!       Variables 'from':
!         1. loadm(8)  - The load module compilation date message.
!         2. NFLAG     - The total number of CALC flow control and debug flags.
!         3. LFILE(3)  - The name of the CALC control file.
!         4. XCALC     - The CALC version number.
!         5. Kjob      - Incrmental job number. If .gt. 1, do not call get4unit.
!
!   Program specifications -
!
      Real*8    JDY2K
      Real*8    FJD2, Fday, Fhr, Fmin
      Real*8    JD1, JD2, Xmin, StrtUTCmin, StopUTCmin, ProcMin 
      Integer*4 Min2, MinStrt, MinStop, StopSec, StopMin, Num2Min,     &
     &          StopHr, StopDay, StopMo, StopYr
!
!     Integer*4 Iyear, Imonth, Iday
      Integer*4  IFLAG(62)
      Integer*2  LCALC(40), LFCIO(40), LHIST(66), LNAME(5), LNAMO(5), &
     &           IBUF(40),      trimlen, host_len, hist_len
      Integer*4 Ipid, Getpid, jj, IOS
      Real*8 xleap(5), tol
      CHARACTER LNAME_chr*10, LNAMO_chr*10, LFCIO_chr*80, LHIST_chr*132
      Character*8  Ich8
      Character*80 Ich80
      CHARACTER*80 CBUF,CTIME*12,CDATE*16
      EQUIVALENCE  ( IFLAG(1),  KATMC ),  ( LCALC(1), LHIST(1) ), &
     &             ( IBUF, CBUF), (LNAME,LNAME_chr), &
     &             ( LNAMO,LNAMO_chr), (LFCIO,LFCIO_chr), &
     &             ( LHIST,LHIST_chr)
      Integer*4 get4unit
!     Integer*2 IPAR(5),          kruc, iveri, lfvo, isame, ivero, &
!    &          kerr, NDO(3), idd2
      Integer*4 I, N, Unit1, Unit2, isz, iup, MXUTPM, Num_Scans
      Integer*4 IMNTHS(12)
      DATA IMNTHS /31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31/
      Character*80 xtlt
      Character*24 STR24
!     Save      Unit1, Unit2
!     CHARACTER*10 IPAR_C
!     EQUIVALENCE (IPAR,IPAR_C)
!     DATA  KRUC / 2 /
!     Data  Lhist1 / &
!    &   ' &
!    &             '/
!     Data Unit1 /0/
!
!
!     External I/O
!       Input variables:
!         1. Non-default model module and utility routine flow control and
!                          debug output flags.
!       Output variables:
!         1. All model and module utility routine flow control and debug
!                          output flags.
!
!     Program variables -
!         1. IFLAG(NFLAG) -  The variable used to initialize all flow
!                            control and debug output flags.
!         7. Intrvl(5,2)  -  First and last UTC tag for data in the current
!                            data base. (First index - year(2 digits),
!                            month(1-12), day of month, hours, minutes)
!
!     Programmer - David Gordon Jan-Apr, 2013 
!
!   dSTART Program Structure
!
      ILUOUT = iout
      MXUTPM = 20
!
!   Initialize all flow control and debug output flags to zero.
      DO 400 N = 1, NFLAG
 400    IFLAG(N) = 0
!
!
!   Get the apriori's from the .calc file.
!!!!      Call dGet_input(Kjob)
       Num_Scans = NumScans
!
! Set Geocenter station;
      Zero_site = 1
      SITES(1) = 'GEOCENTR'
      Axis(1)  = 'AZEL'
      SITAXO(1) = 0.D0
      SITXYZ(1,1) = 0.D0
      SITXYZ(2,1) = 0.D0
      SITXYZ(3,1) = 0.D0
       NUMSIT = NUMSIT + 1

      RETURN
!
      END
!
!**********************************************************************
      BLOCK DATA dSTACMB
      IMPLICIT None
!
! 1.     STABD
!
! 1.1.1  STABD IS THE BLOCK DATA INITIALIZATION SECTION FOR THE START MODULE.
!        IT HOLDS THE LOAD MODULE DATE MESSAGE.
!
! 1.2.2  COMMON BLOCKS USED
      Real*8  XCALC
      Integer*2 NFLAG,NFLAGC,loadm(8),LFILE(3)
      COMMON /STACM/ Computing_center,XCALC,NFLAG,NFLAGC,loadm,LFILE
      Character*64 Computing_center
      CHARACTER*16 LOADM_CHR
      EQUIVALENCE (LOADM,LOADM_CHR)
      CHARACTER*6 C_LFILE
      EQUIVALENCE (C_LFILE,LFILE)
!
!       VARIABLES 'TO':
!         1. LOADM - THE LOAD MODULE COMPILATION DATE MESSAGE.
!         2. NFLAG - THE TOTAL NUMBER OF CALC FLOW CONTROL AND DEBUG FLAGS.
!         3. LFILE(3) - THE NAME OF THE CALC CONTROL FILE.
!         4. XCALC - THE CALC PROGRAM VERSION NUMBER.
!
!     DATA LOADM_CHR /'Ver. 2011.07.19 '/
      DATA NFLAG /62/
!     DATA C_LFILE /'CALCON'/
!     DATA XCALC/10.99D0/
!
! 1.2.9  PROGRAMMER - BRUCE SCHUPLER 05/12/78
!                     BRUCE SCHUPLER 06/05/78
!                     BRUCE SCHUPLER 09/14/78
!                     BRUCE SCHUPLER 12/06/78
!                     BRUCE SCHUPLER 06/06/79
!                     BRUCE SCHUPLER 08/26/80
!                     DAVID GORDON   06/19/84
!                     DAVID GORDON   01/08/85 (REMOVED IDISC=59)
!                     SAVITA GOEL    06/02/87 (CDS FOR A900)
!                     Jim Ryan 89.07.25 Documentation simplified.
!                     Jim Ryan 89.12.12 UNIX-like database interface
!                                    implimented.
!                     David Gordon 94.04.15 Converted to Implicit None
!                     David Gordon 98.07.23 Removed ISECU, IDISC, and IOPEN
!                                    from Common /STACM/.
      END
!**********************************************************************
      SUBROUTINE dGETEOP()
      Implicit None
!
!     Get Earth orientation table from an external file.
!      This routine reads a SOLVE-format EOP Mod file.
!
!     Common blocks used -
!
      INCLUDE 'input11.i'
!            Variables 'from':
!              1. Ex_EOP - File name of the external EOP input file
!
      INCLUDE 'cmxut11.i'
!            Variables 'from':
!              1. Xintv(2)  - First and last Julian Date in the data base
!            Variables 'to':
!              1. UT1IF(4)  - The final UT1 information array. This array
!                             contains respectively: 1) The Julian date of the
!                             first tabular point, 2) The increment in days of
!                             the tabular points, 3) The number of tabular
!                             points, 4) The units of the UT1 tabular array per
!                             second. (days, days, unitless, sec/table unit)
!              2. UT1PT(20) - The tabular values of 'TAI minus UT1'.
!                             (table units)
!              3. ISHRTFL   - The short period tidal terms flag, (unitless).
!                             = 1 --> UT1 table coming from input database is
!                             true UT1, (that is, fortnightly tidal terms have
!                             not been removed, as in the IRIS or IERS series).
!                             = -1 --> UT1 table coming from input database is
!                             UT1R, (that is, the Yoder fortnightly tidal terms
!                             HAVE been removed as in Bulletin B).
!                             = -2 --> UT1 table coming from input database is
!                             UT1S, (the S tidal terms HAVE been removed).
!              4. Leap_fix   - Used in external input mode. .True. means
!                              correct the input EOP series for accumluated
!                              leap seconds. .False. means do not correct.
!              5. UT1type    - UT1 data type: 'UT1-TAI ' or 'UT1-UTC '.
!                              For ''UT1-UTC ', leap second corrections
!                              must be made.
!              6. EOP_time_scale - EOP table time scale, allowed values:
!                              'TAI     ', 'TCG     ', 'TDB     ',
!                              'TDT     ', 'UTC     ', 'UNDEF   '.
!                              Assumed default if not present => TDB
!
      INCLUDE 'cmwob11.i'
!            Variables 'to':
!              1. WOBIF(3)  -  The wobble information array. Contains
!                              respectively: 1) The Julian date of the first
!                              tabular point, 2) The increment in days of the
!                              tabular points, 3) The number of tabular points.
!                              (days, days, unitless)
!              2. XYWOB(2,20)- The wobble tabular points for the polar motion
!                              (wobble) X & Y offsets. (milliarcsec)
!                              (Note: Based on old BIH conventions, offsets
!                              are assumed to be left-handed.)
!
!   Program Specifications -
      Real*8      JD1, Uintv, Xmjdm, Mjdm, Mjds, Xmjds, XJDT, X10, Y10, &
     &            UT1T, Xmjdl, JD2
      Integer*4   Get4unit, Iunit, Npts, Nerp, I, IOS
      Character*4 Utflag
      Integer*2   KERR, idd3
      Character   EOP_ID*15, dummy1*1
!
!   Program variables:
!          JD1    - First (full) Julian Day in EOP file
!          JD2    - Last (full) Julian Day in EOP file
!          Uintv  - EOP interval (usually 1.0 days)
!          Npts   - Number of points in the input EOP file
!          Nerp   - Number of trabular points to use in the UT1 and polar
!                   motion interpolation tables
!          Utflag - Type of UT1 data (UT1, UT1R, UT1S)
!          Xmjdm  - Experiment midpoint (FJD)
!          Mjdm   - Experiment midpoint (MJD)
!          Mjds   - Time of first tabular point (MJD)
!          Xmjds  - Time of first tabular point (FJD)
!          Xmjdl  - Time of last tabular point (FJD)
!          Kjob   - Job number. If .gt. 1, do not call get4unit again.
!
!     Programmer:
!      98.04.27  David Gordon - Original program written
!      99.11.19  David Gordon - Bug fix, CLOSE(Iunit) statements added.
!      99.11.23  David Gordon - Setting number of EOP points to 15 always,
!                               for compatability with Dbedit/Apriori and
!                               SOLVE.
!    2000.12.11  David Gordon - Modify to skip comment statements in EOP
!                               mod file.
!    2000.12.29  David Gordon - Modify to read/interpret new EOP mod file
!                               table header record.
!-----------------------------------------------------------------------
!
         Leap_fix = .False.
!
!  Open the EOP file
!
       Iunit = Get4unit()
       OPEN (unit=Iunit, file=Ex_EOP, status='old', Action='READ',      &
     &       err=99, Iostat=Ios)
       Go to 101
  99   Continue
       Write(6,'(" Error opening external EOP file. Quitting! ")')
       Call TERMINATE_CALC ( 'GETEOP', int2(1), int2(IOS))
 101   Continue
!
!  Read new EOP mod file format. 2000.12.29
       Read(Iunit,1016,err=88) EOP_ID, JD1, Uintv, Npts, UT1type, &
     &                  EOP_time_scale
 1016  Format (A15,2X,F9.1,2X,F4.1,2X,I5,2X,A8,2X,A8)
!
       If (UT1type .eq. 'UT1-TAI ') Then               ! Normal case
         Utflag = 'UT1 '
         ISHRTFL =  1
         Leap_fix = .False.
         Go to 102
       Endif                                           ! Normal case
!
       If (UT1type .eq. 'UT1-UTC ') Then               ! Abnormal case
         Utflag = 'UT1 '
         ISHRTFL =  1
!          Will need to subtract leap seconds later (in UT1I)
         Leap_fix = .True.
         Go to 102
       Endif                                           ! Abnormal case
!
!  If here, UT1type not properly defined. ?????
       Write(6,'(" Illegal UT1type in EOP mod file! Quitting! ")')
       Call TERMINATE_CALC ( 'GETEOP', int2(1), int2(IOS))
!
  88   Continue
!  Old format, just in case
       Backspace (Iunit)
       Read(Iunit,1018, err=89) JD1, Uintv, Npts, Utflag
 1018  Format (F9.1, F4.0, I4, 1X, A4)
       Write(6,'(/,"  !!! Using old EOP mod file format !!!",/)')
!
       Leap_fix = .False.
       UT1type = 'UT1-TAI '
       EOP_time_scale = 'UNDEF   '
!   Determine what the short period tidal term flag should be
       IF(Utflag .eq. 'UT1 ') ISHRTFL =  1
       IF(Utflag .eq. 'UT1S') ISHRTFL = -2
       IF(Utflag .eq. 'UT1R') Then
         ISHRTFL = -1
         Write(6,'(" Cannot use UT1R data! Quitting! ")')
         Call TERMINATE_CALC ('GETEOP', int2(1), int2(Ios))
       ENDIF
!
!**   Write(6,'(" ISHRTFL = ",I3)') ISHRTFL
       Go to 102
  89   Continue
       Write(6,'(" Cannot read EOP file! Quitting! ")')
       Call TERMINATE_CALC ('GETEOP', int2(1), int2(Ios))
!
 102  Continue
!
!  Number of points in table. Set to 15 when data interval less than 2.0 days.
!   Increase by 1 for each additional day, up to 20 points.
       Nerp = 15
!   Set to 15 in all cases! 99.11.23 -DG-
!*     Nerp = 14 + (xintv(2)-xintv(1))
!*     If (Nerp .lt. 15) Nerp = 15
!*     If (Nerp .gt. 20) Nerp = 20
!
!  Midpoint of experiment
       Xmjdm = (Xintv(1) + Xintv(2)) / 2.D0
!  First tabular point at midnight prior to (Nerp*Uintv)/2 days before midpoint
       Mjdm = Xmjdm - 2400000.5D0
       Mjds = Dint (Mjdm - (Nerp*Uintv)/2.D0)
!   First point at time Xmjds:
       Xmjds = Mjds + 2400000.5D0
!
!  Check if EOP file does not start early enough:
! !! Require 15 points in all cases!!! 99.11.23 -DG-
       If (Xmjds .lt. JD1) Then
!*       Need at least one point before first observation time in data base
!*       If ( (Xintv(1) - Uintv) .lt. JD1 ) Then
           Write(6,'("GETEOP: Not enough EOP points before database")')
            KERR = 0
            Close (Iunit)
           CALL TERMINATE_CALC ('GETEOP', int2(1), KERR)
!*       Else
!*         Recompute Nerp and reset first tabular point to JD1
!*         Nerp = Nerp - (JD1-Xmjds+.01)/Uintv
!*         Xmjds = JD1
!*       Endif
       Endif
!
!  Check if EOP file ends too early:
! !! Require 15 points in all cases!!! 99.11.23 -DG-
       Xmjdl = Xmjds + (Nerp-1)*Uintv
       JD2 = JD1 + (Npts-1)*Uintv
       If (Xmjdl .gt. JD2) Then
!*       Need at least one point after last observation time in data base
!*       If ( (Xintv(2) + Uintv) .gt. JD2 ) Then
           Write(6,'("GETEOP: Not enough EOP points after database")')
            KERR = 0
            Close (Iunit)
           CALL TERMINATE_CALC ('GETEOP', int2(1), KERR)
!*       Else
!          Recompute Nerp
!*         Nerp = Nerp - ( Xmjdl-JD2+.01)/Uintv
!*       Endif
       Endif
!
!     Write(6,1021) Xintv, Xmjdm, Mjdm, Mjds, Xmjds
!1021 Format ('Xintv(2), Xmjdm, Mjdm, Mjds, Xmjds: ',2F20.8,/,5X,
!    *        4F19.8)
!
!  Fill the UT1 and Wobble information arrays
       UT1IF(1) = Xmjds
       UT1IF(2) = Uintv
       UT1IF(3) = Nerp
       UT1IF(4) = 1.0D0
!**   Write(6,'(" UT1IF(4) ",4F15.6)') UT1IF
!
       WOBIF(1) = Xmjds
       WOBIF(2) = Uintv
       WOBIF(3) = Nerp
!**   Write(6,'(" WOBIF(3) ",3F15.6)') WOBIF
!
!  Get the EOP points:
!   Read till first point found
  50   Continue
       Read (Iunit,*,err=50) XJDT, X10, Y10, UT1T
!      Read (Iunit,1019) XJDT, X10, Y10, UT1T
 1019  Format (F9.1, 2F8.4, I10)
!
       If (DABS(XJDT - XMJDS) .le. 1.D-8) Then
         Backspace (Iunit)
         Go to 70
       Else
         Go to 50
       Endif
!
  70   Continue
       Do I = 1,Nerp
!      Read (Iunit,1019) XJDT, X10, Y10, UT1T
       Read (Iunit,*) XJDT, X10, Y10, UT1T
!  Input units are : X/Y => 0.1 arc-sec; UT1 => microseconds
!  Convert to milli-arc-seconds and time seconds, and change
!   UT1-TAI to TAI-UT1 (or UT1-UTC to UTC-UT1)
       UT1PT(I) = -UT1T/1.D6
       XYWOB(1,I) = X10/10.D0 * 1.D3
       XYWOB(2,I) = Y10/10.D0 * 1.D3
!
       Enddo
!      Write (6,1023)   (XYWOB(1,I), XYWOB(2,I), UT1PT(I), I=1,Nerp)
!1023  Format (' External EOPs: ',20(/,3F20.10))
!
       Close(Iunit)
!
       Return
       End
!**********************************************************************
      REAL*8 FUNCTION JDY2K (IYEAR, IMONTH, IDAY)
      Implicit None
!
!     Function JDY2K: Function to convert year, month, day to full Julian
!     day. The year can be either a four-digit year or a two-digit year.
!
!     If a 4-digit year, this function is good from 1 March 1900 to 31
!     December 2099.
!
!     If a 2-digit year, this function is good from 1 January 1970 to
!     31 December 2069. If year is 70 - 99, 1900 is added. If year is
!     00 - 69, 2000 is added.
!
!     Programmer:
!      98.07.23  D. Gordon  Function written from code in cutcu.f
!
      Integer*4 IYEAR, IMONTH, IDAY, IY, IM, ID
!
       IY = IYEAR
       IM = IMONTH
       ID = IDAY
!
       If (IY .ge. 70 .and. IY .le. 99) Then
        IY = IY + 1900
        Go To 100
       Endif
!
       If (IY .ge. 0 .and. IY .le. 69) Then
        IY = IY + 2000
        Go To 100
       Endif
!
       If (IY .gt.1900 .and. IY .le. 2099) Then
        Go To 100
       Endif
!
!     Year out of range if we get here
       Print *, ' JDY2K, Year out of Range, Stopping! ', IY
       Stop
!
 100   Continue
!
        JDY2K = 367.D0*IY - (7 * ( IY + (IM+9)/12) )/4 + &
     &          (275*IM)/9 + ID + 1721013.5D0
!
!      Write(6,1000) IYEAR, IMONTH, IDAY, IY, IM, ID, JDY2k
 1000  Format(/,'Function JDY2K: ',/,' Input, Modified Y,M,D: ', &
     &        2x,3I5,5x,3I5,/,' JDY2K ', F15.2)
      Return
      End
!
!**********************************************************************
      SUBROUTINE YMDJL(FJD, IYEAR, IMONTH, IDAY)
      Implicit none
!
!     Convert Julian date at midnight to month, day and year.
!     Copied from PEP plus an additional .5 day to convert
!     from Julian date at midnight to the PEP Julian day number.
!
!     INPUT Variables:
      REAL*8 FJD
!
! FJD = Julian date at midnight
!
!     OUTPUT Variables:
      INTEGER*4 IMONTH,IDAY,IYEAR,ITIME
!
! IDAY = Day of the month
! IMONTH = Month of the year (1-12)
! IYEAR = Year of the century (0-99)
!       => Changed to full 4-digit year
! ITIME - Number of centuries since 1900
!
!     LOCAL VARIABLES
      INTEGER*2 MDN(13),nyr,ic,inyr,i
      Real*8 XJD
      DATA MDN/0,31,59,90,120,151,181,212,243,273,304,334,365/
!
! IC - Number of centuries sice 0 January 1600
! INYR - Leap year days since 0 January 1600
! MDN - Array containing day of year at end of each month
! NYR - Number of years since 0 January 1600
! XJD - Days since 0 January 1600
!
!     HISTORY
!   WHO   WHEN     WHAT
!   DSR  7608??    Created
!   DG  2012.04.26 Integer*4 and 4-digit year mods.
!
!     YMDJL PROGRAM STRUCTURE
!
      XJD = FJD - 2305447.0D0 + 0.5D0
      NYR = XJD/365.
   16 IC = NYR/100
!     DAYS DUE TO LEAP YEARS
      INYR = XJD - NYR*365.0
      IDAY = INYR - (NYR-1)/4 + (NYR + 99)/100 - (NYR + 399)/400 - 1
      IF(IC .NE.0) GO TO 20
      IF(NYR.NE.0) GO TO 20
      IDAY = IDAY + 1
   20 IF(IDAY .GT. 0) GO TO 23
      NYR = NYR - 1
      GO TO 16
!**** IYEAR (O THRU 99) YEAR OF THE CENTURY
   23 IYEAR = NYR - IC * 100
      ITIME = IC - 3
      NYR = IYEAR
      IF(NYR .NE. 0) GO TO 27
      IF(MOD(IC,INT2(4)) .NE. 0) GO TO 34
      GO TO 30
   27 IF(MOD(NYR,INT2(4)) .NE. 0) GO TO 34
!
! Replacing ancient code:
!  30 IF(IDAY - 60) 34,39,32
   30 Continue
      If((IDAY-60) .lt. 0) Go to 34
      If((IDAY-60) .eq. 0) Go to 39
      If((IDAY-60) .gt. 0) Go to 32
!  
   32 IDAY = IDAY - 1
   34 DO 36 I=2,13
          IF(IDAY .LE. MDN(I)) GO TO 40
   36 CONTINUE
   39 IMONTH = 2
      IDAY = 29
      GO TO 45
   40 IMONTH = I - 1
      IDAY = IDAY - MDN(IMONTH)
   45 CONTINUE
! Modified - 4 digit year
       IYEAR = IYEAR + 1900 + ITIME*100
!
      RETURN
      END
!
!**********************************************************************
      SUBROUTINE dGet_input(Kjob)
      IMPLICIT None
!
!
! 3.2.2 COMMON BLOCKS USED -
!
!!!!  INCLUDE 'cuser11.i'
!       Variables from:
!         1. Calc_user  - Calc user type. 'A' for Calc/SOLVE analysis.
!                         'C' for VLBI correlator.
      INCLUDE 'cmxut11.i'
!            Variables 'to':
!              1. Xintv(2)  - First and last Julian Date in the data base
!              1. UT1IF(4)  - The final UT1 information array. This array
!                             contains respectively: 1) The Julian date of the
!                             first tabular point, 2) The increment in days of
!                             the tabular points, 3) The number of tabular
!                             points, 4) The units of the UT1 tabular array per
!                             second. (days, days, unitless, sec/table unit)
!              2. UT1PT(20) - The tabular values of 'TAI minus UT1'.
!                             (table units)
!              3. ISHRTFL   - The short period tidal terms flag, (unitless).
!                             = 1 --> UT1 table coming from input database is
!                             true UT1, (that is, fortnightly tidal terms have
!                             not been removed, as in the IRIS or IERS series).
!                             = -1 --> UT1 table coming from input database is
!                             UT1R, (that is, the Yoder fortnightly tidal terms
!                             HAVE been removed as in Bulletin B).
!                             = -2 --> UT1 table coming from input database is
!                             UT1S, (the S tidal terms HAVE been removed).
!              4. Leap_fix   - Used in external input mode. .True. means
!                              correct the input EOP series for accumluated
!                              leap seconds. .False. means do not correct.
!              5. UT1type    - UT1 data type: 'UT1-TAI ' or 'UT1-UTC '.
!                              For ''UT1-UTC ', leap second corrections
!                              must be made.
!              6. EOP_time_scale - EOP table time scale, allowed values:
!                              'TAI     ', 'TCG     ', 'TDB     ',
!                              'TDT     ', 'UTC     ', 'UNDEF   '.
!                              Assumed default if not present => TDB
!
      INCLUDE 'cmwob11.i'
!            Variables 'to':
!              1. WOBIF(3)  -  The wobble information array. Contains
!                              respectively: 1) The Julian date of the first
!                              tabular point, 2) The increment in days of the
!                              tabular points, 3) The number of tabular points.
!                              (days, days, unitless)
!              2. XYWOB(2,20)- The wobble tabular points for the polar motion
!                              (wobble) X & Y offsets. (milliarcsec)
!                              (Note: Based on old BIH conventions, offsets
!                              are assumed to be left-handed.)
!
      INCLUDE 'cmxst11.i'
!      Variables from:
!       1. Max_Stat             -  Maximum number of stations that can be 
!                                  processed.
!      Variables to:
!*      1. CFRAD(Max_Stat)      -  THE SITE SPHERICAL EARTH RADII.  (M)
!*      2. PLAT(3,Max_Stat)     -  THE PARTIAL DERIVATIVES OF THE SITE CRUST
!*                                 FIXED VECTOR COMPONENTS WITH RESPECT TO THE
!*                                 GEODETIC LATITUDES. (M/RAD)
!*      3. PLON(3,Max_Stat)     -  THE PARTIAL DERIVATIVES OF THE SITE CRUST
!*                                 FIXED VECTOR COMPONENTS WITH RESPECT TO THE
!*                                 EAST LONGITUDES. (M/RAD)
!       4. SITAXO(Max_Stat)     -  THE SITE ANTENNA AXIS OFFSETS. (M)
!       5. SITOAM(11,Max_Stat)  -  THE SITE VERTICAL OCEAN LOADING AMPLITUDES.
!                                  (M)
!       6. SITOPH(11,Max_Stat)  -  THE SITE VERTICAL OCEAN LOADING PHASES.
!                                  (RAD)
!       7. SITXYZ(3,Max_Stat)   -  THE SITE CRUST FIXED X, Y, & Z
!                                  COORDINATES. (M, M, M )
!*      8. SNRM(3,Max_Stat)     -  THE X, Y, AND Z COMPONENTS OF THE SITE
!*                                 NORMAL UNIT VECTORS. (UNITLESS)
!*      9. SITZEN(Max_Stat)     -  THE ZENITH ELECTRICAL PATH LENGTH AT EACH
!*                                 OBSERVATION SITE. (SEC)
!*     10. TCROT(3,3,Max_Stat)  -  THE ROTATION MATRICES WHICH ROTATE THE
!*                                 TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST
!*                                 FIXED REFERENCE SYSTEM FOR EACH SITE.
!*                                 (UNITLESS)
!*     11. XLAT(Max_Stat)       -  THE SITE GEODETIC LATITUDES. (RAD)
!*     12. XLON(Max_Stat)       -  THE SITE EAST LONGITUDES. (RAD)
!      13. KTYPE(Max_Stat)      -  THE SITE ANTENNA AXIS TYPES. (UNITLESS)
!*     14. NLAST(2)             -  THE INTEGER VARIABLE WHICH DETERMINES IF
!*                                 THE BASELINE ID HAS CHANGED FROM ONE
!*                                 OBSERVATION TO THE NEXT.
!*                                 (NOTE: THE SITE GEOMETRY NEED NOT BE
!*                                 RELOADED FOR EACH OBSERVATION IF THE
!*                                 BASELINE ID DOES NOT CHANGE. NLAST MUST BE
!*                                 INITIALIZED TO ZERO IN THE INITIALIZATION
!*                                 SECTION AND PASSED TO THE GEOMETRY SECTION
!*                                 SO THAT IT WILL HAVE ZERO VALUES UNTIL
!*                                 AFTER THE FIRST OBSERVATION IS PROCESSED.)
!*     15. NUMSIT               -  THE NUMBER OF SITES IN THE SITE CATALOG.
!      16. LNSITE(4,Max_Stat)   -  THE EIGHT CHARACTER SITE NAMES OF THE
!                                  SITES IN THE SITE CATALOG. (ALPHAMERIC)
!      17. SITHOA(11,2,Max_Stat) - THE SITE HORIZONTAL OCEAN LOADING
!                                  AMPLITUDES. (M)
!      18. SITHOP(11,2,Max_Stat) - THE SITE HORIZONTAL OCEAN LOADING PHASES.
!                                  (RAD)
!*     19. HEIGHT(Max_Stat)     -  Height above the geoid. (meters)
!*     20. RTROT(3,3,Max_Stat)  -  The rotation matrices which rotate the
!*                                 'radial-transverse' reference system to the
!*                                 crust fixed reference system for each site.
!*                                 (Unitless). The 'radial-transverse' ref.
!*                                 system is nearly identical to the
!*                                 topocentric system. 'Up' is in the radial
!*                                 direction from the center of the Earth;
!*                                 'East' is East; and 'North' is perpendicular
!*                                 to the radial in the north direction.
!*     21. GLAT(Max_Stat)       -  The geocentric latitude at each site. (rad)
!      22. Zero_site            -  The site number of the site at the
!                                  geocenter, if there is one in this data
!                                  set. For correlator usage.
!      23. Dbtilt(Max_Stat,2)   -  Antenna fixed axis tilts, in arc-minutes.
!                                  For alt-az mounts, 1 => East tilt,
!                                  2 => North tilt.
!*     24. Rotilt(3,3,Max_Stat) -  Rotation matrices representing the antenna
!*                                 fixed axis tilts, in the local topocentric
!*                                 station frame. X = Up, Y = East, Z = North.
!      25. OPTL6(6,Max_stat)    -  The site ocean pole tide loading 
!                                  coefficients, interpolated from the Desai
!                                  lat/lon table.
!
      INCLUDE 'cmxsr11.i'
!       VARIABLES 'TO':
!         1. LNSTAR(10,MAX_ARC_SRC)- THE ALPHANUMERIC CHARACTER NAMES
!                                    OF THE STARS IN THE STAR CATALOG.
!                                    Now up to 20 characters in difx mode.
!         2. NUMSTR                - THE NUMBER OF STARS IN THE STAR
!                                    CATALOG.
!         3. RADEC(2,MAX_ARC_SRC)  - THE RIGHT ASCENSIONS AND DECLINATIONS
!                                    OF THE STARS IN THE STAR CATALOG.
!                                    (RAD, RAD)
!         4. P_motion(3,Max_arc_src)-The RA and Dec proper motions and
!                                    appropriate epoch for stars in the
!                                    star catalog. (arc-sec/yr, arc-sec/yr,
!                                    year (i.e. 1995.5, etc.))
!         5. D_psec(Max_arc_src)   - Distances, if known, for stars in the
!                                    star catalog. Zero => unknown.
!                                    (parsecs)
!         6. PRcorr(2,Max_arc_src) - Proper motion corrections in RA and
!                                    Declination for each star. (Radians)
!
!
      Character*200 Buf1
!     CHARACTER*128 calc_file_name
      CHARACTER*26 Sou26, Sp26
      CHARACTER*12 Site12, Scan12
      Real*8    JStart, JStop, StartMJD, EopTag(20), TAIUTC(20),        &
     &          UT1UTC(20), ADJUSTL, X_Sp
      Integer*4 AntNum, SrcNum,          NumEOP, EopNum, SpNum
      Integer*4 I, J, Unit1, IOS, IX, IK, KJ, I_Sp, L, Kjob
      Integer*4 get4unit
      Character*6 Mount6 
      Save      Unit1
!
      INCLUDE 'd_input.i'
!     COMMON/Calc_input/ SrcName, ScanID, Sites, Axis, JobID, NumScans, &
!    &       StartYr, StartMo, StartDay, StartHr, StartMin, StartSec,   &
!    &       ScanStrt, ScanDur
!     Character*10 SrcName(100), ScanID
!     Character*8 Sites(Max_stat)
!     Integer*4 JobID, NumScans
!     Integer*4 StartYr, StartMo, StartDay, StartHr, StartMin, StartSec
!     Integer*4 ScanStrt, ScanDur
!     Character*4 Axis(Max_Stat) 
!
!     COMMON/NFO/ SpTag, SpPos, SpVel, NumSpace, NumRows, SpName 
!     Character*10 SpName(10)
!     Real*8 SpTag(100,10), SpPos(100,3,10), SpVel(100,3,10)
!     Integer*4 NumSpace, Numrows(10)
!
!!    Character*8 SrcName(10)
      Character*20 SrcName(MAX_ARC_SRC)
      Equivalence (LNSTAR(1,1), SrcName(1))
!
!  Need to initialize stuff:
!
       NumSit = 0
       NumStr = 0
       NumEOP = 0
       NumSpace = 0
       SpFrame = 'ECJ2'
       Do IK=1, Max_Stat
         SITAXO(IK) = 0.D0
         Do KJ=1,3
          SITXYZ(KJ,IK) = 0.D0
         Enddo
       Enddo
!
       If (Kjob .eq. 1) Unit1 = get4unit()
       OPEN(Unit1,FILE=calc_file_name ,STATUS='OLD', IOSTAT= IOS)
       IF(IOS.ne.0) Write(6,'("Open Error for file: ",A128)') calc_file_name
!
 100  Continue
!
      Read(Unit1,'(A200)',end=200) Buf1
!
      If (Buf1(1:7) .eq.'JOB ID:') Read(Buf1(20:40),*) JobID 
      If (Buf1(1:15).eq.'JOB START TIME:') Read(Buf1(16:40),*) JStart 
      If (Buf1(1:14).eq.'JOB STOP TIME:') Read(Buf1(16:40),*) JStop 
      If (Buf1(1:10).eq.'START MJD:') Read(Buf1(20:40),*) StartMJD
      If (Buf1(1:11).eq.'START YEAR:') Read(Buf1(20:40),*) StartYr
      If (Buf1(1:12).eq.'START MONTH:') Read(Buf1(20:40),*) StartMo
      If (Buf1(1:10).eq.'START DAY:') Read(Buf1(20:40),*) StartDay
      If (Buf1(1:11).eq.'START HOUR:') Read(Buf1(20:40),*) StartHr
      If (Buf1(1:13).eq.'START MINUTE:') Read(Buf1(20:40),*) StartMin
      If (Buf1(1:13).eq.'START SECOND:') Read(Buf1(20:40),*) StartSec
! 
      If (Buf1(1:15).eq.'NUM TELESCOPES:') Read(Buf1(20:40),*) NUMSIT
!vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv 
      If (Buf1(1:9).eq.'TELESCOPE') Then
!  Don't fill site #1. That will be the Geocenter.

       IX = INDEX(Buf1,'NAME:')
       If (IX .gt. 0) Then
        Read(Buf1(10:IX-1),*) AntNum
        Site12 = Buf1((IX+5):(IX+16)) 
        Site12 = ADJUSTL(Site12)
        Sites(AntNum+2) = Site12(1:8)
       Endif 
!
       IX = INDEX(Buf1,'MOUNT:')
       If (IX .gt. 0) Then
        Read(Buf1(10:IX-1),*) AntNum
        Mount6 = Buf1((IX+6):(IX+11)) 
        Mount6 = ADJUSTL(Mount6)
        Axis(AntNum+2) = Mount6(1:4)
       Endif 
!
       IX = INDEX(Buf1,'OFFSET (m):')
       If (IX .gt. 0) Then
        Read(Buf1(10:IX-1),*) AntNum
        Read(Buf1((IX+11):(IX+22)),*) SITAXO(AntNum+2) 
       Endif 
!
       IX = INDEX(Buf1,'X (m):')
       If (IX .gt. 0) Then
        Read(Buf1(10:IX-1),*) AntNum
        Read(Buf1((IX+7):(IX+26)),*) SITXYZ(1,AntNum+2) 
       Endif 
!
       IX = INDEX(Buf1,'Y (m):')
       If (IX .gt. 0) Then
        Read(Buf1(10:IX-1),*) AntNum
        Read(Buf1((IX+7):(IX+26)),*) SITXYZ(2,AntNum+2) 
       Endif 
!
       IX = INDEX(Buf1,'Z (m):')
       If (IX .gt. 0) Then
        Read(Buf1(10:IX-1),*) AntNum
        Read(Buf1((IX+7):(IX+26)),*) SITXYZ(3,AntNum+2) 
       Endif 
!
      Endif    
!^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
!
      If (Buf1(1:12).eq.'NUM SOURCES:') Read(Buf1(13:30),*)  NUMSTR 
!vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv 
      If (Buf1(1:6).eq.'SOURCE') Then
       IX = INDEX(Buf1,'NAME:')
       If (IX .gt. 0) Then
        Read(Buf1(8:IX-1),*) SrcNum
        Sou26 = Buf1((IX+5):(IX+30)) 
        Sou26 = ADJUSTL(Sou26)
        SrcName(SrcNum+1) = Sou26(1:20)
       Endif 
       IX = INDEX(Buf1,'RA:')
       If (IX .gt. 0) Then
        Read(Buf1(7:IX-1),*) SrcNum
        Read(Buf1((IX+3):(IX+33)),*) RADEC(1,SrcNum+1) 
       Endif 
       IX = INDEX(Buf1,'DEC:')
       If (IX .gt. 0) Then
        Read(Buf1(7:IX-1),*) SrcNum
        Read(Buf1((IX+4):(IX+33)),*) RADEC(2,SrcNum+1) 
       Endif 
      Endif 
!^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
!
      If (Buf1(1:10).eq.'NUM SCANS:') Read(Buf1(11:30),*) NumScans
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!   Scan information now is read in by subroutine dScan.
!vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv 
!     If (Buf1(1:4).eq.'SCAN') Then
!      IX = INDEX(Buf1,'IDENTIFIER:')
!      If (IX .gt. 0) Then
!       Read(Buf1(5:IX-1),*) ScanNum
!       Scan12 = Buf1((IX+11):(IX+22)) 
!       Scan12 = ADJUSTL(Scan12)
!       ScanID = Scan12(1:10)
!      Endif 
!      IX = INDEX(Buf1,'START (S):')
!      If (IX .gt. 0) Then
!       Read(Buf1(5:IX-1),*) ScanNum
!       Read(Buf1((IX+10):(IX+17)),*) ScanStrt
!      Endif 
!      IX = INDEX(Buf1,'DUR (S):')
!      If (IX .gt. 0) Then
!       Read(Buf1(5:IX-1),*) ScanNum
!       Read(Buf1((IX+8):(IX+17)),*) ScanDur
!      Endif 
!      IX = INDEX(Buf1,'NUM PHS CTRS:')
!      If (IX .gt. 0) Then
!       Read(Buf1(5:IX-1),*) ScanNum
!       Read(Buf1((IX+13):(IX+16)),*) NumPhCntr
!      Endif 
!     Endif 
!^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
!
      If (Buf1(1:9).eq.'NUM EOPS:') Read(Buf1(10:30),*) NumEOP
!vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv 
      If (Buf1(1:3).eq.'EOP') Then
       IX = INDEX(Buf1,'TIME (mjd):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) EopNum
        Read(Buf1((IX+11):(IX+20)),*) EopTag(EopNum+1) 
       Endif 
       IX = INDEX(Buf1,'TAI_UTC (sec):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) EopNum
        Read(Buf1((IX+14):(IX+20)),*) TAIUTC(EopNum+1) 
       Endif 
       IX = INDEX(Buf1,'UT1_UTC (sec):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) EopNum
        Read(Buf1((IX+14):(IX+25)),*) UT1UTC(EopNum+1) 
       Endif 
       IX = INDEX(Buf1,'XPOLE (arcsec):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) EopNum
        Read(Buf1((IX+15):(IX+25)),*) XYWOB(1,EopNum+1) 
       Endif 
       IX = INDEX(Buf1,'YPOLE (arcsec):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) EopNum
        Read(Buf1((IX+15):(IX+25)),*) XYWOB(2,EopNum+1) 
       Endif 
      Endif 
!^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
!
!vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv 
      If (Buf1(1:15).eq.'NUM SPACECRAFT:') Read(Buf1(16:30),*) NumSpace
       If (Buf1(1:6).eq.'FRAME:') Read(Buf1(21:24),*) SpFrame 
      If (Buf1(1:10).eq.'SPACECRAFT') Then
       IX = INDEX(Buf1,'NAME:')
       If (IX .gt. 0) Then
        Read(Buf1(11:IX-1),*) SpNum
!       Read(Buf1((IX+5):(IX+30)),*) SpName(SpNum+1) 
        Sp26 = Buf1((IX+5):(IX+30)) 
        Sp26 = ADJUSTL(Sp26)
        SpName(SpNum+1) = Sp26(1:20)
!     write(6,*) 'NumSpace,SpNum,SpName(SpNum+1))', NumSpace,SpNum,SpName(SpNum+1)
       Endif 
       IX = INDEX(Buf1,'ROWS:')
       If (IX .gt. 0) Then
        Read(Buf1(11:IX-1),*) SpNum 
        Read(Buf1((IX+5):(IX+14)),*) Numrows(SpNum+1) 
!  Check for too many spacecraft positions.
           If (Numrows(SpNum+1) .gt. NF_row) Then
            Write(6,1031) Numrows(SpNum+1), NF_row
 1031       Format(/,' Number of spacecraft position rows = ',I4,/,     &
     &            ' The current limit is ',I4,/,' Increase the value ', &
     &            'of NF_row in d_input.i ',/)
            Stop 
           Endif
          Do I = 1, Numrows(SpNum+1)
            Read(Unit1,'(A200)',end=200) Buf1
             If (Buf1(1:6).eq.'FRAME:') Then
               Read(Buf1(21:24),*) SpFrame
               Go to 190
             Endif
            IX = INDEX(Buf1,':')
            Read(Buf1(IX+1:200),*) SpTag(I,SpNum+1),SpPos(I,1,SpNum+1), &
     &       SpPos(I,2,SpNum+1),SpPos(I,3,SpNum+1), SpVel(I,1,SpNum+1), &
     &       SpVel(I,2,SpNum+1),SpVel(I,3,SpNum+1)
!             Shift time tags by t_offset if requested.
            If (SpOffset .eq. 'Offset  ')                               &
     &             SpTag(I,SpNum+1) = SpTag(I,SpNum+1) + t_offset
 190         Continue
          Enddo
       Endif 
      Endif 
!
!
       Go to 100
!
  200 Continue
!
      Close (Unit1)
!
! Setup WOBIF and UT1IF arrays:
      WOBIF(1) = EOPTag(1) + 2400000.5D0
!     WOBIF(2) = 1.0D0 
      WOBIF(2) = EOPTag(2) - EOPTag(1)
      WOBIF(3) = NumEop
!
      UT1IF(1) = EOPTag(1) + 2400000.5D0
!     UT1IF(2) = 1.0D0
      UT1IF(2) = EOPTag(2) - EOPTag(1)
      UT1IF(3) = NumEop
      UT1IF(4) = 1.0D0 
!
       Xintv(1) = JStart + 2400000.5D0
       Xintv(2) = JStop  + 2400000.5D0
!
!  Save leap seconds
       Xleap_sec = TAIUTC(1)
!
!  If multiple scans, get the total duration time.
!!!!   If(NumScans .gt. 1) ScanDur = ScanStrt + ScanDur
!
! Change XY-wobble to milli-arc-seconds
      Do J = 1, NumEOP
       UT1PT(J) = TAIUTC(J) - UT1UTC(J)
       XYWOB(1,J) = XYWOB(1,J) * 1.D3
       XYWOB(2,J) = XYWOB(2,J) * 1.D3
      Enddo
!
!  If Spacecraft mode, create SpcIF array
!     If (NumSpace .ge. 1) Then
!       SpcIF(1) = SpTag(1,1) + 2400000.5D0 
!       SpcIF(1) = SpTag(1,1) 
!         X_Sp = (SpTag(2,1) - SpTag(1,1))*86400.D0 + .01
!         I_Sp = X_Sp 
!       SpcIF(2) = I_Sp/86400.D0
!       SpcIF(3) = Numrows(1)
!      write(6,*) 'dGet_input: SpcIF,Numrows: ', SpcIF, Numrows(1)
! Set near field flag to geocentric coordinates. 
!  [Expand later to handle SSBC coordinates.] 
!       NF_flag = 'GC'
!     Endif 
!
      Numsrc = NUMSTR
!
!**   IF (Debug .eq. 'd') Then 
!!    Write(6,*) StartMJD, StartYr, StartMo, StartDay, StartHr,         &
!!   &           StartMin, StartSec
!!     Write(6,*) '      '
!     Write(6,*) ScanDur 
!      Write(6,*) '      '
!     Write(6,*) Numsit, (Sites(I), I=2, Numsit+1)
!      Write(6,*) '      '
!     Do I = 2, Numsit+1
!!     Write(6,*) I, Sites(I), Axis(I), SITAXO(I), SitXYZ(1,I),         &
!!   &            SitXYZ(2,I), SitXYZ(3,I)
!     Enddo
!
!     Write(6,*) 'Number of Sources: ', NUMSTR
!     Do I=1,NUMSTR
!      Write(6,*) I, SrcName(I), RADEC(1,I), RADEC(2,I)
!     Enddo
!!     Write(6,*) 'WOBIF ', WOBIF
!!     Write(6,*) 'UT1IF ', UT1IF
!     Do I = 1, NumEOP
!!     Write(6,*) I, UT1PT(I), XYWOB(1,I), XYWOB(2,I)
!     Enddo
!      Write(6,*) '      '
!!
!     If (NumSpace .ge. 1) Then
!      Write(6,*) 'SpcIF ', SpcIF
!      Write(6,*) 'X_Sp, I_Sp ', X_Sp, I_Sp
!      Write(6,*) '      '
!      Write(6,*) SpNum, SpName(1), Numrows(1)
!       Do I = 1, Numrows(1)
!        Write(6,*) SpTag(I,1), SpPos(I,1,1), SpPos(I,2,1),             &
!    &     SpPos(I,3,1), SpVel(I,1,1), SpVel(I,2,1),SpVel(I,3,1)
!       Enddo
!     Endif
!      Write(6,*) '      '
!**   Endif 
!
      Return
      End
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!

!!      !!! AEL -- Need to remove this
!!      SUBROUTINE GETCL(Calcfiles, IMfiles)
!!      IMPLICIT None
!!!
!!      INCLUDE 'd_input.i'
!!!       To variables:
!!!        3) Numjobs        - Number of .calc files that will be processed.
!!!!!!!    4) Base_mode      - Baseline mode: 'geocenter' or 'baseline'.
!!!!!!!                        Default is 'geocenter'  => not currently used.
!!!        5) L_time         - 'dont-solve' or 'solve' for light travel
!!!                            time from spacecraft. Default is 'dont-solve'. 
!!!        6) Atmdr          - 'Add-dry   ' or 'no-Add-dry' atmosphere. 
!!!        7) Atmwt          - 'Add-wet   ' or 'no-Add-wet' atmosphere. 
!!!
!!!   Local variables
!!!        1) Calcfiles(n)   - List of input .calc files
!!!        2) IMfiles(n)     - List of output .im files
!!!        3) calc_file - Input '----.calc' file name.
!!!        4) IM_file   - Output '----.im' file name.
!!!
!!!     Programmer - David Gordon Jan-Apr, 2013 
!!!                  David Gordon March 2015
!!!                  David Gordon June 2015
!!!
!!!     CHARACTER*40  calc_file_name, Jobname, IM_file_name
!!      CHARACTER*128 calc_file, IM_file
!!      CHARACTER*128 Calcfiles(2000), IMfiles(2000)
!!      CHARACTER*128 ch_cl
!!!     CHARACTER*10  Base_mode, L_time
!!      Real*8  t_offsec
!!      Integer*4 Iar, I, Ic, Index, isec, Int_poly, i1, Ix, Iskip
!!      Integer*4 ierr, Icm1, l_scr, get4unit, iv, Kjob
!!!
!!      Do I = 1,128
!!       calc_file(I:I) = ' '
!!       Jobname(I:I) =   ' '
!!       IM_file(I:I) =   ' '
!!      Enddo
!!!     calc_out_file =  'Null                                    '
!!      I_out = 0
!!      IM_out = 1
!!      SpOffset = 'NoOffset'
!!!  Defaults:
!!      Base_mode = 'geocenter ' 
!!      L_time = 'dont-solve'
!!      Atmdr  = 'Add-dry   '
!!      Atmwt  = 'Add-wet   '
!!      Verbose = 0
!!      t_offset = 0.D0
!!!     NF_model = 'Sekido  '
!!      NF_model = 'Duev    '
!!      DoStnPos = 0
!!      overwrite = 'no  '
!!      UVW = 'exact '
!!!   Interval between Calc runs (default is every 24 seconds 
!!!      for VLBA DiFX correlator).
!!      d_interval = 24.D0
!!      int_poly = 120
!!!   # of Calc epochs in each 2-minute interval
!!      epoch2m = (120.0001/d_interval) + 1
!!!     write (6,*) ' d_interval, epoch2m: ', d_interval, epoch2m 
!!!   # of input calc jobs
!!      Numjobs = 0
!!!
!!!   Find number of parameters on the command line
!!       Iar = IARGC()
!!!      write(6,*) '  '
!!!      write(6,*) ' GETCL/Iar =  ', Iar
!!! If no arguments, print out the help menu and terminate 
!!       If (Iar .eq. 0) Call USAGE()
!!        Iskip = 0
!!!
!!       Do I = 1, Iar
!!          If (Iskip .eq. 1) Then   ! Next argument already read
!!           Iskip = 0
!!           Go to 100
!!          Endif
!!        Call GETARG(I,ch_cl)
!!!
!!         Ic = Index(ch_cl,'.calc')
!!         If (Ic .ge. 2) Then
!!          Numjobs = Numjobs + 1
!!          Ijob = Ic-1
!!          Jobname(1:Ijob) = ch_cl(1:Ijob)
!!          Icalc = Ijob+5
!!          calc_file(1:Icalc) = ch_cl(1:Icalc) 
!!            Do Ix = Icalc+1, 128
!!             calc_file(Ix:Ix) = ' '
!!            Enddo
!!          IM_file(1:Ijob) = Jobname(1:Ijob)
!!!         IM_file(Ijob+1:Ijob+4) =  '.im'//CHAR(0)
!!          IM_file(Ijob+1:Ijob+3) =  '.im'
!!            Do Ix = Ijob+4, 128
!!             IM_file(Ix:Ix) = ' '
!!            Enddo
!!          Calcfiles(Numjobs) = calc_file
!!          IMfiles(Numjobs) = IM_file
!!          Go to 100
!!         Endif
!!!
!!         If (ch_cl(1:2) .eq. '-h') Call USAGE() 
!!         If (ch_cl(1:6) .eq. '--help') Call USAGE()
!!!        If (ch_cl(1:2) .eq. '-v') Verbose = 1
!!!        If (ch_cl(1:9) .eq. '--verbose') Verbose = 1
!!!        If (ch_cl(1:2) .eq. '-q') Verbose = -1
!!!        If (ch_cl(1:7) .eq. '--quiet') Verbose = -1
!!!        If (ch_cl(1:2) .eq. '-b') Base_mode = 'baseline  '
!!!        If (ch_cl(1:2) .eq. '-m') Base_mode = 'master-stn'
!!         If (ch_cl(1:3) .eq. '-lt') Then
!!            L_time = 'solve     '
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:4) .eq. '-dry') Then
!!            Atmdr  = 'no-Add-dry'
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:4) .eq. '-wet') Then
!!            Atmwt  = 'no-Add-wet'
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:2) .eq. '-S' .or. ch_cl(1:8) .eq. '--Sekido') Then
!!            NF_model = 'Sekido  '
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:2) .eq. '-R' .or. ch_cl(1:9) .eq. '--Ranging') Then
!!            NF_model = 'Ranging '
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:2) .eq. '-D' .or. ch_cl(1:6) .eq. '--Duev') Then
!!            NF_model = 'Duev    '
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:2) .eq. '-s' .or. ch_cl(1:6) .eq. '--stnpos') Then
!!            DoStnPos = 1
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:2) .eq. '-f') Then    ! force execution
!!            overwrite = 'yes '
!!!             write(6,*) ' Overwriting existing .im files! '
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:11) .eq. '-uncorr') Then   ! U,V,W: non-relativistic geometry 
!!            UVW = 'uncorr'
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:11) .eq. '-approx') Then   ! U,V,W: geometry with aberration 
!!            UVW = 'approx' 
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:11) .eq. '-exact ') Then   ! U,V,W: partial derivatives of delay
!!            UVW = 'exact '
!!            Go to 100
!!         Endif
!!         If (ch_cl(1:11) .eq. '-noatmo') Then   ! U,V,W: 'exact' but no atmosphere 
!!            UVW = 'noatmo'
!!            Go to 100
!!         Endif
!!
!!         If (ch_cl(1:2) .eq. '-v')  Then
!!           Call GETARG(I+1,ch_cl)
!!           Read(ch_cl,*,err=20) iv
!!           Verbose = iv
!!           Iskip = 1 
!!           Go to 100
!!  20        Continue
!!           Verbose = 1
!!           Go to 100
!!         Endif
!!!
!!         If (ch_cl(1:2) .eq. '-t') Then     
!!           Call GETARG(I+1,ch_cl)
!!           Read(ch_cl,*,err=22) t_offsec
!!           t_offset = t_offsec/86400.D0
!!           SpOffset = 'Offset  '
!!!          write(6,*) 't_offset ', SpOffset, t_offset
!!           Iskip = 1 
!!           Go to 100
!!         Endif
!!! Process all .calc files in the current directory
!!         If (ch_cl(1:3) .eq. 'all' .or. ch_cl(1:5) .eq. '--all' .or.    &
!!     &       ch_cl(1:1) .eq. '*') Then     
!!            If (I .ne. Iar) Then
!!             Write(6,*) ' *, all, or --all must be the last command line argument, Quitting!'
!!             Stop
!!            Endif
!!            If (Numjobs .ne. 0) Then
!!             Write(6,*) ' Illegal combination of jobs, Quitting! '
!!             Stop
!!            Endif
!!            l_scr = get4unit()
!!            Open(unit=l_scr,file='scr_file',status='unknown')
!!            Close(unit=l_scr,status='Delete')
!!           ierr = SYSTEM('ls *.calc > scr_file')
!!            Open(unit=l_scr,file='scr_file',status='old')
!! 60          Continue
!!              Read(l_scr,'(A128)',end=70) calc_file 
!!               Numjobs = Numjobs + 1 
!!               Calcfiles(Numjobs) = calc_file
!!               IM_file = calc_file
!!                Icm1 = Index(calc_file,'.calc')
!!               IM_file(Icm1:Icm1+5) = '.im   '
!!               IMfiles(Numjobs) = IM_file
!!               Go to 60
!! 70           Continue
!!!           Close(unit=l_scr,status='Delete')
!!            Close(unit=l_scr)
!!           Go to 110
!!         Endif
!!        
!!! If we are here, then there is an unrecognized argument.
!!  80    Continue
!!        Write (6,*) '  '
!!        Write (6,*) ' Unrecognized command line argument: ', ch_cl
!!        Write (6,*) ' Quitting!  '
!!        Write (6,*) '  '
!!        Stop
!!!       Call USAGE()
!!!
!! 100    Continue
!!       Enddo
!! 110   Continue
!!!       Write (6,*) '  '
!!!       Write (6,*) '  '
!!!         Do I = 1, Numjobs
!!!            Write (6,*) I,Calcfiles(I),IMfiles(I)
!!!         Enddo
!!!       Write (6,*) '  '
!!!       Write (6,*) '  '
!!!
!!! Check for no jobs
!!        If (Numjobs .eq. 0) Then
!!         Write (6,*) '  '
!!         Write (6,*) ' No jobs to process, Quitting! '
!!         Write (6,*) '  '
!!         Stop
!!        Endif
!!!
!!!       If (I_out .eq. 1) Then
!!!         calc_out_file(1:Ijob) = Jobname(1:Ijob)
!!!         calc_out_file(Ijob+1:Ijob+9) =  '.calc.out'
!!!         write (6,*) ' calc_out_file ', calc_out_file
!!!       Endif
!!!      write(6,*) ' Verbose ', Verbose
!!!
!!      Return
!! 22   Continue
!!       Write (6,*) 'Error reading time offset. Stopping. '
!!!      Write (6,*) 'Illegal epoch interval. Stopping. '
!!       Stop
!!      End
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      SUBROUTINE FixEpoch(JTAG, TAG_SEC)
      IMPLICIT None
!
      Real*8    TAG_SEC
      Integer*4 JTAG(5), Imin
      Integer IMNTHS(12)
      DATA IMNTHS /31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31/
!
!      Write (6,*) 'FixEpoch: ', JTAG, TAG_SEC
!
! Check for leap year
      IF(MOD(JTAG(1),4) .EQ. 0) IMNTHS(2) = 29
!
      IF (TAG_SEC .ge. 59.9999999) Then  ! Increment minutes
       Imin = TAG_SEC/60.D0 + .00001
       TAG_SEC = TAG_SEC - Imin*60.0D0
       JTAG(5) = JTAG(5) + Imin  ! minutes
        If (JTAG(5) .ge. 60) Then     ! Increment hours
         JTAG(5) = JTAG(5) - 60
         JTAG(4) = JTAG(4) + 1  ! hours
          If (JTAG(4) .ge. 24) Then     ! Increment days
           JTAG(4) = JTAG(4) - 24
           JTAG(3) = JTAG(3) + 1   ! days
            If (JTAG(3) .gt. IMNTHS(JTAG(2))) Then ! Increment month
             JTAG(3) = JTAG(3) - IMNTHS(JTAG(2))    ! days, should be 1
             JTAG(2) = JTAG(2) + 1   ! month
             If (JTAG(2) .gt. 12) Then               ! Increment year
              JTAG(2) = 1
              JTAG(1) = JTAG(1) + 1
             Else
              Return
             Endif                                   ! Increment year
            Else
             Return
            Endif                                  ! Increment month
          Else
           Return
          Endif                         ! Increment days
        Else
         Return
        Endif                         ! Increment hours
      ENDIF                              ! Increment minutes
!      Write (6,*) 'FixEpoch: ', JTAG, TAG_SEC
!
      Return
      End
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      SUBROUTINE FixEpoch2(JTAG, TAG_SEC)
      IMPLICIT None
!
      Real*8    TAG_SEC, Xmin, Xhr
      Integer*4 JTAG(5), Imin, Ihr
      Integer IMNTHS(12)
      DATA IMNTHS /31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31/
!
!      Write (6,*) 'FixEpoch2/Before: ', JTAG, TAG_SEC
!
! Check for leap year
      IF(MOD(JTAG(1),4) .EQ. 0) IMNTHS(2) = 29
!
      IF (TAG_SEC .ge. 59.9999999) Then  ! Reset seconds and increment minutes
       Xmin = TAG_SEC/60.D0 + .00001
       Imin = Xmin
       TAG_SEC = TAG_SEC - Imin*60.0D0
       JTAG(5) = JTAG(5) + Imin  ! minutes
      ENDIF
!
       If (JTAG(5) .ge. 60) Then     ! Reset minutes ana increment hours
        Xmin = JTAG(5)
        Xhr  = Xmin/60.D0
        Ihr  = Xhr
        JTAG(5) = JTAG(5) - Ihr * 60  ! minutes
        JTAG(4) = JTAG(4) + Ihr 
       Endif
!
          If (JTAG(4) .ge. 24) Then     ! Reset hours and increment days
           JTAG(4) = JTAG(4) - 24
           JTAG(3) = JTAG(3) + 1   ! days
            If (JTAG(3) .gt. IMNTHS(JTAG(2))) Then ! Increment month
             JTAG(3) = JTAG(3) - IMNTHS(JTAG(2))    ! days, should be 1
             JTAG(2) = JTAG(2) + 1   ! month
             If (JTAG(2) .gt. 12) Then               ! Increment year
              JTAG(2) = 1
              JTAG(1) = JTAG(1) + 1
             Else
              Return
             Endif                                   ! Increment year
            Else
             Return
            Endif                                  ! Increment month
          Else
           Return
          Endif                         ! Increment days
!
!      Write (6,*) 'FixEpoch2/After:  ', JTAG, TAG_SEC
!
      Return
      End
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      SUBROUTINE USAGE()
      IMPLICIT None
!
      Write(6,1001)
 1001 Format(/,' Program difxcalc: Calc 11 for the difx correlator.',/, &
     &  ' Send comments, suggestions, requests, etc to',                &
     &  ' David.Gordon-1@nasa.gov.  ',/ ,                               &
     &  ' ************** 2016 July 07 Version *************     ',//,   &
     &  ' Usage: difxcalc [options] <file1>  ',/,                       &
     &  ' or:    difxcalc [options] <file1> <file2> <file3> ... ',/,    &
     &  ' or:    difxcalc [options]  --all                      ',/,    &
     &  ' or:    difxcalc [options]  all                      ',/,      &
!    &  ' or:    difxcalc [options]  *                      ',//,       &
     &  ' <file1> <file2>, etc. should be .calc files.      ',//,       &
!    &  ' "*", "all" or "--all" processes all .calc files in the working',   &
     &  ' all or --all processes all .calc files in the working',       &
     &  ' directory (2000 max).                                 ',//,   &
     &  ' If the .calc file contains a spacecraft ephemeris, then',     &
     &  ' difxcalc will',/,'  switch to the near-field model.',//,      &
!    &  '  Uses the Sekido and Fukushima (2006) model for near-',       &
!    &  'field delays.  ',//,                                           &
     &  ' Options can include: ',/,                                     &
     &  '  --help ',/                                                   &
     &  '  -h                 Print this help and quit.    ',//,        &
!    &  '  --verbose ',/,                                               &
     &  '  -v                 Verbose: Small printout.          ',//,   &
!    &  '  -v 1               Verbose: Small printout.          ',//,   &
!    &  '  -v 2               Verbose: More printout.           ',/,    &
!    &  '  -v 3               Verbose: Much more printout.     ',//,    &
!    &  '  --quiet ',/,                                                 &
!    &  '  -q                 Be less verbose in operation.    ',//,    &
     &  '  -s                 Write station J2000 positions.    ',//,   &
     &  '  -dry               DO NOT ADD dry atm delays.      '/,       &
     &  '                     (Default is to ADD dry atm.)     ',//,    &
     &  '  -wet               DO NOT ADD wet atm delays.      '/,       &
     &  '                     (Default is to ADD wet atm.)     ',//,    &
!    &  '  -b                 Baseline mode. Do ALL baselines.  ',/,    &
!    &  '                     (Default is geocenter mode.)     ',//,    &
!    &  '  -m                 Master station mode. First       ',/,     &
!    &  '                     antenna to all others.           ',//,    &
!    &  '  -e <n>             Epoch interval. Default: 24 seconds. ',/, &
!    &  '                     Permitted values of n (seconds): ',/,     &
!    &  '                     1,2,3,4,5,6,8,10,12,15,20,24,30,60. ',//, &
!    &  '  -im                Turn OFF the .im file output.     ',/,    &
!    &  '                     (Default is to write a .im file.) ',//,   &
!    &  '  -o                 Write calc output to a           ',/,     &
!    &  '                     *.calc.out file.            ',//,         &
     &  '  -f                 Force execution, overwrite existing .im files.',//, &
     &  '  -uncorr            U,V,W: non-relativistic geometry.',//,    &
     &  '  -approx            U,V,W: n-r geometry with aberration.',//,  &
     &  '  -exact             U,V,W: partial derivatives (default).',//, &
     &  '  -noatmo            U,V,W: exact but no atmosphere.      ',//, &
     &  '  -S                 Use modified Sekido near-field model.',/, &
!    &  '  --Sekido           Use modified Sekido near-field model.',/, &
     &  '  -D                 Use Duev near-field model. (default)',/,  &
!    &  '  --Duev             Use Duev near-field model. (default)',/, &
     &  '  -R                 Use satellite ranging near-field model.',//, &
!    &  '  --Ranging          Use satellite ranging near-field model.',//, &
     &  '  -lt                Solve for light travel time.    ',/,      &
     &  '                     (Near-field mode only)      ',//,         &
     &  '  -t <offset>        Near-field ephemeris epoch offset.   ',/, &
     &  '                     (in seconds, Real or Integer)       ',//, &
     &  '                                                   ')
!
      Stop
      End
      SUBROUTINE PTDG (SITLAT, SITLON, SITRAD, WOBXR, WOBYR,            &
     &          TCTOCF, R2K, CENT, POLTDP, POLTDV, WOBXds, WOBYds)
      IMPLICIT None
!
! 4.    PTDG
!
! 4.1   PTDG PROGRAM SPECIFICATION
!
! 4.1.1 PTDG Is the Pole tide module geometry section. It calculates the
!       surface pole tide crustal displacements due to the oscillation of
!       the Earth's pole about a mean secular pole. The pole tide station
!       offsets are due to the solid Earth's response to the change in the
!       centrifugal force due to the change in the pole position. There may
!       be additional loading effects due to ocean pole tide effects, but
!       these are not well understood, and not modelled here.
!
!       Beginning with Calc 9.0, mean secular values for X-pole and Y-pole
!       are removed before computing the pole tide. Thus the long term effect
!       of pole tide, averaged over many Chandler cycles, should be null.
!       Previously, a small velocity, from the cumulative effect of the
!       secular movement of the pole, was imparted to each station.
!       (maximums of ~.1 mm/year Up, and ~.03 mm/year horizontally.) The
!       secular mean values of X-pole and Y-pole are computed as simple
!       linear functions of time:
!          NEW VALUES, from IERS Conventions (2003)
!         X-mean(arc-sec) = +0.054  + 0.00083*T
!         Y-mean(arc-sec) = +0.357  + 0.00395*T
!       where T = number of years since 2000. The value of Y-mean used
!       below will be the negative of the above, since the sign of Y-pole
!       is flipped in the wobble module. 2004.03.26
!
!       Update for Calc 11.0 from IERS Conventions (2010).
!       Before 2010, the mean pole is modeled using a third degree polynomial:
!          X_mean(arc-sec) = (55.974D-3 + 1.8243D-3*Tyr + .18413D-3*Tyr**2      
!                            + .007024D-3*Tyr**3)
!          Y_mean(arc-sec) = -(346.346D-3 + 1.7896D-3*Tyr - .10729D-3*Tyr**2 
!                            - .000908D-3*Tyr**3)
!       After 2010, a linear model is used:
!          X_mean(arc-sec) = (23.513D-3 + 7.6141D-3*Tyr)
!          Y_mean(arc-sec) = -(358.891D-3 - 0.6287D-3*Tyr)
!
!       An Lcode contribution ('PTOLDCON') to undo all the above is computed 
!       in PTDC. If both 'PTD CONT' and 'PTOLDCON' are applied in Solve, then
!       the result is a pole tide using the total X and Y polar motion offsets. 
!
! 4.1.2 RESTRICTIONS - MUST BE CALLED AFTER SITG, AND DIRNL TO ENSURE
!                      THAT ALL OF THE VARIABLES THAT PTDG USES HAVE THE
!                      CORRECT VALUE.
!
! 4.1.3 REFERENCES - IERS Technical Note 36, IERS Conventions (2010),
!                    chapter 7, pages 114-116 and Table 7.7.
!
! 4.2   PTDG PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!         INPUT VARIABLES:
!           1. SITLAT(2)     -  GEODETIC LATITUDE OF EACH SITE (RAD)
!           2. SITLON(2)     -  EAST LONGTIUDE OF EACH SITE (RAD)
!           3. SITRAD(2)     -  SPHERICAL EARTH RADIUS OF EACH SITE (M)
!           4. WOBXR         -  LONG PERIOD WOBBLE OFFSET ALONG GREENWICH
!                               MERIDIAN (RAD)
!           5. WOBYR         -  LONG PERIOD WOBBLE OFFSET ALONG LONGITUDE
!                               90 DEG EAST (RAD)
!           7. TCTOCF(3,3,2) -  THE ROTATION MATRIX WHICH ROTATES THE
!                               TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST
!                               FIXED REFERENCE SYSTEM AT EACH SITE
!           8. R2K(3,3,3)    -  THE COMPLETE CRUST FIXED TO J2000 ROTATION
!                               MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES
!                               (UNITLESS, 1/SEC, 1/SEC**2)
!           9. CENT          -  Number of Julian centuries elapsed since the
!                               epoch January 1.5, 2000. (centuries)
!         OUTPUT VARIABLES:
!           1. POLTDP(3,2)   -  THE CORRECTIONS TO THE J2000.0 GEOCENTRIC
!                               SITE POSITION VECTORS DUE TO POLE TIDAL
!                               EFFECTS AT EACH SITE. (M) [IN SOME CASES THIS
!                               IS ZEROED OUT DEPENDING ON THE VALUE OF THE
!                               POLE TIDE CONTROL FLAG KPTDC.]
!           2. POLTDV(3,2)   -  THE CORRECTIONS TO THE J2000.0 GEOCENTRIC
!                               SITE VELOCITY VECTORS DUE TO POLE TIDAL
!                               EFFECTS AT EACH SITE. (M/SEC) [IN SOME CASES
!                               THIS IS ZEROED OUT DEPENDING ON THE VALUE OF
!                               THE POLE TIDE CONTROL FLAG KPTDC.]
!
! 4.2.2 COMMON BLOCKS USED -
!
      Real*8  ZPLTDP(3,2), ZPLTDV(3,2), ZPLDPX(3,2), ZPLDVX(3,2),       &
     &        ZPLDPY(3,2), ZPLDVY(3,2), X_mean, Y_mean, DPTDP(2,2)
      COMMON / PTDCM / ZPLTDP, ZPLTDV, ZPLDPX, ZPLDVX, ZPLDPY, ZPLDVY,  &
     &                 X_mean, Y_mean, DPTDP
!            VARIABLES FROM:
!             1.  ZPLTDP(3,2) - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                               POSITION VECTORS DUE TO POLE TIDAL EFFECTS AT
!                               EACH SITE. (M)
!             2.  ZPLTDV(3,2) - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                               VELOCITY VECTORS DUE TO POLE TIDAL EFFECTS AT
!                               EACH SITE. (M/SEC)
!             3.  ZPLDPX(3,2) - The partial derivative of the ZPLTDP with
!                               respective to the X-wobble offset. (m/arcsec)
!             4.  ZPLDPY(3,2) - The partial derivative of the ZPLTDP with
!                               respective to the Y-wobble offset. (m/arcsec)
!             5.  ZPLDVX(3,2) - The partial derivative of the ZPLTDV with
!                               respective to the X-wobble offset.
!                               (m/sec/arcsec)
!             6.  ZPLDVY(3,2) - The partial derivative of the ZPLTDV with
!                               respective to the Y-wobble offset.
!                               (m/sec/arcsec)
!             7.  X_mean, Y_mean - The current mean secular offsets of the
!                               pole, using linear approximations in IERS
!                               Conventions (2003).
!
      Real*8            PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH /  PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!             VARIABLES 'FROM':
!               1. HALFPI -  PI/2.D0 (UNITLESS)
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1.  KPTDC  -  THE POLE TIDE MODULE FLOW CONTROL FLAG.
!              2.  KPTDD  -  THE POLE TIDE MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         then used downstream. Otherwise equals zero. For
!                         correlator usage.
!
! 4.2.3 PROGRAM SPECIFICATIONS -
      Real*8 TCDISP(3,2), CFDISP(3,2), COLAT(2), SITLAT(2), SITLON(2),  &
     &       SITRAD(2), TCTOCF(3,3,2), R2K(3,3,3), POLTDP(3,2),         &
     &       POLTDV(3,2), WOBXR, WOBYR, CENT,                           &
     &       TCDSPX(3,2), TCDSPY(3,2), Tyr, WOBXds, WOBYds
      Integer*4 L, I
!
! 4.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: DCOS, DSIN, VECRT
!
! 4.2.7 CONSTANTS USED - XLOVEH, XLOVEL, WOBXR, WOBYR
!
! 4.2.8 PROGRAM VARIABLES -
!       1. TCDISP(3,2) - THE TOPOCENTRIC EARTH CRUSTAL DISPLACEMENTS AT EACH
!                        SITE (M)
!       2. CFDISP(3,2) - THE CRUST FIXED GEOCENTRIC EARTH CRUSTAL DISPLACEMENTS
!                        AT EACH SITE.  (M)
!       3. COLAT(2)    - COLATITUDE AT EACH SITE (RAD)
!
! 4.2.9 PROGRAMMER - TOM HERRING   07/01/84
!                    DAVID GORDON  01/03/85 (ADDED FLAG 2 CODING)
!                    Jim Ryan      89.07.08 Documentation simplified.
!                    David Gordon  11/24/93 Local site gravity computation
!                                  copied from subroutine ETDG
!                    David Gordon 94.04.15 Changed to Implicit None
!                    David Gordon 94.04.27 Common block ETDCM changed (from
!                                 Earth tide module).
!                    David Gordon 98.06.24 Changed common block ETDCM to match
!                                 Earth tide module.
!                    David Gordon 98.08.04 Changed computations to match
!                                 1996 IERS Conventions; ETDCM not needed.
!                                 Put in mods for Geocenter site (pole tide
!                                 zeroed out).
!                    David Gordon 98.11.24 Added computations of the partial
!                                 derivatives of the pole tide displacement
!                                 w.r.t. X-pole and Y-pole. Partials added to
!                                 common block PTDCM.
!                    David Gordon 98.12.17 Added variable CENT and computations
!                                 for a mean pole X and Y offsets and their
!                                 removal from the pole tide correction.
!                    David Gordon 99.01.19 Added X_mean, Y_mean, and DPTDP to
!                                 Common /PTDCM/.
!                    David Gordon 2001.05.02 Corrected debug output code.
!                    Jim Ryan 2002.09 Interger*4 mods.
!                    David Gordon 2004.03.26 Update for IERS Conventions
!                                 (2003). Mean secular pole offsets revised.
!                    David Gordon Nov. 2012. Modified mean offsets and pole
!                                 tide computations for IERS Conventions 2010.
!
!     PTDG PROGRAM STRUCTURE
!
!     Compute the secular mean values of the X and Y pole positions
!      Year and fraction thereof from 2000.0
        Tyr = CENT*100.D0
!     Mean secular offsets (arc-seconds) [2003 Conventions]
!         X_mean = ( 0.054  + 0.00083*Tyr)
!         Y_mean = (-0.357  - 0.00395*Tyr)
!       Write(6,'("Old: Tyr,X_mean,Y_mean ",3F10.5)') Tyr,X_mean,Y_mean
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     Mean secular offsets (arc-seconds) [2010 Conventions]
        If (Tyr .le. 10.D0) Then
           X_mean = (55.974D-3 + 1.8243D-3*Tyr + .18413D-3*Tyr**2       &
     &            + .007024D-3*Tyr**3)
           Y_mean = -(346.346D-3 + 1.7896D-3*Tyr - .10729D-3*Tyr**2     &
     &            - .000908D-3*Tyr**3)
        Else
           X_mean = (23.513D-3 + 7.6141D-3*Tyr)
           Y_mean = -(358.891D-3 - 0.6287D-3*Tyr)
        Endif
!       Write(6,'("New: Tyr,X_mean,Y_mean ",3F10.5)') Tyr,X_mean,Y_mean
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     De-secularized X and Y (radians)
          WOBXds = WOBXR - X_mean*CONVDS
          WOBYds = WOBYR - Y_mean*CONVDS
!
!     The pole tide geometry for sites 1 and 2 are calculated
!      separately by running through a loop twice.
      DO 1200  L = 1,2
!
!      Check for Geocenter site:
        IF (L .eq. Nzero) Then
         Do i=1,3
           TCDISP(i,L) = 0.D0
           ZPLTDP(i,L) = 0.D0
           ZPLTDV(i,L) = 0.D0
           ZPLDPX(i,L) = 0.D0
           ZPLDVX(i,L) = 0.D0
           ZPLDPY(i,L) = 0.D0
           ZPLDVY(i,L) = 0.D0
         Enddo
         Go to 1200
        ENDIF
!
!       Compute the colatitude of the site
        COLAT(L) = HALFPI - SITLAT(L)
!
!   Compute the IERS Conventions (2010) topocentric displacements with
!    mean offsets removed.
!         Up
        TCDISP(1,L) = -33.D0 * DSIN( 2.D0*COLAT(L) ) * 1.D-3 *          &
     &              ( WOBXds*DCOS(SITLON(L)) + WOBYds*DSIN(SITLON(L)) ) &
     &              / CONVDS
!         East
        TCDISP(2,L) =   9.D0 * DCOS( COLAT(L) ) * 1.D-3 *               &
     &              ( WOBXds*DSIN(SITLON(L)) - WOBYds*DCOS(SITLON(L)) ) &
     &              / CONVDS
!         North
        TCDISP(3,L) =  9.D0 * DCOS( 2.D0*COLAT(L) ) * 1.D-3 *           &
     &              ( WOBXds*DCOS(SITLON(L)) + WOBYds*DSIN(SITLON(L)) ) &
     &              / CONVDS
!
!*       write(6,*), ' PTDG: WOBXds, WOBYds ', WOBXds, WOBYds
!*       write(6,*), ' PTDG: Up,East,North, ', TCDISP(1,L),TCDISP(2,L), &
!*   &               TCDISP(3,L)
!
!    Rotate the displacements to the crust fixed geocentric system.
        CALL VECRT ( TCTOCF(1,1,L), TCDISP(1,L), CFDISP(1,L) )
!    Rotate the crust fixed geocentric displacements to the J2000.0 system.
        CALL VECRT ( R2K(1,1,1), CFDISP(1,L), ZPLTDP(1,L) )
!    Compute the contribution to the J2000.0 velocities due to the
!    effect of the rotation of the earth.
        CALL VECRT ( R2K(1,1,2), CFDISP(1,L), ZPLTDV(1,L) )
!
!  Compute the partial derivatives of the displacements w.r.t. X and Y
!   Recall that the sign of Y-pole was reversed a while back. Units will
!   be meters/arc-sec.
!         Up
        TCDSPX(1,L) = -33.D0 * DSIN(2.D0*COLAT(L)) * 1.D-3 *            &
     &                 DCOS(SITLON(L))
        TCDSPY(1,L) = -33.D0 * DSIN(2.D0*COLAT(L)) * 1.D-3 *            &
     &                 DSIN(SITLON(L))
!         East
        TCDSPX(2,L) = 9.D0 * DCOS(COLAT(L)) * 1.D-3 * DSIN(SITLON(L))
        TCDSPY(2,L) = 9.D0 * DCOS(COLAT(L)) * 1.D-3 * (-DCOS(SITLON(L)))
!
!         North
        TCDSPX(3,L) = 9.D0 * DCOS( 2.D0*COLAT(L) ) * 1.D-3 *            &
     &                 DCOS(SITLON(L))
        TCDSPY(3,L) = 9.D0 * DCOS( 2.D0*COLAT(L) ) * 1.D-3 *            &
     &                 DSIN(SITLON(L))
!
!    Rotate to J2000 position and velocity offsets
        CALL VECRT ( TCTOCF(1,1,L),TCDSPX(1,L), CFDISP(1,L) )
        CALL VECRT ( R2K(1,1,1),   CFDISP(1,L), ZPLDPX(1,L) )
        CALL VECRT ( R2K(1,1,2),   CFDISP(1,L), ZPLDVX(1,L) )
!
        CALL VECRT ( TCTOCF(1,1,L),TCDSPY(1,L), CFDISP(1,L) )
        CALL VECRT ( R2K(1,1,1),   CFDISP(1,L), ZPLDPY(1,L) )
        CALL VECRT ( R2K(1,1,2),   CFDISP(1,L), ZPLDVY(1,L) )
!
!     Close the loop over the sites.
!
 1200 CONTINUE
!
!     Check KPTDC to determine if the pole tide module is to be turned off
!     and the contribution zeroed out.
      IF ( KPTDC .NE. 1 )  GO TO 300
      DO 220  L = 1,2
         DO 210  I = 1,3
            POLTDP(I,L) = 0.D0
            POLTDV(I,L) = 0.D0
            ZPLTDP(I,L) = 0.D0
            ZPLTDV(I,L) = 0.D0
            ZPLDPX(I,L) = 0.D0
            ZPLDVX(I,L) = 0.D0
            ZPLDPY(I,L) = 0.D0
            ZPLDVY(I,L) = 0.D0
  210    CONTINUE
  220 CONTINUE
!
  300 CONTINUE
!
!     Handle the normal case where the pole tide effect is to be applied
!     to the theoretical and is stored as a contribution.
      IF ( KPTDC .NE. 0 )  GO TO 400
      DO 320  L = 1,2
        DO 310  I = 1,3
          POLTDP(I,L) = ZPLTDP(I,L)
          POLTDV(I,L) = ZPLTDV(I,L)
  310   CONTINUE
  320 CONTINUE
!
  400 CONTINUE
!
!  Handle the case where the pole tide is stored as a contribution
!   but not applied to the theoretical.
      IF ( KPTDC .NE. 2 )  GO TO 500
      DO 420  L = 1,2
        DO 410  I = 1,3
          POLTDP(I,L) = 0.D0
          POLTDV(I,L) = 0.D0
  410   CONTINUE
  420 CONTINUE
!
!     Check KPTDD for debug output.
  500 Continue
!
      IF ( KPTDD .EQ. 0 ) GO TO 600
!
      WRITE ( 6, 9100 )
 9100 FORMAT ( /,1X, "Debug output for subroutine PTDG." )
!
      WRITE ( 6, 9200 ) TCDISP, CFDISP, POLTDP, POLTDV, SITLAT, &
     &    SITLON,  WOBXR, WOBYR, R2K, TCTOCF
!
 9200 FORMAT (1X, "TCDISP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "CFDISP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "POLTDP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "POLTDV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "SITLAT = ", 2 (  D30.16, 10X ), /, 1X,               &
     &            "SITLON = ", 2 (  D30.16, 10X ), /, 1X,               &
     &            "WOBXR  = ", D30.16, /, 1X,                           &
     &            "WOBYR  = ", D30.16, /, 1X,                           &
     &            "R2K    = ", 9 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "TCTOCF = ", 6 ( 3 ( D30.16, 10X ), /, 1X ) )
!
      Do 777 L = 1,2
       write (6,'(" ZPLTDP ",3f22.10)') ZPLTDP(1,L), ZPLTDP(2,L),       &
     &                                 ZPLTDP(3,L)
       write (6,'(" ZPLTDV ",3f22.10)') ZPLTDV(1,L), ZPLTDV(2,L),       &
     &                                 ZPLTDV(3,L)
       write (6,'(" ZPLDPX ",3f22.10)') ZPLDPX(1,L), ZPLDPX(2,L),       &
     &                                 ZPLDPX(3,L)
       write (6,'(" ZPLDVX ",3f22.10)') ZPLDVX(1,L), ZPLDVX(2,L),       &
     &                                 ZPLDVX(3,L)
       write (6,'(" ZPLDPY ",3f22.10)') ZPLDPY(1,L), ZPLDPY(2,L),       &
     &                                 ZPLDPY(3,L)
       write (6,'(" ZPLDVY ",3f22.10)') ZPLDVY(1,L), ZPLDVY(2,L),       &
     &                                 ZPLDVY(3,L)
       write (6,'(" TCDSPX ",3f22.10)') TCDSPX(1,L), TCDSPX(2,L),       &
     &                                 TCDSPX(3,L)
       write (6,'(" TCDSPY ",3f22.10)') TCDSPY(1,L), TCDSPY(2,L),       &
     &                                 TCDSPY(3,L)
 777  Continue
!     Normal conclusion.
  600 RETURN
      END
!*****************************************************************
      SUBROUTINE PTDP(STAR)
      IMPLICIT None
!
! 5.    PTDP
!
! 5.1   PTDP PROGRAM SPECIFICATION
!
! 5.1.1 PTDP is the pole tide module partials section. It computes the partial
!       derivatives with respect to the X-wobble and Y-wobble (X, Y in arc
!       seconds)
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!            VARIABLES 'FROM':
!              1. VLIGHT  -  THE VELOCITY OF LIGHT IN VACUUM.  (M/SEC)
!
      Real*8  ZPLTDP(3,2), ZPLTDV(3,2), ZPLDPX(3,2), ZPLDVX(3,2),       &
     &        ZPLDPY(3,2), ZPLDVY(3,2), X_mean, Y_mean, DPTDP(2,2)
      COMMON / PTDCM / ZPLTDP, ZPLTDV, ZPLDPX, ZPLDVX, ZPLDPY, ZPLDVY,  &
     &                 X_mean, Y_mean, DPTDP
!            VARIABLES FROM:
!             1. ZPLTDP(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                               POSITION VECTORS DUE TO POLE TIDAL EFFECTS AT
!                               EACH SITE. (M)
!             2. ZPLTDV(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                               VELOCITY VECTORS DUE TO POLE TIDAL EFFECTS AT
!                               EACH SITE. (M/SEC)
!             3. ZPLDPX(3,2)  - The partial derivative of the ZPLTDP with
!                               respective to the X-wobble offset. (m/arcsec)
!             4. ZPLDPY(3,2)  - The partial derivative of the ZPLTDP with
!                               respective to the Y-wobble offset. (m/arcsec)
!             5. ZPLDVX(3,2)  - The partial derivative of the ZPLTDV with
!                               respective to the X-wobble offset.
!                               (m/sec/arcsec)
!             6. ZPLDVY(3,2)  - The partial derivative of the ZPLTDV with
!                               respective to the Y-wobble offset.
!                               (m/sec/arcsec)
!            VARIABLES TO:
!               1. DPTDP(2,2) - The pole tide partial derivatives of the delay
!                               the delay rate w.r.t. X-pole and Y-pole. First
!                               index runs over the delay partial w.r.t. X and
!                               Y, second runs over rate partial w.r.t X and Y.
!                               (seconds/arcsecond, seconds/sec/arcsec)
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KPTDC  -  THE POLE TIDE MODULE FLOW CONTROL FLAG.
!              2. KPTDD  -  THE POLE TIDE MODULE DEBUG OUTPUT FLAG.
!
! 5.2.3 PROGRAM SPECIFICATIONS -
      Real*8 STAR(3)
!
! 5.2.4 DATA BASE ACCESS => PUT ('PTDXYPAR') moved to PUT_P.
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVR
!             CALLED SUBROUTINES: DOTP, VECSB
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES -
!          1. BASCRX(3,2) - The partial derivative of the J2000 baseline
!                           position and velocity vectors w.r.t to the X-pole
!                           offset. (m/arcsec, m/sec/arcsec)
!          2. BASCRY(3,2) - The partial derivative of the J2000 baseline
!                           position and velocity vectors w.r.t to the Y-pole
!                           offset. (m/arcsec, m/sec/arcsec)
!
! 5.2.9 PROGRAMMER -
!       David Gordon 11.24.98 Code added to compute delay and rate pole
!                    tide partials w.r.t. X-pole and Y-pole.
!       David Gordon 99.01.19 Added X_mean, Y_mean, and DPTDP to Common /PTDCM/
!                    for use in contribution section.
!       Jim Ryan 2002.09 Interger*4 mods.
!       David Gordon Jan. 2013  Moved PUT to subroutine PUT_P.
!
       Real*8 BASCRX(3,2), BASCRY(3,2), DOTP
!
!  Compute the partials.
!
!  Compute the partials w.r.t. X and Y of the J2000.0 baseline position and
!   velocity vectors due to pole tide effects
      CALL VECSB ( ZPLDPX(1,1), ZPLDPX(1,2), BASCRX(1,1) )
      CALL VECSB ( ZPLDVX(1,1), ZPLDVX(1,2), BASCRX(1,2) )
      CALL VECSB ( ZPLDPY(1,1), ZPLDPY(1,2), BASCRY(1,1) )
      CALL VECSB ( ZPLDVY(1,1), ZPLDVY(1,2), BASCRY(1,2) )
!
!  Complete the calculation of the partials.
        DPTDP(1,1) =  DOTP ( BASCRX(1,1), STAR ) / VLIGHT
        DPTDP(1,2) =  DOTP ( BASCRX(1,2), STAR ) / VLIGHT
        DPTDP(2,1) = -DOTP ( BASCRY(1,1), STAR ) / VLIGHT
        DPTDP(2,2) = -DOTP ( BASCRY(1,2), STAR ) / VLIGHT
!
!
!  Check KPTDD for debug output.
      IF ( KPTDD .EQ. 0 ) GO TO 500
      WRITE ( 6, 9100 )
 9100 FORMAT ( /,1X, "Debug output for subroutine PTDC ",/)
      WRITE(6,9200) ZPLDPX,ZPLDVX,BASCRX,ZPLDPY,ZPLDVY,BASCRY,STAR,DPTDP
 9200 FORMAT (1X, "ZPLDPX = ", 2 ( 3 ( D25.16, 1X ), /, 1X ),           &
     &            "ZPLDVX = ", 2 ( 3 ( D25.16, 1X ), /, 1X ),           &
     &            "BASCRX = ", 2 ( 3 ( D25.16, 1X ), /, 1X ),           &
     &            "ZPLDVY = ", 2 ( 3 ( D25.16, 1X ), /, 1X ),           &
     &            "ZPLDVY = ", 2 ( 3 ( D25.16, 1X ), /, 1X ),           &
     &            "BASCRY = ", 2 ( 3 ( D25.16, 1X ), /, 1X ),           &
     &            "STAR   = ",     3 ( D25.16, 1X ), /, 1X,             &
     &            "DPTDP  = ",     4 ( D25.16, 1X ) )
!
!  Normal conclusion.
!
  500 RETURN
      END
!********************************************************************
      SUBROUTINE PTDC ( STAR )
      IMPLICIT None
!
! 6.    PTDC
!
! 6.1   PTDC PROGRAM SPECIFICATION
!
! 6.1.1 PTDC IS THE POLE TIDE MODULE CONTRIBUTION SECTION. IT COMPUTES
!       THE CONTRIBUTION TO THE DELAY AND THE DELAY RATE DUE TO POLE
!       TIDE EFFECTS.
!
! 6.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. STAR(3)  -  THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!
! 6.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!            VARIABLES 'FROM':
!              1. VLIGHT - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. DPTDC(2)   - THE POLE TIDE CONTRIBUTION TO THE DELAY AND TO
!                          THE DELAY RATE (SEC, SEC/SEC)
!          2. PTOLD(2)   - The contribution that will effectively convert
!                          the pole tides to the non-mean-offset-removed
!                          values, i.e. to the old (Calc 8.2 and earlier
!                          versions) values.
!
      Real*8  ZPLTDP(3,2), ZPLTDV(3,2), ZPLDPX(3,2), ZPLDVX(3,2),       &
     &        ZPLDPY(3,2), ZPLDVY(3,2), X_mean, Y_mean, DPTDP(2,2)
      COMMON / PTDCM / ZPLTDP, ZPLTDV, ZPLDPX, ZPLDVX, ZPLDPY, ZPLDVY,  &
     &                 X_mean, Y_mean, DPTDP
!            VARIABLES FROM:
!             1. ZPLTDP(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                               POSITION VECTORS DUE TO POLE TIDAL EFFECTS AT
!                               EACH SITE. (M)
!             2. ZPLTDV(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                               VELOCITY VECTORS DUE TO POLE TIDAL EFFECTS AT
!                               EACH SITE. (M/SEC)
!             3. ZPLDPX(3,2)  - The partial derivative of the ZPLTDP with
!                               respective to the X-wobble offset. (m/arcsec)
!             4. ZPLDPY(3,2)  - The partial derivative of the ZPLTDP with
!                               respective to the Y-wobble offset. (m/arcsec)
!             5. ZPLDVX(3,2)  - The partial derivative of the ZPLTDV with
!                               respective to the X-wobble offset.
!                               (m/sec/arcsec)
!             6. ZPLDVY(3,2)  - The partial derivative of the ZPLTDV with
!                               respective to the Y-wobble offset.
!                               (m/sec/arcsec)
!             7. X_mean, Y_mean-The current mean offsets of the pole, using
!                               Harald Schuh's formula.
!             8. DPTDP(2,2)   - The pole tide partial derivatives of the delay
!                               the delay rate w.r.t. X-pole and Y-pole. First
!                               index runs over the delay partial w.r.t. X and
!                               Y, second runs over rate partial w.r.t. X and Y.
!                               (seconds/arcsecond, seconds/sec/arcsec)
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KPTDC  -  THE POLE TIDE MODULE FLOW CONTROL FLAG.
!              2. KPTDD  -  THE POLE TIDE MODULE DEBUG OUTPUT FLAG.
!
! 6.2.3 PROGRAM SPECIFICATIONS -
!**   Real*8 BASCOR(3,2), DPTDC(2), STAR(3), DOTP, PTOLD(2), PTOFF(2)
      Real*8 BASCOR(3,2),           STAR(3), DOTP,           PTOFF(2)
      Integer*4 K
!
! 6.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVR
!             CALLED SUBROUTINES: DOTP, VECSB
!
! 6.2.7 CONSTANTS USED - VLIGHT
!
! 6.2.8 PROGRAM VARIABLES -
!       1. BASCOR(3,2) - THE CORRECTION TO THE J2000.0 BASELINE POSITION AND
!                        VELOCITY VECTORS DUE TO THE POLE TIDE. (M, M/S)
!
! 6.2.9 PROGRAMMER - TOM HERRING   07/01/84
!                    DAVID GORDON  08/24/84  (ADDED SOME DEBUG)
!                    DAVID GORDON  01/03/85  (ADDED ZPLTDP AND ZPLTDV)
!                    Jim Ryan      89.07.08 Documentation simplified.
!                    Jim Ryan      89:10:05 CPHYS common made an include file.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                             implimented.
!                    David Gordon 94.04.15 Changed to Implicit None
!                    D. Gordon 99.01.19 Added X_mean, Y_mean, and DPTDP to
!                             Common /PTDCM/. Added calculation and PUT for
!                             the contribution to put back in the mean pole
!                             tide correction, Lcode 'PTOLDCON'.
!                    Jim Ryan 2002.09 Interger*4 mods.
!                    David Gordon 2004.08.11 Mean secular offsets removed
!                                 from the default. Contribution to restore
!                                 them computed in PTDC.
!                    David Gordon Jan. 2013  Moved PUT's to subroutine PUT_C.
!
!     PTDC PROGRAM STRUCTURE
!
!     Compute the contributions.
!
!  Compute the corrections to the J2000.0 baseline position and
!   velocity vectors due to pole tidal effects.
      CALL VECSB ( ZPLTDP(1,1), ZPLTDP(1,2), BASCOR(1,1) )
      CALL VECSB ( ZPLTDV(1,1), ZPLTDV(1,2), BASCOR(1,2) )
!  Complete the calculation of the contributions.
      DO 120  K = 1,2
        DPTDC(K) = DOTP ( BASCOR(1,K), STAR ) / VLIGHT
  120 CONTINUE
!
!  Compute the delay and rate contributions to restore the secular
!   mean offsets that were removed in the geometry section. Need to
!   reverse the Y_mean sign.
        PTOLD(1) = X_mean*DPTDP(1,1) -  Y_mean*DPTDP(2,1)
        PTOLD(2) = X_mean*DPTDP(1,2) -  Y_mean*DPTDP(2,2)
!  Compute the delay and rate contributions needed to apply the
!   mean offsets computed in the geometry section.
!   Need to reverse the Y_mean sign.
!xx     PTOFF(1) = -(X_mean*DPTDP(1,1) -  Y_mean*DPTDP(2,1))
!xx     PTOFF(2) = -(X_mean*DPTDP(1,2) -  Y_mean*DPTDP(2,2))
!
!        print *,'PTDC: DPTDC(psec) ', DPTDC(1)*1.D12, DPTDC(2)*1.D12
!        print *,'PTDC: PTOFF(psec) ', PTOFF(1)*1.D12, PTOFF(2)*1.D12
!
!  Check KPTDD for debug output.
      IF ( KPTDD .EQ. 0 ) GO TO 500
      WRITE ( 6, 9100 )
 9100 FORMAT ( /,1X, "Debug output for subroutine PTDC ",/)
      WRITE ( 6, 9200 )  ZPLTDP, ZPLTDV, BASCOR, STAR, DPTDC
 9200 FORMAT (1X, "ZPLTDP = ", 2 ( 3 ( D25.16, 5X ), /, 1X ),           &
     &            "ZPLTDV = ", 2 ( 3 ( D25.16, 5X ), /, 1X ),           &
     &            "BASCOR = ", 2 ( 3 ( D25.16, 5X ), /, 1X ),           &
     &            "STAR   = ",     3 ( D25.16, 5X ), /, 1X,             &
     &            "DPTDC  = ",     2 ( D25.16, 5X ), /, 1X,             &
     &            "PTOLD  = ",     2 ( D25.16, 5X ) )
!
!  Normal conclusion.
  500 RETURN
      END
!
!***************************************************************************
      SUBROUTINE OPTLG(WOBXds, WOBYds, OPTLcoef, R2K6, TCTOCF, TSKIP,   &
     &                OPTLOADP,OPTLOADV)
      Implicit None
!
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
!          Variables "From":
!            1. PI     - THE MATHEMATICAL CONSTANT PI (UNITLESS)
!            2. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS (RAD/DEG)
!            3. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                        (RAD/ARCSECOND)
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         then used downstream. Otherwise equals zero. For
!                         correlator usage.
!
!     Real*8 CT,Xpole,Ypole,Vsite,Vlon,Vlat,u_rR,u_rI,u_nR,        &
!    &       u_nI,u_eR,u_eI,U_up,U_north,U_east
      Real*8 U_up,U_north,U_east
      Real*8 GEE,  a_E, rho_w, Omega, gee_e, GM
      Real*8 H_p, Kay, Gamma2R,  Gamma2I, Xbar_p, Ybar_p, m1, m2, XT
      Real*8 WOBXds, WOBYds, OPTLcoef(6,2), R2K6(3,3,3), TCTOCF(3,3,2), &
     &       OPTLOADP(3,2),OPTLOADV(3,2)
      Real*8 TCoff(3,2), CFDISP(3,2)
      Integer*4 Ifirst, TSKIP, L
!     Save PI, CONVD , GEE,  a_E, rho_w, Omega, gee_e, GM,      &
!    &     H_p, Kay,  Gamma2R, Gamma2I 
      Save  H_p, Kay, Ifirst
!      
!     DATA  PI  /3.1415926535897932D0/,          &
!    &      CONVD  /1.7453292519943296D-02/,     &
!    &      CONVDS /4.8481368110953599D-06/,     &
      DATA  GEE    /6.673D-11/,                  &
     &      a_E    /6378136.6D0/,                &
     &      rho_w  /1025.0D0/,                   &
     &      Omega  /7.292115D-5/,                &
     &      gee_e  /9.7803278/,                  &
     &      GM     /3.986004418D14/,             &
     &      Gamma2R  /0.6870D0/                  &
     &      Gamma2I  /0.0036D0/                  &
     &      Ifirst /0/  
!
!      Modifications:
!       Nov/Dec 2012 D.Gordon 
!
        Ifirst = Ifirst+1 
!
       IF (Ifirst .eq. 1) Then 
        H_p = DSQRT(8.D0*PI/15.D0) * ( (Omega**2 * a_E**4) / GM ) 
        Kay = (4.D0 * PI * GEE * a_E * rho_w * H_p)/(3.D0*gee_e)
!         write(6,*), ' OCPT: H_p, Kay ',  H_p, Kay 
       Endif 

!
!      m1 =  (Xpole - Xbar_p) * CONVDS
!      m2 = -(Ypole - Ybar_p) * CONVDS
!        write(6,*), 'OPTLG: m1, m2 ',  m1, m2 
!
        m1 = WOBXds
        m2 = WOBYds 
!        write(6,*), 'OPTLG: m1, m2 ',  m1, m2 
!
!  Loop over both stations
      DO L = 1,2
!
!      Check for Geocenter site:
        IF (L .eq. Nzero) Then
          TCoff(1,L) = 0.0D0
          TCoff(2,L) = 0.0D0
          TCoff(3,L) = 0.0D0
         Go to 120
        ENDIF
!
!  Ocean pole tide offsets, in meters:
       U_up    = Kay * ( ((m1*Gamma2R + m2*Gamma2I) * OPTLcoef(1,L)) +  &
     &               ((m2*Gamma2R - m1*Gamma2I) * OPTLcoef(2,L))  )
       U_north = Kay * ( ((m1*Gamma2R + m2*Gamma2I) * OPTLcoef(3,L)) +  &
     &               ((m2*Gamma2R - m1*Gamma2I) * OPTLcoef(4,L))  )
       U_east  = Kay * ( ((m1*Gamma2R + m2*Gamma2I) * OPTLcoef(5,L)) +  &
     &               ((m2*Gamma2R - m1*Gamma2I) * OPTLcoef(6,L))  )
! 
!        write(6,*), '                     '
!        write(6,*), 'OPTLG: WOBXds, WOBYds(rad) ', WOBXds, WOBYds
!        write(6,*), 'OPTLG: Up,North,East(m)    ', U_up,U_north,U_east
!
!  Up, East, North
       TCoff(1,L) = U_up
       TCoff(2,L) = U_east
       TCoff(3,L) = U_north
!
 120  Continue
!
!    Rotate the displacements to the crust fixed geocentric system.
        CALL VECRT ( TCTOCF(1,1,L), TCoff (1,L), CFDISP(1,L) )
!    Rotate the crust fixed geocentric displacements to the J2000.0 system.
        CALL VECRT ( R2K6(1,1,1), CFDISP(1,L), OPTLOADP(1,L) )
!    Compute the contribution to the J2000.0 velocities due to the
!    effect of the rotation of the earth.
        CALL VECRT ( R2K6(1,1,2), CFDISP(1,L), OPTLOADV(1,L) )
!        write(6,*), ' OPTLG: OPTLOADP: ', OPTLOADP(1,L), OPTLOADP(2,L), &
!    &                                    OPTLOADP(3,L)
!        write(6,*), ' OPTLG: OPTLOADV: ', OPTLOADV(1,L), OPTLOADV(2,L), &
!    &                                    OPTLOADV(3,L)
!        write(6,*), '                     '
!
      ENDDO
!
      Return
      End
!
!********************************************************************
!
      SUBROUTINE OPTLC (OPTLOADP, OPTLOADV, STAR )
      IMPLICIT None
!
! 6.    OPTLC
!
! 6.1   OPTLC PROGRAM SPECIFICATION
!
! 6.1.1 OPTLC IS THE OCEAN POLE TIDE MODULE CONTRIBUTION SECTION. IT COMPUTES
!       THE CONTRIBUTION TO THE DELAY AND THE DELAY RATE DUE TO OCEAN POLE
!       TIDE EFFECTS.
!
! 6.2.1 CALLING SEQUENCE -
!         INPUT VARIABLES:
!           1. STAR(3)       - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!           2. OPTLOADP(3,2) - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                              POSITION VECTORS DUE TO OCEAN POLE TIDAL EFFECTS
!                              EACH SITE. (M)
!           3. OPTLOADV(3,2) - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                              VELOCITY VECTORS DUE TO OCEAN POLE TIDAL EFFECTS
!                              EACH SITE. (M/sec)
!
! 6.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1.  KPTDC  -  THE POLE TIDE MODULE FLOW CONTROL FLAG.
!              2.  KPTDD  -  THE POLE TIDE MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cphys11.i'
!            VARIABLES 'FROM':
!           1. VLIGHT - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. DOPTLC(2) - THE OCEAN POLE TIDE CONTRIBUTION TO THE DELAY AND TO
!                         THE DELAY RATE (SEC, SEC/SEC)
!
! 6.2.3 PROGRAM SPECIFICATIONS -
      Real*8 BASCOR(3,2), STAR(3), DOTP, OPTLOADP(3,2), OPTLOADV(3,2)
      Integer*4 L
!
! 6.2.4 DATA BASE ACCESS => Moved to PUT_C ('OPTLCONT'/DOPTLC).  
!
! 6.2.6 SUBROUTINE INTERFACE -
!         CALLER SUBROUTINES: DRIVR
!         CALLED SUBROUTINES: DOTP, VECSB
!
! 6.2.7 CONSTANTS USED - VLIGHT
!
! 6.2.8 PROGRAM VARIABLES -
!          1. BASCOR(3,2) - THE CORRECTION TO THE J2000.0 BASELINE POSITION AND
!                           VELOCITY VECTORS DUE TO THE OCEAN POLE TIDE. (M, M/S)
!
! 6.2.9 PROGRAMMER - David Gordon  December 2012
!
!
!     Compute the contributions.
!
!  Compute the corrections to the J2000.0 baseline position and
!   velocity vectors due to pole tidal effects.
      CALL VECSB ( OPTLOADP(1,1), OPTLOADP(1,2), BASCOR(1,1) )
      CALL VECSB ( OPTLOADV(1,1), OPTLOADV(1,2), BASCOR(1,2) )
!  Complete the calculation of the contributions.
      DO L = 1,2
        DOPTLC(L) = DOTP(BASCOR(1,L),STAR)/VLIGHT
      ENDDO 
!
!       print *,'OPTLC: DOPTLC(psec) ', DOPTLC(1)*1.D12,DOPTLC(2)*1.D12
!
!  Check KPTDD for debug output.
      IF ( KPTDD .EQ. 0 ) GO TO 500
      WRITE ( 6, 9100 )
 9100 FORMAT ( /,1X, "Debug output for subroutine PTDC ",/)
      WRITE ( 6, 9200 ) OPTLOADP,OPTLOADV,BASCOR, STAR, DOPTLC
 9200 FORMAT (1X, "OPTLOADP = ", 2 ( 3 ( D25.16, 5X ), /, 1X ),           &
     &            "OPTLOADV = ", 2 ( 3 ( D25.16, 5X ), /, 1X ),           &
     &            "BASCOR   = ", 2 ( 3 ( D25.16, 5X ), /, 1X ),           &
     &            "STAR     = ",     3 ( D25.16, 5X ), /, 1X,             &
     &            "DOPTLC   = ",     2 ( D25.16, 5X ), /, 1X)
!
!  Normal conclusion.
  500 RETURN
      END
      SUBROUTINE TERMINATE_CALC ( LNAME, I1, I2 )
      IMPLICIT None
!
! 1.     TERMINATE_CALC
!
! 1.1    TERMINATE_CALC PROGRAM SPECIFICATION
!
! 1.1.1  TERMINATE_CALC IS THE UTILITY ROUTINE WHICH TERMINATES THE CALC
!        PROGRAM IF A DATA BASE INTERFACE ERROR IS DETECTED IN THE PROGRAM.
!
! 1.2    TERMINATE_CALC PROGRAM INTERFACE
!
! 1.2.1  CALLING SEQUENCE -
!
!        INPUT VARIABLES:
!          1. I1       -  THE NUMBER OF THE DATA BASE INTERFACE ERROR FLAG
!                         WHICH CAUSED THE TERMINATE_CALC.
!          2. I2       -  THE VALUE RETURNED BY THE DATA BASE ERROR RETURN
!                         FLAG.
!          3. LNAME(3) -  THE NAME OF THE SUBROUTINE IN WHICH THE PROGRAM
!                         TERMINATED.
!
! 1.2.2 COMMON BLOCKS USED - CON
!
      INCLUDE 'ccon.i'
!
! 1.2.3  PROGRAM SPECIFICATIONS -
!
      INTEGER*2  LNAME(3),IPAR(5), I1, I2
      CHARACTER*10 IPAR_C
      EQUIVALENCE (IPAR,IPAR_C)
!
! 1.2.4  DATA BASE ACCESS -  NONE
!
! 1.2.5  EXTERNAL INPUT/OUTPUT -
!               INPUT VARIABLES:  NONE
!               OUTPUT VARIABLES: THE PROGRAM TERMINATION MESSAGE
!
! 1.2.6  SUBROUTINE INTERFACE -
!              CALLER SUBROUTINES: ALL ROUTINES WITH DATA BASE INTERFACES.
!              CALLED SUBROUTINES: NONE
!
! 1.2.7  CONSTANTS USED - NONE
!
! 1.2.8  PROGRAM VARIABLES -   NONE
!
! 1.2.9  PROGRAMMER - DALE MARKHAM  01/20/77
!                     PETER DENATALE 07/18/77
!                     BRUCE SCHUPLER 01/11/80
!                     SAVITA GOEL    06/04/87 (CDS FOR A900)
!                     Jim Ryan 90.01.26  QUIT_CALC implemented.
!                     David Gordon 94.04.12 Edit termination message for Calc 8.
!                     David Gordon 94.04.14 Change to Implicit none.
!                     Jim Ryan Sept 2002 Integer*2/4 mods.
!
! 1.3    TERMINATE_CALC PROGRAM STRUCTURE
!
!    WRITE OUT THE MESSAGE WHICH INDICATES THE PROGRAM HAS BEEN TERMINATED.
      WRITE( 6, 9000 ) LNAME, I1, I2
 9000 FORMAT (1X, "CALC has terminated in subroutine ", 3A2, &
     &        ',', 'KERR(', I1, ') = ', I2, '.' )
!
!
!   TERMINATE THE PROGRAM.
!     IPAR_C = 'CALC Fail '
!     CALL QUIT_CALC(IPAR)
!
      STOP
      END
      SUBROUTINE OCEG (CFSITE, UT1, OCEAMP, OCEPHS, R2000, XJD, TCTOCF, &
     &                 TSKIP, FA2K, CENT, UTC, XLOADP, XLOADV)
      IMPLICIT None
!
!     OCEG is the ocean loading geometry section.
!
!     References -
!       1. Merit Standards, April 1981, Second draft, Appendices 7 and 11.
!       2. C.C.GOAD, J. GEOPHYS. RES., 85, P.2679-2683, MAY 1980.
!       3. IERS Conventions (2010).
!
!     OCEG program interfaces -
!
!       CALLING SEQUENCE -
!
!       INPUT VARIABLES:
!         1. CFSITE(3,2)  - THE CRUST FIXED SITE VECTORS AT EACH OBSERVATION
!                           SITE. (M)
!         2. UT1          - THE UT1 TIME OF THE DAY. (SEC)
!         3. OCEAMP(11,3,2) - OCEAN LOADING AMPLITUDES FOR 11 TIDES AT EACH
!                             OBSERVATION SITE. (M)
!                  ( J,K,L)      K=1 : VERTICAL
!                                K=2 : EAST-WEST
!                                K=3 : NORTH-SOUTH DIRECTION
!         4. OCEPHS(11,3,2) - OCEAN LOADING PHASES. (RAD)
!         5. R2000(3,3,3) - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION MATRIX
!                           AND ITS FIRST TWO CT TIME DERIVATIVES.
!                           (UNITLESS,1/SEC,1,SEC**2)
!         6. XJD          - THE JULIAN DATE AT ZERO HOURS UTC OF THE DATE IN
!                           QUESTION. (DAYS)
!         7. TCTOCF(3,3,2)- THE ROTATION MATRIX WHICH ROTATES THE TOPOCENTRIC
!                           REFERENCE SYSTEM TO THE CRUST FIXED REFERENCE SYSTEM
!                           AT EACH OBSERVATION SITE. (UNITLESS)
!
!       OUTPUT VARIABLES:
!         1. XLOADP(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                           POSITION VECTORS DUE TO OCEAN LOADING EFFECTS. (M)
!                           FOR THE DEFAULT CALC SETUP (KOCEC=0), THE OCEAN
!                           LOADING CORRECTIONS ARE NOT ADDED TO THE
!                           THEORETICAL OBSERVATIONS, BUT ONLY PASSED OUT AS
!                           CONTRIBUTIONS, SO THIS ARRAY IS NORMALLY ZEROED OUT.
!         2. XLOADV(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                           VELOCITY VECTORS DUE TO OCEAN LOADING EFFECTS. (M/S)
!                           SEE ABOVE COMMENTS FOR XLOADP.
!
! 4.2.2 COMMON BLOCKS USED -
!
      Real*8 ZLOADP(3,2), ZLOADV(3,2), ZLOADP_HOR(3,2),                 &
     &       ZLOADV_HOR(3,2), ZLOADP_VER(3,2), ZLOADV_VER(3,2),         &
     &       ZLOADPold(3,2), ZLOADVold(3,2)
      COMMON / OCECM / ZLOADP, ZLOADV, ZLOADP_HOR,                      &
     &       ZLOADV_HOR, ZLOADP_VER, ZLOADV_VER,                        &
     &       ZLOADPold, ZLOADVold
!       VARIABLES TO:
!         1. ZLOADP(3,2)  - SAME AS XLOADP ABOVE, EXCEPT CONTAINS VALUES UNLESS
!                           THE OCEAN LOADING MODULE IS TURNED OFF (KOCEC=1).
!                           STORED AS A SEPARATE VARIABLE IN COMMON IN ORDER TO
!                           PASS IT TO THE CONTRIBUTIONS SUBROUTINE.
!         2. ZLOADV(3,2)  - SAME AS XLOADV. SEE COMMENTS FOR ZLOADP.
!         3. ZLOADP_HOR(3,2) - SAME AS ZLOADP EXCEPT CONTAINS ONLY THE
!                           HORIZONTAL OCEAN LOADING EFFECTS.
!         4. ZLOADV_HOR(3,2)  - SAME AS ZLOADV EXCEPT CONTAINS ONLY THE
!                           HORIZONTAL OCEAN LOADING EFFECTS.
!         5. ZLOADP_VER(3,2)  - SAME AS ZLOADP EXCEPT CONTAINS ONLY THE VERTICAL
!                           OCEAN LOADING EFFECTS.
!         6. ZLOADV_VER(3,2)  - SAME AS ZLOADV EXCEPT CONTAINS ONLY THE VERTICAL
!                           OCEAN LOADING EFFECTS.
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!       VARIABLES 'FROM' -
!         1. CONVD   -  THE CONVERSION FACTOR FROM DEGREES TO radians
!
       INCLUDE 'ccon.i'
!       VARIABLES 'FROM':
!         1. KOCEC   -  THE OCEAN LOADING MODULE FLOW CONTROL FLAG
!         2. KOCED   -  THE OCEAN LOADING MODULE DEBUG OUTPUT FLAG
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
       INCLUDE 'cuser11.i'
!       Variables from:
!            1. Calc_user   - Calc user type. 'A' for Calc/SOLVE analysis.
!                             'C' for VLBI correlator.
!            2. Apply_ocean - Switch to apply ocean loading to theoreticals
!                             for correlator usage. 'Y' to apply (recommended),
!                             'N' for do not apply.
!
     INCLUDE 'put2s.i'
!       Variables to:
!         1. XHOLD(3,2,2) - THE TOTAL OCEAN LOADING DISPLACEMENT VECTORS IN
!                           J2000.0 COORDINATES. THE INDICES RUN OVER (X,Y,Z),
!                          (POSITION, VELOCITY), (SITE 1, SITE 2) (METERS)
!
       Real*8 speed(11)
       Common /tide_speed/ speed
!            SPEED(11)- COEFFICIENTS FOR THE COMPUTATION OF ARGUMENTS IN THE
!                       FOLLOWING ORDER OF TIDES: (RAD/SEC)
!                       M2, S2, N2, K2, K1, O1, P1, Q1, MF, MM, SSA.
!                       (These are actually the rates of change of the 11 tide
!                        angles - see subroutine OCARG).
!
! 4.2.3 PROGRAM SPECIFICATIONS -
!
      Integer*4 I, J, K, L
      Real*8 ANGLE(11), CFDIS(3,2), CFSITE(3,2), DELTAO(3,2),           &
     &       OCEAMP(11,3,2), OCEPHS(11,3,2), R2000(3,3,3),              &
     &       XLOADP(3,2), XLOADV(3,2), TCDIS(3,2), CFVEL(3,2),          &
     &       ZLOAV1(3,2), ZLOAV2(3,2), TCVEL(3,2), TCTOCF(3,3,2),       &
     &       DELTAV(3,2), TCDIS_HOR(3,2), TCDIS_VER(3,2),               &
     &       TCVEL_HOR(3,2), TCVEL_VER(3,2), CFDIS_HOR(3,2),            &
     &       CFDIS_VER(3,2), CFVEL_HOR(3,2), CFVEL_VER(3,2),            &
     &       ZLOAV1_HOR(3,2),ZLOAV1_VER(3,2), ZLOAV2_HOR(3,2),          &
     &       ZLOAV2_VER(3,2), UT1, XJD
      Real*8 TCDISold(3,2),TCVELold(3,2),CFDISold(3,2),CFVELold(3,2),   &
     &       ZLOAV3(3,2), ZLOAV4(3,2)
!
      REAL*8 CTUT1, FA2K(14), CENT, UTC, D_UEN(3,2),DV_UEN(3,2)
      Integer*4 NL
      PARAMETER (NL=600)
      REAL*4 DZ(NL),DS(NL),DW(NL)
!
      Integer*4 TSKIP
!
      Save ANGLE
!
! 4.2.4 DATA BASE ACCESS
!
!       PUT VARIABLES:
!         1. XHOLD(3,2,2) - THE TOTAL OCEAN LOADING DISPLACEMENT VECTORS IN
!                           J2000.0 COORDINATES. THE INDICES RUN OVER (X,Y,Z),
!                          (POSITION, VELOCITY), (SITE 1, SITE 2) (METERS)
!
! 4.2.5 EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG OUTPUT
!
! 4.2.6 SUBROUTINE INTERFACE  -
!       CALLER SUBROUTINES: DRIVG
!       CALLED SUBROUTINES: OCARG, ANG, DATAN2, DCOS, DSIN, VECRT, VECAD
!
! 4.2.7 CONSTANTS USED - NONE
!
! 4.2.8 PROGRAM VARIABLES -
!
!         1. ANGLE(11)  - THE ANGULAR ARGUMENTS FOR SCHWIDERSKI COMPUTATION IN
!                         THE FOLLOWING ORDER:
!                         M2, S2, N2, K2, K1, O1, P1, Q1, MF, MM, SSA
!         2. CFDIS(3,2) - THE CRUST FIXED GEOCENTRIC DISPLACEMENTS DUE TO OCEAN
!                         LOADING AT EACH SITE. (M)
!         3. CFVEL(3,2) - THE CRUST FIXED GEOCENTRIC VELOCITIES DUE TO OCEAN
!                         LOADING AT EACH SITE. (M/SEC)
!         4. DELTAO(3,2)- THE UP (I=1), EAST-WEST (I=2), AND NORTH-SOUTH (I=3)
!                  (I,J)  DISPLACEMENTS DUE TO OCEAN LOADING AT EACH SITE. (M)
!         5. ZLOAV1(3,2)- THE CONTRIBUTION TO THE CORRECTION TO THE J2000.0
!                         GEOCENTRIC SITE VELOCITY VECTOR DUE TO THE EFFECT OF
!                         THE CHANGED SITE POSITION. (M/SEC)
!         6. ZLOAV2(3,2)- THE CONTRIBUTION TO THE CORRECTION TO THE J2000.0
!                         GEOCENTRIC SITE VELOCITY VECTOR DUE TO THE EFFECT OF
!                         THE CHANGING OCEAN LOADING DISPLACEMENT. (M/SEC)
!         7. TCDIS(3,2) - THE TOPOCENTRIC EARTH CRUSTAL DISPLACEMENTS DUE TO
!                         OCEAN LOADING AT EACH SITE. (M)
!         8. TCVEL(3,2) - THE TOPOCENTRIC EARTH CRUSTAL VELOCITIES DUE TO OCEAN
!                         LOADING AT EACH SITE. (M/SEC)
!         9. DELTAV(3,2)- THE VELOCITY OF EACH SITE DUE TO OCEAN LOADING. (M/S)
!        10. ZLOAV1_HOR(3,2)- LIKE ZOAV1, BUT CONTAINS ONLY HORIZONTAL EFFECTS.
!        11. ZLOAV2_HOR(3,2)- LIKE ZOAV2, BUT CONTAINS ONLY HORIZONTAL EFFECTS.
!        12. ZLOAV1_VER(3,2)- LIKE ZOAV1, BUT CONTAINS ONLY HORIZONTAL EFFECTS.
!        13. ZLOAV2_VER(3,2)- LIKE ZOAV2, BUT CONTAINS ONLY HORIZONTAL EFFECTS.
!        14. D_UEN(3,2) - THE UP (I=1), EAST-WEST (I=2), AND NORTH-SOUTH (I=3)
!                 (I,J)   DISPLACEMENTS DUE TO OCEAN LOADING AT EACH SITE, as 
!                         computed using the HARDISP model. (meters)
!
! 4.2.9 PROGRAMMER - HAROLD M. SCHUH 10/08/83
!                    JIM RYAN        06/20/84  CHANGED TO CONTRIBUTION ONLY
!                    DAVID GORDON    08/30/84  PUT CONVERSION TO J2000.0
!                                    POSITIONS AND VELOCITIES INTO STANDARD FORM
!                    DAVID GORDON    09/05/84  ADDED DANGL AND COMPLETED
!                                    COMPUTATION OF RATES
!                    DAVID GORDON    03/18/85  FIXED BUG FOR KOCEC.NE.0
!                    GREGG COOKE     12/22/88 TOPO OCL DISP. & VEL. PUT INTO
!                                    DATABASE)
!                    LOTHAR MOHLMANN 03/23/89 HORIZONTAL OCEAN LOADING
!                                    DISPLACEMENTS)
!                    GREG COOK       06/20/89  Put into CALC 7.0
!                    JIM RYAN        06/23/89  Code added to break out
!                                    horizontal and vertical.
!                    Jim Ryan        89.12.12 UNIX-like database interface
!                                    implimented.
!                    Jim Ryan        90.01.24 Logic for KOCEC=3 added.
!                    DSR&JWR         90.04.24 Changed the signs on the hor.
!                                    displacements and velocities. Code
!                                    orginally supplied by Bonn group was in
!                                    error due to error in algorithm supplied by
!                                    Sherneck at Uppsala. (Sherneck after
!                                    consulting with Duncan Agnew at Scripps
!                                    discovered the signs on both horizontal
!                                    components were in error.)
!                    Jim Ryan        90:11:20 Bug in logic for putting local
!                                    displacements in the database fixed.
!                                    Debug statments fixed.
!                    Jim Ryan        91.11.04 Array ANGFAC in 'OCARG' modified
!                                    to make it consistent with IERS stardards.
!                    David Gordon    94.04.18 Converted to Implicit None.
!                    David Gordon    94.08.22 Added common block for SPEED(11)
!                     & John Gipson  from OCARG to replace variable DANGL(11),
!                                    which was incorrectly being used as the
!                                    derivatives of the tide angles.
!                    David Gordon    98.08.04 Added code for handling Geocenter
!                                    station, zeroes out necessary quantities.
!                    David Gordon    98.10.16 Added 'cuser.i' include file
!                                    and code to add ocean loading to the
!                                    theoreticals for correlator users.
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    D. Gordon Nov. 2012 Hardisp model added.
!                    D. Gordon Dec. 2012 PUT's move to PUT_G. 
!                    D. Gordon Jan. 2013 Modified to pass ocean loading into
!                                   subroutines SITCR or dSITCR and decide 
!                                   there whether to apply or not.
!                    D. Gordon Oct. 2013 Modified to save the old ocean 
!                                   loading displacements and velocities. 
!                                   (Calc 10 and earlier versions.)
!
!     OCEG PROGRAM STRUCTURE
!
!   The ocean loading geometry for sites #1 and #2 are calculated separately by
!   running a loop over the two sites.
!
!   Compute the time dependent angular momentum for the 11 tidal arguments.
      IF (TSKIP.ne.1) &
     &    CALL OCARG ( UT1, XJD, ANGLE )
!
!   Loop twice for the calculation of the displacements due to ocean
!   loading at sites #1 and 2.
!
      DO  L = 1, 2
!
! Check for Geocenter site
      IF (L .eq. Nzero) Then
       Do K=1,3
         DELTAO(K,L) = 0.D0
         DELTAV(K,L) = 0.D0
          TCDIS(K,L) = 0.D0
          TCVEL(K,L) = 0.D0
         ZLOADP(K,L) = 0.D0
         ZLOADP_HOR(K,L) = 0.D0
         ZLOADP_VER(K,L) = 0.D0
         ZLOADV(K,L) = 0.D0
         ZLOADV_HOR(K,L) = 0.D0
         ZLOADV_VER(K,L) = 0.D0
       Enddo
        Go to 150
      ENDIF
!
!   Compute the topocentric displacement DELTAO and DELTAV for each site due to
!    ocean loading (for the 11 main tides in 3 directions).
!     [These are the old (Calc 10 and earlier) displacements.]
!
        DO K = 1, 3
          DELTAO(K,L) = 0.D0
          DELTAV(K,L) = 0.D0
          DO J = 1,11
            DELTAO(K,L) =   OCEAMP(J,K,L)  * DCOS(ANGLE(J)              &
     &                    - OCEPHS(J,K,L)) + DELTAO(K,L)
            DELTAV(K,L) = - OCEAMP(J,K,L)  * DSIN(ANGLE(J)              &
     &                    - OCEPHS(J,K,L)) * speed(J) &
     &                    + DELTAV(K,L)
          ENDDO
        ENDDO
!
!   Change the signs on the horizontal displacements and velocities.
!     (See explanation in the subroutine history above.)
!
        DELTAO(2,L) = -DELTAO(2,L)
        DELTAV(2,L) = -DELTAV(2,L)
        DELTAO(3,L) = -DELTAO(3,L)
        DELTAV(3,L) = -DELTAV(3,L)
!
!**********************************************************************
!  Now call Hardisp ocean loading model:
       CALL C_HARDISP(CENT,UT1,UTC,OCEAMP,OCEPHS, FA2K, L, DZ, DW, DS)
       D_UEN(1,L) =  DZ(1)
       D_UEN(2,L) = -DW(1)
       D_UEN(3,L) = -DS(1)
! Velocities:
       DV_UEN(1,L) = 0.0D0 
       DV_UEN(2,L) = 0.0D0 
       DV_UEN(3,L) = 0.0D0 
!
!      write(6,1017) L, DELTAO(1,L), DELTAO(2,L), DELTAO(3,L)
!      write(6,1018) L, D_UEN (1,L), D_UEN (2,L), D_UEN (3,L)
 1017  format (/,' OCEG: L, DELTAO(m) ',I2,3F14.6)
 1018  format (/,' OCEG: L, D_UEN(m)  ',I2,3F14.6)
!
!**********************************************************************
!
!   Load the topocentric ocean loading displacement vector. Also load up vector
!   that contains only the vertical and only the horizontal effects.
!!!     TCDIS(1,L) = DELTAO(1,L)
!!!     TCDIS(2,L) = DELTAO(2,L)
!!!     TCDIS(3,L) = DELTAO(3,L)
!
!!!     TCDIS_HOR(1,L) = 0.D0
!!!     TCDIS_HOR(2,L) = DELTAO(2,L)
!!!     TCDIS_HOR(3,L) = DELTAO(3,L)
!
!!!     TCDIS_VER(1,L) = DELTAO(1,L)
!!!     TCDIS_VER(2,L) = 0.D0
!!!     TCDIS_VER(3,L) = 0.D0
!
!   Load the topocentric ocean loading velocity vector. As above, load like
!   quantities for horizontal and vertical.
!!!     TCVEL(1,L) = DELTAV(1,L)
!!!     TCVEL(2,L) = DELTAV(2,L)
!!!     TCVEL(3,L) = DELTAV(3,L)
!
!!!     TCVEL_HOR(1,L) = 0.D0
!!!     TCVEL_HOR(2,L) = DELTAV(2,L)
!!!     TCVEL_HOR(3,L) = DELTAV(3,L)
!
!!!     TCVEL_VER(1,L) = DELTAV(1,L)
!!!     TCVEL_VER(2,L) = 0.D0
!!!     TCVEL_VER(3,L) = 0.D0
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!  Replace with the HARDISP model
!
!   Load the topocentric ocean loading displacement vector. Also load vectors
!   that contains only the vertical and only the horizontal effects.
        TCDIS(1,L) =  D_UEN(1,L)
        TCDIS(2,L) =  D_UEN(2,L)
        TCDIS(3,L) =  D_UEN(3,L)
!
        TCDIS_HOR(1,L) = 0.D0
        TCDIS_HOR(2,L) =  D_UEN(2,L)
        TCDIS_HOR(3,L) =  D_UEN(3,L)
!
        TCDIS_VER(1,L) =  D_UEN(1,L)
        TCDIS_VER(2,L) = 0.D0
        TCDIS_VER(3,L) = 0.D0
!
!   Load the topocentric ocean loading velocity vector. As above, load like
!   quantities for horizontal and vertical.
        TCVEL(1,L) = DV_UEN(1,L)
        TCVEL(2,L) = DV_UEN(2,L)
        TCVEL(3,L) = DV_UEN(3,L)
!
        TCVEL_HOR(1,L) = 0.D0
        TCVEL_HOR(2,L) = DV_UEN(2,L)
        TCVEL_HOR(3,L) = DV_UEN(3,L)
!
        TCVEL_VER(1,L) = DV_UEN(1,L)
        TCVEL_VER(2,L) = 0.D0
        TCVEL_VER(3,L) = 0.D0
!
!   Rotate the displacements and velocities to the crust fixed geocentric
!   coordinate system.
        CALL VECRT(TCTOCF(1,1,L),TCDIS(1,L),CFDIS(1,L))
        CALL VECRT(TCTOCF(1,1,L),TCVEL(1,L),CFVEL(1,L))
!
        CALL VECRT(TCTOCF(1,1,L),TCDIS_HOR(1,L),CFDIS_HOR(1,L))
        CALL VECRT(TCTOCF(1,1,L),TCVEL_HOR(1,L),CFVEL_HOR(1,L))
!
        CALL VECRT(TCTOCF(1,1,L),TCDIS_VER(1,L),CFDIS_VER(1,L))
        CALL VECRT(TCTOCF(1,1,L),TCVEL_VER(1,L),CFVEL_VER(1,L))
!
!   Rotate the crust fixed geocentric displacements to J2000.0.
        CALL VECRT(R2000(1,1,1),CFDIS(1,L)    ,ZLOADP(1,L)    )
        CALL VECRT(R2000(1,1,1),CFDIS_HOR(1,L),ZLOADP_HOR(1,L))
        CALL VECRT(R2000(1,1,1),CFDIS_VER(1,L),ZLOADP_VER(1,L))
!
!   Rotate the crust fixed geocentric velocities to J2000.0.
!
!   Compute the contribution to the J2000.0 velocities due to the effect of
!   changed site positon due to ocean loading.
        CALL VECRT(R2000(1,1,2),CFDIS    (1,L),ZLOAV1    (1,L))
        CALL VECRT(R2000(1,1,2),CFDIS_HOR(1,L),ZLOAV1_HOR(1,L))
        CALL VECRT(R2000(1,1,2),CFDIS_VER(1,L),ZLOAV1_VER(1,L))
!
!   Compute the contribution to the J2000.0 velocities due to the effect of the
!   changing ocean loading displacement.
        CALL VECRT(R2000(1,1,1),CFVEL    (1,L),ZLOAV2    (1,L))
        CALL VECRT(R2000(1,1,1),CFVEL_HOR(1,L),ZLOAV2_HOR(1,L))
        CALL VECRT(R2000(1,1,1),CFVEL_VER(1,L),ZLOAV2_VER(1,L))
!
!   Add the contributions
        CALL VECAD(ZLOAV1    (1,L),ZLOAV2    (1,L),ZLOADV    (1,L))
        CALL VECAD(ZLOAV1_HOR(1,L),ZLOAV2_HOR(1,L),ZLOADV_HOR(1,L))
        CALL VECAD(ZLOAV1_VER(1,L),ZLOAV2_VER(1,L),ZLOADV_VER(1,L))
!
!**********************************************************************
!   Save the 'old' topocentric ocean loading displacement and velocity vectors.
        TCDISold(1,L) = DELTAO(1,L)
        TCDISold(2,L) = DELTAO(2,L)
        TCDISold(3,L) = DELTAO(3,L)
        TCVELold(1,L) = DELTAV(1,L)
        TCVELold(2,L) = DELTAV(2,L)
        TCVELold(3,L) = DELTAV(3,L)
!
!   Rotate to the crust fixed geocentric coordinate system.
        CALL VECRT(TCTOCF(1,1,L),TCDISold(1,L),CFDISold(1,L))
        CALL VECRT(TCTOCF(1,1,L),TCVELold(1,L),CFVELold(1,L))
!
!   Rotate the crust fixed geocentric displacements to J2000.0.
        CALL VECRT(R2000(1,1,1),CFDISold(1,L),ZLOADPold(1,L)    )
!
!   Rotate the crust fixed geocentric velocities to J2000.0.
!
!   Compute the contribution to the J2000.0 velocities due to the effect of
!   changed site positon due to ocean loading.
        CALL VECRT(R2000(1,1,2),CFDISold(1,L),ZLOAV3(1,L))
!   Compute the contribution to the J2000.0 velocities due to the effect of the
!   changing ocean loading displacement.
        CALL VECRT(R2000(1,1,1),CFVELold(1,L),ZLOAV4(1,L))
!   Add the contributions
        CALL VECAD(ZLOAV3(1,L),ZLOAV4(1,L),ZLOADVold    (1,L))
!**********************************************************************
!
 150   CONTINUE
!
      ENDDO
!
!   Check KOCEC to determine if the ocean loading module is to be turned off.
!
!   Handle the normal case (Contributions only)
!**   IF (KOCEC .EQ. 0 .or. KOCEC.eq.3) THEN
        DO  L = 1,2
          DO  I = 1,3
!**         XLOADP(I,L) = 0.D0
!**         XLOADV(I,L) = 0.D0
!  Save Ocean loading. Decide in subroutine SITCR/dSITCR whether
!   to apply it or not. 2013-Jan-29.
            XLOADP(I,L) = ZLOADP(I,L)
            XLOADV(I,L) = ZLOADV(I,L)
          ENDDO
        ENDDO
!**   ENDIF
!
!   Handle the ocean loading module off case.
      IF (KOCEC .EQ. 1) THEN
        DO  L = 1,2
          DO  I = 1,3
            ZLOADP(I,L) = 0.D0
            ZLOADP_HOR(I,L) = 0.D0
            ZLOADP_VER(I,L) = 0.D0
            XLOADP(I,L) = 0.D0
!
!
            ZLOADV(I,L) = 0.D0
            ZLOADV_HOR(I,L) = 0.D0
            ZLOADV_VER(I,L) = 0.D0
            XLOADV(I,L) = 0.D0
          ENDDO
        ENDDO
      ENDIF
!
!   Handle the special case (KOCEC=2) where the effect of ocean loading is
!   added to the theoretical.
!**   IF (KOCEC.eq.2 .or. (Calc_user.eq.'C' .and. Apply_ocean.eq.'Y')   &
!**  &    .or. (Calc_user.eq.'D' .and. Apply_ocean.eq.'Y') ) &
!**  &         THEN
!       print *, 'Ocean loading being applied'
!**     DO  L = 1,2
!**       DO  I = 1,3
!**         XLOADP (I,L) = ZLOADP(I,L)
!**         XLOADV (I,L) = ZLOADV(I,L)
!**       ENDDO
!**     ENDDO
!**   ENDIF
!
!  Put the site dependent topocentric ocean loading displacement and velocity in
!  the database only if the module is turned on. => PUT moved to PUT_G.
!   Note the use of the indices: (Up, East, North) by (P,V) by (site1,site2).
      IF (KOCEC .NE. 1) THEN
        DO I = 1,3
          DO L = 1,2
            XHOLD(I,1,L) = TCDIS(I,L)
            XHOLD(I,2,L) = TCVEL(I,L)
          ENDDO
        ENDDO
      ENDIF
!
!  Check KOCED to determine if debug output is requested.
  400 CONTINUE
!
      IF( KOCED .EQ. 0) GO TO 500
      WRITE (6,9100)
 9100 FORMAT (1X, 'Debug output for subroutine OCEG.' )
      WRITE(6,8)' ANGLE     ' ,ANGLE
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CFDIS     ' ,CFDIS
      WRITE(6,8)' DELTAO    ' ,DELTAO
      WRITE(6,8)' DELTAV    ' ,DELTAV
      WRITE(6,8)' TCDIS     ' ,TCDIS
      WRITE(6,8)' TCDIS_HOR ' ,TCDIS_HOR
      WRITE(6,8)' TCDIS_VER ' ,TCDIS_VER
      WRITE(6,8)' TCVEL     ' ,TCVEL
      WRITE(6,8)' TCVEL_HOR ' ,TCVEL_HOR
      WRITE(6,8)' TCVEL_VER ' ,TCVEL_VER
      WRITE(6,8)' ZLOAV1    ' ,ZLOAV1
      WRITE(6,8)' ZLOAV1_HOR' ,ZLOAV1_HOR
      WRITE(6,8)' ZLOAV1_VER' ,ZLOAV1_VER
      WRITE(6,8)' ZLOAV2_HOR' ,ZLOAV2_HOR
      WRITE(6,8)' ZLOAV2_VER' ,ZLOAV2_VER
      WRITE(6,9200) ZLOADP, ZLOADP_HOR, ZLOADP_VER,                     &
     &              ZLOADV, ZLOADV_HOR, ZLOADV_VER,                     &
     &              XLOADP, XLOADV, CFSITE, UT1, OCEAMP,                &
     &              ((((OCEPHS(J,K,L)/CONVD),J=1,11),K=1,3),L=1,2),     &
     &              R2000,CFDIS, CFDIS_HOR,CFDIS_VER
!
 9200 FORMAT (' ZLOADP  = ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' ZLOADP_HOR',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' ZLOADP_VER',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' ZLOADV  = ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' ZLOADV_HOR',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' ZLOADV_VER',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' XLOADP  = ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' XLOADV  = ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' CFSITE  = ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' UT1     = ',/, D25.16, 10X , /, 1X ,                    &
     &        ' OCEAMP  = ',/,2( 3(11F10.5,/),/),                       &
     &        ' OCEPHS-deg',/,2( 3(11F10.5,/),/),                       &
     &        ' R2000   = ',/,3( 3(3D25.16,/),/),                       &
     &        ' CFDIS   = ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' CFDIS_HOR ',/,2 ( 3 ( D25.16, 10X ), /),                &
     &        ' CFDIS_VER ',/,2 ( 3 ( D25.16, 10X ), /))
      WRITE(6,'(" XJD     = ", F15.2, 1X,"KOCEC   = ",I3)')             &
     &  XJD,KOCEC
!
!     Normal termination.
 500  RETURN
      END
!*********************************************************************
      SUBROUTINE OCEP()
      IMPLICIT None
!
!     This is a "STUB" routine which does nothing but return control to DRIVR.
!     There are no ocean loading partials.
!
      RETURN
      END
!*********************************************************************
      SUBROUTINE OCEC (STAR)
      IMPLICIT None
!
!    OCEC is the contributions section of the ocean loading module. It computes
!    the contributions to the delay and delay rate due to ocean loading effects.
!
!     OCEC program interface -
!      CALLING SEQUENCE -
!       INPUT VARIABLES:
!         1. STAR(3) - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!       OUTPUT VARIABLES: NONE
!
! 6.2.2 COMMON BLOCKS -
!
      Real*8 ZLOADP(3,2), ZLOADV(3,2), ZLOADP_HOR(3,2),                 &
     &       ZLOADV_HOR(3,2), ZLOADP_VER(3,2), ZLOADV_VER(3,2),         &
     &       ZLOADPold(3,2), ZLOADVold(3,2)
      COMMON / OCECM / ZLOADP, ZLOADV, ZLOADP_HOR,                      &
     &       ZLOADV_HOR, ZLOADP_VER, ZLOADV_VER,                        &
     &       ZLOADPold, ZLOADVold
!
!       VARIABLES FROM:
!         1. ZLOADP(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                           POSITION VECTORS DUE TO OCEAN LOADING EFFECTS. (M)
!         2. ZLOADV(3,2)  - THE CORRECTIONS TO THE J2000.0 GEOCENTRIC SITE
!                           VELOCITY VECTORS DUE TO OCEAN LOADING EFFECTS. (M/S)
!         3. ZLOADP_HOR(3,2)- SAME AS ZLOADP EXCEPT CONTAINS ONLY THE HORIZONTAL
!                           OCEAN LOADING EFFECTS.
!         4. ZLOADV_HOR(3,2)- SAME AS ZLOADV EXCEPT CONTAINS ONLY THE HORIZONTAL
!                           OCEAN LOADING EFFECTS.
!         5. ZLOADP_VER(3,2)- SAME AS ZLOADP EXCEPT CONTAINS ONLY THE VERTICAL
!                           OCEAN LOADING EFFECTS.
!         6. ZLOADV_VER(3,2)- SAME AS ZLOADV EXCEPT CONTAINS ONLY THE VERTICAL
!                           OCEAN LOADING EFFECTS.
!
      INCLUDE 'cphys11.i'
!       VARIABLES 'FROM':
!         1. VLIGHT  - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!
      INCLUDE 'ccon.i'
!       VARIABLES 'FROM' :
!         1. KOCEC - THE OCEAN LOADING MODULE FLOW CONTROL FLAG
!         2. KOCED - THE OCEAN LOADING MODULE DEBUG OUTPUT FLAG
!
     INCLUDE 'put2s.i'
!       Variables to:
!         1. DOCEC(2)         - THE OCEAN LOADING CONTRIBUTION TO THE DELAY
!                               AND TO THE DELAY RATE. (SEC, SEC/SEC)
!         2. CONTRIB_HOR(2,2) - THE SITE-DEPENDENT CONTRIBUTION TO THE DELAY
!                               AND RATE FROM HORIZONTAL DISPLACEMENTS. THE
!                               first index runs over the sites and the second
!                               over the delay and rate. (sec, sec/sec)
!         3. CONTRIB_VER(2,2) - THE SITE-DEPENDENT CONTRIBUTION TO THE DELAY
!                               AND RATE FROM VERTICAL DISPLACEMENTS. THE
!                               first index runs over the sites and the second
!                               over the delay and rate. (sec, sec/sec)
!
!
! 6.2.3  PROGRAM SPECIFICATIONS -
!
      Integer*4 K
      Real*8 BASCOR(3,2), STAR(3), DOTP, BASCORold(3,2)
!
! 6.2.4  DATA BASE ACCESS => PUT's moved to PUT_C.
!
! 6.2.6 SUBROUTINE INTERFACE -
!         CALLER SUBROUTINES: DRIVC
!         CALLED SUBROUTINES: DOTP, PUT4, VECSB
!
! 6.2.7 CONSTANTS USED - VLIGHT
!
! 6.2.8 PROGRAM VARIABLES -
!         1. BASCOR(3,2)  -  THE CORRECTION TO THE J2000.0 BASELINE POSITION AND
!                            VELOCITY VECTORS DUE TO OCEAN LOADING EFFECTS.
!                            (M, M/SEC)
!
! 6.2.9 PROGRAMMER - HAROLD M. SCHUH 10/08/83
!                    JIM RYAN         6/20/83
!                    JIM RYAN        06/23/89  Code added to break out
!                                      horizontal and vertical.
!                    Jim Ryan 89:10:05 CPHYS common made an include file
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                                      implimented.
!                    David Gordon 94.04.18 Converted to Implicit None.
!                    David Gordon 94.06.27 Reversed indices of CONTRIB_HOR and
!                                      CONTRIB_VER for consistency elsewhere in
!                                      Calc (and SOLVE). First index is now
!                                      sites, second is delay and rate.
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    David Gordon Jan. 2013 Moved PUT's into subroutine PUT_C.
!                    David Gordon Oct. 2013 Code added to compute the old ocean 
!                                   loading contribution. 
!
!     OCEC PROGRAM STRUCTURE
!
!  Compute the contributions.
!
!   Compute the corrections to the J2000.0 baseline position and velocity
!   vectors due to ocean loading effects.
!
      CALL VECSB ( ZLOADP(1,1), ZLOADP(1,2), BASCOR(1,1) )
      CALL VECSB ( ZLOADV(1,1), ZLOADV(1,2), BASCOR(1,2) )
!
!   Complete the calculation of the contributions.
      DO K = 1,2
        DOCEC(K) = DOTP(BASCOR(1,K),STAR)/VLIGHT
      Enddo
!
      CONTRIB_HOR(1,1) =  DOTP( ZLOADP_HOR(1,1), STAR ) / VLIGHT
      CONTRIB_HOR(2,1) = -DOTP( ZLOADP_HOR(1,2), STAR ) / VLIGHT
      CONTRIB_HOR(1,2) =  DOTP( ZLOADV_HOR(1,1), STAR ) / VLIGHT
      CONTRIB_HOR(2,2) = -DOTP( ZLOADV_HOR(1,2), STAR ) / VLIGHT
!
      CONTRIB_VER(1,1) =  DOTP( ZLOADP_VER(1,1), STAR ) / VLIGHT
      CONTRIB_VER(2,1) = -DOTP( ZLOADP_VER(1,2), STAR ) / VLIGHT
      CONTRIB_VER(1,2) =  DOTP( ZLOADV_VER(1,1), STAR ) / VLIGHT
      CONTRIB_VER(2,2) = -DOTP( ZLOADV_VER(1,2), STAR ) / VLIGHT
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Compute contributions using the 'old' ocean loading computations
      CALL VECSB ( ZLOADPold(1,1), ZLOADPold(1,2), BASCORold(1,1) )
      CALL VECSB ( ZLOADVold(1,1), ZLOADVold(1,2), BASCORold(1,2) )
      DO K = 1,2
        DOCECold(K) = DOTP(BASCORold(1,K),STAR)/VLIGHT
      Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!   Check KOCED so see if debug is requested.
      IF ( KOCED .EQ. 0 ) GO TO 500
!
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, 'Debug output for subroutine OCEC.' )
      WRITE(6,8)'BASCOR ',BASCOR
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)'VLIGHT ',VLIGHT
      WRITE ( 6, 9200 )  ZLOADP, ZLOADV, STAR, CONTRIB_HOR,             &
     &                   CONTRIB_VER, DOCEC
 9200 FORMAT (    ' ZLOADP  =    ', 6D16.8, /,                          &
     &            ' ZLOADV  =    ', 6D16.8, /,                          &
     &            ' STAR    =    ', 3D16.8, /,                          &
     &            ' CONTRIB_HOR  ', 4D16.8, /,                          &
     &            ' CONTRIB_VER  ', 4D16.8, /,                          &
     &            ' DOCEC  =     ', 2D16.8 )
!
!     Normal termination.
  500 RETURN
      END
!*********************************************************************
      SUBROUTINE OCARG (UT1, XJD, ANGLE)
      IMPLICIT None
!
!   1.1.1  THIS SUBROUTINE COMPUTES THE ANGULAR ARGUMENTS
!          FOR SCHWIDERSKI COMPUTATION OF 11 OCEAN TIDES.
!
!          C A U T I O N
!          = = = = = = =
!          SCHWIDERSKI MODIFIES THE ANGULAR ARGUMENTS OF THE DIURNAL TERMS
!          BY +/- 90 DEGREES. THEREFORE HIS DIURNAL PHASES CANNOT BE USED WITH
!          THE STANDARD DOODSEN OR CARTWRIGHT CONVENTIONS.
!
!          Valid only after 1973!!!!!!
!
!   1.1.2  RESTRICTIONS  -  NONE
!
!   1.1.3  REFERENCES - MERIT STANDARDS, APRIL 1981, SECOND DRAFT, APPENDICES
!                       7 and 11.
!
!   1.2.   OCARG PROGRAM INTERFACE
!
!   1.2.1  CALLING SEQUENCE
!
!          INPUT VARIABLES  -
!            1. UT1  -  THE UT1 TIME OF THE DAY. (SEC)
!            2. XJD  -  THE JULIAN DATE AT ZERO HOURS UTC OF THE DATE IN
!                       QUESTION. (DAYS)
!
!          OUTPUT VARIABLES  -
!            1. ANGLE(11) - THE ANGULAR ARGUMENTS FOR SCHWIDERSKI COMPUTATION
!                           OF THE OCEAN TIDES IN THE ORDER:
!                           M2, S2, N2, K2, K1, O1, P1, Q1, MF, MM, SSA
!
!   1.2.2. COMMON BLOCKS USED
!
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          VARIABLES 'FROM'  -
!            1. TWOPI  -  PI * 2.0D0. (UNITLESS)
!            2. CONVD  -  CONVERSION FACTOR FROM DEGREES TO RADIANS. (RAD/DEG)
!            3. SECDAY -  THE NUMBER OF TIME SECONDS PER DAY. (SEC/DAY)
!
      INCLUDE 'ccon.i'
!          VARIABLES 'FROM'  -
!            1. KOCED  -  THE OCEAN LOADING MODULE DEBUG CONTROL FLAG.
!
       Real*8 speed(11)
       Common /tide_speed/ speed
!            SPEED(11)- COEFFICIENTS FOR THE COMPUTATION OF ARGUMENTS IN THE
!                       FOLLOWING ORDER OF TIDES: (RAD/SEC)
!                       M2, S2, N2, K2, K1, O1, P1, Q1, MF, MM, SSA.
!
!  1.2.3   PROGRAM SPECIFICATIONS
      REAL*8 ANGLE(11), UT1, XJD, CENTJ, XJD75, FDAY, &
     &       CAPT, H0, S0, P0
      REAL*4 ANGFAC(4,11)
      Integer*4 ICAPD, JCAPD, K
      Save CAPT, H0, S0, P0, JCAPD
!
!  1.2.5   EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG
!
!  1.2.6   SUBROUTINE INTERFACE
!              CALLER SUBROUTINE - OCEG
!              CALLED SUBROUTINE - DMOD
!
!  1.2.7   CONSTANTS USED  -
!            1. CONVD  -  CONVERSION FACTOR FROM DEGREES TO RADIANS. (RAD/DEG)
!            2. TWOPI  -  PI * 2.0D0. (UNITLESS)
!            3. ANGFAC(4,11)-TABLE OF MULTIPLES OF ARGUMENTS. (UNITLESS)
!            4. CENTJ  -  THE NUMBER OF JULIAN DAYS PER JULIAN CENTURY.
!                         (DAYS/CENT.) (CENTJ=36525.D0)
!            5. SPEED(11)- COEFFICIENTS FOR THE COMPUTATION OF ARGUMENTS IN THE
!                          FOLLOWING ORDER OF TIDES: (RAD/SEC)
!                           M2, S2, N2, K2, K1, O1, P1, Q1, MF, MM, SSA.
!            6. XJD75  -  THE JULIAN DATE OF JAN. 0.0 1975. (DAYS)
!
      DATA ANGFAC / 2.D0, -2.D0, 0.D0, 0.D0,            &
     &              0.D0,  0.D0, 0.D0, 0.D0,            &
     &              2.D0, -3.D0, 1.D0, 0.D0,            &
     &              2.D0,  0.D0, 0.D0, 0.D0,            &
     &              1.D0,  0.D0, 0.D0, 0.25D0,          &
     &              1.D0, -2.D0, 0.D0,-0.25D0,          &
     &             -1.D0,  0.D0, 0.D0,-0.25D0,          &
     &              1.D0, -3.D0, 1.D0,-0.25D0,          &
     &              0.D0,  2.D0, 0.D0, 0.D0,            &
     &              0.D0,  1.D0,-1.D0, 0.D0,            &
     &              2.D0,  0.D0, 0.D0, 0.D0 /
!
      DATA CENTJ / 36525.D0 /
!
      DATA SPEED / 1.40519D-4, 1.45444D-4, 1.37880D-4,  &
     &             1.45842D-4, 0.72921D-4, 0.67598D-4,  &
     &             0.72523D-4, 0.64959D-4, 0.053234D-4, &
     &             0.026392D-4, 0.003982D-4 /
!
      DATA XJD75 / 2442412.5D0 /
      data JCAPD / -9999 /   ! initial value, make sure its before 1973
!
!  1.2.8   PROGRAM VARIABLES
!            1. CAPT  -  THE NUMBER OF JULIAN CENTURIES BETWEEN JAN 0.5, 1900
!                        AND THE OBSERVATION.
!            2. FDAY  -  FRACTIONAL PART OF UNIVERSAL TIME (UT1) DAY IN
!                        SECONDS. (SEC)
!            3. H0    -  MEAN LONGITUDE OF SUN AT BEGINNING OF DAY. (RAD)
!            4. ICAPD -  JULIAN DAYS SINCE JANUARY 0.0 UT 1975. (DAYS)
!            5. P0    -  MEAN LONGITUDE OF LUNAR PERIGEE AT BEGINNING OF DAY.
!                        (RAD)
!            6. S0    -  MEAN LONGITUDE OF MOON AT BEGINNING OF DAY. (RAD)
!            7. JCAPD -  Previous value of ICAPD. Checked to see if we can
!                        reuse the previous values of CAPT, H0, P0, and S0.
!
!  1.2.9   PROGRAMMER  -  CLYDE GOAD
!          83:10:08 HAROLD M. SCHUH
!          89:10:08 Jim Ryan ANGFAC and SPEED moved to ema.
!          91:11:04 Jim Ryan ANGFAC(8,3) changed from 0.0 to 1.0 to make
!               consistent with IERS standards (Nov. 89)
!          David Gordon 94.04.18 Converted to Implicit None.
!          David Gordon 94.08.22 ICAPD had been incorrectly set to R*8, changed
!                       it to an integer - error had no effect. Put SPEED(11)
!                       into common block for use in geometry section [to
!                       replace DANGL(11)].
!          David Gordon 94.09.22 Added JCAPD and setting it to the previous
!                       value of ICAPD. If equal to current ICAPD, we skip
!                       computation of CAPT, H0, S0, and P0. CAPT, H0, S0, P0,
!                       and JCAPD put in save block.
!
!  1.3     OCARG PROGRAM STRUCTURE
!
!   Compute FDAY  -  fractional part of UT1 day in seconds.
      FDAY = UT1
!
!   Compute ICAPD  -  Days since JAN 0, 0.00 UT, 1975
      ICAPD = XJD - XJD75
!
!  Check to see if we've started a new day. If so, we need to compute new values
!    for CAPT, H0, S0, & P0. If not, then we can reuse the previous values.
      If (ICAPD .ne. JCAPD) Then
!
       JCAPD = ICAPD      !Reset JCAPD for next observation
!
!   Compute CAPT  -  Julian centuries since JAN 0.5, 1900.
      CAPT = ( 27392.500528D0 + 1.000000035D0 * ICAPD ) / CENTJ
!
!   Compute mean longitude of sun at beginning of day.
      H0 = (279.69668D0 + (36000.768930485D0 + 3.03D-4 * CAPT) * CAPT)  &
     &     * CONVD
!
!   Compute mean longitude of moon at beginning of day.
      S0 = ((( 1.9D-6 * CAPT - 0.001133D0 ) * CAPT + 481267.88314137D0) &
     &     * CAPT + 270.434358D0 ) * CONVD
!
!   Compute mean longitude of lunar perigee at beginning of day.
      P0 = ((( -1.2D-5 * CAPT - .010325D0 ) * CAPT + 4069.0340329577D0) &
     &     * CAPT + 334.329653D0 ) * CONVD
!
      Endif
!
!   Calculate the angular arguments. Run a loop over the 11 main tides.
!
      DO K = 1,11
        ANGLE(K) = SPEED(K)*FDAY + ANGFAC(1,K)*H0 + ANGFAC(2,K)*S0      &
     &             + ANGFAC(3,K)*P0 + ANGFAC(4,K)*TWOPI
!
        ANGLE(K) = DMOD( ANGLE(K), TWOPI )
        IF( ANGLE(K) .LT. 0.D0 ) ANGLE(K) = ANGLE(K) + TWOPI
      Enddo
!
!   Check KOCED to determine if debug output is requested.
      IF( KOCED .EQ. 0 ) GO TO 800
      H0 = DMOD( H0, TWOPI )
      S0 = DMOD( S0, TWOPI )
      P0 = DMOD( P0, TWOPI )
      WRITE (6,9100)
 9100 FORMAT (1X, 'Debug output for subroutine OCARG.' )
      WRITE(6,8)'ANGLE  ' ,ANGLE
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,9)'ANGFAC ',ANGFAC
    9 FORMAT(/,1X,A,4I4/(8X,4I4))
      WRITE(6,8)'CAPT   ',CAPT
      WRITE(6,8)'FDAY   ',FDAY
      WRITE(6,8)'H0     ',H0
      WRITE(6,7) 'ICAPD ',ICAPD
    7 FORMAT(/,1X,A,15I8/(8X,15I8))
      WRITE(6,8)'P0     ',P0
      WRITE(6,8)'S0     ',S0
      WRITE(6,8)'CENTJ  ',CENTJ
      WRITE(6,8)'CONVD  ',CONVD
      WRITE(6,8)'TWOPI  ',TWOPI
      WRITE(6,8)'XJD75  ',XJD75
      WRITE(6,8)'UT1    ',UT1
      WRITE(6,8)'XJD    ',UT1
!
!     Normal termination.
  800 RETURN
      END
      SUBROUTINE CTIMG (AT, TT, CFSITE, SITLON, UTC, XJD, CT, DATDCT,   &
     &           DLPGR, TDB, TDBg)
      IMPLICIT None
!
! 1.    CTIMG
!
! 1.1   CTIMG PROGRAM SPECIFICATION
!
! 1.1.1 CTIMG is the utility routine which computes the coordinate time fraction
!       of the coordinate time day at observing site #1, the partial derivative
!       of the atomic time with respect to the coordinate time, and the partial
!       derivative of the long period terms in the 'AT mimus CT' offset with
!       respect to the coordinate time.
!
!       The algorithm is taken directly from the referenced Moyer paper. Moyer
!       derives the theory in terms of vector positions of the Earth, Moon, and
!       planets in a solar system barycenter coordinate system and he gives an
!       algorithm in that system. In part 2 of the paper he derives an alternate
!       algorithm which does not use vectors, but rather uses an analytic
!       planetary theory. The advantage of the second algorithm is that the only
!       required inputs are the geocentric, crust fixed position of the station
!       and the UTC and AT time tags. The second algorithm is implemented here.
!
!       NOTE 1. The algorithm calls for UT1, but UTC is used in its' place.
!       (Since 1972 UTC has been kept within 0.7 seconds of UT1).
!
!       NOTE 2. The equation numbers in the Moyer paper are identified below.
!
! 1.1.3 REFERENCES  -  MOYER, T. D., TRANSFORMATION FROM PROPER TIME ON
!                      EARTH TO COORDINATE TIME IN SOLAR SYSTEM BARYCENTRIC
!                      SPACE-TIME FRAME OF REFERENCE, CEL. MECH. 23,
!                      33-68, 1981. SEE PP. 66-67.
!
! 1.2   CTIMG PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1.  AT          - THE ATOMIC TIME FRACTION OF THE TAI TIME DAY.
!                               (DAYS)
!             2.  CFSITE(3,2) - CRUST FIXED STATION COORDINATES. (M)
!             3.  SITLON(2)   - STATION EAST LONGITUDES. (RAD)
!             4.  UTC         - UTC FRACTION OF DAY. (DAYS)
!             5.  XJD         - THE JULIAN DATE AT ZERO HOURS UTC OF THE DATE
!                               IN QUESTION.  (DAYS)
!             6.  TT          - Terrestrial Time. (Days)
!           OUTPUT VARIABLES:
!             1.  CT      -  THE COORDINATE TIME FRACTION OF THE COORDINATE TIME
!                            DAY. (DAYS)
!             2.  DATDCT  -  THE PARTIAL DERIVATIVE OF THE ATOMIC TIME WITH
!                            RESPECT TO THE COORDINATE TIME. (SEC/SEC)
!             3.  DLPGR   -  THE PARTIAL DERIVATIVE OF THE LONG PERIOD TERMS IN
!                            THE 'AT MINUS CT' OFFSET WITH RESPECT TO THE
!                            COORDINATE TIME. (SEC/SEC)
!
! 1.2.2 COMMON BLOCKS USED -
!
      Real*8           A1TAI, ATCTEP, D1950, ECCEN, XL(2), XM(2),       &
     &       D(2), XLLJ(2), XLLSA(2), XMJ(2), XMSA(2), ACT(15)
      COMMON / CTICM / A1TAI, ATCTEP, D1950, ECCEN, XL,    XM,          &
     &       D,    XLLJ,    XLLSA,    XMJ,    XMSA,    ACT
!
!     VARIABLES 'FROM':
!       1. A1TAI   -  THE OFFSET BETWEEN A1 AND TAI (SECONDS) (NO LONGER USED)
!       2. ATCTEP  -  THE VALUE OF THE 'CT MINUS TAI' OFFSET. (SEC)
!       3. D1950   -  THE JULIAN DATE OF THE EPOCH JAN 1, 1950 0 HR UT.
!       4. ECCEN   -  ECCENTRICITY OF THE HELIOCENTRIC ORBIT OF THE EARTH-MOON
!                     BARYCENTER. (UNITLESS)
!       5. XL(2)   -  COEFFICIENTS FOR SUN'S MEAN LONGITUDE. (RAD,RAD/SEC)
!       6. XM(2)   -  COEFFICIENTS FOR EARTH-MOON BARYCENTER MEAN ANOMALY.
!                     (RAD,RAD/SEC)
!       7. D(2)    -  COEFFICIENTS FOR MEAN ELONGATION OF THE MOON FROM THE SUN.
!                     (RAD,RAD/SEC)
!       8. XLLJ(2) -  COEFFICIENTS FOR MEAN ELONGATION OF THE SUN FROM JUPITER.
!                     (RAD,RAD/SEC)
!       9. XLLSA(2)-  COEFFICIENTS FOR MEAN ELONGATION OF THE SUN FROM SATURN.
!                     (RAD,RAD/SEC)
!      10. XMJ(2)  -  COEFFICIENTS FOR JUPITER'S MEAN ANOMALY. (RAD,RAD/SEC)
!      11. XMSA(2) -  COEFFICIENTS FOR SATURN'S MEAN ANOMALY. (RAD,RAD/SEC)
!      12. ACT(15) -  AMPLITUDES OF TERMS IN CT-AT. (SEC)
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          VARIABLES 'FROM':
!            1. SECDAY  -  THE CONVERSION FACTOR OF COORDINATE TIME SECONDS PER
!                          COORDINATE TIME DAY. (SEC/DAY)
!
      INCLUDE 'ccon.i'
!          VARIABLES 'FROM':
!            1. KCTIC  -  THE CTIMG UTILITY ROUTINE FLOW CONTROL FLAG.
!            2. KCTID  -  THE CTIMG UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!     Common blocks used:
      INCLUDE 'put2s.i'
!       Variables to:
!          1. TDBgeo   - TDB at the geocenter. (days) 
!
!
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 AT, CFSITE(3,2), SITLON(2), UTC, XJD, CT, DATDCT, DLPGR
      Real*8 TDBmTT, dTDBmTT, CTmTT, dCTmTT, TT, Elong, TDB, TDBg,      &
     &       dTDB, dTDBg
!
! 1.2.4 DATA BASE ACCESS -
!          'PUT' VARIABLES:
!            1. CT - THE COORDINATE TIME FRACTION OF THE COORDINATE TIME DAY
!                    AT OBSERVATION SITE #1. (DAYS)
!          ACCESS CODES:
!            1. 'CT SITE1' - THE DATA BASE ACCESS CODE FOR THE COORDINATE TIME
!                            FRACTION OF THE COORDINATE TIME DAY AT SITE #1.
!
! 1.2.5 EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG OUTPUT
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: DCOS, DSIN, PUT4
!
! 1.2.7 CONSTANTS USED - SECDAY, TWOPI, ATCTEP, D1950, ECCEN,
!                        XL, XM, D, XLLJ, XLLSA, XMJ, XMSA, ACT
!
! 1.2.8 PROGRAM VARIABLES -
!       1. XLE     -  SUN'S MEAN LONGITUDE. (RAD,RAD/SEC)
!       2. XME     -  EARTH-MOON BARYCENTER MEAN ANOMALY. (RAD,RAD/SEC)
!       3. DE      -  MEAN ELONGATION OF THE MOON FROM THE SUN. (RAD,RAD/SEC)
!       4. XLLJE   -  MEAN ELONGATION OF THE SUN FROM JUPITER. (RAD,RAD/SEC)
!       5. XLLSAE  -  MEAN ELONGATION OF THE SUN FROM SATURN. (RAD,RAD/SEC)
!       6. XMJE    -  JUPITER'S MEAN ANOMALY. (RAD,RAD/SEC)
!       7. XMSAE   -  SATURN'S MEAN ANOMALY. (RAD,RAD/SEC)
!       8. ANOMEC  -  THE ECCENTRIC ANOMALY OF THE HELIOCENTRIC ORBIT OF THE
!                     EARTH-MOON BARYCENTER. (RAD)
!       9. SECEP   -  THE NUMBER OF SECONDS ELAPSED SINCE THE EPOCH JAN 1, 1950
!                     0HR UT.
!      10. UTL     -  UTC + EAST LONGITUDE OF STATION 1. (RAD)
!      11. U       -  STATION 1 DISTANCE FROM SPIN AXIS. (KM)
!      12. V       -  STATION 1 DISTANCE ABOVE EQUATOR. (KM)
!      13. CTP     -  PERIODIC TERMS IN CT. (SEC)
!
! 1.2.9 PROGRAMMER - DALE MARKHAM   01/17/77
!                    PETER DENATALE 07/18/77
!                    BRUCE SCHUPLER 02/21/78
!                    CHOPO MA       08/06/81
!                    Jim Ryan 89.07.26 Documentation simplified.
!                    Gregg Cooke    90.02.14  Changed name to avoid conflict
!                                             with hp-ux libraries.
!                    David Gordon 2012.04.18 Adding modern computation of TDB,
!                                   using SOFA function iau_DTDB, renamed 
!                                   TDBminusTT.
!                    David Gordon 2012.10.17 TDBminusTT changed to a
!                                 a subroutine. Returns TDB at site 1
!                                 and TDB at the geocenter. 
!
      Real*8  XLE, XME, DE, XLLJE, XLLSAE, XMJE, XMSAE, ANOMEC,         &
     &         SECEP, UTL, U, V, CTP
      Integer*4 K
!
!     CTIMG Program Structure
!
!     Compute the number of seconds elapsed since epoch Jan 1, 1950
!     0 hours UT.
      SECEP = ( XJD + AT - D1950 ) * SECDAY
!
!     Compute the astronomical arguments.
!
!     Compute the mean anomaly of the heliocentric orbit of the
!     Earth-Moon barycenter. Moyer Eq. 44
      XME = XM(1) + XM(2) * SECEP
!
!     Compute the eccentric anomaly of the heliocentric orbit of the
!     Earth_moon barycenter.  Moyer Eq. 40
      ANOMEC = XME + ECCEN * DSIN ( XME )
!
!     Compute the sun's mean longitude.  Moyer Eq. 43
      XLE = XL(1) + XL(2) * SECEP
!
!     Compute mean elongation of the Moon from the Sun. Moyer Eq. 45
      DE = D(1) + D(2) * SECEP
!
!     Compute mean elongation of the Sun from Jupiter. Moyer Eq. 46
      XLLJE = XLLJ(1) + XLLJ(2) * SECEP
!
!     Compute mean elongation of the Sun from Saturn. Moyer Eq. 47
      XLLSAE = XLLSA(1) + XLLSA(2) * SECEP
!
!     Compute Jupiter's mean anomaly - approximation for eccentric anomaly
!     Moyer Eq. 48
      XMJE = XMJ(1) + XMJ(2) * SECEP
!
!     Compute Saturn's mean anomaly - approximation for eccentric anomaly
!     Moyer Eq. 49
      XMSAE = XMSA(1) + XMSA(2) * SECEP
!
!     Compute periodic contributions to coordinate time. The Moyer
!     Equation (No. 38) calls for UT1+LAMDA,i.e., UT1 plus the crust
!     fixed site longitude in the following 'UTL' is that quantity.
      UTL = UTC * TWOPI + SITLON(1)
!
!     Compute the station spin axis distance and Z-component in kilometers.
      U = DSQRT( CFSITE(1,1)**2 + CFSITE(2,1)**2 ) / 1.D3
      V = CFSITE(3,1) / 1.D3
!
!     Now evaluate Moyer's Equation # 43 with delta T sub A removed.
      CTP =   ACT(1) * DSIN( ANOMEC ) + ACT(2) * DSIN( DE )             &
     &      + ACT(3) * U * DSIN( UTL )                                  &
     &      + ACT(4) * U * DSIN( UTL - XME )                            &
     &      + ACT(5) * U * DSIN( UTL - 2.D0*XME )                       &
     &      + ACT(6) * U * DSIN( UTL + 2.D0*XLE )                       &
     &      + ACT(7) * U * DSIN( UTL + 2.D0*XLE + XME )                 &
     &      + ACT(8) * U * DSIN( UTL - DE ) + ACT(9) * V * DCOS( XLE )  &
     &      + ACT(10) * DSIN( XMJE ) + ACT(11) * DSIN( XMSAE )          &
     &      + ACT(12) * DSIN( XLLJE ) + ACT(13) * DSIN( XLLSAE )        &
     &      + ACT(14) * U * DSIN( UTL + XLLJE )                         &
     &      + ACT(15) * U * DSIN( UTL + XLLSAE )
!
!     Compute coordinate time depending on flow control.
!                              [ ATCTEP = 32.184 seconds ]
      IF (KCTIC.EQ.0) CT = AT + (ATCTEP + CTP) / SECDAY
      IF (KCTIC.EQ.1) CT = AT
      IF (KCTIC.EQ.2) CT = AT + ATCTEP / SECDAY
!
!     Compute the partial derivative of the long period term in
!     'AT minus CT' offset with respect to the coordinate time.
!     The long period terms are those without any diurnal signature,
!     specifically those withut UTL. The leading (-) is required
!     since the series above defines the long period terms for
!     'CT minus AT'.
!
      DLPGR = - ( ACT(1) * DCOS ( ANOMEC )                             &
     &          * ( 1.D0  +  ECCEN * DCOS ( XME ) ) * XM(2)            &
     &        + ACT(2) * DCOS ( DE ) * D(2)                            &
     &        - ACT(9) * V * DSIN( XLE ) * XL(2)                       &
     &        + ACT(10) * DCOS( XMJE ) * XMJ(2)                        &
     &        + ACT(11) * DCOS( XMSAE ) * XMSA(2)                      &
     &        + ACT(12) * DCOS( XLLJE ) * XLLJ(2)                      &
     &        + ACT(13) * DCOS( XLLSAE ) * XLLSA(2) )
!
      IF( KCTIC.NE.0) DLPGR = 0.D0
!
!     Compute the partial derivative of the atomic time with respect to
!     the coordinate time.  The (+) reverses the sign of DLPGR.
      DATDCT = 1.D0  +  DLPGR
!      write (6,8) ' AT     ', AT
!      write (6,8) ' CT     ', CT
!      write (6,8) ' DATDCT ', DATDCT
!      write (6,8) ' DLPGR  ', DLPGR 
!
!     PUT the coordinate time fracton of the coordinate time day into
!     the database.
!     CALL PUT4 ('CT SITE1      ', CT, int2(1), int2(1), int2(1))
!
! Compute modern definition of TDB. 2012.04.18
      Elong = SITLON(1)
!       Write(6,'("Elong = ",F7.1)')  360.D0*Elong/TWOPI 
      CALL TDBminusTT(XJD,TT,UTC,Elong,U,V,TDBmTT,dTDBmTT,CTmTT,dCTmTT)
       TDB = TDBmTT/86400.D0 + TT
        dTDB = dTDBmTT/86400.D0
!  TDB at the geocenter:
       TDBg = CTmTT/86400.D0 + TT
!        [TDBg replaces CT, used only for JPL ephemeris]
        dTDBg = dCTmTT/86400.D0 
!         [ dTDBg should replace DATDCT ]
! 
!     PUT the coordinate time fracton of the coordinate time day into
!     the database.
!!! This needs to be renamed!!!!!!
       TDBgeo = TDBg
!**   CALL PUT4 ('CT SITE1      ',TDBgeo, int2(1), int2(1), int2(1))
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!*     write(6,*) '              '
!*     write(6,*) 'CTIMG: TDB, dTDB ', TDB,dTDB
!*     write(6,*) 'CTIMG: TDBg,dTDBg ', TDBg,dTDBg
!*     write(6,*) '              '
!
!     Write(6,1778) TT*86400.D0,TDB*86400.D0,CT*86400.D0,TDBg*86400.D0,  &
!    &     (TT-TDB)*86400.D0, (CT-TDB)*86400.D0, (TDBg-TDB)*86400.D0
!1778 Format(/,'CTIMG: TT=',F15.8,' TDB=',F16.9,' CT=',F16.9,           &
!    &     ' TDBg=',F16.9,/,' TT-TDB=',F16.12,' CT-TDB=',F16.12,         &
!    &     ' TDBg-TDB=',F16.12,/)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!    TEST - values of WT, WF, WJ
!     Do K = 1, 12
!      Elong = (TWOPI/12.D0)*K
!       Write(6,'("Elong = ",F7.1)')  360.D0*Elong/TWOPI 
!      TDBmTT = TDBminusTT(XJD,TT,UTC,Elong,U,V)
!     Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     Check KCTID for debug output.
      IF ( KCTID .EQ. 0 )  GO TO 1100
      WRITE ( 6, 9)
    9 FORMAT(1X, "Debug output for subroutine CTIME." )
      WRITE(6,8)' XL      ',XL
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' XLE     ',XLE
      WRITE(6,8)' XM      ',XM
      WRITE(6,8)' XME     ',XME
      WRITE(6,8)' D       ',D
      WRITE(6,8)' DE      ',DE
      WRITE(6,8)' XLLJ    ',XLLJ
      WRITE(6,8)' XLLJE   ',XLLJE
      WRITE(6,8)' XLLSA   ',XLLSA
      WRITE(6,8)' XLLSAE  ',XLLSAE
      WRITE(6,8)' XMJ     ',XMJ
      WRITE(6,8)' XMJE    ',XMJE
      WRITE(6,8)' XMSA    ',XMSA
      WRITE(6,8)' XMSAE   ',XMSAE
      WRITE(6,8)' ECCEN   ',ECCEN
      WRITE(6,8)' ACT     ',ACT
      WRITE(6,8)' ANOMEC  ',ANOMEC
      WRITE(6,8)' CTP     ',CTP
      WRITE(6,8)' D1950   ',D1950
      WRITE(6,8)' SECDAY  ',SECDAY
      WRITE(6,8)' SECEP   ',SECEP
      WRITE(6,8)' UTL     ',UTL
      WRITE(6,8)' U       ',U
      WRITE(6,8)' V       ',V
      WRITE(6,8)' A1TAI   ',A1TAI
      WRITE(6,8)' ATCTEP  ',ATCTEP
      WRITE(6,8)' TT      ',TT     
      WRITE(6,8)' TDB     ',TDB    
      WRITE ( 6, 9200 )  AT, CFSITE(1,1), CFSITE(2,1), SITLON(1),       &
     &                        UTC, XJD, CT, DATDCT, DLPGR
 9200 FORMAT (1X, "AT     = ", D30.16, /, 1X,                           &
     &            "CFSITE(1,1) = ", D30.16, /, 1X,                      &
     &            "CFSITE(2,1) = ", D30.16, /, 1X,                      &
     &            "SITLON (1) = ", D30.16, /, 1X,                       &
     &            "UTC    = ", D30.16, /, 1X,                           &
     &            "XJD    = ", D30.16, /, 1X,                           &
     &            "CT     = ", D30.16, /, 1X,                           &
     &            "DATDCT = ", D30.16, /, 1X,                           &
     &            "DLPGR  = ", D30.16 )
!
!   10.   NORMAL PROGRAM CONCLUSION.
!
 1100 RETURN
      END
!**********************************************************************
      BLOCK DATA CTICMB
      IMPLICIT None
!
! 7.    CTICM
!
! 7.1   CTICM PROGRAM SPECIFICATION
!
! 7.1.1 CTICM IS THE CTIMG UTILITY BLOCK DATA INPUT AND INITIALIZATION SECTION.
!
! 7.1.3 REFERENCES  -  MOYER, T. D., TRANSFORMATION FROM PROPER TIME ON
!                      EARTH TO COORDINATE TIME IN SOLAR SYSTEM BARYCENTRIC
!                      SPACE-TIME FRAME OF REFERENCE, CEL. MECH. 23,
!                      33-68, 1981.  SEE PP. 66-67.
!
! 7.2.2 COMMON BLOCKS - CTICM
      Real*8           A1TAI, ATCTEP, D1950, ECCEN, XL(2), XM(2),       &
     &       D(2), XLLJ(2), XLLSA(2), XMJ(2), XMSA(2), ACT(15)
      COMMON / CTICM / A1TAI, ATCTEP, D1950, ECCEN, XL,    XM,          &
     &       D,    XLLJ,    XLLSA,    XMJ,    XMSA,    ACT
!
!     VARIABLES 'TO':
!       1. ATCTEP   -  THE VALUE OF THE 'CT MINUS TAI' OFFSET. (SEC)
!       2. D1950    -  THE JULIAN DATE OF THE EPOCH JAN 1, 1950 0 HR UT.
!       3. ECCEN    -  ECCENTRICITY OF THE HELIOCENTRIC ORBIT OF THE EARTH-MOON
!                      BARYCENTER. (UNITLESS)
!       4. XL(2)    -  COEFFICIENTS FOR SUN'S MEAN LONGITUDE  (RAD,RAD/SEC)
!       5. XM(2)    -  COEFFICIENTS FOR EARTH-MOON BARYCENTER MEAN ANOMALY.
!                      (RAD,RAD/SEC)
!       6. D(2)     -  COEFFICIENTS FOR MEAN ELONGATION OF THE MOON FROM THE
!                      SUN. (RAD,RAD/SEC)
!       7. XLLJ(2)  -  COEFFICIENTS FOR MEAN ELONGATION OF THE SUN FROM JUPITER.
!                      (RAD,RAD/SEC)
!       8. XLLSA(2) -  COEFFICIENTS FOR MEAN ELONGATION OF THE SUN FROM SATURN.
!                      (RAD,RAD/SEC)
!       9. XMJ(2)   -  COEFFICIENTS FOR JUPITER'S MEAN ANOMALY. (RAD,RAD/SEC)
!      10. XMSA(2)  -  COEFFICIENTS FOR SATURN'S MEAN ANOMALY. (RAD,RAD/SEC)
!      11. ACT(15)  -  AMPLITUDES OF TERMS IN CT-AT, ORDERED AS ON P. 66 OF
!                      REFERENCE. (SEC)
!     VARIABLES 'PASSED' FROM OTHER MODULE SECTIONS:
!       1. A1TAI  -  (A1 - TAI) FROM THE DATA BASE. (SEC)
!
! 7.2.3 PROGRAM SPECIFICATIONS -
!
      DATA ATCTEP / 32.184D0 /
      DATA D1950 / 2433282.5D0 /
      DATA ECCEN / 0.01672D0 /
      DATA XL    / 4.888339D0, 1.99106383D-7 /
      DATA XM    / 6.248291D0, 1.99096871D-7 /
      DATA D     / 2.518411D0, 2.462600818D-6 /
      DATA XLLJ  / 5.652593D0, 1.82313637D-7 /
      DATA XLLSA / 2.125474D0, 1.92339923D-7 /
      DATA XMJ   / 5.286877D0, 1.6785063D-8 /
      DATA XMSA  / 1.165341D0, 0.6758558D-8 /
      DATA ACT   / 1.658D-3, 1.548D-6,                                  &
     &             3.17679D-10,                                         &
     &             5.312D-12,                                           &
     &             1.00D-13,                                            &
     &            -1.3677D-11,                                          &
     &            -2.29D-13,                                            &
     &             1.33D-13, -1.3184D-10,                               &
     &             5.21D-6, 2.45D-6,                                    &
     &             20.73D-6, 4.58D-6,                                   &
     &             1.33D-13,                                            &
     &             2.9D-14 /
!
! 7.2.4 CONSTANTS USED - ATCTEP, D1950, ECCEN, XL, XM, D,
!                        XLLJ, XLLSA, XMJ, XMSA, ACT
!
! 7.2.5 PROGRAMMER - BRUCE SCHUPLER  01/07/80
!                    CHOPO MA        08/06/81
!
! 7.3   CTICM PROGRAM STRUCTURE - NONE
!
      END
      SUBROUTINE ATMG (R2K, STAR, STAR12, EARTH, TCTOCF, SITEV,         &
     &                       STAR_ABERRATED )
      Implicit none
!
!       ATMG
!
!       ATMG is the geometry section of the Atmosphere module. It computes the
!       aberrated source vector and the elevation of the aberrated source and
!       its CT time derivative at each site.
!
!       References - Smart, W.M., 'Textbook on Spherical Astronomy', 1965, P. 68
!
!       ATMG program interface
!
!       Calling sequence -
!           Input variables:
!             1. R2K(3,3,3)    - The complete crust fixed to J2000.0 rotation
!                                matrix and its first two CT time derivatives.
!                                (unitless, 1/sec, 1/sec**2)
!             2. STAR(3)       - The J2000.0 source unit vector. (unitless)
!             3. EARTH(3,3)    - The SSBC position, velocity and acceleration of
!                                the Earth. (m,m/s,m/s**2)
!             4. TCTOCF(3,3,2) - The rotation matrix which rotates the
!                                topocentric reference system to the crust fixed
!                                geocentric reference system at each observation
!                                site. (unitless)
!             5. SITEV(3,2)    - The J2000.0 geocentric velocity of each site.
!                                (m/sec)
!             6. STAR12(3,2)   - The J2000.0 source unit vestors from stations
!                                1 and 2. (unitless). For Far-field sources,
!                                these are the same as STAR(3). 
!
!           Output variables:
!             1. STAR_ABERRATED(3,2) - The J2000 source unit vector with
!                            aberration applied at each observing site.
!
!     Common blocks used -
!
      Real*8 RF(2), RTRACE(2), wetcon(2), Datmp_hmf(2,2),               &
     &       Datmp_wmf(2,2), Zen_dry(2,2), Zen_wet(2,2), Ngrad(2,2,2)
      COMMON /ATMCM/ RF, RTRACE, wetcon, Datmp_hmf, Datmp_wmf, Zen_dry, &
     &               Zen_wet, Ngrad
!           Variables 'from':
!             1. RF(2) - The constants appearing in terms 1 and 2 in the
!                        calculation of the correction angle to be added to
!                        the source zenith angle to find the apparent source
!                        direction due to tropospheric refraction. - See
!                        references. (Radians)
!
      INCLUDE 'ccon.i'
!           Variables 'from':
!             1. KATMC  -  The atmosphere module flow control flag.
!             2. KATMD  -  The atmosphere module debug output flag.
!
      Include 'cphys11.i'
!           Variables from:
!             1. VLIGHT  -  The speed of light. (m/s)
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      INCLUDE 'cuser11.i'
!       Variables to:
!          1. C_mode -
!
      INCLUDE 'put2s.i'
!       Variables to:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
      INCLUDE 'd_input.i'
!       Variables from:
!        1. 
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           Variables 'from' :
!             1. TWOPI  -  The mathematical constant 2 * PI
!
!     Program specifications -
      Real*8     CFSTAR(3,2), CFTOTC(3,3), R2K(3,3,3), SITLAT(2),       &
     &           STAR(3), TCSTAR(3,2), TCTOCF(3,3,2), TR2000(3,3,2),    &
     &                   TAZ(2,2),           STAR_ABERRATED(3,2),       &
     &           STAR12(3,2)
!
      Real*8 DOTP, EARTH(3,3), VR, SITEV(3,2), Earthplus(3)
      Real*8 Vecmg, starcheck, K_Unit_Aberr(3), Vel_dif(3)
      Real*8 AZQUAD
      Integer*4 I, L
!
!      Subroutine interface -
!             Caller subroutines: DRIVG
!             Called subroutines: DASIN, DCOS, MTRAN, VECRT, DATAN2, PUT4
!
!      Program variables -
!           1. CFSTAR(3,2)   - The aberratted source unit vector in the crust
!                              fixed geocentric reference system and its CT
!                              time derivative. (unitless, 1/sec)
!           2. CFTOTC(3,3)   - The 3x3 rotation matrix which rotates the
!                              geocentric crust fixed reference system to the
!                              topocentric reference system. (unitless)
!           3. TCSTAR(3,2)   - The aberratted source unit vector in the
!                              topocentric reference system and its CT time
!                              derivative.
!                              (unitless, 1/sec)
!           4. TR2000(3,3,2) - The complete J2000.0 to crust fixed rotation
!                              matrix and its first CT time derivative.
!                              (unitless, 1/sec)
!           5. TAZ(2,2)      - A temporary array used in the computation of AZ
!                              (rad,rad/sec)
!           6. AZQUAD        - A variable used to force the source azimuth into
!                              the range 0 to TWOPI rather than -PI to PI.
!           7. VR            - Barycentric speed of the Earth in the direction
!                              of the source.
!
!       Programmer - Dale Markham  01/13/77
!        77.11.07  Peter Denatale
!        78.02.13  Bruce Schupler
!        87.06.03  Savita Goel   CDS for A900)
!        89.05.22  Gregg Cooke
!        89.07.27  Jim Ryan      Documentation simpfilied.
!        89.12.12  Jim Ryan      UNIX-like database interface implimented.
!        89.05.25  Jim Ryan      Documentation simplified again.
!        91:11:05  Jim Ryan      Logic to account for source position
!                                aberration added to the elevation and
!                                azimuth computation.
!        91:12:30  Jim Ryan      Two equations involving VR have had the sign
!                                flipped to make to use of VR consistent with
!                                it definition.
!        93.05.19  David Gordon  STAR_ABERRATED spelling corrected, changed to
!                                a (3,2) variable, diurnal aberration added,
!                                and renormalized to a unit vector. Replaced
!                                derivative of STAR with STAR_ABERRATED for
!                                derivatives of azimuth and elevation
!                                computation.
!        94.03.03  David Gordon  Added computation for unmodified (unaberrated)
!                                source elevations and azimuths.
!        94.10.24  David Gordon  Removed computation of unmodified (unaberrated)
!                                source elevations and azimuths.
!        95.12.18  David Gordon  SITEV added to debug printout.
!        98.08.05  David Gordon  Mods for geocenter station.
!        Sept 2002 Jim Ryan      Interger*2/4 mods.
!        Jan. 2013 David Gordon  PUT's moved to subroutine PUT_G. 
!
!  ATMG program structure
!
!   Loop twice for the calculation of the elevation and azimuth angles
!   and their CT time derivatives at each site.
!
      DO 500  L = 1,2
!
!  Apply aberration to the J2000 unit vector. We now add in the diurnal
!    component to each site's velocity, whereas previously only an annual
!    term was used.
!     If (NumSpace .gt. 0)  Then
!       Call VECSB (SITEV(1,L), SPvxyz, Vel_dif)
!       Call Vecad(EARTH(1,2),Vel_dif,Earthplus)
!     Else
        Call Vecad(EARTH(1,2),SITEV(1,L),Earthplus)
!     Endif
!
        VR = DOTP(STAR12(1,L),Earthplus)
        Do I = 1,3
          STAR_ABERRATED(I,L) = STAR12(I,L)                          &
     &    + (Earthplus(i) - VR*STAR12(I,L)) / VLIGHT
        Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write (6,*) ' ATM Test: L = ', L
!       Write (6,*) 'VR  ', VR
!       Write (6,*) 'STAR12 ', STAR12(1,L), STAR12(2,L), STAR12(3,L)
!       Write (6,*) 'STAR_ABERRATED ', STAR_ABERRATED(1,L),             &
!    &               STAR_ABERRATED(2,L), STAR_ABERRATED(3,L)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!  Normalize for further use here, but keep initial vector for later use
!    in the axis offset module
             Call VUNIT(Star_Aberrated(1,L), K_Unit_Aberr)
!
!
!  Check for geocenter station
       IF (L .eq. Nzero) Go to 450
!
!  Rotate the J2000.0 source unit vector to the topocentric system.
!   (NOTE: The topocentric system sits at the observation site with the axes
!    pointing Up, East and North.
!
!  Compute the rotation matrix which rotates from the geocentric crust fixed
!    system to the topocentric system.
            CALL MTRAN ( TCTOCF(1,1,L), CFTOTC )
!
!  Compute the rotation matrix which rotates from the J2000.0 system to the
!    geocentric crust fixed system.
            CALL MTRAN ( R2K(1,1,1), TR2000(1,1,1) )
!
!  Rotate to the crust fixed system:
!           CALL VECRT (TR2000(1,1,1),STAR_ABERRATED(1,L),CFSTAR(1,1))
            CALL VECRT (TR2000(1,1,1),K_Unit_Aberr       ,CFSTAR(1,1))
!  Rotate to the topocentric system:
            CALL VECRT (CFTOTC, CFSTAR(1,1), TCSTAR(1,1))
!
!  Compute the elevation angle of the aberrated source.
            ELEV(L,1) = DASIN ( TCSTAR(1,1) )
!
!     Compute the azimuth angle of the aberrated source.
            TAZ(L,1) = DATAN2(TCSTAR(2,1),TCSTAR(3,1))
            AZQUAD = 0.0D0
            IF (TAZ(L,1) .LT. 0.0D0) AZQUAD = TWOPI
            AZ(L,1) = TAZ(L,1) + AZQUAD
!
!     Compute the CT time derivative of the aberrated source unit vector
!      in the topocentric system.
            CALL MTRAN (R2K(1,1,2), TR2000(1,1,2) )
!           CALL VECRT (TR2000(1,1,2),STAR_ABERRATED(1,L),CFSTAR(1,2))
            CALL VECRT (TR2000(1,1,2),K_Unit_Aberr       ,CFSTAR(1,2))
            CALL VECRT (CFTOTC, CFSTAR(1,2), TCSTAR(1,2) )
!
!     Compute time derivatives of elevation and azimuth
            ELEV(L,2) = TCSTAR(1,2) / DCOS ( ELEV(L,1) )
!
            AZ(L,2) = ( (TCSTAR(2,2) / TCSTAR(3,1)) -                   &
     &                (TCSTAR(2,1) * TCSTAR(3,2) / TCSTAR(3,1)**2) ) /  &
     &                (1.0D0 + (TCSTAR(2,1) / TCSTAR(3,1))**2)
!
       GO TO 500
!
  450 CONTINUE
!      Geocenter station special handling
!           WRITE ( 6, * ) 'ATMG/Nzero: SITEV = ', SITEV
!           call vecad(EARTH(1,2),SITEV(1,L),Earthplus)
!           VR = DOTP(STAR,Earthplus)
!          Do I = 1,3
!            STAR_ABERRATED(I,L) = STAR(I) &
!    &       + (Earthplus(i) - VR*STAR(I)) / VLIGHT
!          Enddo
            ELEV(L,1) = HALFPI
            AZ(L,1)   = 0.0D0
            ELEV(L,2) = 0.0D0
            AZ(L,2)   = 0.0D0
!
!     Close the loop which runs over the sites.
  500 CONTINUE
!
!
!   Check for debug output.
      IF ( KATMD .ne. 0 )  Then
      WRITE ( 6, 9100 )
 9100 FORMAT (/," Debug output for subroutine ATMG." )
    8 FORMAT(A,3D25.16/(7X,3D25.16))
      WRITE(6,8)' CFSTAR  ',CFSTAR
      WRITE(6,8)' CFTOTC  ',CFTOTC
      WRITE(6,8)' TCSTAR  ',TCSTAR
      WRITE(6,8)' TR2000  ',TR2000
      write(6,8) ' SITEV  ', SITEV
      write(6,8) ' EARTH  ', EARTH
      write(6,8) ' Earthplus ', Earthplus
      write(6,8) ' VR        ', VR
      write(6,8) ' STAR           ', STAR
      write(6,8) ' STAR_ABERRATED ', STAR_ABERRATED
      WRITE(6,8)' ELEV    ',ELEV
      WRITE(6,8)' AZ      ',AZ
      WRITE(6,8)' TAZ     ',TAZ
      WRITE(6,8)' AZQUAD  ',AZQUAD
      WRITE ( 6, 9200 )  R2K, STAR, TCTOCF,TWOPI
 9200 FORMAT (1X, "R2K    = ", 9 ( 3 ( D30.16, 10X ), /, 1X ), /, 1X, &
     &            "STAR   = ", 3 ( D30.16, 4X ), /, 1X, &
     &            "TCTOCF = ", 6 ( 3 ( D30.16, 10X ), /, 1X ),1X, &
     &            "TWOPI  = ",D30.16)
!
      Endif
!
      RETURN
      END
!
!************************************************************************
      SUBROUTINE ATMP ( SITLAT, SITLON, SITHEIGHT, XJD, CT, dATMCdh,    &
     &           gmfh, gmfw )
      Implicit none
!
!     ATMP is the atmosphere module partial derivatives section. ATMP computes
!     the partial derivatives of the delay and rate with respect to the zenith
!     electrical path delay at each observing site. Separate computations are
!     made for the Chau and the Niell (Nhmf and Whmf) models.
!
!     Calling sequence:
!       'Input' variables:
!          1. SITLAT(2) - The geodetic site latitudes. (rad)
!          2. SITHEIGHT(2)-The site heights above the geoid. (meters)
!          3. XJD       - Julian date at zero hours UTC of the date in question.
!          4. CT        - The coordinate time fraction of the coordinate time
!                         day.
!       'Output' variables:
!          1. dATMCdh(2,2)-Derivative of the Niell dry atmosphere contribution
!                          with respect to station height. First index runs over
!                          the sites and the second over the delay and rate.
!                          (sec/meter, sec/sec/meter)
!
      Real*8 SITLAT(2), SITLON(2), SITHEIGHT(2), XJD, CT, dATMCdh(2,2)
!
!   Common blocks used:
!
      Real*8 N_air(2),DAXOC_new(2,2), Daxoc_newer(2,2)
      Common /OBS/N_air,DAXOC_new, Daxoc_newer
!
      Real*8 RF(2), RTRACE(2), wetcon(2), Datmp_hmf(2,2),               &
     &       Datmp_wmf(2,2), Zen_dry(2,2), Zen_wet(2,2), Ngrad(2,2,2)
      COMMON /ATMCM/ RF, RTRACE, wetcon, Datmp_hmf, Datmp_wmf, Zen_dry, &
     &               Zen_wet, Ngrad
!        Variables 'from':
!          1. RTRACE(2) - The constants appearing in the calculation of the
!                         partial derivatives of the delay and the delay
!                         rate with respect to the zenith path delay at each
!                         site. These constants were determined from the
!                         best fit of the ray tracing algorithm for
!                         atmospheric thickness from the zenith to the
!                         horizon. (unitless)  (See references.)
!          2. wetcon(2) - The same as RTRACE, except that RTRACE is
!                         appropriate for the dry atmosphere and wetcon is
!                         appropriate for the wet.
!        Variables 'to':
!          1. Datmp_hmf(2,2) - The Niell (Nhmf) dry atmosphere partial
!                          derivatives of the delay and rate with respect to
!                          the zenith path delays at each site. The first
!                          index runs over the sites and the second runs
!                          over the delay and rate. (sec,sec/sec)
!          2. Datmp_wmf(2,2) - Same as Datmp_hmf, except for the wet Niell
!                          (Whmf) atmosphere partials.
!          3. Zen_dry(2,2)- Dry (hydrostatic) zenith delay (meters), and its
!                          rate of change (m/sec) from Niell. First index runs
!                          over sites, second runs over delay and rate.
!          4. Zen_wet(2,2)- Wet zenith delay (meters), and its rate of change
!                          (m/sec) from Niell. First index runs over sites,
!                          second runs over delay and rate.
!          5. Ngrad(2,2,2)-Atmosphere gradient partials, scaled using
!                          the Niell dry mapping function. First
!                          index runs over sites, second over North
!                          and East components, third over delay and
!                          rate.
!
      INCLUDE 'ccon.i'
!        Variables 'from':
!          1. KATMC  -  The atmosphere module flow control flag.
!          2. KATMD  -  The atmosphere module debug output flag.
!
      INCLUDE 'cphys11.i'
!        Variables 'from':
!          1. VLIGHT - Velocity of light in a vacuum. (m/sec)
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      INCLUDE 'cuser11.i'
!          Variables from:
!            1. Calc_user - Calc user type. 'A' for Calc/SOLVE analysis.
!                           'C' for VLBI correlator.
!
      INCLUDE 'get2s.i'
!       Variables from:
!        1. SurPR(2,2)
!        2. SurTP(2,2)
!        3. SurHM(2,2)
!        4. metPR
!        5. metTP
!        6. metHM
!
      INCLUDE 'put2s.i'
!       Variables from:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
!
!     Program specifications -
!
!     Database access - PUT's move to PUT_P ( 'NDRYPART'/Datmp_hmf,
!                       'NWETPART'/Datmp_wmf and 'NGRADPAR'/Ngrad moved
!                       to PUT_P.
!
!    Subroutine interface -
!        Caller subroutines: DRIVP
!        Called subroutines: DCOS, DSIN, DTAN
!
!    Program variables:
      Real*8  hmf(2), wmf(2), hmf2(2,2), wmf2(2,2), epoch, el
      Real*8  Temp, Tdot, Press, Pdot, Relhum, Rdot, X, ZD, ZDdot,      &
     &        ZW, ZWdot, sithit, Rlat, dXdh, dPdh, dZDdh 
      Real*8  gmfh(2), gmfw(2), rlon
      Integer*4 N
      Integer*2 ND0(3), Kerr
!
!          1. Press  - Atmospheric pressure. (mbar)
!          2. Pdot   - Rate of change of pressure (set to zero).
!          3. Relhum - Relative humidity. (fraction)
!          4. Temp   - Temperature. (Celsius)
!          5. ZD,ZDdot-Dry (hydrostatic) zenith delay, and rate of change,
!                      from Niell model. (meters, meters/sec)
!          6. ZW,ZWdot-Wet zenith delay, and rate of change, from Niell model.
!                      (meters, meters/sec)
!          7. dPdh   - Derivative of pressure with respect to station height.
!          8. dZDdh  - Derivative of zenith delay with respect to station
!                      height.
!          9. hmf2(2,2)-Hydrstatic (dry) mapping function and its derivative
!                      with respect to source elevation. First index runs over
!                      sites, second over the function and the derivative.
!          10. wmf2(2,2)-Wet delay mapping function and its derivative with
!                      respect to source elevation. First index runs over sites,
!                      second over the function and the derivative.
!
! 5.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!    77.07.11  Peter Denatale
!    89.07.27  Gregg Cooke
!    89.07.27  Jim Ryan  Documentation simpfilied.
!    89.12.13  Jim Ryan  UNIX-like database interface implemented.
!    89.05.24  Jim Ryan  Wet partial introduced and dry partial recode
!                        to simplify. Documetation simplified.
!    94.02.03  David Gordon - Put in ADDR's for 'NDRYPART', 'NWETPART',
!              access codes for Arthur Niell's NHMF2 and WHMF2 dry and wet
!              mapping function partials. Added SITLAT, SITHEIGHT, XJD, and CT
!              to ATMP calling sequence. DATMP changed to Datmp_Chau. Wetp
!              changed to Datmp_wetChau. Added Datmp_hmf(2,2) and Datmp_wmf(2,2)
!              to Common block ATMCM; these are the Niell model dry and wet
!              atmosphere partials w.r.t. the zenith path delay. Calls to
!              subroutines Nhmf2 and Nwmf2 added to get Niell dry and wet
!              mapping functions. PUT4's added for NDRYPART and NWETPART.
!    94.03.23  David Gordon - Moved calls to SASTD and SASTW to compute zenith
!              delays here instead of in ATMC. Added dATMCdh to calling sequence
!              and moved computation to here instead of ATMC.
!    94.03.25  David Gordon - N_air(2) computation added, a priori index of
!              refraction at each site.
!    95.12.18  David Gordon - Added about 30 variables to debug printout.
!    98.08.05  David Gordon - Mods for geocenter station.
!    98.10.01  David Gordon - New include file 'cuser.i' to tell if user is
!              analysis center or correlator. If correlator, allowed to use
!              measured pressures, temperatures, and humidities in
!              computation of Saastomoinen zenith dry and/or wet delays.
!    98.11.19  David Gordon - Adding computation and put for atmosphere
!              gradient partials, using the Niell dry mapping function.
!              Removed all old Chau computations and PUT's.
!    Sept 2002 Jim Ryan - Interger*2/4 mods.
!    Jan. 2013 David Gordon - PUT's moved to subroutine PUT_P. GET's moved
!              to subroutine GET_P.
!
! 5.3   ATMP PROGRAM STRUCTURE
!
!  Check to see if we are to use surface met data:
!    The GET's of 'ATM PRES'/SurPR, 'TEMP C'/SurTP, and 'REL.HUM.'/SurHM
!     are now in GET_P. Only if (Calc_user .eq. 'C'). 
!
!
!  Now do Arthur Niell's mapping functions:
       epoch = XJD + CT
       Do N=1,2                                      ! Loop over sites
!
!   First check for geocenter station
        IF (N .eq. Nzero) Go to 550
!
        Rlat = SITLAT(N)
        sithit = SITHEIGHT(N)
        el = elev(N,1)
!
        call NHMF2(epoch, rlat, sithit, el, hmf)
        call NWMF2(rlat, el, wmf)
!
!   Partials with respect to zenith path delays:
      if(N.eq.1) then             ! reverse sign for station 1)
        Datmp_hmf(N,1) = -hmf(1)            ! hydrostatic mapping function
        Datmp_hmf(N,2) = -hmf(2)*ELEV(N,2)  ! derivative of above w.r.t. time.
        Datmp_wmf(N,1) = -wmf(1)            ! wet mapping function
        Datmp_wmf(N,2) = -wmf(2)*ELEV(N,2)  ! derivative of above w.r.t. time.
      else
        Datmp_hmf(N,1) = hmf(1)             ! hydrostatic mapping function
        Datmp_hmf(N,2) = hmf(2)*ELEV(N,2)   ! derivative of above w.r.t. time.
        Datmp_wmf(N,1) = wmf(1)             ! wet mapping function
        Datmp_wmf(N,2) = wmf(2)*ELEV(N,2)   ! derivative of above w.r.t. time.
      endif
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! Switch to GMF hydrostatic model:
         Rlon = SITLON(N)
        Call GMF11 (epoch, rlat, rlon, sithit, el, gmfh, gmfw)
!        write(6,*) '    ' 
!        write(6,*) 'hmf1,gmfh ',  hmf, gmfh
!        write(6,*) 'wmf1,gmfw ',  wmf, gmfw
!   Partials with respect to zenith path delays:
      if(N.eq.1) then             ! reverse sign for station 1)
        Datmp_hmf(N,1) = -gmfh(1)            ! hydrostatic mapping function
        Datmp_hmf(N,2) = -gmfh(2)*ELEV(N,2)  ! derivative of above w.r.t. time.
        Datmp_wmf(N,1) = -gmfw(1)            ! wet mapping function
        Datmp_wmf(N,2) = -gmfw(2)*ELEV(N,2)  ! derivative of above w.r.t. time.
      else
        Datmp_hmf(N,1) = gmfh(1)             ! hydrostatic mapping function
        Datmp_hmf(N,2) = gmfh(2)*ELEV(N,2)   ! derivative of above w.r.t. time.
        Datmp_wmf(N,1) = gmfw(1)             ! wet mapping function
        Datmp_wmf(N,2) = gmfw(2)*ELEV(N,2)   ! derivative of above w.r.t. time.
      endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!    Atmosphere gradient partials using Niell mapping function
!        Delay terms
       Ngrad(N,1,1) = DCOS(AZ(N,1)) / DTAN(ELEV(N,1)) * hmf(1)          !North
       Ngrad(N,2,1) = DSIN(AZ(N,1)) / DTAN(ELEV(N,1)) * hmf(1)          !East
!        Rate terms
       Ngrad(N,1,2)= -DSIN(AZ(N,1))/DTAN(ELEV(N,1))*hmf(1)*AZ(N,2) &
     &              - DCOS(AZ(N,1))/DSIN(ELEV(N,1))**2*hmf(1)*ELEV(N,2) &
     &              + DCOS(AZ(N,1))/DTAN(ELEV(N,1))*hmf(2) * ELEV(N,2)
       Ngrad(N,2,2) = DCOS(AZ(N,1))/DTAN(ELEV(N,1))*hmf(1)*AZ(N,2) &
     &              - DSIN(AZ(N,1))/DSIN(ELEV(N,1))**2*hmf(1)*ELEV(N,2) &
     &              + DSIN(AZ(N,1))/DTAN(ELEV(N,1))*hmf(2) * ELEV(N,2)
!     print *,' Ngrad  ', Ngrad(N,1,1),Ngrad(N,2,1),
!    *                    Ngrad(N,1,2),Ngrad(N,2,2)
!
!   Now do the Niell dry and wet (Nhmf and Whmf) contributions:
!
!     Met values, either measured or a priori computed:
        If (metTP .eq. 1 .and. SurTP(N,1).ne.-999.D0) Then
          Temp = SurTP(N,1)
          Tdot = SurTP(N,2)
        Else
          Temp = 293.15D0 - (6.5D-3)*Sithit - 273.16D0
          Tdot = 0.D0
        Endif
!
        If (metPR .eq. 1 .and. SurPR(N,1).ne.-99900.D0) Then
          Press = SurPR(N,1)
          Pdot  = SurPR(N,2)
        Else
          X = 1.D0 - (6.5D-3)*Sithit  / 293.15D0
          Press = 1013.25D0 * (X**5.26D0)
           Pdot = 0.D0
        Endif
!
        If (metHM .eq. 1 .and. SurHM(N,1).ne.-999.D0) Then
          Relhum = SurHM(N,1)
          Rdot   = SurHM(N,2)
        Else
          Relhum = .5D0
           Rdot  = 0.D0
        Endif
!
!    Compute index of refraction in air at each site
        N_air(N) = 77.6D-6*Press/(Temp+273.16D0) + 1.D0
!
!   94Feb15 - Take partials with respect to height
          X = 1.D0 - (6.5D-3)*Sithit  / 293.15D0
         dXdh = - 6.5D-3 / 293.15D0
         dPdh = 1013.25D0 * 5.26 * (X**4.26D0) * dXdh
!
!  Compute zenith dry and wet delays
      call SASTD(Press,Pdot,Rlat,Sithit,dPdh,ZD,ZDDOT,dZDdh)
      call SASTW(Relhum,Temp,Rdot,Tdot,ZW,ZWDOT)
!
      Zen_dry(N,1) = ZD / VLIGHT
      Zen_dry(N,2) = ZDDOT / VLIGHT
      Zen_wet(N,1) = ZW / VLIGHT
      Zen_wet(N,2) = ZWDOT / VLIGHT
!
!  Find atmosphere contribution partial with respect to height (sec/meter) and
!    its time derivative
        dATMCdh(N,1) = Datmp_hmf(N,1) * dZDdh / VLIGHT
        dATMCdh(N,2) = Datmp_hmf(N,2) * dZDdh / VLIGHT
       Go to 600
!
 550   Continue
!   Geocenter handling:
        Datmp_hmf(N,1) = 0.0D0
        Datmp_hmf(N,2) = 0.0D0
        Datmp_wmf(N,1) = 0.0D0
        Datmp_wmf(N,2) = 0.0D0
        Zen_dry(N,1)   = 0.0D0
        Zen_dry(N,2)   = 0.0D0
        Zen_wet(N,1)   = 0.0D0
        Zen_wet(N,2)   = 0.0D0
        dATMCdh(N,1)   = 0.0D0
        dATMCdh(N,2)   = 0.0D0
        Ngrad(N,1,1)   = 0.0D0
        Ngrad(N,2,1)   = 0.0D0
        Ngrad(N,1,2)   = 0.0D0
        Ngrad(N,2,2)   = 0.0D0
!
 600   Continue
!
      Enddo                                          ! Loop over sites
!
!
!    Check for debug output.
      IF ( KATMD .ne. 0 )  Then
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "Debug output for subroutine ATMP." )
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' ELEV       ',ELEV
      write(6,8)' SITLAT     ',SITLAT
      write(6,8)' SITHEIGHT  ',SITHEIGHT
      write(6,8)' XJD, CT    ',XJD, CT
      write(6,8)' epoch      ',epoch
      write(6,8)' RLAT, Sithit, el ',RLAT, Sithit, el
      write(6,8)' hmf        ',hmf
      write(6,8)' wmf        ',wmf
      write(6,8)' Temp, Press, Relhum ',Temp, Press, Relhum
      write(6,8)' X          ',X
      write(6,8)' N_air      ',N_air
      write(6,8)' dXdh, dPdh ',dXdh, dPdh
      write(6,8)' ZD, ZDDOT, dZDdh ',ZD, ZDDOT, dZDdh
      write(6,8)' ZW, ZWDOT        ',ZW, ZWDOT
      WRITE(6,8)' RTRACE     ',RTRACE
      write(6,8)' wetcon     ',wetcon
      WRITE(6,8)' Datmp_hmf  ',Datmp_hmf
      WRITE(6,8)' Datmp_wmf  ',Datmp_wmf
      WRITE(6,8)' Zen_dry    ', Zen_dry
      WRITE(6,8)' Zen_wet    ', Zen_wet
      WRITE(6,8)' dATMCdh    ', dAtmcdh
      WRITE(6,8)' Ngrad      ', Ngrad
      Endif
!
      RETURN
      END
!************************************************************************
      SUBROUTINE ATMC (ZPATH, DATMC)
      Implicit none
!
!     ATMC is the atmosphere module contributions section. ATMC computes the
!     contributions to the delay and rate due to tropospheric refraction at
!     each observation site.
!
      Real*8 ZPATH(2), DATMC(2,2)
!
!     Calling sequence -
!          Input variables:
!            1. ZPATH(2)  - The nominal zenith atmosphere path delay at each
!                           site. (sec)
!          Output variables:
!            1. DATMC(2,2) - The contributions to the delay and rate due to
!                            tropospheric refraction at each site. The first
!                            index runs over the sites and the second over the
!                            delay and rate. (sec, sec/sec)
!
!     Common blocks used -
!
      Real*8 RF(2), RTRACE(2), wetcon(2), Datmp_hmf(2,2),               &
     &       Datmp_wmf(2,2), Zen_dry(2,2), Zen_wet(2,2), Ngrad(2,2,2)
      COMMON /ATMCM/ RF, RTRACE, wetcon, Datmp_hmf, Datmp_wmf, Zen_dry, &
     &               Zen_wet, Ngrad
!          Variables 'from':
!            1. Datmp_hmf(2,2) - The Niell (Nhmf) dry atmosphere partial
!                            derivatives of the delay and rate with respect to
!                            the zenith path delays at each site. The first
!                            index runs over the sites and the second runs
!                            over the delay and rate. (sec,sec/sec)
!            2. Datmp_wmf(2,2) - Same as Datmp_hmf, except for the wet Niell
!                            (Whmf) atmosphere partials.
!            3. Zen_dry(2,2)- Dry (hydrostatic) zenith delay (meters), and its
!                            rate of change (m/sec) from Niell. First index runs
!                            over sites, second runs over delay and rate.
!            4. Zen_wet(2,2)- Wet zenith delay (meters), and its rate of change
!                            (m/sec) from Niell. First index runs over sites,
!                            second runs over delay and rate.
!
      INCLUDE 'ccon.i'
!          Variables 'from':
!            1. KATMC  -  The atmosphere module flow control flag.
!            2. KATMD  -  the atmosphere module debug output flag.
!
!     INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT - Velocity of light in a vacuum. (m/sec)
!
       INCLUDE 'cuser11.i'
!          Variables from:
!            1. Calc_user - Calc user type. 'A' for Calc/SOLVE analysis.
!                           'C' for VLBI correlator.
!            2. Wet_atm   - Correlator option to combine dry and wet
!                           atmosphere corrections.
!                           = 'Y' => combine and output in 'NDRYCONT' access
!                             code. Set 'NWETCONT' access code to zero.
!                           = 'N' => don't combine.
      INCLUDE 'put2s.i'
!       Variables to:
!           1. Datmc_hmf(2,2) - The contributions to the delay and rate due
!                           to the Niell (Nhmf) dry tropospheric refraction 
!                           at each site. The first index runs over the sites
!                           and the second over the delay and rate.
!                           (sec, sec/sec)
!           2. Datmc_hmf(2,2) - The contributions to the delay and rate due
!                           to the Niell (Whmf) wet tropospheric refraction
!                           at each site. The first index runs over the sites
!                           and the second over the delay and rate.
!                           (sec, sec/sec)
!
!    Program specifications -
!    Local variables:
      Integer*4 L,K,N
!**   Real*8  Datmc_hmf(2,2), Datmc_wmf(2,2)
!
!     Database access => PUT's moved to PUT_C ('NDRYCONT'/Datmc_hmf and
!                        'NWETCONT'/Datmc_wmf). 
!
!     Subroutine interface -
!             Caller subroutines: DRIVC
!             Called subroutines: 
!
!     PROGRAMMER - Dale Markham  01/13/77
!      77.07.07  Peter Denatale
!      87.06.03  David Gordon Changed flag definition.
!      87.06.03  Savita Goel  CDS for A900)
!      89.05.22  Gregg Cooke
!      89.07.27  Jim Ryan     Documentation simpfilied.
!      89.12.12  Jim Ryan     UNIX-like database interface implimented.
!      91.05.24  Jim Ryan     Documentation further simplified.
!      94.02.04  David Gordon Added SITLAT and SITHEIGHT to calling sequence.
!                             Added subroutines Sastd and Sastw and calls to
!                             to get Niell model dry and wet Zenith
!                             contributions. PUT4's added for NDRYCONT and
!                             NWETCONT. DATMC set equal to Datmc_hmf for use
!                             elsewhere in Calc.
!      94.03.04  David Gordon Changed dATMCdh to a (2,2) array and added
!                             computation for time derivative of Niell dry
!                             contribution.
!      94.03.23  David Gordon Moved Niell zenith delay and dATMCdh computations
!                             to ATMP.
!      98.11.19  David Gordon Removed all old Chau computations and PUT's.
!      99.10.05  David Gordon Added correlator option to use dry and
!                             wet atmosphere corrections in theory module.
!      Sept 2002 Jim Ryan     Interger*2/4 mods.
!      Jan. 2013 David Gordon Moved PUT's to subroutine PUT_C.
!
!
!     ATMC Program Structure
!
!   Do the Niell dry and wet (Nhmf and Whmf) contributions:
      Do N=1,2
       Datmc_hmf(N,1) = Datmp_hmf(N,1) * Zen_dry(N,1)
       Datmc_hmf(N,2) = Datmp_hmf(N,2) * Zen_dry(N,1)
       Datmc_wmf(N,1) = Datmp_wmf(N,1) * Zen_wet(N,1)
       Datmc_wmf(N,2) = Datmp_wmf(N,2) * Zen_wet(N,1)
!
!  Store the Niell dry atmosphere delays for use elsewhere:
       DATMC(N,1) = Datmc_hmf(N,1)
       DATMC(N,2) = Datmc_hmf(N,2)
      Enddo
!      write(6,*) 'ATMC: ', Datmc_hmf(2,1), Datmc_wmf(2,1)
!
!  Mods for correlator usage. Add wet component to DATMC for use elsewhere
!     If (Calc_user .eq. 'C' .and. Wet_atm .eq. 'Y') Then
!      Do N=1,2
!       DATMC(N,1) = DATMC(N,1) + Datmc_wmf(N,1)
!       DATMC(N,2) = DATMC(N,2) + Datmc_wmf(N,2)
!      Enddo
!     Endif
!
!
!     Check for debug output.
      IF ( KATMD .ne. 0 )  Then
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "Debug output for subroutine  ATMC." )
    8 FORMAT(A,4D25.16/(7X,5D25.16))
!     WRITE(6,8)' ZPATH        ',ZPATH
      WRITE(6,8)' Zen_dry   ', Zen_dry
      WRITE(6,8)' Zen_wet   ', Zen_wet
      WRITE(6,8)' Datmc_hmf ',Datmc_hmf
      WRITE(6,8)' Datmc_wmf ',Datmc_wmf
      WRITE(6,8)' DATMC        ',DATMC
      Endif
!
      RETURN
      END
!************************************************************************
      Subroutine NHMF2(epoch,latitude,height,elev,hmf)
      Implicit none
!
!     Routine to compute the hydrostatic mapping function nhmf2 which depends on
!     the day of the year (DOY), station latitude, and height above the geoid.
!
      Integer*4 I
!
!   a,b,c       - the a,b,and c coeffiecents in the continued fraction
!                 form of Marini
!   beta        - intermediate term in calculation
!   gamma       - intermediate term in calculation
!   sine        - sine of elevation angle
!   cose        - cos of elevation angle
!   hmf(1)      - delay mapping function
!   hmf(2)      - d_mapping_function/d_elevation (dhmf2/d_el)
!   topcon      - constant of top of mapping function to ensure
!                 that value is 1.0000 at zenith
!
      Real*8 a,b,c, beta, cose, hmf(2), gamma, sine, topcon
!
!   height     - Height of site above geoid (meters)
!   hs_km      - Height of site in kms
!   latitude   - Latitude (radians)
!   latituded  - Latitude (deg)
!   l          - Absolute value of latitude
!   dl         - Incremental latitude from last lat_hmf
!   elev       - Elevation (radians)
!   epoch      - Julian date of observation, used to get day of year
!   doy        - Days since Dec 31
!   doy_atm    - Doy for atmosphere relative to Jan 28
!   doyr_atm   - Doy_atm in radians;
!   cost       - Cosine(day of year)
!   doy2rad    - Convert doy to radians
!
      Real*8 epoch, doy, latitude,latituded, height, elev
      Real*8 hs_km, l, dl, doy_atm, doyr_atm, cost
!
!   lat_hmf(5)  - Latitudes at which coefficients are defined
!   abc_avg     - Continued fraction coefficients at latitudes lat_hmf
!   abc_amp     - Amplitude of annual variation of abc_avg
!   daavg, daamp, etc - Incremental values for interpolation
!   aavg,  aamp,  etc - Average and amplitude at latitude
!
      Real*8 lat_hmf(5), abc_avg(5,3), abc_amp(5,3), a_ht, b_ht, c_ht
      Common / hmf2_coef/ lat_hmf, abc_avg, abc_amp, a_ht, b_ht, c_ht
!
      Real*8 daavg, daamp, dbavg, dbamp, dcavg, dcamp
!
!   a_ht, b_ht, c_ht - Parameters for continued fraction for height corr'n.
!
!   Define parameters used for calculating coefficients.
!
!     Data lat_hmf / 15, 30, 45, 60, 75/
!
!     Data abc_avg /
!    .1.2769934D-3,1.2683230D-3,1.2465397D-3,1.2196049D-3,1.2045996D-3,
!    .2.9153695D-3,2.9152299D-3,2.9288445D-3,2.9022565D-3,2.9024912D-3,
!    .62.610505D-3,62.837393D-3,63.721774D-3,63.824265D-3,64.258455D-3/
!
!     Data abc_amp /
!    .  0.0D0, 1.2709626D-5, 2.6523662D-5, 3.4000452D-5, 4.1202191D-5,
!    .  0.0D0, 2.1414979D-5, 3.0160779D-5, 7.2562722D-5, 11.723375D-5,
!    .  0.0D0, 9.0128400D-5, 4.3497037D-5, 84.795348D-5, 170.37206D-5/
!
!     Data a_ht / 2.53D-5/
!    .     b_ht / 5.49D-3/
!    .     c_ht / 1.14D-3/
!
      Real*8 aavg,  aamp,  bavg,  bamp,  cavg,  camp
      Real*8 ht_corr_coef, ht_corr
      real*8 dhmf_ht_del, dht_corr_coef_del, dht_corr_del               ! CSJ
!
!   Common Blocks:
!
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!
      INCLUDE 'ccon.i'
!            Variables 'from':
!              1. KATMC  -  The atmosphere module flow control flag.
!              2. KATMD  -  the atmosphere module debug output flag.
!
!   Programmers:
!    00.00.00  Arthur Niell  Subroutine created.
!    93.05.17  Arthur Niell  Use phase of 28 days (winter extremum corresponds
!                            to Jan 28) based on least-square fit to raytrace
!                            of radiosonde data for DRT, ELP, ALB, CHH, FAI,
!                            MUN, and LIH.
!    94.01.27  Dan MacMillan Changed input latitude and elevation to radians,
!                            changed input time to Julian Day.
!    95.12.15  David Gordon  Installed mods by Chris Jacobs (JPL) to compute
!                            height correction for hmf(2). Cleanup/additions to
!                            documentation and debug printout.
!
!   Convert height in meters to kilometers
      hs_km  = height/1000.d0
!
!   If Julian date is used for epoch, then calculate day of year;
!      use 1980 Jan 0 as reference epoch.
      doy = epoch - 2444238.5
!
!   To account for the six month difference in seasons between hemispheres,
!   add 365.25/2 days to doy if station is in the southern hemisphere.
      latituded = latitude/CONVD                 ! convert to degrees
      l = abs(latituded)
      if (latituded .lt. 0) doy = doy + 365.25/2
!
! mod aen 930517 Use phase of 28 days (winter extremum corresponds to Jan 28)
!                based on least-square fit to raytrace of radiosonde data for
!                DRT, ELP, ALB, CHH, FAI, MUN, and LIH.
      doy_atm  = doy - 28.
!  convert to radians
      doyr_atm = doy_atm * TWOPI/365.25
!
      cost = cos(doyr_atm)
!
!   Coefficients for the continued fraction expansion for each latitude.
!
!   For latitudes less than 15 degrees:
      if (l .le. lat_hmf(1)) then
         a = abc_avg(1,1)
         b = abc_avg(1,2)
         c = abc_avg(1,3)
      endif
!
!   For latitudes between 15 and 75  degrees:
      do i = 1,4
          if (l .gt. lat_hmf(i) .and. l .le. lat_hmf(i+1)) then
             dl = (l-lat_hmf(i))/(lat_hmf(i+1)-lat_hmf(i))
             daavg =   abc_avg(i+1,1)-abc_avg(i,1)
             daamp =   abc_amp(i+1,1)-abc_amp(i,1)
             aavg  =   abc_avg(i,1) + dl*daavg
             aamp  =   abc_amp(i,1) + dl*daamp
             a     = aavg - aamp*cost
!
             dbavg =   abc_avg(i+1,2)-abc_avg(i,2)
             dbamp =   abc_amp(i+1,2)-abc_amp(i,2)
             bavg  =   abc_avg(i,2) + dl*dbavg
             bamp  =   abc_amp(i,2) + dl*dbamp
             b     = bavg - bamp*cost
!
             dcavg =   abc_avg(i+1,3)-abc_avg(i,3)
             dcamp =   abc_amp(i+1,3)-abc_amp(i,3)
             cavg  =   abc_avg(i,3) + dl*dcavg
             camp  =   abc_amp(i,3) + dl*dcamp
             c     = cavg - camp*cost
!
          endif
      end do
!
!   for latitudes greater than 75 degrees:
      if (l .ge. lat_hmf(5)) then
         a = abc_avg(5,1)
         b = abc_avg(5,2)
         c = abc_avg(5,3)
      endif
!
!   Now the coefficients exist; calculate the mapping function, hmf(1), and the
!    change of mapping function with elevation, dhmf/d_el = hmf(2).
!   To get delay-rate correction d_tau/dt:
!      d_tau/dt = d_tau-zen/dt*hmf(1) + tau-zen*dhmf/d_el*d_el/dt
!
      sine   = sin(elev )
      cose   = cos(elev )
      beta   = b/(sine + c )
      gamma  = a/(sine + beta)
      topcon = (1.d0 + a/(1.d0 + b/(1.d0 + c)))
!
      hmf(1) = topcon / ( sine + gamma )
!
      hmf(2) = -topcon / ( sine + gamma )**2 * &
     &            ( cose - a/( sine + beta)**2 * cose * &
     &            ( 1.d0 - b/( sine + c )**2 ) )
!
!   Apply height correction to mapping function only
!         (not to dmf/d_el since this is a small correction):
!      1) height correction coefficient is
!         1/sine(elev) - continued fraction(a_ht,b_ht,c_ht).
!      2) height correction is ht_corr_coef times height in km.
!
      beta   = b_ht/( sine + c_ht )
      gamma  = a_ht/( sine + beta)
      topcon = (1.d0 + a_ht/(1.d0 + b_ht/(1.d0 + c_ht)))
      ht_corr_coef = 1/sine - topcon/(sine + gamma)
      ht_corr      = ht_corr_coef * hs_km
      hmf(1)       = hmf(1) + ht_corr
!
!************************************************
!   CSJ additions December 1995:
!     Calculate the component of d hmf/ d el    due to ht_corr.
!     This will be needed for the second term in delay rate equation,
!      d_tau/dt = d_tau-zen/dt*hmf(1) + tau-zen * dhmf/d_el * d_el/dt
!
!     Assume
!      1) hs_km is constant.
!      2) d el /dt, hs_km, tau-zen are supplied outside this routine
!      3) For convenience of notation define  eldot = d el /dt
!
!     d ht_corr / dt   = d ht_corr      / d el         * eldot
!     d ht_corr / dt   = d ht_corr_coef / d el * hs_km * eldot
!
!     Thus we need d ht_corr_coef / d el
!     Define hmf_ht = topcon/(sinel+gamma)
!
!     d ht_corr_coef / d el  = d csc(el) / d el  - d hmf_ht /d el
!
!     d csc(el) / d el  =   - ( cosel / sinel**2 )
!
!     d hmf_ht / d el = (-topcon*cosel/( sinel + gamma)**2) *
!   (1.d0 -  (a_ht/( sinel + betm )**2) * (1.d0 -  (b_ht/( sinel + c_ht )**2)))
!   1        2     3              3   2   2        3     4              4   321
!   The numbers above show levels of parenthesis
!
      dhmf_ht_del = (-topcon*cose/( sine + gamma)**2) &
     &            * (1.d0 -  (a_ht/( sine + beta )**2) &
     &            * (1.d0 -  (b_ht/( sine + c_ht )**2) ) )      ! CSJ
!
      dht_corr_coef_del = -cose/sine**2 - dhmf_ht_del           ! CSJ
      dht_corr_del      = dht_corr_coef_del * hs_km             ! CSJ
      hmf(2)            = hmf(2) + dht_corr_del                 ! CSJ
!
!************************************************
!     Check for debug output.
      IF ( KATMD .ne. 0 )  Then
        WRITE ( 6, 9100 )
 9100   FORMAT (1X, "Debug output for subroutine NHMF2." )
    8   FORMAT(A,4D25.16/(7X,5D25.16))
        write(*,'("doy, doy_atm, doyr_atm = ", 3f20.9)') doy, doy_atm, &
     &       doyr_atm
        WRITE(6,8)' epoch, elev    ', epoch, elev
        WRITE(6,8)' Height, hs_km  ', Height, hs_km
        WRITE(6,8)' Latitude, Latituded ', Latitude, Latituded
        WRITE(6,8)' a, b, c ', a, b, c
        write(*,'("sine, cose, beta, gamma, topcon = ", 5f10.5)') &
     &             sine, cose, beta, gamma, topcon
        write(6,8)' ht_corr_coef, ht_corr ', ht_corr_coef, ht_corr
        WRITE(6,8)' dhmf_ht_del       ', dhmf_ht_del
        WRITE(6,8)' dht_corr_coef_del ', dht_corr_coef_del
        WRITE(6,8)' dht_corr_del      ', dht_corr_del
        write(6,8)' hmf(1), hmf(2)    ', hmf
      Endif
!
      Return
      End
!************************************************************************
      Subroutine NWMF2(latitude, elev, wmf)
      Implicit none
!
!    NWMF2: Routine to compute the new WMF2.0 mapping function which depends
!    only on latitude and elevation.
!
!   Input variables:
!       1. latitude - Latitude (radians)
!       2. elev     - Source selevation. (radians)
!
!   Output variables:
!       1. wmf(1) - Wet delay mapping function.
!       2. wmf(2) - Derivative of the wet delay mapping function (wmf(1) with
!                   respect to elevation.
!
!   Program variables:
!       1. a,b,c      - The a,b,and c coefficients in the continued fraction
!                       form of Marini
!       2. beta       - Intermediate term in calculation
!       3. gamma      - Intermediate term in calculation
!       4. sine       - Sine of elevation angle
!       5. cose       - Cos of elevation angle
!       6. topcon     - Constant of top of mapping fuinction to ensure
!                       value is 1.0000 at zenith
!       7. latituded  - latitude (degrees)
!       8. l          - absolute latitude
!       9. dl         - incremental latitude from last lat_wmf
!      10. dl,da,db,dc- used for interpolation
!
      Real*8 a,b,c, beta, cose, wmf(2), gamma, sine, topcon
      Real*8 lat_wmf(5), abc_w2p0(5,3)
      Real*8 dl, da, db, dc
      Real*8 latitude, latituded, l, elev
      Integer*4 I
!
!   Define parameters used for calculating coefficients.
      Data lat_wmf / 15.D0, 30.D0, 45.D0, 60.D0, 75.D0/
!
!   Coefficients are from fits to raytraces of the standard atmospheres
!   for July for latitudes 15, 45, 60, and 75 degrees latitude and for
!   January for 30 degrees latitude (930517).
      Data abc_w2p0 / &
     & 5.8021897D-4,5.6794847D-4,5.8118019D-4,5.9727542D-4,6.1641693D-4, &
     & 1.4275268D-3,1.5138625D-3,1.4572752D-3,1.5007428D-3,1.7599082D-3, &
     & 4.3472961D-2,4.6729510D-2,4.3908931D-2,4.4626982D-2,5.4736038D-2/
!
!   Common Blocks:
!
      INCLUDE 'ccon.i'
!
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!
!   Programmers:
!     93.05.17  Arthur Niell  Subroutine created.
!     94.01.27  Dan MacMillan Changed input latitude and elevation to radians.
!     95.12.18  David Gordon  Documentation made 'Calc'-like, debug section
!                             added.
!
      latituded = latitude/CONVD             ! convert to degrees
      l = abs(latituded)
!
!   Coefficients for the continued fraction expansion for each latitude.
!
!   for latitudes less than 15 degrees:
      if (l .le. lat_wmf(1)) then
         a = abc_w2p0(1,1)
         b = abc_w2p0(1,2)
         c = abc_w2p0(1,3)
      endif
!
!   for latitudes between 15 and 75  degrees:
      do i = 1,4
          if (l .gt. lat_wmf(i) .and. l .le. lat_wmf(i+1)) then
             dl = (l-lat_wmf(i))/(lat_wmf(i+1)-lat_wmf(i))
             da  =   abc_w2p0(i+1,1)-abc_w2p0(i,1)
             a   =   abc_w2p0(i,1) + dl*da
!
             db  =   abc_w2p0(i+1,2)-abc_w2p0(i,2)
             b   =   abc_w2p0(i,2) + dl*db
!
             dc  =   abc_w2p0(i+1,3)-abc_w2p0(i,3)
             c   =   abc_w2p0(i,3) + dl*dc
!
          endif
      end do
!
!   for latitudes greater than 75 degrees:
      if (l .ge. lat_wmf(5)) then
         a = abc_w2p0(5,1)
         b = abc_w2p0(5,2)
         c = abc_w2p0(5,3)
      endif
!
!   Now the coefficients exist; calculate the mapping function, wmf(1), and the
!    change of mapping function with elevation, dwmf/d_el =wmf(2).
!   To calculate the delay-rate correction, d_tau/dt:
!       d_tau/dt = d_tau_zen/dt * wmf(1) + tau_zen * dwmf/d_el * d_el/dt
!
      sine  = sin( elev )
      cose  = cos( elev )
      beta  = b/( sine + c )
      gamma = a/( sine + beta)
      topcon = (1.d0 + a/(1.d0 + b/(1.d0 + c)))
!
      wmf(1) = topcon / ( sine + gamma )
!
      wmf(2) = -topcon / ( sine + gamma )**2 * &
     &         ( cose - a/( sine + beta)**2 * cose * &
     &         ( 1.d0 - b/( sine + c )**2 ) )
!
!     Check for debug output.
      IF ( KATMD .ne. 0 )  Then
        WRITE ( 6, 9100 )
 9100   FORMAT (1X, "Debug output for subroutine NWMF2." )
    8   FORMAT(A,4D25.16/(7X,5D25.16))
        WRITE(6,8)' latitude, elev ', latitude, elev
        WRITE(6,8)' a, b, c        ', a, b, c
        WRITE(6,8)' dl, da, db, dc ', dl, da, db, dc
        write(*,'("sine, cose, beta, gamma, topcon = ", 5f10.5)') &
     &           sine, cose, beta, gamma, topcon
         write(6,8)' wmf(1), wmf(2) ', wmf
      Endif
!
      return
      end
!************************************************************************
      SUBROUTINE SASTD(P,PDOT,RLAT,SITEHT,dPdh,ZD,ZDDOT,dZDdh)
      IMPLICIT NONE
!
!     SASTD PROGRAM SPECIFICATION
!
!     Calculate zenith delay for "hydrostatic" component of the atmosphere using
!     Saastamoinen formulation and constants from Davis et al.
!
!     REFERENCES:
!       1) Saastamoinen, J. "The Use of Artificial Satellites for
!          Geodesy", Geophys. Monograph Series, vol. 15, ed. by
!          S.W.Henriksen et al, AGU, Wash., D.C., pp 247-251, 1972.
!       2) Davis, J.L., et al., "Geodesy by Radio Interferometry:
!          Effects of Atmospheric Modeling Errors On Estimates Of
!          Baseline Length", Radio Science, 20, 1593-1607, 1985.
!
      REAL*8 P, PDOT, RLAT, SITEHT, dPdh, ZD, ZDDOT, dZDdh
!
!  Calling Sequence:
!
!    Input Variables:
!      1. P      - Pressure. (mbar)
!      2. PDOT   - Rate of change of pressure, set to 0.0. (mbar/sec)
!      3. RLAT   - Latitude. (radians)
!      4. SITEHT - Height of station above geoid. (meters)
!      5. dPdh   - Derivative of pressure with respect to station height.
!
!    Output Variables:
!      1. ZD    - Zenith delay of "hydrostatic" component. (meters)
!      2. ZDDOT - Rate of change of zenith delay. (meters/second)
!      3. dZDdh - Derivative of ZD with respect to station height.
!
!     SUBROUTINE INTERFACE
!       CALLING SUBROUTINES - ATMP
!       CALLED SUBROUTINES  - None
!
      INCLUDE 'ccon.i'
!
      REAL*8 F, dFdh
!
!     Program Variables
!       1. F    - Intermediate result in zenith delay calculation
!       2. dFdh - Derivative of F with respect to height.
!
!     Programmers:
!      ??.??.??  JMG,AEN??  Created?
!      94.02.15  D. Gordon  Added partials of ZD with respect to height.
!      95.12.18  D. Gordon  Documentation made 'Calc'-like, debug printout
!                           section added.
!
!     SASTD PROGRAM STRUCTURE
!
!-----Calculate variation of gravity with station position.
!
      F = 1.0D0-0.00266D0*COS(2.0D0*RLAT) - 0.00028D0*SITEHT/1000.0D0
      ZD = 0.0022768D0*P/F
      ZDDOT = ZD*PDOT/P
!
! 94FEB15 - take partials with respect to height -DG-
      dFdh = -2.8D-7
      dZDdh = 0.0022768D0 * (dPdh  - P*dFdh/F) / F
!
      If (KATMD .ne. 0)  Then
        WRITE ( 6, 9100 )
 9100   FORMAT (1X, "Debug output for subroutine SASTD." )
    8   FORMAT(A,4D25.16/(7X,5D25.16))
        WRITE(6,8)' P, PDOT, dPdh ', P, PDOT, dPdh
        WRITE(6,8)' RLAT, SITEHT  ', RLAT, SITEHT
        WRITE(6,8)' ZD, ZDDOT, dZDdh ', ZD, ZDDOT, dZDdh
        WRITE(6,8)' F, dFdh   ', F, dFdh
      Endif
!
      RETURN
      END
!************************************************************************
      SUBROUTINE SASTW(RH,TC,RHDOT,TCDOT,ZW,ZWDOT)
      IMPLICIT NONE
!
!     SASTW PROGRAM SPECIFICATION
!
!     Calculate zenith delay due to the 'wet' (non-hydrostatic) component of
!     the atmosphere using Saastamoinen formula (19a) (Ref. 1).  The saturation
!     vapor pressure is calculated using the formula found in MET03,  which is
!     much simpler than that found in "Methods of Experimental Physics B"
!    (1976) p. 187, but agrees to 0.3% over the range 0 - 40 deg. C.
!
!     REFERENCES:
!       1) Saastamoinen, J. "The Use of Artificial Satellites for
!          Geodesy", Geophys. Monograph Series, vol. 15, ed. by
!          S.W.Henriksen et al, AGU, Wash, D.C., pp 247-251, 1972.
!       2) Davis, J.L., et al., "Geodesy by Radio Interferometry:
!          Effects of Atmospheric Modeling Errors on Estimates of
!          Baseline Length", Radio Science, 20, 1593-1607, 1985.
!
!     SASTW INTERFACE
!
      REAL*8 RH, TC, RHDOT, TCDOT, ZW, ZWDOT
!
!     Input Variables:
!       1. RH - Relative humidity (set equal to .5).  (0 <= RH <= 1.0)
!       2. TC - Temperature (a function of height). (Celsius)
!       3. RHDOT - Time derivative of RH (set to 0.0).
!       4. TCDOT - Time derivative of TC (set to 0.0).
!
!     Output Variables:
!       1. ZW    - Zenith path delay of wet component. (meters)
!       2. ZWDOT - Time derivative of zenith delay. (meters/sec)
!
!     SUBROUTINE INTERFACE
!       CALLING SUBROUTINES - ATMP
!       CALLED SUBROUTINES  - None
!
      INCLUDE 'ccon.i'
!
      REAL*8 ESAT, TEMP, ESATDOT
!
!     Program Variables:
!       1. ESAT    - Saturation vapor pressure.
!       2. ESATDOT - Time derivative of saturation pressure.
!       3. TEMP    - Used for intermediate values in calculations.
!
!     Programmers:
!      ??.??.??  ?????????  Created?
!      95.12.18  D. Gordon  Documentation made 'Calc'-like, debug printout
!                           section added.
!
!    SASTW PROGRAM STRUCTURE
!
!---Calculate zenith delay due to'wet' (non-hydrostatic) component
!     of atmosphere using Saastamoinen formula 19a. (Ref 1).
!
!     The saturation vapor pressure is calculated using the formula
!     found in MET03 which is much simpler than that found in Methods
!     of Experimental Physics B (1976) p. 187, but agrees to 0.3%
!     over the range 0 - 40 deg. C.
!
!---Calculate saturation vapor pressure, and time derivative.
!     ESAT = 6.11 * 10**(7.5*TC/(TC+237.3))
      TEMP = TC+237.3D0
      ESAT = 6.11D0 * EXP(17.269D0*TC/TEMP)
      ESATDOT = ESAT * (17.269D0/TEMP - 17.269D0*TC/(TEMP*TEMP))*TCDOT
!
!---Calculate zenith path delay
      ZW = 0.002277D0 * (1255.D0/(TC+273.16D0) + 0.05D0) * RH * ESAT
!
!   ... AND RATE OF CHANGE OF ZENITH PATH DELAY
!       CHANGED 255. TO 1255. IN TCDOT CONTRIBUTION       12-28-87 WEH
!       CHANGED RHDOT CONTRIBUTION FROM ZW*RHDOT/RH       12-28-87  WEH
      TEMP = 273.16D0+TC
      ZWDOT = - 0.002277D0 * (TCDOT*1255.D0/(TEMP*TEMP))*RH*ESAT &
     &  + 0.002277D0 * (1255.D0/(TC+273.16D0) + 0.05D0) * RHDOT * ESAT &
     &  + ZW * ESATDOT/ESAT
!
      If (KATMD .ne. 0)  Then
        WRITE ( 6, 9100 )
 9100   FORMAT (1X, "Debug output for subroutine SASTW." )
    8   FORMAT(A,4D25.16/(7X,5D25.16))
        WRITE(6,8)' RH, RHDOT ', RH, RHDOT
        WRITE(6,8)' TC, TCDOT ', TC, TCDOT
        WRITE(6,8)' ZW, ZWDOT ', ZW, ZWDOT
        WRITE(6,8)' ESAT, TEMP, ESATDOT ', ESAT, TEMP, ESATDOT
      Endif
!
      RETURN
      END
!************************************************************************
      BLOCK DATA ATMCMB
      Implicit none
!
!     ATMBD is the atmosphere module block data input and initialization 
!     section.
!
!     References - Hopfield, H.S., 'Radio Science', 6, 357, 1971,
!                    'JSR', 74, 4487, 1969.
!                - Chau, C.C., 'JPL Technical Manual', #391-129, 1970.
!                - SMART, W.M., 'Textbook on Spherical Astronomy', 1965, P. 68.
!                - Chau, C.C., 'The Tropospheric Calibration Model for Mariner
!                    Mars 1971", JPL Technical Report 32-1587, (NASA Sci & Tech
!                    Info Facility N&$-16983) p. 75, eq. 19 - wet formulation.
!
!     Common blocks:
!
      Real*8 RF(2), RTRACE(2), wetcon(2), Datmp_hmf(2,2),               &
     &       Datmp_wmf(2,2), Zen_dry(2,2), Zen_wet(2,2), Ngrad(2,2,2)
      COMMON /ATMCM/ RF, RTRACE, wetcon, Datmp_hmf, Datmp_wmf, Zen_dry, &
     &               Zen_wet, Ngrad
!
!        Variables 'to':
!           1. RF(2)     - The constants appearing in terms 1 and 2 of the
!                          calculation of the correction angle to be added to
!                          the source elevation angle to find the apparent
!                          source direction due to tropospheric refraction.
!                           RF(1) = 2.826172873D-4 radians
!                           RF(2) = -3.23855539D-7 radians
!           2. RTRACE(2) - The constants appearing in the calculation of the
!                          partial derivatives of the delay and rate with
!                          respect to the zenith path delay at each observing
!                          site. These constants were determined from the
!                          best fit of the ray tracing algorithm for
!                          atmospheric thickness from the zenith to the
!                          horizon. (unitless)  (See references)
!                           RTRACE(1) = 1.43D-3
!                           RTRACE(2) = 4.45D-2
!           3. wetcon(2) - The same as RTRACE, except that RTRACE is
!                          appropriate for the dry atmosphere and wetcon is
!                          appropriate for the wet.
!           4. lat_hmf(5)- Latitudes at which coefficients are defined for the
!                          Niell mapping function.
!           5. abc_avg(5,3) - Continued fraction coefficients at latitudes
!                          lat_hmf
!           6. abc_amp(5,3) - Amplitude of annual variation of abc_avg.
!           7. a_ht, b_ht, c_ht - Parameters for continued fraction for height
!                          correction.
!
      Real*8 lat_hmf(5), abc_avg(5,3), abc_amp(5,3), a_ht, b_ht, c_ht
      Common / hmf2_coef/ lat_hmf, abc_avg, abc_amp, a_ht, b_ht, c_ht
!
!     Program specifications -
!
!   Define parameters used for calculating coefficients.
!
      Data lat_hmf / 15.D0, 30.D0, 45.D0, 60.D0, 75.D0/
!
      Data abc_avg / &
     &1.2769934D-3,1.2683230D-3,1.2465397D-3,1.2196049D-3,1.2045996D-3, &
     &2.9153695D-3,2.9152299D-3,2.9288445D-3,2.9022565D-3,2.9024912D-3, &
     &62.610505D-3,62.837393D-3,63.721774D-3,63.824265D-3,64.258455D-3/
!
      Data abc_amp / &
     &  0.0,   1.2709626D-5, 2.6523662D-5, 3.4000452D-5, 4.1202191D-5, &
     &  0.0,   2.1414979D-5, 3.0160779D-5, 7.2562722D-5, 11.723375D-5, &
     &  0.0,   9.0128400D-5, 4.3497037D-5, 84.795348D-5, 170.37206D-5/
!
      Data a_ht / 2.53D-5/
      Data b_ht / 5.49D-3/
      Data c_ht / 1.14D-3/
!
      Data  RF     / 2.826172873D-4, -3.23855539D-7 /
      Data  RTRACE / 1.43D-3, 4.45D-2 /
      Data  wetcon / 0.35d-3, 1.7d-2 /
!
!    Constants used - RF, RTRACE
!
!    Programmer - Dale Markham  01/13/77
!     77.07.11  Peter Denatale
!     89.05.24  Jim Ryan - Wet partials info added.
!
      END
!
!***********************************************************************
!
      SUBROUTINE NFATM (R2K, STAR, STAR12, STAR12dt, EARTH, TCTOCF,     &
     &           SITEV, SITEA, R2K6m1, R2K6p1, R1mag, R2mag,            &
     &           STAR_ABERRATED, STAR_ABERRATEDdt )
      Implicit none
!
!       NFATMG
!
!       NFATMG is the geometry section for the near-field atmosphere 
!       computations. It computes the  aberrated source vector and the 
!       elevation of the aberrated source and  its CT time derivative at
!       each site.
!         NOT USED IN THE DATABASE VERSION.
!
!       References - Smart, W.M., 'Textbook on Spherical Astronomy', 1965, P. 68
!
!       NFATMG program interface
!
!       Calling sequence -
!           Input variables:
!             1. R2K(3,3,3)    - The complete crust fixed to J2000.0 rotation
!                                matrix and its first two CT time derivatives.
!                                (unitless, 1/sec, 1/sec**2)
!             2. STAR(3)       - The J2000.0 source unit vector. (unitless)
!             3. EARTH(3,3)    - The SSBC position, velocity and acceleration of
!                                the Earth. (m,m/s,m/s**2)
!             4. TCTOCF(3,3,2) - The rotation matrix which rotates the
!                                topocentric reference system to the crust fixed
!                                geocentric reference system at each observation
!                                site. (unitless)
!             5. SITEV(3,2)    - The J2000.0 geocentric velocity of each site.
!                                (m/sec)
!             6. STAR12(3,2)   - The J2000.0 source unit vestors from stations
!                                1 and 2. (unitless). For Far-field sources,
!                                these are the same as STAR(3). 
!
!           Output variables:
!             1. STAR_ABERRATED(3,2) - The J2000 source unit vector with
!                            aberration applied at each observing site.
!
!     Common blocks used -
!
      Real*8 RF(2), RTRACE(2), wetcon(2), Datmp_hmf(2,2),               &
     &       Datmp_wmf(2,2), Zen_dry(2,2), Zen_wet(2,2), Ngrad(2,2,2)
      COMMON /ATMCM/ RF, RTRACE, wetcon, Datmp_hmf, Datmp_wmf, Zen_dry, &
     &               Zen_wet, Ngrad
!           Variables 'from':
!             1. RF(2) - The constants appearing in terms 1 and 2 in the
!                        calculation of the correction angle to be added to
!                        the source zenith angle to find the apparent source
!                        direction due to tropospheric refraction. - See
!                        references. (Radians)
!
      INCLUDE 'ccon.i'
!           Variables 'from':
!             1. KATMC  -  The atmosphere module flow control flag.
!             2. KATMD  -  The atmosphere module debug output flag.
!
      Include 'cphys11.i'
!           Variables from:
!             1. VLIGHT  -  The speed of light. (m/s)
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      INCLUDE 'cuser11.i'
!       Variables to:
!          1. C_mode -
!
      INCLUDE 'put2s.i'
!       Variables to:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
      INCLUDE 'd_input.i'
!       Variables from:
!        1. 
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           Variables 'from' :
!             1. TWOPI  -  The mathematical constant 2 * PI
!
!     Program specifications -
      Real*8 CFSTAR(3,2), CFTOTC(3,3), R2K(3,3,3), SITLAT(2),           &
     &       STAR(3), TCSTAR(3,2), TCTOCF(3,3,2), TR2000(3,3,2),        &
     &       TAZ(2,2), STAR_ABERRATED(3,2), STAR_ABERRATEDdt(3,2),      &
     &       STAR12(3,2), STAR12dt(3,2), Earthplus(3), Earthplusdt(3),  &
     &       VRdt, STab
      Real*8 DOTP, EARTH(3,3), VR, SITEV(3,2), SITEA(3,2)
      Real*8 VECMG, starcheck, K_Unit_Aberr(3), K_Unit_Aberrdt(3),      &
     &       Vel_dif(3),  Vel_difdt(3), CFdt1(3), CFdt2(3), CFdt3(3),  CFdt4(3), TR2003(3,3)
      Real*8 cr1(3), cr2(3), cr3(3), R1mag, R2mag, Rmag
      Real*8 R2K6m1(3,3,3), R2K6p1(3,3,3) 
      Real*8 Stm1(3), STAR_ABm1(3), TR2Km1(3,3), CFSTm1(3), Div,        &
     &       Stp1(3), STAR_ABp1(3), TR2Kp1(3,3), CFSTp1(3), CFSTdf(3) 
      Real*8 AZQUAD
      Integer*4 I, L
!
!
!      Subroutine interface -
!             Caller subroutines: DRIVG
!             Called subroutines: DASIN, DCOS, MTRAN, VECRT, DATAN2
!
!      Program variables -
!           1. CFSTAR(3,2)   - The aberratted source unit vector in the crust
!                              fixed geocentric reference system and its CT
!                              time derivative. (unitless, 1/sec)
!           2. CFTOTC(3,3)   - The 3x3 rotation matrix which rotates the
!                              geocentric crust fixed reference system to the
!                              topocentric reference system. (unitless)
!           3. TCSTAR(3,2)   - The aberratted source unit vector in the
!                              topocentric reference system and its CT time
!                              derivative.
!                              (unitless, 1/sec)
!           4. TR2000(3,3,2) - The complete J2000.0 to crust fixed rotation
!                              matrix and its first CT time derivative.
!                              (unitless, 1/sec)
!           5. TAZ(2,2)      - A temporary array used in the computation of AZ
!                              (rad,rad/sec)
!           6. AZQUAD        - A variable used to force the source azimuth into
!                              the range 0 to TWOPI rather than -PI to PI.
!           7. VR            - Barycentric speed of the Earth in the direction
!                              of the source.
!
!       Programmer - Dale Markham  01/13/77
!        77.11.07  Peter Denatale
!        78.02.13  Bruce Schupler
!        87.06.03  Savita Goel   CDS for A900)
!        89.05.22  Gregg Cooke
!        89.07.27  Jim Ryan      Documentation simpfilied.
!        89.12.12  Jim Ryan      UNIX-like database interface implimented.
!        89.05.25  Jim Ryan      Documentation simplified again.
!        91:11:05  Jim Ryan      Logic to account for source position
!                                aberration added to the elevation and
!                                azimuth computation.
!        91:12:30  Jim Ryan      Two equations involving VR have had the sign
!                                flipped to make to use of VR consistent with
!                                it definition.
!        93.05.19  David Gordon  STAR_ABERRATED spelling corrected, changed to
!                                a (3,2) variable, diurnal aberration added,
!                                and renormalized to a unit vector. Replaced
!                                derivative of STAR with STAR_ABERRATED for
!                                derivatives of azimuth and elevation
!                                computation.
!        94.03.03  David Gordon  Added computation for unmodified (unaberrated)
!                                source elevations and azimuths.
!        94.10.24  David Gordon  Removed computation of unmodified (unaberrated)
!                                source elevations and azimuths.
!        95.12.18  David Gordon  SITEV added to debug printout.
!        98.08.05  David Gordon  Mods for geocenter station.
!        Sept 2002 Jim Ryan      Interger*2/4 mods.
!        Jan. 2013 David Gordon  PUT's moved to subroutine PUT_G. 
!        Feb-Mar 2013 D. Gordon  Modified for the near-field case.
!
!  ATMG program structure
!
!   Loop twice for the calculation of the elevation and azimuth angles
!   and their CT time derivatives at each site.
!
      DO 500  L = 1,2
!
!  Apply aberration to the J2000 unit vector. The near-field object's
!   velocity is geocentric, so we do not include the Earth's SSB velocity.
        Call VECSB (SITEV(1,L), SPvxyz, Vel_dif)
        VR = DOTP(STAR12(1,L),Vel_dif  )
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!! Temporary test for near/far field comparisons !!!!!!!!!!!!!!!!!!!!!
!       Write (6,*) ' NFATM Test: L = ', L
!       Write (6,*) 'VR  ', VR
!       Call Vecad(EARTH(1,2),Vel_dif,Earthplus)
!       VR = DOTP(STAR12(1,L),Earthplus)
!       Write (6,*) 'VR  ', VR
!       Vel_dif(1) = Earthplus(1)
!       Vel_dif(2) = Earthplus(2)
!       Vel_dif(3) = Earthplus(3)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write (6,*) '            '
!       Write (6,*) 'Subroutine NFATM: L=  ', L
!       Write (6,*) 'SITEV   ', SITEV(1,L), SITEV(2,L), SITEV(3,L)
!       Write (6,*) 'SPvxyz  ', SPvxyz
!       Write (6,*) 'Vel_dif ' , Vel_dif 
!       Write (6,*) 'EARTH(1,2) ', EARTH(1,2), EARTH(2,2), EARTH(3,2)
!       Write (6,*) 'Earthplus ', Earthplus
!
       Do I = 1,3
          STAR_ABERRATED(I,L) = STAR12(I,L)                             &
     &    + (Vel_dif(I) - VR*STAR12(I,L)) / VLIGHT
       Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write (6,*) 'STAR12 ', STAR12(1,L), STAR12(2,L), STAR12(3,L)
!       Write (6,*) 'STAR_ABERRATED ', STAR_ABERRATED(1,L),             &
!    &               STAR_ABERRATED(2,L), STAR_ABERRATED(3,L)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Normalize for further use here, but keep initial vector for later use
!    in the axis offset module
             Call VUNIT(Star_Aberrated(1,L), K_Unit_Aberr)
             STab = VECMG(Star_Aberrated(1,L))
!       Write (6,*) 'K_Unit_Aberr ', K_Unit_Aberr(1), K_Unit_Aberr(2),  &
!    &               K_Unit_Aberr(3)
!       Write (6,*) 'STab  ' , STab    
!
! Time derivative of STAR_ABERRATED
        Call VECSB (SITEA(1,L), SPaxyz, Vel_difdt)
!       Write (6,*) 'SITEA   ', SITEA(1,L), SITEA(2,L), SITEA(3,L)
!       Write (6,*) 'SPaxyz  ', SPaxyz
!       Write (6,*) 'Vel_difdt ' , Vel_difdt 
!       Write (6,*) 'EARTH(1,3) ', EARTH(1,3), EARTH(2,3), EARTH(3,3)
!       Write (6,*) 'Earthplusdt ', Earthplusdt
         VRdt = DOTP(STAR12dt(1,L),Vel_dif) +                         &
     &          DOTP(STAR12(1,L),Vel_difdt)
!       Write (6,*) 'VRdt ', VRdt
!
       DO I = 1,3
        STAR_ABERRATEDdt(I,L) =  STAR12dt(I,L) + Vel_difdt(I)/VLIGHT  &
     &    - (VR*STAR12dt(I,L))/VLIGHT - (VRdt*STAR12(I,L))/VLIGHT 
!         Normalize: 
        K_Unit_Aberrdt(I) = STAR_ABERRATEDdt(I,L) / STab
       Enddo
!       Write (6,*) 'STAR12dt ', STAR12dt(1,L), STAR12dt(2,L),          &
!    &               STAR12dt(3,L)
!       Write (6,*) 'STAR_ABERRATEDdt ', STAR_ABERRATEDdt(1,L),         &
!    &               STAR_ABERRATEDdt(2,L), STAR_ABERRATEDdt(3,L)
!       Write (6,*) 'K_Unit_Aberrdt ', K_Unit_Aberrdt(1),               &
!    &               K_Unit_Aberrdt(2), K_Unit_Aberrdt(3)
!
!
!  Check for geocenter station
       IF (L .eq. Nzero) Go to 450
!
!  Rotate the J2000.0 source unit vector to the topocentric system.
!   (NOTE: The topocentric system sits at the observation site with the axes
!    pointing Up, East and North.
!
!  Compute the rotation matrix which rotates from the geocentric crust fixed
!    system to the topocentric system.
            CALL MTRAN ( TCTOCF(1,1,L), CFTOTC )
!
!  Compute the rotation matrix which rotates from the J2000.0 system to the
!    geocentric crust fixed system.
            CALL MTRAN ( R2K(1,1,1), TR2000(1,1,1) )
!
!
!  Rotate to the crust fixed system:
!!!!!!      CALL VECRT (TR2000(1,1,1),STAR_ABERRATED(1,L),CFSTAR(1,1))
            CALL VECRT (TR2000(1,1,1),K_Unit_Aberr       ,CFSTAR(1,1))
!
!  Rotate to the topocentric system:
            CALL VECRT (CFTOTC, CFSTAR(1,1), TCSTAR(1,1))
!
!     Compute the CT time derivative of the aberrated source unit vector
!      in the topocentric system.
!*          CALL MTRAN (R2K(1,1,2), TR2000(1,1,2) )
!
!*          CALL VECRT (TR2000(1,1,2),K_Unit_Aberr,CFdt1)
!*          CALL VECRT (TR2000(1,1,1),K_Unit_Aberrdt,CFdt2)
!*          CALL VECAD (CFdt1, CFdt2, CFSTAR(1,2))
!
!      Write (6,*) ' NFATM: L = ', L
!      WRITE(6,8)' R2K6    ', R2K   
!      WRITE(6,8)' TR2000  ',TR2000
!*     Write (6,*) 'CFSTAR(1) ', CFSTAR(1,1), CFSTAR(2,1), CFSTAR(3,1)
!*     Write (6,*) 'CFSTAR(2) ', CFSTAR(1,2), CFSTAR(2,2), CFSTAR(3,2)
!*     Write (6,*) 'CFdt1     ', CFdt1 
!*     Write (6,*) 'CFdt2     ', CFdt2 
!
!*          CALL VECRT (TR2000(1,1,2),K_Unit_Aberrdt,CFdt3)
!*          CALL MTRAN (R2K(1,1,3), TR2003(1,1) )
!*          CALL VECRT (TR2003(1,1),K_Unit_Aberr,CFdt4)
!*          Write (6,*) 'CFdt3     ', CFdt3 
!*          Write (6,*) 'CFdt4     ', CFdt4 
!           Call CROSP(K_Unit_Aberr,SITEV(1,L), cr1)
!           Call CROSP(K_Unit_Aberr,cr1,cr2)
!            If (L .eq. 1) Rmag = R1mag
!            If (L .eq. 2) Rmag = R2mag
!           Call VECDV(cr2,Rmag,cr3)
!           Write (6,*) 'cr3       ', cr3   
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!  Note: the traditional computations to get the time derivative of 
!!        the crust-fixed and topocentric aberrated source vector does
!!        not work for the near-field case. Instead we compute a 
!!        numerical derivative.
!  Compute aberrated star vectors and the J2000 => Crust-Fixed rotation
!  matrices at -1 and +1 second offset from epoch
            CALL VECSB (STAR_ABERRATED(1,L), STAR_ABERRATEDdt(1,L),Stm1)
            CALL VUNIT (Stm1, STAR_ABm1)
!           Write (6,*) 'STAR_ABm1 ', STAR_ABm1
            CALL MTRAN ( R2K6m1(1,1,1), TR2Km1 )
            CALL VECRT (TR2Km1, STAR_ABm1, CFSTm1)
!           Write (6,*) 'CFSTm1    ', CFSTm1   
!
            CALL VECAD (STAR_ABERRATED(1,L), STAR_ABERRATEDdt(1,L),Stp1)
            CALL VUNIT (Stp1, STAR_ABp1)
!           Write (6,*) 'STAR_ABp1 ', STAR_ABp1
            CALL MTRAN ( R2K6p1(1,1,1), TR2Kp1(1,1) )
            CALL VECRT (TR2Kp1(1,1), STAR_ABp1, CFSTp1)
!           Write (6,*) 'CFSTp1    ', CFSTp1   
! Take numerical derivative
            CALL VECSB (CFSTp1, CFSTm1, CFSTdf)
             Div = 2.0D0
            CALL VECDV(CFSTdf, Div, CFSTAR(1,2))
!      Write (6,*) 'CFSTAR(1) ', CFSTAR(1,1), CFSTAR(2,1), CFSTAR(3,1)
!      Write (6,*) 'CFSTAR(2)   ', CFSTAR(1,2), CFSTAR(2,2), CFSTAR(3,2)
!!! TEST, shift R2K(1,1,1) by +1 seconds??
!             Write(6,1037) R2K
!1037  Format(1x,'NFATM/R2K6: ',(9(/,3E25.15)))
!           Call MADD2 (R2K(1,1,1), R2K(1,1,2), R2Kp1)
!             Write(6,1037) R2K
!             Write(6,1038) R2Kp1
!1038  Format(1x,'NFATM/R2K6p1: ',(3(/,3E25.15)))
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
            CALL VECRT (CFTOTC, CFSTAR(1,2), TCSTAR(1,2) )
!       Write (6,*) 'TCSTAR(1) ', TCSTAR(1,1), TCSTAR(2,1), TCSTAR(3,1)
!       Write (6,*) 'TCSTAR(2) ', TCSTAR(1,2), TCSTAR(2,2), TCSTAR(3,2)
!
!  Compute the elevation angle of the aberrated source.
            ELEV(L,1) = DASIN ( TCSTAR(1,1) )
!  Compute the azimuth angle of the aberrated source.
            TAZ(L,1) = DATAN2(TCSTAR(2,1),TCSTAR(3,1))
            AZQUAD = 0.0D0
            IF (TAZ(L,1) .LT. 0.0D0) AZQUAD = TWOPI
            AZ(L,1) = TAZ(L,1) + AZQUAD
!
!  Compute time derivatives of elevation and azimuth
            ELEV(L,2) = TCSTAR(1,2) / DCOS ( ELEV(L,1) )
            AZ(L,2) = ( (TCSTAR(2,2) / TCSTAR(3,1)) -                   &
     &                (TCSTAR(2,1) * TCSTAR(3,2) / TCSTAR(3,1)**2) ) /  &
     &                (1.0D0 + (TCSTAR(2,1) / TCSTAR(3,1))**2)
!       Write (6,*) 'ELEV ', ELEV(L,1), ELEV(L,2)
!       Write (6,*) 'AZ   ', AZ(L,1), AZ(L,2)
!
       GO TO 475
!
  450 CONTINUE
!      Geocenter station special handling
!           WRITE ( 6, * ) 'ATMG/Nzero: SITEV = ', SITEV
!           call vecad(EARTH(1,2),SITEV(1,L),Earthplus)
!           VR = DOTP(STAR,Earthplus)
!          Do I = 1,3
!            STAR_ABERRATED(I,L) = STAR(I) &
!    &       + (Earthplus(i) - VR*STAR(I)) / VLIGHT
!          Enddo
            ELEV(L,1) = HALFPI
            AZ(L,1)   = 0.0D0
            ELEV(L,2) = 0.0D0
            AZ(L,2)   = 0.0D0
  475 CONTINUE
! 
!  Pass a unit vector to the axis offset module
        Do I = 1,3
          STAR_ABERRATED(I,L)   = K_Unit_Aberr(I) 
          STAR_ABERRATEDdt(I,L) = K_Unit_Aberrdt(I) 
        Enddo
 
!     Close the loop which runs over the sites.
  500 CONTINUE
!
!     Write (6,*) 'Elevations: ', ELEV(1,1)/CONVD, ELEV(2,1)/CONVD
!   Check for debug output.
      IF ( KATMD .ne. 0 )  Then
      WRITE ( 6, 9100 )
 9100 FORMAT (/," Debug output for subroutine ATMG." )
    8 FORMAT(A,3D25.16/(7X,3D25.16))
      WRITE(6,8)' CFSTAR  ',CFSTAR
      WRITE(6,8)' CFTOTC  ',CFTOTC
      WRITE(6,8)' TCSTAR  ',TCSTAR
      WRITE(6,8)' TR2000  ',TR2000
      write(6,8) ' SITEV  ', SITEV
      write(6,8) ' EARTH  ', EARTH
      write(6,8) ' Earthplus ', Earthplus
      write(6,8) ' VR        ', VR
      write(6,8) ' STAR           ', STAR
      write(6,8) ' STAR_ABERRATED ', STAR_ABERRATED
      WRITE(6,8)' ELEV    ',ELEV
      WRITE(6,8)' AZ      ',AZ
      WRITE(6,8)' TAZ     ',TAZ
      WRITE(6,8)' AZQUAD  ',AZQUAD
      WRITE ( 6, 9200 )  R2K, STAR, TCTOCF,TWOPI
 9200 FORMAT (1X, "R2K    = ", 9 ( 3 ( D30.16, 10X ), /, 1X ), /, 1X, &
     &            "STAR   = ", 3 ( D30.16, 4X ), /, 1X, &
     &            "TCTOCF = ", 6 ( 3 ( D30.16, 10X ), /, 1X ),1X, &
     &            "TWOPI  = ",D30.16)
!
      Endif
!
      RETURN
      END
!************************************************************************
      SUBROUTINE ATMGuv (R2K, K_EWNS, EARTH, TCTOCF, SITEV, K_EWNS_ab,  &
     &           AZ_ab, EL_ab)
      Implicit none
!
!      ATMGab
!
!      ATMGab  computes the aberrated source vectors for the E,W,N,S 
!       offset source unit vectors and their elevation angles. 
!
!       Calling sequence -
!           Input variables:
!             1. R2K(3,3,3)    - The complete crust fixed to J2000.0 rotation
!                                matrix and its first two CT time derivatives.
!                                (unitless, 1/sec, 1/sec**2)
!             2. K_EWNS(3,4)   - The J2000.0 E,W,N,S offset source unit vectors.
!             3. EARTH(3,3)    - The SSBC position, velocity and acceleration of
!                                the Earth. (m,m/s,m/s**2)
!             4. TCTOCF(3,3,2) - The rotation matrix which rotates the
!                                topocentric reference system to the crust fixed
!                                geocentric reference system at each observation
!                                site. (unitless)
!             5. SITEV(3,2)    - The J2000.0 geocentric velocity of each site.
!                                (m/sec)
!           Output variables:
!             1. K_EWNS_ab(3,4)- The J2000 source unit vectors with
!                            aberration applied at each observing site.
!             1. ELEV_ab(4) - The E,W,N,S offset elevation angles corrrected for
!                             aberration at site 2. (rad)
!             2. AZ_ab(4)   - The E,W,N,S offset azimuth angles corrrected for
!                             aberration at site 2. (rad)
!
!     Common blocks used -
!
!     INCLUDE 'ccon.i'
!           Variables 'from':
!             1. KATMC  -  The atmosphere module flow control flag.
!             2. KATMD  -  The atmosphere module debug output flag.
!
      Include 'cphys11.i'
!           Variables from:
!             1. VLIGHT  -  The speed of light. (m/s)
!
!     INCLUDE 'cuser11.i'
!       Variables to:
!          1. C_mode -
!
      INCLUDE 'put2s.i'
!       Variables from:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
!
!     INCLUDE 'd_input.i'
!       Variables from:
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           Variables 'from' :
!             1. TWOPI  -  The mathematical constant 2 * PI
!
!     Program specifications -
      Real*8  CFSTAR(3,2), CFTOTC(3,3), R2K(3,3,3), SITLAT(2),          &
     &        K_EWNS(3,4), TCSTAR(3,2), TCTOCF(3,3,2), TR2000(3,3,2),   &
     &        TAZ(2),K_EWNS_ab(3,4)
!
      Real*8 DOTP, EARTH(3,3), VR, SITEV(3,2), Earthplus(3)
      Real*8 Vecmg, starcheck, K_Unit_Aberr(3), Vel_dif(3)
      Real*8 AZQUAD, AZ_ab(4), EL_ab(4)
      Integer*4 I, L
!
!
!      Program variables -
!           1. CFSTAR(3,2)   - The aberratted source unit vector in the crust
!                              fixed geocentric reference system and its CT
!                              time derivative. (unitless, 1/sec)
!           2. CFTOTC(3,3)   - The 3x3 rotation matrix which rotates the
!                              geocentric crust fixed reference system to the
!                              topocentric reference system. (unitless)
!           3. TCSTAR(3,2)   - The aberratted source unit vector in the
!                              topocentric reference system and its CT time
!                              derivative.
!                              (unitless, 1/sec)
!           4. TR2000(3,3,2) - The complete J2000.0 to crust fixed rotation
!                              matrix and its first CT time derivative.
!                              (unitless, 1/sec)
!           5. TAZ(2)        - A temporary array used in the computation of AZ
!                              (rad)
!           6. AZQUAD        - A variable used to force the source azimuth into
!                              the range 0 to TWOPI rather than -PI to PI.
!           7. VR            - Barycentric speed of the Earth in the direction
!                              of the source.
!
!       Programmer:
!        May  2016 David Gordon  Modified version of Subroutine ATMG.
!
!     Write(6,*) ' ATMGuv output: '
!     Write(6,*) ' Az, El:         ', AZ(2,1)/CONVD, ELEV(2,1)/CONVD
!
!  ATMGuv program structure
!
!   Loop four times for the calculation of the elevation and azimuth angles.
!
!  Compute the rotation matrix which rotates from the geocentric crust fixed
!    system to the topocentric system.
            CALL MTRAN ( TCTOCF(1,1,2), CFTOTC )
!  Compute the rotation matrix which rotates from the J2000.0 system to the
!    geocentric crust fixed system.
            CALL MTRAN ( R2K(1,1,1), TR2000(1,1,1) )
!
        Call Vecad(EARTH(1,2),SITEV(1,2),Earthplus)
!
      DO L = 1, 4
!  Apply aberration to the J2000 unit vectors. 
        VR = DOTP(K_EWNS(1,L),Earthplus)
        Do I = 1,3
          K_EWNS_ab(I,L) = K_EWNS(I,L)                          &
     &    + (Earthplus(I) - VR*K_EWNS(I,L)) / VLIGHT
        Enddo
!
!  Normalize to a unit vector
             Call VUNIT(K_EWNS_ab(1,L), K_Unit_Aberr)
!
!  Rotate to the crust fixed system:
            CALL VECRT (TR2000(1,1,1),K_Unit_Aberr       ,CFSTAR(1,1))
!  Rotate to the topocentric system:
            CALL VECRT (CFTOTC, CFSTAR(1,1), TCSTAR(1,1))
!
!  Compute the aberrated elevation angles.
            EL_ab(L) = DASIN ( TCSTAR(1,1) )
!  Compute the aberrated azimuth angles.
            TAZ(L) = DATAN2(TCSTAR(2,1),TCSTAR(3,1))
            AZQUAD = 0.0D0
            IF (TAZ(L) .LT. 0.0D0) AZQUAD = TWOPI
            AZ_ab(L) = TAZ(L) + AZQUAD
!
!     Write(6,*) 'L, AZ_ab, EL_ab: ', L, AZ_ab(L)/CONVD, EL_ab(L)/CONVD
!
      ENDDO
!
      RETURN
      END
!
!***********************************************************************
      SUBROUTINE NFATMuv (R2K, STAR2, TCTOCF, SITEV, STAR12, STAR2_ab,  &
     &            AZ_ab, EL_ab )
      Implicit none
!
!       NFATMG
!
!       NFATMG is the geometry section for the near-field atmosphere 
!       computations. It computes the  aberrated source vector and the 
!       elevation of the aberrated source and  its CT time derivative at
!       each site.
!
!       Calling sequence -
!           Input variables:
!             1. R2K(3,3,3)    - The complete crust fixed to J2000.0 rotation
!                                matrix and its first two CT time derivatives.
!                                (unitless, 1/sec, 1/sec**2)
!             2. STAR2(3,4)    - The J2000.0 source unit vector  for the East,
!                                West, North, and South offsets. (unitless)
!             4. TCTOCF(3,3,2) - The rotation matrix which rotates the
!                                topocentric reference system to the crust fixed
!                                geocentric reference system at each observation
!                                site. (unitless)
!             5. SITEV(3,2)    - The J2000.0 geocentric velocity of each site.
!                                (m/sec)
!             6. STAR12(3,2)   - The J2000.0 source unit vestors from stations
!                                1 and 2. (unitless). For Far-field sources,
!                                these are the same as STAR(3). 
!
!           Output variables:
!             1. STAR2_ab(3,4) - The STAR2(3,4) vectors with aberration applied
!                                at each site #2.
!
!     Common blocks used -
!
      Real*8 SpEWNS(3,4), R1EWNS(3,4), R2EWNS(3,4), R1EWNSmag(4),       &
     &       R2EWNSmag(4), STAR12EWNS(3,4,2), STARewns(3,4)
      Common / NFewns/ SpEWNS, R1EWNS, R2EWNS, R1EWNSmag, R2EWNSmag,    &
     &       STAR12EWNS, STARewns
!
      Include 'cphys11.i'
!           Variables from:
!             1. VLIGHT  -  The speed of light. (m/s)
!
!???  INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
!???  INCLUDE 'cuser11.i'
!       Variables to:
!          1. C_mode -
!
      INCLUDE 'put2s.i'
!       Variables to:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!        2. AZ(2,2)   - The azimuth angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
      INCLUDE 'd_input.i'
!       Variables from:
!        1. 
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!           Variables 'from' :
!             1. TWOPI  -  The mathematical constant 2 * PI
!
!     Program specifications -
      Real*8 CFSTAR(3,2), CFTOTC(3,3), R2K(3,3,3), STAR2(3,4),          &
     &       TCSTAR(3,2), TCTOCF(3,3,2), TR2000(3,3,2), TAZ(2,2),       &
     &        AZQUAD, STAR2_ab(3,4),STAR12(3,2), SITEV(3,2)
      Real*8 Vec_ab(3), EL_ab(4), AZ_ab(4), Vel_dif(3)
      Real*8 DOTP, VR, VECMG
      Integer*4 I, L
!
!      Program variables -
!           1. CFSTAR(3,2)   - The aberratted source unit vector in the crust
!                              fixed geocentric reference system and its CT
!                              time derivative. (unitless, 1/sec)
!           2. CFTOTC(3,3)   - The 3x3 rotation matrix which rotates the
!                              geocentric crust fixed reference system to the
!                              topocentric reference system. (unitless)
!           3. TCSTAR(3,2)   - The aberratted source unit vector in the
!                              topocentric reference system and its CT time
!                              derivative.
!                              (unitless, 1/sec)
!           4. TR2000(3,3,2) - The complete J2000.0 to crust fixed rotation
!                              matrix and its first CT time derivative.
!                              (unitless, 1/sec)
!           5. TAZ(2,2)      - A temporary array used in the computation of AZ
!                              (rad,rad/sec)
!           6. AZQUAD        - A variable used to force the source azimuth into
!                              the range 0 to TWOPI rather than -PI to PI.
!           7. VR            - Relative speed of site #2 in the direction
!                              of the source.
!
!       Programmer - David Gordon  27-May-2016 
!
!  NFATMuv program structure
!      write(6,*) ' ***********  NFATMuv  *********** '
!
!  Compute the rotation matrix which rotates from the geocentric crust fixed
!    system to the topocentric system.
            CALL MTRAN ( TCTOCF(1,1,2), CFTOTC )
!  Compute the rotation matrix which rotates from the J2000.0 system to the
!    geocentric crust fixed system.
            CALL MTRAN ( R2K(1,1,1), TR2000(1,1,1) )
!
!   Calculate the elevation and azimuth angles for the 4 offset positions
      Do L = 1, 4            ! East, West, North, South offsets
!
!  Apply aberration to the J2000 unit vectors at site 2. The near-field object's
!   velocity is geocentric, so we do not include the Earth's SSB velocity.
        Call VECSB (SITEV(1,2), SPvxyz, Vel_dif)
!       VR = DOTP(STAR2(1,L),Vel_dif  )
        VR = DOTP(STAR12EWNS(1,L,2),Vel_dif  )
!
       Do I = 1,3
!         Vec_ab(I) = STAR2(I,L) + (Vel_dif(I) - VR*STAR2(I,L)) / VLIGHT
          Vec_ab(I) = STAR12EWNS(I,L,2) + (Vel_dif(I) -                 &
     &                VR*STAR12EWNS(I,L,2)) / VLIGHT
       Enddo
       Call VUNIT(Vec_ab, Star2_ab(1,L))
!
!       Write (6,*) 'L, STAR2    ', L, STAR2(1,L), STAR2(2,L), STAR2(3,L)
!       Write (6,*) 'L, STAR2_ab ', L, STAR2_ab(1,L), STAR2_ab(2,L), STAR2_ab(3,L)
!
!  Rotate to the crust fixed system:
            CALL VECRT (TR2000(1,1,1),STAR2_ab(1,L),CFSTAR(1,1))
!  Rotate to the topocentric system:
            CALL VECRT (CFTOTC, CFSTAR(1,1), TCSTAR(1,1))
!
!  Compute the elevation angle of the aberrated source.
            EL_ab(L) = DASIN ( TCSTAR(1,1) )
!  Compute the azimuth angle of the aberrated source.
            TAZ(L,1) = DATAN2(TCSTAR(2,1),TCSTAR(3,1))
            AZQUAD = 0.0D0
            IF (TAZ(L,1) .LT. 0.0D0) AZQUAD = TWOPI
            AZ_ab(L) = TAZ(L,1) + AZQUAD
!
      Enddo
!
!       Write (6,*) 'AZ, ELEV           ', AZ(2,1), ELEV(2,1)
!       Do L=1,4
!        Write (6,*) 'L, AZ_ab, EL_ab ', L, AZ_ab(L), EL_ab(L)
!       Enddo
!
!      STOP
!
      RETURN
      END
!
!***********************************************************************
      SUBROUTINE GMF11 (epoch, dlat, dlon, dhgt, el, gmfh, gmfw)
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     Modified version of gmf.f from Vienna Technical University.
!      Converted to Fortran 90 at GFSC, 2015-OCT-19  -DG-
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     This subroutine determines the Global Mapping Functions GMF
!
!     Reference: Boehm, J., A.E. Niell, P. Tregoning, H. Schuh (2006), 
!     Global Mapping Functions (GMF): A new empirical mapping function 
!     based on numerical weather model data,
!     Geoph. Res. Letters, Vol. 33, L07304, doi:10.1029/2005GL025545.
!
!     input data
!     ----------
!     dmjd: modified julian date
!     dlat: ellipsoidal latitude in radians
!     dlon: longitude in radians
!     dhgt: height in m
!     zd:   zenith distance in radians
!
!     output data
!     -----------
!     gmfh: hydrostatic mapping function
!     gmfw: wet mapping function
!
!     Johannes Boehm, 2005 August 30
!     Rev. Boehm 21 July 2011: latitude -> ellipsoidal latitude
!
      Implicit None
!
      Real*8 epoch, el, dmjd,dlat,dlon,dhgt,zd,gmfh(2),gmfw(2)
      Real*8    dfac(20),P(10,10),aP(55),bP(55),                        &
     &          ah_mean(55),bh_mean(55),ah_amp(55),bh_amp(55),          &
     &          aw_mean(55),bw_mean(55),aw_amp(55),bw_amp(55)
      Real*8 T, DOY, bh, c0h, phh, c11h, c10h, ch, ahm, aha, ah,    &
     &       sine, beta, gamma, topcon, a_ht, b_ht, c_ht, hs_km,        &
     &       ht_corr_coef, ht_corr, bw, cw, awm, awa, aw, sum
      Real*8 d_sine, d_beta, d_gamma, d_ht_corr_coef, d_ht_corr
      Integer*4 I, J, K, N, M, IR
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!
      data (ah_mean(i),i=1,55)/                                         &
     &+1.2517d+02, +8.503d-01, +6.936d-02, -6.760d+00, +1.771d-01,      &
     & +1.130d-02, +5.963d-01, +1.808d-02, +2.801d-03, -1.414d-03,      &
     & -1.212d+00, +9.300d-02, +3.683d-03, +1.095d-03, +4.671d-05,      &
     & +3.959d-01, -3.867d-02, +5.413d-03, -5.289d-04, +3.229d-04,      &
     & +2.067d-05, +3.000d-01, +2.031d-02, +5.900d-03, +4.573d-04,      &
     & -7.619d-05, +2.327d-06, +3.845d-06, +1.182d-01, +1.158d-02,      &
     & +5.445d-03, +6.219d-05, +4.204d-06, -2.093d-06, +1.540d-07,      &
     & -4.280d-08, -4.751d-01, -3.490d-02, +1.758d-03, +4.019d-04,      &
     & -2.799d-06, -1.287d-06, +5.468d-07, +7.580d-08, -6.300d-09,      &
     & -1.160d-01, +8.301d-03, +8.771d-04, +9.955d-05, -1.718d-06,      &
     & -2.012d-06, +1.170d-08, +1.790d-08, -1.300d-09, +1.000d-10/
!
      data (bh_mean(i),i=1,55)/                                         &
     & +0.000d+00, +0.000d+00, +3.249d-02, +0.000d+00, +3.324d-02,      &
     & +1.850d-02, +0.000d+00, -1.115d-01, +2.519d-02, +4.923d-03,      &
     & +0.000d+00, +2.737d-02, +1.595d-02, -7.332d-04, +1.933d-04,      &
     & +0.000d+00, -4.796d-02, +6.381d-03, -1.599d-04, -3.685d-04,      &
     & +1.815d-05, +0.000d+00, +7.033d-02, +2.426d-03, -1.111d-03,      &
     & -1.357d-04, -7.828d-06, +2.547d-06, +0.000d+00, +5.779d-03,      &
     & +3.133d-03, -5.312d-04, -2.028d-05, +2.323d-07, -9.100d-08,      &
     & -1.650d-08, +0.000d+00, +3.688d-02, -8.638d-04, -8.514d-05,      &
     & -2.828d-05, +5.403d-07, +4.390d-07, +1.350d-08, +1.800d-09,      &
     & +0.000d+00, -2.736d-02, -2.977d-04, +8.113d-05, +2.329d-07,      &
     & +8.451d-07, +4.490d-08, -8.100d-09, -1.500d-09, +2.000d-10/
!       
      data (ah_amp(i),i=1,55)/                                          &
     & -2.738d-01, -2.837d+00, +1.298d-02, -3.588d-01, +2.413d-02,      &
     & +3.427d-02, -7.624d-01, +7.272d-02, +2.160d-02, -3.385d-03,      &
     & +4.424d-01, +3.722d-02, +2.195d-02, -1.503d-03, +2.426d-04,      &
     & +3.013d-01, +5.762d-02, +1.019d-02, -4.476d-04, +6.790d-05,      &
     & +3.227d-05, +3.123d-01, -3.535d-02, +4.840d-03, +3.025d-06,      &
     & -4.363d-05, +2.854d-07, -1.286d-06, -6.725d-01, -3.730d-02,      &
     & +8.964d-04, +1.399d-04, -3.990d-06, +7.431d-06, -2.796d-07,      &
     & -1.601d-07, +4.068d-02, -1.352d-02, +7.282d-04, +9.594d-05,      &
     & +2.070d-06, -9.620d-08, -2.742d-07, -6.370d-08, -6.300d-09,      &
     & +8.625d-02, -5.971d-03, +4.705d-04, +2.335d-05, +4.226d-06,      &
     & +2.475d-07, -8.850d-08, -3.600d-08, -2.900d-09, +0.000d+00/
!       
      data (bh_amp(i),i=1,55)/                                          &
     & +0.000d+00, +0.000d+00, -1.136d-01, +0.000d+00, -1.868d-01,      &
     & -1.399d-02, +0.000d+00, -1.043d-01, +1.175d-02, -2.240d-03,      &
     & +0.000d+00, -3.222d-02, +1.333d-02, -2.647d-03, -2.316d-05,      &
     & +0.000d+00, +5.339d-02, +1.107d-02, -3.116d-03, -1.079d-04,      &
     & -1.299d-05, +0.000d+00, +4.861d-03, +8.891d-03, -6.448d-04,      &
     & -1.279d-05, +6.358d-06, -1.417d-07, +0.000d+00, +3.041d-02,      &
     & +1.150d-03, -8.743d-04, -2.781d-05, +6.367d-07, -1.140d-08,      &
     & -4.200d-08, +0.000d+00, -2.982d-02, -3.000d-03, +1.394d-05,      &
     & -3.290d-05, -1.705d-07, +7.440d-08, +2.720d-08, -6.600d-09,      &
     & +0.000d+00, +1.236d-02, -9.981d-04, -3.792d-05, -1.355d-05,      &
     & +1.162d-06, -1.789d-07, +1.470d-08, -2.400d-09, -4.000d-10/
!       
      data (aw_mean(i),i=1,55)/                                         &
     & +5.640d+01, +1.555d+00, -1.011d+00, -3.975d+00, +3.171d-02,      &
     & +1.065d-01, +6.175d-01, +1.376d-01, +4.229d-02, +3.028d-03,      &
     & +1.688d+00, -1.692d-01, +5.478d-02, +2.473d-02, +6.059d-04,      &
     & +2.278d+00, +6.614d-03, -3.505d-04, -6.697d-03, +8.402d-04,      &
     & +7.033d-04, -3.236d+00, +2.184d-01, -4.611d-02, -1.613d-02,      &
     & -1.604d-03, +5.420d-05, +7.922d-05, -2.711d-01, -4.406d-01,      &
     & -3.376d-02, -2.801d-03, -4.090d-04, -2.056d-05, +6.894d-06,      &
     & +2.317d-06, +1.941d+00, -2.562d-01, +1.598d-02, +5.449d-03,      &
     & +3.544d-04, +1.148d-05, +7.503d-06, -5.667d-07, -3.660d-08,      &
     & +8.683d-01, -5.931d-02, -1.864d-03, -1.277d-04, +2.029d-04,      &
     & +1.269d-05, +1.629d-06, +9.660d-08, -1.015d-07, -5.000d-10/
!       
      data (bw_mean(i),i=1,55)/                                         &
     & +0.000d+00, +0.000d+00, +2.592d-01, +0.000d+00, +2.974d-02,      &
     & -5.471d-01, +0.000d+00, -5.926d-01, -1.030d-01, -1.567d-02,      &
     & +0.000d+00, +1.710d-01, +9.025d-02, +2.689d-02, +2.243d-03,      &
     & +0.000d+00, +3.439d-01, +2.402d-02, +5.410d-03, +1.601d-03,      &
     & +9.669d-05, +0.000d+00, +9.502d-02, -3.063d-02, -1.055d-03,      &
     & -1.067d-04, -1.130d-04, +2.124d-05, +0.000d+00, -3.129d-01,      &
     & +8.463d-03, +2.253d-04, +7.413d-05, -9.376d-05, -1.606d-06,      &
     & +2.060d-06, +0.000d+00, +2.739d-01, +1.167d-03, -2.246d-05,      &
     & -1.287d-04, -2.438d-05, -7.561d-07, +1.158d-06, +4.950d-08,      &
     & +0.000d+00, -1.344d-01, +5.342d-03, +3.775d-04, -6.756d-05,      &
     & -1.686d-06, -1.184d-06, +2.768d-07, +2.730d-08, +5.700d-09/
!       
      data (aw_amp(i),i=1,55)/                                          &
     & +1.023d-01, -2.695d+00, +3.417d-01, -1.405d-01, +3.175d-01,      &
     & +2.116d-01, +3.536d+00, -1.505d-01, -1.660d-02, +2.967d-02,      &
     & +3.819d-01, -1.695d-01, -7.444d-02, +7.409d-03, -6.262d-03,      &
     & -1.836d+00, -1.759d-02, -6.256d-02, -2.371d-03, +7.947d-04,      &
     & +1.501d-04, -8.603d-01, -1.360d-01, -3.629d-02, -3.706d-03,      &
     & -2.976d-04, +1.857d-05, +3.021d-05, +2.248d+00, -1.178d-01,      &
     & +1.255d-02, +1.134d-03, -2.161d-04, -5.817d-06, +8.836d-07,      &
     & -1.769d-07, +7.313d-01, -1.188d-01, +1.145d-02, +1.011d-03,      &
     & +1.083d-04, +2.570d-06, -2.140d-06, -5.710d-08, +2.000d-08,      &
     & -1.632d+00, -6.948d-03, -3.893d-03, +8.592d-04, +7.577d-05,      &
     & +4.539d-06, -3.852d-07, -2.213d-07, -1.370d-08, +5.800d-09/
!       
      data (bw_amp(i),i=1,55)/                                          &
     & +0.000d+00, +0.000d+00, -8.865d-02, +0.000d+00, -4.309d-01,      &
     & +6.340d-02, +0.000d+00, +1.162d-01, +6.176d-02, -4.234d-03,      &
     & +0.000d+00, +2.530d-01, +4.017d-02, -6.204d-03, +4.977d-03,      &
     & +0.000d+00, -1.737d-01, -5.638d-03, +1.488d-04, +4.857d-04,      &
     & -1.809d-04, +0.000d+00, -1.514d-01, -1.685d-02, +5.333d-03,      &
     & -7.611d-05, +2.394d-05, +8.195d-06, +0.000d+00, +9.326d-02,      &
     & -1.275d-02, -3.071d-04, +5.374d-05, -3.391d-05, -7.436d-06,      &
     & +6.747d-07, +0.000d+00, -8.637d-02, -3.807d-03, -6.833d-04,      &
     & -3.861d-05, -2.268d-05, +1.454d-06, +3.860d-07, -1.068d-07,      &
     & +0.000d+00, -2.658d-02, -1.947d-03, +7.131d-04, -3.506d-05,      &
     & +1.885d-07, +5.792d-07, +3.990d-08, +2.000d-08, -5.700d-09/
!
      dmjd = epoch - 2400000.5D0
      zd = HALFPI - el
!
!     reference day is 28 January
!     this is taken from Niell (1996) to be consistent
      doy = dmjd  - 44239.d0 + 1 - 28
!
!     parameter t
      t = dsin(dlat)
!
!     degree n and order m
      n = 9
      m = 9
!
! determine n!  (faktorielle)  moved by 1
      dfac(1) = 1
      do i = 1,(2*n + 1)
        dfac(i+1) = dfac(i)*i
      end do
!
! determine Legendre functions (Heiskanen and Moritz, Physical Geodesy,
!    1967, eq. 1-62)
      do i = 0,n
        do j = 0,min(i,m)
          ir = int((i - j)/2)
          sum = 0
          do k = 0,ir
            sum = sum + (-1)**k*dfac(2*i - 2*k + 1)/dfac(k + 1)/        &
     &       dfac(i - k + 1)/dfac(i - j - 2*k + 1)*t**(i - j - 2*k)
          end do
!         Legendre functions moved by 1
          P(i + 1,j + 1) = 1.d0/2**i*dsqrt((1 - t**2)**(j))*sum
        end do
      end do
!
!     spherical harmonics
      i = 0
      do n = 0,9
        do m = 0,n
          i = i + 1
          aP(i) = P(n+1,m+1)*dcos(m*dlon)
          bP(i) = P(n+1,m+1)*dsin(m*dlon)
        end do
      end do
!
!     hydrostatic
      bh = 0.0029
      c0h = 0.062
      if (dlat.lt.0) then ! southern hemisphere
        phh  = pi
        c11h = 0.007
        c10h = 0.002
      else                ! northern hemisphere
        phh  = 0
        c11h = 0.005
        c10h = 0.001
      end if
      ch = c0h + ((dcos(doy/365.25d0*2*pi + phh)+1)*c11h/2 + c10h)*    &
     &           (1-dcos(dlat))
!
      ahm = 0.d0
      aha = 0.d0
      do i = 1,55
        ahm = ahm + (ah_mean(i)*aP(i) + bh_mean(i)*bP(i))*1d-5
        aha = aha + (ah_amp(i) *aP(i) + bh_amp(i) *bP(i))*1d-5
      end do
      ah  = ahm + aha*dcos(doy/365.25d0*2.d0*pi)
!
!     sine   = dsin(pi/2 - zd)
      sine   = dsin(el)            ! DG mod
       d_sine = dcos(el)           ! derivative of sine wrt elevation
      beta   = bh/( sine + ch  )
       d_beta = -(bh * d_sine)/(sine + ch)**2   ! derivative of beta wrt elev
      gamma  = ah/( sine + beta)
       d_gamma  = -(ah * (d_sine+d_beta))/(sine + beta)**2
      topcon = (1.d0 + ah/(1.d0 + bh/(1.d0 + ch)))
      gmfh(1)= topcon/(sine+gamma)
       gmfh(2)= -(topcon*(d_sine+d_gamma))/(sine+gamma)**2   !derivative wrt elev
!
!     height correction for hydrostatic mapping function from Niell (1996)
      a_ht = 2.53d-5
      b_ht = 5.49d-3
      c_ht = 1.14d-3
      hs_km  = dhgt/1000.d0
!
      beta   = b_ht/( sine + c_ht )
       d_beta = -(b_ht*d_sine)/(sine + c_ht)**2   ! derivative of beta wrt elev
      gamma  = a_ht/( sine + beta)
       d_gamma  = -(a_ht*(d_sine+d_beta))/(sine+beta)**2
      topcon = (1.d0 + a_ht/(1.d0 + b_ht/(1.d0 + c_ht)))
      ht_corr_coef = 1.d0/sine - topcon/(sine + gamma)
       d_ht_corr_coef = -d_sine/sine**2 + topcon*(d_sine+d_gamma)/(sine+gamma)**2 
      ht_corr      = ht_corr_coef * hs_km
       d_ht_corr   =  d_ht_corr_coef * hs_km
      gmfh(1)      = gmfh(1) + ht_corr
      gmfh(2)      = gmfh(2) + d_ht_corr
!
!     wet
      bw = 0.00146
      cw = 0.04391
!
      awm = 0.d0
      awa = 0.d0
      do i = 1,55
        awm = awm + (aw_mean(i)*aP(i) + bw_mean(i)*bP(i))*1d-5
        awa = awa + (aw_amp(i) *aP(i) + bw_amp(i) *bP(i))*1d-5
      end do
      aw =  awm + awa*dcos(doy/365.25d0*2*pi)
!
      beta   = bw/( sine + cw )
       d_beta = -(bw*d_sine)/(sine + cw)**2
      gamma  = aw/( sine + beta)
       d_gamma  = -(aw*(d_sine+d_beta))/(sine+beta)**2
      topcon = (1.d0 + aw/(1.d0 + bw/(1.d0 + cw)))
      gmfw(1) = topcon/(sine+gamma)
      gmfw(2) = -(topcon*(d_sine+d_gamma))/(sine+gamma)**2
!     
      Return
      End 
!***********************************************************************
      Subroutine EWNS_atmC (gmfh,gmfw, EL_ab, Datmc_h_EWNS,Datmc_w_EWNS)
      Implicit none
!
!   Finds the dry and wet atmosphere delays at the East, West, North
!    and South source offsets. For use in computing (U,V) using the 
!    partial derivatives method.
!
      Real*8 gmfh(2), gmfw(2), Datmc_h_EWNS(4), Datmc_w_EWNS(4),        &
     &       EL_ab(4)
      Real*8 Datmc_h, Datmc_w
      Integer*4 I
!
!     Common blocks used -
!
      Real*8 RF(2), RTRACE(2), wetcon(2), Datmp_hmf(2,2),               &
     &       Datmp_wmf(2,2), Zen_dry(2,2), Zen_wet(2,2), Ngrad(2,2,2)
      COMMON /ATMCM/ RF, RTRACE, wetcon, Datmp_hmf, Datmp_wmf, Zen_dry, &
     &               Zen_wet, Ngrad
!          Variables 'from':
!            1. Zen_dry(2,2)- Dry (hydrostatic) zenith delay (meters), and its
!                            rate of change (m/sec) from Niell. First index runs
!                            over sites, second runs over delay and rate.
!            2. Zen_wet(2,2)- Wet zenith delay (meters), and its rate of change
!                            (m/sec) from Niell. First index runs over sites,
!                            second runs over delay and rate.
!
      INCLUDE 'put2s.i'
!       Variables from:
!        1. ELEV(2,2) - The elevation angle of the source corrrected for
!                       aberration and its CT time derivative at each
!                       site. (rad,rad/sec)
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!
!
       Datmc_h = gmfh(1) * Zen_dry(2,1)
       Datmc_w = gmfw(1) * Zen_wet(2,1)
      Do I = 1, 4
       Datmc_h_EWNS(I) = Datmc_h + (EL_ab(I) - ELEV(2,1)) * gmfh(2) *   &
     &                   Zen_dry(2,1)
       Datmc_w_EWNS(I) = Datmc_w + (EL_ab(I) - ELEV(2,1)) * gmfw(2) *   &
     &                   Zen_wet(2,1)
      Enddo 
!
!      write(6,*) 'EWNS: ', ELEV(2,1)/CONVD, Datmc_h, Datmc_w
!      write(6,*) 'E:    ', EL_ab(1)/CONVD, Datmc_h_EWNS(1), Datmc_w_EWNS(1)
!      write(6,*) 'W:    ', EL_ab(2)/CONVD, Datmc_h_EWNS(2), Datmc_w_EWNS(2)
!      write(6,*) 'N:    ', EL_ab(3)/CONVD, Datmc_h_EWNS(3), Datmc_w_EWNS(3)
!      write(6,*) 'S:    ', EL_ab(4)/CONVD, Datmc_h_EWNS(4), Datmc_w_EWNS(4)
!
      Return
      End
      SUBROUTINE ROTAT ( THETA, I, R )
      IMPLICIT None
!
! 1.    ROTAT
!
! 1.1   ROTAT PROGRAM SPECIFICATION
!
! 1.1.1 ROTAT is the matrix utility routine which creates a matrix 'R' which
!       performs a coordinate system rotation by an angle 'THETA' about
!       coordinate axis 'I' in the counterclockwise direction looking along the
!       axis towards the origin.
!
! 1.1.2 RESTRICTIONS - NONE
!
! 1.1.3 REFERENCES - NONE
!
! 1.2   ROTAT PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. I      -  THE INTEGER FLAG WHICH DETERMINES THE ROTATION AXIS.
!                          (I = 1, 2, 3 REFERS RESPECTIVELY TO ROTATIONS ABOUT
!                          THE X, Y, AND Z AXES.)
!             2. THETA  -  THE ANGLE THROUGH WHICH THE COORDINATE SYSTEM
!                          ROTATION IS PERFORMED. (RAD)
!
!           OUTPUT VARIABLES:
!             1. R(3,3)  -  THE 3x3 ROTATION MATRIX WHICH PERFORMS THE
!                            COORDINATE SYSTEM ROTATION. (UNITLESS)
!
! 1.2.2 COMMON BLOCKS USED -
!
       INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 R(3,3), THETA, C, S
      Integer*2 I
!
! 1.2.4 DATA BASE ACCESS - NONE
!
! 1.2.5 EXTERNAL INPUT/OUTPUT -  NONE
!
!           OUTPUT VARIABLES:
!             1.  POSSIBLE DEBUG OUTPUT
!
! 1.2.6 SUBROUTINE INTERFACE -
!
!             CALLER SUBROUTINES: DIRNL, ETDG, NUTG, PREG, SITI, WOBG
!             CALLED SUBROUTINES: DCOS, DSIN
!
! 1.2.7 CONSTANTS USED - NONE
!
! 1.2.8 PROGRAM VARIABLES -
!             1.  C  -  THE COSINE OF THE ROTATION ANGLE THETA. (UNITLESS)
!             2.  S  -  THE SINE OF THE ROTATION ANGLE THETA. (UNITLESS)
!
! 1.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    SAVITA GOEL    06/04/87 (CDS FOR A900)
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!     ROTAT Program structure
!
!   Compute the cosine and sine of the rotation angle THETA.
      C = DCOS ( THETA )
      S = DSIN ( THETA )
!
!   Go to the right logic depending to the axix of rotation.
      IF ( I .EQ. 1 )  GO TO 300
      IF ( I .EQ. 2 )  GO TO 400
      IF ( I .EQ. 3 )  GO TO 500
!
!   Rotation about the X-axis.
!
!          ( 1  0  0 )
!   R(X) = ( 0  C  S )
!          ( 0 -S  C )
!
  300 R(1,1) = 1.D0
      R(2,1) = 0.D0
      R(3,1) = 0.D0
      R(1,2) = 0.D0
      R(2,2) = +C
      R(3,2) = -S
      R(1,3) = 0.D0
      R(2,3) = +S
      R(3,3) = +C
      GO TO 600
!
!   Rotation about the Y-axis.
!
!          ( C  0 -S )
!   R(Y) = ( 0  1  0 )
!          ( S  0  C )
!
  400 R(1,1) = +C
      R(2,1) = 0.D0
      R(3,1) = +S
      R(1,2) = 0.D0
      R(2,2) = 1.D0
      R(3,2) = 0.D0
      R(1,3) = -S
      R(2,3) = 0.D0
      R(3,3) = +C
      GO TO 600
!
!   Rotation about the Z-axis.
!
!          ( C  S  0 )
!   R(Z) = (-S  C  0 )
!          ( 0  0  1 )
!
  500 R(1,1) = +C
      R(2,1) = -S
      R(3,1) = 0.D0
      R(1,2) = +S
      R(2,2) = +C
      R(3,2) = 0.D0
      R(1,3) = 0.D0
      R(2,3) = 0.D0
      R(3,3) = 1.D0
      GO TO 600
!
!   Check KMATD for debug output.
  600 IF ( KMATD .EQ. 0 )  GO TO 700
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility ROTAT." )
      WRITE ( 6, 9200 )  C, S, I, THETA, R
 9200 FORMAT (1X, "C     = ", D30.16, /, 1X, &
     &            'S     = ', D30.16, /, 1X, &
     &            'I     = ', I2, /, 1X, &
     &            'THETA = ', D30.16, /, 1X, &
     &            'R     = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
!    Normal conclusion.
  700 RETURN
      END
!
!******************************************************************************
      SUBROUTINE DROTT ( THETA, DTHETA, I, DR )
      IMPLICIT None
!
! 2.    DROTT
!
! 2.1   DROTT PROGRAM SPECIFICATION
!
! 2.1.1 DROTT is the matrix utility routine which creates the partial derivative
!       of a rotation matrix with respect to a variable on which the rotation
!       matrix is functionally dependent.
!
! 2.1.2 RESTRICTIONS - NONE
!
! 2.1.3 REFERENCES - NONE
!
! 2.2   DROTT PROGRAM INTERFACE
!
! 2.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. DTHETA  -  THE PARTIAL DERIVATIVE OF THE ROTATION ANGLE THETA
!                           WITH RESPECT TO THE VARIABLE IN QUESTION.
!             2. I       -  THE INTEGER FLAG WHICH DETERMINES THE ROTATION AXIS.
!                           (I = 1, 2, 3 REFERS RESPECTIVELY TO ROTATIONS ABOUT
!                           THE X, Y, AND Z AXES.)
!             3. THETA   -  THE ANGLE THROUGH WHICH THE COORDINATE SYSTEM
!                           ROTATION IS PERFORMED. (RAD)
!
!           OUTPUT VARIABLES:
!             1. DR(3,3)  -  THE PARTIAL DERIVATIVE OF THE ROTATION MATRIX IN
!                            QUESTION WITH RESPECT TO THE VARIABLE IN QUESTION.
!
! 2.2.2 COMMON BLOCKS USED -
!
       INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1.  KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2.  KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 2.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 DR(3,3), THETA, DTHETA, DC, DS
      Integer*2 I
!
! 2.2.4 DATA BASE ACCESS - NONE
!
! 2.2.5 EXTERNAL INPUT/OUTPUT -
!             1.  POSSIBLE DEBUG OUTPUT
!
! 2.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DIRNL, NUTG, PREG, PREP, UT1P, WOBP
!             CALLED SUBROUTINES: DCOS, DSIN
!
! 2.2.7 CONSTANTS USED - NONE
!
! 2.2.8 PROGRAM VARIABLES -
!
!             1. DC  -  THE COSINE OF THE ROTATION ANGLE (THETA) MULTIPLIED BY
!                       THE PARTIAL DERIVATIVE OF THE ROTATION ANGLE WITH
!                       RESPECT TO THE VARIABLE IN QUESTION (DTHETA).
!             2. DS  -  THE SINE OF THE ROTATION ANGLE (THETA) MULTIPLIED BY THE
!                       PARTIAL DERIVATIVE OF THE ROTATION ANGLE WITH RESPECT TO
!                       THE VARIABLE IN QUESTION (DTHETA).
!
! 2.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!     DROTT Program Structure
!
!   Compute the program variables DC and DS.
      DC = DCOS ( THETA ) * DTHETA
      DS = DSIN ( THETA ) * DTHETA
!
!   Go to the correct logic depending on the axis of rotation.
      IF ( I .EQ. 1 )  GO TO 300
      IF ( I .EQ. 2 )  GO TO 400
      IF ( I .EQ. 3 )  GO TO 500
!
!   Rotation about the X-axis.
!
!          (  0   0   0  )
!  DR(X) = (  0 -DS  DC  )
!          (  0 -DC -DS  )
!
  300 DR(1,1) = 0.D0
      DR(2,1) = 0.D0
      DR(3,1) = 0.D0
      DR(1,2) = 0.D0
      DR(2,2) = -DS
      DR(3,2) = -DC
      DR(1,3) = 0.D0
      DR(2,3) = +DC
      DR(3,3) = -DS
      GO TO 600
!
!   Rotation about the Y-axis.
!
!          (-DS   0 -DC  )
!  DR(Y) = (  0   0   0  )
!          ( DC   0 -DS  )
!
  400 DR(1,1) = -DS
      DR(2,1) = 0.D0
      DR(3,1) = +DC
      DR(1,2) = 0.D0
      DR(2,2) = 0.D0
      DR(3,2) = 0.D0
      DR(1,3) = -DC
      DR(2,3) = 0.D0
      DR(3,3) = -DS
      GO TO 600
!
!   Rotation about the Z-axis.
!
!          (-DS  DC   0  )
!  DR(Z) = (-DC -DS   0  )
!          (  0   0   0  )
!
  500 DR(1,1) = -DS
      DR(2,1) = -DC
      DR(3,1) = 0.D0
      DR(1,2) = +DC
      DR(2,2) = -DS
      DR(3,2) = 0.D0
      DR(1,3) = 0.D0
      DR(2,3) = 0.D0
      DR(3,3) = 0.D0
      GO TO 600
!
!   Check KMATD for debug output.
  600 IF ( KMATD .EQ. 0 )  GO TO 700
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility DROTT." )
      WRITE ( 6, 9200 )  DC, DS, DTHETA, I, THETA, DR
 9200 FORMAT (1X, "DC     = ", D30.16, /, 1X, &
     &            'DS     = ', D30.16, /, 1X, &
     &            'DTHETA = ', D30.16, /, 1X, &
     &            'I      = ', I2, /, 1X, &
     &            'THETA  = ', D30.16, /, 1X, &
     &            'DR     = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
!   7.    NORMAL PROGRAM CONCLUSION.
!
  700 RETURN
      END
!
!******************************************************************************
      SUBROUTINE DDROT ( THETA, DDTHTA, I, DDR )
      IMPLICIT None
!
! 3.    DDROT
!
! 3.1   DDROT PROGRAM SPECIFICATION
!
! 3.1.1 DDROT is the matrix utility routine which creates the second
!       partial derivative of a rotation matrix with respect to a
!       variable on which the rotation matrix is functionally dependent.
!
! 3.1.2 RESTRICTIONS - THIS UTILITY ROUTINE ASSUMES THAT THE SECOND PARTIAL
!                      DERIVATIVE OF THE FUNCTIONALLY DEPENDENT VARIABLE WITH
!                      RESPECT TO THE PARAMETER IN QUESTION IS EQUAL TO ZERO.
!                      THIS IS A VERY GOOD ASSUMPTION IN ALL CASES WHERE
!                      SUBROUTINE DDROT IS USED IN THIS PROGRAM.
!
! 3.1.3 REFERENCES - NONE
!
! 3.2   DDROT PROGRAM INTERFACE
!
! 3.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. DDTHTA  -  THE SECOND PARTIAL DERIVATIVE OF THE ROTATION ANGLE
!                           THETA WITH RESPECT TO THE VARIABLE IN QUESTION.
!             2. I       -  THE INTEGER FLAG WHICH DETERMINES THE ROTATION AXIS.
!                           (I = 1, 2, 3 REFERS RESPECTIVELY TO ROTATIONS ABOUT
!                           THE X, Y, AND Z AXES. )
!             3. THETA   -  THE ANGLE THROUGH WHICH THE COORDINATE SYSTEM
!                           ROTATION IS PERFORMED.  (RAD)
!
!           OUTPUT VARIABLES:
!             1. DDR(3,3)  -  THE SECOND PARTIAL DERIVATIVE OF THE ROTATION
!                             MATRIX IN QUESTION WITH RESPECT TO THE VARIABLE IN
!                             QUESTION.
!
! 3.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 3.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  DDR(3,3), THETA, DDTHTA, DDC, DDS
      Integer*2 I
!
! 3.2.4 DATA BASE ACCESS - NONE
!
! 3.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 3.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DIRNL, UT1P
!             CALLED SUBROUTINES: DCOS, DSIN
!
! 3.2.7 CONSTANTS USED - NONE
!
! 3.2.8 PROGRAM VARIABLES -
!             1. DDC  -  THE COSINE OF THE ROTATION ANGLE MULTIPLIED BY THE
!                        SECOND PARTIAL DERIVATIVE OF THE ROTATION ANGLE WITH
!                        RESPECT TO THE VARIABLE IN QUESTION.
!             2. DDS  -  THE SINE OF THE ROTATION ANGLE MULTIPLIED BY THE SECOND
!                        PARTIAL DERIVATIVE OF THE ROTATION ANGLE WITH RESPECT
!                        TO THE VARIABLE IN QUESTION.
!
! 3.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   DDROT Program Structure
!
!   Compute the program variables DDC and DDS.
      DDC = DCOS ( THETA ) * DDTHTA
      DDS = DSIN ( THETA ) * DDTHTA
!
!   Go to the correct logic depending of the axis of rotation.
      IF ( I .EQ. 1 )  GO TO 300
      IF ( I .EQ. 2 )  GO TO 400
      IF ( I .EQ. 3 )  GO TO 500
!
!   Rotation ablut the X-axis.
!
!           (   0    0    0   )
!  DDR(X) = (   0 -DDC -DDS   )
!           (   0  DDS -DDC   )
!
  300 DDR(1,1) = 0.D0
      DDR(2,1) = 0.D0
      DDR(3,1) = 0.D0
      DDR(1,2) = 0.D0
      DDR(2,2) = -DDC
      DDR(3,2) = +DDS
      DDR(1,3) = 0.D0
      DDR(2,3) = -DDS
      DDR(3,3) = -DDC
      GO TO 600
!
!   Rotation about the Y-axis.
!
!           (-DDC    0  DDS   )
!  DDR(Y) = (   0    0    0   )
!           (-DDS    0 -DDC   )
!
  400 DDR(1,1) = -DDC
      DDR(2,1) = 0.D0
      DDR(3,1) = -DDS
      DDR(1,2) = 0.D0
      DDR(2,2) = 0.D0
      DDR(3,2) = 0.D0
      DDR(1,3) = +DDS
      DDR(2,3) = 0.D0
      DDR(3,3) = -DDC
      GO TO 600
!
!   Rotation about the Z-axis.
!
!           (-DDC -DDS    0   )
!  DDR(Z) = ( DDS -DDC    0   )
!           (   0    0    0   )
!
  500 DDR(1,1) = -DDC
      DDR(2,1) = +DDS
      DDR(3,1) = 0.D0
      DDR(1,2) = -DDS
      DDR(2,2) = -DDC
      DDR(3,2) = 0.D0
      DDR(1,3) = 0.D0
      DDR(2,3) = 0.D0
      DDR(3,3) = 0.D0
      GO TO 600
!
!   Check KMATD for debug output.
  600 IF ( KMATD .EQ. 0 )  GO TO 700
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine DDROT." )
      WRITE ( 6, 9200 )  THETA, I, DDTHTA, DDR
 9200 FORMAT (1X, "THETA  = ", D30.16, /, 1X, &
     &            'I      = ', I2, /, 1X, &
     &            'DDTHTA = ', D30.16, /, 1X, &
     &            'DDR    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
!     Normal Conclusion.
  700 RETURN
      END
!
!*******************************************************************************
      SUBROUTINE D3ROT ( THETA, D3THET, I, D3R )
      IMPLICIT None
!
! 2.    D3ROT
!
! 2.1   D3ROT PROGRAM SPECIFICATION
!
! 2.1.1 D3ROT is the matrix utility routine which creates the third partial
!       derivative of a rotation matrix with respect to a variable on which
!       the rotation matrix is functionally dependent.
!
! 2.1.2 RESTRICTIONS - NONE
!
! 2.1.3 REFERENCES - NONE
!
! 2.2   D3ROT PROGRAM INTERFACE
!
! 2.2.1 CALLING SEQUENCE - CALL D3ROT(THETA,D3THET,I,D3R)
!
!           INPUT VARIABLES:
!             1. D3THET  -  THE THIRD PARTIAL DERIVATIVE OF THE ROTATION ANGLE
!                           THETA WITH RESPECT TO THE VARIABLE IN QUESTION.
!             2. I       -  THE INTEGER FLAG WHICH DETERMINES THE ROTATION AXIS.
!                           (I = 1, 2, 3 REFERS RESPECTIVELY TO ROTATIONS ABOUT
!                           THE X, Y, AND Z AXES.)
!             3. THETA   -  THE ANGLE THROUGH WHICH THE COORDINATE SYSTEM
!                           ROTATION IS PERFORMED. (RAD)
!
!           OUTPUT VARIABLES:
!             1. D3R(3,3) -  THE THIRD PARTIAL DERIVATIVE OF THE ROTATION MATRIX
!                            IN QUESTION WITH RESPECT TO THE VARIABLE IN
!                            QUESTION.
!
! 2.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES "FROM":
!             1.  KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2.  KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 2.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  D3R(3,3), THETA, D3THET, D3C, D3S
      Integer*2 I
!
! 2.2.4 DATA BASE ACCESS - NONE
!
! 2.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 2.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DIRNL, NUTG, PREG, PREP, UT1P, WOBP
!             CALLED SUBROUTINES: DCOS, DSIN
!
! 2.2.7 CONSTANTS USED - NONE
!
! 2.2.8 PROGRAM VARIABLES -
!             1. D3C -  THE COSINE OF THE ROTATION ANGLE (THETA) MULTIPLIED BY
!                       THE SECOND PARTIAL DERIVATIVE OF THE ROTATION ANGLE WITH
!                       RESPECT TO THE VARIABLE IN QUESTION (DTHETA).
!             2. D3S -  THE SINE OF THE ROTATION ANGLE (THETA) MULTIPLIED BY THE
!                       SECOND PARTIAL DERIVATIVE OF THE ROTATION ANGLE WITH
!                       RESPECT TO THE VARIABLE IN QUESTION (DTHETA).
!
! 2.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    BRUCE SCHUPLER 03/27/78
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   D3ROT Program Structure
!
!   Compute the program variables D3C and D3S.
      D3C = DCOS ( THETA ) * D3THET
      D3S = DSIN ( THETA ) * D3THET
!
!   Go to the correct logic depending on the axis of rotation.
      IF ( I .EQ. 1 )  GO TO 300
      IF ( I .EQ. 2 )  GO TO 400
      IF ( I .EQ. 3 )  GO TO 500
!
!   Rotation about the X-axis.
!
!          (  0   0   0  )
!  D3R(X) = (  0 +D3S -D3C  )
!          (  0 +D3C +D3S  )
!
  300 D3R(1,1) = 0.D0
      D3R(2,1) = 0.D0
      D3R(3,1) = 0.D0
      D3R(1,2) = 0.D0
      D3R(2,2) = +D3S
      D3R(3,2) = +D3C
      D3R(1,3) = 0.D0
      D3R(2,3) = -D3C
      D3R(3,3) = +D3S
      GO TO 600
!
!   Rotation about the y-axis.
!
!          (+D3S   0 +D3C  )
!  D3R(Y) = (  0   0   0  )
!          (-D3C   0 +D3S  )
!
  400 D3R(1,1) = +D3S
      D3R(2,1) = 0.D0
      D3R(3,1) = -D3C
      D3R(1,2) = 0.D0
      D3R(2,2) = 0.D0
      D3R(3,2) = 0.D0
      D3R(1,3) = +D3C
      D3R(2,3) = 0.D0
      D3R(3,3) = +D3S
      GO TO 600
!
!   Rotation about the Z-axis.
!
!          (+D3S -D3C   0  )
!  D3R(Z) = (+D3C +D3S   0  )
!          (  0   0   0  )
!
  500 D3R(1,1) = +D3S
      D3R(2,1) = +D3C
      D3R(3,1) = 0.D0
      D3R(1,2) = -D3C
      D3R(2,2) = +D3S
      D3R(3,2) = 0.D0
      D3R(1,3) = 0.D0
      D3R(2,3) = 0.D0
      D3R(3,3) = 0.D0
      GO TO 600
!
!   Check KMATD for debug output.
  600 IF ( KMATD .EQ. 0 )  GO TO 700
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility D3ROT." )
      WRITE ( 6, 9200 )  D3C, D3S, D3THET, I, THETA, D3R
 9200 FORMAT (1X, "D3C     = ", D30.16, /, 1X, &
     &            'D3S     = ', D30.16, /, 1X, &
     &            'D3THET = ', D30.16, /, 1X, &
     &            'I      = ', I2, /, 1X, &
     &            'THETA  = ', D30.16, /, 1X, &
     &            'D3R     = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
!     Normal conclusion.
  700 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MMUL2 ( A, B, C )
      IMPLICIT None
!
! 4.    MMUL2
!
! 4.1   MMUL2 PROGRAM SPECIFICATION
!
! 4.1.1 MMUL2 is the matrix utility which multiplies two rotation matrices
!       producing a product rotation matrix.
!
! 4.1.2 RESTRICTIONS - NONE
!
! 4.1.3 REFERENCES - NONE
!
! 4.2   MMUL2 PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. C(3,3)  -  THE PRODUCT OF ROTATION MATRICES A AND B.
!
! 4.2.2 COMMON BLOCKS USED -
!
       INCLUDE 'ccon.i'
!
!            VARIABLES 'FROM':
!              1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!              2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!            VARIABLES 'TO': NONE
!
! 4.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  A(3,3), B(3,3), C(3,3)
      Integer*4 I, J
!
! 4.2.4 DATA BASE ACCESS - NONE
!
! 4.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 4.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: MMUL3, SITI, WOBG, WOBP
!             CALLED SUBROUTINES: NONE
!
! 4.2.7 CONSTANTS USED - NONE
!
! 4.2.8 PROGRAM VARIABLES - NONE
!
! 4.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   MMUL2 Program Structure
!
!   Perform the multiplication.
      DO 120  J = 1,3
        DO 110  I = 1,3
          C(I,J) =   A(I,1) * B(1,J) &
     &             + A(I,2) * B(2,J) &
     &             + A(I,3) * B(3,J)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility MMUL2." )
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A   = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MMUL3 ( A, B, C, D )
      IMPLICIT None
!
! 5.    MMUL3
!
! 5.1   MMUL3 PROGRAM SPECIFICATION
!
! 5.1.1 MMUL3 is the matrix utility routine which multiplies together
!       three rotation matrices producing a product rotation matrix.
!
! 5.1.2 RESTRICTIONS - NONE
!
! 5.1.3 REFERENCES - NONE
!
! 5.2   MMUL3 PROGRAM INTERFACE
!
! 5.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!             3. C(3,3)  -  THE THIRD ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. D(3,3)  -  THE PRODUCT OF ROTATION MATRICES A, B, AND C.
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES "FROM":
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  A(3,3), AB(3,3), B(3,3), C(3,3), D(3,3)
!
! 5.2.4 DATA BASE ACCESS - NONE
!
! 5.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: MMUL5, NUTG, PREG, PREP
!             CALLED SUBROUTINES: MMUL2
!
! 5.2.7 CONSTANTS USED - NONE
!
! 5.2.8 PROGRAM VARIABLES -
!             1. AB(3,3)  -  THE PRODUCT OF ROTATION MATRICES A AND B.
!
! 5.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   MMUL3 Program Structure
!
!   Perform the multiplications.
      CALL MMUL2 ( A, B, AB )
      CALL MMUL2 ( AB, C, D )
!
!   Check KMATD to for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility MMUL3." )
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!******************************************************************************
      SUBROUTINE MMUL4 ( A, B, C, D, E )
      IMPLICIT None
!
! 6.1.1 MMUL4 is the matrix utility routine which multiplies together
!       four rotation matrices producing a product rotation matrix.
!
! 6.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!             3. C(3,3)  -  THE THIRD ROTATION MATRIX.
!             4. D(3,3)  -  THE FOURTH ROTATION MATRIX.
!           OUTPUT VARIABLES:
!             1. E(3,3)  -  THE PRODUCT OF ROTATION MATRICES A, B, C, AND D.
!
! 6.2.2 COMMON BLOCKS USED -
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 6.2.3 PROGRAM SPECIFICATIONS -
      Real*8 A(3,3), ABC(3,3), B(3,3), C(3,3), D(3,3), E(3,3)
!
! 6.2.8 PROGRAM VARIABLES -
!             1. ABC(3,3)  -  THE PRODUCT OF ROTATION MATRICES A, B, AND C.
!
! 6.2.9 PROGRAMMER - D. Gordon 2003.12.30
!
!   Perform the multiplications
      CALL MMUL3 ( A, B, C, ABC )
      CALL MMUL2 ( ABC, D, E )
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utililty MMUL4." )
      WRITE ( 6, 9200 )  A, ABC, B, C, D, E
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'ABC  = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'D    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'E    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MMUL5 ( A, B, C, D, E, F )
      IMPLICIT None
!
! 6.    MMUL5
!
! 6.1   MMUL5 PROGRAM SPECIFICATION
!
! 6.1.1 MMUL5 is the matrix utility routine which multiplies together
!       five rotation matrices producing a product rotation matrix.
!
! 6.1.2 RESTRICTIONS - NONE
!
! 6.1.3 REFERENCES - NONE
!
! 6.2   MMUL5 PROGRAM INTERFACE
!
! 6.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!             3. C(3,3)  -  THE THIRD ROTATION MATRIX.
!             4. D(3,3)  -  THE FOURTH ROTATION MATRIX.
!             5. E(3,3)  -  THE FIFTH ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. F(3,3)  -  THE PRODUCT OF ROTATION MATRICES A, B, C, D, AND E.
!
! 6.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 6.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3,3), ABC(3,3), B(3,3), C(3,3), D(3,3), E(3,3), F(3,3)
!
! 6.2.4 DATA BASE ACCESS - NONE
!
! 6.2.5 EXTERNAL INPUT/OUTPUT -
!             1.  POSSIBLE DEBUG OUTPUT
!
! 6.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: M1950, PREP, UT1P, WOBP
!             CALLED SUBROUTINES: MMUL3
!
! 6.2.7 CONSTANTS USED - NONE
!
! 6.2.8 PROGRAM VARIABLES -
!             1. ABC(3,3)  -  THE PRODUCT OF ROTATION MATRICES A, B, AND C.
!
! 6.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!     MMUL5 Program Structure
!
!   Perform the multiplications
      CALL MMUL3 ( A, B, C, ABC )
      CALL MMUL3 ( ABC, D, E, F )
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utililty MMUL5." )
      WRITE ( 6, 9200 )  A, ABC, B, C, D, E, F
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'ABC  = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'D    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'E    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'F    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MADD2 ( A, B, C )
      IMPLICIT None
!
! 7.    MADD2
!
! 7.1   MADD2 PROGRAM SPECIFICATION
!
! 7.1.1 MADD2 is the matrix utility which adds togeter two matrices.
!
! 7.1.2 RESTRICTIONS - NONE
!
! 7.1.3 REFERENCES - NONE
!
! 7.2   MADD2 PROGRAM INTERFACE
!
! 7.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. C(3,3)  -  THE SUM OF ROTATION MATRICES A AND B.
!
! 7.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1.  KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2.  KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 7.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  A(3,3), B(3,3), C(3,3)
      Integer*4 I, J
!
! 7.2.4 DATA BASE ACCESS - NONE
!
! 7.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 7.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: NONE
!             CALLED SUBROUTINES: NONE
!
! 7.2.7 CONSTANTS USED - NONE
!
! 7.2.8 PROGRAM VARIABLES - NONE
!
! 7.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   MADD2 Program Structure
!
!   Do the addition.
      DO 120  J = 1,3
        DO 110  I = 1,3
          C(I,J) = A(I,J) + B(I,J)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE MADD2." )
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MADD3 ( A, B, C, D )
      IMPLICIT None
!
! 8.    MADD3
!
! 8.1   MADD3 PROGRAM SPECIFICATION
!
! 8.1.1 MADD3 adds together three matrices.
!
! 8.1.2 RESTRICTIONS - NONE
!
! 8.1.3 REFERENCES - NONE
!
! 8.2   MADD3 PROGRAM INTERFACE
!
! 8.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!             3. C(3,3)  -  THE THIRD ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. D(3,3)  -  THE SUM OF ROTATION MATRICES A, B, AND C.
!
! 8.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 8.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3,3), B(3,3), C(3,3), D(3,3)
      Integer*4 I, J
!
! 8.2.4 DATA BASE ACCESS - NONE
!
! 8.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 8.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: M1950, NUTG, PREG, PREP
!             CALLED SUBROUTINES: NONE
!
! 8.2.7 CONSTANTS USED - NONE
!
! 8.2.8 PROGRAM VARIABLES - NONE
!
! 8.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!     MADD3 PROGRAM STRUCTURE
!
!   Do the additions.
      DO 120  J = 1,3
        DO 110  I = 1,3
          D(I,J) = A(I,J) + B(I,J) + C(I,J)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE MADD3." )
      WRITE ( 6, 9200 )  A, B, C, D
 9200 FORMAT (1X, "A   = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'D   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MADD4 ( A, B, C, D, E )
      IMPLICIT None
!
! 8.    MADD4
!
! 8.1   MADD4 PROGRAM SPECIFICATION
!
! 8.1.1 MADD4 adds together four matrices.
!
! 8.1.2 RESTRICTIONS - NONE
!
! 8.1.3 REFERENCES - NONE
!
! 8.2   MADD4 PROGRAM INTERFACE
!
! 8.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!             3. C(3,3)  -  THE THIRD ROTATION MATRIX.
!             4. D(3,3)  -  THE FOURTH ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. E(3,3)  -  THE SUM OF ROTATION MATRICES A, B, C, AND D.
!
! 8.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 8.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3,3), B(3,3), C(3,3), D(3,3), E(3,3)
      Integer*4 I, J
!
! 8.2.4 DATA BASE ACCESS - NONE
!
! 8.2.5 EXTERNAL INPUT/OUTPUT -  POSSIBLE DEBUG OUTPUT
!
! 8.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: M2000, ?
!             CALLED SUBROUTINES: NONE
!
! 8.2.7 CONSTANTS USED - NONE
!
! 8.2.8 PROGRAM VARIABLES - NONE
!
! 8.2.9 PROGRAMMER - 95.12.11 David Gordon Created from MADD3
!
!     MADD4 PROGRAM STRUCTURE
!
!   Do the additions.
      DO 120  J = 1,3
        DO 110  I = 1,3
          E(I,J) = A(I,J) + B(I,J) + C(I,J) + D(I,J)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE MADD4." )
      WRITE ( 6, 9200 )  A, B, C, D, E
 9200 FORMAT (1X, "A   = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'D   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'E   = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MADD5 ( A, B, C, D, E, F )
      IMPLICIT None
!
! 9.    MADD5
!
! 9.1   MADD5 PROGRAM SPECIFICATION
!
! 9.1.1 MADD5 adds together five matrices.
!
! 9.1.2 RESTRICTIONS - NONE
!
! 9.1.3 REFERENCES - NONE
!
! 9.2   MADD5 PROGRAM INTERFACE
!
! 9.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!             3. C(3,3)  -  THE THIRD ROTATION MATRIX.
!             4. D(3,3)  -  THE FOURTH ROTATION MATRIX.
!             5. E(3,3)  -  THE FIFTH ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. F(3,3)  -  THE SUM OF ROTATION MATRICES A, B, C, D, AND E.
!
! 9.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
! 9.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3,3), B(3,3), C(3,3), D(3,3), E(3,3), F(3,3)
      Integer*4 I,J
!
! 9.2.4 DATA BASE ACCESS - NONE
!
! 9.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
! 9.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: M1950
!             CALLED SUBROUTINES: NONE
!
! 9.2.7 CONSTANTS USED - NONE
!
! 9.2.8 PROGRAM VARIABLES - NONE
!
! 9.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   MADD5 Program Structure
!
!     Do the additons.
      DO 120  J = 1,3
        DO 110  I = 1,3
          F(I,J) = A(I,J) + B(I,J) + C(I,J) + D(I,J) + E(I,J)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE MADD5." )
      WRITE ( 6, 9200 )  A, B, C, D, E, F
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'D    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'E    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'F    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MTRAN ( A, B )
      IMPLICIT None
!
!10.    MTRAN
!
!10.1   MTRAN PROGRAM SPECIFICATION
!
!10.1.1 MTRAN constructs the transpose of a matrix.
!
!10.1.2 RESTRICTIONS - NONE
!
!10.1.3 REFERENCES - NONE
!
!10.2   MTRAN PROGRAM INTERFACE
!
!10.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE ROTATION MATRIX TO BE TRANSPOSED.
!
!           OUTPUT VARIABLES:
!             1. B(3,3)  -  THE TRANSPOSE OF THE ROTATION MATRIX A.
!
!10.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
!10.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 A(3,3), B(3,3)
      Integer*4 I, J
!
!10.2.4 DATA BASE ACCESS - NONE
!
!10.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
!10.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: ATMG, AXOG
!             CALLED SUBROUTINES: NONE
!
!10.2.7 CONSTANTS USED - NONE
!
!10.2.8 PROGRAM VARIABLES - NONE
!
!10.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   MTRAN Program Structure
!
!     Do the transpostion.
      DO 120  J = 1,3
        DO 110  I = 1,3
          B(I,J) = A(J,I)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "Debug output for utility MTRAN." )
      WRITE ( 6, 9200 )  A, B
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!*****************************************************************************
      SUBROUTINE VECRT ( A, V, RV )
      IMPLICIT None
!
!11.    VECRT
!
!11.1   VECRT PROGRAM SPECIFICATION
!
!11.1.1 VECRT is the matrix utility which multiplies a vector by a rotation
!       matrix.
!
!11.1.2 RESTRICTIONS - NONE
!
!11.1.3 REFERENCES - NONE
!
!11.2   VECRT PROGRAM INTERFACE
!
!11.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE ROTATION MATRIX PERFORMING THE COORDINATE SYSTEM
!                           ROTATION.
!             2. V(3)    -  THE VECTOR BEING ROTATED BY THE ROTATION MATRIX.
!
!           OUTPUT VARIABLES:
!             1. RV(3)  -  THE ROTATED VECTOR.
!
!11.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!
!           VARIABLES 'FROM':
!             1. KMATC  -  THE MATRIX UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
!           VARIABLES 'TO': NONE
!
!11.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  A(3,3), V(3), RV(3)
      Integer*4 I
!
!11.2.4 DATA BASE ACCESS - NONE
!
!11.2.5 EXTERNAL INPUT/OUTPUT -
!             1. POSSIBLE DEBUG OUTPUT
!
!11.2.6 SUBROUTINE INTERFACE -
!           CALLER SUBROUTINES: ATMG, AXOG, ETDG, ETDP, PREP, ROSIT, UT1P, WOBP
!           CALLED SUBROUTINES: NONE
!
!11.2.7 CONSTANTS USED - NONE
!
!11.2.8 PROGRAM VARIABLES - NONE
!
!11.2.9 PROGRAMMER - DALE MARKHAM  01/19/77
!                    PETER DENATALE 07/18/77
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.15 Converted to Implicit None.
!
!   VECRT PROGRAM STRUCTURE
!
!   Perform the rotation.
      DO 100  I = 1,3
        RV(I) =   A(I,1) * V(1) &
     &          + A(I,2) * V(2) &
     &          + A(I,3) * V(3)
  100 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for utility VECRT." )
      WRITE ( 6, 9200 )  A, V, RV
 9200 FORMAT (1X, "A   = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'V   = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'RV  = ', 3 ( D30.16, 10X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MSUB2 ( A, B, C )
      IMPLICIT None
!
! 7.    MSUB2
!
! 7.1   MSUB2 PROGRAM SPECIFICATION
!
! 7.1.1 MSUB2 is the matrix utility which subtracts one matrix from another.
!
! 7.2   MSUB2 PROGRAM INTERFACE
!
! 7.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE FIRST ROTATION MATRIX.
!             2. B(3,3)  -  THE SECOND ROTATION MATRIX.
!           OUTPUT VARIABLES:
!             1. C(3,3)  -  THE Difference OF ROTATION MATRICES A AND B.
!
! 7.2.2 COMMON BLOCKS USED -
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1.  KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 7.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  A(3,3), B(3,3), C(3,3)
      Integer*4 I, J
!
! 7.2.9 PROGRAMMER - David Gordon 02/22/2013. Modified MADD2.
!
!   MSUB2 Program Structure
!
!   Do the subtraction.
      DO 120  J = 1,3
        DO 110  I = 1,3
          C(I,J) = A(I,J) - B(I,J)
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE MSUB2." )
      WRITE ( 6, 9200 )  A, B, C
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'B    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE MATEQ ( A, C )
      IMPLICIT None
!
! 7.    MATEQ
!
! 7.1   MATEQ PROGRAM SPECIFICATION
!
! 7.1.1 MATEQ is the matrix utility which sets one matrix equal to another.
!
! 7.2   MATEQ PROGRAM INTERFACE
!
! 7.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. A(3,3)  -  THE Input ROTATION MATRIX.
!           OUTPUT VARIABLES:
!             1. C(3,3)  -  THE output ROTATION MATRIX.
!
! 7.2.2 COMMON BLOCKS USED -
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1.  KMATD  -  THE MATRIX UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 7.2.3 PROGRAM SPECIFICATIONS -
      Real*8  A(3,3), C(3,3)
      Integer*4 I, J
!
! 7.2.9 PROGRAMMER - David Gordon 02/22/2013. Modified MADD2.
!
!   MATEQ Program Structure
!
!   Set matrix C equal to matrix A.
      DO 120  J = 1,3
        DO 110  I = 1,3
          C(I,J) = A(I,J) 
  110   CONTINUE
  120 CONTINUE
!
!   Check KMATD for debug output.
      IF ( KMATD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9100 )
 9100 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE MATEQ." )
      WRITE ( 6, 9200 )  A, C
 9200 FORMAT (1X, "A    = ", 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'C    = ', 3 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!
!******************************************************************************
      SUBROUTINE ROT2K ( CFLAT, CFLON, CFSITE, CFSITN, R2K  , EPLATP, &
     &                    EPLATV, EPLONP, EPLONV, EPSITN, SITEA, USITEP, &
     &                    USITEV )
      IMPLICIT None
!
! 1.    ROT2K
!
! 1.1   ROT2K PROGRAM SPECIFICATION
!
! 1.1.1 ROT2K is the utility which rotates the site geometry from the crust
!       fixed reference system to the J2000.0 reference system using the
!       IERS 2003 CEO-based TRF ==> CRF tranformation matrix.
!
! 1.2   ROT2K PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. CFLAT(3,2)   - THE PARTIAL DERIVATIVES OF THE GEOCENTRIC
!                               CRUST FIXED VECTOR COMPONENTS WITH RESPECT TO
!                               THE GEODETIC LATITUDES AT EACH OBSERVATION SITE.
!                               (M/RAD)
!             2. CFLON(3,2)   - THE PARTIAL DERIVATIVES OF THE GEOCENTRIC CRUST
!                               FIXED VECTOR COMPONENTS WITH RESPECT TO THE
!                               EAST LONGITUDES AT EACH OBSERVATION SITE.
!                               (M/RAD)
!             3. CFSITE(3,2)  - THE GEOCENTRIC CRUST FIXED SITE VECTORS AT EACH
!                               OBSERVATION SITE. (M)
!             4. CFSITN(3,2)  - THE GEOCENTRIC CRUST FIXED SITE NORMAL UNIT
!                               VECTORS AT EACH OBSERVATION SITE. (UNITLESS)
!             5. R2K(3,3,3)   - THE IERS 2003 CEO-based CRUST FIXED TO J2000.0
!                               ROTATION MATRIX AND ITS FIRST TWO CT TIME
!                               DERIVATIVES. (UNITLESS, 1/SEC, 1/SEC**2)
!
!           OUTPUT VARIABLES:
!             1. EPLATP(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE POSITION VECTOR COMPONENTS WITH
!                               RESPECT TO THE GEODETIC LATITUDE AT EACH
!                               OBSERVATION SITE. (M/RAD)
!             2. EPLATV(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE VELOCITY VECTOR COMPONENTS WITH
!                               RESPECT TO THE GEODETIC LATITUDE AT EACH
!                               OBSERVATION SITE. (M/SEC-RAD)
!             3. EPLONP(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE POSITION VECTOR COMPONENTS WITH
!                               RESPECT TO THE EAST LONGITUDE AT EACH
!                               OBSERVATION SITE. (M/RAD)
!             4. EPLONV(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE VELOCITY VECTOR COMPONENTS WITH
!                               RESPECT TO THE EAST LONGITUDE AT EACH
!                               OBSERVATION SITE. (M/RAD-SEC)
!             5. EPSITN(3,2)  - THE J2000.0 GEOCENTRIC SITE NORMAL UNIT VECTORS
!                               AT EACH OBSERVATION SITE. (UNITLESS)
!             6. SITEA(3,2)   - THE J2000.0 GEOCENTRIC SITE ACCELERATION
!                               VECTORS. (M/SEC**2)
!                               (NOTE: IT IS NOT NECESSARY TO CORRECT THE
!                               J2000.0 SITE GEOCENTRIC ACCELERATION VECTORS
!                               FOR EARTH TIDAL AND OCEAN LOADING EFFECTS.)
!             7. USITEP(3,2)  - THE J2000.0 GEOCENTRIC SITE POSITION VECTORS
!                               UNCORRECTED FOR EARTH TIDAL AND OCEAN LOADING
!                               EFFECTS. (M)
!             8. USITEV(3,2)  - THE J2000.0 GEOCENTRIC SITE VELOCITY VECTORS
!                               UNCORRECTED FOR EARTH TIDAL AND OCEAN LOADING
!                               EFFECTS. (M/SEC)
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1. KROSC - THE ROSIT UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KROSD - THE ROSIT UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
      Real*8     CFLAT(3,2), CFLON(3,2), CFSITE(3,2), CFSITN(3,2), &
     &           EPLATP(3,2), EPLATV(3,2), EPLONP(3,2), EPLONV(3,2), &
     &           EPSITN(3,2), R2K  (3,3,3), SITEA(3,2), USITEP(3,2), &
     &           USITEV(3,2)
      Integer*4  L
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: VECRT
!
! 1.2.9 PROGRAMMER - DALE MARKHAM  01/17/77
!                    PETER DENATALE 07/18/77
!                    SAVITA GOEL    06/04/87 (CDS FOR A900)
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.18 Converted to Implicit None.
!                    David Gordon 2003.11.20 Updated for new solid body
!                                 rotation matrix (IERS 2003 model).
!
!   ROT2k Program Structure
!
!   ROTATE the site geometry from the crust fixed reference system
!     to the J2000.0 system.
!
!   Loop twice for the geometry of the two sites.
      DO 160  L = 1,2
!
!   Rotate the geocentric site vectors.
        CALL VECRT ( R2K(1,1,1), CFSITE(1,L), USITEP(1,L) )
        CALL VECRT ( R2K(1,1,2), CFSITE(1,L), USITEV(1,L) )
        CALL VECRT ( R2K(1,1,3), CFSITE(1,L), SITEA(1,L) )
!
!   Rotate the geocentric site normal unit vectors.
        CALL VECRT ( R2K(1,1,1), CFSITN(1,L), EPSITN(1,L) )
!
!   Rotate the geodetic latitude partial derivatives.
        CALL VECRT ( R2K(1,1,1), CFLAT(1,L), EPLATP(1,L) )
        CALL VECRT ( R2K(1,1,2), CFLAT(1,L), EPLATV(1,L) )
!
!   Rotate the East longitude partial derivatives.
        CALL VECRT ( R2K(1,1,1), CFLON(1,L), EPLONP(1,L) )
        CALL VECRT ( R2K(1,1,2), CFLON(1,L), EPLONV(1,L) )
!
!   Close the loop over the sites.
  160 CONTINUE
!
!   Check KROSD for debug output.
      IF ( KROSD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine ROT2K." )
      WRITE ( 6, 9200 )  CFLAT, CFLON, CFSITE, CFSITN, R2K, &
     &            EPLATP, EPLATV, EPLONP, EPLONV, EPSITN, SITEA, USITEP, &
     &                   USITEV
 9200 FORMAT (1X, "CFLAT  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CFLON  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CFSITE = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CFSITN = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "R2K    = ", 9 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLATP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLATV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLONP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLONV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPSITN = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "SITEA  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "USITEP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "USITEV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
!********************************************************************
      SUBROUTINE ROTC2K ( CFLAT, CFLON, CFSITE, CFSITN, RC2K , EPLATP, &
     &                    EPLATV, EPLONP, EPLONV, EPSITN, SITEA, USITEP, &
     &                    USITEV )
      IMPLICIT None
!
! 1.    ROTC2K
!
! 1.1   ROTC2K PROGRAM SPECIFICATION
!
! 1.1.1 ROTC2K is the utility which rotates the site geometry from the crust
!       fixed reference system to the J2000.0 reference system using the
!       IERS 2003 classical TRF ==> CRF tranformation matrix.
!
! 1.2   ROTC2K PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. CFLAT(3,2)   - THE PARTIAL DERIVATIVES OF THE GEOCENTRIC
!                               CRUST FIXED VECTOR COMPONENTS WITH RESPECT TO
!                               THE GEODETIC LATITUDES AT EACH OBSERVATION SITE.
!                               (M/RAD)
!             2. CFLON(3,2)   - THE PARTIAL DERIVATIVES OF THE GEOCENTRIC CRUST
!                               FIXED VECTOR COMPONENTS WITH RESPECT TO THE
!                               EAST LONGITUDES AT EACH OBSERVATION SITE.
!                               (M/RAD)
!             3. CFSITE(3,2)  - THE GEOCENTRIC CRUST FIXED SITE VECTORS AT EACH
!                               OBSERVATION SITE. (M)
!             4. CFSITN(3,2)  - THE GEOCENTRIC CRUST FIXED SITE NORMAL UNIT
!                               VECTORS AT EACH OBSERVATION SITE. (UNITLESS)
!             5. RC2K(3,3,3)  - THE IERS 2003 CEO-based CRUST FIXED TO J2000.0
!                               ROTATION MATRIX AND ITS FIRST TWO CT TIME
!                               DERIVATIVES. (UNITLESS, 1/SEC, 1/SEC**2)
!
!           OUTPUT VARIABLES:
!             1. EPLATP(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE POSITION VECTOR COMPONENTS WITH
!                               RESPECT TO THE GEODETIC LATITUDE AT EACH
!                               OBSERVATION SITE. (M/RAD)
!             2. EPLATV(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE VELOCITY VECTOR COMPONENTS WITH
!                               RESPECT TO THE GEODETIC LATITUDE AT EACH
!                               OBSERVATION SITE. (M/SEC-RAD)
!             3. EPLONP(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE POSITION VECTOR COMPONENTS WITH
!                               RESPECT TO THE EAST LONGITUDE AT EACH
!                               OBSERVATION SITE. (M/RAD)
!             4. EPLONV(3,2)  - THE PARTIAL DERIVATIVES OF THE J2000.0
!                               GEOCENTRIC SITE VELOCITY VECTOR COMPONENTS WITH
!                               RESPECT TO THE EAST LONGITUDE AT EACH
!                               OBSERVATION SITE. (M/RAD-SEC)
!             5. EPSITN(3,2)  - THE J2000.0 GEOCENTRIC SITE NORMAL UNIT VECTORS
!                               AT EACH OBSERVATION SITE. (UNITLESS)
!             6. SITEA(3,2)   - THE J2000.0 GEOCENTRIC SITE ACCELERATION
!                               VECTORS. (M/SEC**2)
!                               (NOTE: IT IS NOT NECESSARY TO CORRECT THE
!                               J2000.0 SITE GEOCENTRIC ACCELERATION VECTORS
!                               FOR EARTH TIDAL AND OCEAN LOADING EFFECTS.)
!             7. USITEP(3,2)  - THE J2000.0 GEOCENTRIC SITE POSITION VECTORS
!                               UNCORRECTED FOR EARTH TIDAL AND OCEAN LOADING
!                               EFFECTS. (M)
!             8. USITEV(3,2)  - THE J2000.0 GEOCENTRIC SITE VELOCITY VECTORS
!                               UNCORRECTED FOR EARTH TIDAL AND OCEAN LOADING
!                               EFFECTS. (M/SEC)
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1. KROSC - THE ROSIT UTILITY ROUTINE FLOW CONTROL FLAG.
!             2. KROSD - THE ROSIT UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
      Real*8     CFLAT(3,2), CFLON(3,2), CFSITE(3,2), CFSITN(3,2), &
     &           EPLATP(3,2), EPLATV(3,2), EPLONP(3,2), EPLONV(3,2), &
     &           EPSITN(3,2), RC2K (3,3,3), SITEA(3,2), USITEP(3,2), &
     &           USITEV(3,2)
      Integer*4  L
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: VECRT
!
! 1.2.9 PROGRAMMER - DALE MARKHAM  01/17/77
!                    PETER DENATALE 07/18/77
!                    SAVITA GOEL    06/04/87 (CDS FOR A900)
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    David Gordon 94.04.18 Converted to Implicit None.
!                    David Gordon 2003.11.20 Updated for new solid body
!                                 rotation matrix (IERS 2003 model).
!
!   ROT2k Program Structure
!
!   ROTATE the site geometry from the crust fixed reference system
!     to the J2000.0 system.
!
!   Loop twice for the geometry of the two sites.
      DO 160  L = 1,2
!
!   Rotate the geocentric site vectors.
        CALL VECRT ( RC2K(1,1,1), CFSITE(1,L), USITEP(1,L) )
        CALL VECRT ( RC2K(1,1,2), CFSITE(1,L), USITEV(1,L) )
        CALL VECRT ( RC2K(1,1,3), CFSITE(1,L), SITEA(1,L) )
!
!   Rotate the geocentric site normal unit vectors.
        CALL VECRT ( RC2K(1,1,1), CFSITN(1,L), EPSITN(1,L) )
!
!   Rotate the geodetic latitude partial derivatives.
        CALL VECRT ( RC2K(1,1,1), CFLAT(1,L), EPLATP(1,L) )
        CALL VECRT ( RC2K(1,1,2), CFLAT(1,L), EPLATV(1,L) )
!
!   Rotate the East longitude partial derivatives.
        CALL VECRT ( RC2K(1,1,1), CFLON(1,L), EPLONP(1,L) )
        CALL VECRT ( RC2K(1,1,2), CFLON(1,L), EPLONV(1,L) )
!
!   Close the loop over the sites.
  160 CONTINUE
!
!   Check KROSD for debug output.
      IF ( KROSD .EQ. 0 )  GO TO 300
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine ROTC2K." )
      WRITE ( 6, 9200 )  CFLAT, CFLON, CFSITE, CFSITN, RC2K, &
     &            EPLATP, EPLATV, EPLONP, EPLONV, EPSITN, SITEA, USITEP, &
     &                   USITEV
 9200 FORMAT (1X, "CFLAT  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CFLON  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CFSITE = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "CFSITN = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "RC2K   = ", 9 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLATP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLATV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLONP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPLONV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "EPSITN = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "SITEA  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "USITEP = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "USITEV = ", 2 ( 3 ( D30.16, 10X ), /, 1X ) )
!
  300 RETURN
      END
      SUBROUTINE STRG (XJD, UTC, Isource, STAR, STAR12, RIGHT_ASC,      &
     &                 DECLINATION, Sourc20)
      IMPLICIT None
!
! 4.1.1 STRG is the geometry section of the STAR Module. STRG computes the
!       J2000.0 unit vector in the direction of the source. Now will compute
!       proper motions in special situations.
!
! 4.2   STRG PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!         INPUT:
!          1. Isource - Source # if in 'difx' mode.
!         OUTPUT VARIABLES:
!          1. STAR(3) - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!
! 4.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cmxsr11.i'
!       VARIABLES 'FROM':
!          1. LNSTAR(10,MAX_ARC_SRC)- THE ALPHANUMERIC CHARACTER NAMES
!                                     OF THE STARS IN THE STAR CATALOG.
!                                     Up to 20 characters in difx mode.
!          2. NUMSTR                - THE NUMBER OF STARS IN THE STAR
!                                     CATALOG.
!          3. RADEC(2,MAX_ARC_SRC)  - THE RIGHT ASCENSIONS AND DECLINATIONS
!                                     OF THE STARS IN THE STAR CATALOG.
!                                     (RAD, RAD)
!       VARIABLES 'TO':
!          1. CD  - THE COSINE OF THE DECLINATION OF THE STAR BEING USED IN
!                   THE CURRENT OBSERVATION. (UNITLESS)
!          2. CRA - THE COSINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                   USED IN THE CURRENT OBSERVATION. (UNITLESS)
!          3. SD  - THE SINE OF THE DECLINATION OF THE STAR BEING USED IN
!                   THE CURRENT OBSERVATION. (UNITLESS)
!          4. SRA - THE SINE OF THE RIGHT ASCENSION OF THE STAR BEING USED
!                   IN THE CURRENT OBSERVATION. (UNITLESS)
!
      INCLUDE 'ccon.i'
!       VARIABLES 'FROM':
!          1. KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!          2. KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cuser11.i'
!       Variables 'from':
!          1. C_mode  - Calc 11 mode. Either 'mark3 ', 'difx  ', or
!                       'nusolve'.
!
      INCLUDE 'get2s.i'
!       Variables to:
!          1. LSTRNM(4) - THE EIGHT ALPHAMERIC CHARACTER STAR NAME FOR THE
!                         CURRENT OBSERVATION. (ALPHAMERIC)
!
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!         CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!
      Real*8 PR_RA, PR_DEC
      Common /Pmotn/ PR_RA, PR_DEC
!
      Real*8 Dparsec, t_prlx(2)
      Common /PRLX/ Dparsec, t_prlx
!
! 4.2.3 PROGRAM SPECIFICATIONS -
      Real*8  STAR(3), XJD, UTC, STAR12(3,2)
!
! 4.2.4 DATA BASE ACCESS - None. GET 'STAR ID ' moved to subroutine GET_G.
!
! 4.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: DCOS, DSIN, GETA, TERMINATE_CALC, JDY2K
!
! 4.2.7 CONSTANTS USED - NONE
!
! 4.2.8 PROGRAM VARIABLES -
      REAL*8    RIGHT_ASC, DECLINATION, Xepoch, XJAN1, Xdays, Difyrs,   &
     &          JDepoch, JDY2K
      Integer*4 N, NN, IM, ID, Ieph, I, J, Isource
      Integer*2 NDO(3), KERR
!
      Character*20 SrcName(MAX_ARC_SRC), SName, Sourc20
      Equivalence (LNSTAR(1,1), SrcName(1))
      Equivalence (LSTRNM(1), SName)
!
!       Local variables:
!             1. RIGHT_ASC   - LOCAL VARIABLE FOR HOLDING THE RA.
!             2. DECLINATION - LOCAL VARIABLE FOR HOLDING THE DEC.
!
! 4.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!                    PETER DENATALE 07/14/77
!                    JIM RYAN      88.01.07
!                    Jim Ryan 89.07.09 Documentation simplied.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                          implimented.
!                    David Gordon 94.04.15 Converted to Implicit None
!                    B. Archinal  95.11.13 Max # sources set in cmxsr.i.
!                    David Gordon 98.09.08 Add /CMATH/ Common block.
!                    David Gordon 98.09.11 Add new /Pmotn/ and /PRLX/ common
!                          blocks to hold proper motion offsets and distance.
!                          Code added to compute and handle proper motions,
!                          if that option is turned on.
!                    David Gordon 98.11.25 Removed proper motion computations
!                          and moved them to the initialization section.
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    David Gordon 2012.12.20  Database GET's move to 
!                          subroutine GET_G.
!
!     STRG PROGRAM STRUCTURE
!
!   GET of 'STAR ID' moved to subroutine GET_G.
!
!     Construct the arrays which will hold the information for the
!     source being used in the current observation in order to pass
!     this information to the remainder of CALC.
!
!       Write(6,*) 'C_mode: ', C_mode
!     Match the current star name against the names in the star catalog.
!     If no match, send a message and quit.
      IF (C_mode .eq. 'mark3 ') Then
  300  DO 310  NN = 1, NUMSTR
           N = NN
           IF  ( ( LNSTAR(1,N) .EQ. LSTRNM(1) ) &
     &     .AND. ( LNSTAR(2,N) .EQ. LSTRNM(2) ) &
     &     .AND. ( LNSTAR(3,N) .EQ. LSTRNM(3) ) &
     &     .AND. ( LNSTAR(4,N) .EQ. LSTRNM(4) ) )  GO TO 320
  310  CONTINUE
!       Write(6,*) 'NUMSTR= ', NUMSTR
!       Write(6,*) 'LSTRNM= ', LSTRNM(1), LSTRNM(2), LSTRNM(3), LSTRNM(4)
!       Write(6,*) 'LNSTAR= ', LNSTAR(1,1),LNSTAR(2,1),LNSTAR(3,1),LNSTAR(4,1)
       GO TO 600
      ENDIF
!
      IF (C_mode .eq. 'difx  ') Then
       N = Isource
       SName = SrcName(N)
       Sourc20 = SName
!       Write(6,*) 'NUMSTR: ', NUMSTR
!       Write(6,'(" SName, SrcName: ",A20,2X,A20)') SName,SrcName(N)
!       Write(6,'(" STRNM= ",4A2)' ) LSTRNM
      ENDIF
!
!     Construct the arrays to hold the sine and cosine of the star
!     declination and right ascention.
  320 CONTINUE
      RIGHT_ASC   = RADEC(1,N)
      DECLINATION = RADEC(2,N)
!      WRITE(6,*) 'STRG: RIGHT_ASC,DECLINATION ', RIGHT_ASC,DECLINATION
!
!***********************************************************************
!  Check for proper motion computations
!     IF (KSTRC.eq.1 .or. KSTRC.eq.2) THEN
!  Compute proper motion offsets in RA and Dec
!   Proper motion epoch
!       Xepoch = P_motion(3,N)
!   Truncate to integer year
!       Ieph = Xepoch
!   Day of year
!       If (JMOD(Ieph,4) .eq. 0) Then
!        Xdays = (Xepoch - Ieph) / 366.D0
!       Else
!        Xdays = (Xepoch - Ieph) / 365.D0
!       Endif
!   Julian day an Jan. 1
!        IM = 1
!        ID = 1
!       XJAN1 = JDY2K(Ieph,IM,ID)
!   Julian day at proper motion epoch
!       JDepoch = XJAN1 - 1 + Xdays
!   Difference: (Observation time) - (Proper motion epoch), yrs
!       Difyrs = ((XJD+UTC) - JDepoch) / 365.25D0
!   Proper motion in RA (convert arc-seconds to time units in radians)
!       PR_RA = P_motion(1,N) / DCOS(DECLINATION) * CONVDS * Difyrs
!   Proper motion in Dec (convert arc-seconds to radians)
!       PR_DEC = P_motion(2,N) * CONVDS * Difyrs
!
!   Determine if proper motions should be added to the source vector. If so
!    the corrections should also be reversed for later use in STRP.
!       IF (KSTRC.eq.2) THEN
!         RIGHT_ASC   = RIGHT_ASC   + PR_RA
!         DECLINATION = DECLINATION + PR_DEC
!         PR_RA  = -PR_RA
!         PR_DEC = -PR_DEC
!       ENDIF
!      WRITE(6,8) ' Xepoch, Xdays, XJAN1, JDepoch, Difyrs ',
!    *              Xepoch, Xdays, XJAN1, JDepoch, Difyrs
!      WRITE(6,8) ' PR_RA, PR_DEC ', PR_RA, PR_DEC
!
!     ENDIF
!***********************************************************************
!
      SD = DSIN ( DECLINATION)
      CD = DCOS ( DECLINATION)
      SRA = DSIN ( RIGHT_ASC )
      CRA = DCOS ( RIGHT_ASC )
!
!     Compute the star position unit vector.
      STAR(1) = CD * CRA
      STAR(2) = CD * SRA
      STAR(3) = SD
!
!  Compute star unit vectors at sites 1 and 2. 
       Do J = 1, 2
        Do I = 1, 3
         STAR12(I,J) = STAR(I)
        Enddo
       Enddo
!
      IF (KSTRC.eq.1 .or. KSTRC.eq.2) THEN
        PR_RA  = PRcorr(1,N)
        PR_DEC = PRcorr(2,N)
      ENDIF
!
!  Match source with distance, if parallax to be computed
      IF (KPLXC .eq. 1) Then
        Dparsec = D_psec(N)
        WRITE (6,8) ' Dparsec ', Dparsec
      ENDIF
!
!
!!!!!!!!!!!!!!!!!!!! DEBUG !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     WRITE ( 6, 9207 )  STAR, LSTRNM
!9207 FORMAT (1X, "STAR   = ", 3 ( D30.16, 10X ), /, 1X, &
!    &            "LSTRNM = ", 4A2, / )
!!!!!!!!!!!!!!!!!!!! DEBUG !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!
!     Check KSTRD for debug output.
      IF ( KSTRD .EQ. 0 )  GO TO 500
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine STRG." )
!
      WRITE(6,8)' CD      ',CD
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CRA     ',CRA
      WRITE(6,8)' RADEC   ',RADEC
      WRITE(6,7)' NUMSTR  ',NUMSTR
    7 FORMAT(A,15I8/(9X,15I8))
      WRITE(6,8)' SD      ',SD
      WRITE(6,8)' SRA     ',SRA
!
      WRITE ( 6, 9200 )  STAR, LSTRNM, LNSTAR
 9200 FORMAT (1X, "STAR   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            "LSTRNM = ", 4A2, /, 1X, &
     &            "LNSTAR = ", 20 ( 5(10A2,2X), /, 1X ) )
!
      IF (KSTRC.eq.1 .or. KSTRC.eq.2) THEN
       WRITE(6,8) ' Xepoch, Xdays, XJAN1, JDepoch, Difyrs ', &
     &              Xepoch, Xdays, XJAN1, JDepoch, Difyrs
       WRITE(6,8) ' PR_RA, PR_DEC ', PR_RA, PR_DEC
      ENDIF
      IF (KPLXC .eq. 1) WRITE (6,8) ' Dparsec ', Dparsec
!
!   5.    NORMAL PROGRAM CONCLUSION.
!
  500 RETURN
!
!   6.    ABNORMAL PROGRAM TERMINATION.
!
  600 WRITE ( 6, 9300 )
 9300 FORMAT (" CALC has terminated in subroutine STRG.  ", &
     &        ' The source identification was not successful. ' )
!
      CALL TERMINATE_CALC ( 'STRG  ', int2(0), int2(0))
      END
!**********************************************************************
      SUBROUTINE STRP (EPBASE,STAR,EARTH,SITEV,      CDX,CRAX,SDX,SRAX)
      IMPLICIT None
!
! 5.1.1 STRP is the partial derivatives section of the STAR module. It computes
!       the partial derivatives of the delay and rate with respect to the source
!       declination and right ascension.
!
! 5.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. EPBASE(3,2) - THE J2000.0 GEOCENTRIC BASELINE VECTOR
!                              AND ITS CT TIME DERIVATIVE. (M, M/SEC)
!             2. STAR(3)     - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!             3. EARTH(3,3)  - The ssbc position, velocity, and acceleration
!                               of the Earth. (m, m/s, m/s**2)
!           OUTPUT VARIABLES:
!             1. CDX -  THE COSINE OF THE DECLINATION OF THE SOURCE
!             2. CRAX - THE COSINE OF THE RIGHT ASCENSION OF THE SOURCE
!             3. SDX -  THE SINE OF THE DECLINATION OF THE SOURCE
!             4. SRAX - THE SINE OF THE RIGHT ASCENSION OF THE SOURCE
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!           VARIABLES 'FROM':
!             1. VLIGHT  - THE VELOCITY OF LIGHT IN VACUUM.  (M/SEC)
!             2. VLIGHT2 - THE VELOCITY OF LIGHT IN VACUUM SQUARED.
!                          (M**2/SEC**2)
!
      INCLUDE 'cmxsr11.i'
!           VARIABLES 'FROM':
!             1. CD  - THE COSINE OF THE DECLINATION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!             2. CRA - THE COSINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!             3. SD  - THE SINE OF THE DECLINATION OF THE STAR BEING USED
!                      IN THE CURRENT OBSERVATION.
!             4. SRA - THE SINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1.  KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!             2.  KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables to:
!         1. DSTRP(2,2) - THE PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!                         RATE WITH RESPECT TO THE SOURCE RIGHT ASCENSION AND
!                         DECLINATION. (sec/rad, sec/sec-rad) THE FIRST INDEX
!                         RUNS OVER RA AND DEC, THE SECOND RUNS OVER DELAY AND
!                         DELAY RATE.
!
!
      Real*8 PR_RA, PR_DEC
      Common /Pmotn/ PR_RA, PR_DEC
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
       Real*8 DDEC(3), DRA(3),             EPBASE(3,2), STAR(3), CDX,   &
     &        CRAX, SDX, SRAX, EARTH(3,3), SITEV(3,2), c1, c2, tt,      &
     &        vg(3), bp(3), bv(3),            DOTP
!*   &        vg(3), bp(3), bv(3), PMCONT(2), DOTP
       Integer*4 I
!
! 5.2.4 DATA BASE ACCESS - Moved to subroutine PUT_P ('STR PART').
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVP
!             CALLED SUBROUTINES: 
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES -
!             1. DDEC(3) - THE PARTIAL DERIVATIVE OF THE J2000.0 SOURCE UNIT
!                          VECTOR WITH RESPECT TO SOURCE DECLINATION. (1/RAD)
!             2. DRA(3)  - THE PARTIAL DERIVATIVE OF THE J2000.0 SOURCE UNIT
!                          VECTOR WITH RESPECT TO THE SOURCE RIGHT ASCENSION.
!                          (1/RAD)
!             3. c1, c2, tt, vg(3), b(3) -  Dummy variables used in computation
!                          of the partials.
!
! 5.2.9 PROGRAMMER - 77.01.13 Dale Markham
!                    77.07.14 Peter Denatale
!                    88.11.10 Bruce Schupler
!                    88.01.07 Jim Ryan
!                    89.07.09 Jim Ryan Documentation simplied.
!                    89.10.05 Jim Ryan CPHYS common made an include file
!                    89.12.12 Jim Ryan UNIX-like database interface
!                             implimented.
!                    01:11:25 Jim Ryan Term 2 of Shapiro's model added
!                             to the partials.
!                    David Gordon 94.04.15 Converted to Implicit None
!                    David Gordon 95.05.02 DSTRP passed back to DRIVR for use
!                             in PLXP.
!                    B. Archinal  95.11.13 Max # sources set in cmxsr.i.
!                    David Gordon 98.09.08 Changed partials computation to
!                             use CONSENSUS model (Step 10B). Makes no
!                             significant difference.
!                    David Gordon 2000.05.15 Bug correction, variable c1
!                             redefined (had been commented out).
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    David Gordon Jan. 2013  PUT moved to subroutine PUT_P.
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!                                             !!!!!!!!!!!!!!!
!!!!!!!!!!!!!!           NOT FOR NEAR-FIELD USE            !!!!!!!!!!!!!!! 
!!!!!!!!!!!!!!                                             !!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     STRP Program Structure
!
!  Compute the partial derivatives of the J2000.0 source unit vector with
!   respect to the source declination and with respect to the source R.A.
      DDEC(1) = - SD * CRA
      DDEC(2) = - SD * SRA
      DDEC(3) = + CD
!
      DRA(1) = - CD * SRA
      DRA(2) = + CD * CRA
      DRA(3) = 0.D0
!******************************************************************************
!   Complete the calculation of the partial derivatives.
!     c1 = 1.d0/VLIGHT
!     c2 = c1**2
!     Do i=1,3
!       vg(i) =  EARTH(I,2)
!       bp(i) = -EPBASE(I,1)
!       bv(i) = -EPBASE(I,2)
!     Enddo
!     tt = 1.d0 - c1*Dotp(STAR,vg)
!
!     DSTRP(1,1)=-c1*Dotp(bp,DRA )*tt+c2*Dotp(STAR,bp)*Dotp(vg,DRA)
!     DSTRP(1,2)=-c1*Dotp(bv,DRA )*tt+c2*Dotp(STAR,bv)*Dotp(vg,DRA)
!     DSTRP(2,1)=-c1*Dotp(bp,DDEC)*tt+c2*Dotp(STAR,bp)*Dotp(vg,DDEC)
!     DSTRP(2,2)=-c1*Dotp(bv,DDEC)*tt+c2*Dotp(STAR,bv)*Dotp(vg,DDEC)
!     WRITE(6,'(" Old DSTRP: ",4D22.14)') DSTRP
!******************************************************************************
!
!   Complete the calculation of the partial derivatives.
      Do I=1,3
        vg(I) =  EARTH(I,2) + SITEV(I,2)
        bp(I) = -EPBASE(I,1)
        bv(I) = -EPBASE(I,2)
      Enddo
      c1 = 1.d0/VLIGHT
      tt = 1.d0 + c1*Dotp(STAR,vg)
!   Changed to Consensus model formula
      DSTRP(1,1) = -Dotp(bp,DRA )/(Vlight*tt) +                         &
     &              Dotp(STAR,bp)*Dotp(vg,DRA)/Vlight2
      DSTRP(1,2) = -Dotp(bv,DRA )/(Vlight*tt) +                         &
     &              Dotp(STAR,bv)*Dotp(vg,DRA)/Vlight2
      DSTRP(2,1) = -Dotp(bp,DDEC)/(Vlight*tt) +                         &
     &              Dotp(STAR,bp)*Dotp(vg,DDEC)/Vlight2
      DSTRP(2,2) = -Dotp(bv,DDEC)/(Vlight*tt) +                         &
     &              Dotp(STAR,bv)*Dotp(vg,DDEC)/Vlight2
!     WRITE(6,'(" New DSTRP: ",4D22.14)') DSTRP
!
!
!   Copy some values from STRCM into dummy variables for use elsewhere
      CDX = CD
      CRAX = CRA
      SDX = SD
      SRAX = SRA
!
!   Check KSTRD for debug output.
      IF ( KSTRD .EQ. 0 )  GO TO 600
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine STRP." )
      WRITE(6,8)' CD     ',CD
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CRA    ',CRA
      WRITE(6,8)' DDEC   ',DDEC
      WRITE(6,8)' DRA    ',DRA
      WRITE(6,8)' DSTRP  ',DSTRP
      WRITE(6,8)' SD     ',SD
      WRITE(6,8)' SRA    ',SRA
      WRITE(6,8)' VLIGHT ',VLIGHT
      WRITE(6,8)' c1     ',c1
      WRITE(6,8)' c2     ',c2
      WRITE(6,8)' tt     ',tt
      WRITE(6,8)' vg     ',vg
      WRITE(6,8)' bp     ',bp
      WRITE(6,8)' bv     ',bv
!
      WRITE ( 6, 9200 )  EPBASE, STAR,CDX,SDX,CRAX,SRAX
 9200 FORMAT (1X, "EPBASE = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "STAR   = ", 3 ( D30.16, 10X ),/,1X, &
     &            "CDX    = ", D30.16,1X, &
     &            "SDX    = ", D30.16,1X, &
     &            "CRAX   = ", D30.16,/,1X, &
     &            "SRAX   = ", D30.16)
!
! NORMAL PROGRAM CONCLUSION.
!
  600 RETURN
      END
!***********************************************************************
      SUBROUTINE STRC ( )
      IMPLICIT None
!
! 5.1.1 STRC is the contributions section of the STAR module. It computes
!       contributions to the delay and rate due to proper motions. Used
!       only when KSTRC = 1 or 2.
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1. KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!             2. KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables from:
!         1. DSTRP(2,2)-THE PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!                       RATE WITH RESPECT TO THE SOURCE RIGHT ASCENSION AND
!                       DECLINATION. (sec/rad, sec/sec-rad) THE FIRST INDEX
!                       RUNS OVER RA AND DEC, THE SECOND RUNS OVER DELAY AND
!                       DELAY RATE.
!       Variables to:
!         1. PMCONT(2) - If KSTRC = 1, these are the contributions to
!                        the delay and rate to correct for the effect
!                        of proper motion; add to theoreticals.
!                        If KSTRC = 2, these are the contributions to
!                        return the delay and rate to their non-proper
!                        motion values; add to theoreticals. (sec, sec/sec).
!
      Real*8 PR_RA, PR_DEC
      Common /Pmotn/ PR_RA, PR_DEC
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
! 5.2.4 DATA BASE ACCESS - Moved to subroutine PUT_C ('PMOTNCON', 'PMOT2CON').
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVP
!             CALLED SUBROUTINES: 
!
! 5.2.9 PROGRAMMER - 98.09.15 D. Gordon - subroutine created
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    David Gordon Jan. 2013  PUT's moved to subroutine PUT_C.
!
!     STRC Program Structure
!
!  Check for proper motion computations
      IF (KSTRC.eq.1 .or. KSTRC.eq.2) THEN
        PMCONT(1) = PR_RA*DSTRP(1,1) + PR_DEC*DSTRP(2,1)
        PMCONT(2) = PR_RA*DSTRP(1,2) + PR_DEC*DSTRP(2,2)
!**     IF (KSTRC.eq.1) CALL PUT4 ('PMOTNCON      ', PMCONT, int2(2), &
!**  &      int2(1), int2(1))
!**     IF (KSTRC.eq.2) CALL PUT4 ('PMOT2CON      ', PMCONT, int2(2), &
!**  &      int2(1), int2(1))
      ELSE
       Return
      ENDIF
!
!** DEBUG *************************************************************
      WRITE(6,8)'STRP: DSTRP  ', DSTRP
      WRITE(6,8)'STRP: PMCONT ', PMCONT
!
!   Check KSTRD for debug output.
      IF (KSTRD .EQ. 0)  THEN
       WRITE ( 6, 9)
    9  FORMAT (1X, "Debug output for subroutine STRC." )
    8  FORMAT(A,4D25.16/(7X,5D25.16))
       WRITE(6,8)' DSTRP  ',DSTRP
       WRITE(6,8)'STRP: PMCONT ', PMCONT
      ENDIF
!
! NORMAL PROGRAM CONCLUSION.
!
  600 RETURN
      END
!***********************************************************************
      SUBROUTINE STAR_NSEW (STAR,K_EWNS, RIGHT_ASC, DECLINATION,        &
     &                      STAR12, dKew, dKns)
      IMPLICIT None
!
      Real*8 STAR(3), K_EWNS(3,4), RIGHT_ASC, DECLINATION, STAR12(3,2)
      Real*8 Zee(3), West(3), South(3), UnitW(3), UnitS(3), W1(3),      &
     &       E1(3), StarW(3), StarE(3), S1(3), N1(3), StarS(3),         &
     &       StarN(3)
      Real*8 delKew(3), delKns(3), dKew, dKns, VECMG
      Real*8 P1(3), P2(3), P3(3), W2(3), E2(3), S2(3), N2(3), sag
      Real*8 RAw, RAe, RAs, RAn, DECw, DECe, DECs, DECn, SD, CD, SRA,CRA
      Real*8 TAN0001
      Integer*4 I
!
!      write(6,*) '********* STAR_NSEW ********* '         
      Zee(1) = 0.D0
      Zee(2) = 0.D0
      Zee(3) = 1.D0
      TAN0001 = DTAN(.0001D0) 
!     TAN0001 = DTAN(.001D0) 
!      write(6,*) 'TAN0001: ', TAN0001
       sag = 1.D0 - DSQRT(1.D0 - TAN0001**2)
!
!
! Take cross product of the STAR vector and the Z-unit vector. Result 
!   is a vector in the West direction.
      Call Crosp(STAR,Zee,West)
!       write(6,*) 'STAR:  ', STAR 
!       write(6,*) 'West:  ', West
      Call VUNIT(West, UnitW)      ! make it a unit vector
!       write(6,*) 'UnitW: ', UnitW
! Compute a .0001 radian rotation of STAR in West and East directions
      Do I = 1,3
       W1(I) = STAR(I) + TAN0001 * UnitW(I)
       E1(I) = STAR(I) - TAN0001 * UnitW(I)
      Enddo
! Convert to unit vectors
      Call VUNIT(W1, StarW)
      Call VUNIT(E1, StarE)
!       write(6,*) 'Plan A: '
!       write(6,*) 'StarW: ', StarW
!       write(6,*) 'StarE: ', StarE
!
! Now do same in N-S direction
!
      Call Crosp(STAR,UnitW,South) 
      Call VUNIT(South,UnitS)
!       write(6,*) 'South: ', South
!       write(6,*) 'UnitS: ', UnitS
! Compute a .0001 radian rotation of STAR in North and South directions
      Do I = 1,3
       S1(I) = STAR(I) + TAN0001 * UnitS(I)
       N1(I) = STAR(I) - TAN0001 * UnitS(I)
      Enddo
! Convert to unit vectors
      Call VUNIT(S1, StarS)
      Call VUNIT(N1, StarN)
!       write(6,*) 'StarS: ', StarS
!       write(6,*) 'StarN: ', StarN
!---------------------------------------------------------------------
! Plan C:
!!     RAw  = RIGHT_ASC - .0001D0/DCOS(DECLINATION)
!!     DECw = DECLINATION
!!     RAe  = RIGHT_ASC + .0001D0/DCOS(DECLINATION)
!!     DECe = DECLINATION
!!
!!    SD = DSIN (DECw)
!!    CD = DCOS (DECw)
!!    SRA = DSIN (RAw)
!!    CRA = DCOS (RAw)
!!    StarW(1) = CD * CRA
!!    StarW(2) = CD * SRA
!!    StarW(3) = SD
!!
!!    SD = DSIN (DECe)
!!    CD = DCOS (DECe)
!!    SRA = DSIN (RAe)
!!    CRA = DCOS (RAe)
!!    StarE(1) = CD * CRA
!!    StarE(2) = CD * SRA
!!    StarE(3) = SD
!
!     RAs  = RIGHT_ASC 
!     DECs = DECLINATION - .0001D0
!     SD = DSIN (DECs)
!     CD = DCOS (DECs)
!     SRA = DSIN (RAs)
!     CRA = DCOS (RAs)
!     StarS(1) = CD * CRA
!     StarS(2) = CD * SRA
!     StarS(3) = SD
!
!     RAn  = RIGHT_ASC 
!     DECn = DECLINATION + .0001D0
!     SD = DSIN (DECn)
!     CD = DCOS (DECn)
!     SRA = DSIN (RAn)
!     CRA = DCOS (RAn)
!     StarN(1) = CD * CRA
!     StarN(2) = CD * SRA
!     StarN(3) = SD
!
!     Call Crosp(STAR,StarN,West ) 
!     Call VUNIT(West, UnitW)      ! make it a unit vector
! Compute a .0001 radian rotation of STAR in West and East directions
!     Do I = 1,3
!      W1(I) = STAR(I) + TAN0001 * UnitW(I)
!      E1(I) = STAR(I) - TAN0001 * UnitW(I)
!     Enddo
! Convert to unit vectors
!     Call VUNIT(W1, StarW)
!     Call VUNIT(E1, StarE)
!
!       write(6,*) 'Plan C: '
!       write(6,*) 'StarW: ', StarW
!       write(6,*) 'StarE: ', StarE
!       write(6,*) 'StarS: ', StarS
!       write(6,*) 'StarN: ', StarN
!---------------------------------------------------------------------
! Plan B:
!   Create vector perpendicular to the plane and pointing back to Earth.
!      Call VECMU(STAR,-sag,P3)
!       write(6,*) 'Plan B: '
!       write(6,*) 'STAR   ', STAR  
!       write(6,*) 'sag,P3 ', sag,P3
!
!      Call VECAD(W1,P3,W2)
!      Call VECAD(E1,P3,E2)
!      Call VECAD(S1,P3,S2)
!      Call VECAD(N1,P3,N2)
!      Call VUNIT(W2,StarW)
!      Call VUNIT(E2,StarE)
!      Call VUNIT(S2,StarS)
!      Call VUNIT(N2,StarN)
!       write(6,*) 'W2:    ', W2 
!       write(6,*) 'StarW: ', StarW
!       write(6,*) 'E2:    ', E2 
!       write(6,*) 'StarE: ', StarE
!       write(6,*) 'S2:    ', S2 
!       write(6,*) 'StarS: ', StarS
!       write(6,*) 'N2:    ', N2 
!       write(6,*) 'StarN: ', StarN
!---------------------------------------------------------------------
!
!  Load K_EWNS array 
      Do I = 1,3
       K_EWNS(I,1) = StarE(I)
       K_EWNS(I,2) = StarW(I)
       K_EWNS(I,3) = StarN(I)
       K_EWNS(I,4) = StarS(I)
        delKew(I) = StarE(I) - StarW(I)
        delKns(I) = StarN(I) - StarS(I)
      Enddo
! Find difference vectors:
       dKew = VECMG(delKew)
       dKns = VECMG(delKns)
!       write(6,*) 'dKew, dKns: ', dKew, dKns 
! One more test:
!       Do I = 1, 3
!        STAR(I) = StarS(I)
!        STAR12(I,1) = StarE(I)
!        STAR12(I,2) = StarE(I)
!       Enddo
!
      Return
      End
      SUBROUTINE THERY ( DATMC, DIONC, DLPGR, EARTH, EPBASE,            &
     &           SITEP, SITEV, SITEA, SUN, STAR, XMOON, AT )
      Implicit none
!
!     Routine THERY computes the theoretical values of delay and delay rate
!     using the information generated by the modules. Subroutine CONSEN is
!     called to perform the computations using the Eubanks "Consensus"
!     relativity model. The Shapiro and Hellings relativity model computations
!     have been removed with Calc 9.0 and are no longer used here.
!
!     References: None
!
!     Program Interface
!       Input variables:
!         1. DATMC(2,2)  - The contributions to the delay and delay rate due to
!                          tropospheric refraction at each site. (sec, sec/sec)
!         3. DIONC(2)    - The contributions to the delay and rate due to
!                          ionospheric refraction at each site. (sec, sec/sec)
!         4. DLPGR       - The CT time derivative of the long period terms in
!                          'AT MINUS CT' offset. (sec/sec) (Not used)
!         5. EARTH(3,3)  - The solar system barycentric Earth position
!                          velocity, and acceleration vectors. The first index
!                          runs over the vector components and the second runs
!                          over the time derivatives. (m, m/sec, m/sec**2)
!         6. EPBASE(3,2) - The J2000.0 baseline position and velocity vectors.
!                          (m, m/sec)
!         7. SITEA(3,2)  - The J2000.0 geocentric acceleration vectors of each
!                          observing site. (m/sec**2)
!         8. SITEP(3,2)  - The J2000.0 geocentric position vectors of each
!                          observing site. (m)
!         9. SITEV(3,2)  - The J2000.0 geocentric velocity vectors of each
!                          observing site. (m/sec)
!        10. SUN(3,2)    - The J2000.0 geocentric Sun position and velocity
!                          vectors. (m, m/sec)
!        11. XMOON(3,2)  - The J2000.0 geocentric Moon position and velocity
!                          vectors. (m, m/sec)
!        12. STAR(3)     - The J2000.0 source unit vector. (unitless)
!        13. AT          - The Atomic Time fraction of the Atomic Time Day
!                          (TAI). (days) (Not used)
!
!     Common blocks used -
!
      INCLUDE 'ccon.i'
!       Variables 'from':
!         1.  KTHEC - The Theory routine flow control flag.
!                     (No longer has any function.)
!         2.  KTHED - The theory routine debug control flag.
!         3.  KRELC - The relativity module flow control flag.
!                       0     --> Gravitational bending used.
!                       NOT 0 --> Gravitational bending not used.
!
      INCLUDE 'put2s.i'
!       Variables from:
!         2. DAXOC(2,2)  - The contributions to the delay and rate due to the
!                          antenna axis offsets. First index runs over sites,
!                          the second runs over delay and rate (sec,sec/sec).
!       Variables to:
!          1. CONDEL(2)    - The theoretical delay from the Consensus
!                            model in two pieces in units of MICROSECONDS.
!                            The 1st is the integer microseconds and the
!                            2nd is the submicroseconds portion.
!          2. CONRAT       - The theoretical delay rate from the Consensus
!                            model/ (sec/sec).
!          3. SUN_CNTRB(2) - The solar gravitational bending delay and rate
!                            terms from the Consensus model. (sec, sec/sec)
!          4. CON_CNTRB(2) - The total gravitational bending delay and rate
!                            terms from the Consensus model. (sec, sec/sec)
!          5. CON_PART(2)  - The total Consensus delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!          6. Sunplus(2)   - Higher order solar bending delay and rate
!                            contributions, as defined in IERS Conventions
!                            (1996), page 91, eqn. 14. (sec, sec/sec) It
!                            has also been added to the total solar bending
!                            delay and rate contibutions.
!          7. Bend_par(2)  - The relativistic bending delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!
!
!   Program specifications -
      INTEGER*4 I
      REAL*8 DATMC(2,2),             DIONC(2), SUN(3,2), EARTH(3,3),    &
     &       EPBASE(3,2), SITEA(3,2), STAR(3), SITEP(3,2), SITEV(3,2),  &
     &       XMOON(3,2), AT, SUNHAT(3), DLPGR, K_EWNS(3,4)
      Real*8                    delta_t_grav, d_delta_t_grav,           &
     &       tg2_tg1, dtg2_tg1, xtg2_tg1,                               &
     &       delta_t_grav_Sun, d_delta_t_grav_Sun, CONSENSUS(2),        &
     &       con_cont(2), Datmc_h_EWNS(4), Datmc_w_EWNS(4) 
!
!    Subroutine interface -
!          Caller subroutine:  DRIVR
!          Called subroutines: CONSEN
!
!    Program variables -
!           1. tg2_tg1      - The geometric delay corrected for relativistic
!                             effects using the Consensus model.
!           2. dtg2_tg1     - The time derivative of the geometric delay
!                             corrected for relativistic effects using the
!                             Consensus model.
!           3. delta_t_grav - The total differential gravitational time delay,
!                             or "bending delay" from the Consensus model.
!           4. d_delta_t_grav-The time derivative of the total differential
!                             gravitational time delay, or "bending delay,"
!                             from the Consensus model.
!
! 4.2.9 PROGRAMMER - DALE MARKHAM 01/17/77
!                  PETER DENATALE 07/20/77
!                  CHOPO MA / DAVID GORDON 04/12/84
!                  DAVID GORDON 06/19/84 REMOVED ATMOSPHERE.
!                  DAVID GORDON 07/31/84 RELATIVISTIC CORRECTIONS.
!                  DAVID GORDON 01/03/85 ADDED ATMOSPHERE AFTER MODS TO
!                               ATMOSPHERE FLAGS.
!                  SAVITA GOEL  06/03/87 CDS FOR A900.
!                  GREGG COOKE  05/01/89 NEW MODEL FROM I.SHAPIRO.
!                  JIM RYAN     06/06/89 Some bugs fixed and documentation
!                               modified.
!                  Jim Ryan     09/13/89 Robertson code removed and Hellings
!                               added.
!                  Jim Ryan     89.10.05 CPHYS common made an include file
!                  Jim Ryan     89.10.09 Relativity partials and contributions
!                               moved here.
!                  Jim Ryan     89.11.20 Shapiro algorithm modified to make
!                               it reflect Ryan's memo
!                  Jim Ryan     89.12.12 UNIX-like database interface
!                               implemented.
!                  Jim Ryan     89.12.14 Addional delay information stored
!                               and Helling rate implemented.
!                  C Ma         90.08.10 Corrections to documentation.
!                  Jim Ryan     90.11.20 Debug statement fixed and comments
!                               cleaned up.
!                  T. Marshall Eubanks & Brent Archinal 91.05.10 HELL EMS
!                               fixed, debug statements and comments modified.
!                               A900 and HP-UX versions consolidated except for
!                               dbh calls and ILUOUT.
!                  Jim Ryan     91.05.28 A few, mostly cosmetic changes made.
!                  David Gordon 93.04.27 GMEARTH put into cphys.i and
!                               defined in cinit.f; definition removed here.
!                  David Gordon 93.08.02 Thery modified to call subroutine
!                               Consen (previously called by DRIVR), and to
!                               do the puts for the Consensus delay and rate.
!                  David Gordon 93.12.22 Fixed up debug output.
!                  David Gordon 93.12.27 Added access code CONSCONT, correction
!                               to convert Hellings to Comsensus theoreticals.
!                  David Gordon 94.01.21 Added access code SHAPCONT, correction
!                               to convert Hellings to Shapiro theoreticals.
!                  David Gordon 94 Feb/March - Modified axis offset correction
!                               for use here.
!                  David Gordon 94.10.05 Corrected error in computing second
!                               half of Lcode for Shapiro delay contribution.
!                               Many unused variables removed.
!                  David Gordon 95.10.11 Minor correction to Hellings model
!                               when gravitational bending turned OFF (KRELC=1).
!                  David Gordon 96.01.30 Added Consensus model solar bending
!                               term (Sun_cntrb(2) and the L-code 'SUN CONT').
!                               Removed 'CON PART' L-code (Solar bending
!                               partials w.r.t. Gamma) and replaced it with
!                               'CONSPART' (Total Consensus delay and rate
!                               partials w.r.t. Gamma).
!                  David Gordon 98.08.18 Shapiro and Hellings models removed.
!                  David Gordon 98.11.16 Added Sunplus to CALL CONSEN argument
!                               list. Contains the delay and rate contributions
!                               due to higher order solar bending, as defined
!                               in the 1996 IERS Conventions, p. 91, eqn. 14.
!                               Added PUTR of 'SUN2CONT' to put it in the
!                               data bases. It is already included in the
!                               theoretical, therefore to remove its effects,
!                               you must SUBTRACT it from the theoretical.
!                  David Gordon 98.12.16 Added Bend_par(2), the partials of the
!                               gravitional bending contributions with respect
!                               to Gamma.
!                  Jim Ryan     Sept 2002 Integer*2/4 mods.
!                  David Gordon Jan. 2013  Moved PUT's into subroutine PUT_TH.
!
!     THERY program structure
!--------------------------------------------------------------------------
!
!   Call subroutine CONSEN to compute the delay and delay rate based on the
!   Eubanks' Consensus relativity model. We put it in its own subroutine
!   because it is a very long and detailed set of computations. 93JUL29, DG
!
      Call CONSEN ( DATMC, EARTH, EPBASE, SITEP, SITEV,                 &
     &     SITEA, SUN, XMOON, STAR, K_EWNS, Datmc_h_EWNS, Datmc_w_EWNS, &
     &     tg2_tg1, dtg2_tg1,                                           &
     &     delta_t_grav, d_delta_t_grav, delta_t_grav_Sun,              &
     &     d_delta_t_grav_Sun )
!      print *,' Delay,Rate: ', tg2_tg1, dtg2_tg1
!
!   Add the axis offset corrections
      tg2_tg1  = tg2_tg1  + DAXOC(1,1) + DAXOC(2,1)
      dtg2_tg1 = dtg2_tg1 + DAXOC(1,2) + DAXOC(2,2)
!
!      print *,' THERY '
!      print *,' DAXOC: ', DAXOC 
!      print *,' Delay,Rate (with axis offset): ', tg2_tg1, dtg2_tg1
!      print *,' Delay(ps),Rate(ps/sec): ', tg2_tg1*1.D12,dtg2_tg1*1.D12
!      write (6,*) ' With atm added: ', tg2_tg1+DATMC(1,1)+DATMC(2,1),  &
!    &               dtg2_tg1+DATMC(1,2)+DATMC(2,2)
!      print *,'       '
!
      CONSENSUS(1) =  tg2_tg1      ! Consensus delay
      CONSENSUS(2) = dtg2_tg1      ! Consensus rate
!
!      print *,' THERY/Delay (psec): ', CONSENSUS(1)*1.D12
!      print *,' THERY/Rate (psec/sec): ', CONSENSUS(2)*1.D12
!
!   Convert the theoretical delay to microseconds and split the double
!   precision results into an integer microseconds portion and a
!   submicroseconds portion.
      xtg2_tg1  = tg2_tg1  * 1.D6
      CONDEL(1) = IDINT(xtg2_tg1 )
      CONDEL(2) = xtg2_tg1 - CONDEL(1)
      CONRAT = dtg2_tg1
!
!  Compute and store the total gravitational light bending terms
      CON_CNTRB(1) = delta_t_grav
      CON_CNTRB(2) = d_delta_t_grav
!  Compute and store the solar gravitational light bending terms
      Sun_cntrb(1) = delta_t_grav_Sun
      Sun_cntrb(2) = d_delta_t_grav_Sun
!
!   Note: The Lcode 'CON CONT' will hold the TOTAL gravitational bending delay
!         and rate from the Sun, Moon, Earth, and planets. 'SUN CONT' will hold
!         the gravitational bending delay from the Sun only.
!         'CONSPART' will hold the TOTAL Consensus delay and rate partials with
!         respect to Gamma.
!
!!!!!!!!!!!! Debug !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,8)' CONDEL, CONRAT ', CONDEL, CONRAT
!      write(6,8)' CONSENSUS ',CONSENSUS
!!!!!!!!!!!! Debug !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!--------------------------------------------------------------------------
!     Check KTHED to determine if debug output is neccessary.
      !IF ( KTHED .ne. 0 )  Then
       WRITE (6, 9100 )
 9100  FORMAT (1X, "Debug output for subroutine THERY." )
    8  FORMAT(A,4D25.16/(7X,5D25.16))
       write(6,8)' tg2_tg1, dtg2_tg1 ',tg2_tg1, dtg2_tg1
       write(6,8)' CONDEL, CONRAT ', CONDEL, CONRAT
       write(6,8)' CON_CNTRB ',CON_CNTRB
       write(6,8)' SUN_CNTRB ',SUN_CNTRB
       write(6,8)' CON_PART  ',CON_PART
       write(6,8)' CONSENSUS ',CONSENSUS
       write(6,8)' Sunplus   ',Sunplus
!      Endif
!
      Return
      END
!**********************************************************************
      SUBROUTINE CONSEN ( DATMC, EARTH, EPBASE, SITEP, SITEV,           &
     &           SITEA, SUN, XMOON, STAR, K_EWNS, Datmc_h_EWNS,         &
     &           Datmc_w_EWNS, tg2_tg1, dtg2_tg1,                       &
     &           delta_t_grav, d_delta_t_grav, delta_t_grav_Sun,        &
     &           d_delta_t_grav_Sun )
      IMPLICIT NONE
!
!     Routine CONSEN computes the theoretical values of delay and delay rate
!     using the Eubanks' Consensus relativity model.
!
!     References:
!       - Eubanks, T.M., "A Consensus Model for Relativistic Effects in
!          Geodetic VLBI," in "Proceedings of the U.S. Naval Observatory
!          Workshop on Relativistic Models for Use in Space Geodesy,",
!          T.M. Eubanks (editor), USNO, Washington, DC, June, 1991.
!
!      Input Variables:
!         1.  DATMC(2,2)   -  The contributions to the delay and delay rate due
!                             to tropospheric refraction at each site. (s, s/s)
!         2.  EARTH(3,3)   -  The solar system barycentric Earth position,
!                             velocity, and acceleration vectors. The first
!                             index runs over the vector components and the
!                             second runs over the time derivatives.
!                             (m, m/sec, m/sec**2)
!         3.  EPBASE(3,2)  -  The J2000.0 baseline position and velocity
!                             vectors.  (m, m/sec)
!         4.  SITEP(3,2)   -  The J2000.0 geocentric position vectors of each
!                             observing site. (m)
!         5.  SITEV(3,2)   -  The J2000.0 geocentric velocity vectors of each
!                             observing site. (m/sec)
!         6.  SITEA(3,2)   -  The J2000.0 geocentric acceleration vectors of
!                             each observing site. (m/sec**2)
!         7.  SUN(3,2)     -  The J2000.0 geocentric Sun position and velocity
!                             vectors.  (m, m/sec)
!         8.  XMOON(3,2)   -  The J2000.0 geocentric Moon position and velocity
!                             vectors.  (m, m/sec)
!         9.  STAR(3)      -  The J2000.0 source unit vector. (unitless)
!
!      Output Variables:
!         1. tg2_tg1       -  The geometric delay corrected for relativistic
!                             effects (but not atmospheric refraction) using
!                             the Consensus model.
!         2. dtg2_tg1      -  The time derivative of the geometric delay
!                             corrected for relativistic effects using the
!                             Consensus model.
!         3. delta_t_grav  -  The total differential gravitational time delay,
!                             or "bending delay" from the Consensus model.
!         4. d_delta_t_grav-  The time derivative of the total differential
!                             gravitational time delay, or "bending delay" from
!                             the Consensus model.
!         5. delta_t_grav_Sun-The Sun's contribution to the "bending delay"
!                             from the Consensus model. Now includes
!                             Sunplus(1).
!         6. d_delta_t_grav_Sun-The time derivative of the Sun's contribution
!                             to the "bending delay" from the Consensus model.
!                             Now includes Sunplus(2).
!         7. Con_part      -  Partial derivatives of the Consensus delays and
!                             rates with respect to Gamma.
!         8. Sunplus(2)    -  Higher order solar bending delay and rate
!                             contributions, as defined in IERS Conventions
!                             (1996), page 91, eqn. 14. (sec, sec/sec) It
!                             has also been added to the total solar bending
!                             delay and rate contibutions.
!         9. Bend_par(2)   -  The relativistic bending delay and rate partials
!                             with respect to Gamma. (sec, sec/sec)
!
!     Common blocks used -
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - The velocity of light cubed. (m/sec)**3
!            4. GAMMA   - The post Newtonian expansion parameter which
!                         affects light bending. (1.0 used here). (unitless)
!            5. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!            6. REARTH  - The equatorial radius of the Earth. (meters)
!
      INCLUDE 'csolsys11.i'
!       Variables 'from':
!         1. SPLANET(3,2,7) - The J2000.0 Solar System Barycentric positions
!                             and velocities of all planets except the Earth
!                             and Pluto. (meters, meters/sec) The first index
!                             runs over X,Y, and Z, the second runs over
!                             position and velocity, and the third runs over
!                             the planets, where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                             of all planets except the Earth and Pluto.
!                             (meters, meters/sec) The first index runs over
!                             X,Y, and Z, the second runs over position and
!                             velocity, and the third runs over the planets,
!                             where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
       INCLUDE 'ccon.i'
!            Variables 'from':
!              1.  KTHEC  -  The Theory routine flow control flag.
!                            (No longer has any function.)
!              2.  KTHED  -  The theory routine debug control flag.
!              3.  KRELC  -  The relativity module flow control flag.
!                            0     --> Gravitational bending used.
!                            NOT 0 --> Gravitational bending not used.
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          5. CON_PART(2)  - The total Consensus delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!          6. Sunplus(2)   - Higher order solar bending delay and rate
!                            contributions, as defined in IERS Conventions
!                            (1996), page 91, eqn. 14. (sec, sec/sec) It
!                            has also been added to the total solar bending
!                            delay and rate contibutions.
!          7. Bend_par(2)  - The relativistic bending delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!
      INCLUDE 'd_input.i'
!       Variables from:
!         1. UVW - 
!
!
!   Program Specifications -
      INTEGER*4 l,k
      REAL*8 DATMC(2,2), SUN(3,2), EARTH(3,3), EPBASE(3,2), SITEA(3,2), &
     &       STAR(3), SITEP(3,2), SITEV(3,2), XMOON(3,2), K_EWNS(3,4),  &
     &       Datmc_h_EWNS(4),Datmc_w_EWNS(4), DOTP, VECMG
      Real*8 XsubEarth(3), VsubEarth(3), AsubEarth(3)
      Real*8 x_sub1t1(3), x_sub2t1(3), w_sub1(3), w_sub2(3)
      Real*8 a_sub1(3), a_sub2(3)
      Real*8 unit_K(3), b_nought(3),db_nought(3)
      Real*8 x_subSun(3), x_subMoon(3), v_subSun(3), v_subMoon(3)
      Real*8 XsubSun(3), XsubMoon(3), VsubSun(3), VsubMoon(3)
      Real*8 R_Earth_Sun(3), R_Earth_Moon(3)
      Real*8 V_Earth_Sun(3), V_Earth_Moon(3)
      Real*8 Xsub1(3), Xsub2(3), t_sub1, t_sub2
      Real*8 dXsub1(3), dXsub2(3)
      Real*8 x1Sun(3), x1Moon(3), x1Planet(3,7)
      Real*8 del_t_Sun, del_t_Moon, del_t_Planet(7)
      Real*8 XSunt1J(3), XMoont1J(3), XPlant1J(3,7)
      Real*8 dXSunt1J(3), dXMoont1J(3), dXPlant1J(3,7)
      Real*8 R1Sunt1(3), R1Moont1(3), R1Plant1(3,7)
      Real*8 R2Sunt1(3), R2Moont1(3), R2Plant1(3,7)
      Real*8 dR1Sunt1(3), dR1Moont1(3), dR1Plant1(3,7)
      Real*8 dR2Sunt1(3), dR2Moont1(3), dR2Plant1(3,7)
      Real*8 delta_t_grav, delta_t_grav_Sun, delta_t_grav_Moon, &
     &       delta_t_grav_Earth, delta_t_grav_Plan(7), &
     &       delta_t_grav_Planets
      Real*8 d_delta_t_grav, d_delta_t_grav_Sun, d_delta_t_grav_Moon, &
     &       d_delta_t_grav_Earth, d_delta_t_grav_Plan(7), &
     &       d_delta_t_grav_Planets
      Real*8 U, U_Sun, dU, absVEarth
      Real*8 C_Earth, C_Sun, C_Moon, C_Plan(7)
      Real*8 term_a, term_b, term_c, term_d, term_e, term_f, &
     &       term_g, term_h
      Real*8 dterm_a, dterm_b, dterm_c, dterm_d, dterm_e, dterm_f, &
     &       dterm_g, dterm_h
      Real*8 term1, term2a, term2b, term2c, term2d, term2, &
     &       term2bcd, term3a, term3b, term3, term4, &
     &       term123, vec_sum(3), tv2_tv1
      Real*8 dterm1, dterm2a, dterm2b, dterm2c, dterm2d, dterm2, &
     &       dterm2bcd, dterm3a, dterm3b,  dterm3, dterm4, &
     &       dterm123, dvec_sum(3), dtv2_tv1
      Real*8 V_w1(3), V_w2(3), K_V_w1, K_V_w2           !!
      Real*8 tg2_tg1, dtg2_tg1
      Real*8 w2_w1(3), a2_a1(3), K_dotw2w1, dK_dotw2w1
      Real*8 KdotB, dKdotB, VdotB, dVdotB, KdotV, dKdotV
      Real*8 delta_t2_t1, d_delta_t2_t1, term10a, term10b, term10c, &
     &       dterm10a, dterm10b, dterm10c, del_del_t(2,2)
      Real*8 x_delta_t2_t1, dx_delta_t2_t1
      Real*8 vecmg1,vecmg2
      Real*8 N_hat(3), dN_hat(3), Vmag_S, CSun1, NplusK(3), V1, dV1, &
     &       V2, dV2
!
!     Subroutines used:  DOTP, VUNIT, VECAD, VECSB, VECMG
!
!     Constants used - VLIGHT      - Speed of light (m/s)
!                      VLIGHT2     - Speed of light squared
!                      VLIGHT3     - Speed of light cubed
!                      GMMOON      - GM of the Moon.
!                      GMEARTH     - GM of the Earth.
!                      GMSUN       - GM of the Sun.
!                      GMPlanet(7) - GM's of all planets except Earth and Pluto
!
!   Program variables -
!
!    1.  XsubEarth(3)  =  Barycentric radius vector of the geocenter (meters).
!    2.  VsubEarth(3)  =  Barycentric velocity vector of the geocenter (m/sec).
!    3.  AsubEarth(3)  =  Barycentric acceleration of the geocenter (m/sec**2).
!
!    4.  x_sub1t1(3)   =  Geocentric radius vector of receivers 1 and 2 at the
!    5.  x_sub2t1(3)        geocentric time t_sub1 (meters).
!
!    6.  w_sub1(3)     =  Geocentric velocity of receiver 1 (m/sec).
!    7.  w_sub2(3)     =  Geocentric velocity of receiver 2 (m/sec).
!
!    8.  a_sub1(3)     =  Geocentric acceleration of receiver 1 (m/sec).
!    9.  a_sub2(3)     =  Geocentric acceleration of receiver 2 (m/sec).
!
!   10.  x_subSun(3)   =  Geocentric radius vector of the Sun (meters).
!   11.  x_subMoon(3)  =  Geocentric radius vector of the Moon (meters).
!   12.  GPLANET(l,1,k)=  Geocentric radius vectors of the planets (meters).
!                          (l = X,Y,Z; k = planet #)
!
!   13.  v_subSun(3)   =  Geocentric velocity vector of the Sun (m/sec).
!   14.  v_subMoon(3)  =  Geocentric velocity vector of the Moon (m/sec).
!   15.  GPLANET(l,2,k)=  Geocentric velocity vector of the planets (m/sec).
!                          (l = X,Y,Z; k = planet #)
!
!   16.  Xsub1(3)      =  Barycentric radius vector of receiver 1 (meters).
!   17.  Xsub2(3)      =  Barycentric radius vector of receiver 2 (meters).
!   18.  dXsub1(3)     =  Barycentric velocity vector of receiver 1 (m/sec).
!   19.  dXsub2(3)     =  Barycentric velocity vector of receiver 2 (m/sec).
!
!   20.  x1Sun(3)      =  Vector from receiver 1 to the Sun at time t_sub1
!   21.  x1Moon(3)     =  Vector from receiver 1 to the Moon at time t_sub1
!   22.  x1Planet(3,7) =  Vector from receiver 1 to the planets at time t_sub1
!
!   23.  XsubSun(3)    =  Barycentric radius vector of the Sun/Moon/planets
!   24.  XsubMoon(3)
!   25.  SPLANET(l,1,k)
!
!   26.  VsubSun(3)    =  Barycentric velocity vector of the Sun/Moon/planets
!   27.  VsubMoon(3)
!   28.  SPLANET(l,2,k)
!
!   29.  XSunt1J(3)    =  SSBC radius vector to the Sun/Moon/planets
!   30.  XMoont1J(3)         at the time of closest approach.
!   31.  XPlant1J(3,7)              (meters)
!
!   32.  R_Earth_Sun(3) = Vector from the Sun to the geocenter
!   33.  R_Earth_Moon(3)= Vector from the Moon to the geocenter
!   34.  -GPLANET(l,1,k)= Vector from planets to the geocenter
!
!   35.  V_Earth_Sun(3) = Velocity Vector of the geocenter from the Sun
!
!   36.  R1Sunt1(3)    =  Vector from the Sun/Moon/planets to receiver
!   37.  R1Moont1(3)   =      1 at the time of closest approach.
!   38.  R1Plant1(3,7) =                (meters)
!
!   39.  R2Sunt1(3)    =  Vector from the Sun/Moon/planets to receiver
!   40.  R2Moont1(3)   =      2 at the time of closest approach.
!   41.  R2Plant1(3,7) =              (meters)
!
!   42.  t_sub1        =  Time of arrival of the signal at receivers 1 and 2.
!   43.  t_sub2            [Note: not needed here so we don't actually define
!                          them.]
!
!   44.  del_t_Sun     =  Difference between arrival time at receiver 1, t_sub1,
!   45.  del_t_Moon         and time of closest approach to Sun/Moon/planets
!   46.  del_t_Planet(7)      ( > 0 if closest approach is before arrival)
!
!   47.  unit_K(3)     =  Barycentric unit vector to the source (in the absense
!                         of gravitational or aberrational bending).
!
!   48.  k_sub1(3)     =  Aberrated unit vector from station 1 to the source.
!   49.  k_sub2(3)     =  Aberrated unit vector from station 2 to the source.
!                          [Note: not computed here, see atmosphere module.]
!
!   50.  b_nought(3)   =  A priori geocentric baseline vector at time t_sub1
!                         (Baseline vector and it's velocity. Defined from
!                         site #1 to site #2 (M,M/S).)
!
!   51.  U             =  Sun's potential
!
!   52.  delta_t_grav_Sun
!   53.  delta_t_grav_Moon =  The differential gravitational time delay for
!   54.  delta_t_grav_Plan(7)     the Sun/Moon/planets/Earth.
!   55.  delta_t_grav_Earth
!
!   56.  delta_t_grav_Planets = Sum of bending delays for the planets
!
!   57.  delta_t_grav  =  The total differential gravitational time delay,
!                         or "bending delay."
!
!   58.  tv2_tv1       =  The theoretical vacuum delay computed using the
!                         Consensus model. (sec)
!
!   59.  tg2_tg1       =  The total theoretical geometric delay (doesn't
!                         include tropospheric refraction effects which are
!                         usually added in Solve) computed using the Consensus
!                         model. (sec)
!
! 4.2.9 PROGRAMMER - DAVID GORDON 04/22/93 thru 08/02/93 - Written and debuged
!                    D. Gordon Nov. 1993 - Modified to use all planets
!                              except Pluto.
!                    D. Gordon Jan-Mar 1994 - Modified for axis offset
!                              correction. Not using Eubank's Step 10.
!                    D. Gordon 10.05.94 Many unused variable and much unused
!                              code removed.
!                    D. Gordon 96.01.30 Added section to compute partial
!                              derivatives of delay and rate w.r.t. Gamma.
!                    D. Gordon 96.02.09 Corrected typo in Step 2 debug printout.
!                    D. Gordon 98.08.18 Mods for geocenter station.
!                    D. Gordon 98.11.16 Added computation of higher order
!                              solar bending term, from IERS Conventions
!                              (1996), page 91, eqn. 14. This term is now
!                              added to the total solar bending term. It
!                              only becomes significant within about 2
!                              degrees of the Sun.
!                    D. Gordon 98.12.16 Added computation of Bend_par(2), the
!                              partial derivatives of the gravitational
!                              bending contributions with respect to Gamma.
!
!     CONSEN program structure:
!
!     Compute the theoretical delay and delay rate using Eubanks's Consensus
!     Relativity model.
!_____________________________________________________________________________
!
!     Copy CALC variables into variables with names which mimic the variables
!     in the consensus paper. VLIGHT is used for the velocity of light because
!     'C' is a poor variable name that could be easily lost.
!
      Do l=1,3
!
       XsubEarth(l) = EARTH(l,1)     ! SSBC Earth position
       VsubEarth(l) = EARTH(l,2)     !   ditto    velocity
       AsubEarth(l) = EARTH(l,3)     !   ditto    acceleration
!
       x_sub1t1(l) = SITEP(l,1)      ! Site 1 geocentric position
       w_sub1(l)   = SITEV(l,1)      !      ditto        velocity
       a_sub1(l)   = SITEA(l,1)      !      ditto        acceleration
!
       x_sub2t1(l) = SITEP(l,2)      ! Site 2 geocentric position
       w_sub2(l)   = SITEV(l,2)      !      ditto        velocity
       a_sub2(l)   = SITEA(l,2)      !      ditto        acceleration
!
       unit_K(l)    = STAR(l)        ! J2000.0 unit source vector
!
       x_subSun(l)  = SUN(l,1)       ! Geocentric Sun position
       v_subSun(l)  = SUN(l,2)       !       ditto    velocity
!
       x_subMoon(l) = XMOON(l,1)     ! Geocentric Moon position
       v_subMoon(l) = XMOON(l,2)     !       ditto     velocity
!
       b_nought(l)  = -EPBASE(l,1)   ! Baseline vector from site 1 to site 2
       db_nought(l) = -EPBASE(l,2)   ! Time derivative of baseline vector
!
       R_Earth_Sun(l)  = -SUN(l,1)
       V_Earth_Sun(l)  = -SUN(l,2)    ! = -v_subSun(l) also
       R_Earth_Moon(l) = -XMOON(l,1)
!
!   SSBC radius vectors of Sun and Moon:
       XsubSun(l)  = XsubEarth(l) + x_subSun(l)
       XsubMoon(l) = XsubEarth(l) + x_subMoon(l)
!
!   SSBC velocity vectors of Sun and Moon:
       VsubSun(l)  = VsubEarth(l) + v_subSun(l)
       VsubMoon(l) = VsubEarth(l) + v_subMoon(l)
!
      Enddo
!
!    Atomic time, TAI, at receiver #1:
!      t_sub1 =   ! Not needed here
!
      If (KTHED .ne. 0) Then
       write(6,'(/,15x,"  Debug output for subroutine CONSEN",/)')
       write(6,8)' GMSUN  ', GMSUN
       write(6,8)' GMMOON ', GMMOON
       write(6,8)' GMEARTH', GMEARTH
       write(6,'("GM-Planets = ",3d25.16,/,5x,4d25.16)') GMPLANET
!      write(6,8)' GAMMA  ', GAMMA
       write(6,'(/,"XsubEarth:",3D23.14)') XsubEarth
       write(6,'("VsubEarth:",3D23.14)') VsubEarth
       write(6,'("AsubEarth:",3D23.14)') AsubEarth
       write(6,'("x_sub1t1:",3D23.14)') x_sub1t1
       write(6,'("w_sub1:",3D23.14)') w_sub1
       write(6,'("a_sub1:",3D23.14)') a_sub1
       write(6,'("x_sub2t1:",3D23.14)') x_sub2t1
       write(6,'("w_sub2:",3D23.14)') w_sub2
       write(6,'("a_sub2:",3D23.14)') a_sub2
       write(6,'("unit_K:",3D23.14)') unit_K
       write(6,'("x_subSun:",3D23.14)') x_subSun
       write(6,'("x_subMoon:",3D23.14)') x_subMoon
       write(6,'("v_subSun:",3D23.14)') v_subSun
       write(6,'("v_subMoon:",3D23.14)') v_subMoon
       write(6,'("b_nought:",3D23.14)') b_nought
       write(6,'("db_nought:",3D23.14)') db_nought
       write(6,'("R_Earth_Sun:",3D23.14)') R_Earth_Sun
       write(6,'("V_Earth_Sun:",3D23.14)') V_Earth_Sun
       write(6,'("R_Earth_Moon:",3D23.14)') R_Earth_Moon
       write(6,'("XsubSun:",3D23.14)') XsubSun
       write(6,'("XsubMoon:",3D23.14)') XsubMoon
       write(6,'("VsubSun:",3D23.14)') VsubSun
       write(6,'("VsubMoon:",3D23.14)') VsubMoon
      Endif
!
!******************************************************************************
!  Step 1: Estimate barycentric radius and velocity vectors for stations 1
!          and 2 at time t_sub1 (Equation 6 and time derivative of).
!
      Do l=1,3
       Xsub1(l) = XsubEarth(l) + x_sub1t1(l)
       Xsub2(l) = XsubEarth(l) + x_sub2t1(l)
       dXsub1(l) = VsubEarth(l) + w_sub1(l)     !derivative
       dXsub2(l) = VsubEarth(l) + w_sub2(l)     !derivative
      Enddo
!
      If (KTHED .ne. 0) Then
       write(6,'(/,15x,"Step 1 dump:")')
       write(6,8)' Xsub1 ',Xsub1
       write(6,8)' Xsub2 ',Xsub2
       write(6,8)' dXsub1 ',dXsub1
       write(6,8)' dXsub2 ',dXsub2
      Endif
!
!******************************************************************************
!  Step 2: Estimate the vectors from the Sun, the Moon, and each planet (except
!          Earth and Pluto) to receiver 1.
!
!   Eq. 5a  -  Find time of closet approach to the gravitating body. [Actually
!              we find only how much earlier (or later) the quasar's rays
!              passed closest to the gravitating body. Then, if earlier, we
!              extrapolate the body's position back to that earlier time. If
!              not earlier we just keep the current position.]
!
!  J2000.0 vector from receiver #1 to the Sun/Moon/planets:
      Do l=1,3
       x1Sun(l)  = XsubSun(l)  - Xsub1(l)
       x1Moon(l) = XsubMoon(l) - Xsub1(l)
      Enddo
      Do k=1,7
       do l=1,3
        x1Planet(l,k)  = SPLANET(l,1,k)  - Xsub1(l)
       enddo
      Enddo
!
!   more good stuff
       KdotB  = DOTP(unit_K,b_nought)
       dKdotB = DOTP(unit_K,db_nought)     !derivative
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Sun:
       del_t_Sun  = DOTP(unit_K,x1Sun) / Vlight
       If(del_t_Sun .lt. 0.D0) del_t_Sun = 0.0D0
!
        Do l=1,3
!    SSBC vector to Sun at time of closest approach and its time derivative:
         XSunt1J(l) = Xsubsun(l) - VsubSun(l)*del_t_Sun
         dXSunt1J(l) = Vsubsun(l)   !Derivative (approx. - no acceleration)
!
!         equation 5b: Vector from the Sun to receiver 1
         R1Sunt1(l) = Xsub1(l) - XSunt1J(l)
         dR1Sunt1(l) = dXsub1(l) - dXSunt1J(l)   !Derivative
!
!         equation 5c: Vector from the Sun to receiver 2
         R2Sunt1(l) = Xsub2(l) - VsubEarth(l)*KdotB/VLIGHT - XSunt1J(l)
         dR2Sunt1(l) = dXsub2(l) -  AsubEarth(l)*KdotB/VLIGHT - &
     &                 VsubEarth(l)*dKdotB/VLIGHT - dXSunt1J(l)   !Derivative
        Enddo
!
!  98NOV18 addition, unit vector from Sun to receiver #1
          Call VUNIT (R1Sunt1, N_hat)
          Vmag_S = VECMG(R1Sunt1)
          Do l=1,3
           dN_hat(l) = dR1Sunt1(l)/Vmag_S - &
     &        R1Sunt1(l)*(DOTP(dR1Sunt1,R1Sunt1))/Vmag_S**3
          Enddo
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Moon:
       del_t_Moon = DOTP(unit_K,x1Moon) / Vlight
       If(del_t_Moon .lt. 0.D0) del_t_Moon = 0.D0
!
        Do l=1,3
!    SSBC vector to Moon at time of closest approach and its time derivative:
         XMoont1J(l) = XsubMoon(l) - VsubMoon(l)*del_t_Moon
         dXMoont1J(l) = VsubMoon(l)    !Derivative (approx. - no acceleration)
!
!        equation 5b: Vector from the Moon to receiver 1
         R1Moont1(l) = Xsub1(l) - XMoont1J(l)
         dR1Moont1(l) = dXsub1(l) - dXMoont1J(l)   !Derivative
!
!        equation 5c: Vector from the Moon to receiver 2
         R2Moont1(l) = Xsub2(l) - VsubEarth(l)* KdotB/VLIGHT - &
     &                 XMoont1J(l)
         dR2Moont1(l) = dXsub2(l) - AsubEarth(l)*KdotB/VLIGHT - &
     &                VsubEarth(l)*dKdotB/VLIGHT - dXMoont1J(l)  !Derivative
        Enddo
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Planets:
      Do k=1,7      !Planet loop
       del_t_Planet(k)  = DOTP(unit_K,x1Planet(1,k)) / Vlight
       If(del_t_Planet(k) .lt. 0.D0) del_t_Planet(k) = 0.D0
!
        Do l=1,3
!    SSBC vector to Planet at time of closest approach and its time derivative:
         XPlant1J(l,k) = SPLANET(l,1,k) - SPLANET(l,2,k)*del_t_Planet(k)
         dXPlant1J(l,k) = SPLANET(l,2,k)    ! Derivative  (approximate)
!
!        equation 5b: Vector from Planet to receiver 1
         R1Plant1(l,k) = Xsub1(l) - XPlant1J(l,k)
         dR1Plant1(l,k) = dXsub1(l) - dXPlant1J(l,k)   !Derivative
!
!        equation 5c: Vector from Planet to receiver 2
         R2Plant1(l,k) = Xsub2(l) - VsubEarth(l)*KdotB/VLIGHT - &
     &                XPlant1J(l,k)
         dR2Plant1(l,k) = dXsub2(l) - AsubEarth(l)*KdotB/VLIGHT - &
     &               VsubEarth(l)*dKdotB/VLIGHT - dXPlant1J(l,k)   !Derivative
        Enddo
      Enddo      !Planet loop
!
!******************* Debug ********************
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,'(/,15x,"Step 2 dump:")')
       write(6,8)' x1Sun ',x1Sun
       write(6,8)' x1Moon ',x1Moon
      Do k=1,7
         write(6,'("x1Planet(",i1,") = ",3d25.16)') k,x1Planet(1,k), &
     &            x1Planet(2,k),x1Planet(3,k)
         write(6,'("SPLANET(",i1,") = ",3d25.16)') k,SPLANET(1,1,k), &
     &            SPLANET(2,1,k),SPLANET(3,1,k)
      Enddo
!
       write(6,8)' KdotB, dKdotB ', KdotB, dKdotB
       write(6,8)' del_t_Sun ',del_t_Sun
       write(6,8)' XSunt1J ',XSunt1J
       write(6,8)' dXSunt1J ',dXSunt1J
       write(6,8)' R1Sunt1 ',R1Sunt1
       write(6,8)' dR1Sunt1 ',dR1Sunt1
       write(6,8)' R2Sunt1 ',R2Sunt1
       write(6,8)' dR2Sunt1 ',dR2Sunt1
       write(6,8)' del_t_Moon ',del_t_Moon
       write(6,8)' XMoont1J ',XMoont1J
       write(6,8)' dXMoont1J ',dXMoont1J
       write(6,8)' R1Moont1 ',R1Moont1
       write(6,8)' dR1Moont1 ',dR1Moont1
       write(6,8)' R2Moont1 ',R2Moont1
       write(6,8)' dR2Moont1 ',dR2Moont1
       write(6,8)' Vmag_S ',  Vmag_S
       write(6,8)' N_hat  ',  N_hat
       write(6,8)' dN_hat ', dN_hat
!
      Do k=1,7
         write(6,'("del_t_Planet(",i1,") = ",d25.16)')k,del_t_Planet(k)
         write(6,'("XPlant1J(",i1,") = ",3d25.16)') k,XPlant1J(1,k), &
     &            XPlant1J(2,k),XPlant1J(3,k)
         write(6,'("dXPlant1J(",i1,") = ",3d25.16)') k,dXPlant1J(1,k), &
     &            dXPlant1J(2,k),dXPlant1J(3,k)
         write(6,'("R1Plant1(",i1,") = ",3d25.16)') k,R1Plant1(1,k), &
     &            R1Plant1(2,k),R1Plant1(3,k)
         write(6,'("dR1Plant1(",i1,") = ",3d25.16)') k,dR1Plant1(1,k), &
     &            dR1Plant1(2,k),dR1Plant1(3,k)
         write(6,'("R2Plant1(",i1,") = ",3d25.16)') k,R2Plant1(1,k), &
     &            R2Plant1(2,k),R2Plant1(3,k)
         write(6,'("dR2Plant1(",i1,") = ",3d25.16)') k,dR2Plant1(1,k), &
     &            dR2Plant1(2,k),dR2Plant1(3,k)
      Enddo
!
      Endif                               ! Debug
!
!******************************************************************************
!  Step 3: Use Equation 2 to estimate the differential gravitational delay for
!          the Sun, the Moon, and the Planets.
!
       C_Sun = (1.0D0 + gamma) * GMSUN/VLIGHT3
       vecmg1 = VECMG(R1Sunt1)
       term_a = vecmg1 + DOTP(unit_K,R1Sunt1)
       vecmg2 = VECMG(R2Sunt1)
       term_b = vecmg2 + DOTP(unit_K,R2Sunt1)
!    Derivatives:
       dterm_a = Dotp(R1Sunt1,dR1Sunt1)/vecmg1 + DOTP(unit_K,dR1Sunt1)
       dterm_b = Dotp(R2Sunt1,dR2Sunt1)/vecmg2 + DOTP(unit_K,dR2Sunt1)
!
       delta_t_grav_Sun = C_Sun * DLOG(term_a / term_b)
       d_delta_t_grav_Sun = C_Sun * ( dterm_a/term_a - &
     &                      dterm_b/term_b )                 !derivative
!
!  98NOV18 addition: Additional solar gravitional delay term, for observations
!   close to the Sun. IERS Conventions (1996), paged 91, equation 14.
       CSun1 = C_Sun**2 * VLIGHT
        Call VECAD (N_hat, unit_K, NplusK)
        V1 = DOTP(b_nought, NplusK)
       dV1 = DOTP(db_nought, NplusK) + DOTP(b_nought, dN_hat)
        V2 = term_a**2
       dV2 = 2.D0 * term_a * dterm_a
        Sunplus(1) = CSun1 * V1 / V2
        Sunplus(2) = CSun1*dV1/V2 - CSun1*V1*DV2/V2**2
!  Don't add these to the solar bending yet, or they will mess up the Gamma
!   partials.
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
       C_Moon = (1.0D0 + gamma) * GMMoon/VLIGHT3
       vecmg1 = VECMG(R1Moont1)
       term_c = vecmg1 + DOTP(unit_K,R1Moont1)
       vecmg2 = VECMG(R2Moont1)
       term_d = vecmg2 + DOTP(unit_K,R2Moont1)
!    Derivatives:
       dterm_c = Dotp(R1Moont1,dR1Moont1)/vecmg1 + &
     &           DOTP(unit_K,dR1Moont1)
       dterm_d = Dotp(R2Moont1,dR2Moont1)/vecmg2 + &
     &           DOTP(unit_K,dR2Moont1)
!
       delta_t_grav_Moon = C_Moon * DLOG(term_c / term_d)
       d_delta_t_grav_Moon = C_Moon* ( dterm_c/term_c - &
     &                      dterm_d/term_d )                   !derivative
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,8)' CONSEN:  '
!      write(6,8)'C: delta_t_grav_Sun, d_delta_t_grav_Sun,  ', &
!    &             delta_t_grav_Sun, d_delta_t_grav_Sun
!      write(6,8)'C: delta_t_grav_Moon, d_delta_t_grav_Moon,  ', &
!    &             delta_t_grav_Moon, d_delta_t_grav_Moon
!      write(6,8)' Sunplus  ', Sunplus
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,'(/,15x,"Step 3 dump:")')
       write(6,8)' C_Sun    ',C_Sun
       write(6,8)' term_a, dterm_a ',term_a, dterm_a
       write(6,8)' term_b, dterm_b ',term_b, dterm_b
       write(6,8)' delta_t_grav_Sun, d_delta_t_grav_Sun,  ', &
     &             delta_t_grav_Sun, d_delta_t_grav_Sun
       write(6,8)' C_Moon   ',C_Moon
       write(6,8)' term_c, dterm_c ',term_c, dterm_c
       write(6,8)' term_d, dterm_d ',term_d, dterm_d
       write(6,8)' delta_t_grav_Moon, d_delta_t_grav_Moon,  ', &
     &             delta_t_grav_Moon, d_delta_t_grav_Moon
       write(6,8)' CSun1    ', CSun1
       write(6,8)' NplusK   ', NplusK
       write(6,8)' V1, dV1  ', V1, dV1
       write(6,8)' V2, dV2  ', V2, dV2
       write(6,8)' Sunplus  ', Sunplus
      Endif                               ! Debug
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      Do k=1,7       ! Planet loop
!
       C_Plan(k) = (1.0D0 + gamma) * GMPlanet(k)/VLIGHT3
       vecmg1 = VECMG(R1Plant1(1,k))
       term_e = vecmg1 + DOTP(unit_K,R1Plant1(1,k))
       vecmg2 = VECMG(R2Plant1(1,k))
       term_f = vecmg2 + DOTP(unit_K,R2Plant1(1,k))
!    Derivatives:
       dterm_e = Dotp(R1Plant1(1,k),dR1Plant1(1,k))/vecmg1 + &
     &           Dotp(unit_K,dR1Plant1(1,k))
       dterm_f = Dotp(R2Plant1(1,k),dR2Plant1(1,k))/vecmg2 + &
     &           Dotp(unit_K,dR2Plant1(1,k))
!
       delta_t_grav_Plan(k) = C_Plan(k) * DLOG(term_e / term_f)
       d_delta_t_grav_Plan(k) = C_Plan(k) * ( dterm_e/term_e - &
     &                      dterm_f/term_f )                 !derivative
!
!      write(6,*)'C: k, delta_t_grav_Plan, d_delta_t_grav_Plan, ', &
!    &             k, delta_t_grav_Plan(k), d_delta_t_grav_Plan(k)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,13) k, C_Plan(k), vecmg1,term_e, dterm_e, vecmg2, &
!    &             term_f, dterm_f, delta_t_grav_Plan(k), &
!    &             d_delta_t_grav_Plan(k)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,13) k, C_Plan(k), vecmg1,term_e, dterm_e, vecmg2, &
     &             term_f, dterm_f, delta_t_grav_Plan(k), &
     &             d_delta_t_grav_Plan(k)
  13   format(" k,C_Plan: ",i5,d25.16,/," vecmg1,term_e,dterm_e: ", &
     &        3d25.16,/," vecmg2,term_f,dterm_f: ",3d25.16,/, &
     &        " delta_t_grav_Plan, d_delta_t_grav_Plan: ",2d25.16,/)
      Endif                               ! Debug
!
      Enddo           ! Planet loop
!
!******************************************************************************
!  Step 4: Use Equation 4 to find the differential delay due to the Earth.
!
       C_Earth = (1.0D0 + gamma) * GMEarth/VLIGHT3
!
       IF(Nzero .ne. 1) THEN
        vecmg1 = VECMG(x_sub1t1)
        term_g = vecmg1 + DOTP(unit_K,x_sub1t1)
        dterm_g = Dotp(x_sub1t1,w_sub1)/vecmg1 + DOTP(unit_K,w_sub1)
       ELSE
        vecmg1 =  0.0D0
        term_g =  2.0D0 * REARTH
        dterm_g = 0.0D0
       ENDIF
!
       IF(Nzero .ne. 2) THEN
        vecmg2 = VECMG(x_sub2t1)
        term_h = vecmg2 + DOTP(unit_K,x_sub2t1)
        dterm_h = Dotp(x_sub2t1,w_sub2)/vecmg2 + DOTP(unit_K,w_sub2)
       ELSE
        vecmg2 =  0.0D0
        term_h =  2.0D0 * REARTH
        dterm_h = 0.0D0
       ENDIF
!
       delta_t_grav_Earth = C_Earth * DLOG(term_g / term_h)
       d_delta_t_grav_Earth = C_Earth*( dterm_g/term_g - &
     &                        dterm_h/term_h )               !derivative
!
!      write(6,8)'C: delta_t_grav_Earth, d_delta_t_grav_Earth ',        &
!    &             delta_t_grav_Earth,d_delta_t_grav_Earth
!
!
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,'(/,15x,"Step 4 dump:")')
       write(6,8)' C_Earth  ',C_Earth
       write(6,8)' term_g, dterm_g  ', term_g, dterm_g
       write(6,8)' term_h, dterm_h  ', term_h, dterm_h
       write(6,8)' delta_t_grav_Earth, d_delta_t_grav_Earth ', &
     &             delta_t_grav_Earth,d_delta_t_grav_Earth
      Endif                               ! Debug
!
!******************************************************************************
!  Step 5: Add up all components from steps 3 and 4 to get the total
!          differential gravitational delay (equation 7).
!          [Does not include the term for observations close to the Sun.]
!
        delta_t_grav_Planets = 0.D0
        d_delta_t_grav_Planets = 0.D0
       do k=1,7
        delta_t_grav_Planets = delta_t_grav_Planets + &
     &                          delta_t_grav_Plan(k)
        d_delta_t_grav_Planets = d_delta_t_grav_Planets + &
     &                         d_delta_t_grav_Plan(k)
       enddo
!
       delta_t_grav = delta_t_grav_Sun + delta_t_grav_Moon &
     &              + delta_t_grav_Planets + delta_t_grav_Earth
!  derivative
       d_delta_t_grav = d_delta_t_grav_Sun + d_delta_t_grav_Moon &
     &              + d_delta_t_grav_Planets + d_delta_t_grav_Earth
!
!      write(6,8)' Consen: delta_t_grav, d_delta_t_grav ', &
!    &             delta_t_grav, d_delta_t_grav
!
!
!***  IF(KTHED .ne. 0) Then               ! Debug
!      write(6,'(/,15x,"Step 5 dump:")')
!      write(6,8)' delta_t_grav_Planets, d_delta_t_grav_Planets ', &
!    &             delta_t_grav_Planets, d_delta_t_grav_Planets
!      write(6,8)' delta_t_grav, d_delta_t_grav ', &
!    &             delta_t_grav, d_delta_t_grav
!***  Endif                               ! Debug
!
!******************************************************************************
!  Step 6: Add the total differential gravitational delay to the rest of the
!          a priori vacuum delay, Equation 9.
!
!  Find Sun's potential:
!
       U_Sun  = GMSUN/VLIGHT2
       vecmg1 = VECMG(R_Earth_Sun)
       U      = U_Sun/vecmg1
!   Derivative:
       dU = -U_Sun * Dotp(R_Earth_Sun,V_Earth_Sun) / vecmg1**3
!
!   Compute individual terms of Eqn. 9
!
!    Check to see if the user wants to use gravitational bending.
      If(KRELC .eq. 0) Then      ! Default, use bending
!       Also add in term for observations close to the Sun
       term1 = delta_t_grav + Sunplus(1)
       dterm1 = d_delta_t_grav + Sunplus(2)
      Else                       ! Don't use bending
       term1 = 0.D0
       dterm1 = 0.D0
      Endif
!
       term2a = KdotB/VLIGHT
       dterm2a = dKdotB/VLIGHT                  ! derivative
!
       term2b = 1.D0 - ((1.D0 + gamma) * U)
       dterm2b = -(1.D0 + gamma) * dU           ! derivative
!
       absVEarth = VECMG(VsubEarth)
       term2c = (absVEarth)**2 / (2.D0*VLIGHT2)
       dterm2c = Dotp(VsubEarth,AsubEarth) /  VLIGHT2        ! derivative
!
       term2d = DOTP(VsubEarth,w_sub2) / VLIGHT2
       dterm2d = (DOTP(AsubEarth,w_sub2) + DOTP(VsubEarth,a_sub2)) &
     &            / VLIGHT2                                  ! derivative
!
!  Combine terms 2b,2c,2d
       term2bcd = term2b - term2c - term2d
       dterm2bcd = dterm2b - dterm2c - dterm2d               ! derivative
!
       term2  = term2a * term2bcd
       dterm2  = term2a * dterm2bcd + dterm2a * term2bcd     ! derivative
!
       VdotB  = DOTP(VsubEarth,b_nought)
       dVdotB = DOTP(AsubEarth,b_nought) + DOTP(VsubEarth,db_nought) !derivative
!
       KdotV  = DOTP(unit_K,VsubEarth)
       dKdotV = DOTP(unit_K,AsubEarth)                       ! derivative
!
       term3a = VdotB/VLIGHT2
       term3b = 1.D0 + KdotV/(2.D0*VLIGHT)
       term3  = term3a * term3b
!
       dterm3a = dVdotB/VLIGHT2                              ! derivative
       dterm3b = dKdotV/(2.D0*VLIGHT)                        ! derivative
       dterm3  = dterm3a*term3b +  term3a*dterm3b            ! derivative
!
       call VECAD(VsubEarth,w_sub2,vec_sum)
       call VECAD(AsubEarth,a_sub2,dvec_sum)                 ! derivative
       term4  = 1.D0 + DOTP(unit_K,vec_sum)/VLIGHT
       dterm4  = DOTP(unit_K,dvec_sum)/VLIGHT                ! derivative
!
       term123  = term1  - term2  - term3
       dterm123 = dterm1 - dterm2 - dterm3                   ! derivative
!
       tv2_tv1 = term123 / term4
       dtv2_tv1 = dterm123 / term4  - &
     &            term123 * dterm4 / term4**2                ! derivative
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,8)'C: tv2_tv1, dtv2_tv1 ',tv2_tv1, dtv2_tv1
!  Delay without gravitational bending:
!      Write(6,*) 'Delay no Tgrav (ps): ', (tv2_tv1 - term1/term4)*1.D12
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,'(/,15x,"Step 6 dump:")')
       write(6,8)' U_Sun, U, dU ',U_Sun, U, dU
       write(6,8)' term1, dterm1  ',term1, dterm1
       write(6,8)' term2a, dterm2a  ',term2a, dterm2a
       write(6,8)' term2b, dterm2b  ',term2b, dterm2b
       write(6,8)' absVEarth',absVEarth
       write(6,8)' term2c, dterm2c  ',term2c, dterm2c
       write(6,8)' term2d, dterm2d  ',term2d, dterm2d
       write(6,8)' term2bcd, dterm2bcd  ',term2bcd, dterm2bcd
       write(6,8)' term2, dterm2  ',term2, dterm2
       write(6,8)' VdotB, dVdotB  ',VdotB, dVdotB
       write(6,8)' KdotV, dKdotV  ',KdotV, dKdotV
       write(6,8)' term3a, dterm3a  ',term3a, dterm3a
       write(6,8)' term3b, dterm3b  ',term3b, dterm3b
       write(6,8)' term3, dterm3  ',term3, dterm3
       write(6,8)' vec_sum, dvec_sum ',vec_sum, dvec_sum
       write(6,8)' term4, dterm4  ',term4, dterm4
       write(6,8)' term123, dterm123  ',term123, dterm123
       write(6,8)' tv2_tv1, dtv2_tv1 ',tv2_tv1, dtv2_tv1
      Endif                               ! Debug
!
!******************************************************************************
!  Step 7: Calculate the aberrated source vectors for use in the tropospheric
!          propogation delay calculation.
!
!      [Note: These calculations are in the atmosphere module, subroutine
!      ATMG, and do not need to be done here. The aberrated source vectors are
!      used in the atmosphere module to compute the topocentric azimuths and
!      elevations, and in the axis offset module (along with refraction) to
!      compute the vector axis offset.]
!
!     call vecad(VsubEarth,w_sub1,V_w1)
!     K_V_w1 = Dotp(unit_K,V_w1)
!
!     call vecad(VsubEarth,w_sub2,V_w2)
!     K_V_w2 = Dotp(unit_K,V_w2)
!
!     Do l=1,3
!       k_sub1(l) = unit_K(l) + (VsubEarth(l) + w_sub1(l)) / VLIGHT
!    .            - unit_K(l) * K_V_w1 /VLIGHT
!       k_sub2(l) = unit_K(l) + (VsubEarth(l) + w_sub2(l)) / VLIGHT
!    .            - unit_K(l) * K_V_w2 /VLIGHT
!     Enddo
!
!     IF(KTHED .ne. 0) Then               ! Debug
!      write(6,'(/,15x,"Step 7 dump:")')
!      write(6,8)' V_w1, K_V_w1  ',V_w1, K_V_w1
!      write(6,8)' V_w2, K_V_w2  ',V_w2, K_V_w2
!      write(6,8)' k_sub1, k_sub2  ',k_sub1, k_sub2
!     Endif                               ! Debug
!
!******************************************************************************
!  Step 8: Add the geometric part of the tropospheric propogation delay to the
!          vacuum delay.
!          [Geocenter station: DATMC(Nzero,1) and DATMC(Nzero,2) should
!          already be zero.]
!
      call vecsb(w_sub2,w_sub1,w2_w1)
      call vecsb(a_sub2,a_sub1,a2_a1)
      K_dotw2w1 = Dotp(unit_K,w2_w1)
      dK_dotw2w1 = Dotp(unit_K,a2_a1)           ! derivative
!
!  Apparent error in earlier versions of following code because station 1
!   atmosphere is negative. Error only at the .01 picosecond level though.
      tg2_tg1 = tv2_tv1 -  DATMC(1,1) * K_dotw2w1/VLIGHT
      dtg2_tg1 = dtv2_tv1 -  DATMC(1,2) * K_dotw2w1/VLIGHT &
     &                    -  DATMC(1,1) * dK_dotw2w1/VLIGHT       ! derivative
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,8)'          '
!      write(6,8)' DATMC  ', DATMC
!      write(6,8)'          '
!      write(6,8)'C: tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
!      write(6,8)'          '
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,'(/,15x,"Step 8 dump:")')
       write(6,8)' w2_w1, a2_a1   ',w2_w1, a2_a1
       write(6,8)' K_dotw2w1, dK_dotw2w1 ', K_dotw2w1, dK_dotw2w1
       write(6,8)' DATMC  ', DATMC
       write(6,8)' tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
       write(6,8)' tg2_tg1,dtg2_tg1+atm ', tg2_tg1+DATMC(1,1)+DATMC(2,1), &
     &              dtg2_tg1+DATMC(1,2)+DATMC(2,2)
      Endif                               ! Debug
!
!******************************************************************************
!  Step 9: Step 9 is to compute the total delay by adding in the "Best"
!          estimate of the troposphere propogation delay for each site.
!          Normally this will be done 'on the fly' in program SOLVE.
!          However, we add the Niell atmosphere term here if the atmosphere
!          flag, KATMC is 1. The default is not to add it.
!           [Geocenter station: DATMC(Nzero,1) and DATMC(Nzero,2) should
!            already be zero.]
!
      IF(KATMC.eq.1) then
         tg2_tg1  =  tg2_tg1 + DATMC(1,1) + DATMC(2,1)
         dtg2_tg1 = dtg2_tg1 + DATMC(1,2) + DATMC(2,2)
        write(6,8)'(KATMC=1:) tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
!
       IF(KTHED .ne. 0) Then               ! Debug
        write(6,'(/,15x,"Step 9 dump:")')
        write(6,8)'(KATMC=1:) tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
       Endif                               ! Debug
!
      Endif
!
!******************************************************************************
!  Step 10: Correct for axis offset:
!
!      [ These computations are made in the axis offset module. ]
!
!******************************************************************************
!  Step Gamma: Take the partial derivatives of the delay (tg2_tg1) and the
!              delay rate (dtg2_tg1) with respect to Gamma.
!              [Does not include the term for observing close to the Sun.]
!
      Con_part(1) = ( delta_t_grav/(1.d0+Gamma) + U*term2a ) / term4
      Con_part(2) = &
     &   ( ( d_delta_t_grav/(1.d0+Gamma) + U*dterm2a + term2a*dU ) &
     &     / term4 ) - &
     &      (dterm4/term4**2) * &
     &     ( delta_t_grav/(1.d0+Gamma) + U*term2a )
!
!  Take partial derivative of the gravitational bending part w.r.t. Gamma.
!    [Does not include the term for observing close to the Sun.]
      Bend_par(1) = ( delta_t_grav/(1.d0+Gamma) ) / term4
      Bend_par(2) = ( d_delta_t_grav/(1.d0+Gamma) ) / term4  - &
     &      (dterm4/term4**2) * ( delta_t_grav/(1.d0+Gamma) )
!
      IF(KTHED .ne. 0) Then               ! Debug
       write(6,'(/,15x,"Step Gamma dump:")')
       write(6,8)' Con_part   ', Con_part
       write(6,8)' Bend_par  ', Bend_par
      Endif                               ! Debug
!
!  Cleanup Step: Finish computation of components for PUT's into data base
!
!   Total light bending portion:
      CON_CNTRB(1) = (   delta_t_grav + Sunplus(1) ) / term4
      CON_CNTRB(2) = ( d_delta_t_grav + Sunplus(2) ) / term4 - &
     &        dterm4 * ( delta_t_grav + Sunplus(1) ) / term4**2
!      write(6,8)' delta_t_grav, d_delta_t_grav ',
!    .             delta_t_grav, d_delta_t_grav
!      write(6,8)' CON_CNTRB ', CON_CNTRB
!
!   Solar light bending portion:
      Sun_cntrb(1) = (   delta_t_grav_Sun + Sunplus(1) ) / term4
      Sun_cntrb(2) = ( d_delta_t_grav_Sun + Sunplus(2) ) / term4 - &
     &        dterm4 * ( delta_t_grav_Sun + Sunplus(1) ) / term4**2
!      write(6,8)' delta_t_grav_Sun, d_delta_t_grav_Sun ',
!    .             delta_t_grav_Sun, d_delta_t_grav_Sun
!      write(6,8)' SUN_CNTRB ', SUN_CNTRB
!
!   Close to the Sun additional light bending portion:
!      write(6,8)' Sunplus   ',Sunplus
      Sunplus(1) =  Sunplus(1)/term4
      Sunplus(2) =  Sunplus(2)/term4 - dterm4*Sunplus(1)/term4**2
!      write(6,8)' Sunplus   ',Sunplus
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!! Compute delays at East, West, North, and South offsets for 
!   computation of the 'EXACT' U,V coordinates.
!!!    write(6,'("tv2_tv1 (psec): ",F20.2)') tv2_tv1*1.D12
!      write(6,'("tg2_tg1 (psec): ",F20.2)') tg2_tg1*1.D12
      If (UVW .eq. 'exact ' .or. UVW .eq. 'noatmo')  Then
       Call DelayEWNS (tg2_tg1,unit_K, K_EWNS, b_nought, VsubEarth,     &
     &     DATMC, term1, term2bcd, term3a, vec_sum, w_sub1, w_sub2,     &
     &     Datmc_h_EWNS,Datmc_w_EWNS) 
      Endif
!
!--------------------------------------------------------------------------
!
    8 FORMAT(A,4D25.16/(7X,5D25.16))
!
      RETURN
      END
!***********************************************************************
!
      SUBROUTINE DelayEWNS (tg21, unit_K, K_EWNS, b_nought, VsubEarth,  &
     &     DATMC, term1, term2bcd, term3a, vec_sum, w_sub1, w_sub2,     &
     &     Datmc_h_EWNS,Datmc_w_EWNS )
      IMPLICIT NONE
!
!     SUBROUTINE DelayEWNS computes the delays at small (.0001 radian)
!      offsets in the East, West, North, and South directions. It then
!      computes the numerical derivative of the delay with respect to
!      the East and North directions. These give the 'NO ATMOS' and
!      'EXACT' computations of the (U,V) coordinates that are needed 
!      for wide field mapping.
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - The velocity of light cubed. (m/sec)**3
!            4. GAMMA   - The post Newtonian expansion parameter which
!                         affects light bending. (1.0 used here). (unitless)
!            5. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!            6. REARTH  - The equatorial radius of the Earth. (meters)
!
      INCLUDE 'put2s.i'
!          Variables 'from':
!            1. U_V(2) -
!            2. Wb     -
!
      INCLUDE 'd_input.i'
!       Variables from:
!        1. UVW - Flag defining how to compute (U,V,W) coordinates
!
      Real*8 unit_K(3), b_nought(3), K_EWNS(3,4), VsubEarth(3),         &
     &       w_sub1(3), w_sub2(3), DATMC(2,2), tg21
      Real*8 Datmc_h_EWNS(4), Datmc_w_EWNS(4)
      Real*8 DOTP 
      Real*8 term1, term2a, term2b, term2c, term2d, term2, &
     &       term2bcd, term3a, term3b, term3, term4, &
     &       term123, vec_sum(3), w2_w1(3), K_dotw2w1
      Real*8 tv2_tv1(4), tg2_tg1(4), U, V
      Real*8 delKew(3), delKns(3), dKew, dKns, VECMG
      Integer*4 I
!
!
      Do I = 1,4
!
       term2a = DOTP(K_EWNS(1,I),b_nought)/VLIGHT
       term2  = term2a * term2bcd 
!
       term3b = 1.D0 + (DOTP(K_EWNS(1,I),VsubEarth)/(2.D0*VLIGHT))
       term3  = term3a * term3b
!
       term4  = 1.D0 + (DOTP(K_EWNS(1,I),vec_sum)/VLIGHT)
!
       term123  = term1  - term2  - term3
!
! Vacuum delays
       tv2_tv1(I) = term123 / term4
!      write(6,'("I,tv2_tv1(psec):",I2,F18.2)') I, tv2_tv1(I)*1.D12
!
! Add the geometric part of the tropospheric propogation delay.
      call vecsb(w_sub2,w_sub1,w2_w1)
      K_dotw2w1 = Dotp(unit_K,w2_w1)
      tg2_tg1(I) = tv2_tv1(I) - DATMC(1,1) * K_dotw2w1/VLIGHT
! Add the best estimate of the atmosphere delay (needs to be computed
!       for each offset).
!     tg2_tg1(I) = tg2_tg1(I) + DATMC(1,1) + DATMC(2,1)
       If (UVW .eq. 'exact ')  Then
        tg2_tg1(I) = tg2_tg1(I) + Datmc_h_EWNS(I) + Datmc_w_EWNS(I) 
!       write(6,'("I,tg2_tg1(psec):",I2,F18.2)') I, tg2_tg1(I)*1.D12
       Endif
      Enddo
!
      Do I = 1,3
        delKew(I) = K_EWNS(I,1) - K_EWNS(I,2) 
        delKns(I) = K_EWNS(I,3) - K_EWNS(I,4) 
      Enddo
! Find difference vectors:
       dKew = VECMG(delKew)
       dKns = VECMG(delKns)
!       write(6,*) 'DelayEWNS: dKew, dKns ', dKew, dKns
!
!    Do I = 1,3
!       delKe(I) = unit_K(I) - K_EWNS(I,1)  
!       delKw(I) = unit_K(I) - K_EWNS(I,2)   
!       delKn(I) = unit_K(I) - K_EWNS(I,3) 
!       delKs(I) = unit_K(I) - K_EWNS(I,4)              
!     Enddo
! Find difference vectors:
!      dKew = VECMG(delKe) + VECMG(delKw)
!      dKns = VECMG(delKn) + VECMG(delKs)
!
!     U = VLIGHT*(tg2_tg1(1) - tg2_tg1(2))/dKew
!     V = VLIGHT*(tg2_tg1(3) - tg2_tg1(4))/dKns
      U = VLIGHT*(tg2_tg1(1) - tg2_tg1(2))/0.0002D0
      V = VLIGHT*(tg2_tg1(3) - tg2_tg1(4))/0.0002D0
!      write(6,*) 'DelayEWNS: U (m, sec) ', U,  U/VLIGHT
!      write(6,*) 'DelayEWNS: V (m, sec) ', V,  V/VLIGHT
! TEST !!!!!
!     U = VLIGHT*(tg2_tg1(1) - tg21) / .0001D0
!      write(6,*) ' U1 (m) ', U
!     U = VLIGHT*(tg2_tg1(2) - tg21) / .0001D0
!      write(6,*) ' U2 (m) ', U
!     V = VLIGHT*(tg2_tg1(3) - tg21) / .0001D0
!      write(6,*) ' V3 (m) ', V
!     V = VLIGHT*(tg2_tg1(4) - tg21) / .0001D0
!      write(6,*) ' V4 (m) ', V
!
      U_V(1) = U
      U_V(2) = V
!     Wb     = (tg21 + DATMC(1,1) + DATMC(2,1)) * VLIGHT
!
      Return
      End

      SUBROUTINE NFTHERY ( DATMC, DIONC, DLPGR, EARTH, EPBASE, SITEP,   &
     &           SITEV, SITEA, SUN, STAR, STARdt, XMOON, AT, T0_T1,     &
     &           R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag, R2magdt,    &
     &           STAR12, STAR12dt )
      Implicit none
!
!     Routine THERY computes the theoretical values of delay and delay rate
!     using the information generated by the modules. Subroutine CONSEN is
!     called to perform the computations using the Eubanks "Consensus"
!     relativity model. The Shapiro and Hellings relativity model computations
!     have been removed with Calc 9.0 and are no longer used here.
!
!     References: None
!
!     Program Interface
!       Input variables:
!         1. DATMC(2,2)  - The contributions to the delay and delay rate due to
!                          tropospheric refraction at each site. (sec, sec/sec)
!**       2. DAXOC(2,2)  - The contributions to the delay and rate due to the
!**                        antenna axis offsets. First index runs over sites,
!**                        the second runs over delay and rate (sec,sec/sec).
!         3. DIONC(2)    - The contributions to the delay and rate due to
!                          ionospheric refraction at each site. (sec, sec/sec)
!         4. DLPGR       - The CT time derivative of the long period terms in
!                          'AT MINUS CT' offset. (sec/sec) (Not used)
!         5. EARTH(3,3)  - The solar system barycentric Earth position
!                          velocity, and acceleration vectors. The first index
!                          runs over the vector components and the second runs
!                          over the time derivatives. (m, m/sec, m/sec**2)
!         6. EPBASE(3,2) - The J2000.0 baseline position and velocity vectors.
!                          (m, m/sec)
!         7. SITEA(3,2)  - The J2000.0 geocentric acceleration vectors of each
!                          observing site. (m/sec**2)
!         8. SITEP(3,2)  - The J2000.0 geocentric position vectors of each
!                          observing site. (m)
!         9. SITEV(3,2)  - The J2000.0 geocentric velocity vectors of each
!                          observing site. (m/sec)
!        10. SUN(3,2)    - The J2000.0 geocentric Sun position and velocity
!                          vectors. (m, m/sec)
!        11. XMOON(3,2)  - The J2000.0 geocentric Moon position and velocity
!                          vectors. (m, m/sec)
!        12. STAR(3)     - The J2000.0 source unit vector. (unitless)
!        13. AT          - The Atomic Time fraction of the Atomic Time Day
!                          (TAI). (days) (Not used)
!
!     Common blocks used -
!
      INCLUDE 'ccon.i'
!       Variables 'from':
!         1.  KTHEC - The Theory routine flow control flag.
!                     (No longer has any function.)
!         2.  KTHED - The theory routine debug control flag.
!         3.  KRELC - The relativity module flow control flag.
!                       0     --> Gravitational bending used.
!                       NOT 0 --> Gravitational bending not used.
!
      INCLUDE 'put2s.i'
!       Variables from:
!         2. DAXOC(2,2)  - The contributions to the delay and rate due to the
!                          antenna axis offsets. First index runs over sites,
!                          the second runs over delay and rate (sec,sec/sec).
!       Variables to:
!          1. CONDEL(2)    - The theoretical delay from the Consensus
!                            model in two pieces in units of MICROSECONDS.
!                            The 1st is the integer microseconds and the
!                            2nd is the submicroseconds portion.
!          2. CONRAT       - The theoretical delay rate from the Consensus
!                            model/ (sec/sec).
!          3. SUN_CNTRB(2) - The solar gravitational bending delay and rate
!                            terms from the Consensus model. (sec, sec/sec)
!          4. CON_CNTRB(2) - The total gravitational bending delay and rate
!                            terms from the Consensus model. (sec, sec/sec)
!          5. CON_PART(2)  - The total Consensus delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!          6. Sunplus(2)   - Higher order solar bending delay and rate
!                            contributions, as defined in IERS Conventions
!                            (1996), page 91, eqn. 14. (sec, sec/sec) It
!                            has also been added to the total solar bending
!                            delay and rate contibutions.
!          7. Bend_par(2)  - The relativistic bending delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!
!   Program specifications -
      INTEGER*4 I
      REAL*8 DATMC(2,2), DIONC(2), SUN(3,2), EARTH(3,3),                &
     &       EPBASE(3,2), SITEA(3,2), STAR(3), SITEP(3,2), SITEV(3,2),  &
     &       XMOON(3,2), AT, SUNHAT(3), DLPGR, STARdt(3), STAR12(3,2),  &
     &       STAR12dt(3,2)
      Real*8 delta_t_grav, d_delta_t_grav, &
     &       tg2_tg1, dtg2_tg1, xtg2_tg1,                               &
     &       delta_t_grav_Sun, d_delta_t_grav_Sun, CONSENSUS(2),        &
     &       con_cont(2) 
      Real*8 R1(3), R2(3), R1dt(3), R2dt(3), R1mag, R2mag, R1magdt,     &
     &       R2magdt, T0_T1
      Real*8 tr2_tr1, dtr2_tr1 
!
! 4.2.4 DATA BASE ACCESS -
!
!**      'PUT' VARIABLES:
!**        1. CONDEL(2)    - The theoretical delay from the Consensus
!**                          model in two pieces in units of MICROSECONDS.
!**                          The 1st is the integer microseconds and the
!**                          2nd is the submicroseconds portion.
!**        2. CONRAT       - The theoretical delay rate from the Consensus
!**                          model/ (sec/sec).
!**        3. SUN_CNTRB(2) - The solar gravitational bending delay and rate
!**                          terms from the Consensus model. (sec, sec/sec)
!**        4. CON_CNTRB(2) - The total gravitational bending delay and rate
!**                          terms from the Consensus model. (sec, sec/sec)
!**        5. CON_PART(2)  - The total Consensus delay and rate partials
!**                          with respect to Gamma. (sec, sec/sec)
!**        6. Sunplus(2)   - Higher order solar bending delay and rate
!**                          contributions, as defined in IERS Conventions
!**                          (1996), page 91, eqn. 14. (sec, sec/sec) It
!**                          has also been added to the total solar bending
!**                          delay and rate contibutions.
!**        7. Bend_par(2)  - The relativistic bending delay and rate partials
!**                          with respect to Gamma. (sec, sec/sec)
!
!        ACCESS CODES:
!          1. 'CONSNDEL' - The database access code for the theoretical
!                          delay using the Eubanks' Consensus model.
!          2. 'CONSNRAT' - The database access code for the theoretical
!                          delay rate using the Eubanks' Consensus model.
!          3. 'SUN CONT' - The database access code for the Consensus model
!                          Solar gravitational bending delay and rate terms.
!          4. 'CON CONT' - The database access code for the Consensus model
!                          TOTAL gravitational bending delay and rate terms.
!          5. 'CONSPART' - Database access code for the partial derivatives
!                          of the Consensus model delays and rates with
!                          respect to Gamma.
!          6. 'SUN2CONT' - Database access code for the additional solar
!                          bending due to higher order relativistic effects.
!                          This term is already in the theoretical, so to
!                          remove it, SUBTRACT the values in this access code.
!          7. 'BENDPART' - Database access code for the partial derivatives
!                          of the Consensus model gravitational bending
!                          delay and rate contributions with respect to Gamma.
!
!    Subroutine interface -
!          Caller subroutine:  DRIVR
!          Called subroutines:  PUT4, CONSEN
!
!    Program variables -
!           1. tg2_tg1      - The geometric delay corrected for relativistic
!                             effects using the Consensus model.
!           2. dtg2_tg1     - The time derivative of the geometric delay
!                             corrected for relativistic effects using the
!                             Consensus model.
!           3. delta_t_grav - The total differential gravitational time delay,
!                             or "bending delay" from the Consensus model.
!           4. d_delta_t_grav-The time derivative of the total differential
!                             gravitational time delay, or "bending delay,"
!                             from the Consensus model.
!**         5. SUN_CNTRB(2) - The solar gravitational bending delay and rate
!**                           contributions from the Consensus model. (s, s/s).
!**         6. CON_CNTRB(2) - The total gravitational bending delay and rate
!**                           contributions from the Consensus model. (s, s/s).
!           7. CON_PART(2)  - The partial derivatives of the Consensus model
!                             delay and rate with respect to Gamma (s and s/s).
!**         8. Sunplus(2)  -  Higher order solar bending delay and rate
!**                           contributions, as defined in IERS Conventions
!**                           (1996), page 91, eqn. 14 (sec, sec/sec). It
!**                           has also been added to the total solar bending
!**                           delay and rate contibutions.
!**         9. Bend_par(2)  - The relativistic bending delay and rate partials
!**                           with respect to Gamma. (sec, sec/sec)
!
! 4.2.9 PROGRAMMER - DALE MARKHAM 01/17/77
!                  PETER DENATALE 07/20/77
!                  CHOPO MA / DAVID GORDON 04/12/84
!                  DAVID GORDON 06/19/84 REMOVED ATMOSPHERE.
!                  DAVID GORDON 07/31/84 RELATIVISTIC CORRECTIONS.
!                  DAVID GORDON 01/03/85 ADDED ATMOSPHERE AFTER MODS TO
!                               ATMOSPHERE FLAGS.
!                  SAVITA GOEL  06/03/87 CDS FOR A900.
!                  GREGG COOKE  05/01/89 NEW MODEL FROM I.SHAPIRO.
!                  JIM RYAN     06/06/89 Some bugs fixed and documentation
!                               modified.
!                  Jim Ryan     09/13/89 Robertson code removed and Hellings
!                               added.
!                  Jim Ryan     89.10.05 CPHYS common made an include file
!                  Jim Ryan     89.10.09 Relativity partials and contributions
!                               moved here.
!                  Jim Ryan     89.11.20 Shapiro algorithm modified to make
!                               it reflect Ryan's memo
!                  Jim Ryan     89.12.12 UNIX-like database interface
!                               implemented.
!                  Jim Ryan     89.12.14 Addional delay information stored
!                               and Helling rate implemented.
!                  C Ma         90.08.10 Corrections to documentation.
!                  Jim Ryan     90.11.20 Debug statement fixed and comments
!                               cleaned up.
!                  T. Marshall Eubanks & Brent Archinal 91.05.10 HELL EMS
!                               fixed, debug statements and comments modified.
!                               A900 and HP-UX versions consolidated except for
!                               dbh calls and ILUOUT.
!                  Jim Ryan     91.05.28 A few, mostly cosmetic changes made.
!                  David Gordon 93.04.27 GMEARTH put into cphys.i and
!                               defined in cinit.f; definition removed here.
!                  David Gordon 93.08.02 Thery modified to call subroutine
!                               Consen (previously called by DRIVR), and to
!                               do the puts for the Consensus delay and rate.
!                  David Gordon 93.12.22 Fixed up debug output.
!                  David Gordon 93.12.27 Added access code CONSCONT, correction
!                               to convert Hellings to Comsensus theoreticals.
!                  David Gordon 94.01.21 Added access code SHAPCONT, correction
!                               to convert Hellings to Shapiro theoreticals.
!                  David Gordon 94 Feb/March - Modified axis offset correction
!                               for use here.
!                  David Gordon 94.10.05 Corrected error in computing second
!                               half of Lcode for Shapiro delay contribution.
!                               Many unused variables removed.
!                  David Gordon 95.10.11 Minor correction to Hellings model
!                               when gravitational bending turned OFF (KRELC=1).
!                  David Gordon 96.01.30 Added Consensus model solar bending
!                               term (Sun_cntrb(2) and the L-code 'SUN CONT').
!                               Removed 'CON PART' L-code (Solar bending
!                               partials w.r.t. Gamma) and replaced it with
!                               'CONSPART' (Total Consensus delay and rate
!                               partials w.r.t. Gamma).
!                  David Gordon 98.08.18 Shapiro and Hellings models removed.
!                  David Gordon 98.11.16 Added Sunplus to CALL CONSEN argument
!                               list. Contains the delay and rate contributions
!                               due to higher order solar bending, as defined
!                               in the 1996 IERS Conventions, p. 91, eqn. 14.
!                               Added PUTR of 'SUN2CONT' to put it in the
!                               data bases. It is already included in the
!                               theoretical, therefore to remove its effects,
!                               you must SUBTRACT it from the theoretical.
!                  David Gordon 98.12.16 Added Bend_par(2), the partials of the
!                               gravitional bending contributions with respect
!                               to Gamma.
!                  Jim Ryan     Sept 2002 Integer*2/4 mods.
!                  David Gordon Jan. 2013  Moved PUT's into subroutine PUT_TH.
!
!     THERY program structure
!--------------------------------------------------------------------------
!
!       write(6,*) 'NFTHERY/R1mag,R1magdt ',  R1mag,R1magdt
!       write(6,*) 'NFTHERY/R2mag,R2magdt ',  R2mag,R2magdt
!
!   Call subroutine Sekido to compute the delay and delay rate based on the
!   Eubanks' Consensus relativity model. We put it in its own subroutine
!   because it is a very long and detailed set of computations. 93JUL29, DG
!
      Call  SEKIDO ( DATMC, EARTH, EPBASE, SITEP, SITEV, SITEA, SUN,    &
     &      XMOON, STAR, STARdt, T0_T1, R1, R1dt, R1mag, R1magdt,       &
     &      R2, R2dt, R2mag, R2magdt, STAR12, STAR12dt,                 &
     &      tg2_tg1, dtg2_tg1 ) 
!
!      print *,' Delay,Rate: ', tg2_tg1*1.D12, dtg2_tg1*1.D12
!   Add the axis offset corrections
!     TG2_TG1  = tg2_tg1  + DAXOC(1,1) + DAXOC(2,1)
!     dtg2_tg1 = dtg2_tg1 + DAXOC(1,2) + DAXOC(2,2)
!      print *,' Delay,Rate: ', tg2_tg1*1.D12, dtg2_tg1*1.D12
!     print *,' NFTHERY '
!      print *,'Delay(ps),Rate(ps/sec): ', tg2_tg1*1.D12,dtg2_tg1*1.D12
!      print *,'Delay,Rate(AXOF added): ', tg2_tg1,dtg2_tg1
!        tg2_tg1  =  tg2_tg1 + DATMC(1,1) + DATMC(2,1)
!        dtg2_tg1 = dtg2_tg1 + DATMC(1,2) + DATMC(2,2)
!      print *,'Delay,Rate(AXOF,ATMC added): ', tg2_tg1,dtg2_tg1
!      print *,'DATMC (sec): ', DATMC
!      print *, '          '
!
      CONSENSUS(1) =  tg2_tg1      ! Sekido    delay
      CONSENSUS(2) = dtg2_tg1      ! Sekido    rate
!
!      print *,' THERY/Delay (psec): ', CONSENSUS(1)*1.D12
!      print *,' THERY/Rate (psec/sec): ', CONSENSUS(2)*1.D12
!
!   Convert the theoretical delay to microseconds and split the double
!   precision results into an integer microseconds portion and a
!   submicroseconds portion.
!     xtg2_tg1  = tg2_tg1  * 1.D6
!     CONDEL(1) = IDINT(xtg2_tg1 )
!     CONDEL(2) = xtg2_tg1 - CONDEL(1)
!     CONRAT = dtg2_tg1
!
!!!!!!!!!!!! Debug !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,8)' CONDEL, CONRAT ', CONDEL, CONRAT
!      write(6,8)' CONSENSUS ',CONSENSUS
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     Call  RANGE  ( DATMC, SITEP, SITEV, SITEA, SUN,    &
!    &      T0_T1, R1, R1dt, R1mag, R1magdt,       &
!    &      R2, R2dt, R2mag, R2magdt,                  &
!    &      tr2_tr1, dtr2_tr1  )
!
!!!!!!!!!!!! Debug !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!--------------------------------------------------------------------------
!     Check KTHED to determine if debug output is neccessary.
      IF ( KTHED .ne. 0 )  Then
       WRITE (6, 9100 )
 9100  FORMAT (1X, "Debug output for subroutine THERY." )
    8  FORMAT(A,4D25.16/(7X,5D25.16))
       write(6,8)' tg2_tg1, dtg2_tg1 ',tg2_tg1, dtg2_tg1
       write(6,8)' CONDEL, CONRAT ', CONDEL, CONRAT
       write(6,8)' CON_CNTRB ',CON_CNTRB
       write(6,8)' SUN_CNTRB ',SUN_CNTRB
       write(6,8)' CON_PART  ',CON_PART
       write(6,8)' CONSENSUS ',CONSENSUS
       write(6,8)' Sunplus   ',Sunplus
      Endif
!
      Return
      END
!**********************************************************************
      SUBROUTINE SEKIDO ( DATMC, EARTH, EPBASE, SITEP, SITEV,           &
     &           SITEA, SUN, XMOON, STAR, STARdt, T0_T1, R1, R1dt,      &
     &           R1mag, R1magdt, R2, R2dt, R2mag, R2magdt, STAR12,      &
     &           STAR12dt, tg2_tg1, dtg2_tg1 )
      IMPLICIT NONE
!
!     Routine SEKIDO computes the theoretical values of delay and delay 
!     rate  using the Sekido and Fukushima near-field model.
!
!       Reference: M. Sekido and T. Fukushima, 'A VLBI delay model for
!                  radio sources at a finite distance', J. Geodesy, 
!                  vol. 80, pp. 137-149, 2006.
!
!      Input Variables:
!         1.  DATMC(2,2)   -  The contributions to the delay and delay rate due
!                             to tropospheric refraction at each site. (s, s/s)
!         2.  EARTH(3,3)   -  The solar system barycentric Earth position,
!                             velocity, and acceleration vectors. The first
!                             index runs over the vector components and the
!                             second runs over the time derivatives.
!                             (m, m/sec, m/sec**2)
!         3.  EPBASE(3,2)  -  The J2000.0 baseline position and velocity
!                             vectors.  (m, m/sec)
!         4.  SITEP(3,2)   -  The J2000.0 geocentric position vectors of each
!                             observing site. (m)
!         5.  SITEV(3,2)   -  The J2000.0 geocentric velocity vectors of each
!                             observing site. (m/sec)
!         6.  SITEA(3,2)   -  The J2000.0 geocentric acceleration vectors of
!                             each observing site. (m/sec**2)
!         7.  SUN(3,2)     -  The J2000.0 geocentric Sun position and velocity
!                             vectors.  (m, m/sec)
!         8.  XMOON(3,2)   -  The J2000.0 geocentric Moon position and velocity
!                             vectors.  (m, m/sec)
!         9.  STAR(3)      -  The J2000.0 source unit vector. (unitless)
!
!      Output Variables:
!         1. tg2_tg1       -  The geometric delay corrected for relativistic
!                             effects (but not atmospheric refraction) using
!                             the Consensus model.
!         2. dtg2_tg1      -  The time derivative of the geometric delay
!                             corrected for relativistic effects using the
!                             Consensus model.
!         3. delta_t_grav  -  The total differential gravitational time delay,
!                             or "bending delay" from the Consensus model.
!         4. d_delta_t_grav-  The time derivative of the total differential
!                             gravitational time delay, or "bending delay" from
!                             the Consensus model.
!         5. delta_t_grav_Sun-The Sun's contribution to the "bending delay"
!                             from the Consensus model. Now includes
!                             Sunplus(1).
!         6. d_delta_t_grav_Sun-The time derivative of the Sun's contribution
!                             to the "bending delay" from the Consensus model.
!                             Now includes Sunplus(2).
!         7. Con_part      -  Partial derivatives of the Consensus delays and
!                             rates with respect to Gamma.
!         8. Sunplus(2)    -  Higher order solar bending delay and rate
!                             contributions, as defined in IERS Conventions
!                             (1996), page 91, eqn. 14. (sec, sec/sec) It
!                             has also been added to the total solar bending
!                             delay and rate contibutions.
!         9. Bend_par(2)   -  The relativistic bending delay and rate partials
!                             with respect to Gamma. (sec, sec/sec)
!
!     Common blocks used -
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - The velocity of light cubed. (m/sec)**3
!            4. GAMMA   - The post Newtonian expansion parameter which
!                         affects light bending. (1.0 used here). (unitless)
!            5. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!            6. REARTH  - The equatorial radius of the Earth. (meters)
!
      INCLUDE 'csolsys11.i'
!       Variables 'from':
!         1. SPLANET(3,2,7) - The J2000.0 Solar System Barycentric positions
!                             and velocities of all planets except the Earth
!                             and Pluto. (meters, meters/sec) The first index
!                             runs over X,Y, and Z, the second runs over
!                             position and velocity, and the third runs over
!                             the planets, where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                             of all planets except the Earth and Pluto.
!                             (meters, meters/sec) The first index runs over
!                             X,Y, and Z, the second runs over position and
!                             velocity, and the third runs over the planets,
!                             where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
       INCLUDE 'ccon.i'
!            Variables 'from':
!              1.  KTHEC  -  The Theory routine flow control flag.
!                            (No longer has any function.)
!              2.  KTHED  -  The theory routine debug control flag.
!              3.  KRELC  -  The relativity module flow control flag.
!                            0     --> Gravitational bending used.
!                            NOT 0 --> Gravitational bending not used.
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          5. CON_PART(2)  - The total Consensus delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!          6. Sunplus(2)   - Higher order solar bending delay and rate
!                            contributions, as defined in IERS Conventions
!                            (1996), page 91, eqn. 14. (sec, sec/sec) It
!                            has also been added to the total solar bending
!                            delay and rate contibutions.
!          7. Bend_par(2)  - The relativistic bending delay and rate partials
!                            with respect to Gamma. (sec, sec/sec)
!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) -  
!          2. SPpvyz(3) -  
!
!
!   Program Specifications -
      REAL*8 DATMC(2,2), SUN(3,2), EARTH(3,3), EPBASE(3,2), SITEA(3,2), &
     &       STAR(3), STARdt(3), SITEP(3,2), SITEV(3,2), XMOON(3,2),    &
     &       STAR12(3,2), STAR12dt(3,2), DOTP, VECMG
      Real*8 R1(3), R2(3), R1dt(3), R2dt(3), R1mag, R2mag, R1magdt,     &
     &       R2magdt, T0_T1
      Real*8 XsubEarth(3), VsubEarth(3), AsubEarth(3)
      Real*8 x_sub1t1(3), x_sub2t1(3), w_sub1(3), w_sub2(3)
      Real*8 a_sub1(3), a_sub2(3)
      Real*8 unit_K(3), b_nought(3),db_nought(3), unitK1(3)
      Real*8 x_subSun(3), x_subMoon(3), v_subSun(3), v_subMoon(3)
      Real*8 XsubSun(3), XsubMoon(3), VsubSun(3), VsubMoon(3)
      Real*8 R_Earth_Sun(3), R_Earth_Moon(3)
      Real*8 V_Earth_Sun(3), V_Earth_Moon(3)
      Real*8 Xsub1(3), Xsub2(3), t_sub1, t_sub2
      Real*8 dXsub1(3), dXsub2(3)
      Real*8 x1Sun(3), x1Moon(3), x1Planet(3,7)
      Real*8 del_t_Sun, del_t_Moon, del_t_Planet(7)
      Real*8 XSunt1J(3), XMoont1J(3), XPlant1J(3,7)
      Real*8 dXSunt1J(3), dXMoont1J(3), dXPlant1J(3,7)
      Real*8 R1Sunt1(3), R1Moont1(3), R1Plant1(3,7)
      Real*8 R2Sunt1(3), R2Moont1(3), R2Plant1(3,7)
      Real*8 dR1Sunt1(3), dR1Moont1(3), dR1Plant1(3,7)
      Real*8 dR2Sunt1(3), dR2Moont1(3), dR2Plant1(3,7)
      Real*8 delta_t_grav, delta_t_grav_Sun, delta_t_grav_Moon,         &
     &       delta_t_grav_Earth, delta_t_grav_Plan(7),                  &
     &       delta_t_grav_Planets
      Real*8 d_delta_t_grav, d_delta_t_grav_Sun, d_delta_t_grav_Moon,   &
     &       d_delta_t_grav_Earth, d_delta_t_grav_Plan(7),              &
     &       d_delta_t_grav_Planets
      Real*8 delgrav_Sun,ddelgrav_Sun, delgrav_Moon, ddelgrav_Moon,     &
     &       delgrav_Plan(7), ddelgrav_Plan(7), delgrav, ddelgrav,      &
             delgrav_Earth, ddelgrav_Earth
      Real*8 U, U_Sun, dU, absVEarth
      Real*8 C_Earth, C_Sun, C_Moon, C_Plan(7)
      Real*8 term_a, term_b, term_c, term_d, term_e, term_f,            &
     &       term_g, term_h, term_a1, term_b1, term_g1, term_h1
      Real*8 dterm_a, dterm_b, dterm_c, dterm_d, dterm_e, dterm_f,      &
     &       dterm_g, dterm_h, dterm_a1, dterm_b1, dterm_g1, dterm_h1
      Real*8 term1, term2a, term2b, term2c, term2d, term2,              &
     &       term2bcd, term3a, term3b, term3, term4,                    &
     &       term123, vec_sum(3), tv2_tv1
      Real*8 dterm1, dterm2a, dterm2b, dterm2c, dterm2d, dterm2,        &
     &       dterm2bcd, dterm3a, dterm3b,  dterm3, dterm4,              &
     &       dterm123, dvec_sum(3), dtv2_tv1
      Real*8 V_w1(3), V_w2(3), K_V_w1, K_V_w2           !!
!**   Real*8 tg2_tg1, dtg2_tg1, Con_part(2), Bend_par(2)
      Real*8 tg2_tg1, dtg2_tg1
      Real*8 w2_w1(3), a2_a1(3), K_dotw2w1, dK_dotw2w1
!     Real*8 k_sub1(3), k_sub2(3)
      Real*8 KdotB, dKdotB, VdotB, dVdotB, KdotV, dKdotV
      Real*8 delta_t2_t1, d_delta_t2_t1, term10a, term10b, term10c,     &
     &       dterm10a, dterm10b, dterm10c, del_del_t(2,2)
      Real*8 x_delta_t2_t1, dx_delta_t2_t1
      Real*8 vecmg1, vecmg2, vecmg0, dvecmg0
      Real*8 N_hat(3), dN_hat(3), Vmag_S, CSun1, NplusK(3), V1, dV1
!!   &       V2, dV2
      Real*8 R0sun(3), dR0sun(3), R1J, R2J, R10, R20, R0J,              &
     &       delTpNsun, R0moon(3), dR0moon(3), delTpNmoon, R0plan(3,7), &
     &       dR0plan(3,7), delTpNPlan(7), delTpN, Vec3c(3),             &
     &       term3c, term4a, H, H1(3), H2, H3, dH1a(3), dH1b(3),dH1(3), &
     &       dH2, dH3, dH, V2(3), dV2(3), dVec3c(3), dterm3c, dterm4a
      Real*8 dR1J, dR2J, dR10, dR20, dR0J, GMp, DelTpNPl, DelTpNPldt,   &
     &       delTpNsundt, DelTpNmoondt, DelTpNPlandt(7), delTpNdt
      Real*8 VsubEart0(3), AsubEart0(3)
      INTEGER*4 I, L, K
!
!     Subroutines used:  DOTP, IDINT, VECAD, VECMG
!
!     Constants used - VLIGHT      - Speed of light (m/s)
!                      VLIGHT2     - Speed of light squared
!                      VLIGHT3     - Speed of light cubed
!                      GMMOON      - GM of the Moon.
!                      GMEARTH     - GM of the Earth.
!                      GMSUN       - GM of the Sun.
!                      GMPlanet(7) - GM's of all planets except Earth and Pluto
!
!   Program variables -
!
!    1.  XsubEarth(3)  =  Barycentric radius vector of the geocenter (meters).
!    2.  VsubEarth(3)  =  Barycentric velocity vector of the geocenter (m/sec).
!    3.  AsubEarth(3)  =  Barycentric acceleration of the geocenter (m/sec**2).
!
!    4.  x_sub1t1(3)   =  Geocentric radius vector of receivers 1 and 2 at the
!    5.  x_sub2t1(3)        geocentric time t_sub1 (meters).
!
!    6.  w_sub1(3)     =  Geocentric velocity of receiver 1 (m/sec).
!    7.  w_sub2(3)     =  Geocentric velocity of receiver 2 (m/sec).
!
!    8.  a_sub1(3)     =  Geocentric acceleration of receiver 1 (m/sec).
!    9.  a_sub2(3)     =  Geocentric acceleration of receiver 2 (m/sec).
!
!   10.  x_subSun(3)   =  Geocentric radius vector of the Sun (meters).
!   11.  x_subMoon(3)  =  Geocentric radius vector of the Moon (meters).
!   12.  GPLANET(l,1,k)=  Geocentric radius vectors of the planets (meters).
!                          (l = X,Y,Z; k = planet #)
!
!   13.  v_subSun(3)   =  Geocentric velocity vector of the Sun (m/sec).
!   14.  v_subMoon(3)  =  Geocentric velocity vector of the Moon (m/sec).
!   15.  GPLANET(l,2,k)=  Geocentric velocity vector of the planets (m/sec).
!                          (l = X,Y,Z; k = planet #)
!
!   16.  Xsub1(3)      =  Barycentric radius vector of receiver 1 (meters).
!   17.  Xsub2(3)      =  Barycentric radius vector of receiver 2 (meters).
!   18.  dXsub1(3)     =  Barycentric velocity vector of receiver 1 (m/sec).
!   19.  dXsub2(3)     =  Barycentric velocity vector of receiver 2 (m/sec).
!
!   20.  x1Sun(3)      =  Vector from receiver 1 to the Sun at time t_sub1
!   21.  x1Moon(3)     =  Vector from receiver 1 to the Moon at time t_sub1
!   22.  x1Planet(3,7) =  Vector from receiver 1 to the planets at time t_sub1
!
!   23.  XsubSun(3)    =  Barycentric radius vector of the Sun/Moon/planets
!   24.  XsubMoon(3)
!   25.  SPLANET(l,1,k)
!
!   26.  VsubSun(3)    =  Barycentric velocity vector of the Sun/Moon/planets
!   27.  VsubMoon(3)
!   28.  SPLANET(l,2,k)
!
!   29.  XSunt1J(3)    =  SSBC radius vector to the Sun/Moon/planets
!   30.  XMoont1J(3)         at the time of closest approach.
!   31.  XPlant1J(3,7)              (meters)
!
!   32.  R_Earth_Sun(3) = Vector from the Sun to the geocenter
!   33.  R_Earth_Moon(3)= Vector from the Moon to the geocenter
!   34.  -GPLANET(l,1,k)= Vector from planets to the geocenter
!
!   35.  V_Earth_Sun(3) = Velocity Vector of the geocenter from the Sun
!
!   36.  R1Sunt1(3)    =  Vector from the Sun/Moon/planets to receiver
!   37.  R1Moont1(3)   =      1 at the time of closest approach.
!   38.  R1Plant1(3,7) =                (meters)
!
!   39.  R2Sunt1(3)    =  Vector from the Sun/Moon/planets to receiver
!   40.  R2Moont1(3)   =      2 at the time of closest approach.
!   41.  R2Plant1(3,7) =              (meters)
!
!   42.  t_sub1        =  Time of arrival of the signal at receivers 1 and 2.
!   43.  t_sub2            [Note: not needed here so we don't actually define
!                          them.]
!
!   44.  del_t_Sun     =  Difference between arrival time at receiver 1, t_sub1,
!   45.  del_t_Moon         and time of closest approach to Sun/Moon/planets
!   46.  del_t_Planet(7)      ( > 0 if closest approach is before arrival)
!
!   47.  unit_K(3)     =  Barycentric unit vector to the source (in the absense
!                         of gravitational or aberrational bending).
!
!   48.  k_sub1(3)     =  Aberrated unit vector from station 1 to the source.
!   49.  k_sub2(3)     =  Aberrated unit vector from station 2 to the source.
!                          [Note: not computed here, see atmosphere module.]
!
!   50.  b_nought(3)   =  A priori geocentric baseline vector at time t_sub1
!                         (Baseline vector and it's velocity. Defined from
!                         site #1 to site #2 (M,M/S).)
!
!   51.  U             =  Sun's potential
!
!   52.  delgrav_Sun
!   53.  delgrav_Moon =  The differential gravitational time delay for
!   54.  delgrav_Plan(7)     the Sun/Moon/planets/Earth.
!   55.  delgrav_Earth
!
!   56.  delta_t_grav_Planets = Sum of bending delays for the planets
!
!   57.  delta_t_grav  =  The total differential gravitational time delay,
!                         or "bending delay."
!
!   58.  tv2_tv1       =  The theoretical vacuum delay computed using the
!                         Consensus model. (sec)
!
!   59.  tg2_tg1       =  The total theoretical geometric delay (doesn't
!                         include tropospheric refraction effects which are
!                         usually added in Solve) computed using the Consensus
!                         model. (sec)
!
! 4.2.9 PROGRAMMER - DAVID GORDON 04/22/93 thru 08/02/93 - Written and debuged
!                    D. Gordon Nov. 1993 - Modified to use all planets
!                              except Pluto.
!                    D. Gordon Jan-Mar 1994 - Modified for axis offset
!                              correction. Not using Eubank's Step 10.
!                    D. Gordon 10.05.94 Many unused variable and much unused
!                              code removed.
!                    D. Gordon 96.01.30 Added section to compute partial
!                              derivatives of delay and rate w.r.t. Gamma.
!                    D. Gordon 96.02.09 Corrected typo in Step 2 debug printout.
!                    D. Gordon 98.08.18 Mods for geocenter station.
!                    D. Gordon 98.11.16 Added computation of higher order
!                              solar bending term, from IERS Conventions
!                              (1996), page 91, eqn. 14. This term is now
!                              added to the total solar bending term. It
!                              only becomes significant within about 2
!                              degrees of the Sun.
!                    D. Gordon 98.12.16 Added computation of Bend_par(2), the
!                              partial derivatives of the gravitational
!                              bending contributions with respect to Gamma.
!
!         Write(6,*) '           ' 
!         Write(6,*) ' SEKIDO:   ' 
!       write(6,*) 'SEKIDO/R1mag,R1magdt ',  R1mag,R1magdt
!       write(6,*) 'SEKIDO/R2mag,R2magdt ',  R2mag,R2magdt
!
!     CONSEN program structure:
!
!     Compute the theoretical delay and delay rate using Eubanks's Consensus
!     Relativity model.
!_____________________________________________________________________________
!
!     Copy CALC variables into variables with names which mimic the variables
!     in the consensus paper. VLIGHT is used for the velocity of light because
!     'C' is a poor variable name that could be easily lost.
!
      Do l=1,3
!
       XsubEarth(l) = EARTH(l,1)     ! SSBC Earth position
       VsubEarth(l) = EARTH(l,2)     !   ditto    velocity
       AsubEarth(l) = EARTH(l,3)     !   ditto    acceleration
!
       VsubEart0(l) = 0.0D0          !   ditto    velocity
       AsubEart0(l) = 0.0D0          !   ditto    acceleration
!      VsubEart0(l) = EARTH(l,2)     !   ditto    velocity
!      AsubEart0(l) = EARTH(l,3)     !   ditto    acceleration
!
       x_sub1t1(l) = SITEP(l,1)      ! Site 1 geocentric position
       w_sub1(l)   = SITEV(l,1)      !      ditto        velocity
       a_sub1(l)   = SITEA(l,1)      !      ditto        acceleration
!
       x_sub2t1(l) = SITEP(l,2)      ! Site 2 geocentric position
       w_sub2(l)   = SITEV(l,2)      !      ditto        velocity
       a_sub2(l)   = SITEA(l,2)      !      ditto        acceleration
!
       unit_K(l)    = STAR(l)        ! J2000.0 pseudo source vector
       unitK1(l)    = STAR12(l,1)    
!
       x_subSun(l)  = SUN(l,1)       ! Geocentric Sun position
       v_subSun(l)  = SUN(l,2)       !       ditto    velocity
!
       x_subMoon(l) = XMOON(l,1)     ! Geocentric Moon position
       v_subMoon(l) = XMOON(l,2)     !       ditto     velocity
!
       b_nought(l)  = -EPBASE(l,1)   ! Baseline vector from site 1 to site 2
       db_nought(l) = -EPBASE(l,2)   ! Time derivative of baseline vector
!
       R_Earth_Sun(l)  = -SUN(l,1)
       V_Earth_Sun(l)  = -SUN(l,2)    ! = -v_subSun(l) also
       R_Earth_Moon(l) = -XMOON(l,1)
!
!   SSBC radius vectors of Sun and Moon:
       XsubSun(l)  = XsubEarth(l) + x_subSun(l)
       XsubMoon(l) = XsubEarth(l) + x_subMoon(l)
!
!   SSBC velocity vectors of Sun and Moon:
       VsubSun(l)  = VsubEarth(l) + v_subSun(l)
       VsubMoon(l) = VsubEarth(l) + v_subMoon(l)
!
      Enddo
!
!    Atomic time, TAI, at receiver #1:
!      t_sub1 =   ! Not needed here
!
      If (KTHED .ne. 0) Then
       write(6,'(/,15x,"  Debug output for subroutine CONSEN",/)')
       write(6,8)' GMSUN  ', GMSUN
       write(6,8)' GMMOON ', GMMOON
       write(6,8)' GMEARTH', GMEARTH
       write(6,'("GM-Planets = ",3d25.16,/,5x,4d25.16)') GMPLANET
       write(6,'(/,"XsubEarth:",3D23.14)') XsubEarth
       write(6,'("VsubEarth:",3D23.14)') VsubEarth
       write(6,'("AsubEarth:",3D23.14)') AsubEarth
       write(6,'("x_sub1t1:",3D23.14)') x_sub1t1
       write(6,'("w_sub1:",3D23.14)') w_sub1
       write(6,'("a_sub1:",3D23.14)') a_sub1
       write(6,'("x_sub2t1:",3D23.14)') x_sub2t1
       write(6,'("w_sub2:",3D23.14)') w_sub2
       write(6,'("a_sub2:",3D23.14)') a_sub2
       write(6,'("unit_K:",3D23.14)') unit_K
       write(6,'("unitK1:",3D23.14)') unitK1
       write(6,'("x_subSun:",3D23.14)') x_subSun
       write(6,'("x_subMoon:",3D23.14)') x_subMoon
       write(6,'("v_subSun:",3D23.14)') v_subSun
       write(6,'("v_subMoon:",3D23.14)') v_subMoon
       write(6,'("b_nought:",3D23.14)') b_nought
       write(6,'("db_nought:",3D23.14)') db_nought
       write(6,'("R_Earth_Sun:",3D23.14)') R_Earth_Sun
       write(6,'("V_Earth_Sun:",3D23.14)') V_Earth_Sun
       write(6,'("R_Earth_Moon:",3D23.14)') R_Earth_Moon
       write(6,'("XsubSun:",3D23.14)') XsubSun
       write(6,'("XsubMoon:",3D23.14)') XsubMoon
       write(6,'("VsubSun:",3D23.14)') VsubSun
       write(6,'("VsubMoon:",3D23.14)') VsubMoon
      Endif
!
!******************************************************************************
!  Step 1: Estimate barycentric radius and velocity vectors for stations 1
!          and 2 at time t_sub1 (Equation 6 and time derivative of).
!
      Do l=1,3
       Xsub1(l) = XsubEarth(l) + x_sub1t1(l)
       Xsub2(l) = XsubEarth(l) + x_sub2t1(l)
       dXsub1(l) = VsubEarth(l) + w_sub1(l)     !derivative
       dXsub2(l) = VsubEarth(l) + w_sub2(l)     !derivative
      Enddo
!
      If (KTHED .ne. 0) Then
       write(6,'(/,15x,"Step 1 dump:")')
       write(6,8)' Xsub1 ',Xsub1
       write(6,8)' Xsub2 ',Xsub2
       write(6,8)' dXsub1 ',dXsub1
       write(6,8)' dXsub2 ',dXsub2
      Endif
!
!******************************************************************************
!  Step 2: Estimate the vectors from the Sun, the Moon, and each planet (except
!          Earth and Pluto) to receiver 1.
!
!   Eq. 5a  -  Find time of closet approach of the near-field object to the 
!              gravitating body. [Actually ........................
!              we find only how much earlier (or later) the ........ rays
!              passed closest to the gravitating body. Then, if earlier, we
!              extrapolate the body's position back to that earlier time. If
!              not earlier we just keep the current position.]
!
!  J2000.0 vector from receiver #1 to the Sun/Moon/planets:
      Do l=1,3
       x1Sun(l)  = XsubSun(l)  - Xsub1(l)
       x1Moon(l) = XsubMoon(l) - Xsub1(l)
      Enddo
      Do k=1,7
       do l=1,3
        x1Planet(l,k)  = SPLANET(l,1,k)  - Xsub1(l)
       enddo
      Enddo
!
!   more good stuff
       KdotB  = DOTP(STAR,b_nought)
       dKdotB = DOTP(STAR,db_nought) + DOTP(STARdt,b_nought) 
!         Write(6,*) '           ' 
!         Write(6,*) ' SEKIDO:   ' 
!         Write(6,*) ' KdotB,dKdotB  ', KdotB,dKdotB 
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Sun:
       del_t_Sun  = DOTP(unitK1,x1Sun) / Vlight
!        
!      write(6,8)' T0_T1, del_t_Sun(sec) ', T0_T1, del_t_Sun
       If(del_t_Sun .lt. 0.D0) del_t_Sun = 0.0D0
       If(del_t_Sun .gt. T0_T1) del_t_Sun = T0_T1
!      write(6,8)' T0_T1, del_t_Sun(sec) ', T0_T1, del_t_Sun
!
        Do l=1,3
!    SSBC vector to Sun at time of closest approach and its time derivative:
         XSunt1J(l) = Xsubsun(l) - VsubSun(l)*del_t_Sun
         dXSunt1J(l) = Vsubsun(l)   !Derivative (approx. - no acceleration)
!
!          Vector from Sun to receiver 1
         R1Sunt1(l) = Xsub1(l) - XSunt1J(l)
         dR1Sunt1(l) = dXsub1(l) - dXSunt1J(l)   !Derivative
!
!          Vector from Sun to receiver 2
         R2Sunt1(l) = Xsub2(l) - VsubEarth(l)*KdotB/VLIGHT - XSunt1J(l)
         dR2Sunt1(l) = dXsub2(l) -  AsubEarth(l)*KdotB/VLIGHT -         &
     &                 VsubEarth(l)*dKdotB/VLIGHT - dXSunt1J(l)   !Derivative
!
!    Vector from Sun to near-field object 
         R0sun(l) = R1Sunt1(l) + R1(l)
         dR0sun(l) = dR1Sunt1(l) + R1dt(l)
!     
        Enddo
!      write(6,8)' Xsubsun,VsubSun  ', Xsubsun,VsubSun 
!      write(6,8)' Xsub1, XSunt1J   ', Xsub1, XSunt1J  
!      write(6,8)' Xsub2, VsubEarth ', Xsub2, VsubEarth
!      write(6,8)' KdotB,VLIGHT     ', KdotB,VLIGHT    
!      write(6,8)' XSunt1J,dXSunt1J ', XSunt1J,dXSunt1J
!      write(6,8)' R1Sunt1,dR1Sunt1 ', R1Sunt1,dR1Sunt1
!      write(6,8)' R2Sunt1,dR2Sunt1 ', R2Sunt1,dR2Sunt1
!      write(6,8)' R0sun,R1         ', R0sun,R1        
!
         R1J = VECMG (R1Sunt1)
          dR1J = DOTP(R1Sunt1,dR1Sunt1)/R1J
         R2J = VECMG (R2Sunt1)
          dR2J = DOTP(R2Sunt1,dR2Sunt1)/R2J
         R0J = VECMG (R0sun)
          dR0J = DOTP(R0Sun,dR0Sun)/R0J
         R10 = R1mag
          dR10 = R1magdt
         R20 = R2mag
          dR20 = R2magdt
!         Write(6,*) ' Sun: '
!         Write(6,*) ' R1,R1Sunt1 ', R1, R1Sunt1
!         Write(6,*) ' R0sun      ', R0sun   
!         Write(6,*) ' R2,R2Sunt1 ', R2, R2Sunt1
!         Write(6,*) ' R1J, dR1J ', R1J, dR1J
!         Write(6,*) ' R2J, dR2J ', R2J, dR2J
!         Write(6,*) ' R0J, dR0J ', R0J, dR0J
!         Write(6,*) ' R10, dR10 ', R10, dR10
!         Write(6,*) ' R20, dR20 ', R20, dR20
!         Write(6,*) '      '
!
       CALL TGRAV(GMSUN, R0J,R1J,R2J,R10,R20, dR0J,dR1J,dR2J,           &
     &      dR10,dR20, delgrav_Sun, ddelgrav_Sun)
!    &      dR10,dR20, DelTpNsun,DelTpNsundt)
!      write(6,8)' TGRAV: delTpNsun ', delTpNsun, delTpNsundt
!      write(6,8)'TGRAV: delgrav_Sun ', delgrav_Sun, ddelgrav_Sun
!
!  Solar gravitational delay on near-field object:
!     term_a  = R1J + DOTP(STAR12(1,1),R1Sunt1)
!      dterm_a  = dR1J + DOTP(STAR12dt(1,1),R1Sunt1) +                  &
!    &            DOTP(STAR12(1,1),dR1Sunt1)
!
!     term_a1 = R0J + DOTP(STAR12(1,2),R0Sun)
!      dterm_a1 = dR0J + -DOTP(STAR12dt(1,2),R0Sun) +                    &
!    &            DOTP(STAR12(1,2),dR0Sun)
!
!     term_b  = R2J + DOTP(STAR12(1,2),R2Sunt1)
!     dterm_b  = dR2J + DOTP(STAR12dt(1,2),R2Sunt1) +                   &
!    &            DOTP(STAR12(1,2),dR2Sunt1)
!
!     term_b1 = R0J + DOTP(STAR12(1,1),R0Sun)
!      dterm_b1 = dR0J + DOTP(STAR12dt(1,1),R0Sun) +                    &
!    &            DOTP(STAR12(1,1),dR0Sun)
!
!      delgrav_Sun = (2.D0*GMSUN/VLIGHT3) *                             &
!    &     DLOG ( (term_a*term_a1)/(term_b*term_b1)) 
!      ddelgrav_Sun = (2.D0*GMSUN/VLIGHT3) * (dterm_a/term_a +          &
!    &           dterm_a1/term_a1 - dterm_b/term_b - dterm_b1/term_b1)
!      write(6,*) ' Sun:  '
!      write(6,*) ' GMSUN,VLIGHT3  ', GMSUN,VLIGHT3 
!      write(6,*) ' term_a,dterm_a ', term_a,dterm_a
!      write(6,*) ' term_a1,dterm_a1 ', term_a1,dterm_a1
!      write(6,*) ' term_b,dterm_b ', term_b,dterm_b
!      write(6,*) ' term_b1,dterm_b1 ', term_b1,dterm_b1
!      write(6,8) 'Sekido: delgrav_Sun ', delgrav_Sun, ddelgrav_Sun
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Moon:
       del_t_Moon = DOTP(unitK1,x1Moon) / Vlight
!        
       If(del_t_Moon .lt. 0.D0) del_t_Moon = 0.0D0
       If(del_t_Moon .gt. T0_T1) del_t_Moon = T0_T1
!      write(6,8)' del_t_Moon ',del_t_Moon
!
        Do l=1,3
!    SSBC vector to Moon at time of closest approach and its time derivative:
         XMoont1J(l) = XsubMoon(l) - VsubMoon(l)*del_t_Moon
         dXMoont1J(l) = VsubMoon(l)    !Derivative (approx. - no acceleration)
!
!       Vector from the Moon to receiver 1
         R1Moont1(l) = Xsub1(l) - XMoont1J(l)
         dR1Moont1(l) = dXsub1(l) - dXMoont1J(l)   !Derivative
!
!       Vector from the Moon to receiver 2
         R2Moont1(l) = Xsub2(l) - VsubEarth(l)* KdotB/VLIGHT -          &
     &                 XMoont1J(l)
         dR2Moont1(l) = dXsub2(l) - AsubEarth(l)*KdotB/VLIGHT -         &
     &                VsubEarth(l)*dKdotB/VLIGHT - dXMoont1J(l)  !Derivative
!
!    Vector from Moon to near-field 
         R0moon(l)  =  R1moont1(l) + R1(l)
         dR0moon(l) = dR1moont1(l) + R1dt(l)
!     
        Enddo
!
         R1J = VECMG (R1Moont1)
          dR1J = DOTP(R1Moont1,dR1Moont1)/R1J
         R2J = VECMG (R2Moont1)
          dR2J = DOTP(R2Moont1,dR2Moont1)/R2J
         R0J = VECMG (R0Moon)
          dR0J = DOTP(R0Moon,dR0Moon)/R0J
!
!         Write(6,*) ' Moon: '
!         Write(6,*) ' R1J, dR1J ', R1J, dR1J
!         Write(6,*) ' R2J, dR2J ', R2J, dR2J
!         Write(6,*) ' R0J, dR0J ', R0J, dR0J
!         Write(6,*) '      '
!
!
       CALL TGRAV(GMMOON,R0J,R1J,R2J,R10,R20, dR0J,dR1J,dR2J,           &
     &      dR10,dR20, delgrav_Moon, ddelgrav_Moon)
!    &      dR10,dR20, DelTpNmoon,DelTpNmoondt)
!      write(6,8)'TGRAV: DelTpNmoon ', delTpNmoon, DelTpNmoondt
!      write(6,8)'TGRAV: delgrav_Moon ', delgrav_Moon, ddelgrav_Moon
!
!  Lunar gravitational delay on near-field object:
!     term_a  = R1J + DOTP(STAR12(1,1),R1Moont1)
!      dterm_a  = dR1J + DOTP(STAR12dt(1,1),R1Moont1) +                  &
!    &            DOTP(STAR12(1,1),dR1Moont1)
!
!     term_a1 = R0J + DOTP(STAR12(1,2),R0Moon)
!      dterm_a1 = dR0J + DOTP(STAR12dt(1,2),R0Moon) +                    &
!    &            DOTP(STAR12(1,2),dR0Moon)
!
!     term_b  = R2J + DOTP(STAR12(1,2),R2Moont1)
!     dterm_b  = dR2J + DOTP(STAR12dt(1,2),R2Moont1) +                   &
!    &            DOTP(STAR12(1,2),dR2Moont1)
!
!     term_b1 = R0J + DOTP(STAR12(1,1),R0Moon)
!      dterm_b1 = dR0J + DOTP(STAR12dt(1,1),R0Moon) +                    &
!    &            DOTP(STAR12(1,1),dR0Moon)
!
!      delgrav_Moon = (2.D0*GMMOON/VLIGHT3) *                             &
!    &     DLOG ( (term_a*term_a1)/(term_b*term_b1) ) 
!      ddelgrav_Moon = (2.D0*GMMOON/VLIGHT3) * (dterm_a/term_a +          &
!    &           dterm_a1/term_a1 - dterm_b/term_b - dterm_b1/term_b1)
!      write(6,*) ' Moon:  '
!      write(6,*) ' term_a,dterm_a ', term_a,dterm_a
!      write(6,*) ' term_a1,dterm_a1 ', term_a1,dterm_a1
!      write(6,*) ' term_b,dterm_b ', term_b,dterm_b
!      write(6,*) ' term_b1,dterm_b1 ', term_b1,dterm_b1
!      write(6,8) 'Sekido: delgrav_Moon ', delgrav_Moon, ddelgrav_Moon
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Planets:
      Do k=1,7      !Planet loop
       del_t_Planet(k)  = DOTP(unitK1,x1Planet(1,k)) / Vlight
!        
       If(del_t_Planet(k) .lt. 0.D0) del_t_Planet(k) = 0.0D0
       If(del_t_Planet(k) .gt. T0_T1) del_t_Planet(k) = T0_T1
!        write(6,'("del_t_Planet(",i1,") = ",d25.16)')k,del_t_Planet(k)
!
        Do l=1,3
!    SSBC vector to Planet at time of closest approach and its time derivative:
         XPlant1J(l,k) = SPLANET(l,1,k) - SPLANET(l,2,k)*del_t_Planet(k)
         dXPlant1J(l,k) = SPLANET(l,2,k)    ! Derivative  (approximate)
!
!       Vector from Planet to receiver 1
         R1Plant1(l,k) = Xsub1(l) - XPlant1J(l,k)
         dR1Plant1(l,k) = dXsub1(l) - dXPlant1J(l,k)   !Derivative
!
!       Vector from Planet to receiver 2
         R2Plant1(l,k) = Xsub2(l) - VsubEarth(l)*KdotB/VLIGHT -         &
     &                XPlant1J(l,k)
         dR2Plant1(l,k) = dXsub2(l) - AsubEarth(l)*KdotB/VLIGHT -       &
     &               VsubEarth(l)*dKdotB/VLIGHT - dXPlant1J(l,k)   !Derivative
!
!    Vector from Planet k to near-field object
         R0plan(l,k)  =  R1plant1(l,k) + R1(l)
         dR0plan(l,k) = dR1plant1(l,k) + R1dt(l)
!     
        Enddo
!
         R1J = VECMG (R1Plant1(1,k))
          dR1J = DOTP(R1Plant1(1,k),dR1Plant1(1,k))/R1J
         R2J = VECMG (R2Plant1(1,k))
          dR2J = DOTP(R2Plant1(1,k),dR2Plant1(1,k))/R2J
         R0J = VECMG (R0plan(1,k))
          dR0J = DOTP(R0plan(1,k),dR0plan(1,k))/R0J
         GMp = GMPlanet(k)
!
!         Write(6,*) ' Planet ', k
!         Write(6,*) ' R1J, dR1J ', R1J, dR1J
!         Write(6,*) ' R2J, dR2J ', R2J, dR2J
!         Write(6,*) ' R0J, dR0J ', R0J, dR0J
!         Write(6,*) ' GMp       ', GMp      
!         Write(6,*) '      '
!
       CALL TGRAV (GMp,R0J,R1J,R2J,R10,R20, dR0J,dR1J,dR2J,             &
     &      dR10,dR20, DelTpNPl,DelTpNPldt)
!      DelTpNPlan(k) = DelTpNPl
!      DelTpNPlandt(k) = DelTpNPldt
!      write(6,*)' #, delTpNPLAN(k) ', k, delTpNPlan(k), DelTpNPlandt(k)
       delgrav_Plan(k) = DelTpNPl
       ddelgrav_Plan(k) = DelTpNPldt
!      write(6,*)'TGRAV: delgrav_Plan ', k, delgrav_Plan(k), ddelgrav_Plan(k) 
!
!  Planet #k gravitational delay on near-field object:
!     term_a  = R1J + DOTP(STAR12(1,1),R1Plant1(1,k))
!      dterm_a  = dR1J + DOTP(STAR12dt(1,1),R1Plant1(1,k)) +            &
!    &            DOTP(STAR12(1,1),dR1Plant1(1,k))
!
!     term_a1 = R0J + DOTP(STAR12(1,2),R0Plan(1,k))
!      dterm_a1 = dR0J + DOTP(STAR12dt(1,2),R0Plan(1,k)) +            &
!    &            DOTP(STAR12(1,2),dR0Plan(1,k))
!
!     term_b  = R2J + DOTP(STAR12(1,2),R2Plant1(1,k))
!      dterm_b  = dR2J + DOTP(STAR12dt(1,2),R2Plant1(1,k)) +            &
!    &            DOTP(STAR12(1,2),dR2Plant1(1,k))
!
!     term_b1 = R0J + DOTP(STAR12(1,1),R0Plan(1,k))
!      dterm_b1 = dR0J + DOTP(STAR12dt(1,1),R0Plan(1,k)) +            &
!    &            DOTP(STAR12(1,1),dR0Plan(1,k))
!
!      delgrav_Plan(k) = (2.D0*GMPlanet(k)/VLIGHT3) *                   &
!    &     DLOG ( (term_a*term_a1)/(term_b*term_b1) ) 
!      ddelgrav_Plan(k) = (2.D0*GMPlanet(k)/VLIGHT3) * (dterm_a/term_a  &
!    &         + dterm_a1/term_a1 - dterm_b/term_b - dterm_b1/term_b1)
!      write(6,*) ' Planet ', k
!      write(6,*) ' term_a,dterm_a ', term_a,dterm_a
!      write(6,*) ' term_a1,dterm_a1 ', term_a1,dterm_a1
!      write(6,*) ' term_b,dterm_b ', term_b,dterm_b
!      write(6,*) ' term_b1,dterm_b1 ', term_b1,dterm_b1
!      write(6,*) ' k,delgrav_Plan ', k,delgrav_Plan(k), ddelgrav_Plan(k)
!      write(6,*) '        '
!
      Enddo      !Planet loop
!
!******************* Debug ********************
!     IF(KTHED .ne. 0) Then               ! Debug
!      write(6,'(/,15x,"Step 2 dump:")')
!      write(6,8)' x1Sun ',x1Sun
!      write(6,8)' x1Moon ',x1Moon
!     Do k=1,7
!        write(6,'("x1Planet(",i1,") = ",3d25.16)') k,x1Planet(1,k),    &
!    &            x1Planet(2,k),x1Planet(3,k)
!        write(6,'("SPLANET(",i1,") = ",3d25.16)') k,SPLANET(1,1,k),    &
!    &            SPLANET(2,1,k),SPLANET(3,1,k)
!     Enddo
!
!      write(6,8)' KdotB, dKdotB ', KdotB, dKdotB
!      write(6,8)' del_t_Sun ',del_t_Sun
!      write(6,8)' XSunt1J ',XSunt1J
!      write(6,8)' dXSunt1J ',dXSunt1J
!      write(6,8)' R1Sunt1 ',R1Sunt1
!      write(6,8)' dR1Sunt1 ',dR1Sunt1
!      write(6,8)' R2Sunt1 ',R2Sunt1
!      write(6,8)' dR2Sunt1 ',dR2Sunt1
!      write(6,8)' del_t_Moon ',del_t_Moon
!      write(6,8)' XMoont1J ',XMoont1J
!      write(6,8)' dXMoont1J ',dXMoont1J
!      write(6,8)' R1Moont1 ',R1Moont1
!      write(6,8)' dR1Moont1 ',dR1Moont1
!      write(6,8)' R2Moont1 ',R2Moont1
!      write(6,8)' dR2Moont1 ',dR2Moont1
!      write(6,8)' Vmag_S ',  Vmag_S
!      write(6,8)' N_hat  ',  N_hat
!      write(6,8)' dN_hat ', dN_hat
!
!     Do k=1,7
!        write(6,'("del_t_Planet(",i1,") = ",d25.16)')k,del_t_Planet(k)
!        write(6,'("XPlant1J(",i1,") = ",3d25.16)') k,XPlant1J(1,k),    &
!    &            XPlant1J(2,k),XPlant1J(3,k)
!        write(6,'("dXPlant1J(",i1,") = ",3d25.16)') k,dXPlant1J(1,k),  &
!    &            dXPlant1J(2,k),dXPlant1J(3,k)
!        write(6,'("R1Plant1(",i1,") = ",3d25.16)') k,R1Plant1(1,k),    &
!    &            R1Plant1(2,k),R1Plant1(3,k)
!        write(6,'("dR1Plant1(",i1,") = ",3d25.16)') k,dR1Plant1(1,k),  &
!    &            dR1Plant1(2,k),dR1Plant1(3,k)
!        write(6,'("R2Plant1(",i1,") = ",3d25.16)') k,R2Plant1(1,k),    &
!    &            R2Plant1(2,k),R2Plant1(3,k)
!        write(6,'("dR2Plant1(",i1,") = ",3d25.16)') k,dR2Plant1(1,k),  &
!    &            dR2Plant1(2,k),dR2Plant1(3,k)
!     Enddo
!
!     Endif                               ! Debug
!
!******************************************************************************
!  Step 4: Find the differential delay due to the Earth.
!
       C_Earth = (1.0D0 + gamma) * GMEarth/VLIGHT3
       vecmg0 = VECMG(SPpxyz)
       dvecmg0 = DOTP(SPvxyz,SPpxyz)/vecmg0 
!
      IF(Nzero .ne. 1) THEN
        vecmg1 = VECMG(x_sub1t1)
        term_g = vecmg1 + DOTP(STAR12(1,1),x_sub1t1)
        dterm_g = DOTP(x_sub1t1,w_sub1)/vecmg1 +                        &
     &           DOTP(STAR12(1,1),w_sub1) + DOTP(STAR12dt(1,1),x_sub1t1)
        term_g1 = vecmg0 + DOTP(STAR12(1,1),SPpxyz  )
        dterm_g1 = dvecmg0 + DOTP(STAR12(1,1),SPvxyz)                   &
     &             + DOTP(STAR12dt(1,1),SPpxyz)
      ELSE
        vecmg1   = REARTH
        term_g   = 2.0D0 * REARTH
        dterm_g  = 0.0D0
        term_g1  = 2.0D0 * vecmg0
        dterm_g1 = 2.0D0 * dvecmg0
      ENDIF
!
       IF(Nzero .ne. 2) THEN
        vecmg2 = VECMG(x_sub2t1)
        term_h = vecmg2 + DOTP(STAR12(1,2),x_sub2t1)
        dterm_h = DOTP(x_sub2t1,w_sub2)/vecmg2 +                        &
     &           DOTP(STAR12(1,2),w_sub2) + DOTP(STAR12dt(1,2),x_sub2t1)
        term_h1 = vecmg0 + DOTP(STAR12(1,2),SPpxyz)
        dterm_h1 = dvecmg0 + DOTP(STAR12(1,2),SPvxyz)                   &
     &             + DOTP(STAR12dt(1,2),SPpxyz)
       ELSE
        vecmg2 =  REARTH
        term_h =  2.0D0 * REARTH
        dterm_h = 0.0D0
        term_h1  = 2.0D0 * vecmg0
        dterm_h1 = 2.0D0 * dvecmg0
       ENDIF
!
       delgrav_Earth = C_Earth * DLOG( (term_g*term_h1) /               &
     &                                      (term_h*term_g1) )
       ddelgrav_Earth = C_Earth * ( dterm_g/term_g +                    &
     &    dterm_h1/term_h1 - dterm_h/term_h - dterm_g1/term_g1 )
!
!      write(6,8)' vecmg0, dvecmg0  ', vecmg0, dvecmg0
!      write(6,8)' vecmg1, vecmg2   ', vecmg1, vecmg2
!      write(6,8)' term_g, dterm_g  ', term_g, dterm_g
!      write(6,8)' term_g1,dterm_g1 ', term_g1, dterm_g1
!      write(6,8)' term_h, dterm_h  ', term_h, dterm_h
!      write(6,8)' term_h1,dterm_h1 ', term_h1, dterm_h1
!      write(6,8)'Sekido: delgrav_Earth, ddelgrav_Earth ',              &
!    &             delgrav_Earth,ddelgrav_Earth
!
!*    IF(KTHED .ne. 0) Then               ! Debug
!*     write(6,'(/,15x,"Step 4 dump:")')
!*     write(6,8)' C_Earth  ',C_Earth
!*     write(6,8)' term_g, dterm_g  ', term_g, dterm_g
!*     write(6,8)' term_h, dterm_h  ', term_h, dterm_h
!*     write(6,8)' delgrav_Earth, ddelgrav_Earth ',                     &
!*   &             delgrav_Earth,ddelgrav_Earth
!*    Endif                               ! Debug
!
!******************************************************************************
!  Step 5: Add up all components to get the total
!          differential gravitational delay.
!          [Does not include the term for observations close to the Sun.]
!
!  Add up the 10 gravitational components
      delgrav = delgrav_Sun + delgrav_Moon + delgrav_Earth
       ddelgrav = ddelgrav_Sun + ddelgrav_Moon + ddelgrav_Earth
      Do k=1,7 
       delgrav = delgrav + delgrav_Plan(k)
       ddelgrav = ddelgrav + ddelgrav_Plan(k)
      Enddo
!      write(6,8)' Sekido: delgrav,ddelgrav ', delgrav,ddelgrav
!
!*    IF(KTHED .ne. 0) Then               ! Debug
!*     write(6,'(/,15x,"Step 5 dump:")')
!*     write(6,8)' delgrav_Planets, ddelgrav_Planets ',                 &
!*   &             delgrav_Planets, ddelgrav_Planets
!*     write(6,8)' delgrav, ddelgrav ',                                 &
!*   &             delgrav, ddelgrav
!*    Endif                               ! Debug
!
!******************************************************************************
!  Step 6: Add the total differential gravitational delay to the rest of the
!          a priori vacuum delay, Equation 9.
!
!  Find Sun's potential:
!
       U_Sun  = GMSUN/VLIGHT2
       vecmg1 = VECMG(R_Earth_Sun)
       U      = U_Sun/vecmg1
!   Derivative:
       dU = -U_Sun * Dotp(R_Earth_Sun,V_Earth_Sun) / vecmg1**3
!
!   Compute individual terms of Eqn. 20
!
       term2a = KdotB/VLIGHT
       dterm2a = dKdotB/VLIGHT                  ! derivative
!       Write(6,8) ' term2a,dterm2a ', term2a,dterm2a
!
       term2b = 1.D0 - ((1.D0 + gamma) * U)
       dterm2b = -(1.D0 + gamma) * dU           ! derivative
!       Write(6,8) ' term2b-1,dterm2b ', (term2b-1.D0),dterm2b
!
       absVEarth = VECMG(VsubEarth)
       term2c = (absVEarth)**2 / (2.D0*VLIGHT2)
       dterm2c = Dotp(VsubEarth,AsubEarth) /  VLIGHT2        ! derivative
!!      term2c = 0.D0    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!      dterm2c = 0.D0   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term2c,dterm2c ', term2c,dterm2c
!
       term2d = DOTP(VsubEarth,w_sub2) / VLIGHT2
       dterm2d = (DOTP(AsubEarth,w_sub2) + DOTP(VsubEarth,a_sub2))      &
     &            / VLIGHT2                                  ! derivative
!!     term2d = 0.D0    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!     dterm2d = 0.D0   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term2d,dterm2d ', term2d,dterm2d
!
!  Combine terms 2b,2c,2d
       term2bcd = term2b - term2c - term2d
       dterm2bcd = dterm2b - dterm2c - dterm2d               ! derivative
!
       term2  = term2a * term2bcd
       dterm2  = term2a * dterm2bcd + dterm2a * term2bcd     ! derivative
!       Write(6,8) ' term2, dterm2  ', term2,dterm2
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       VdotB  = DOTP(VsubEart0,b_nought)
       dVdotB = DOTP(AsubEart0,b_nought) + DOTP(VsubEart0,db_nought) !derivative
!
!!!!   KdotV  = DOTP(unit_K,VsubEarth)
!!!!   dKdotV = DOTP(unit_K,AsubEarth)                       ! derivative
!
       term3a = VdotB/VLIGHT2
       dterm3a = dVdotB/VLIGHT2
!       Write(6,8) ' term3a,dterm3a ', term3a,dterm3a
!
       Call VECAD (VsubEart0, w_sub2, V2 )
       Call VECAD (AsubEart0, a_sub2, dV2 )
!       Write(6,8) ' V2, dV2 ', V2, dV2 
       term3b = DOTP(STAR12(1,2), V2)/VLIGHT
!      term3b = DOTP(STAR12(1,2), w_sub2)/VLIGHT     !!!!!! TEST !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       dterm3b = (DOTP(STAR12dt(1,2),V2) + DOTP(STAR12(1,2),dV2))/VLIGHT
!      dterm3b = (DOTP(STAR12dt(1,2),w_sub2) + DOTP(STAR12(1,2),a_sub2))/VLIGHT  !!!!!  TEST !!!!!!!
!??    term3b = DOTP(STAR12(1,2), w_sub2)/VLIGHT
!??    dterm3b = (DOTP(STAR12dt(1,2),w_sub2) + DOTP(STAR12(1,2),a_sub2))/VLIGHT
!       Write(6,8) ' STAR12(1,2)   ', STAR12(1,2),STAR12(2,2),STAR12(3,2)
!       Write(6,8) ' STAR12dt(1,2) ', STAR12dt(1,2),STAR12dt(2,2),STAR12dt(3,2) 
!       Write(6,8) ' term3b,dterm3b ', term3b,dterm3b
!
        DO I = 1,3
         Vec3c(I) = VsubEart0(I) + 2.D0*w_sub2(I)
         dVec3c(I) = AsubEart0(I) + 2.D0*a_sub2(I)
        ENDDO
       term3c = DOTP(Vec3c,STAR) / (2.D0*VLIGHT)
       dterm3c = (DOTP(dVec3c,STAR) + DOTP(Vec3c,STARdt))/(2.D0*VLIGHT)
!       Write(6,8) ' term3c,dterm3c ', term3c,dterm3c
!
       term3 = term3a * (1.D0 + term3b - term3c) 
       dterm3 = dterm3a*(1.D0+term3b-term3c) + term3a*(dterm3b-dterm3c)
!!     term3 = term3a * (1.D0 )     !!!!!!!!!!!!!!!!! 
!!     dterm3 = dterm3a*(1.D0)      !!!!!!!!!!!!!!!!!
!?     term3 = 0.D0         !!!!!!!!!!!!!!!!!!!!!!!!!
!?     dterm3 = 0.D0        !!!!!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term3, dterm3  ', term3,dterm3 
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
       term4a = 1.D0 + DOTP(STAR12(1,2),V2)/VLIGHT
!      term4a = 1.D0 + DOTP(STAR12(1,2),w_sub2)/VLIGHT
       dterm4a = (DOTP(STAR12dt(1,2),V2) + DOTP(STAR12(1,2),dV2))/VLIGHT
!      dterm4a = (DOTP(STAR12dt(1,2),w_sub2) + DOTP(STAR12(1,2),w_sub2))/VLIGHT
!??    term4a = 1.D0 + DOTP(STAR12(1,2),w_sub2)/VLIGHT
!??    dterm4a = (DOTP(STAR12dt(1,2),w_sub2) + DOTP(STAR12(1,2),a_sub2))/VLIGHT
!       Write(6,8) ' term4a,dterm4a ', term4a,dterm4a
!
       Call CROSP(V2,STAR12(1,2),H1)
!??    Call CROSP(w_sub2,STAR12(1,2),H1)
       H2 = (VECMG(H1)/VLIGHT)**2 
       H3 = KdotB/(2.D0*R2mag)
       H  = H2*H3

       Call CROSP(dV2,STAR12(1,2),dH1a)
       Call CROSP(V2,STAR12dt(1,2),dH1b)
!??    Call CROSP(a_sub2,STAR12(1,2),dH1a)
!??    Call CROSP(w_sub2,STAR12dt(1,2),dH1b)
       Call VECAD (dH1a, dH1b, dH1)
!       dH2 = 2.D0*(VECMG(H1)*(VECMG(dH1)))/(VLIGHT2)
        dH2 = (2.D0 * DOTP(H1,dH1)) / VLIGHT2
        dH3 = (dKdotB/R2mag - KdotB*R2magdt/R2mag**2)/2.0D0
        dH  = dH2*H3 + H2*dH3
!       Write(6,8) ' H1, dH1 ', H1, dH1 
!       Write(6,8) ' H2, dH2 ', H2, dH2 
!       Write(6,8) ' H3, dH3 ', H3, dH3 
!       Write(6,8) ' H,  dH  ', H, dH  
!
       term4 = term4a * (1.D0 + H)
       dterm4 = dterm4a*(1.D0 + H) + term4a*dH
!!?    term4 =          (1.D0 + H)             !!!!!!!!!!!!!!!!!!!!!!
!!?    dterm4 = 0.D0                           !!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term4, dterm4  ', term4,dterm4 
!
       tv2_tv1 = (-term2 - term3 + delgrav) / term4
       dtv2_tv1 = (-dterm2 - dterm3 + ddelgrav) / term4    -            &
     &          (1.D0/term4**2) * (-term2 - term3 + delgrav) * dterm4
!
!      write(6,8) 'S: tv2_tv1, dtv2_tv1 ',tv2_tv1, dtv2_tv1
!      Write(6,*) ' No delTgrav (ps): ', (tv2_tv1 - delgrav/term4)*1.D12
!
!     IF(KTHED .ne. 0) Then               ! Debug
!      write(6,'(/,15x,"Step 6 dump:")')
!      write(6,8)' U_Sun, U, dU ',U_Sun, U, dU
!      write(6,8)' term1, dterm1  ',term1, dterm1
!      write(6,8)' term2a, dterm2a  ',term2a, dterm2a
!      write(6,8)' term2b, dterm2b  ',term2b, dterm2b
!      write(6,8)' absVEarth',absVEarth
!      write(6,8)' term2c, dterm2c  ',term2c, dterm2c
!      write(6,8)' term2d, dterm2d  ',term2d, dterm2d
!      write(6,8)' term2bcd, dterm2bcd  ',term2bcd, dterm2bcd
!      write(6,8)' term2, dterm2  ',term2, dterm2
!      write(6,8)' VdotB, dVdotB  ',VdotB, dVdotB
!      write(6,8)' KdotV, dKdotV  ',KdotV, dKdotV
!      write(6,8)' term3a, dterm3a  ',term3a, dterm3a
!      write(6,8)' term3b, dterm3b  ',term3b, dterm3b
!      write(6,8)' term3, dterm3  ',term3, dterm3
!      write(6,8)' vec_sum, dvec_sum ',vec_sum, dvec_sum
!      write(6,8)' term4, dterm4  ',term4, dterm4
!      write(6,8)' term123, dterm123  ',term123, dterm123
!      write(6,8)' tv2_tv1, dtv2_tv1 ',tv2_tv1, dtv2_tv1
!     Endif                               ! Debug
!
!******************************************************************************
!  Step 7: Calculate the aberrated source vectors for use in the tropospheric
!          propogation delay calculation.
!
!      [Note: These calculations are in the atmosphere module, subroutine
!      ATMG, and do not need to be done here. The aberrated source vectors are
!      used in the atmosphere module to compute the topocentric azimuths and
!      elevations, and in the axis offset module (along with refraction) to
!      compute the vector axis offset.]
!
!     call vecad(VsubEarth,w_sub1,V_w1)
!     K_V_w1 = Dotp(unit_K,V_w1)
!
!     call vecad(VsubEarth,w_sub2,V_w2)
!     K_V_w2 = Dotp(unit_K,V_w2)
!
!     Do l=1,3
!       k_sub1(l) = unit_K(l) + (VsubEarth(l) + w_sub1(l)) / VLIGHT
!    .            - unit_K(l) * K_V_w1 /VLIGHT
!       k_sub2(l) = unit_K(l) + (VsubEarth(l) + w_sub2(l)) / VLIGHT
!    .            - unit_K(l) * K_V_w2 /VLIGHT
!     Enddo
!
!     IF(KTHED .ne. 0) Then               ! Debug
!      write(6,'(/,15x,"Step 7 dump:")')
!      write(6,8)' V_w1, K_V_w1  ',V_w1, K_V_w1
!      write(6,8)' V_w2, K_V_w2  ',V_w2, K_V_w2
!      write(6,8)' k_sub1, k_sub2  ',k_sub1, k_sub2
!     Endif                               ! Debug
!
!******************************************************************************
!  Step 8: Add the geometric part of the tropospheric propogation delay to the
!          vacuum delay.
!          [Geocenter station: DATMC(Nzero,1) and DATMC(Nzero,2) should
!          already be zero.]
!
      call vecsb(w_sub2,w_sub1,w2_w1)
      call vecsb(a_sub2,a_sub1,a2_a1)
      K_dotw2w1 = DOTP(STAR,w2_w1) + DOTP(STARdt,b_nought)
      dK_dotw2w1 = DOTP(STARdt,w2_w1) + DOTP(STAR,a2_a1) +              &
     &             DOTP(STARdt,db_nought) 
!!!  &             + DOTP(STARdtdt,b_nought)
!
!   Negative sign because station 1 atmosphere is negative.
      tg2_tg1 = tv2_tv1 - DATMC(1,1) * K_dotw2w1/VLIGHT
      dtg2_tg1 = dtv2_tv1 - DATMC(1,2) * K_dotw2w1/VLIGHT               &
     &                    - DATMC(1,1) * dK_dotw2w1/VLIGHT
!      write(6,8)' w2_w1, a2_a1 ', w2_w1, a2_a1
!      write(6,8)' DOTP(STAR,w2_w1)/c ', DOTP(STAR,w2_w1)/VLIGHT
!      write(6,8)' DOTP(STARdt,b_nought)/c ', DOTP(STARdt,b_nought)/VLIGHT 
!      write(6,8)' K_dotw2w1, dK_dotw2w1 ', K_dotw2w1/VLIGHT, dK_dotw2w1/VLIGHT
!*     write(6,8)' DATMC  ', DATMC
!      write(6,8)' DATMC*K_dotw2w1/c ', DATMC(1,1)*K_dotw2w1/VLIGHT
!      write(6,8)'S: tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
!*     write(6,8)' tg2_tg1,dtg2_tg1+atm:', tg2_tg1+DATMC(1,1)+DATMC(2,1), &
!*   &             dtg2_tg1+DATMC(1,2)+DATMC(2,2) 
!
!
!     IF(KTHED .ne. 0) Then               ! Debug
!      write(6,'(/,15x,"Step 8 dump:")')
!      write(6,8)' w2_w1, a2_a1   ',w2_w1, a2_a1
!      write(6,8)' K_dotw2w1, dK_dotw2w1 ', K_dotw2w1, dK_dotw2w1
!      write(6,8)' DATMC  ', DATMC
!      write(6,8)' tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
!     Endif                               ! Debug
!
!******************************************************************************
!  Step 9: Step 9 is to compute the total delay by adding in the "Best"
!          estimate of the troposphere propogation delay for each site.
!          Normally this will be done 'on the fly' in program SOLVE.
!          However, we add the Niell atmosphere term here if the atmosphere
!          flag, KATMC is 1. The default is not to add it.
!           [Geocenter station: DATMC(Nzero,1) and DATMC(Nzero,2) should
!            already be zero.]
!
!     IF(KATMC.eq.1) then
!        tg2_tg1  =  tg2_tg1 + DATMC(1,1) + DATMC(2,1)
!        dtg2_tg1 = dtg2_tg1 + DATMC(1,2) + DATMC(2,2)
!
!      IF(KTHED .ne. 0) Then               ! Debug
!       write(6,'(/,15x,"Step 9 dump:")')
!       write(6,8)'(KATMC=1:) tg2_tg1, dtg2_tg1 ', tg2_tg1, dtg2_tg1
!      Endif                               ! Debug
!
!     Endif
!
!
    8 FORMAT(A,4D25.16/(7X,5D25.16))
!
      RETURN
      END
!
!**********************************************************************
      SUBROUTINE TGRAV(GM, R0J,R1J,R2J,R10,R20, R0Jdt,R1Jdt,R2Jdt,      &
     &           R10dt,R20dt, DelTpN,DelTpNdt)
      IMPLICIT NONE
!
!  Subroutine to compute the gravitational deflection for a solar 
!   system body (Sun, Moon, planets)  on a near-field object.
!
!
!    1. GM - Gravitational constant times the mass of the gravitating
!            body.
      Real*8 GM, R0J, R1J, R2J, R10, R20, R0Jdt, R1Jdt, R2Jdt, R10dt,  &
     &       R20dt, DelTpN,DelTpNdt
      Real*8 term1a, term1b, term2a, term2b, term1adt, term1bdt,        &
     &       term2adt, term2bdt, term12, term12dt
!*
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - The velocity of light cubed. (m/sec)**3
!
!
      term1a   = R2J   + R0J   + R20
      term1adt = R2Jdt + R0Jdt + R20dt
!
      term1b   = R2J   + R0J   - R20
      term1bdt = R2Jdt + R0Jdt - R20dt 
!
      term2a   = R1J   + R0J   - R10
      term2adt = R1Jdt + R0Jdt - R10dt 
!
      term2b   = R1J   + R0J   + R10
      term2bdt = R1Jdt + R0Jdt + R10dt 
!
      term12 = (term1a/term1b) * (term2a/term2b)
      term12dt = (term1adt/term1b) * (term2a/term2b) -                  &
     &           (term1a*term1bdt)/(term1b**2) * (term2a/term2b) +      &
     &           (term1a/term1b) * (term2adt/term2b) -                  &
     &           (term1a/term1b) * (term2a*term2bdt)/(term2b**2)
!
!     DelTpN = (2.D0*GM/VLIGHT3) * DLOG ( ((R2J+R0J+R20)/(R2J+R0J-R20)) &
!            * ((R1J+R0J+R10)/(R1J+R0J-R10)) )
!
      DelTpN = (2.D0*GM/VLIGHT3) * DLOG (term12)
      DelTpNdt = (2.D0*GM/VLIGHT3) * (1.D0/term12)*term12dt
!
      RETURN
      END
!
!**********************************************************************
      Subroutine DUEV (DATMC, SITEP, SITEV, SITEA, SUN, T0_T1,          &
     &      EARTH, XMOON, UTC, TT, TDB, TDBg, td2_td1, dtd2_td1)
!
      IMPLICIT NONE
      REAL*8 DATMC(2,2), SUN(3,2), EARTH(3,3), SITEA(3,2), SITEP(3,2),  &
     &       SITEV(3,2), DOTP, VECMG, UTC, TT, TDB, TDBg, XMOON(3,2)
      Real*8 T0_T1, td2_td1, dtd2_td1
      Real*8 U, dU, U_Sun, Vecmg1, F1, VdotR1, VdotR2, VdotNFO,         &
     &       del_T0, gm1, RLT_01, R_01mag, R0sunT0mag, R1sunT1mag,      &
     &       T1_T0, ddel_T0, R01sunmag
      Real*8 VsubEarth(3), R_Earth_Sun(3), V_Earth_Sun(3), R1_T1(3),    &
     &       R2_T1(3), R0_T0(3), dR0_T0(3), R_01(3), delSun0(3),        &
     &       SUN_0(3), R0sunT0(3), R1sunT1(3), Rb_01(3), dR0(3),        &
     &       R1(3), EARTH_0(3), RsunT0(3), RsunT1(3), R01sun(3)
      Real*8 R_02(3), Site2(3), R2_T2(3), SunT2(3), EarthT2(3),         &
     &       RsunT2(3), R2sunT2(3), R02sun(3)
      Real*8 T2_T0, del_T2, R2_T2mag, R_02mag, R2sunT2mag, R02sunmag,   &
     &       RLT_02, ddel_T2
      Real*8 T2_T1, VEsq, UE, B(3), VEdotB, VEdotV2
      Real*8 delMoon0(3),MOON_0(3),RmoonT0(3),R0moonT0(3),R0moonT0mag,  &
     &       RmoonT1(3),R1moonT1(3),R1moonT1mag,R01moon(3),R01moonmag,  &
     &       RLT_01s,RLT_01m,RLT_01p,delpl(3),Spl_0(3),R0planT0(3),     &
     &       R0planT0mag,R1planT1(3),R1planT1mag,R01plan(3),R01planmag, &
     &       RLTp(7)
      Real*8 MoonT2(3),RmoonT2(3),R2moonT2(3),R2moonT2mag,R02moon(3),   &
     &       R02moonmag,RLT_02s,RLT_02m,RLT_02p,Spl_2(3),R2planT2(3),   &
     &       R2planT2mag,R02plan(3),R02planmag
      Real*8 delEarth0(3), REarthT0(3), R0earthT0(3), R0earthT0mag,     &
     &       RearthT1(3), R1earthT1(3), R1earthT1mag, R01earth(3),      &
     &       R01earthmag, RLT_01e, RearthT2(3), R2earthT2(3),           &
     &       R2earthT2mag, R02earth(3), R02earthmag, RLT_02e,           &
     &       delearth2(3), delSun2(3), delmoon2(3)
      Integer*4 I, J, K
!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) - Geocentric satellite position at T0 (meters). 
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - THE VELOCITY OF LIGHT IN VACUUM CUBED.
!                         (M**3/SEC**3)
!            4. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!
      INCLUDE 'csolsys11.i'
!       Variables 'from':
!         1. SPLANET(3,2,7) - The J2000.0 Solar System Barycentric positions
!                             and velocities of all planets except the Earth
!                             and Pluto. (meters, meters/sec) The first index
!                             runs over X,Y, and Z, the second runs over
!                             position and velocity, and the third runs over
!                             the planets, where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                             of all planets except the Earth and Pluto.
!                             (meters, meters/sec) The first index runs over
!                             X,Y, and Z, the second runs over position and
!                             velocity, and the third runs over the planets,
!                             where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         3. SUNb(3,2)      - J2000 Barycentric Sun position and velocity.
!         4. MOONb(3,2)     - J2000 Barycentric Moon position and velocity.
!
!   Convert spacecraft and site vectors from TT to TDB  
       Do I = 1, 3
        VsubEarth(I) = EARTH(I,2)      !  SSBC Earth Velocity
        R_Earth_Sun(I)  = -SUN(I,1)    !  Vector from Sun to Earth
        V_Earth_Sun(I)  = -SUN(I,2)    !  Velocity of Earth w.r.t. the Sun
       Enddo
! 
!       Sun's potential:
       U_Sun  = GMSUN/VLIGHT2
       vecmg1 = VECMG(R_Earth_Sun)
       U      = U_Sun/vecmg1
!   Derivative:
!      dU = -U_Sun * Dotp(R_Earth_Sun,V_Earth_Sun) / vecmg1**3
       F1 = 1.D0 - U - 1.48082686741D-8
!
        VdotR1 = DOTP(VsubEarth,SITEP(1,1))
!       VdotR2 = DOTP(VsubEarth,SITEP(1,2))
        VdotNFO = DOTP(VsubEarth,SPpxyz)
!
!   Barycentric TDB vectors: (Duev equation 4)
       Do I = 1,3
        R1_T1(I) = SITEP(I,1)*F1 - 0.5D0*(VdotR1/VLIGHT2)*VsubEarth(I)  &
     &             + EARTH(I,1)
        R2_T1(I) = SITEP(I,2)*F1 - 0.5D0*(VdotR2/VLIGHT2)*VsubEarth(I)  &
     &             + EARTH(I,1)
       Enddo
!       write(6,*) 'site1,R1_T1: ', SITEP(1,1),SITEP(2,1),SITEP(3,1),R1_T1
!       write(6,*) 'site2,R2_T1: ', SITEP(1,2),SITEP(2,2),SITEP(3,2),R2_T1
!
!  Initial estimate for (T1 - T0)
      CALL VECSB (SPpxyz, SITEP(1,1), R_01)
       R_01mag   = VECMG(R_01)
       del_T0 = VECMG(R_01)/VLIGHT 
!       write(6,*) 'DUEV: T0_T1, Initial del_T0 ', T0_T1, del_T0
!
       gm1 = 2.D0*GMSUN/VLIGHT2
!
! Three iterations should be enough 
      DO J = 1,3   
        Do I = 1,3    ! Barycentric at T1 - del_T0
         R0_T0(I) = SPpxyz(I)*F1 - 0.5D0*(VdotNFO/VLIGHT2)*VsubEarth(I) &
     &              + (EARTH(I,1) - del_T0*EARTH(I,2)) -                &
     &     SPvxyz(I)*(T0_T1 - del_T0)
        Enddo
!
! Barycentric vectors
       Call VECSB(R1_T1, R0_T0, R_01)      ! equation 15
        R_01mag = VECMG(R_01)
!!!      write(6,*) 'R_01,R_01mag: ', R_01,R_01mag
!
       CALL VECMU(SUNb(1,2),del_T0,delSun0)
       CALL VECSB(SUNb(1,1), delSun0, RsunT0) 
!               write(6,*) 'new RsunT0: ', RsunT0 
       CALL VECSB (R0_T0, RsunT0, R0sunT0)          ! eqn 16, Sun to spacecraft at T0
        R0sunT0mag = VECMG(R0sunT0)
!!!      write(6,*) 'R0sunT0,R0sunT0mag: ', R0sunT0,R0sunT0mag 
!
       CALL VECMU(MOONb(1,2),del_T0,delMoon0)
       CALL VECSB(MOONb(1,1), delMoon0, RmoonT0) 
!               write(6,*) 'new RmoonT0: ', RmoonT0 
       CALL VECSB (R0_T0, RmoonT0, R0moonT0)          ! eqn 16, Moon to spacecraft at T0
        R0moonT0mag = VECMG(R0moonT0)
!
       CALL VECMU(EARTH(1,2),del_T0,delEarth0)
       CALL VECSB(EARTH(1,1), delMoon0, REarthT0) 
       CALL VECSB (R0_T0, RearthT0, R0earthT0)          ! eqn 16, Earth to spacecraft at T0
        R0earthT0mag = VECMG(R0earthT0)
!               write(6,*) 'RearthT0: ', RearthT0 
!               write(6,*) 'R0earthT0: ', R0earthT0 
!               write(6,*) 'R0earthT0mag: ', R0earthT0mag 
       CALL VECEQ(EARTH(1,1),RearthT1) 
!              write(6,*) 'RearthT1: ', RearthT1 
       CALL VECSB(R1_T1, RearthT1, R1earthT1)   ! eqn 16, Earth to site 1 at T1
       R1earthT1mag = VECMG(R1earthT1)
!              write(6,*) 'R1earthT1: ', R1earthT1 
!              write(6,*) 'R1earthT1mag: ', R1earthT1mag 
       CALL VECSB (R1earthT1,R0earthT0,R01earth) ! eqn 17, Earth
       R01earthmag = VECMG(R01earth)
!              write(6,*) 'R01earth: ', R01earth 
!              write(6,*) 'R01earthmag: ', R01earthmag 
!
       CALL VECEQ(SUNb(1,1),RsunT1) 
!              write(6,*) 'new RsunT1: ', RsunT1 
       CALL VECSB(R1_T1, RsunT1, R1sunT1)   ! eqn 16, Sun to site 1 at T1
       R1sunT1mag = VECMG(R1sunT1)
!!!      write(6,*) 'R1sunT1,R1sunT1mag: ', R1sunT1,R1sunT1mag 
!
       CALL VECEQ(MOONb(1,1),RmoonT1) 
!              write(6,*) 'new RmoonT1: ', RmoonT1 
       CALL VECSB(R1_T1, RmoonT1, R1moonT1)   ! eqn 16, Moon to site 1 at T1
       R1moonT1mag = VECMG(R1moonT1)
!
       CALL VECSB (R1sunT1,R0sunT0,R01sun) ! eqn 17, Sun 
       R01sunmag = VECMG(R01sun)
!!!      write(6,*) 'R01sun,R01sunmag: ', R01sun,R01sunmag 
       CALL VECSB (R1moonT1,R0moonT0,R01moon) ! eqn 17, Moon
       R01moonmag = VECMG(R01moon)
!  Sun:
        RLT_01s = (2.D0*GMSUN/VLIGHT3) * DLOG( (R0sunT0mag + R1sunT1mag  &
     &  + R01sunmag + gm1)/(R0sunT0mag + R1sunT1mag - R01sunmag + gm1) )
!  Moon:
        RLT_01m = (2.D0*GMMOON/VLIGHT3) * DLOG( (R0moonT0mag + R1moonT1mag  &
     &  + R01moonmag)/(R0moonT0mag + R1moonT1mag - R01moonmag) )
!       write(6,*) 'RLT_01s, RLT_01m ', RLT_01s,RLT_01m
!
!  Earth:  (Contribution is zero at the geocenter)
!       RLT_01e = (2.D0*GMEarth/VLIGHT3) * DLOG( (R0earthT0mag + R1earthT1mag  &
!    &  + R01earthmag)/(R0earthT0mag + R1earthT1mag - R01earthmag) )
!       write(6,*) 'RLT_01s ', RLT_01s
!       write(6,*) 'RLT_01m ', RLT_01m
!       write(6,*) 'RLT_01e ', RLT_01e
!
! Planets:
        RLT_01p = 0.0D0 
!       write(6,*) 'J, del_T0', J,del_T0
       Do K = 1,7
        Call VECMU(SPLANET(1,2,K),del_T0,delpl)  
        CALL VECSB(SPLANET(1,1,K), delpl, Spl_0)  ! SSBC planet vector at T0
        CALL VECSB(R0_T0, Spl_0, R0planT0)        ! Planet to spacecraft at T0
        R0planT0mag = VECMG(R0planT0)
!
        CALL VECSB(R1_T1,SPLANET(1,1,K), R1planT1) ! Planet to site 1 at T1
        R1planT1mag = VECMG(R1planT1)
!
        CALL VECSB(R1planT1, R0planT0, R01plan)    ! ~Planet-to-site1
        R01planmag = VECMG(R01plan)
!
        RLTp(K) =  (2.D0*GMPLANET(K)/VLIGHT3) *                         &
     &             DLOG( (R0planT0mag + R1planT1mag + R01planmag) /     &
     &                   (R0planT0mag + R1planT1mag - R01planmag) )
        RLT_01p = RLT_01p + RLTp(K)
       Enddo
!
        RLT_01 = RLT_01s + RLT_01m + RLT_01p 
        T1_T0 = R_01mag/VLIGHT + RLT_01
        ddel_T0 = T1_T0 - del_T0
        del_T0 = T1_T0
!        write(6,*) 'J,RLT_01, del_T0: ', J, RLT_01, del_T0
!
      Enddo
!
! Now find (T2 - T0):
!  Initial estimate for (T2 - T0)
       Call VECSB(R2_T1, R0_T0, R_02)
        T2_T0 = VECMG(R_02)/VLIGHT
        del_T2 = T1_T0 - T2_T0      ! difference from T1
!        write(6,*) 'R_02,T2_T0,del_T2: ', R_02,T2_T0,del_T2 
!
      DO J = 1,3   ! Three iterations ????
!   Barycentric TDB vectors:
       Do I = 1,3
        Site2(I) = SITEP(I,2) - SITEV(I,2)*del_T2    ! Site 2 at T2
        VdotR2 = DOTP(VsubEarth,Site2)
        R2_T2(I) = Site2(I)*F1 - 0.5D0*(VdotR2/VLIGHT2)*VsubEarth(I)  &
     &             + (EARTH(I,1) - del_T2*EARTH(I,2))       ! SSBC Site2 vector @ T2
       Enddo
        R2_T2mag = VECMG(R2_T2)
!       write(6,*) 'SITEP2,Site2:', SITEP(1,2),SITEP(2,2),SITEP(3,2),Site2
!       write(6,*) 'R2_T2,R2_T2mag:', R2_T2,R2_T2mag 
!
       Call VECSB(R2_T2, R0_T0, R_02)    ! eqn 15; Site2 to NFO
        R_02mag = VECMG(R_02)
!
       CALL VECMU(SUNb(1,2),del_T2,delSun2)
       CALL VECSB(SUNb(1,1), delSun2, RsunT2)
       CALL VECSB (R2_T2, RsunT2, R2sunT2)          ! eqn 16, Sun to site 2 at T2
        R2sunT2mag = VECMG(R2sunT2)
!         write(6,*) 'new RsunT2: ', RsunT2
!         write(6,*) 'new R2sunT2mag: ', R2sunT2mag
       CALL VECSB (R2sunT2,R0sunT0,R02sun) ! eqn 17, Sun 
       R02sunmag = VECMG(R02sun)
!         write(6,*) 'new R02sun,R02sunmag: ', R02sun,R02sunmag 
!
       CALL VECMU(MOONb(1,2),del_T2,delmoon2)
       CALL VECSB(MOONb(1,1), delmoon2, RmoonT2)
       CALL VECSB (R2_T2, RmoonT2, R2moonT2)          ! eqn 16, Moon to site 2 at T2
        R2moonT2mag = VECMG(R2moonT2)
!         write(6,*) 'new R2moonT2: ', R2moonT2
!         write(6,*) 'new R2moonT2mag: ', R2moonT2mag
       CALL VECSB (R2moonT2,R0moonT0,R02moon) ! eqn 17, Moon
       R02moonmag = VECMG(R02moon)
!         write(6,*) 'new R02moon,R02moonmag: ', R02moon,R02moonmag 
!
        CALL VECMU(EARTH(1,2),del_T2,delearth2)
        CALL VECSB(EARTH(1,1), delearth2, RearthT2)
!!               write(6,*) 'new RearthT2: ', earthRT2
        CALL VECSB (R2_T2, RearthT2, R2earthT2)          ! eqn 16, Earth to site 2 at T2
         R2earthT2mag = VECMG(R2earthT2)
!            write(6,*) 'R2earthT2mag: ', R2earthT2mag
        CALL VECSB (R2earthT2,R0earthT0,R02earth) ! eqn 17, Earth
        R02earthmag = VECMG(R02earth)
!!              write(6,*) 'R02earth: ', R02earth
!               write(6,*) 'R02earthmag: ', R02earthmag
!
       RLT_02s = (2.D0*GMSUN/VLIGHT3) * DLOG((R0sunT0mag + R2sunT2mag    &
     &  + R02sunmag + gm1)/(R0sunT0mag + R2sunT2mag - R02sunmag + gm1) )
       RLT_02m = (2.D0*GMMOON/VLIGHT3) * DLOG((R0moonT0mag + R2moonT2mag    &
     &  + R02moonmag)/(R0moonT0mag + R2moonT2mag - R02moonmag) )
!      write(6,*) 'RLT_02s, RLT_02m', RLT_02s, RLT_02m
       RLT_02e = (2.D0*GMEarth/VLIGHT3) * DLOG( (R0earthT0mag + R2earthT2mag  &
     &  + R02earthmag)/(R0earthT0mag + R2earthT2mag - R02earthmag) )
!       write(6,*) 'RLT_02s ', RLT_02s
!       write(6,*) 'RLT_02m ', RLT_02m
!       write(6,*) 'RLT_02e ', RLT_02e
!
! Planets:
        RLT_02p = 0.0D0 
       Do K = 1,7
        Call VECMU(SPLANET(1,2,K),del_T0,delpl)  
        CALL VECSB(SPLANET(1,1,K), delpl, Spl_0)  ! SSBC planet vector at T0
        CALL VECSB(R0_T0, Spl_0, R0planT0)        ! Planet to spacecraft at T0
        R0planT0mag = VECMG(R0planT0)
!
        Call VECMU(SPLANET(1,2,K),del_T2,delpl)  
        CALL VECSB(SPLANET(1,1,K), delpl, Spl_2)  ! SSBC planet vector at T2
        CALL VECSB(R2_T2,Spl_2,          R2planT2) ! Planet to site 2 at T2
        R2planT2mag = VECMG(R2planT2)
!
        CALL VECSB(R2planT2, R0planT0, R02plan)    ! ~Planet-to-site2
        R02planmag = VECMG(R02plan)
!
        RLTp(K) =  (2.D0*GMPLANET(K)/VLIGHT3) *                         &
     &             DLOG( (R0planT0mag + R2planT2mag + R02planmag) /     &
     &                   (R0planT0mag + R2planT2mag - R02planmag) )
        RLT_02p = RLT_02p + RLTp(K)
       Enddo
!       write(6,*) 'RLT_02p ', RLT_02p
!
       RLT_02 = RLT_02s + RLT_02m + RLT_02e + RLT_02p
!       write(6,*) 'RLT_02 ', RLT_02
        T2_T0 = R_02mag/VLIGHT + RLT_02
        ddel_T2 = T2_T0 - (T1_T0 - del_T2)
        del_T2 = T1_T0 - T2_T0 
!
!      write (6,*) 'del_T2, T2-T1: ', del_T2, (T2_T0 - T1_T0)
      Enddo
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Convert to TT frame, Duev equation 20.
!
      T2_T1 = T2_T0 - T1_T0     ! Vacuum delay in TDB frame
      VEsq = DOTP(VsubEarth,VsubEarth)      ! Square of Earth's SSBC velocity
      UE = GMSUN/vecmg1                     ! Newtonian potential, Sun only
      Call VECSB(SITEP(1,2),SITEP(1,1),B)   ! Geocentric baseline vector
      VEdotB = DOTP(VsubEarth,B)            ! Earth SSB velocity * Baseline
      VEdotV2 = DOTP(VsubEarth,SITEV(1,2))  ! Earth SSB velocity * Site2 geocentric velocity
!
      td2_td1 =  ( (T2_T1/(1.D0-1.48082686741D-8)) *                    &
     &   ( 1.D0 - (VEsq/2.D0 + UE)/VLIGHT2 ) - VEdotB/VLIGHT2 ) /       &
     &   (1.D0 + VEdotV2/VLIGHT2) 

!      write (6,*) 'Duev: td2_td1: ', td2_td1
!
!        STOP
!
      RETURN
      END
!
!**********************************************************************
!
      Subroutine  RANGE (DATMC, SITEP, SITEV, SITEA, SUN, T0_T1,        &
     &      R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag, R2magdt,         &
     &      tr2_tr1, dtr2_tr1)
      IMPLICIT NONE
!
      REAL*8 DATMC(2,2), SUN(3,2), EARTH(3,3), SITEA(3,2), SITEP(3,2),  &
     &       SITEV(3,2), DOTP, VECMG
      Real*8 R1(3), R2(3), R1dt(3), R2dt(3), R1mag, R2mag, R1magdt,     &
     &       R2magdt, T0_T1, tr2_tr1, dtr2_tr1
      Real*8 SunNFO(3), del2(3), Site2(3),x2x0(3), rsun2(3), vecx2x0(3) 
      Real*8 G2sunV3, rsun0mag, rsun1mag, rsun2mag, x1x0mag, x2x0mag,   &
     &       xlog1, xlog2, t1t0, t2t0, t1t2, t1t2_old, G2EarthV3,       &
     &       xEx0mag, Site2mag, tgrav, tgravSun, tgravEarth
      Integer*4 J
!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) - Geocentric satellite position (meters). 
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - THE VELOCITY OF LIGHT IN VACUUM CUBED.
!                         (M**3/SEC**3)
!            4. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!
!   From IERS Conventions (2010), section 11.2.
!
!  2*GMsun/VLIGHT3
       G2sunV3 = 2.D0*GMSUN/VLIGHT3
       Call VECSB(SPpxyz,SUN(1,1),SunNFO)
       rsun0mag = VECMG(SunNFO)
       rsun1mag = VECMG(SUN(1,1))
       x1x0mag  = VECMG(R1)
       xlog1 = rsun0mag + rsun1mag + x1x0mag
       xlog2 = rsun0mag + rsun1mag - x1x0mag
       tgravSun = G2sunV3 * DLOG(xlog1/xlog2)
!
       G2EarthV3 = 2.D0*GMEARTH/VLIGHT3
       xEx0mag = VECMG(SPpxyz)
       xlog1 = xEx0mag + xEx0mag
       xlog2 = xEx0mag - xEx0mag
!      tgravEarth = G2EarthV3 * DLOG(xlog1/xlog2)
       tgravEarth =  0.D0   ! zero at geocenter
!
!   Delay from NFO to site1 (geocenter)
!      t1t0 = R1mag/VLIGHT + tgravEarth + tgravSun
       t1t0 = R1mag/VLIGHT + tgravEarth
!      write(6,*) 'tgravSun,tgravEarth ', tgravSun,tgravEarth
!
       t1t2 = 0.D0
      Do J = 1,4
         t1t2_old = t1t2
       Call VECMU(SITEV(1,2),t1t2,del2)   ! del2 = vector correction to site2 position
       Call VECSB(SITEP(1,2),del2,Site2)  ! Site2 = site2 retarded position
       Call VECSB(Site2,SPpxyz,vecx2x0)
       x2x0mag = VECMG(vecx2x0)
       Call VECSB(Site2,SUN(1,1),rsun2)
       rsun2mag = VECMG(rsun2)
!
       xlog1 = rsun0mag + rsun2mag + x2x0mag
       xlog2 = rsun0mag + rsun2mag - x2x0mag
        tgravSun = G2sunV3 * DLOG(xlog1/xlog2)
!
       Site2mag = VECMG(Site2)
       xlog1 = xEx0mag + Site2mag + x2x0mag
       xlog2 = xEx0mag + Site2mag - x2x0mag
       tgravEarth = G2EarthV3 * DLOG(xlog1/xlog2)
!
!      t2t0 = x2x0mag/VLIGHT + tgravEarth + tgravSun
       t2t0 = x2x0mag/VLIGHT + tgravEarth 
       t1t2 = t1t0 - t2t0
!      write(6,*) 'J,t1t0,t2t0,t1t2,t1t2_old,tgravSun,tgravEarth ', J,t1t0,t2t0,t1t2,t1t2_old,tgravSun,tgravEarth
      Enddo
!      write(6,*) 'tgravSun,tgravEarth ', tgravSun,tgravEarth
!
      tr2_tr1 = t2t0 - t1t0
!
      Return
      End
!**********************************************************************
      SUBROUTINE SEKIDOewns (Datmc_h_EWNS, Datmc_w_EWNS, EARTH, EPBASE, &
     &           SITEP, SITEV, SITEA, SUN, XMOON, T0_T1 )
      IMPLICIT NONE
!
!     Routine SEKIDO computes the theoretical values of delay and delay 
!     rate  using the Sekido and Fukushima near-field model.
!
!       Reference: M. Sekido and T. Fukushima, 'A VLBI delay model for
!                  radio sources at a finite distance', J. Geodesy, 
!                  vol. 80, pp. 137-149, 2006.
!
!      Input Variables:
!         1.  DATMC(2,2)   -  The contributions to the delay and delay rate due
!                             to tropospheric refraction at each site. (s, s/s)
!         2.  EARTH(3,3)   -  The solar system barycentric Earth position,
!                             velocity, and acceleration vectors. The first
!                             index runs over the vector components and the
!                             second runs over the time derivatives.
!                             (m, m/sec, m/sec**2)
!         3.  EPBASE(3,2)  -  The J2000.0 baseline position and velocity
!                             vectors.  (m, m/sec)
!         4.  SITEP(3,2)   -  The J2000.0 geocentric position vectors of each
!                             observing site. (m)
!         5.  SITEV(3,2)   -  The J2000.0 geocentric velocity vectors of each
!                             observing site. (m/sec)
!         6.  SITEA(3,2)   -  The J2000.0 geocentric acceleration vectors of
!                             each observing site. (m/sec**2)
!         7.  SUN(3,2)     -  The J2000.0 geocentric Sun position and velocity
!                             vectors.  (m, m/sec)
!         8.  XMOON(3,2)   -  The J2000.0 geocentric Moon position and velocity
!                             vectors.  (m, m/sec)
!         9.  STAR(3)      -  The J2000.0 source unit vector. (unitless)
!
!      Output Variables:
!         1. tg2_tg1ewns(4) - The geometric delay corrected for relativistic
!                             effects (but not atmospheric refraction) using
!                             the Consensus model.
!         2. dtg2_tg1      -  The time derivative of the geometric delay
!                             corrected for relativistic effects using the
!                             Consensus model.
!         3. delta_t_grav  -  The total differential gravitational time delay,
!                             or "bending delay" from the Consensus model.
!         4. d_delta_t_grav-  The time derivative of the total differential
!                             gravitational time delay, or "bending delay" from
!                             the Consensus model.
!         5. delta_t_grav_Sun-The Sun's contribution to the "bending delay"
!                             from the Consensus model. Now includes
!                             Sunplus(1).
!         6. d_delta_t_grav_Sun-The time derivative of the Sun's contribution
!                             to the "bending delay" from the Consensus model.
!                             Now includes Sunplus(2).
!         7. Con_part      -  Partial derivatives of the Consensus delays and
!                             rates with respect to Gamma.
!         8. Sunplus(2)    -  Higher order solar bending delay and rate
!                             contributions, as defined in IERS Conventions
!                             (1996), page 91, eqn. 14. (sec, sec/sec) It
!                             has also been added to the total solar bending
!                             delay and rate contibutions.
!         9. Bend_par(2)   -  The relativistic bending delay and rate partials
!                             with respect to Gamma. (sec, sec/sec)
!
!     Common blocks used -
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - The velocity of light cubed. (m/sec)**3
!            4. GAMMA   - The post Newtonian expansion parameter which
!                         affects light bending. (1.0 used here). (unitless)
!            5. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!            6. REARTH  - The equatorial radius of the Earth. (meters)
!
      INCLUDE 'csolsys11.i'
!       Variables 'from':
!         1. SPLANET(3,2,7) - The J2000.0 Solar System Barycentric positions
!                             and velocities of all planets except the Earth
!                             and Pluto. (meters, meters/sec) The first index
!                             runs over X,Y, and Z, the second runs over
!                             position and velocity, and the third runs over
!                             the planets, where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                             of all planets except the Earth and Pluto.
!                             (meters, meters/sec) The first index runs over
!                             X,Y, and Z, the second runs over position and
!                             velocity, and the third runs over the planets,
!                             where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
       INCLUDE 'ccon.i'
!            Variables 'from':
!              1.  KTHEC  -  The Theory routine flow control flag.
!                            (No longer has any function.)
!              2.  KTHED  -  The theory routine debug control flag.
!              3.  KRELC  -  The relativity module flow control flag.
!                            0     --> Gravitational bending used.
!                            NOT 0 --> Gravitational bending not used.
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      INCLUDE 'put2s.i'
!       Variables from:
!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) -  
!          2. SPpvyz(3) -  
!
      Real*8 SpEWNS(3,4), R1EWNS(3,4), R2EWNS(3,4), R1EWNSmag(4),       &
     &       R2EWNSmag(4), STAR12EWNS(3,4,2), STARewns(3,4)
      Common / NFewns/ SpEWNS, R1EWNS, R2EWNS, R1EWNSmag, R2EWNSmag,    &
     &       STAR12EWNS, STARewns
!
!
!   Program Specifications -
      REAL*8 SUN(3,2), EARTH(3,3), EPBASE(3,2), SITEA(3,2), SITEP(3,2), &
     &       SITEV(3,2), XMOON(3,2), DOTP, VECMG, Datmc_h_EWNS(4),      &
     &       Datmc_w_EWNS(4), T0_T1
      Real*8 XsubEarth(3), VsubEarth(3), AsubEarth(3)
      Real*8 x_sub1t1(3), x_sub2t1(3), w_sub1(3), w_sub2(3)
!     Real*8 a_sub1(3), a_sub2(3)
      Real*8 unit_K(3), b_nought(3),db_nought(3), unitK1(3)
      Real*8 x_subSun(3), x_subMoon(3), v_subSun(3), v_subMoon(3)
      Real*8 XsubSun(3), XsubMoon(3), VsubSun(3), VsubMoon(3)
      Real*8 R_Earth_Sun(3), R_Earth_Moon(3)
      Real*8 V_Earth_Sun(3), V_Earth_Moon(3)
      Real*8 Xsub1(3), Xsub2(3), t_sub1, t_sub2
      Real*8 dXsub1(3), dXsub2(3)
      Real*8 x1Sun(3), x1Moon(3), x1Planet(3,7)
      Real*8 del_t_Sun, del_t_Moon, del_t_Planet(7)
      Real*8 XSunt1J(3), XMoont1J(3), XPlant1J(3,7)
!     Real*8 dXSunt1J(3), dXMoont1J(3), dXPlant1J(3,7)
      Real*8 R1Sunt1(3), R1Moont1(3), R1Plant1(3,7)
      Real*8 R2Sunt1(3), R2Moont1(3), R2Plant1(3,7)
!     Real*8 dR1Sunt1(3), dR1Moont1(3), dR1Plant1(3,7)
!     Real*8 dR2Sunt1(3), dR2Moont1(3), dR2Plant1(3,7)
      Real*8 delta_t_grav, delta_t_grav_Sun, delta_t_grav_Moon,         &
     &       delta_t_grav_Earth, delta_t_grav_Plan(7),                  &
     &       delta_t_grav_Planets
!     Real*8 d_delta_t_grav, d_delta_t_grav_Sun, d_delta_t_grav_Moon,   &
!    &       d_delta_t_grav_Earth, d_delta_t_grav_Plan(7),              &
!    &       d_delta_t_grav_Planets
      Real*8 delgrav_Sun,ddelgrav_Sun, delgrav_Moon, ddelgrav_Moon,     &
     &       delgrav_Plan(7), ddelgrav_Plan(7), delgrav, ddelgrav,      &
             delgrav_Earth, ddelgrav_Earth
      Real*8 U, U_Sun, dU, absVEarth
      Real*8 C_Earth, C_Sun, C_Moon, C_Plan(7)
      Real*8 term_a, term_b, term_c, term_d, term_e, term_f,            &
     &       term_g, term_h, term_a1, term_b1, term_g1, term_h1
!     Real*8 dterm_a, dterm_b, dterm_c, dterm_d, dterm_e, dterm_f,      &
!    &       dterm_g, dterm_h, dterm_a1, dterm_b1, dterm_g1, dterm_h1
      Real*8 term1, term2a, term2b, term2c, term2d, term2,              &
     &       term2bcd, term3a, term3b, term3, term4,                    &
     &       term123, vec_sum(3), tv2_tv1
!     Real*8 dterm1, dterm2a, dterm2b, dterm2c, dterm2d, dterm2,        &
!    &       dterm2bcd, dterm3a, dterm3b,  dterm3, dterm4,              &
!    &       dterm123, dvec_sum(3), dtv2_tv1
      Real*8 V_w1(3), V_w2(3), K_V_w1, K_V_w2           !!
      Real*8 tg2_tg1ewns(4)
      Real*8 w2_w1(3), a2_a1(3), K_dotw2w1, dK_dotw2w1
!     Real*8 k_sub1(3), k_sub2(3)
      Real*8 KdotB, dKdotB, VdotB, dVdotB, KdotV, dKdotV
      Real*8 delta_t2_t1, d_delta_t2_t1, term10a, term10b, term10c,     &
     &       dterm10a, dterm10b, dterm10c, del_del_t(2,2)
      Real*8 x_delta_t2_t1, dx_delta_t2_t1
      Real*8 vecmg1, vecmg2, vecmg0, dvecmg0
      Real*8 N_hat(3), dN_hat(3), Vmag_S, CSun1, NplusK(3), V1, dV1
!!   &       V2, dV2
      Real*8 R0sun(3), dR0sun(3), R1J, R2J, R10, R20, R0J,              &
     &       delTpNsun, R0moon(3), dR0moon(3), delTpNmoon, R0plan(3,7), &
     &       dR0plan(3,7), delTpNPlan(7), delTpN, Vec3c(3),             &
     &       term3c, term4a, H, H1(3), H2, H3, dH1a(3), dH1b(3),dH1(3), &
     &       dH2, dH3, dH, V2(3), dV2(3), dVec3c(3), dterm3c, dterm4a
      Real*8 dR1J, dR2J, dR10, dR20, dR0J, GMp, DelTpNPl, DelTpNPldt,   &
     &       delTpNsundt, DelTpNmoondt, DelTpNPlandt(7), delTpNdt
      Real*8 VsubEart0(3), AsubEart0(3)
      INTEGER*4 I, L, K, N
!
!   Program variables -
!
!    1.  XsubEarth(3)  =  Barycentric radius vector of the geocenter (meters).
!    2.  VsubEarth(3)  =  Barycentric velocity vector of the geocenter (m/sec).
!    3.  AsubEarth(3)  =  Barycentric acceleration of the geocenter (m/sec**2).
!
!    4.  x_sub1t1(3)   =  Geocentric radius vector of receivers 1 and 2 at the
!    5.  x_sub2t1(3)        geocentric time t_sub1 (meters).
!
!    6.  w_sub1(3)     =  Geocentric velocity of receiver 1 (m/sec).
!    7.  w_sub2(3)     =  Geocentric velocity of receiver 2 (m/sec).
!
!    8.  a_sub1(3)     =  Geocentric acceleration of receiver 1 (m/sec).
!    9.  a_sub2(3)     =  Geocentric acceleration of receiver 2 (m/sec).
!
!   10.  x_subSun(3)   =  Geocentric radius vector of the Sun (meters).
!   11.  x_subMoon(3)  =  Geocentric radius vector of the Moon (meters).
!   12.  GPLANET(l,1,k)=  Geocentric radius vectors of the planets (meters).
!                          (l = X,Y,Z; k = planet #)
!
!   13.  v_subSun(3)   =  Geocentric velocity vector of the Sun (m/sec).
!   14.  v_subMoon(3)  =  Geocentric velocity vector of the Moon (m/sec).
!   15.  GPLANET(l,2,k)=  Geocentric velocity vector of the planets (m/sec).
!                          (l = X,Y,Z; k = planet #)
!
!   16.  Xsub1(3)      =  Barycentric radius vector of receiver 1 (meters).
!   17.  Xsub2(3)      =  Barycentric radius vector of receiver 2 (meters).
!   18.  dXsub1(3)     =  Barycentric velocity vector of receiver 1 (m/sec).
!   19.  dXsub2(3)     =  Barycentric velocity vector of receiver 2 (m/sec).
!
!   20.  x1Sun(3)      =  Vector from receiver 1 to the Sun at time t_sub1
!   21.  x1Moon(3)     =  Vector from receiver 1 to the Moon at time t_sub1
!   22.  x1Planet(3,7) =  Vector from receiver 1 to the planets at time t_sub1
!
!   23.  XsubSun(3)    =  Barycentric radius vector of the Sun/Moon/planets
!   24.  XsubMoon(3)
!   25.  SPLANET(l,1,k)
!
!   26.  VsubSun(3)    =  Barycentric velocity vector of the Sun/Moon/planets
!   27.  VsubMoon(3)
!   28.  SPLANET(l,2,k)
!
!   29.  XSunt1J(3)    =  SSBC radius vector to the Sun/Moon/planets
!   30.  XMoont1J(3)         at the time of closest approach.
!   31.  XPlant1J(3,7)              (meters)
!
!   32.  R_Earth_Sun(3) = Vector from the Sun to the geocenter
!   33.  R_Earth_Moon(3)= Vector from the Moon to the geocenter
!   34.  -GPLANET(l,1,k)= Vector from planets to the geocenter
!
!   35.  V_Earth_Sun(3) = Velocity Vector of the geocenter from the Sun
!
!   36.  R1Sunt1(3)    =  Vector from the Sun/Moon/planets to receiver
!   37.  R1Moont1(3)   =      1 at the time of closest approach.
!   38.  R1Plant1(3,7) =                (meters)
!
!   39.  R2Sunt1(3)    =  Vector from the Sun/Moon/planets to receiver
!   40.  R2Moont1(3)   =      2 at the time of closest approach.
!   41.  R2Plant1(3,7) =              (meters)
!
!   42.  t_sub1        =  Time of arrival of the signal at receivers 1 and 2.
!   43.  t_sub2            [Note: not needed here so we don't actually define
!                          them.]
!
!   44.  del_t_Sun     =  Difference between arrival time at receiver 1, t_sub1,
!   45.  del_t_Moon         and time of closest approach to Sun/Moon/planets
!   46.  del_t_Planet(7)      ( > 0 if closest approach is before arrival)
!
!   47.  unit_K(3)     =  Barycentric unit vector to the source (in the absense
!                         of gravitational or aberrational bending).
!
!   48.  k_sub1(3)     =  Aberrated unit vector from station 1 to the source.
!   49.  k_sub2(3)     =  Aberrated unit vector from station 2 to the source.
!                          [Note: not computed here, see atmosphere module.]
!
!   50.  b_nought(3)   =  A priori geocentric baseline vector at time t_sub1
!                         (Baseline vector and it's velocity. Defined from
!                         site #1 to site #2 (M,M/S).)
!
!   51.  U             =  Sun's potential
!
!   52.  delgrav_Sun
!   53.  delgrav_Moon =  The differential gravitational time delay for
!   54.  delgrav_Plan(7)     the Sun/Moon/planets/Earth.
!   55.  delgrav_Earth
!
!   56.  delta_t_grav_Planets = Sum of bending delays for the planets
!
!   57.  delta_t_grav  =  The total differential gravitational time delay,
!                         or "bending delay."
!
!   58.  tv2_tv1       =  The theoretical vacuum delay computed using the
!                         Consensus model. (sec)
!
!   59.  tg2_tg1       =  The total theoretical geometric delay (doesn't
!                         include tropospheric refraction effects which are
!                         usually added in Solve) computed using the Consensus
!                         model. (sec)
!
! 4.2.9 PROGRAMMER - DAVID GORDON 04/22/93 thru 08/02/93 - Written and debuged
!                    D. Gordon Nov. 1993 - Modified to use all planets
!                              except Pluto.
!                    D. Gordon Jan-Mar 1994 - Modified for axis offset
!                              correction. Not using Eubank's Step 10.
!                    D. Gordon 10.05.94 Many unused variable and much unused
!                              code removed.
!                    D. Gordon 96.01.30 Added section to compute partial
!                              derivatives of delay and rate w.r.t. Gamma.
!                    D. Gordon 96.02.09 Corrected typo in Step 2 debug printout.
!                    D. Gordon 98.08.18 Mods for geocenter station.
!                    D. Gordon 98.11.16 Added computation of higher order
!                              solar bending term, from IERS Conventions
!                              (1996), page 91, eqn. 14. This term is now
!                              added to the total solar bending term. It
!                              only becomes significant within about 2
!                              degrees of the Sun.
!                    D. Gordon 98.12.16 Added computation of Bend_par(2), the
!                              partial derivatives of the gravitational
!                              bending contributions with respect to Gamma.
!
!         Write(6,*) '           ' 
!         Write(6,*) ' SEKIDO:   ' 
!
!_____________________________________________________________________________
!
!     Copy CALC variables into variables with names which mimic the variables
!     in the consensus paper. VLIGHT is used for the velocity of light because
!     'C' is a poor variable name that could be easily lost.
!
      Do l=1,3
!
       XsubEarth(l) = EARTH(l,1)     ! SSBC Earth position
       VsubEarth(l) = EARTH(l,2)     !   ditto    velocity
       AsubEarth(l) = EARTH(l,3)     !   ditto    acceleration
!
       VsubEart0(l) = 0.0D0          !   modified velocity
       AsubEart0(l) = 0.0D0          !   modified acceleration
!
       x_sub1t1(l) = SITEP(l,1)      ! Site 1 geocentric position
       w_sub1(l)   = SITEV(l,1)      !      ditto        velocity
!d     a_sub1(l)   = SITEA(l,1)      !      ditto        acceleration
!
       x_sub2t1(l) = SITEP(l,2)      ! Site 2 geocentric position
       w_sub2(l)   = SITEV(l,2)      !      ditto        velocity
!d     a_sub2(l)   = SITEA(l,2)      !      ditto        acceleration
!
!      unit_K(l)    = STAR(l)        ! J2000.0 pseudo source vector
!      unitK1(l)    = STAR12(l,1)    
!
       x_subSun(l)  = SUN(l,1)       ! Geocentric Sun position
       v_subSun(l)  = SUN(l,2)       !       ditto    velocity
!
       x_subMoon(l) = XMOON(l,1)     ! Geocentric Moon position
       v_subMoon(l) = XMOON(l,2)     !       ditto     velocity
!
       b_nought(l)  = -EPBASE(l,1)   ! Baseline vector from site 1 to site 2
       db_nought(l) = -EPBASE(l,2)   ! Time derivative of baseline vector
!
       R_Earth_Sun(l)  = -SUN(l,1)
       V_Earth_Sun(l)  = -SUN(l,2)    ! = -v_subSun(l) also
       R_Earth_Moon(l) = -XMOON(l,1)
!
!   SSBC radius vectors of Sun and Moon:
       XsubSun(l)  = XsubEarth(l) + x_subSun(l)
       XsubMoon(l) = XsubEarth(l) + x_subMoon(l)
!
!   SSBC velocity vectors of Sun and Moon:
       VsubSun(l)  = VsubEarth(l) + v_subSun(l)
       VsubMoon(l) = VsubEarth(l) + v_subMoon(l)
!
      Enddo
!
!******************************************************************************
!  Step 1: Estimate barycentric radius and velocity vectors for stations 1
!          and 2 at time t_sub1 
!
      Do l=1,3
       Xsub1(l) = XsubEarth(l) + x_sub1t1(l)
       Xsub2(l) = XsubEarth(l) + x_sub2t1(l)
!d     dXsub1(l) = VsubEarth(l) + w_sub1(l)     !derivative
!d     dXsub2(l) = VsubEarth(l) + w_sub2(l)     !derivative
      Enddo
!
!@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
!   Start East, West, North, South offsets loop
      Do N = 1, 4
!
       do l = 1,3
        unitK1(l) = STAR12EWNS(l,N,1)
       enddo
!
!******************************************************************************
!  Step 2: Estimate the vectors from the Sun, the Moon, and each planet (except
!          Earth and Pluto) to receiver 1.
!
!              Find time of closet approach of the near-field object to the 
!              gravitating body. [Actually ........................
!              we find only how much earlier (or later) the ........ rays
!              passed closest to the gravitating body. Then, if earlier, we
!              extrapolate the body's position back to that earlier time. If
!              not earlier we just keep the current position.]
!
!  J2000.0 vector from receiver #1 to the Sun/Moon/planets:
      Do l=1,3
       x1Sun(l)  = XsubSun(l)  - Xsub1(l)
       x1Moon(l) = XsubMoon(l) - Xsub1(l)
      Enddo
      Do k=1,7
       do l=1,3
        x1Planet(l,k)  = SPLANET(l,1,k)  - Xsub1(l)
       enddo
      Enddo
!
!   more good stuff
       KdotB  = DOTP(STARewns(1,N),b_nought)
!d     dKdotB = DOTP(STAR,db_nought) + DOTP(STARdt,b_nought) 
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Sun:
       del_t_Sun  = DOTP(unitK1,x1Sun) / Vlight
!        
!      write(6,8)' T0_T1, del_t_Sun(sec) ', T0_T1, del_t_Sun
       If(del_t_Sun .lt. 0.D0) del_t_Sun = 0.0D0
       If(del_t_Sun .gt. T0_T1) del_t_Sun = T0_T1
!      write(6,8)' T0_T1, del_t_Sun(sec) ', T0_T1, del_t_Sun
!
        Do l=1,3
!    SSBC vector to Sun at time of closest approach and its time derivative:
         XSunt1J(l) = Xsubsun(l) - VsubSun(l)*del_t_Sun
!d       dXSunt1J(l) = Vsubsun(l)   !Derivative (approx. - no acceleration)
!
!          Vector from Sun to receiver 1
         R1Sunt1(l) = Xsub1(l) - XSunt1J(l)
!d       dR1Sunt1(l) = dXsub1(l) - dXSunt1J(l)   !Derivative
!
!          Vector from Sun to receiver 2
         R2Sunt1(l) = Xsub2(l) - VsubEarth(l)*KdotB/VLIGHT - XSunt1J(l)
!d       dR2Sunt1(l) = dXsub2(l) -  AsubEarth(l)*KdotB/VLIGHT -         &
!d   &                 VsubEarth(l)*dKdotB/VLIGHT - dXSunt1J(l)   !Derivative
!
!    Vector from Sun to near-field object 
!!!      R0sun(l) = R1Sunt1(l) + R1(l)
         R0sun(l) = R1Sunt1(l) + R1EWNS(l,N)
!d       dR0sun(l) = dR1Sunt1(l) + R1dt(l)
!     
        Enddo
!      write(6,8)' Xsubsun,VsubSun  ', Xsubsun,VsubSun 
!      write(6,8)' Xsub1, XSunt1J   ', Xsub1, XSunt1J  
!      write(6,8)' Xsub2, VsubEarth ', Xsub2, VsubEarth
!      write(6,8)' KdotB,VLIGHT     ', KdotB,VLIGHT    
!      write(6,8)' XSunt1J,dXSunt1J ', XSunt1J,dXSunt1J
!      write(6,8)' R1Sunt1,dR1Sunt1 ', R1Sunt1,dR1Sunt1
!      write(6,8)' R2Sunt1,dR2Sunt1 ', R2Sunt1,dR2Sunt1
!      write(6,8)' R0sun,R1         ', R0sun,R1        
!
         R1J = VECMG (R1Sunt1)
!d        dR1J = DOTP(R1Sunt1,dR1Sunt1)/R1J
         R2J = VECMG (R2Sunt1)
!d        dR2J = DOTP(R2Sunt1,dR2Sunt1)/R2J
         R0J = VECMG (R0sun)
!d        dR0J = DOTP(R0Sun,dR0Sun)/R0J
!!!!!    R10 = R1mag
         R10 = R1EWNSmag(N)
!d        dR10 = R1magdt
!!!!!    R20 = R2mag
         R20 = R2EWNSmag(N)
!d        dR20 = R2magdt
!         Write(6,*) ' Sun: '
!         Write(6,*) ' R1,R1Sunt1 ', R1, R1Sunt1
!         Write(6,*) ' R0sun      ', R0sun   
!         Write(6,*) ' R2,R2Sunt1 ', R2, R2Sunt1
!         Write(6,*) ' R1J, dR1J ', R1J, dR1J
!         Write(6,*) ' R2J, dR2J ', R2J, dR2J
!         Write(6,*) ' R0J, dR0J ', R0J, dR0J
!         Write(6,*) ' R10, dR10 ', R10, dR10
!         Write(6,*) ' R20, dR20 ', R20, dR20
!         Write(6,*) '      '
!
       CALL TGRAV1(GMSUN, R0J,R1J,R2J,R10,R20, delgrav_Sun)
!
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Moon:
       del_t_Moon = DOTP(unitK1,x1Moon) / Vlight
!        
       If(del_t_Moon .lt. 0.D0) del_t_Moon = 0.0D0
       If(del_t_Moon .gt. T0_T1) del_t_Moon = T0_T1
!      write(6,8)' del_t_Moon ',del_t_Moon
!
        Do l=1,3
!    SSBC vector to Moon at time of closest approach and its time derivative:
         XMoont1J(l) = XsubMoon(l) - VsubMoon(l)*del_t_Moon
!d       dXMoont1J(l) = VsubMoon(l)    !Derivative (approx. - no acceleration)
!
!       Vector from the Moon to receiver 1
         R1Moont1(l) = Xsub1(l) - XMoont1J(l)
!d       dR1Moont1(l) = dXsub1(l) - dXMoont1J(l)   !Derivative
!
!       Vector from the Moon to receiver 2
         R2Moont1(l) = Xsub2(l) - VsubEarth(l)* KdotB/VLIGHT -          &
     &                 XMoont1J(l)
!d       dR2Moont1(l) = dXsub2(l) - AsubEarth(l)*KdotB/VLIGHT -         &
!d   &                VsubEarth(l)*dKdotB/VLIGHT - dXMoont1J(l)  !Derivative
!
!    Vector from Moon to near-field 
         R0moon(l)  =  R1moont1(l) + R1EWNS(l,N)
!d       dR0moon(l) = dR1moont1(l) + R1dt(l)
!     
        Enddo
!
         R1J = VECMG (R1Moont1)
!d        dR1J = DOTP(R1Moont1,dR1Moont1)/R1J
         R2J = VECMG (R2Moont1)
!d        dR2J = DOTP(R2Moont1,dR2Moont1)/R2J
         R0J = VECMG (R0Moon)
!d        dR0J = DOTP(R0Moon,dR0Moon)/R0J
!
!
       CALL TGRAV1(GMMOON,R0J,R1J,R2J,R10,R20, delgrav_Moon)
!      write(6,8)'TGRAV: delgrav_Moon ', delgrav_Moon, ddelgrav_Moon
!
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!  Planets:
      Do k=1,7      ! Planet loop
       del_t_Planet(k)  = DOTP(unitK1,x1Planet(1,k)) / Vlight
!        
       If(del_t_Planet(k) .lt. 0.D0) del_t_Planet(k) = 0.0D0
       If(del_t_Planet(k) .gt. T0_T1) del_t_Planet(k) = T0_T1
!        write(6,'("del_t_Planet(",i1,") = ",d25.16)')k,del_t_Planet(k)
!
        Do l=1,3
!    SSBC vector to Planet at time of closest approach and its time derivative:
         XPlant1J(l,k) = SPLANET(l,1,k) - SPLANET(l,2,k)*del_t_Planet(k)
!d       dXPlant1J(l,k) = SPLANET(l,2,k)    ! Derivative  (approximate)
!
!       Vector from Planet to receiver 1
         R1Plant1(l,k) = Xsub1(l) - XPlant1J(l,k)
!d       dR1Plant1(l,k) = dXsub1(l) - dXPlant1J(l,k)   !Derivative
!
!       Vector from Planet to receiver 2
         R2Plant1(l,k) = Xsub2(l) - VsubEarth(l)*KdotB/VLIGHT -         &
     &                XPlant1J(l,k)
!d       dR2Plant1(l,k) = dXsub2(l) - AsubEarth(l)*KdotB/VLIGHT -       &
!d   &               VsubEarth(l)*dKdotB/VLIGHT - dXPlant1J(l,k)   !Derivative
!
!    Vector from Planet k to near-field object
         R0plan(l,k)  =  R1plant1(l,k) + R1EWNS(l,N)
!d       dR0plan(l,k) = dR1plant1(l,k) + R1dt(l)
!     
        Enddo
!
         R1J = VECMG (R1Plant1(1,k))
!d        dR1J = DOTP(R1Plant1(1,k),dR1Plant1(1,k))/R1J
         R2J = VECMG (R2Plant1(1,k))
!d        dR2J = DOTP(R2Plant1(1,k),dR2Plant1(1,k))/R2J
         R0J = VECMG (R0plan(1,k))
!d        dR0J = DOTP(R0plan(1,k),dR0plan(1,k))/R0J
         GMp = GMPlanet(k)
!
!         Write(6,*) ' Planet ', k
!         Write(6,*) ' R1J, dR1J ', R1J, dR1J
!         Write(6,*) ' R2J, dR2J ', R2J, dR2J
!         Write(6,*) ' R0J, dR0J ', R0J, dR0J
!         Write(6,*) ' GMp       ', GMp      
!         Write(6,*) '      '
!
       CALL TGRAV1 (GMp,R0J,R1J,R2J,R10,R20, DelTpNPl)
!      write(6,*)' #, delTpNPLAN(k) ', k, delTpNPlan(k)
       delgrav_Plan(k) = DelTpNPl
!d     ddelgrav_Plan(k) = DelTpNPldt
!      write(6,*)'TGRAV: delgrav_Plan ', k, delgrav_Plan(k), ddelgrav_Plan(k) 
!
      Enddo      ! Planet loop
!
!******************************************************************************
!  Step 4: Find the differential delay due to the Earth.
!
       C_Earth = (1.0D0 + gamma) * GMEarth/VLIGHT3
       vecmg0 = VECMG(SpEWNS(1,N))
!d     dvecmg0 = DOTP(SPvxyz,SPpxyz)/vecmg0 
!
      IF(Nzero .ne. 1) THEN
        vecmg1 = VECMG(x_sub1t1)
        term_g = vecmg1 + DOTP(STAR12EWNS(1,N,1),x_sub1t1)
!d      dterm_g = DOTP(x_sub1t1,w_sub1)/vecmg1 +                        &
!d   &           DOTP(STAR12(1,1),w_sub1) + DOTP(STAR12dt(1,1),x_sub1t1)
        term_g1 = vecmg0 + DOTP(STAR12EWNS(1,N,1),SpEWNS(1,N))
!d      dterm_g1 = dvecmg0 + DOTP(STAR12(1,1),SPvxyz)                   &
!d   &             + DOTP(STAR12dt(1,1),SPpxyz)
      ELSE
        vecmg1   = REARTH
        term_g   = 2.0D0 * REARTH
!d      dterm_g  = 0.0D0
        term_g1  = 2.0D0 * vecmg0
!d      dterm_g1 = 2.0D0 * dvecmg0
      ENDIF
!
       IF(Nzero .ne. 2) THEN
        vecmg2 = VECMG(x_sub2t1)
        term_h = vecmg2 + DOTP(STAR12EWNS(1,N,2),x_sub2t1)
!d      dterm_h = DOTP(x_sub2t1,w_sub2)/vecmg2 +                        &
!d   &           DOTP(STAR12(1,2),w_sub2) + DOTP(STAR12dt(1,2),x_sub2t1)
        term_h1 = vecmg0 + DOTP(STAR12EWNS(1,N,2),SpEWNS(1,N))
!d      dterm_h1 = dvecmg0 + DOTP(STAR12(1,2),SPvxyz)                   &
!d   &             + DOTP(STAR12dt(1,2),SPpxyz)
       ELSE
        vecmg2 =  REARTH
        term_h =  2.0D0 * REARTH
!d      dterm_h = 0.0D0
        term_h1  = 2.0D0 * vecmg0
!d      dterm_h1 = 2.0D0 * dvecmg0
       ENDIF
!
       delgrav_Earth = C_Earth * DLOG( (term_g*term_h1) /               &
     &                                      (term_h*term_g1) )
!d     ddelgrav_Earth = C_Earth * ( dterm_g/term_g +                    &
!d   &    dterm_h1/term_h1 - dterm_h/term_h - dterm_g1/term_g1 )
!
!******************************************************************************
!  Step 5: Add up all components to get the total
!          differential gravitational delay.
!          [Does not include the term for observations close to the Sun.]
!
!  Add up the 10 gravitational components
      delgrav = delgrav_Sun + delgrav_Moon + delgrav_Earth
!d     ddelgrav = ddelgrav_Sun + ddelgrav_Moon + ddelgrav_Earth
      Do k=1,7 
       delgrav = delgrav + delgrav_Plan(k)
 !d    ddelgrav = ddelgrav + ddelgrav_Plan(k)
      Enddo
!      write(6,8)' Sekido: delgrav,ddelgrav ', delgrav,ddelgrav
!
!******************************************************************************
!  Step 6: Add the total differential gravitational delay to the rest of the
!          a priori vacuum delay, Equation 9.
!
!  Find Sun's potential:
!
       U_Sun  = GMSUN/VLIGHT2
       vecmg1 = VECMG(R_Earth_Sun)
       U      = U_Sun/vecmg1
!   Derivative:
!d     dU = -U_Sun * Dotp(R_Earth_Sun,V_Earth_Sun) / vecmg1**3
!
!   Compute individual terms of Eqn. 20
!
       term2a = KdotB/VLIGHT
!d     dterm2a = dKdotB/VLIGHT                  ! derivative
!       Write(6,8) ' term2a,dterm2a ', term2a,dterm2a
!
       term2b = 1.D0 - ((1.D0 + gamma) * U)
!d     dterm2b = -(1.D0 + gamma) * dU           ! derivative
!       Write(6,8) ' term2b-1,dterm2b ', (term2b-1.D0),dterm2b
!
       absVEarth = VECMG(VsubEarth)
       term2c = (absVEarth)**2 / (2.D0*VLIGHT2)
!d     dterm2c = Dotp(VsubEarth,AsubEarth) /  VLIGHT2        ! derivative
!!      term2c = 0.D0    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!      dterm2c = 0.D0   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term2c,dterm2c ', term2c,dterm2c
!
       term2d = DOTP(VsubEarth,w_sub2) / VLIGHT2
!d     dterm2d = (DOTP(AsubEarth,w_sub2) + DOTP(VsubEarth,a_sub2))      &
!d   &            / VLIGHT2                                  ! derivative
!!     term2d = 0.D0    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!     dterm2d = 0.D0   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term2d,dterm2d ', term2d,dterm2d
!
!  Combine terms 2b,2c,2d
       term2bcd = term2b - term2c - term2d
!d     dterm2bcd = dterm2b - dterm2c - dterm2d               ! derivative
!
       term2  = term2a * term2bcd
!d     dterm2  = term2a * dterm2bcd + dterm2a * term2bcd     ! derivative
!       Write(6,8) ' term2, dterm2  ', term2,dterm2
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       VdotB  = DOTP(VsubEart0,b_nought)
!d     dVdotB = DOTP(AsubEarth,b_nought) + DOTP(VsubEarth,db_nought) !derivative
!
       term3a = VdotB/VLIGHT2
!d     dterm3a = dVdotB/VLIGHT2
!       Write(6,8) ' term3a,dterm3a ', term3a,dterm3a
!
       Call VECAD (VsubEart0, w_sub2, V2 )
!d     Call VECAD (AsubEarth, a_sub2, dV2 )
!       Write(6,8) ' V2, dV2 ', V2, dV2 
       term3b = DOTP(STAR12EWNS(1,N,2), V2)/VLIGHT
!d     dterm3b = (DOTP(STAR12dt(1,2),V2) + DOTP(STAR12(1,2),dV2))/VLIGHT
!       Write(6,8) ' STAR12(1,2)   ', STAR12(1,2),STAR12(2,2),STAR12(3,2)
!       Write(6,8) ' STAR12dt(1,2) ', STAR12dt(1,2),STAR12dt(2,2),STAR12dt(3,2) 
!       Write(6,8) ' term3b,dterm3b ', term3b,dterm3b
!
        DO I = 1,3
         Vec3c(I) = VsubEart0(I) + 2.D0*w_sub2(I)
!d       dVec3c(I) = AsubEarth(I) + 2.D0*a_sub2(I)
        ENDDO
       term3c = DOTP(Vec3c,STARewns(1,N)) / (2.D0*VLIGHT)
!d     dterm3c = (DOTP(dVec3c,STAR) + DOTP(Vec3c,STARdt))/(2.D0*VLIGHT)
!       Write(6,8) ' term3c,dterm3c ', term3c,dterm3c
!
       term3 = term3a * (1.D0 + term3b - term3c) 
!d     dterm3 = dterm3a*(1.D0+term3b-term3c) + term3a*(dterm3b-dterm3c)
!!     term3 = term3a * (1.D0 )     !!!!!!!!!!!!!!!!! 
!!     dterm3 = dterm3a*(1.D0)      !!!!!!!!!!!!!!!!!
!?     term3 = 0.D0         !!!!!!!!!!!!!!!!!!!!!!!!!
!?     dterm3 = 0.D0        !!!!!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term3, dterm3  ', term3,dterm3 
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!      term4a = 1.D0 + DOTP(STAR12EWNS(1,N,2),V2)/VLIGHT
       term4a = 1.D0 + term3b 
!d     dterm4a = (DOTP(STAR12dt(1,2),V2) + DOTP(STAR12(1,2),dV2))/VLIGHT
!       Write(6,8) ' term4a,dterm4a ', term4a,dterm4a
!
       Call CROSP(V2, STAR12EWNS(1,N,2), H1)
       H2 = (VECMG(H1)/VLIGHT)**2 
       H3 = KdotB/(2.D0*R2EWNSmag(N))
       H  = H2*H3

!d     Call CROSP(dV2,STAR12(1,2),dH1a)
!d     Call CROSP(V2,STAR12dt(1,2),dH1b)
!d     Call VECAD (dH1a, dH1b, dH1)
!       dH2 = 2.D0*(VECMG(H1)*(VECMG(dH1)))/(VLIGHT2)
!d      dH2 = (2.D0 * DOTP(H1,dH1)) / VLIGHT2
!d      dH3 = (dKdotB/R2mag - KdotB*R2magdt/R2mag**2)/2.0D0
!d      dH  = dH2*H3 + H2*dH3
!       Write(6,8) ' H1, dH1 ', H1, dH1 
!       Write(6,8) ' H2, dH2 ', H2, dH2 
!       Write(6,8) ' H3, dH3 ', H3, dH3 
!       Write(6,8) ' H,  dH  ', H, dH  
!
       term4 = term4a * (1.D0 + H)
!d     dterm4 = dterm4a*(1.D0 + H) + term4a*dH
!!?    term4 =          (1.D0 + H)             !!!!!!!!!!!!!!!!!!!!!!
!!?    dterm4 = 0.D0                           !!!!!!!!!!!!!!!!!!!!!!
!       Write(6,8) ' term4, dterm4  ', term4,dterm4 
!
       tv2_tv1 = (-term2 - term3 + delgrav) / term4
!d     dtv2_tv1 = (-dterm2 - dterm3 + ddelgrav) / term4    -            &
!d   &          (1.D0/term4**2) * (-term2 - term3 + delgrav) * dterm4
!
!      write(6,8) 'S: tv2_tv1, dtv2_tv1 ',tv2_tv1, dtv2_tv1
!
!******************************************************************************
!  Step 8: Add the geometric part of the tropospheric propogation delay to the
!          vacuum delay.
!          [Geocenter station: DATMC(Nzero,1) and DATMC(Nzero,2) should
!          already be zero.]
!
      call vecsb(w_sub2,w_sub1,w2_w1)
!d    call vecsb(a_sub2,a_sub1,a2_a1)
!???  K_dotw2w1 = DOTP(STARewns(1,N),w2_w1) + DOTP(STARdt,b_nought)
      K_dotw2w1 = DOTP(STARewns(1,N),w2_w1)
!d    dK_dotw2w1 = DOTP(STARdt,w2_w1) + DOTP(STAR,a2_a1) +              &
!d   &             DOTP(STARdt,db_nought) 
!!!  &             + DOTP(STARdtdt,b_nought)
!
!   Negative sign because station 1 atmosphere is negative.
!??   tg2_tg1ewns(N) = tv2_tv1 - Datmc_h_EWNS(N) * K_dotw2w1/VLIGHT
      tg2_tg1ewns(N) = tv2_tv1 
!d    dtg2_tg1 = dtv2_tv1 - DATMC(1,2) * K_dotw2w1/VLIGHT               &
!d   &                    - DATMC(1,1) * dK_dotw2w1/VLIGHT
!      write(6,8)' w2_w1, a2_a1 ', w2_w1, a2_a1
!
       If (UVW .eq. 'exact ')  Then
        tg2_tg1ewns(N) = tg2_tg1ewns(N) + Datmc_h_EWNS(N) + Datmc_w_EWNS(N)
!       write(6,'("I,tg2_tg1(psec):",I2,F18.2)') I, tg2_tg1(I)*1.D12
       Endif
!
      Enddo    ! East, West, North, South offsets loop
!@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
!
    8 FORMAT(A,4D25.16/(7X,5D25.16))
!         write (6,*) ' Sekido model '
!         write (6,*) ' tg2_tg1east  ', tg2_tg1ewns(1)
!         write (6,*) ' tg2_tg1west  ', tg2_tg1ewns(2)
!         write (6,*) ' tg2_tg1north ', tg2_tg1ewns(3)
!         write (6,*) ' tg2_tg1south ', tg2_tg1ewns(4)
!
      U_V(1) = VLIGHT*(tg2_tg1ewns(1) - tg2_tg1ewns(2))/0.0002D0
      U_V(2) = VLIGHT*(tg2_tg1ewns(3) - tg2_tg1ewns(4))/0.0002D0
!      write(6,*) ' U (m, sec) ', U_V(1),  U_V(1)/VLIGHT
!      write(6,*) ' V (m, sec) ', U_V(2),  U_V(2)/VLIGHT
!
      RETURN
      END
!
!**********************************************************************
      SUBROUTINE TGRAV1(GM, R0J,R1J,R2J,R10,R20, DelTpN)
      IMPLICIT NONE
!
!  Subroutine to compute the gravitational deflection for a solar 
!   system body (Sun, Moon, planets)  on a near-field object.
!  Same as TGRAV but without time derivatives.
!
!
!    1. GM - Gravitational constant times the mass of the gravitating
!            body.
      Real*8 GM, R0J, R1J, R2J, R10, R20, DelTpN
      Real*8 term1a, term1b, term2a, term2b, term1adt, term1bdt,        &
     &       term2adt, term2bdt, term12, term12dt
!*
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - The velocity of light cubed. (m/sec)**3
!
!
      term1a   = R2J   + R0J   + R20
!
      term1b   = R2J   + R0J   - R20
!
      term2a   = R1J   + R0J   - R10
!
      term2b   = R1J   + R0J   + R10
!
      term12 = (term1a/term1b) * (term2a/term2b)
!
      DelTpN = (2.D0*GM/VLIGHT3) * DLOG (term12)
!
      RETURN
      END
!
!**********************************************************************
      Subroutine DUEVewns (Datmc_h_EWNS, Datmc_w_EWNS, SITEP, SITEV,    &
     &      SITEA, SUN, T0_T1, EARTH, XMOON, UTC, TT, TDB, TDBg)
!
      IMPLICIT NONE
      REAL*8 SUN(3,2), EARTH(3,3), SITEA(3,2), SITEP(3,2),              &
     &       SITEV(3,2), DOTP, VECMG, UTC, TT, TDB, TDBg, XMOON(3,2),   &
     &       Datmc_h_EWNS(4), Datmc_w_EWNS(4)
      Real*8 td2_td1(4), dtd2_td1(4), T0_T1
      Real*8 U, dU, U_Sun, Vecmg1, F1, VdotR1, VdotR2, VdotNFO,         &
     &       del_T0, gm1, RLT_01, R_01mag, R0sunT0mag, R1sunT1mag,      &
     &       T1_T0, ddel_T0, R01sunmag
      Real*8 VsubEarth(3), R_Earth_Sun(3), V_Earth_Sun(3), R1_T1(3),    &
     &       R2_T1(3), R0_T0(3), dR0_T0(3), R_01(3), delSun0(3),        &
     &       SUN_0(3), R0sunT0(3), R1sunT1(3), Rb_01(3), dR0(3),        &
     &       R1(3), EARTH_0(3), RsunT0(3), RsunT1(3), R01sun(3)
      Real*8 R_02(3), Site2(3), R2_T2(3), SunT2(3), EarthT2(3),         &
     &       RsunT2(3), R2sunT2(3), R02sun(3)
      Real*8 T2_T0, del_T2, R2_T2mag, R_02mag, R2sunT2mag, R02sunmag,   &
     &       RLT_02, ddel_T2
      Real*8 T2_T1, VEsq, UE, B(3), VEdotB, VEdotV2
      Real*8 delMoon0(3),MOON_0(3),RmoonT0(3),R0moonT0(3),R0moonT0mag,  &
     &       RmoonT1(3),R1moonT1(3),R1moonT1mag,R01moon(3),R01moonmag,  &
     &       RLT_01s,RLT_01m,RLT_01p,delpl(3),Spl_0(3),R0planT0(3),     &
     &       R0planT0mag,R1planT1(3),R1planT1mag,R01plan(3),R01planmag, &
     &       RLTp(7)
      Real*8 MoonT2(3),RmoonT2(3),R2moonT2(3),R2moonT2mag,R02moon(3),   &
     &       R02moonmag,RLT_02s,RLT_02m,RLT_02p,Spl_2(3),R2planT2(3),   &
     &       R2planT2mag,R02plan(3),R02planmag
      Real*8 delEarth0(3), REarthT0(3), R0earthT0(3), R0earthT0mag,     &
     &       RearthT1(3), R1earthT1(3), R1earthT1mag, R01earth(3),      &
     &       R01earthmag, RLT_01e, RearthT2(3), R2earthT2(3),           &
     &       R2earthT2mag, R02earth(3), R02earthmag, RLT_02e,           &
     &       delearth2(3), delSun2(3), delmoon2(3)
      Integer*4 I, J, K, N
!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) - Geocentric satellite position at T0 (meters). 
!
      Real*8 SpEWNS(3,4), R1EWNS(3,4), R2EWNS(3,4), R1EWNSmag(4),       &
     &       R2EWNSmag(4), STAR12EWNS(3,4,2), STARewns(3,4)
      Common / NFewns/ SpEWNS, R1EWNS, R2EWNS, R1EWNSmag, R2EWNSmag,    &
     &       STAR12EWNS, STARewns
!       Variables from:
!          1. SpEWNS(3,4) - Geocentric satellite East, West, North, and
!                           South offset positions at T0 (meters). 
!
      INCLUDE 'put2s.i'
!       Variables to:
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - THE VELOCITY OF LIGHT IN VACUUM CUBED.
!                         (M**3/SEC**3)
!            4. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!
      INCLUDE 'csolsys11.i'
!       Variables 'from':
!         1. SPLANET(3,2,7) - The J2000.0 Solar System Barycentric positions
!                             and velocities of all planets except the Earth
!                             and Pluto. (meters, meters/sec) The first index
!                             runs over X,Y, and Z, the second runs over
!                             position and velocity, and the third runs over
!                             the planets, where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                             of all planets except the Earth and Pluto.
!                             (meters, meters/sec) The first index runs over
!                             X,Y, and Z, the second runs over position and
!                             velocity, and the third runs over the planets,
!                             where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!         3. SUNb(3,2)      - J2000 Barycentric Sun position and velocity.
!         4. MOONb(3,2)     - J2000 Barycentric Moon position and velocity.
!
!   Convert spacecraft and site vectors from TT to TDB  
       Do I = 1, 3
        VsubEarth(I) = EARTH(I,2)      !  SSBC Earth Velocity
        R_Earth_Sun(I)  = -SUN(I,1)    !  Vector from Sun to Earth
        V_Earth_Sun(I)  = -SUN(I,2)    !  Velocity of Earth w.r.t. the Sun
       Enddo
! 
!       Sun's potential:
       U_Sun  = GMSUN/VLIGHT2
       vecmg1 = VECMG(R_Earth_Sun)
       U      = U_Sun/vecmg1
!   Derivative:
!      dU = -U_Sun * Dotp(R_Earth_Sun,V_Earth_Sun) / vecmg1**3
       F1 = 1.D0 - U - 1.48082686741D-8
!
        VdotR1 = DOTP(VsubEarth,SITEP(1,1))
!       VdotR2 = DOTP(VsubEarth,SITEP(1,2))
!
!   Barycentric TDB vectors: (Duev equation 4)
       Do I = 1,3
        R1_T1(I) = SITEP(I,1)*F1 - 0.5D0*(VdotR1/VLIGHT2)*VsubEarth(I)  &
     &             + EARTH(I,1)
        R2_T1(I) = SITEP(I,2)*F1 - 0.5D0*(VdotR2/VLIGHT2)*VsubEarth(I)  &
     &             + EARTH(I,1)
       Enddo
!       write(6,*) 'site1,R1_T1: ', SITEP(1,1),SITEP(2,1),SITEP(3,1),R1_T1
!       write(6,*) 'site2,R2_T1: ', SITEP(1,2),SITEP(2,2),SITEP(3,2),R2_T1
!
!  Start the East, West, North, South offsets loop
      DO N = 1, 4              ! E-W-N-S loop
!
        VdotNFO = DOTP(VsubEarth,SpEWNS(1,N))
!
!  Initial estimate for (T1 - T0)
!RR   CALL VECSB (SPpxyz, SITEP(1,1), R_01)
      CALL VECSB (SpEWNS(1,N), SITEP(1,1), R_01)
       R_01mag   = VECMG(R_01)
       del_T0 = VECMG(R_01)/VLIGHT 
!       write(6,*) 'DUEV: T0_T1, Initial del_T0 ', T0_T1, del_T0
!
       gm1 = 2.D0*GMSUN/VLIGHT2
!
! Three iterations should be enough 
      DO J = 1,3   
        Do I = 1,3    ! Barycentric at T1 - del_T0
         R0_T0(I) = SpEWNS(I,N)*F1 - 0.5D0*(VdotNFO/VLIGHT2)*VsubEarth(I) &
     &              + (EARTH(I,1) - del_T0*EARTH(I,2)) -                &
     &     SPvxyz(I)*(T0_T1 - del_T0)
        Enddo
!
! Barycentric vectors
       Call VECSB(R1_T1, R0_T0, R_01)      ! equation 15
        R_01mag = VECMG(R_01)
!!!      write(6,*) 'R_01,R_01mag: ', R_01,R_01mag
!
       CALL VECMU(SUNb(1,2),del_T0,delSun0)
       CALL VECSB(SUNb(1,1), delSun0, RsunT0) 
!               write(6,*) 'new RsunT0: ', RsunT0 
       CALL VECSB (R0_T0, RsunT0, R0sunT0)          ! eqn 16, Sun to spacecraft at T0
        R0sunT0mag = VECMG(R0sunT0)
!!!      write(6,*) 'R0sunT0,R0sunT0mag: ', R0sunT0,R0sunT0mag 
!
       CALL VECMU(MOONb(1,2),del_T0,delMoon0)
       CALL VECSB(MOONb(1,1), delMoon0, RmoonT0) 
!               write(6,*) 'new RmoonT0: ', RmoonT0 
       CALL VECSB (R0_T0, RmoonT0, R0moonT0)          ! eqn 16, Moon to spacecraft at T0
        R0moonT0mag = VECMG(R0moonT0)
!
       CALL VECMU(EARTH(1,2),del_T0,delEarth0)
       CALL VECSB(EARTH(1,1), delMoon0, REarthT0) 
       CALL VECSB (R0_T0, RearthT0, R0earthT0)          ! eqn 16, Earth to spacecraft at T0
        R0earthT0mag = VECMG(R0earthT0)
!               write(6,*) 'RearthT0: ', RearthT0 
!               write(6,*) 'R0earthT0: ', R0earthT0 
!               write(6,*) 'R0earthT0mag: ', R0earthT0mag 
       CALL VECEQ(EARTH(1,1),RearthT1) 
!              write(6,*) 'RearthT1: ', RearthT1 
       CALL VECSB(R1_T1, RearthT1, R1earthT1)   ! eqn 16, Earth to site 1 at T1
       R1earthT1mag = VECMG(R1earthT1)
!              write(6,*) 'R1earthT1: ', R1earthT1 
!              write(6,*) 'R1earthT1mag: ', R1earthT1mag 
       CALL VECSB (R1earthT1,R0earthT0,R01earth) ! eqn 17, Earth
       R01earthmag = VECMG(R01earth)
!              write(6,*) 'R01earth: ', R01earth 
!              write(6,*) 'R01earthmag: ', R01earthmag 
!
       CALL VECEQ(SUNb(1,1),RsunT1) 
!              write(6,*) 'new RsunT1: ', RsunT1 
       CALL VECSB(R1_T1, RsunT1, R1sunT1)   ! eqn 16, Sun to site 1 at T1
       R1sunT1mag = VECMG(R1sunT1)
!!!      write(6,*) 'R1sunT1,R1sunT1mag: ', R1sunT1,R1sunT1mag 
!
       CALL VECEQ(MOONb(1,1),RmoonT1) 
!              write(6,*) 'new RmoonT1: ', RmoonT1 
       CALL VECSB(R1_T1, RmoonT1, R1moonT1)   ! eqn 16, Moon to site 1 at T1
       R1moonT1mag = VECMG(R1moonT1)
!
       CALL VECSB (R1sunT1,R0sunT0,R01sun) ! eqn 17, Sun 
       R01sunmag = VECMG(R01sun)
!!!      write(6,*) 'R01sun,R01sunmag: ', R01sun,R01sunmag 
       CALL VECSB (R1moonT1,R0moonT0,R01moon) ! eqn 17, Moon
       R01moonmag = VECMG(R01moon)
!  Sun:
        RLT_01s = (2.D0*GMSUN/VLIGHT3) * DLOG( (R0sunT0mag + R1sunT1mag  &
     &  + R01sunmag + gm1)/(R0sunT0mag + R1sunT1mag - R01sunmag + gm1) )
!  Moon:
        RLT_01m = (2.D0*GMMOON/VLIGHT3) * DLOG( (R0moonT0mag + R1moonT1mag  &
     &  + R01moonmag)/(R0moonT0mag + R1moonT1mag - R01moonmag) )
!       write(6,*) 'RLT_01s, RLT_01m ', RLT_01s,RLT_01m
!
!  Earth:
!       RLT_01e = (2.D0*GMEarth/VLIGHT3) * DLOG( (R0earthT0mag + R1earthT1mag  &
!    &  + R01earthmag)/(R0earthT0mag + R1earthT1mag - R01earthmag) )
!       write(6,*) 'RLT_01s ', RLT_01s
!       write(6,*) 'RLT_01m ', RLT_01m
!       write(6,*) 'RLT_01e ', RLT_01e
!
! Planets:
        RLT_01p = 0.0D0 
!       write(6,*) 'J, del_T0', J,del_T0
       Do K = 1,7
        Call VECMU(SPLANET(1,2,K),del_T0,delpl)  
        CALL VECSB(SPLANET(1,1,K), delpl, Spl_0)  ! SSBC planet vector at T0
        CALL VECSB(R0_T0, Spl_0, R0planT0)        ! Planet to spacecraft at T0
        R0planT0mag = VECMG(R0planT0)
!
        CALL VECSB(R1_T1,SPLANET(1,1,K), R1planT1) ! Planet to site 1 at T1
        R1planT1mag = VECMG(R1planT1)
!
        CALL VECSB(R1planT1, R0planT0, R01plan)    ! ~Planet-to-site1
        R01planmag = VECMG(R01plan)
!
        RLTp(K) =  (2.D0*GMPLANET(K)/VLIGHT3) *                         &
     &             DLOG( (R0planT0mag + R1planT1mag + R01planmag) /     &
     &                   (R0planT0mag + R1planT1mag - R01planmag) )
        RLT_01p = RLT_01p + RLTp(K)
       Enddo
!
        RLT_01 = RLT_01s + RLT_01m + RLT_01p 
        T1_T0 = R_01mag/VLIGHT + RLT_01
        ddel_T0 = T1_T0 - del_T0
        del_T0 = T1_T0
!        write(6,*) 'J,RLT_01, del_T0: ', J, RLT_01, del_T0
!
      Enddo
!
! Now find (T2 - T0):
!  Initial estimate for (T2 - T0)
       Call VECSB(R2_T1, R0_T0, R_02)
        T2_T0 = VECMG(R_02)/VLIGHT
        del_T2 = T1_T0 - T2_T0      ! difference from T1
!        write(6,*) 'R_02,T2_T0,del_T2: ', R_02,T2_T0,del_T2 
!
      DO J = 1,3   ! Three iterations 
!   Barycentric TDB vectors:
       Do I = 1,3
        Site2(I) = SITEP(I,2) - SITEV(I,2)*del_T2    ! Site 2 at T2
        VdotR2 = DOTP(VsubEarth,Site2)
        R2_T2(I) = Site2(I)*F1 - 0.5D0*(VdotR2/VLIGHT2)*VsubEarth(I)  &
     &             + (EARTH(I,1) - del_T2*EARTH(I,2))       ! SSBC Site2 vector @ T2
       Enddo
        R2_T2mag = VECMG(R2_T2)
!       write(6,*) 'SITEP2,Site2:', SITEP(1,2),SITEP(2,2),SITEP(3,2),Site2
!       write(6,*) 'R2_T2,R2_T2mag:', R2_T2,R2_T2mag 
!
       Call VECSB(R2_T2, R0_T0, R_02)    ! eqn 15; Site2 to NFO
        R_02mag = VECMG(R_02)
!
       CALL VECMU(SUNb(1,2),del_T2,delSun2)
       CALL VECSB(SUNb(1,1), delSun2, RsunT2)
       CALL VECSB (R2_T2, RsunT2, R2sunT2)          ! eqn 16, Sun to site 2 at T2
        R2sunT2mag = VECMG(R2sunT2)
!         write(6,*) 'new RsunT2: ', RsunT2
!         write(6,*) 'new R2sunT2mag: ', R2sunT2mag
       CALL VECSB (R2sunT2,R0sunT0,R02sun) ! eqn 17, Sun 
       R02sunmag = VECMG(R02sun)
!         write(6,*) 'new R02sun,R02sunmag: ', R02sun,R02sunmag 
!
       CALL VECMU(MOONb(1,2),del_T2,delmoon2)
       CALL VECSB(MOONb(1,1), delmoon2, RmoonT2)
       CALL VECSB (R2_T2, RmoonT2, R2moonT2)          ! eqn 16, Moon to site 2 at T2
        R2moonT2mag = VECMG(R2moonT2)
!         write(6,*) 'new R2moonT2: ', R2moonT2
!         write(6,*) 'new R2moonT2mag: ', R2moonT2mag
       CALL VECSB (R2moonT2,R0moonT0,R02moon) ! eqn 17, Moon
       R02moonmag = VECMG(R02moon)
!         write(6,*) 'new R02moon,R02moonmag: ', R02moon,R02moonmag 
!!
        CALL VECMU(EARTH(1,2),del_T2,delearth2)
        CALL VECSB(EARTH(1,1), delearth2, RearthT2)
!!               write(6,*) 'new RearthT2: ', earthRT2
        CALL VECSB (R2_T2, RearthT2, R2earthT2)          ! eqn 16, Earth to site 2 at T2
         R2earthT2mag = VECMG(R2earthT2)
!            write(6,*) 'R2earthT2mag: ', R2earthT2mag
        CALL VECSB (R2earthT2,R0earthT0,R02earth) ! eqn 17, Earth
        R02earthmag = VECMG(R02earth)
!!              write(6,*) 'R02earth: ', R02earth
!               write(6,*) 'R02earthmag: ', R02earthmag
!
       RLT_02s = (2.D0*GMSUN/VLIGHT3) * DLOG((R0sunT0mag + R2sunT2mag    &
     &  + R02sunmag + gm1)/(R0sunT0mag + R2sunT2mag - R02sunmag + gm1) )
       RLT_02m = (2.D0*GMMOON/VLIGHT3) * DLOG((R0moonT0mag + R2moonT2mag    &
     &  + R02moonmag)/(R0moonT0mag + R2moonT2mag - R02moonmag) )
!      write(6,*) 'RLT_02s, RLT_02m', RLT_02s, RLT_02m
       RLT_02e = (2.D0*GMEarth/VLIGHT3) * DLOG( (R0earthT0mag + R2earthT2mag  &
     &  + R02earthmag)/(R0earthT0mag + R2earthT2mag - R02earthmag) )
!       write(6,*) 'RLT_02s ', RLT_02s
!       write(6,*) 'RLT_02m ', RLT_02m
!       write(6,*) 'RLT_02e ', RLT_02e
!              write(6,*) '    '
!
! Planets:
        RLT_02p = 0.0D0 
       Do K = 1,7
        Call VECMU(SPLANET(1,2,K),del_T0,delpl)  
        CALL VECSB(SPLANET(1,1,K), delpl, Spl_0)  ! SSBC planet vector at T0
        CALL VECSB(R0_T0, Spl_0, R0planT0)        ! Planet to spacecraft at T0
        R0planT0mag = VECMG(R0planT0)
!
        Call VECMU(SPLANET(1,2,K),del_T2,delpl)  
        CALL VECSB(SPLANET(1,1,K), delpl, Spl_2)  ! SSBC planet vector at T2
        CALL VECSB(R2_T2,Spl_2,          R2planT2) ! Planet to site 2 at T2
        R2planT2mag = VECMG(R2planT2)
!
        CALL VECSB(R2planT2, R0planT0, R02plan)    ! ~Planet-to-site2
        R02planmag = VECMG(R02plan)
!
        RLTp(K) =  (2.D0*GMPLANET(K)/VLIGHT3) *                         &
     &             DLOG( (R0planT0mag + R2planT2mag + R02planmag) /     &
     &                   (R0planT0mag + R2planT2mag - R02planmag) )
        RLT_02p = RLT_02p + RLTp(K)
       Enddo
!       write(6,*) 'RLT_02p ', RLT_02p
!
       RLT_02 = RLT_02s + RLT_02m + RLT_02e + RLT_02p
!       write(6,*) 'RLT_02 ', RLT_02
        T2_T0 = R_02mag/VLIGHT + RLT_02
        ddel_T2 = T2_T0 - (T1_T0 - del_T2)
        del_T2 = T1_T0 - T2_T0 
!
!      write (6,*) 'del_T2, T2-T1: ', del_T2, (T2_T0 - T1_T0)
      Enddo
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Convert to TT frame, Duev equation 20.
!
      T2_T1 = T2_T0 - T1_T0     ! Vacuum delay in TDB frame
      VEsq = DOTP(VsubEarth,VsubEarth)      ! Square of Earth's SSBC velocity
      UE = GMSUN/vecmg1                     ! Newtonian potential, Sun only
      Call VECSB(SITEP(1,2),SITEP(1,1),B)   ! Geocentric baseline vector
      VEdotB = DOTP(VsubEarth,B)            ! Earth SSB velocity * Baseline
      VEdotV2 = DOTP(VsubEarth,SITEV(1,2))  ! Earth SSB velocity * Site2 geocentric velocity
!
      td2_td1(N) = (( (T2_T1/(1.D0-1.48082686741D-8)) *                 &
     &   (( 1.D0 - (VEsq/2.D0 + UE)/VLIGHT2 )) - VEdotB/VLIGHT2 ) /     &
     &   (1.D0 + VEdotV2/VLIGHT2)) 
!
       If (UVW .eq. 'exact ')  Then
        td2_td1(N) = td2_td1(N) + Datmc_h_EWNS(N) + Datmc_w_EWNS(N)
!       write(6,'("I,td2_td1(psec):",I2,F18.2)') I, td2_td1(I)*1.D12
       Endif
!      write (6,*) 'DUEVewns/new: N, td2_td1(ps): ', N, td2_td1(N)*1.D12
!
      ENDDO     ! E-W-N-S loop
!
      U_V(1) = VLIGHT*(td2_td1(1) - td2_td1(2))/0.0002D0
      U_V(2) = VLIGHT*(td2_td1(3) - td2_td1(4))/0.0002D0
!      write(6,*) 'Duev New: U (m, psec) ', U_V(1),  U_V(1)*1.D12/VLIGHT
!      write(6,*) 'Duev New: V (m, psec) ', U_V(2),  U_V(2)*1.D12/VLIGHT
!
      RETURN
      END
!
!**********************************************************************
      Subroutine  RANGEewns (Datmc_h_EWNS, Datmc_w_EWNS, SITEP, SITEV,  &
     &      SITEA, SUN, T0_T1,                                          & 
     &      R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag, R2magdt) 
!    &      tr2_tr1, dtr2_tr1)
!
      IMPLICIT NONE
!
      REAL*8             SUN(3,2), EARTH(3,3), SITEA(3,2), SITEP(3,2),  &
     &       SITEV(3,2), DOTP, VECMG, Datmc_h_EWNS(4), Datmc_w_EWNS(4)
      Real*8 R1(3), R2(3), R1dt(3), R2dt(3), R1mag, R2mag, R1magdt,     &
     &       R2magdt, T0_T1, tr2_tr1(4), dtr2_tr1(4)
      Real*8 SunNFO(3), del2(3), Site2(3),x2x0(3), rsun2(3), vecx2x0(3) 
      Real*8 G2sunV3, rsun0mag, rsun1mag, rsun2mag, x1x0mag, x2x0mag,   &
     &       xlog1, xlog2, t1t0, t2t0, t1t2, t1t2_old, G2EarthV3,       &
     &       xEx0mag, Site2mag, tgrav, tgravSun, tgravEarth
      Integer*4 J, N
!
      INCLUDE 'd_input.i'
!       Variables from:
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - THE VELOCITY OF LIGHT IN VACUUM CUBED.
!                         (M**3/SEC**3)
!            4. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.
!
      INCLUDE 'put2s.i'
!       Variables from:
!
      Real*8 SpEWNS(3,4), R1EWNS(3,4), R2EWNS(3,4), R1EWNSmag(4),       &
     &       R2EWNSmag(4), STAR12EWNS(3,4,2), STARewns(3,4)
      Common / NFewns/ SpEWNS, R1EWNS, R2EWNS, R1EWNSmag, R2EWNSmag,    &
     &       STAR12EWNS, STARewns
!
      DO N = 1, 4     ! loop over East, West, North, South offsets
!
       G2sunV3 = 2.D0*GMSUN/VLIGHT3
       Call VECSB(SpEWNS(1,N),SUN(1,1),SunNFO)
       rsun0mag = VECMG(SunNFO)
       rsun1mag = VECMG(SUN(1,1))
       x1x0mag  = VECMG(R1)
       xlog1 = rsun0mag + rsun1mag + x1x0mag
       xlog2 = rsun0mag + rsun1mag - x1x0mag
        tgravSun = G2sunV3 * DLOG(xlog1/xlog2)
!
       G2EarthV3 = 2.D0*GMEARTH/VLIGHT3
       xEx0mag = VECMG(SpEWNS(1,N))
!      xlog1 = xEx0mag + xEx0mag
!      xlog2 = xEx0mag - xEx0mag
!       tgravEarth = G2EarthV3 * DLOG(xlog1/xlog2)
       tgravEarth =  0.D0   ! zero at geocenter
!
!   Delay from NFO to site1 (geocenter)
       t1t0 = R1mag/VLIGHT + tgravEarth 
!
       t1t2 = 0.D0
      Do J = 1,4
         t1t2_old = t1t2
       Call VECMU(SITEV(1,2),t1t2,del2)   ! del2 = vector correction to site2 position
       Call VECSB(SITEP(1,2),del2,Site2)  ! Site2 = site2 retarded position
       Call VECSB(Site2,SpEWNS(1,N),vecx2x0)
       x2x0mag = VECMG(vecx2x0)
       Call VECSB(Site2,SUN(1,1),rsun2)
       rsun2mag = VECMG(rsun2)
!
       xlog1 = rsun0mag + rsun2mag + x2x0mag
       xlog2 = rsun0mag + rsun2mag - x2x0mag
       tgravSun = G2sunV3 * DLOG(xlog1/xlog2)
!
       Site2mag = VECMG(Site2)
       xlog1 = xEx0mag + Site2mag + x2x0mag
       xlog2 = xEx0mag + Site2mag - x2x0mag
       tgravEarth = G2EarthV3 * DLOG(xlog1/xlog2)

!      t2t0 = x2x0mag/VLIGHT + tgravSun + tgravEarth
       t2t0 = x2x0mag/VLIGHT + tgravEarth
!      t2t0 = x2x0mag/VLIGHT 
       t1t2 = t1t0 - t2t0
      Enddo
!
      tr2_tr1(N) = t2t0 - t1t0
!
       If (UVW .eq. 'exact ')  Then
        tr2_tr1(N) = tr2_tr1(N) + Datmc_h_EWNS(N) + Datmc_w_EWNS(N)
       Endif
!
      ENDDO     ! end loop over East, West, North, South offsets
!
!              write (6,*) ' Ranging model '
!         write (6,*) ' tr2_tr1east  ', tr2_tr1(1)
!         write (6,*) ' tr2_tr1west  ', tr2_tr1(2)
!         write (6,*) ' tr2_tr1north ', tr2_tr1(3)
!         write (6,*) ' tr2_tr1south ', tr2_tr1(4)
!
      U_V(1) = VLIGHT*(tr2_tr1(1) - tr2_tr1(2))/0.0002D0
      U_V(2) = VLIGHT*(tr2_tr1(3) - tr2_tr1(4))/0.0002D0
!      write(6,*) ' U (m, psec) ', U_V(1),  U_V(1)*1.D12/VLIGHT
!      write(6,*) ' V (m, psec) ', U_V(2),  U_V(2)*1.D12/VLIGHT
!
      Return
      End
!**********************************************************************
      SUBROUTINE ETDG ( R2K, SITLAT, SITLON, SUN, TCTOCF, RTTOCF,       &
     &         USITEP, USITEV, XMOON, EARTH, GAST2K,                    &
     &         FA2K, FAD2K, CENT, GEOLAT, TIDEP, TIDEV )
      IMPLICIT None
!
!     ETDG is the Solid Earth Tide geometry section. It calculates the
!     Earth surface crustal displacements and velocities due to Earth
!     tidal effects at each site using the IERS 1996 Earth tide model.
!
!     References:  1. IERS Technical Note 21, IERS Conventions (1996);
!                     Dennis D. McCarthy (ed.); pages 56-65.
!                  2. IERS Technical Note 32, IERS Conventions (2003),
!                     Dennis D. McCarthy (ed.), chapter 7.
!
!     ETDG Program Interface:
!
!       Calling sequence:
!           INPUT VARIABLES:
!             1. R2K(3,3,3)   - The complete crust fixed to J2000.0 rotation
!                               matrix and its first two CT time derivatives.
!                               (unitless, 1/sec, 1/sec**2)
!             2. SITLAT(2)    - The geodetic latitude of each site. (RAD)
!             3. SITLON(2)    - The longitude of each site. (RAD)
!             4. SUN(3,2)     - The J2000.0 geocentric Sun position and
!                               velocity vectors. (M, M/SEC)
!             5. TCTOCF(3,3,2)- The rotation matrix which rotates the
!                               topocentric reference system to the crust
!                               fixed reference system at each site. (unitless)
!             6. RTTOCF(3,3,2)- The rotation matrix which rotates the
!                               'radial-transverse' reference system to the
!                               crust fixed reference system at each site.
!             7. USITEP(3,2)  - The J2000.0 geocentric site position vectors
!                               uncorrected for Earth tidal effects. (M)
!             8. USITEV(3,2)  - The J2000.0 geocentric site velocity vectors
!                               uncorrected for Earth tidal effects. (M/SEC)
!             9. XMOON(3,2)   - The J2000.0 geocentric Moon position and
!                               velocity vectors. (M, M/SEC)
!            10. EARTH(3,3)   - The solar system barycentric Earth position,
!                               velocity, and acceleration vectors. The first
!                               index runs over the vector components and the
!                               second runs over the time derivatives.
!                               (m, m/sec, m/sec**2)
!            11. GAST(2)      - The Greenwich Apparent Siderial time and its
!                               CT time derivative. (RAD, RAD/SEC)
!            12. FA2K(14)     - The fundamental arguments (arcsec)
!            13. FAD2K(14)    - The CT time derivatives of the fundamental
!                               arguments. (arcsec/century)
!            14. CENT         - The number of Julian centuries elapsed since the
!                               epoch January 1.5, 2000. (centuries)
!            15. GEOLAT(2)    - The geocentric latitude at each site. (rad)
!
!           OUTPUT VARIABLES:
!             1. TIDEP(3,2)   - The corrections to the J2000.0 geocentric site
!                               position vectors due to Earth tidal effects at
!                               each site. (M)
!             2. TIDEV(3,2)   - The corrections to the J2000.0 geocentric site
!                               velocity vectors due to Earth tidal effects at
!                               each site. (M/SEC)
!
!     Common blocks used:
!
      INCLUDE 'ccon.i'
!          VARIABLES 'FROM':
!           1. KETDC  -  The module flow control flag.
!                        = 0 => Default, IERS 2003 Earth Tide Model.
!                        = 1 => Earth tide model OFF, no corrections computed.
!           2. KETDD  -  The debug output flag.
!
      INCLUDE 'cphys11.i'
!            Variables 'from':
!              2. GMMOON  - The mass of the Moon multiplied by the Universal
!                           gravitational constant. (M**3/SEC**2)
!              3. GMSUN   - The mass of the Sun multiplied by the Universal
!                           Gravitational constant. (M**3/SEC**2)
!              4. GMEARTH - The mass of the Earth multiplied by the Universal
!                           Gravitational constant. (M**3/SEC**2)
!              5. REARTH  - The equatorial radius of the Earth. (meters)
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         otherwise equals zero. For correlator usage.
!
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
!          Variables "From":
!            1. PI     - THE MATHEMATICAL CONSTANT PI (UNITLESS)
!            2. TWOPI  - PI * 2.0D0 (UNITLESS)
!            3. HALFPI - PI / 2.0D0 (UNITLESS)
!            4. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS (RAD/DEG)
!            5. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                        (RAD/ARCSECOND)
!            6. CONVHS - THE CONVERSION FACTOR FROM TIME SECONDS TO RADIANS
!                        (RADIANS / TIME SECOND)
!            7. SECDAY - THE NUMBER OF TIME SECONDS PER DAY (SECONDS / DAY)
!
!   Program specifications:
!
      Real*8 delta_r2(3,2),                                             &
     &       ddelta_r2(3,2), delta_r3(3,2), ddelta_r3(3,2),             &
     &       delta_r2_dh2(3,2), ddelta_r2_dh2(3,2),                     &
     &       delta_r2_dl2(3,2), ddelta_r2_dl2(3,2)
      Real*8 R2K  (3,3,3), SITLAT(2), SUN(3,2), TCTOCF(3,3,2),          &
     &       TIDEP(3,2), TIDEV(3,2), USITEP(3,2), USITEV(3,2),          &
     &       XMOON(3,2), SITLON(2),          EARTH(3,3), CENT,          &
     &       RTTOCF(3,3,2), GEOLAT(2), GAST2K(2), FA2K(14), FAD2K(14)
      Real*8 SunLat, SunLon, MoonLat, MoonLon, dSunLat, dSunLon,        &
     &       dMoonLat, dMoonLon
      Real*8 Vecmg, Dotp
      Real*8 r_vec(3),dr_vec(3), r_mag,dr_mag, r_hat(3),dr_hat(3),      &
     &       Rmoon(3),dRmoon(3), Rmoon_mag, dRmoon_mag,                 &
     &       Rmoon_hat(3),dRmoon_hat(3), Rmoon_dot_r,dRmoon_dot_r,      &
     &       Rsun(3),dRsun(3), Rsun_mag,dRsun_mag,                      &
     &       Rsun_hat(3),dRsun_hat(3), Rsun_dot_r,dRsun_dot_r,          &
     &       term1M,dterm1M, term2,dterm2, term3M,dterm3M,              &
     &       term4M,dterm4M, term1M_2,dterm1M_2, term1S,dterm1S,        &
     &       term3S,dterm3S, term4S,dterm4S, term1S_2,dterm1S_2
      Real*8 term5M, dterm5M, term5S, dterm5S
      Real*8 GSL2(2), Phi(2), h_sub_2, l_sub_2, h_sub_3, l_sub_3,       &
     &       term01M, dterm01M, term02, dterm02, term03M, dterm03M,     &
     &       term04M, dterm04M, term05M, dterm05M,                      &
     &       PHImoon, dPHImoon, Theta_moon, dTheta_moon,                &
     &       RA_moon, dRA_moon, Lamda_moon, dLamda_moon,                &
     &       P12_moon, P12_moon_a, P22_moon, P22_moon_a,                &
     &       dP12_moon, dP12_moon_a, dP22_moon, dP22_moon_a,            &
     &       PHIsun, dPHIsun, Theta_sun, dTheta_sun,                    &
     &       RA_sun, dRA_sun, Lamda_sun, dLamda_sun,                    &
     &       P12_sun, P12_sun_a, P22_sun, P22_sun_a,                    &
     &       dP12_sun, dP12_sun_a, dP22_sun, dP22_sun_a,                &
     &       TR2K  (3,3,2), CFRmoon(3), CFRsun(3), dCFRmoon(3),         &
     &       dCFRsun(3), CFM1(3), CFM2(3), CFRmoon_mag, dCFRmoon_mag,   &
     &       CFRsun_mag, dCFRsun_mag
      Real*8 topo11(3,2), dtopo11(3,2), CF11(3,2), dCF11(3,2),          &
     &       topo12(3,2), dtopo12(3,2), CF12(3,2), dCF12(3,2),          &
     &       topo13(3,2), dtopo13(3,2), CF13(3,2), dCF13(3,2),          &
     &       topo14(3,2), dtopo14(3,2), CF14(3,2), dCF14(3,2),          &
     &       topo15(3,2), dtopo15(3,2), CF15(3,2), dCF15(3,2),          &
     &       topo16(3,2), dtopo16(3,2), CF16(3,2), dCF16(3,2),          &
     &       vec1(3), vec2(3), T17A, T17B
      Real*8 delta11(3,2), ddelta11(3,2), delta12(3,2), ddelta12(3,2),  &
     &       delta13(3,2), ddelta13(3,2), delta14(3,2), ddelta14(3,2),  &
     &       delta15(3,2), ddelta15(3,2), delta16(3,2), ddelta16(3,2),  &
     &       l1_11, l1_12, h_I13, l_I13, h_I14, l_I14,                  &
     &       theta15(11), dtheta15(11), theta16(5), dtheta16(5)
      Real*8 CPhi, SPhi, C2Phi, S2Phi, CsqPhi, SsqPhi, CLamMoon,        &
     &       SLamMoon, CLLMoon, SLLMoon, C2LLMoon, S2LLMoon, dCLamMoon, &
     &       dSLamMoon, dCLLMoon, dSLLMoon, dC2LLMoon, dS2LLMoon,       &
     &       CPhiMoon, SPhiMoon, CsqPhiMoon, SsqPhiMoon, C2PhiMoon,     &
     &       S2PhiMoon, dCPhiMoon, dSPhiMoon, dCsqPhiMoon, dSsqPhiMoon, &
     &       dC2PhiMoon, dS2PhiMoon, CLamSun, SLamSun, CLLSun, SLLSun,  &
     &       C2LLSun, S2LLSun, dCLamSun, dSLamSun, dCLLSun, dSLLSun,    &
     &       dC2LLSun, dS2LLSun, CPhiSun, SPhiSun, CsqPhiSun,           &
     &       SsqPhiSun, C2PhiSun, S2PhiSun, dCPhiSun, dSPhiSun,         &
     &       dCsqPhiSun, dSsqPhiSun, dC2PhiSun, dS2PhiSun,              &
     &       C2LamMoon, S2LamMoon, C2LamSun, S2LamSun,                  &
     &       dC2LamMoon, dS2LamMoon, dC2LamSun, dS2LamSun
      Integer*4 C1, C2
!
      Data h_sub_3  /0.292D0/
      Data l_sub_3  /0.015D0/
!
      Real*4 Table75a(10,11), Table75b(10,5)
      Integer*4 itide, ll, kk, k, k8, L, J, I, jf
      Real*8 fund_arg(6), arg, dfund_arg(6), d_arg
      Real*8 geo_lat(2)
!
!  Table 7.5a, IERS Conventions (2003)
      Data Table75a / &
     &  1.,  0.,  2.,  0.,  2., -1., -0.08,  0.00, -0.01,  0.01,        &
     &  0.,  0.,  2.,  0.,  1., -1., -0.10,  0.00,  0.00,  0.00,        &
     &  0.,  0.,  2.,  0.,  2., -1., -0.51,  0.00, -0.02,  0.03,        &
     &  1.,  0.,  0.,  0.,  0., -1.,  0.06,  0.00,  0.00,  0.00,        &
     &  0.,  1.,  2., -2.,  2., -1., -0.06,  0.00,  0.00,  0.00,        &
     &  0.,  0.,  2., -2.,  2., -1., -1.23, -0.07,  0.06,  0.01,        &
     &  0.,  0.,  0.,  0., -1., -1., -0.22,  0.01,  0.01,  0.00,        &
     &  0.,  0.,  0.,  0.,  0., -1., 12.00, -0.78, -0.67, -0.03,        &
     &  0.,  0.,  0.,  0.,  1., -1.,  1.73, -0.12, -0.10,  0.00,        &
     &  0., -1.,  0.,  0.,  0., -1., -0.50, -0.01,  0.03,  0.00,        &
     &  0.,  0., -2.,  2., -2., -1., -0.11,  0.01,  0.01,  0.00 /
!
!  Table 7.5b, IERS Conventions (2003)
      Data Table75b / &
     &  0.,  0.,  0.,  0.,  1.,  0.,  0.47,  0.16,  0.23,  0.07,        &
     &  0.,  0., -2.,  2., -2.,  0., -0.20, -0.11, -0.12, -0.05,        &
     & -1.,  0.,  0.,  0.,  0.,  0., -0.11, -0.09, -0.08, -0.04,        &
     &  0.,  0., -2.,  0., -2.,  0., -0.13, -0.15, -0.11, -0.07,        &
     &  0.,  0., -2.,  0., -1.,  0., -0.05, -0.06, -0.05, -0.03 /
!
!     External input/output - Possible debug output.
!
!     Subroutine Interface:
!           Caller subroutines: DRIVG
!           Called subroutines: DCOS, DOTP, ROTATE, VECAD, VECRT, VECMG, VECSB
!
!     Constants used:  GMMOON, GMSUN, GMEARTH, REARTH
!
!    Program variables:
!
!       1. Rmoon(3), Rsun(3), dRmoon(3), dRsun(3) - Geocentric position and
!            velocity vectors of the Moon and the Sun. (m, m, m/s, m/s)
!       2. Rmoon_mag, dRmoon_mag, Rsun_mag, dRsun_mag - Magnitude of geocentric
!             vectors and their derivatives. (m, m, m/s, m/s)
!       3. Rmoon_hat(3), Rsun_hat(3), dRmoon_hat(3), dRsun_hat(3) - Geocentric
!             unit vectors and their derivatives. (unitless)
!       4. r_vec(3), dr_vec(3) - Geocentric position and velocity of current
!             site. (m, m/s)
!       5. r_mag, dr_mag - Magnitude of geocentric site vector and its
!             derivative. (m, m/s)
!       6. r_hat(3), dr_hat(3) -  Geocentric unit vector of current site and
!             its derivative. (unitless)
!       7. Rmoon_dot_r, dRmoon_dot_r, Rsun_dot_r, dRsun_dot_r - Dot products of
!             Moon/Sun unit vectors with site unit vector and their derivatives.
!       8. term---, dterm---  - terms used for the second and third order tide
!             and partials computations, too numerous to mention individually.
!       9. delta_r2(3,2)-The second order tidal displacement at each site. First
!             index is X,Y,Z. Second index runs over sites. (m)
!      10. ddelta_r2(3,2)-The second order tidal velocity at each site. First
!             index is X,Y,Z. Second index runs over sites. (m/s)
!      11. fund_arg(6) - The five fundamental arguments (fa(5))
!             converted to radians and the Greenwich apparent siderial time
!             plus PI. (radians)
!      12. dfund_arg(6) - Time derivatives of above. (radians/sec)
!      13. geo_lat(2) - The geocentric latitude of each site. (RAD)
!      14. SunLat  - The J2000 geocentric latitude (declination) of the Sun.
!      15. MoonLat - The J2000 geocentric latitude (declination) of the Moon.
!      16. SunLon  - The J2000 geocentric longitude (RA) of the Sun.
!      17. MoonLon - The J2000 geocentric longitude (RA) of the Moon.
!      18. delta_r3(3,2) - The third order tidal displacement at each site,
!             from the IERS 1996 model. First index runs over X,Y,Z;
!             second runs over sites. (meters)
!      19. ddelta_r3(3,2) - Time derivative of above, third order tidal
!             velocity. First index runs over X,Y,Z; second runs over sites.
!             (m/sec)
!
! 4.2.9 PROGRAMMER -
!           DALE MARKHAM  01/13/77
!           PETER DENATALE 07/12/77
!           BRUCE SCHUPLER 03/24/78
!           BRUCE SCHUPLER 11/02/78
!           BRUCE SCHUPLER 01/14/80
!           DAVID GORDON   07/20/84
!           Jim Ryan 89.06.29 Character strings and clean up.
!           Jim Ryan 89:10:05 CPHYS common made an include file.
!           David Gordon 93Oct/Nov. Added IERS tide computation,
!                        restructured subroutine, new KETDC options.
!           David Gordon 94.01.24 Third order tide components added.
!           David Gordon 94.01.27 Partials with respect to lag angle
!                        added.
!           David Gordon 94.04.05 Coding added to compute the six
!                        frequency dependent Love number correction
!                        vertical terms (K1, O1, P1, Psi, and 2
!                        unnamed terms). New terms will replace old
!                        K1 term in IERS tide computation (default).
!                        K1 left in old tide option.
!           David Gordon 94.04.06 Changed to 'Implicit None'
!           David Gordon 94.04.27 New common block 'tide_stuff'.
!           David Gordon 94.04.28 Term for change in Love/Shida #'s
!                        (r2_IERS) added. Separate terms kept for
!                        all non "pure" IERS contributions.
!           David Gordon 94.05.23 Removed second dimensioning of XK1V.
!           David Gordon 94.07.11 Changed absolute value of geocentric
!                        site radius to Earth's equatorial radius
!                        (REARTH) in second and third order tide
!                        computation. Added change to second order
!                        term to IERS-restorer variable. Reference
!                        is Sonny Mathews via John Gipson.
!           David Gordon 94.08.09 Changed Love numbers for
!                        Gipson/Mathews tides. Changed amplitudes for
!                        O1, P1, K1, Psi, ... terms. John Gipson
!                        Aug. 9, 1994 memo (reference #7 above).
!           David Gordon 94.08.25 Changed default back to IERS
!                        Standards. Three correction terms kept to
!                        convert to Gipson/Mathews Earth tide model.
!           David Gordon 96.01.10 Changing geodetic latitude to
!                        geocentric latitude for computation of K1
!                        and K1-plus tide corrections.
!           David Gordon 96.02.07 Changing 2 arguments (signs
!                        reversed) in Tide_arg and 3 amplitudes in
!                        Tide_val. See 96Feb06 J. Gipson memo.
!           David Gordon 98.05.06 Old (Calc 5/6/7) computations removed.
!                        Calc 8 computations moved into subroutine ETDC8.
!                        Calc 9 (1996 IERS Conventions) computations coded
!                        and put into subroutine ETDC9.
!           David Gordon 98.06.24 Subroutine ETDC8 deleted. Subroutine ETDG
!                        reduced to a driver for ETDC9.
!           David Gordon 98.07.29 Added 'Include cobsn.i' with
!                        variable Nzero, and code to skip topocentric
!                        computations for a station at the geocenter.
!           David Gordon 98.07.31 Subroutine ETDC9 folded back in to ETDG.
!                        Mods to set tides to zero for a geocenter station.
!           David Gordon 98.09.30 Finished coding Earth tide partials based
!                        on John Gipson's memo of 8 Sept. 1998. Restructured
!                        and simplifed earlier tide components and time
!                        derivatives. Removed all but DETDP9 from common
!                        block ETDCM. Removed the block data subprogram.
!           David Gordon 98.12.29 Corrected errors in Table73b, found by
!                        John Gipson.
!           David Gordon 99.01.06 Added call to subroutine ETDC8 to compute
!                        earlier Calc 8 Earth tide. Skipping of partials
!                        for correlator usage.
!           David Gordon 99.10.01 Adding 'Use_Tide' parameter to allow
!                        using the Calc 8 tide model at the correlators.
!           David Gordon 99.10.13 Added computation of permanent tide vectors.
!           David Gordon 99.10.18 Redefined 'Use_Tide' parameter to allow
!                        using the Calc 8 tide model, the Calc 9.0 model,
!                        or the real crust model at the correlators.
!           Jim Ryan     2002.09 Integer*4 conversion
!           David Gordon 2004 Updated Step 2 for IERS Conventions (2003).
!                        Removed Calc 8 tide call and Calc 9 partials.
!           David Gordon 2007.01.10. Corrected geocenter bug.
!
!****************************************************************************
!     ETDG PROGRAM STRUCTURE
!****************************************************************************
!
!  Check KETDC to determine if the Earth tide module is to be turned OFF.
      IF (KETDC .eq. 1)  Then
        DO 220  L = 1,2
          DO 210  I = 1,3
            TIDEP(I,L) = 0.D0
            TIDEV(I,L) = 0.D0
  210     CONTINUE
  220   CONTINUE
       RETURN
      ENDIF
!
!****************************************************************************
!     The Earth tide geometry for site #1 and site #2 are calculated
!     separately by running twice through a loop.
!     The program uses the IERS Conventions (2003) model.
!
!
! Preliminary Sun and Moon (station independent) quantities:
!
!   Vectors from the geocenter to the Moon and the Sun and their derivatives
       Do kk=1,3
         Rmoon(kk)  = XMOON(kk,1)
         dRmoon(kk) = XMOON(kk,2)
         Rsun(kk)  = SUN(kk,1)
         dRsun(kk) = SUN(kk,2)
       Enddo
!
!   Magnitude of vector from geocenter to the Moon and its derivative
       Rmoon_mag = vecmg(Rmoon)
       dRmoon_mag = Dotp(Rmoon,dRmoon)/Rmoon_mag
!
!   Magnitude of vector from geocenter to the Sun and its derivative
       Rsun_mag = vecmg(Rsun)
       dRsun_mag = Dotp(Rsun,dRsun)/Rsun_mag
!
!   Unit vectors from geocenter to the Moon and Sun and their derivatives
       call vunit(Rmoon,Rmoon_hat)
       call vunit(Rsun,Rsun_hat)
       do kk=1,3
        dRmoon_hat(kk) = dRmoon(kk)/Rmoon_mag - Rmoon(kk)*dRmoon_mag /  &
     &                   Rmoon_mag**2
        dRsun_hat(kk) = dRsun(kk)/Rsun_mag - Rsun(kk)*dRsun_mag /       &
     &                   Rsun_mag**2
       enddo
!
!  Get Crust-fixed latitude and longitude of the Sun and the Moon.
!  Rotate Moon and Sun vectors from the J2000 coordinate system to the
!  geocentric crust-fixed system.
!    First compute the rotation matrix which rotates from the J2000.0
!    reference system to the geocentric crust fixed system, and its
!    time derivative.
           CALL MTRAN ( R2K  (1,1,1), TR2K  (1,1,1) )
           CALL MTRAN ( R2K  (1,1,2), TR2K  (1,1,2) )
!    Then rotate the Moon and Sun unit vectors to the crust fixed system.
           CALL VECRT ( TR2K  (1,1,1),Rmoon(1),CFRmoon(1))
           CALL VECRT ( TR2K  (1,1,1),Rsun(1),CFRsun(1))
!    And find their derivatives in the crust fixed system
           CALL VECRT ( TR2K  (1,1,1),dRmoon,CFM1)
           CALL VECRT ( TR2K  (1,1,2), Rmoon,CFM2)
           CALL VECAD ( CFM1, CFM2, dCFRmoon )
           CALL VECRT ( TR2K  (1,1,1),dRsun,CFM1)
           CALL VECRT ( TR2K  (1,1,2), Rsun,CFM2)
           CALL VECAD ( CFM1, CFM2, dCFRsun )
!
      CFRmoon_mag = VECMG( CFRmoon )
      dCFRmoon_mag = DOTP( CFRmoon, dCFRmoon ) / CFRmoon_mag
!
      CFRsun_mag = VECMG( CFRsun )
      dCFRsun_mag = DOTP( CFRsun, dCFRsun ) / CFRsun_mag
!
!  Find body-fixed geocentric latitude of Sun/moon
      PHImoon  = DASIN( CFRmoon(3)/CFRmoon_mag )
      dPHImoon = ( dCFRmoon(3)/CFRmoon_mag - &
     &             CFRmoon(3)*dCFRmoon_mag/CFRmoon_mag**2 ) /           &
     &             DSQRT( 1.D0 - (CFRmoon(3)/CFRmoon_mag)**2 )
      PHIsun   = DASIN( CFRsun(3)/CFRsun_mag )
      dPHIsun  = ( dCFRsun(3)/CFRsun_mag -                              &
     &             CFRsun(3)*dCFRsun_mag/CFRsun_mag**2 ) /              &
     &             DSQRT( 1.D0 - (CFRsun(3)/CFRsun_mag)**2 )
!
!  Find body-fixed East longitude (from Greenwich) of moon
      Lamda_moon = DATAN2( CFRmoon(2),CFRmoon(1) )
      dLamda_moon =  1.D0 / ( 1.D0 + (CFRmoon(2)/CFRmoon(1))**2 )       &
     &      *  ( dCFRmoon(2)/CFRmoon(1) -                               &
     &        CFRmoon(2)*dCFRmoon(1)/CFRmoon(1)**2 )
!
!  Find body-fixed East longitude (from Greenwich) of Sun
      Lamda_sun = DATAN2( CFRsun(2),CFRsun(1) )
      dLamda_sun =  1.D0 / ( 1.D0 + (CFRsun(2)/CFRsun(1))**2 )          &
     &      * ( dCFRsun(2)/CFRsun(1) -                                  &
     &        CFRsun(2)*dCFRsun(1)/CFRsun(1)**2 )
!
!  Compute heavily used sine and cosine terms and derivatives of Sun and
!       Moon crust-fixed latitude and longitude
!
       CPhiMoon = DCOS(PhiMoon)
       SPhiMoon = DSIN(PhiMoon)
      dCPhiMoon = -SPhiMoon * dPhiMoon
      dSPhiMoon =  CPhiMoon * dPhiMoon
!
       CsqPhiMoon = CPhiMoon * CPhiMoon
       SsqPhiMoon = SPhiMoon * SPhiMoon
      dCsqPhiMoon = 2.D0 * CPhiMoon * dCPhiMoon
      dSsqPhiMoon = 2.D0 * SPhiMoon * dSPhiMoon
!
       C2PhiMoon = DCOS(2.D0*PhiMoon)
       S2PhiMoon = DSIN(2.D0*PhiMoon)
      dC2PhiMoon = -2.D0 * S2PhiMoon * dPhiMoon
      dS2PhiMoon =  2.D0 * C2PhiMoon * dPhiMoon
!
       CLamMoon = DCOS(Lamda_Moon)
       SLamMoon = DSIN(Lamda_Moon)
      dCLamMoon = -SLamMoon * dLamda_Moon
      dSLamMoon =  CLamMoon * dLamda_Moon
!
       C2LamMoon = DCOS(2.D0 * Lamda_Moon)
       S2LamMoon = DSIN(2.D0 * Lamda_Moon)
      dC2LamMoon = -S2LamMoon * 2.D0 * dLamda_Moon
      dS2LamMoon =  C2LamMoon * 2.D0 * dLamda_Moon
!
       CPhiSun  = DCOS(PhiSun )
       SPhiSun  = DSIN(PhiSun )
      dCPhiSun  = -SPhiSun  * dPhiSun
      dSPhiSun  =  CPhiSun  * dPhiSun
!
       CsqPhiSun  = CPhiSun  * CPhiSun
       SsqPhiSun  = SPhiSun  * SPhiSun
      dCsqPhiSun  = 2.D0 * CPhiSun  * dCPhiSun
      dSsqPhiSun  = 2.D0 * SPhiSun  * dSPhiSun
!
       C2PhiSun  = DCOS(2.D0*PhiSun )
       S2PhiSun  = DSIN(2.D0*PhiSun )
      dC2PhiSun  = -2.D0 * S2PhiSun  * dPhiSun
      dS2PhiSun  =  2.D0 * C2PhiSun  * dPhiSun
!
       CLamSun  = DCOS(Lamda_Sun )
       SLamSun  = DSIN(Lamda_Sun )
      dCLamSun  = -SLamSun  * dLamda_Sun
      dSLamSun  =  CLamSun  * dLamda_Sun
!
       C2LamSun = DCOS(2.D0 * Lamda_Sun)
       S2LamSun = DSIN(2.D0 * Lamda_Sun)
      dC2LamSun = -S2LamSun * 2.D0 * dLamda_Sun
      dS2LamSun =  C2LamSun * 2.D0 * dLamda_Sun
!
!    Delauney fundamental arguments, for Steps 2A and 2B:
!     Moved 2007.01.11
       DO LL=1,5
         FUND_ARG(LL) = FA2K(LL)
        DFUND_ARG(LL) = FAD2K(LL)      ! time derivative
       ENDDO
         FUND_ARG(6) = GAST2K(1) + PI
        DFUND_ARG(6) = GAST2K(2)
!        print *,' ETDG/GAST2K: ', GAST2K
!        print *,' ETDG/FUND_ARG (new): ', FUND_ARG
!
      If(KETDD .ne. 0) Then
       write(6,'(/,10x,"Debug from Subroutine ETDC9: KETDC =",I2)')KETDC
       write(6,8)' Rmoon        ', Rmoon
       write(6,8)' dRmoon       ', dRmoon
       write(6,8)' Rmoon_mag, dRmoon_mag ', Rmoon_mag, dRmoon_mag
       write(6,8)' Rmoon_hat    ', Rmoon_hat
       write(6,8)' dRmoon_hat   ', dRmoon_hat
       write(6,8)' Rsun         ', Rsun
       write(6,8)' dRsun        ', dRsun
       write(6,8)' Rsun_mag, dRsun_mag ', Rsun_mag, dRsun_mag
       write(6,8)' Rsun_hat     ', Rsun_hat
       write(6,8)' dRsun_hat    ', dRsun_hat
       write(6,8)' CFRmoon  ', CFRmoon
       write(6,8)' CFRsun  ', CFRsun
       write(6,8)' CFM1moon ', CFM1
       write(6,8)' CFM2moon ', CFM2
       write(6,8)' dCFRmoon ', dCFRmoon
       write(6,8)' CFM1sun ', CFM1
       write(6,8)' CFM2sun ', CFM2
       write(6,8)' dCFRsun ', dCFRsun
       write(6,8)' CFRmoon_mag, dCFRmoon_mag  ',CFRmoon_mag,dCFRmoon_mag
       write(6,8)' CFRsun_mag, dCFRsun_mag  ',CFRsun_mag,dCFRsun_mag
       write(6,8)' PHImoon, dPHImoon  ', PHImoon/CONVD, dPHImoon/CONVD
       write(6,8)' Lamda_moon, dLamda_moon ', Lamda_moon/CONVD,         &
     &                                        dLamda_moon/CONVD
       write(6,8)' PHIsun, dPHIsun  ', PHIsun/CONVD, dPHIsun/CONVD
       write(6,8)' Lamda_sun, dLamda_sun ', Lamda_sun/CONVD,            &
     &                                      dLamda_sun/CONVD
       write(6,8)' CPhiMoon, SPhiMoon  ', CPhiMoon, dCPhiMoon,          &
     &                                    SPhiMoon, dSPhiMoon
       write(6,8)' CsqPhiMoon, SsqPhiMoon  ', CsqPhiMoon, dCsqPhiMoon,  &
     &                                        SsqPhiMoon, dSsqPhiMoon
       write(6,8)' C2PhiMoon, S2PhiMoon  ', C2PhiMoon, dC2PhiMoon,      &
     &                                      S2PhiMoon, dS2PhiMoon
       write(6,8)' CLamMoon, SLamMoon  ', CLamMoon, dCLamMoon,          &
     &                                    SLamMoon, dSLamMoon
       write(6,8)' C2LamMoon, S2LamMoon  ', C2LamMoon, dC2LamMoon,      &
     &                                    S2LamMoon, dS2LamMoon
       write(6,8)' CPhiSun, SPhiSun  ', CPhiSun, dCPhiSun,              &
     &                                   SPhiSun, dSPhiSun
       write(6,8)' CsqPhiSun, SsqPhiSun  ', CsqPhiSun, dCsqPhiSun,      &
     &                                      SsqPhiSun, dSsqPhiSun
       write(6,8)' C2PhiSun, S2PhiSun  ', C2PhiSun, dC2PhiSun,          &
     &                                    S2PhiSun, dS2PhiSun
       write(6,8)' CLamSun, SLamSun  ', CLamSun, dCLamSun,              &
     &                                  SLamSun, dSLamSun
       write(6,8)' C2LamSun, S2LamSun  ', C2LamSun, dC2LamSun,          &
     &                                    S2LamSun, dS2LamSun
       write(6,8)' GMMOON  ',GMMOON
       write(6,8)' GMSUN   ',GMSUN
       write(6,8)' GMEARTH ',GMEARTH
       write(6,8)' REARTH ',REARTH
       write(6,8)'  fund_arg ',  fund_arg
       write(6,8)' dfund_arg ', dfund_arg
      Endif
!
!******************************************************************
!   Loop through twice for sites 1 and 2
!
      DO k=1,2                                  !Loop over sites
!
! First check for geocenter station. There should be no tidal effects at the
!  geocenter.
      IF (Nzero .eq. k) THEN
!      print *,'ETDG: Zero site found '
         Do kk=1,3
          TIDEP(kk,k) = 0.D0
          TIDEV(kk,k) = 0.D0
         Enddo
       GO TO 100
      ENDIF
!
!   Vector from geocenter to site #k and its derivative
       do kk = 1,3
        r_vec(kk)  = USITEP(kk,k)
        dr_vec(kk) = USITEV(kk,k)
       enddo
!   Magnitude of vector from geocenter to site #k (r_vec) and its derivative
!     (Derivative should be zero)
       r_mag = vecmg(r_vec)
!         dr_mag = Dotp(r_vec,dr_vec)/r_mag
       dr_mag = 0.D0
!   Unit vector from geocenter to site # k and its derivative
!         write(6,*) 'k, r_vec: ', k, r_vec
       call vunit(r_vec,r_hat)
       do kk=1,3
        dr_hat(kk) = dr_vec(kk)/r_mag - r_vec(kk)*dr_mag/r_mag**2
       enddo
!
!   Dot product of unit Moon vector with unit site vector and its derivative
       Rmoon_dot_r  = Dotp(Rmoon_hat,r_hat)
       dRmoon_dot_r = Dotp(Rmoon_hat,dr_hat) +                          &
     &                Dotp(dRmoon_hat,r_hat)
!
!   Dot product of unit Sun vector with unit site vector and its derivative
       Rsun_dot_r = Dotp(Rsun_hat,r_hat)
       dRsun_dot_r = Dotp(Rsun_hat,dr_hat) +                            &
     &                Dotp(dRsun_hat,r_hat)
!
!   Geocentric latitude:
        Phi(k) = GEOLAT(k)
!
!--------------------------------------------------------------------------
!  Compute heavily used sine and cosine terms and derivatives
!
       CLLMoon = DCOS(SITLON(k) - Lamda_moon)
       SLLMoon = DSIN(SITLON(k) - Lamda_moon)
      dCLLMoon = -SLLMoon * (-dLamda_moon)
      dSLLMoon =  CLLMoon * (-dLamda_moon)
!
       C2LLMoon = DCOS(2.D0 * (SITLON(k) - Lamda_moon))
       S2LLMoon = DSIN(2.D0 * (SITLON(k) - Lamda_moon))
      dC2LLMoon = -S2LLMoon * 2.D0 * (-dLamda_moon)
      dS2LLMoon =  C2LLMoon * 2.D0 * (-dLamda_moon)
!
       CLLSun  = DCOS(SITLON(k) - Lamda_sun )
       SLLSun  = DSIN(SITLON(k) - Lamda_sun )
      dCLLSun  = -SLLSun  * (-dLamda_sun)
      dSLLSun  =  CLLSun  * (-dLamda_sun)
!
       C2LLSun  = DCOS(2.D0 * (SITLON(k) - Lamda_sun ))
       S2LLSun  = DSIN(2.D0 * (SITLON(k) - Lamda_sun ))
      dC2LLSun  = -S2LLSun  * 2.D0 * (-dLamda_sun)
      dS2LLSun  =  C2LLSun  * 2.D0 * (-dLamda_sun)
!
!  Constant (nearly) quantities
       CPhi   = DCOS(Phi(k))
       SPhi   = DSIN(Phi(k))
       C2Phi  = DCOS(2.D0*Phi(k))
       S2Phi  = DSIN(2.D0*Phi(k))
       CsqPhi = CPhi * CPhi
       SsqPhi = SPhi * SPhi
!
!--------------------------------------------------------------------------
!   Elastic case with latitude dependence:
!      h_sub_2 = .6026D0 - .0006D0 * (1.5*SsqPhi - .5D0)
!      l_sub_2 = .0831D0 + .0002D0 * (1.5*SsqPhi - .5D0)
!   Anelastic case with latitude dependence:
       h_sub_2 = .6078D0 - .0006D0 * (1.5D0*SsqPhi - .5D0)
       l_sub_2 = .0847D0 + .0002D0 * (1.5D0*SsqPhi - .5D0)
!
       term1M = GMMOON / Rmoon_mag**3
       dterm1M = -3.D0 * GMMOON * dRmoon_mag / Rmoon_mag**4
       term1S = GMSUN / Rsun_mag**3
       dterm1S = -3.D0 * GMSUN * dRsun_mag / Rsun_mag**4
!
       term2  =  REARTH**4 / GMEARTH
       dterm2  =  0.D0
!
       term3M  = h_sub_2 * (1.5D0 * (Rmoon_dot_r)**2 - .5D0)
       dterm3M = h_sub_2 * 3.D0 * (Rmoon_dot_r) * dRmoon_dot_r
       term3S  = h_sub_2 * (1.5D0 * (Rsun_dot_r)**2 - .5D0)
       dterm3S = h_sub_2 * 3.D0 * (Rsun_dot_r) * dRsun_dot_r
!
       term4M  =  3.D0 * l_sub_2 * Rmoon_dot_r
       dterm4M =  3.D0 * l_sub_2 * dRmoon_dot_r
       term4S  =  3.D0 * l_sub_2 * Rsun_dot_r
       dterm4S =  3.D0 * l_sub_2 * dRsun_dot_r
!
       term5M  =  -3.D0 * l_sub_2 * Rmoon_dot_r**2
       dterm5M =  -6.D0 * l_sub_2 * Rmoon_dot_r * dRmoon_dot_r
       term5S  =  -3.D0 * l_sub_2 * Rsun_dot_r**2
       dterm5S =  -6.D0 * l_sub_2 * Rsun_dot_r * dRsun_dot_r
!
       term1M_2 =  term1M * term2
       dterm1M_2 = dterm1M*term2 + term1M*dterm2
!
       term1S_2 = term1S * term2
       dterm1S_2 = dterm1S*term2 + term1S*dterm2
!
!  Step 1A: Degree 2 tides, using Equation 8, p. 61, IERS Technical Note 21,
!   IERS Conventions (1996).
       do kk = 1,3
         delta_r2(kk,k) = term1M_2 * ( term3M * r_hat(kk)               &
     &                               + term4M * Rmoon_hat(kk)           &
     &                               + term5M * r_hat(kk) )             &
     &                  + term1S_2 * ( term3S * r_hat(kk)               &
     &                               + term4S * Rsun_hat(kk)            &
     &                               + term5S * r_hat(kk) )
!
!       ddelta_r2(kk,k) = dterm1M_2 * ( term3M * r_hat(kk) &
!    &                               + term4M * Rmoon_hat(kk) &
!    &                               + term5M * r_hat(kk) ) &
!    &       + term1M_2 * ( dterm3M * r_hat(kk) + term3M * dr_hat(kk) &
!    &            + dterm4M * Rmoon_hat(kk) + term4M * dRmoon_hat(kk) &
!    &                    + dterm5M * r_hat(kk) + term5M * dr_hat(kk) ) &
!    &                 + dterm1S_2 * ( term3S * r_hat(kk) &
!    &                               + term4S * Rsun_hat(kk) &
!    &                               + term5S * r_hat(kk) ) &
!    &       + term1S_2 * ( dterm3S * r_hat(kk) + term3S * dr_hat(kk) &
!    &            + dterm4S * Rsun_hat(kk) + term4S * dRsun_hat(kk) &
!    &                    + dterm5S * r_hat(kk) + term5S * dr_hat(kk) )
!
        ddelta_r2(kk,k) = dterm1M_2 * ( term3M * r_hat(kk) +            &
     &              term4M * Rmoon_hat(kk) + term5M * r_hat(kk) ) +     &
     &         term1M_2 * ( dterm3M * r_hat(kk) + term3M * dr_hat(kk) + &
     &              dterm4M * Rmoon_hat(kk) + term4M * dRmoon_hat(kk) + &
     &                   dterm5M * r_hat(kk) + term5M * dr_hat(kk) ) +  &
     &                  dterm1S_2 * ( term3S * r_hat(kk) + &
     &                  term4S * Rsun_hat(kk) + term5S * r_hat(kk) ) +  &
     &         term1S_2 * ( dterm3S * r_hat(kk) + term3S * dr_hat(kk) + &
     &              dterm4S * Rsun_hat(kk) + term4S * dRsun_hat(kk) +   &
     &                      dterm5S * r_hat(kk) + term5S * dr_hat(kk) )
!
       enddo
!
!  Partials of second order tide with respect to h2 and l2:
       do kk = 1,3
         delta_r2_dh2(kk,k) = term1M_2 * term3M/h_sub_2 * r_hat(kk)     &
     &                      + term1S_2 * term3S/h_sub_2 * r_hat(kk)
         delta_r2_dl2(kk,k) = term1M_2 * (term4M/l_sub_2 * Rmoon_hat(kk) &
     &                                 +  term5M/l_sub_2 * r_hat(kk) )  &
     &                      + term1S_2 * (term4S/l_sub_2 * Rsun_hat(kk) &
     &                                 +  term5S/l_sub_2 * r_hat(kk) )
!
        ddelta_r2_dh2(kk,k) = dterm1M_2 * term3M/h_sub_2 * r_hat(kk)    &
     &       + term1M_2 * (dterm3M/h_sub_2 * r_hat(kk) + term3M/h_sub_2 &
     &             * dr_hat(kk)) &
     &       + dterm1S_2 * term3S/h_sub_2 * r_hat(kk) &
     &       + term1S_2 * (dterm3S/h_sub_2 * r_hat(kk) + term3S/h_sub_2 &
     &             * dr_hat(kk))
!
!       ddelta_r2_dl2(kk,k) = dterm1M_2 * (term4M/l_sub_2 *Rmoon_hat(kk) &
!    &                          + term5M/l_sub_2 * r_hat(kk) ) &
!    &     + term1M_2 * ( dterm4M/l_sub_2 * Rmoon_hat(kk) + &
!    &                      term4M/l_sub_2 * dRmoon_hat(kk) &
!    &     + dterm5M/l_sub_2 * r_hat(kk) + term5M/l_sub_2 * dr_hat(kk))
!    &     + dterm1S_2 * (term4S/l_sub_2 * Rsun_hat(kk) &
!    &         + term5S/l_sub_2 * r_hat(kk) ) &
!    &       + term1S_2 * (dterm4S/l_sub_2 * Rsun_hat(kk) &
!    &         + term4S/l_sub_2 * dRsun_hat(kk) &
!    &         + dterm5S/l_sub_2 * r_hat(kk) + term5S/l_sub_2 &
!    &         * dr_hat(kk) )
!
        ddelta_r2_dl2(kk,k) = dterm1M_2 * (term4M/l_sub_2               &
     &      * Rmoon_hat(kk) + term5M/l_sub_2 * r_hat(kk) ) +            &
     &       term1M_2 * ( dterm4M/l_sub_2 * Rmoon_hat(kk) +             &
     &       term4M/l_sub_2 * dRmoon_hat(kk) + &
     &       dterm5M/l_sub_2 * r_hat(kk) + term5M/l_sub_2 * dr_hat(kk)) &
     &     + dterm1S_2 * (term4S/l_sub_2 * Rsun_hat(kk) +               &
     &       term5S/l_sub_2 * r_hat(kk) ) +                             &
     &       term1S_2 * (dterm4S/l_sub_2 * Rsun_hat(kk) +               &
     &       term4S/l_sub_2 * dRsun_hat(kk) +                           &
     &       dterm5S/l_sub_2 * r_hat(kk) + term5S/l_sub_2 * dr_hat(kk) )
       enddo
!
!  Tide difference if elastic case used instead of anelastic case
!      Do kk = 1,3
!       ELASP(kk,k) = -.0052* delta_r2_dh2(kk,k) +
!    *                -.0016* delta_r2_dl2(kk,k)
!       ELASV(kk,k) = -.0052*ddelta_r2_dh2(kk,k) +
!    *                -.0016*ddelta_r2_dl2(kk,k)
!      Enddo
!
       term01M = GMMOON / Rmoon_mag**4
       dterm01M = -4.D0 * GMMOON * dRmoon_mag / Rmoon_mag**5
!
       term02  =  REARTH**5 / GMEARTH
       dterm02  =  0.D0
!
       term03M  = h_sub_3 * (2.5D0*Rmoon_dot_r**3 - 1.5D0*Rmoon_dot_r)
       dterm03M = h_sub_3 * (7.5D0*Rmoon_dot_r**2*dRmoon_dot_r -        &
     &                       1.5D0*dRmoon_dot_r)
       term04M  = l_sub_3 * (7.5D0*Rmoon_dot_r**2 - 1.5D0)
       dterm04M = l_sub_3 * (15.D0*Rmoon_dot_r*dRmoon_dot_r)
!
       term05M  = -l_sub_3 * (7.5D0*Rmoon_dot_r**3 - 1.5D0*Rmoon_dot_r)
       dterm05M = -l_sub_3 * (22.5D0*Rmoon_dot_r**2*dRmoon_dot_r        &
     &                     - 1.5D0*dRmoon_dot_r)
!
!  Step 1B: Degree 3 tides, using Equation 9, p. 61, IERS Technical Note 21,
!  IERS Conventions (1996).
       Do kk = 1,3
         delta_r3(kk,k) = term01M*term02 *                              &
     &       ( term03M*r_hat(kk) +                                      &
     &         term04M*Rmoon_hat(kk) +                                  &
     &         term05M*r_hat(kk) )
!
         ddelta_r3(kk,k) = dterm01M*term02 * ( term03M*r_hat(kk) +      &
     &         term04M*Rmoon_hat(kk) +  term05M*r_hat(kk) )             &
     &    + term01M*term02 * ( dterm03M*r_hat(kk) + term03M*dr_hat(kk)  &
     &    +    dterm04M*Rmoon_hat(kk) + term04M*dRmoon_hat(kk)          &
     &    +    dterm05M*r_hat(kk) +  term05M*dr_hat(kk) )
       Enddo
!
! Step 1D, Contributions from latitude dependence
!    Equations 11 and 12, page 62
!
!   Legendre polynomials - Moon
       P12_moon = 3.D0 * CFRmoon(1) * CFRmoon(3) / CFRmoon_mag**2 /     &
     &             CLamMoon
       dP12_moon =                                                      &
     &   3.D0*dCFRmoon(1)*CFRmoon(3)/CFRmoon_mag**2/CLamMoon            &
     & + 3.D0*CFRmoon(1)*dCFRmoon(3)/CFRmoon_mag**2/CLamMoon            &
     & - 6.D0*CFRmoon(1)*CFRmoon(3) * dCFRmoon_mag / CFRmoon_mag**3     &
     &        /CLamMoon                                                 &
     & + 3.D0*CFRmoon(1)*CFRmoon(3)/CFRmoon_mag**2 *                    &
     &        (-dCLamMoon)  / CLamMoon**2
!
       P22_moon =                                                       &
     &     (3.D0 / CFRmoon_mag**2) * (CFRmoon(1)**2 - CFRmoon(2)**2) /  &
     &         C2LamMoon
       dP22_moon =                                                      &
     &   (3.D0 / CFRmoon_mag**2) * ( 2.D0*CFRmoon(1)*dCFRmoon(1) -      &
     &     2.D0*CFRmoon(2)*dCFRmoon(2)  ) / C2LamMoon                   &
     & - (6.D0*dCFRmoon_mag/CFRmoon_mag**3) * (CFRmoon(1)**2 -          &
     &     CFRmoon(2)**2) / C2LamMoon                                   &
     & + (3.D0 / CFRmoon_mag**2) * (CFRmoon(1)**2 - CFRmoon(2)**2) *    &
     &    (-dC2LamMoon) / C2LamMoon**2
!
!   Legendre polynomials - Sun
       P12_sun = 3.D0 * CFRsun(1) * CFRsun(3) / CFRsun_mag**2 /         &
     &            CLamSun
       dP12_sun = &
     &   3.D0*dCFRsun(1)*CFRsun(3)/CFRsun_mag**2/CLamSun                &
     & + 3.D0*CFRsun(1)*dCFRsun(3)/CFRsun_mag**2/CLamSun                &
     & - 6.D0*CFRsun(1)*CFRsun(3) * dCFRsun_mag / CFRsun_mag**3         &
     &        /CLamSun                                                  &
     & + 3.D0*CFRsun(1)*CFRsun(3)/CFRsun_mag**2 *                       &
     &        (-dCLamSun) / CLamSun**2
!
       P22_sun  = &
     &     (3.D0 / CFRsun_mag**2) * (CFRsun(1)**2 - CFRsun(2)**2) /     &
     &         C2LamSun
       dP22_sun  =                                                      &
     &   (3.D0 / CFRsun_mag**2) * ( 2.D0*CFRsun(1)*dCFRsun(1) -         &
     &     2.D0*CFRsun(2)*dCFRsun(2) ) / C2LamSun                       &
     & - (6.D0*dCFRsun_mag/CFRsun_mag**3) * (CFRsun(1)**2 -             &
     &     CFRsun(2)**2) / C2LamSun                                     &
     & + (3.D0 / CFRsun_mag**2) * (CFRsun(1)**2 - CFRsun(2)**2) *       &
     &    (-dC2LamSun) / C2LamSun**2
!
! Step 1D1: Equation 11, page 62, topocentric contribution from the diurnal
!   band (with l_1 = 0.0012)
        l1_11 = 0.0012D0
!  Up
        topo11(1,k) = 0.D0
       dtopo11(1,k) = 0.D0
!  East
       topo11(2,k) =  l1_11 * SPhi * term1M_2 * P12_moon * C2Phi*SLLMoon &
     &              + l1_11 * SPhi * term1S_2 * P12_sun  * C2Phi *SLLSun
      dtopo11(2,k) = &
     &        l1_11 * SPhi * dterm1M_2 * P12_moon * C2Phi * SLLMoon     &
     &     +  l1_11 * SPhi * term1M_2 * dP12_moon * C2Phi * SLLMoon     &
     &     +  l1_11 * SPhi * term1M_2 * P12_moon * C2Phi  * dSLLMoon    &
     &     +  l1_11 * SPhi * dterm1S_2 * P12_sun * C2Phi * SLLSun       &
     &     +  l1_11 * SPhi * term1S_2 * dP12_sun * C2Phi * SLLSun       &
     &     +  l1_11 * SPhi * term1S_2 * P12_sun  * C2Phi * dSLLSun
!
!  North
       topo11(3,k) = -l1_11 * SPhi**2 * term1M_2 * P12_moon * CLLMoon   &
     &              - l1_11 * SPhi**2 * term1S_2 * P12_sun  * CLLSun
      dtopo11(3,k) = -l1_11 * SPhi**2 * dterm1M_2 * P12_moon * CLLMoon  &
     &         -  l1_11 * SPhi**2 * term1M_2 * dP12_moon * CLLMoon      &
     &         -  l1_11 * SPhi**2 * term1M_2 * P12_moon  * dCLLMoon     &
     &         -  l1_11 * SPhi**2 * dterm1S_2 * P12_sun * CLLSun        &
     &         -  l1_11 * SPhi**2 * term1S_2 * dP12_sun * CLLSun        &
     &         -  l1_11 * SPhi**2 * term1S_2 * P12_sun * dCLLSun
!
!  Rotate vectors from topocentric to crust-fixed and then from crust-fixed
!   to J2000.
       CALL VECRT( RTTOCF(1,1,k), topo11(1,k), CF11(1,k) )
       CALL VECRT( R2K  (1,1,1), CF11(1,k), delta11(1,k) )
!
       CALL VECRT( RTTOCF(1,1,k), dtopo11(1,k), dCF11(1,k) )
       CALL VECRT( R2K  (1,1,1), dCF11(1,k), vec1 )
       CALL VECRT( R2K  (1,1,2),  CF11(1,k), vec2 )
       CALL VECAD( vec1, vec2, ddelta11(1,k) )
!
! Step 1D2: Equation 12, page 62, topocentric contribution from the
!   semidiurnal band (with l_1 = 0.0024)
        l1_12 = 0.0024D0
!  Up
       topo12(1,k) = 0.D0
      dtopo12(1,k) = 0.D0
!  East
       topo12(2,k) = -0.5D0 * l1_12 * SPhi * CPhi * term1M_2 * P22_moon &
     &                      * SPhi * S2LLMoon &
     &    -           0.5D0 * l1_12 * SPhi * CPhi * term1S_2 * P22_sun  &
     &                      * SPhi * S2LLSun
      dtopo12(2,k) = &
     &    -0.5D0 * l1_12 * SPhi * CPhi * dterm1M_2 * P22_moon           &
     &         * SPhi * S2LLMoon - &
     &     0.5D0 * l1_12 * SPhi * CPhi * term1M_2 * dP22_moon           &
     &         * SPhi * S2LLMoon - &
     &     0.5D0 * l1_12 * SPhi * CPhi * term1M_2 * P22_moon            &
     &         * SPhi * dS2LLMoon - &
     &     0.5D0 * l1_12 * SPhi * CPhi * dterm1S_2 * P22_sun            &
     &         * SPhi * S2LLSun - &
     &     0.5D0 * l1_12 * SPhi * CPhi  * term1S_2 * dP22_sun           &
     &         * SPhi * S2LLSun - &
     &     0.5D0 * l1_12 * SPhi * CPhi * term1S_2 * P22_sun             &
     &         * SPhi * dS2LLSun
!  North
       topo12(3,k) =                                                    &
     &   -0.5D0 * l1_12 * SPhi * CPhi * term1M_2 * P22_moon * C2LLMoon  &
     &  - 0.5D0 * l1_12 * SPhi * CPhi * term1S_2 * P22_sun  * C2LLSun
!
      dtopo12(3,k) =                                                    &
     &   -0.5D0 * l1_12 * SPhi * CPhi * dterm1M_2 * P22_moon * C2LLMoon &
     &  - 0.5D0 * l1_12 * SPhi * CPhi * term1M_2 * dP22_moon * C2LLMoon &
     &  - 0.5D0 * l1_12 * SPhi * CPhi * term1M_2 * P22_moon * dC2LLMoon &
     &  - 0.5D0 * l1_12 * SPhi * CPhi * dterm1S_2 * P22_sun * C2LLSun   &
     &  - 0.5D0 * l1_12 * SPhi * CPhi * term1S_2 * dP22_sun * C2LLSun   &
     &  - 0.5D0 * l1_12 * SPhi * CPhi * term1S_2 * P22_sun * dC2LLSun
!
!  Rotate vectors from topocentric to crust-fixed and then from crust-fixed
!   to J2000.
       CALL VECRT( RTTOCF(1,1,k), topo12(1,k), CF12(1,k) )
       CALL VECRT( R2K  (1,1,1), CF12(1,k), delta12(1,k) )
!
       CALL VECRT( RTTOCF(1,1,k), dtopo12(1,k), dCF12(1,k) )
       CALL VECRT( R2K  (1,1,1), dCF12(1,k), vec1 )
       CALL VECRT( R2K  (1,1,2),  CF12(1,k), vec2 )
       CALL VECAD( vec1, vec2, ddelta12(1,k) )
!
!
!  Step 1C1. Equation 13, Out-of-Phase for degree 2 only, diurnal components
       h_I13 = -0.0025D0
       l_I13 = -0.0007D0
!
!   Equation 13A: Up component
       topo13(1,k) =                                                    &
     &  -.75D0 * h_I13 * term1M_2 * S2PhiMoon * S2Phi * SLLMoon         &
     &  -.75D0 * h_I13 * term1S_2 * S2PhiSun  * S2Phi * SLLSun
       dtopo13(1,k) =                                                   &
     &  -.75D0 * h_I13 * dterm1M_2 * S2PhiMoon * S2Phi * SLLMoon        &
     &  -.75D0 * h_I13 * term1M_2 * dS2PhiMoon * S2Phi * SLLMoon        &
     &  -.75D0 * h_I13 * term1M_2 * S2PhiMoon  * S2Phi * dSLLMoon       &
     &  -.75D0 * h_I13 * dterm1S_2 * S2PhiSun * S2Phi * SLLSun          &
     &  -.75D0 * h_I13 * term1S_2 * dS2PhiSun * S2Phi * SLLSun          &
     &  -.75D0 * h_I13 * term1S_2 * S2PhiSun  * S2Phi * dSLLSun
!
!    Equation 13B: East component
       topo13(2,k) =                                                    &
     &  -1.5D0 * l_I13 * term1M_2 * S2PhiMoon * SPhi * CLLMoon          &
     &  -1.5D0 * l_I13 * term1S_2 * S2PhiSun  * SPhi * CLLSun
       dtopo13(2,k) =                                                   &
     &  -1.5D0 * l_I13 * dterm1M_2 * S2PhiMoon  * SPhi * CLLMoon        &
     &  -1.5D0 * l_I13 * term1M_2  * dS2PhiMoon * SPhi * CLLMoon        &
     &  -1.5D0 * l_I13 * term1M_2  * S2PhiMoon  * SPhi * dCLLMoon       &
     &  -1.5D0 * l_I13 * dterm1S_2 * S2PhiSun  * SPhi * CLLSun          &
     &  -1.5D0 * l_I13 * term1S_2  * dS2PhiSun * SPhi * CLLSun          &
     &  -1.5D0 * l_I13 * term1S_2  * S2PhiSun  * SPhi * dCLLSun
!
!    Equation 13B: North component
       topo13(3,k) =                                                    &
     &  -1.5D0 * l_I13 * term1M_2 * S2PhiMoon * C2Phi * SLLMoon         &
     &  -1.5D0 * l_I13 * term1S_2 * S2PhiSun  * C2Phi * SLLSun
       dtopo13(3,k) = &
     &  -1.5D0 * l_I13 * dterm1M_2 * S2PhiMoon * C2Phi * SLLMoon        &
     &  -1.5D0 * l_I13 * term1M_2 * dS2PhiMoon * C2Phi * SLLMoon        &
     &  -1.5D0 * l_I13 * term1M_2 * S2PhiMoon * C2Phi * dSLLMoon        &
     &  -1.5D0 * l_I13 * dterm1S_2 * S2PhiSun * C2Phi * SLLSun          &
     &  -1.5D0 * l_I13 * term1S_2 * dS2PhiSun * C2Phi * SLLSun          &
     &  -1.5D0 * l_I13 * term1S_2 * S2PhiSun * C2Phi * dSLLSun
!
!  Rotate vectors from topocentric to crust-fixed and then from crust-fixed
!   to J2000.
       CALL VECRT( RTTOCF(1,1,k), topo13(1,k), CF13(1,k) )
       CALL VECRT( R2K  (1,1,1), CF13(1,k), delta13(1,k) )
!
       CALL VECRT( RTTOCF(1,1,k), dtopo13(1,k), dCF13(1,k) )
       CALL VECRT( R2K  (1,1,1), dCF13(1,k), vec1 )
       CALL VECRT( R2K  (1,1,2),  CF13(1,k), vec2 )
       CALL VECAD( vec1, vec2, ddelta13(1,k) )
!
!  Step 1C2. Equation 14, Out-of-Phase for degree 2 only, semidiurnal
!   components
       h_I14 = -0.0022D0
       l_I14 = -0.0007D0
!
!    Equation 14A: Up component
       topo14(1,k) =                                                    &
     &  -.75D0 * h_I14 * term1M_2 * CsqPhiMoon * Cphi**2 * S2LLMoon     &
     &  -.75D0 * h_I14 * term1S_2 * CsqPhiSun  * Cphi**2 * S2LLSun
       dtopo14(1,k) =                                                   &
     &  -.75D0 * h_I14 * dterm1M_2 * CsqPhiMoon * Cphi**2 * S2LLMoon    &
     &  -.75D0 * h_I14 * term1M_2 * dCsqPhiMoon * Cphi**2 * S2LLMoon    &
     &  -.75D0 * h_I14 * term1M_2 * CsqPhiMoon * Cphi**2 * dS2LLMoon    &
     &  -.75D0 * h_I14 * dterm1S_2 * CsqPhiSun * Cphi**2 * S2LLSun      &
     &  -.75D0 * h_I14 * term1S_2 * dCsqPhiSun * Cphi**2 * S2LLSun      &
     &  -.75D0 * h_I14 * term1S_2 * CsqPhiSun * Cphi**2 * dS2LLSun
!
!    Equation 14B: East component
       topo14(2,k) =                                                    &
     &   .75D0 * l_I14 * term1M_2 * CsqPhiMoon * (-2.D0)*CPhi * C2LLMoon  &
     & + .75D0 * l_I14 * term1S_2 * CsqPhiSun  * (-2.D0)*CPhi * C2LLSun
       dtopo14(2,k) =                                                   &
     &   .75D0 * l_I14 * dterm1M_2 * CsqPhiMoon * (-2.D0)*CPhi * C2LLMoon &
     & + .75D0 * l_I14 * term1M_2 * dCsqPhiMoon * (-2.D0)*CPhi * C2LLMoon &
     & + .75D0 * l_I14 * term1M_2 * CsqPhiMoon * (-2.D0)*CPhi * dC2LLMoon &
     & + .75D0 * l_I14 * dterm1S_2 * CsqPhiSun * (-2.D0)*CPhi * C2LLSun   &
     & + .75D0 * l_I14 * term1S_2 * dCsqPhiSun * (-2.D0)*CPhi * C2LLSun   &
     & + .75D0 * l_I14 * term1S_2 * CsqPhiSun  * (-2.D0)*CPhi * dC2LLSun
!
!    Equation 14B: North component
       topo14(3,k) =                                                    &
     &   .75D0 * l_I14 * term1M_2 * CsqPhiMoon * S2Phi * S2LLMoon       &
     & + .75D0 * l_I14 * term1S_2 * CsqPhiSun  * S2Phi * S2LLSun
       dtopo14(3,k) =                                                   &
     &   .75D0 * l_I14 * dterm1M_2 * CsqPhiMoon * S2Phi * S2LLMoon      &
     & + .75D0 * l_I14 * term1M_2 * dCsqPhiMoon * S2Phi * S2LLMoon      &
     & + .75D0 * l_I14 * term1M_2 * CsqPhiMoon * S2Phi * dS2LLMoon      &
     & + .75D0 * l_I14 * dterm1S_2 * CsqPhiSun * S2Phi * S2LLSun        &
     & + .75D0 * l_I14 * term1S_2 * dCsqPhiSun * S2Phi * S2LLSun        &
     & + .75D0 * l_I14 * term1S_2 * CsqPhiSun  * S2Phi * dS2LLSun
!
!  Rotate vectors from topocentric to crust-fixed and then from crust-fixed
!   to J2000.
       CALL VECRT( RTTOCF(1,1,k), topo14(1,k), CF14(1,k) )
       CALL VECRT( R2K  (1,1,1), CF14(1,k), delta14(1,k) )
!
       CALL VECRT( RTTOCF(1,1,k), dtopo14(1,k), dCF14(1,k) )
       CALL VECRT( R2K  (1,1,1), dCF14(1,k), vec1 )
       CALL VECRT( R2K  (1,1,2),  CF14(1,k), vec2 )
       CALL VECAD( vec1, vec2, ddelta14(1,k) )
!
!++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
!  !!!!!!!!!!!! UPDATED FOR IERS CONVENTIONS (2003) !!!!!!!!!!!!!!
!  Step 2A, Equation 16, [IERS Conventions (2003), Chapter 7, page 12]
!     Frequency domain corrections. In phase for degree 2, diurnal
!     tides. Computed using the Delauney fundamental arguments
!
!!!! Bug here if station 1 is at the geocenter, remove IF/THEN/ENDIF,
!!!!  2007.01.10
!**   IF (K .EQ. 1) THEN
!      DO LL=1,5
!        FUND_ARG(LL) = FA2K(LL)
!       DFUND_ARG(LL) = FAD2K(LL)      ! time derivative
!      ENDDO
!        FUND_ARG(6) = GAST2K(1) + PI
!       DFUND_ARG(6) = GAST2K(2)
!        print *,' ETDG/FUND_ARG (new): ', FUND_ARG
!**   ENDIF
!
      Do jf =1, 11
          arg = 0.D0
        d_arg = 0.D0
        Do ll=1,6
           arg = arg   - Table75a(ll,jf)* fund_arg(ll)
         d_arg = d_arg - Table75a(ll,jf)*dfund_arg(ll)
        Enddo
          theta15(jf) = DMOD(arg,TWOPI)
         dtheta15(jf) = d_arg
      Enddo
!
       Do I=1,3
         topo15(I,k) = 0.0D0
        dtopo15(I,k) = 0.0D0
       Enddo
!
      Do jf=1,11
!
!  Up component (meters)
       topo15(1,k) =  topo15(1,k) + Table75a(7,jf) * S2Phi              &
     &           * DSIN(theta15(jf) + SITLON(k)) * 1.D-3                &
     &          +  Table75a(8,jf) * S2Phi                               &
     &           * DCOS(theta15(jf) + SITLON(k)) * 1.D-3
      dtopo15(1,k) = dtopo15(1,k) + Table75a(7,jf) * S2Phi              &
     &           * DCOS(theta15(jf) + SITLON(k)) * dtheta15(jf) * 1.D-3 &
     &          -  Table75a(8,jf) * S2Phi                               &
     &           * DSIN(theta15(jf) + SITLON(k)) * dtheta15(jf) * 1.D-3
!
!  East component (meters)
        topo15(2,k) = topo15(2,k) + Table75a( 9,jf) * SPhi              &
     &           * DCOS(theta15(jf)+SITLON(k)) * 1.D-3                  &
     &           - Table75a(10,jf) * SPhi                               &
     &           * DSIN(theta15(jf)+SITLON(k)) * 1.D-3
       dtopo15(2,k) = dtopo15(2,k) + Table75a( 9,jf) * SPhi             &
     &           * (-DSIN(theta15(jf)+SITLON(k))) * dtheta15(jf)*1.D-3    &
     &           - Table75a(10,jf) * SPhi                               &
     &           * DSIN(theta15(jf)+SITLON(k)) * dtheta15(jf)* 1.D-3
!
!  North component (meters)
       topo15(3,k) = topo15(3,k) + Table75a( 9,jf) * C2Phi              &
     &           * DSIN(theta15(jf)+SITLON(k)) * 1.D-3                  &
     &           + Table75a(10,jf) * C2Phi                              &
     &           * DCOS(theta15(jf)+SITLON(k)) * 1.D-3
       dtopo15(3,k) = dtopo15(3,k) + Table75a( 9,jf) * C2Phi            &
     &           * DCOS(theta15(jf)+SITLON(k)) * dtheta15(jf) * 1.D-3   &
     &           + Table75a(10,jf) * C2Phi                              &
     &           * (-DSIN(theta15(jf)+SITLON(k))) * dtheta15(jf) * 1.D-3
!  --- need to check time derivatives, etc !!!!!
!
      Enddo
!
!  Rotate vectors from topocentric to crust-fixed and then from crust-fixed
!   to J2000.
       CALL VECRT( RTTOCF(1,1,k), topo15(1,k), CF15(1,k) )
       CALL VECRT( R2K  (1,1,1), CF15(1,k), delta15(1,k) )
!
       CALL VECRT( RTTOCF(1,1,k), dtopo15(1,k), dCF15(1,k) )
       CALL VECRT( R2K  (1,1,1), dCF15(1,k), vec1 )
       CALL VECRT( R2K  (1,1,2),  CF15(1,k), vec2 )
       CALL VECAD( vec1, vec2, ddelta15(1,k) )
!
!  Step 2B, Equation 17, [IERS Conventions (2003), Chapter 5, page 13]
!     Frequency domain corrections, in phase and out of
!    phase for degree 2, long period tides. Computed using the Delauney
!    fundamental arguments
!
      Do jf =1, 5
          arg = 0.D0
        d_arg = 0.D0
        Do ll=1,6
           arg = arg   - Table75b(ll,jf)* fund_arg(ll)
         d_arg = d_arg - Table75b(ll,jf)*dfund_arg(ll)
        Enddo
          theta16(jf) = DMOD(arg,TWOPI)
         dtheta16(jf) = d_arg
!       IF(K .EQ. 1) THEN
!        if (theta16(jf) .gt. PI) theta16(jf) = theta16(jf) - TWOPI
!        if (theta16(jf) .le. -PI) theta16(jf) = theta16(jf) + TWOPI
!        print *,' theta16(degrees) ', jf,theta16(jf)/CONVD
!       ENDIF
      Enddo
!
       Do I=1,3
         topo16(I,k) = 0.0D0
        dtopo16(I,k) = 0.0D0
       Enddo
!
      Do jf=1,5
!  Up component (meters)
        topo16(1,k) = topo16(1,k) + (1.5D0*SPhi**2 - .5D0)              &
     &             * ( Table75b(7,jf)*DCOS(theta16(jf)) +               &
     &                 Table75b( 8,jf)*DSIN(theta16(jf)) ) * 1.D-3
       dtopo16(1,k) = dtopo16(1,k) + (1.5D0*SPhi**2 -.5D0)              &
     &             * (-Table75b(7,jf)*DSIN(theta16(jf))*dtheta16(jf) +  &
     &                 Table75b( 8,jf)*DCOS(theta16(jf))*dtheta16(jf) ) &
     &             * 1.D-3
!
!  East component (meters) ==> ZERO
!       topo16(2,k) = 0.0D0
!      dtopo16(2,k) = 0.0D0
!
!  North component (meters)
        topo16(3,k) = topo16(3,k)                                       &
     &    + S2Phi *  ( Table75b( 9,jf)*DCOS(theta16(jf)) +              &
     &         Table75b(10,jf)*DSIN(theta16(jf)) ) * 1.D-3
       dtopo16(3,k) = dtopo16(3,k)                                      &
     &    + S2Phi *  (-Table75b( 9,jf)*DSIN(theta16(jf))*dtheta16(jf) + &
     &         Table75b(10,jf)*DCOS(theta16(jf))*dtheta16(jf) ) * 1.D-3
!
      Enddo
!
!  Rotate vectors from topocentric to crust-fixed and then from crust-fixed
!   to J2000.
       CALL VECRT( RTTOCF(1,1,k), topo16(1,k), CF16(1,k) )
       CALL VECRT( R2K  (1,1,1), CF16(1,k), delta16(1,k) )
!
       CALL VECRT( RTTOCF(1,1,k), dtopo16(1,k), dCF16(1,k) )
       CALL VECRT( R2K  (1,1,1), dCF16(1,k), vec1 )
       CALL VECRT( R2K  (1,1,2),  CF16(1,k), vec2 )
       CALL VECAD( vec1, vec2, ddelta16(1,k) )
!
!************************************************************************
!
!  Finished computing all the pieces, now add them up
        Do kk = 1,3
          TIDEP(kk,k) = delta_r2(kk,k) + delta_r3(kk,k)                 &
     &          + delta11(kk,k)  + delta12(kk,k) + delta13(kk,k)        &
     &          + delta14(kk,k)  + delta15(kk,k) + delta16(kk,k)
!
          TIDEV(kk,k) = ddelta_r2(kk,k) + ddelta_r3(kk,k)               &
     &          + ddelta11(kk,k) + ddelta12(kk,k) + ddelta13(kk,k)      &
     &          + ddelta14(kk,k) + ddelta15(kk,k) + ddelta16(kk,k)
!
        Enddo
!
!****************************************************************************
!   Check for debug output
      If (KETDD .ne. 0) Then
       write(6,'(/," Dump for site #",i1)') K
       write(6,8)' SITLAT(k), SITLON(k) ', SITLAT(k), SITLON(k)
       write(6,8)' GEO_LAT(k)           ', GEO_LAT(k)
       write(6,8)' r_vec        ', r_vec
       write(6,8)' dr_vec       ', dr_vec
       write(6,8)' r_mag, dr_mag', r_mag, dr_mag
       write(6,8)' r_hat        ', r_hat
       write(6,8)' dr_hat       ', dr_hat
       write(6,8)' Rmoon_dot_r, dRmoon_dot_r ',Rmoon_dot_r,dRmoon_dot_r
       write(6,8)' Rsun_dot_r, dRsun_dot_r ',Rsun_dot_r,dRsun_dot_r
       write(6,8)' k, Phi(k): ', k, Phi(k)
       write(6,8)' CLLMoon, SLLMoon  ',CLLMoon,dCLLMoon,SLLMoon,dSLLMoon
       write(6,8)' C2LLMoon, S2LLMoon ', C2LLMoon, dC2LLMoon,           &
     &                                    S2LLMoon, dS2LLMoon
       write(6,8)' CLLSun, SLLSun  ', CLLSun, dCLLSun, SLLSun, dSLLSun
       write(6,8)' C2LLSun, S2LLSun  ',C2LLSun,dC2LLSun,S2LLSun,dS2LLSun
       write(6,8)' CPhi, SPhi     ', CPhi, SPhi
       write(6,8)' C2Phi, S2Phi   ', C2Phi, S2Phi
       write(6,8)' CsqPhi, SsqPhi ', CsqPhi, SsqPhi
       write(6,8)' term1M, dterm1M ', term1M, dterm1M
       write(6,8)' term2, dterm2   ', term2, dterm2
       write(6,8)' term3M, dterm3M ', term3M, dterm3M
       write(6,8)' term4M, dterm4M ', term4M, dterm4M
       write(6,8)' term5M, dterm5M  ', term5M, dterm5M
       write(6,8)' term1M_2, dterm1M_2 ', term1M_2, dterm1M_2
       write(6,8)' term1S, dterm1S ', term1S, dterm1S
       write(6,8)' term3S, dterm3S ', term3S, dterm3S
       write(6,8)' term4S, dterm4S ', term4S, dterm4S
       write(6,8)' term5S, dterm5S  ', term5S, dterm5S
       write(6,8)' term1S_2, dterm1S_2 ', term1S_2, dterm1S_2
       write(6,8)' delta_r2    ', delta_r2(1,k), delta_r2(2,k),         &
     &                            delta_r2(3,k)
       write(6,8)' ddelta_r2   ', ddelta_r2(1,k),ddelta_r2(2,k),        &
     &                            ddelta_r2(3,k)
       write(6,8)' term01M, dterm01M ', term01M, dterm01M
       write(6,8)' term02,  dterm02  ', term02, dterm02
       write(6,8)' term03M, dterm03M ', term03M, dterm03M
       write(6,8)' term04M, dterm04M ', term04M, dterm04M
       write(6,8)' term05M, dterm05M ', term05M, dterm05M
       write(6,8)' delta_r3  ', delta_r3(1,k),delta_r3(2,k),            &
     &                            delta_r3(3,k)
       write(6,8)' ddelta_r3 ', ddelta_r3(1,k),ddelta_r3(2,k),          &
     &                            ddelta_r3(3,k)
       write(6,8)' P12_moon, dP12_moon  ', P12_moon, dP12_moon
       write(6,8)' P22_moon, dP22_moon  ', P22_moon, dP22_moon
       write(6,8)' P12_sun, dP12_sun  ', P12_sun, dP12_sun
       write(6,8)' P22_sun, dP22_sun  ', P22_sun, dP22_sun
       write(6,8)' topo11   ', topo11(1,k),topo11(2,k),topo11(3,k)
       write(6,8)' dtopo11  ', dtopo11(1,k),dtopo11(2,k),dtopo11(3,k)
       write(6,8)' delta11  ', delta11(1,k),delta11(2,k),delta11(3,k)
       write(6,8)' ddelta11 ',ddelta11(1,k),ddelta11(2,k),ddelta11(3,k)
       write(6,8)' topo12   ', topo12(1,k), topo12(2,k),topo12(3,k)
       write(6,8)' dtopo12  ', dtopo12(1,k),dtopo12(2,k),dtopo12(3,k)
       write(6,8)' delta12  ', delta12(1,k),delta12(2,k),delta12(3,k)
       write(6,8)' ddelta12 ',ddelta12(1,k),ddelta12(2,k),ddelta12(3,k)
       write(6,8)' topo13  ',topo13(1,k),topo13(2,k),topo13(3,k)
       write(6,8)' dtopo13 ', dtopo13(1,k),dtopo13(2,k),dtopo13(3,k)
       write(6,8)' delta13  ', delta13(1,k),delta13(2,k),delta13(3,k)
       write(6,8)' ddelta13 ',ddelta13(1,k),ddelta13(2,k),ddelta13(3,k)
       write(6,8)' topo14  ', topo14(1,k), topo14(2,k), topo14(3,k)
       write(6,8)' dtopo14 ', dtopo14(1,k),dtopo14(2,k),dtopo14(3,k)
       write(6,8)' delta14  ', delta14(1,k),delta14(2,k),delta14(3,k)
       write(6,8)' ddelta14 ',ddelta14(1,k),ddelta14(2,k),ddelta14(3,k)
       write(6,'(" theta15:  ",7f12.8,/,10x,4f12.8)') theta15
       write(6,'(" dtheta15: ",7f12.9,/,10x,4f12.9)') dtheta15
       write(6,8)' topo15  ', topo15(1,k),topo15(2,k),topo15(3,k)
       write(6,8)' dtopo15 ', dtopo15(1,k),dtopo15(2,k),dtopo15(3,k)
       write(6,8)' delta15  ', delta15(1,k),delta15(2,k),delta15(3,k)
       write(6,8)' ddelta15 ',ddelta15(1,k),ddelta15(2,k),ddelta15(3,k)
       write(6,'(" theta16:  ",5f12.8)') theta16
       write(6,'(" dtheta16: ",5f12.9)') dtheta16
       write(6,8)' topo16  ', topo16(1,k),topo16(2,k),topo16(3,k)
       write(6,8)' dtopo16 ', dtopo16(1,k),dtopo16(2,k),dtopo16(3,k)
       write(6,8)' delta16  ', delta16(1,k),delta16(2,k),delta16(3,k)
       write(6,8)' ddelta16 ',ddelta16(1,k),ddelta16(2,k),ddelta16(3,k)
!
      Endif
!
 100  Continue
!   Close loop over sites
      Enddo                                  !Loop over sites
!
      If (KETDD .ne. 0) Then
      write (6, 9201)  TIDEP, TIDEV
 9201 FORMAT (1X, "TIDEP  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "TIDEV  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ) )
      Endif
!
    8 FORMAT(A,4D25.16/(7X,5D25.16))
!
!     Normal program conclusion.
      RETURN
      END
!**********************************************************************
      SUBROUTINE ETDP ( R2K, SITLAT, STAR, TCTOCF )
      IMPLICIT None
!
!     ETDP is the Earth Tide Module partial derivatives section. It calculates
!     the partial derivatives of the delay and rate with respect to site
!     dependent Earth tide parameters.
!
!     ETDP Program Interface:
!
!       Calling sequence -
!           Input variables:
!             1. R2K  (3,3,3)  - The complete crust fixed to J2000 rotation
!                                matrix and its first two CT time derivatives.
!                                (unitless, 1/sec, 1/sec**2)
!             2. SITLAT(2)     - The site geodetic latitudes. (RAD)
!             3. STAR(3)       - The J2000.0 source unit vector. (unitless)
!             4. TCTOCF(3,3,2) - The rotation matrix which rotates the
!                                topocentric reference system to the crust
!                                fixed reference system at each site.
!
!     Common blocks used:
!
      INCLUDE 'cphys11.i'
!            Variables 'from':
!              1. VLIGHT  -  The vacuum velocity of light.  (M/SEC)
!
      INCLUDE 'ccon.i'
!         Variables 'from':
!           1. KETDC  -  The module flow control flag.
!                        = 0 => Default, IERS 1996 Earth Tide Model
!                        = 1 => Earth tide model OFF, no corrections computed
!           2. KETDD  -  The debug output flag.
!
!   Program specifications -
      Real*8   R2K(3,3,3), SITLAT(2), STAR(3), TCTOCF(3,3,2)
      Integer*4 I, J, K, L
!
!     Database access:
!       'PUT' Variables: None
!          Access codes: None
!
!     Subroutine Interface:
!            Caller subroutines: DRIVP
!            Called subroutines: PUT4
!
! 5.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!                    PETER DENATALE 07/12/77
!                    BRUCE SCHUPLER 03/24/78
!                    BRUCE SCHUPLER 11/02/78
!                    Jim Ryan 89.06.29 Character strings and clean up.
!                    Jim Ryan 89:10:05 CPHYS common made an include file.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                    implimented.
!                    Jim Ryan 90.01.20 Documentation of the partials array
!                                      fixed.
!                    David Gordon 93NOV23 Modified for IERS Earth tides.
!                    David Gordon 94.04.06 Changed to 'Implicit None'
!                    David Gordon 94.04.27 New common block 'tide_stuff'.
!                    David Gordon 98.06.24 Obsolete code removed. New Puts
!                                 for 1996 IERS model.
!                    David Gordon 98.09.30 Increased dimensions on PUT4 of
!                                 partial derivatives (ETJMGPAR).
!                    David Gordon 98.01.06 Return immediately if Correlator.
!                    Jim Ryan     2002.09 Integer*4 conversion
!                    David Gordon 2004.08.05 PUT's removed.
!
!  ETDP Program Structure
!
!  There are no partials! Keep subroutine for future use.
!
!     Normal conclusion.
      RETURN
      END
!************************************************************************
      SUBROUTINE ETDC ( TIDEP, TIDEV, STAR )
      IMPLICIT None
!
!     ETDC is the Earth Tide Module contribution section. It computes the
!     contributions to the delay and rate due to Earth tide effects.
!
!     ETDC Program Interface:
!
!       Calling sequence -
!           Input variables:
!             1. TIDEP(3,2) - The corrections to the J2000 geocentric site
!                             position due to Earth tidal effects at each site.
!                             (M)
!             2. TIDEV(3,2) - The corrections to the J2000.0 geocentric site
!                             velocity vectors due to Earth tidal effects at
!                             each site. (M/SEC)
!             3. STAR(3)    - The J2000.0 source unit vector. (unitless)
!
!     Common blocks used:
!
      INCLUDE 'cphys11.i'
!            Variables 'from':
!              1. VLIGHT - The vacuum velocity of light. (m/sec)
!
      INCLUDE 'ccon.i'
!         Variables 'from':
!           1. KETDC  -  The module flow control flag.
!                        = 0 => Default, IERS 1996 Earth Tide Model
!                        = 1 => Earth tide model OFF, no corrections computed
!           2. KETDD  -  The debug output flag.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. DETDC(2) - The total Earth tide contribution to the delay and
!                        rate. 
!
!   Program specifications:
      Real*8 DOTP, BASCOR(3,2), TIDEP(3,2), TIDEV(3,2),          STAR(3)
      Integer*4 K
!
!     Database access: => Moved to PUT_C.
!
!     Subroutine Interface:
!             Caller subroutines: DRIVC
!             Called subroutines: DOTP, VECSB
!
!     Constants used: VLIGHT
!
!     Program variables:
!         1. BASCOR(3,2) - The correction to the J2000 baseline position and
!                          velocity vectors due to Earth tidal effects.
!                          (M, M/SEC)
!
! 6.2.9 PROGRAMMER - DALE MARKHAM  01/13/77
!                    PETER DENATALE 07/12/77
!                    Jim Ryan 89.06.29 Character strings and clean up.
!                    Jim Ryan 89:10:05 CPHYS common made an include file.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                    implimented.
!                    David Gordon 94.01.24 Third order tide remover
!                                 contribution added.
!                    David Gordon 94.04.06 Changed to 'Implicit None'. Vertical
!                                 Love # dependent terms added to IERS 'excess'
!                                 correction term and that Lcode renamed
!                                 'ETD IERS'.
!                    David Gordon 94.04.27 New common block 'tide_stuff'.
!                    David Gordon 94.04.28 Change due to Love # difference added
!                                 to 'ETD IERS'. Computations and PUT4's for
!                                 'ETD3CONT', 'ETDKCONT', and 'ETD2CONT' added.
!                    David Gordon 94.08.25 IERS made default. delta_IERS,
!                                 dtide_IERS, and other unused variables
!                                 removed. Documentation expanded and corrected.
!                    David Gordon 98.06.24 Obsolete code for Calc 8.x
!                                 contributions removed.
!                    David Gordon 98.01.06 Added PUT's of corrections to use
!                                 old Calc 8.x Earth tide ('C82ETCON') and
!                                 correction to change anelastic case to
!                                 elastic case ('ELASTCON'); skipped if
!                                 Correlator.
!                    David Gordon 99.10.15 Added computation and PUT of
!                                 permanent deformation delay and rate
!                                 contributions, access code 'PERMDEF '.
!                    Jim Ryan     2002.09 Integer*4 conversion
!                    David Gordon 2004 Removed Calc 8 tide, permanent tide,
!                                 and elasticity contributions.
!                    David Gordon Jan. 2013  Moved PUT to subroutine PUT_C.
!
!  ETDC Program Structure.
!
! Compute the contributions.
!
!  Compute the corrections to the J2000.0 baseline position and
!  velocity vectors due to Earth tidal effects.
      CALL VECSB ( TIDEP(1,1), TIDEP(1,2), BASCOR(1,1) )
      CALL VECSB ( TIDEV(1,1), TIDEV(1,2), BASCOR(1,2) )
!
!  Complete the calculation of the contributions.
      DO K = 1,2
        DETDC(K) = DOTP ( BASCOR(1,K), STAR ) / VLIGHT
      ENDDO
!
!  Check KETDD for debug output.
      IF ( KETDD .ne. 0 ) Then        ! Debug output
       WRITE ( 6, 9100 )
 9100  FORMAT (1X, "Debug output for subroutine ETDC." )
    8  FORMAT(A,4D25.16/(7X,5D25.16))
       WRITE(6,8)' BASCOR',BASCOR
       WRITE(6,8)' DETDC ',DETDC
       WRITE(6,8)' VLIGHT',VLIGHT
       WRITE ( 6, 9200 )  TIDEP, TIDEV, STAR
 9200  FORMAT (1X, "TIDEP  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &             "TIDEV  = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &             "STAR   = ",     3 ( D30.16, 10X ) )
      ENDIF                    ! Debug output
!
!     Normal conclusion.
      RETURN
      END
      BLOCK DATA CMATHB
      IMPLICIT None
!
! 1.    CMABD
!
! 1.1   CMABD PROGRAM SPECIFICATION
!
! 1.1.1 CMABD is the block data which initializes the mathematical
!       constants.  Rather than obtaining the mathematical constants
!       from the database, they must be initialized here because of
!       the problems with differing representations of the constants
!       in ASCII and binary.
!
! 1.1.2 RESTRICTIONS - NONE
!
! 1.1.3 REFERENCES - CHEMICAL RUBBER COMPANY HANDBOOK
!
! 1.2   CMABD PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE - NONE
!
! 1.2.2 COMMON BLOCK
!
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
!     VARIABLES "TO":
!
!     1. PI     - THE MATHEMATICAL CONSTANT PI (UNITLESS)
!     2. TWOPI  - PI * 2.0D0 (UNITLESS)
!     3. HALFPI - PI / 2.0D0 (UNITLESS)
!     4. CONVD  - THE CONVERSION FACTOR FROM DEGREES TO RADIANS (RAD/DEG)
!     5. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!     6. CONVHS - THE CONVERSION FACTOR FROM TIME SECONDS TO RADIANS
!                 (RADIANS / TIME SECOND)
!     7. SECDAY - THE NUMBER OF TIME SECONDS PER DAY (SECONDS / DAY)
!
!     VARIABLES "FROM": NONE
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      DATA PI     /3.1415926535897932D0/, &
     &     TWOPI  /6.2831853071795865D0/, &
     &     HALFPI /1.5707963267948966D0/, &
     &     CONVD  /1.7453292519943296D-02/, &
     &     CONVDS /4.8481368110953599D-06/, &
     &     CONVHS /7.2722052166430399D-05/, &
     &     SECDAY /8.6400D04/
!
! 1.2.4 CONSTANTS USED - PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!
! 1.2.5 PROGRAMMER - BRUCE SCHUPLER 02/15/78
!                    SAVITA GOEL    06/04/87 (CDS FOR A900)
!                    David Gordon 94.04.14 Converted to Implicit None
!
! 1.3   PROGRAM STRUCTURE - NONE
!
      END
      SUBROUTINE WOBG (CENT, TT, UTC, XJD, GMST2K, TSKIP, FA2K, FAD2K,  &
     &                 UT1, DUT1AT, Xti, Yti, dXti, dYti, Xli, Yli,     &
     &                 dXli, dYli, UT1li, dUT1li, UT1ti, dUT1ti,        &
     &                 WOBXR, WOBYR, WOBXD, WOBYD, SP, DSP, RW2K)
      IMPLICIT None
!
!    WOBG is the geometry section of the Wobble Module. It computes the
!    wobble portion of the complete crust fixed to J2000.0 rotation matrix.
!    Although this subroutine uses the BIH sign convention for a left-handed
!    coordinate system, the values for WOBX and WOBY leave this routine as
!    WOBXR and WOBYR, values in a right-handed system. WOBXR and WOBYR are
!    passed to all routines outside the Wobble Module. (Used in Pole Tide
!    module.)
!
!    References - Ash, M.E., 'Determination of Earth Satellite Orbits", Lincoln
!                 Laboratory Technical Report 1972-75, 04/19/72, p. 229-230.
!
!               - Mueller, I.P., "Spherical and Practical Astronomy as Applied
!                 to Geodesy", 1969, p. 80-85. (NOTE: The reference in Mueller
!                 refers to the calculation of the wobble portion of the
!                 complete J2000.0 to crust fixed rotation matrix. Program CALC
!                 however, needs the transpose of this matrix, so be cautious
!                 if comparing the reference to the following program.)
!
!                 IERS Conventions (2003).
!
!     Calling sequence -
!           Input Variables:
!             1. CENT     -
!             1. CT       -  Coordinate time (ephemeris time).
!             1. TT       -  Terrestrial Time fraction of the day.
!             2. UTC      -  The UTC fraction of the UTC day (days).
!             3. XJD      -  The Julian date at zero hours UTC of the date in
!                            question. (days)
!             4. TSKIP    -  Skip time-dependent computations if TSKIP=1
!                            (same time as previous observation).
!             5. Xti      -  Short period X tidal contribution. (mas)
!             6. Yti      -  Short period Y tidal contribution. (mas)
!             7. dXti     -  Time derivative of Xti. (mas/sec)
!             8. dYti     -  Time derivative of Yti. (mas/sec)
!           Output Variables:
!             1. RW2K(3,3,2)-The wobble portion of the complete crust fixed 
!                            to J2000.0 rotation matrix and its first time'
!                            derivative. (unitless, 1/sec)
!             2. WOBXR     - The long period wobble X-offset. (RAD)
!                            This variable, along with WOBYR, are for use in a
!                            right-handed coordinate system. WOBXR and WOBYR
!                            are the variables passed to all routines external
!                            to the Wobble Module.
!             3. WOBYR     - The long period wobble Y-offset. (RAD)
!                            To be used in a right-handed system (see WOBXR).
!             4. SP        - S' angle, positions the Terrestrial Ephemeris 
!                            Origin on the equator of the Celestial 
!                            Intermediate Pole.
!             5. DSP       - dS'/dt, time derivative of SP (above).
!
!     Common blocks used -
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!            Variables 'FROM':
!              1. CONVDS  -  The conversion factor of radians per arcsecond.
!                            (radians/arcsecond)
!
      INCLUDE 'cmwob11.i'
!            Variables 'TO':
!              1. RWOBX(3,3) - The rotation matrix which rotates about the
!                              crust fixed Y-axis by an angle equal to WOBX.
!              2. RWOBY(3,3) - The rotation matrix which rotates about the new
!                              X-axis by an angle equal to WOBY. (unitless)
!              3. RWOBZ(3,3) - The rotation matrix which rotates about the
!                              Z-axis by the angle SP.
!              4. WOBX       - The left-handed X-wobble. (rad)
!              5. DWOBX      - Time derivative of WOBX. (rad/sec)
!              6. WOBY       - The left-handed Y-wobble. (rad)
!              7. DWOBY      - Time derivative of WOBY. (rad/sec)
!              8. RWX(3,3)   - Rotation matrix used in computation of time
!                              derivative of wobble rotation matrix.
!              9. RWY(3,3)   - Rotation matrix used in computation of time
!                              derivative of wobble rotation matrix.
!             10. RWZ(3,3)   - Rotation matrix used in computation of time
!                              derivative of wobble rotation matrix.
!             11. WOBXli     - Short period X libration contribution. (rad)
!             12. WOBYli     - Short period Y libration contribution. (rad)
!             13. dWOBXli    - Time derivative of WOBXn. (rad/sec)
!             14. dWOBYli    - Time derivative of WOBYn. (rad/sec)
!             15. WOBXti     - Short period X tidal contribution. (rad)
!             16. WOBYti     - Short period Y tidal contribution. (rad)
!
      INCLUDE 'cmxut11.i'
!            Variables 'FROM':
!              1. EOP_time_scale - EOP table time scale, allowed values:
!                              'TAI     ', 'TCG     ', 'TDB     ',
!                              'TDT     ', 'UTC     ', 'UNDEF   '.
!
       INCLUDE 'cuser11.i'
!          Variables from:
!            1. Calc_user - Calc user type. 'A' for Calc/SOLVE analysis.
!                           'C' for VLBI correlator.
!            2. Hifreq_tidal_EOP - Correlator option to add the high
!                           frequency (diurnal and sub-diurnal) EOP 
!                           correction for ocean tidal effects from 
!                           subroutine ORTHO_EOP. 
!                           'Y' => Add high frequency EOP corrections.
!                           'N' => Don't add high frequency EOP correction. 
!            3. Hifreq_nut_EOP - Correlator option to add the EOP
!                           correction for high frequency (periods less 
!                           than 2 days) nutation. 
!                           'Y' => Add EOP nutation corrections.
!                           'N' => Don't add EOP nutation corrections. 
!
      INCLUDE 'ccon.i'
!            Variables 'FROM':
!              1.  KWOBC  -  The Wobble Module flow control flag.
!              2.  KWOBD  -  The Wobble Module debug output flag.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. WOBIN - The X and Y polar motion values interpolated to
!                     the time of this observation in the conventional
!
!
      Real*8  ATMUTC(3), ROTEPH(2,20), A1UTC(3), A1DIFF(3)
      COMMON / EOPCM / ATMUTC, ROTEPH, A1UTC, A1DIFF
!           VARIABLES 'TO':
!            1. ATMUTC(3) - THE 'TAI MINUS UTC' INFORMATION ARRAY. THIS ARRAY
!                           CONTAINS RESPECTIVELY THE EPOCH, VALUE, AND TIME
!                           RATE OF CHANGE OF 'TAI MINUS UTC'. Used in the
!                           atomic time module. (DAYS, SEC, SEC/SEC)
!
!   Program Specifications -
      Real*8           UTC, XJD, WOBXR, WOBYR, WOBXL,                   &
     &       WOBYL, DWOBXL, DWOBYL, CT, tab_time,rw1(3,3), rw2(3,3),    &
     &       CENT, GMST2K(2), FA2K(14), FAD2K(14), TT
      Real*8 WOBXD, WOBYD
      REAL*8 SP,DSP,           RW2K(3,3,2),DRWC1(3,3),                  &
     &       DRWC2(3,3), DRWC3(3,3), Xli, Yli, dXli, dYli, UT1ti,       &
     &       dUT1ti, TMJD, Xti, Yti, dXti, dYti, UT1li, dUT1li
         Real*8        UT1, DUT1AT
      Integer*4 TSKIP
!
!     Subroutine interface -
!             Caller subroutines: DRIVG
!             Called subroutines: WOBMU, XYLIB, UT1_LIB, MMUL3,
!                                 ROTAT, DROTT, MADD3
!
!     Program Variables -
!               1. WOBXL  - The left-handed X-Wobble. (milliarcsec)
!               2. WOBYL  - The left-handed Y-Wobble. (milliarcsec)
!               3. DWOBXL - Time derivative of WOBXL. (masec/sec)
!               4. DWOBYL - Time derivative of WOBYL. (masec/sec)
!               5. WOBIN  - Both wobbles, to be put into the database.
!               6. rw1(3,3)-Rotation matrix used in computation of time
!                           derivative of wobble rotation matrix.
!               7. rw2(3,3)-Rotation matrix used in computation of time
!                           derivative of wobble rotation matrix.
!
!     Programmer - Dale Markham  02/17/77
!      77.07.14 Peter Denatale
!      77.03.31 Kathy Watts
!      78.01.09 Bruce Schupler
!      88.12.21 Gregg Cooke
!      89.07.26 Jim Ryan  Documentation simplifed and strings.
!      89.12.12 Jim Ryan  UNIX-like database interface implimented.
!      90.01.02 Jim Ryan  WOBIN converted to left-handed.
!      91.06.06 Jim Ryan  Clean up documentation.
!      94.04.15 D. Gordon Converted to Implicit None.
!      94.05.23 D. Gordon Fixed bug - use_cubic, use_linear, use_spline were
!                         being dimensioned both Logical*2 and Real*8.
!      95.10.05 D. Gordon Skip interpolation if Module OFF (KWOBC=1); set
!                         WOBXL and WOBYL equal to zero (previously undefined).
!      95.12.04 D. Gordon Changing interpolation epoch variable to tab_time
!                         (previously was UTC). Tab_time set to CT for
!                         consistency with UT1 interpolation which is in CT.
!      95.12.11 D. Gordon Adding DWOBXL and DWOBYL, derivatives of X-wobble and
!                         Y-wobble, to WOBMU argument list. Variables DWOBX,
!                         DWOBY, rwx, rwy, rw1, and rw2 added. Code added to
!                         compute the time derivative of the wobble rotation
!                         matrix. RW(3,3) changed to RW(3,3,2).
!      96.02.09 D. Gordon Added dwobx, dwoby, rwx, and rwy to Common/WOBCM/.
!      2001.01.02 D. Gordon Code added to determine time scale of EOP table
!                         (CT/TDB, UTC, TDT or TAI).
!      2002 Sept Jim Ryan Integer*2/4 mods.
!      2003.05.07 D. Gordon Code added to compute S' (SP) and dS'/dt (DSP),
!                         to position the Terrestrial Ephemeris Origin on
!                         the equator of the Celestial Intermediate Pole.
!      2003/2004 D.Gordon Modified for CEO-based rotation computations and
!                         for high frequency (tidal and nutation) polar
!                         motion.
!      2007.12.28 D.Gordon Options to add high frequency (diurnal and 
!                         sub-diurnal) EOP corrections due to ocean tides
!                         and nutation for correlator usage.
!      Nov. 2012 D.Gordon Added new subroutine calls. XYLIB computes 
!                         short period polar motion due to libration 
!                         effects. UT1_LIB computes short period UT1
!                         due to libration effects. UT1_LIB is called
!                         here instead of UT1G because GMST2K is not
!                         defined when UT1G is called. 
!      Dec. 2012 D.Gordon Moved PUT's to PUT_G.
!
!
!    WOBG Program Structure.
!
      IF (TSKIP .eq. 1) Go to 250
!
!     Call 'WOBMU' to obtain WOBXL and WOBYL
      If (KWOBC.ne.1) Then             ! Module ON
!
!  Determine time scale of EOP table epochs. TT is now the default.
!        tab_time = CT
         tab_time = TT
       If (EOP_time_scale .eq. 'UTC     ') tab_time = UTC
       If (EOP_time_scale .eq. 'TAI     ') tab_time = UTC +             &
     &       ATMUTC(2)/SECDAY + ATMUTC(3)*(XJD-ATMUTC(1))
       If (EOP_time_scale .eq. 'TDT     ') tab_time = UTC +             &
     &      (ATMUTC(2) + 32.184D0)/SECDAY + ATMUTC(3)*(XJD-ATMUTC(1))
!
       CALL WOBMU (XJD,tab_time,WOBXL,WOBYL,DWOBXL,DWOBYL)
!
! Get short period libration (formerly called nutation) contribution 
!    to X and Y. Xli and Yli are in milli-arc-seconds
       CALL XYLIB (GMST2K, FA2K, FAD2K, Xli, Yli, dXli, dYli)
!
!      WRITE(6,*) 'WOBG: Xli,dXli(mas) ', Xli, dXli
!      WRITE(6,*) 'WOBG: Yli,dYli(mas) ', Yli, dYli
!
!   --- ORTHO_EOP moved to UT1G.
! Get short period tidal contribution to X and Y and UT1.
!      CALL ORTHO_EOP (TMJD, Xti, Yti, UT1t, dXti, dYti, dUT1t)
!
      Else                             ! Module OFF
       WOBXL  = 0.D0
       WOBYL  = 0.D0
       DWOBXL = 0.D0
       DWOBYL = 0.D0
      Endif
!
!   Compute the short period corrections to UT1 due to libration. (msec)
!!!! We have to do this here because GMST2K is defined after the call to UT1G!!!!!!!
      CALL UT1_LIB (GMST2K, FA2K, FAD2K, UT1li, dUT1li)
!      WRITE(6,*) 'WOBG: UT1li,dUT1li(mas) ', UT1li, dUT1li
!      WRITE(6,*) 'WOBG: UT1, UT1+li ', UT1, UT1 + UT1li*1.D-3   
!
!    Convert the variables WOBXL and WOBYL from units of milliarcseconds
!    to units of radians.
      WOBX =   WOBXL * CONVDS * 1.0D-3
      WOBY =   WOBYL * CONVDS * 1.0D-3
      DWOBX = DWOBXL * CONVDS * 1.0D-3
      DWOBY = DWOBYL * CONVDS * 1.0D-3
!
! Save short period nutation and tidal contributions in radians and
!  short period UT1 tidal contribution in seconds.
         WOBXli   =  Xli * CONVDS * 1.0D-3
         WOBYli   =  Yli * CONVDS * 1.0D-3
         dWOBXli  = dXli * CONVDS * 1.0D-3
         dWOBYli  = dYli * CONVDS * 1.0D-3
         WOBXti   =  Xti * CONVDS * 1.0D-3
         WOBYti   =  Yti * CONVDS * 1.0D-3
!
!     If (Calc_user .eq. 'C' .and. Hifreq_tidal_EOP .eq. 'Y') Then
!       WOBX = WOBX + WOBXti 
!       WOBY = WOBY + WOBYti 
!       DWOBX = DWOBX + (dXti * CONVDS * 1.0D-3)
!       DWOBY = DWOBY + (dYti * CONVDS * 1.0D-3)
!     Endif
!
!     If (Calc_user .eq. 'C' .and. Hifreq_nut_EOP .eq. 'Y') Then
!       WOBX = WOBX + WOBXli
!       WOBY = WOBY + WOBYli
!       DWOBX = DWOBX + dWOBXli
!       DWOBY = DWOBY + dWOBYli
!       UT1 = UT1 + UT1li*1.D-3
!     Endif 
!
!    Create variables WOBXR and WOBYR, for external use, in subroutines
!    using a right-handed coordinate system.
      WOBXR =  WOBX
      WOBYR = -WOBY
      WOBXD = DWOBX
      WOBYD = DWOBY
!
!    Compute the wobble portion of the complete crust fixed to J2000.0
!    rotation matrix. (NOTE: WOBY is still left-handed, however,
!    the wobble matrix is constructed to take this into account.
!    Thus the final wobble matrix is right-handed.)
!
!    Construct the rotation matrix which rotates about the crust fixed
!    Y-axis by an angle equal to +WOBX.
      CALL ROTAT ( +WOBX, int2(2), RWOBX)
!
!    Construct the rotation matrix which rotates about the X-axis by
!    an angle equal to +WOBY.
      CALL ROTAT ( +WOBY, int2(1), RWOBY)
!
!  Compute S' and dS'/dt. (Taken from IERS function SP2000.)
        SP  = -47.D-6 * CENT * CONVDS
        DSP = SP/(CENT*36525.D0*86400.D0)
!
!   Construct the rotation matrix which rotates about the Z-axis by
!    an angle equal to -SP.
      CALL ROTAT ( -SP, int2(3), RWOBZ)
!
!  Compute the new polar motion (CEO-based) rotation matrix
!   below agrees with POM2000 and IERS Conventions (2003)
      CALL MMUL3 ( RWOBZ, RWOBX, RWOBY, RW2K(1,1,1) )
!   below agrees with IERS Conventions (1996)
!     CALL MMUL3 ( RWOBZ, RWOBY, RWOBX, RW2K(1,1,1) )
!
!  Compute the time derivative of the CEO-based wobble rotation matrix.
!   Compute the X derivative component
       CALL DROTT (WOBX, DWOBX, int2(2), RWX)
!   Compute the Y derivative component
       CALL DROTT (WOBY, DWOBY, int2(1), RWY)
!   Compute the Z derivative component
      CALL DROTT (-SP, -DSP, Int2(3), RWZ)
!  Compute the three time derivative components ...
!
! Below agrees with POM2000 and IERS Conventions (2003)
      CALL MMUL3 (   RWZ, RWOBX, RWOBY, DRWC1 )
      CALL MMUL3 ( RWOBZ,   RWX, RWOBY, DRWC2 )
      CALL MMUL3 ( RWOBZ, RWOBX,   RWY, DRWC3 )
!
! Below agrees with IERS Conventions (1996)
!     CALL MMUL3 (   RWZ, RWOBY, RWOBX, DRWC1 )
!     CALL MMUL3 ( RWOBZ,   RWY, RWOBX, DRWC2 )
!     CALL MMUL3 ( RWOBZ, RWOBY,   RWX, DRWC3 )
!
!   and add them together (chain rule).
      CALL MADD3 ( DRWC1, DRWC2, DRWC3, RW2K(1,1,2) )
!
!****************************************************
!    Check KWOBC to determine if the wobble module is to be turned off.
      IF ( KWOBC .EQ. 1 )  THEN
        CALL ROTAT ( 0.D0, int2(3), RW2K(1,1,1))
        CALL ROTAT ( 0.D0, int2(3), RW2K(1,1,2))
        WOBXR = 0.0D0
        WOBYR = 0.0D0
      ENDIF
!
 250   CONTINUE
!
!    'PUT' the left-handed wobble values (radians) into the database.
      WOBIN(1) = WOBX
      WOBIN(2) = WOBY
!  The 'PUT' was moved to Subroutine PUT_G
!
!    Check KWOBD for debug output.
      If (KWOBD .ne. 0) then
      WRITE (6,9)
    9 FORMAT (1X, 'Debug output for subroutine WOBG.' )
      WRITE(6,8)' CONVDS  ',CONVDS
    8 FORMAT(A,4D25.16/(7X,5D25.16))
   18 FORMAT(A,3D30.20/(10X,3D30.20))
      WRITE(6,8)' WOBXL,  WOBYL  = ',WOBXL, WOBYL
      WRITE(6,8)' DWOBXL, DWOBYL = ',DWOBXL, DWOBYL
      WRITE(6,8)' CT      ',CT
      WRITE(6,8)' tab_time',tab_time
      WRITE ( 6, 9200 )  UTC, XJD, RW2K
      WRITE(6,8)'  WOBX,  WOBY = ', WOBX,  WOBY
      WRITE(6,8)' DWOBX, DWOBY = ',DWOBX, DWOBY
      WRITE(6,18)' RWOBX  = ', RWOBX
      WRITE(6,18)' RWOBY  = ', RWOBY
      WRITE(6,18)' RWOBZ  = ', RWOBZ
      WRITE(6,18)' RWX    = ', RWX
      WRITE(6,18)' RWY    = ', RWY
      WRITE(6,18)' RWZ    = ', RWZ
      WRITE ( 6, * ) ' WOBG/ORTHO_EOP: Xti,Yti,UT1t:    ',              &
     &            Xti,Yti,UT1ti
      WRITE ( 6, * ) ' WOBXti, WOBYti (rad) =', WOBXti, WOBYti
      WRITE(6,8)' WOBG/WOBX (radians): ', WOBX,DWOBX
      WRITE(6,8)' WOBG/WOBY (radians): ', WOBY,DWOBY
!      Write(6,1015) RW2K
 1015  Format(1x,'WOBG/RW2K ',(3(/,3E30.20)))
 9200 FORMAT (1X,' UTC = ',D26.16,9X,'XJD = ',D30.16,/,                 &
     &           ' RW2K = ',3D30.20,/,5(6x,3d30.20,/) )
!
!     Normal Conclusion.
      endif
      END
!******************************************************************
      SUBROUTINE WOBP (CFBASE, STAR, EARTH, RPN2K, RS2K, SITEV)
      Implicit None
!
!    WOBP is the partial derivatives section of the Wobble module. It computes
!    the partial derivatives of the delay and rate with respect to the polar
!    motion offsets.
!
!     Calling sequence -
!           Input Variables:
!             1. CFBASE(3)   - The crust fixed baseline vector. (m)
!             3. RPN2K(3,3,2)- The nutation portion of the complete crust fixed
!                              to J2000.0 rotation matrix and its CT time
!                              derivative. (unitless, 1/sec)
!             5. RS2K(3,3,3) - The diurnal spin portion of the complete crust
!                              fixed to J2000.0 rotation matrix and its first
!                              two CT time derivatives. (unitless, 1/s, 1/s**2)
!             6. STAR(3)     - The J2000.0 source unit vector.
!             7. EARTH(3,3)  - The SSBC position, velocity, and acceleration
!                              vectors of the Earth. (m, m/s, m/s**2)
!             8. SITEV(3,2)  - THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF
!                              EACH OBSERVATION SITE. (M/SEC)
!
!     Common blocks used -
!
      INCLUDE 'cphys11.i'
!            Variables 'FROM':
!              1. VLIGHT    -  The velocity of light in a vacuum. (m/s)
!              2. VLIGHT2   -  The velocity of light squared. (m**2/s**2)
!
      INCLUDE 'cmwob11.i'
!            Variables 'FROM':
!              1. RWOBX(3,3) - The rotation matrix which rotates about the crust
!                              fixed Y-axis by an angle equal to WOBX.
!              2. RWOBY(3,3) - The rotation matrix which rotates about the new
!                              X-axis by an angle equal to WOBY. (unitless)
!              3. WOBX       - The left-handed X-wobble. (rad)
!              4. DWOBX      - Time derivative of WOBX. (rad/sec)
!              5. WOBY       - The left-handed Y-wobble. (rad)
!              6. DWOBY      - Time derivative of WOBY. (rad/sec)
!              7. RWX(3,3)   - Rotation matrix used in computation of time
!                              derivative of wobble rotation matrix.
!              8. RWY(3,3)   - Rotation matrix used in computation of time
!                              derivative of wobble rotation matrix.
!              9. RWZ(3,3)   - Rotation matrix used in computation of time
!                              derivative of wobble rotation matrix.
!            Variables 'TO':
!              1. DWOBP(2,2) - The partial derivatives of the delay and rate
!                              with respect to the X and Y polar motion. The
!                              first index runs over the X and Y offsets
!                              and the second runs over delay and rate.
!                              (s/radian, (s/s)/radian)
!
      INCLUDE 'ccon.i'
!            Variables 'FROM':
!              1. KWOBC - The wobble module flow control flag.
!              2. KWOBD - The wobble module debug output flag.
!
!     Program specifications -
!
      Real*8  CFBASE(3), DWOBDX(3,3), DWOBDY(3,3), STAR(3),WOBXDX(3,3), &
     &        WOBYDY(3,3), XBASE(3,2), XR2000(3,3,2), YBASE(3,2), &
     &        YR2000(3,3,2),EARTH(3,3), VG(3), c1, c2, tt, DOTP, &
     &        RPN2K(3,3,2), RS2K(3,3,3), SITEV(3,2), VE(3)
      Real*8  pRWdx(3,3), pRWdy(3,3), prwxdx(3,3), prwydy(3,3), &
     &        pRWx1(3,3), pRWx2(3,3), pRWy1(3,3), pRWy2(3,3), &
     &        pdRWdtdx(3,3), pdRWdtdy(3,3), XRW2000(3,3,2), &
     &        YRW2000(3,3,2), rx1(3,3), rx2(3,3), rx3(3,3), rx4(3,3), &
     &        ry1(3,3), ry2(3,3), ry3(3,3), ry4(3,3), pRW2Kx(3,3,2), &
     &        pRW2Ky(3,3,2), pDRWX1(3,3), pDRWX2(3,3),pDRWX3(3,3), &
     &        pDRWY1(3,3), pDRWY2(3,3),pDRWY3(3,3), pR2Kx(3,3,2), &
     &        pR2Ky(3,3,2), dR2Kx1(3,3), dR2Kx2(3,3), dR2Kx3(3,3), &
     &        dR2Ky1(3,3), dR2Ky2(3,3), dR2Ky3(3,3)
      Integer*4 K, I
!
!    Subroutine Interface -
!             Caller subroutines: DRIVP
!             Called subroutines: DOTP, DROTT, MMUL3, MADD3, VECRT
!
!    Constants used - VLIGHT, VLIGHT2
!
!    Program Variables -
!           1. pRWdx(3,3)    - The partial derivative of the wobble matrix with
!                              respect to the x-offset. (1/radian)
!           2. pRWdy(3,3)    - The partial derivative of the wobble matrix with
!                              respect to the y-offset. (1/radian)
!           3. WOBXDX(3,3)   - The partial derivative of the rotation matrix
!                              RWOBX with respect to the X offset. (1/radian)
!           4. WOBYDY(3,3)   - The partial derivative of the rotation matrix
!                              RWOBY with respect to the Y offset. (1/radian)
!           5. XBASE(3,2)    - The partial derivatives of the J2000.0 baseline
!                              position and velocity vectors with respect to
!                              the X offset. (m/radian, (m/s)/radian)
!           6. YBASE(3,2)    - The partial derivatives of the J2000.0 baseline
!                              position and velocity vectors with respect to
!                              the Y offset. (m/radian, (m/s)/radian)
!           7. XR2000(3,3,2) - The partial derivative of the complete crust
!                              fixed to J2000.0 rotation matrix and its first
!                              CT time derivative with respect to the X offset.
!                              (1/radian,(1/x)/radian)
!           8. YR2000(3,3,2) - The partial derivative of the complete crust
!                              fixed to J2000.0 rotation matrix and its first
!                              CT time derivative with respect to the Y offset.
!                              (1/radian, (1/s)/radian)
!           9. vg(3)         - A local copy of the SSBC velocity vector of the
!                              Earth. See EARTH.
!          10. c1, c2, tt    - Temporary variables used to simplify the
!                              expression for computing the partials.
!          11. pRWxdx        - Partial derivative of RWX w.r.t. X-pole.
!          12. pRWydy        - Partial derivative of RWY w.r.t. Y-pole.
!
!     Programmer - Dale Markham 02/17/77
!      77.07.14  Peter Denatale
!      77.03.28  Kathy Watts
!      77.12.23  Bruce Schupler
!      89.07.26  Jim Ryan  Documentation simplifed and strings.
!      89.10.05  Jim Ryan  CPHYS common made an include file.
!      89.12.12  Jim Ryan  UNIX-like database interface implimented.
!      91.06.06  Jim Ryan  Documentation cleanup.
!      91.11.25  Jim Ryan  Second term in Shapiro's model added to
!                          the computation of the partials.
!      94.04.15  D. Gordon Converted to Implicit None.
!      94.05.23  D. Gordon Fixed bug - use_cubic, use_linear, use_spline were
!                          being dimensioned both Logical*2 and Real*8.
!      95.11.27  D. Gordon Corrected error in second part of DWOBP(2,1).
!      96.02.09  D. Gordon Added dwobx, dwoby, rwx, and rwy to Common/WOBCM/.
!                          Put in all 4 terms for computation of the partials
!                          of the first derivative of the J2000.0 rotation
!                          matrix w.r.t X-pole and Y-pole. Changed DWOBDX to
!                          pRWdx and DWOBDY to pRWdx and reversed order of
!                          multiplication to compute them.
!      98.05.01  D. Gordon Common /WOBCM/ moved into include file cmwob.i.
!      2002 Sept  Jim Ryan Integer*2/4 mods.
!      2003/2004  D.Gordon Modified for CEO-based rotation computations.
!      2004.11.09 D.Gordon Modified partial to use Consensus model.
!      Jan. 2013  D.Gordon Moved PUT to subroutine P_PUT.
!
!    WOBP Program Structure
!
!    Compute the partial derivatives of the rotation matrices RWOBX and RWOBY
!    with respect to the long period X and Y offsets, respectively.
      CALL DROTT ( WOBX, 1.D0, int2(2), WOBXDX)
      CALL DROTT ( WOBY, 1.D0, int2(1), WOBYDY)
!
!   Compute the partial derivatives of RWX w.r.t. X-pole and of RWY w.r.t.
!    Y-pole.
        Call DDROT ( WOBX, DWOBX, int2(2), pRWxdx)
        Call DDROT ( WOBY, DWOBY, int2(1), pRWydy)
!
!**************************
!   Compute partials of the new CEO based wobble rotation matrix,
!    RW2K(1,1,1), with respect to X-pole and Y-pole.
!  Below agrees with POM2000 and IERS Conventions (2003)
      CALL MMUL3 ( RWOBZ, WOBXDX, RWOBY, pRW2Kx(1,1,1) )
      CALL MMUL3 ( RWOBZ,  RWOBX, WOBYDY,pRW2Ky(1,1,1) )
!
!   Compute partials of the time derivative of the new CEO based
!    wobble rotation matrix,
!    RW2K(1,1,2), with respect to X-pole and Y-pole.
!
!  Below agrees with POM2000 and IERS Conventions (2003)
      CALL MMUL3 ( RWOBZ, WOBXDX,   RWY, pDRWX1 )
      CALL MMUL3 ( RWOBZ, pRWXDX, RWOBY, pDRWX2 )
      CALL MMUL3 (   RWZ, WOBXDX, RWOBY, pDRWX3 )
      CALL MADD3 ( pDRWX1, pDRWX2, pDRWX3, pRW2Kx(1,1,2) )
!
!  Below agrees with POM2000 and IERS Conventions (2003)
      CALL MMUL3 ( RWOBZ, RWOBX, pRWYDY, pDRWY1 )
      CALL MMUL3 ( RWOBZ,   RWX, WOBYDY, pDRWY2 )
      CALL MMUL3 (   RWZ, RWOBX, WOBYDY, pDRWY3 )
      CALL MADD3 ( pDRWY1, pDRWY2, pDRWY3, pRW2Ky(1,1,2) )
!
!    Compute partials of CEO-based J2000 rotation matrix, R2K(3,3,2),
!       w.r.t. X-pole and Y-pole.
      CALL MMUL3 (RPN2K(1,1,1),RS2K(1,1,1),pRW2Kx(1,1,1),pR2Kx(1,1,1))
      CALL MMUL3 (RPN2K(1,1,1),RS2K(1,1,1),pRW2Ky(1,1,1),pR2Ky(1,1,1))
!
!    Compute partials of the time derivative of R2K(3,3,2) w.r.t. X-pole
!     and Y-pole.
!   Compute the three terms necessary for the X-pole calculation.
      CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,1), pRW2Kx(1,1,1), dR2Kx1 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,2), pRW2Kx(1,1,1), dR2Kx2 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,1), pRW2Kx(1,1,2), dR2Kx3 )
!   Add the three terms to complete the calculation.
      CALL MADD3 ( dR2Kx1, dR2Kx2, dR2Kx3, pR2Kx(1,1,2 ) )
!   Compute the three terms necessary for the Y-pole calculation.
      CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,1), pRW2Ky(1,1,1), dR2Ky1 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,2), pRW2Ky(1,1,1), dR2Ky2 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,1), pRW2Ky(1,1,2), dR2Ky3 )
!   Add the three terms to complete the calculation.
      CALL MADD3 ( dR2Ky1, dR2Ky2, dR2Ky3, pR2Ky(1,1,2 ) )
!
!***************************************************
!
!    Compute the partial derivatives of the J2000.0 baseline position and
!    velocity vectors with respect to the long period wobble X and Y offsets.
!
      DO 300  K = 1,2
!        New CEO-based partials
        CALL VECRT ( pR2Kx (1,1,K), CFBASE, XBASE(1,K) )
        CALL VECRT ( pR2Ky (1,1,K), CFBASE, YBASE(1,K) )
  300 CONTINUE
!
!    Compute the partial derivatives of the delay and the delay rate with
!    respect to the long period wobble X and Y offsets. 
!    Use the Consensus model definition.
        DO I =1,3
          VG(I) = EARTH(I,2) + SITEV(I,2)
          VE(I) = EARTH(I,2)
        Enddo
         TT = 1.d0 + DOTP(STAR,VG)/VLIGHT
!
      DWOBP(1,1) = Dotp(XBASE(1,1),STAR )/VLIGHT/TT +                   &
     &             Dotp(Xbase(1,1),VE)/VLIGHT2
      DWOBP(1,2) = Dotp(XBASE(1,2),STAR )/VLIGHT/TT +                   &
     &             Dotp(Xbase(1,2),VE)/VLIGHT2
      DWOBP(2,1) = Dotp(YBASE(1,1),STAR )/VLIGHT/TT +                   &
     &             Dotp(Ybase(1,1),VE)/VLIGHT2
      DWOBP(2,2) = Dotp(YBASE(1,2),STAR )/VLIGHT/TT +                   &
     &             Dotp(Ybase(1,2),VE)/VLIGHT2
!
!    'PUT' of the wobble partial derivatives, DWOBP, moved to sub. PUT_P.
!
!    Check KWOBD for debug.
      If (KWOBD .ne. 0) then
      WRITE (6,9)
    7 FORMAT(A,3D25.16,5(/,9X,3D25.16))
    8 FORMAT(A,4D25.16/(7X,5D25.16))
    9 FORMAT (1X, 'DEBUG OUTPUT FOR SUBROUTINE WOBP.' )
!        Write(6,1020) WOBXDX
!1020    Format(1x,'WOBP/WOBXDX: ',(3(/,3E25.15)))
!        Write(6,1021) WOBYDY
!1021    Format(1x,'WOBP/WOBYDY: ',(3(/,3E25.15)))
!        Write(6,1022) pRWxdx
!1022    Format(1x,'WOBP/pRWxdx ',(3(/,3E25.15)))
!        Write(6,1023) pRWydy
!1023    Format(1x,'WOBP/pRWydy ',(3(/,3E25.15)))
!        Write(6,1025) pRW2Kx
 1025    Format(1x,'WOBP/pRW2Kx: ',(6(/,3E25.15)))
!        Write(6,1026) pRW2Ky
 1026    Format(1x,'WOBP/pRW2Ky: ',(6(/,3E25.15)))
!        Write(6,1028) pR2Kx
 1028    Format(1x,'WOBP/pR2Kx: ',(6(/,3E25.15)))
!        Write(6,1029) pR2Ky
 1029    Format(1x,'WOBP/pR2Ky: ',(6(/,3E25.15)))
      WRITE(6,7)' WOBX, DWOBX ', WOBX, DWOBX
      WRITE(6,7)' WOBY, DWOBY ', WOBY, DWOBY
      WRITE(6,7)' WOBXDX  ', WOBXDX
      WRITE(6,7)' WOBYDY  ', WOBYDY
      WRITE(6,7)' RWOBX   ',RWOBX
      WRITE(6,7)' RWOBY   ',RWOBY
      WRITE(6,7)' RWX     ', RWX
      WRITE(6,7)' pRWxdx  ', pRWxdx
      WRITE(6,7)' RWY     ', RWY
      WRITE(6,7)' pRWydy  ', prwydy
      WRITE(6,7)' pRW2Kx  ', pRW2Kx
      WRITE(6,7)' pRW2Ky  ', pRW2Ky
      WRITE(6,7)' pR2Kx   ', pR2Kx
      WRITE(6,7)' pR2Ky   ', pR2Ky
      WRITE(6,8)' DWOBP   ',DWOBP
      WRITE(6,8)' VLIGHT, VLIGHT2 ', VLIGHT, VLIGHT2
      WRITE(6,8)' XBASE   ',XBASE
      WRITE(6,8)' YBASE   ',YBASE
      WRITE(6,8)' C1, C2, TT ', C1, C2, TT
      WRITE(6,8)' VG      ',VG
      WRITE ( 6, 9200 )  CFBASE, RPN2K, RS2K, STAR
 9200 FORMAT (1X, 'CFBASE = ', 3 ( D30.16, 10X ), /, 1X, &
     &            'RPN2K  = ', 6 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'RS2K   = ', 9 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'STAR   = ', 3 ( D30.16))
!
!     Normal conclusion.
      endif
      END
!***************************************************************************
      SUBROUTINE WOBC(Xti, Yti, dXti, dYti)
      Implicit None
!
!    WOBC is the contributions section of the wobble module. It computes the
!    contributions to the delay and rate due to polar motion X and Y offsets.
!
!     Common blocks used -
!
      INCLUDE 'cmwob11.i'
!            Variables 'FROM':
!              1. DWOBP(2,2) - The polar motion partials. (See above.)
!              2. WOBX       - The left-handed X-wobble. (rad)
!              3. DWOBX      - Time derivative of WOBX. (rad/sec)
!              4. WOBY       - The left-handed Y-wobble. (rad)
!              5. DWOBY      - Time derivative of WOBY. (rad/sec)
!              6. WOBXn      - Short period X libration contribution. (rad)
!              7. WOBYn      - Short period Y libration contribution. (rad)
!              8. dWOBXn     - Time derivative of WOBXn. (rad/sec)
!              9. dWOBYn     - Time derivative of WOBYn. (rad/sec)
!             10. WOBXli     - Short period X libration contribution. (rad)
!             11. WOBYli     - Short period Y libration contribution. (rad)
!             12. dWOBXli    - Time derivative of WOBXn. (rad/sec)
!             13. dWOBYli    - Time derivative of WOBYn. (rad/sec)
!             14. WOBXti     - Short period X tidal contribution. (rad)
!             15. WOBYti     - Short period Y tidal contribution. (rad)
!
      INCLUDE 'ccon.i'
!            Variables 'FROM':
!              1. KWOBC  -  The wobble module flow control flag.
!              2. KWOBD  -  The wobble module debug output flag.
!
!   Common blocks used:
      INCLUDE 'put2s.i'
!       Variables from:
!         1. DWOBXC(2)  - The contributions to the delay and rate due to
!                         the X-pole offset. (s, s/s)
!         2. DWOBYC(2)  - The contributions to the delay and rate due to
!                         the Y-pole offset. (s, s/s)
!         3. DWOBlib(2) - The contributions to the delay and rate due to
!                         the X and Y short period libration. (s, s/s)
!         4. DWOBtid(2) - The contributions to the delay and rate due to
!                         the X and Y ocean tides. (s, s/s)
!
! 
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!            Variables 'FROM':
!              1. CONVDS  -  The conversion factor of radians per arcsecond.
!                            (radians/arcsecond).
!
!    Program specifications -
      Real*8 Xti, Yti, dXti, dYti
      Integer*4 K, J
!
!     Subroutine interface -
!             Caller subroutines: DRIVC
!             Called subroutines: 
!
!     Program variables - None
!
!     Programmer - Dale Marknam  02/17/77
!      77.07.14  Peter Denatale
!      77.03.28  Kathy Watts
!      77.12.23  Bruce Schupler
!      89.07.26  Jim Ryan  Documentation simplifed and strings.
!      89.12.12  Jim Ryan  UNIX-like database interface implimented.
!      91.06.06  Jim Ryan  Documentation cleaned up.
!      91.12.17  D. Gordon Bug fixed. For KWOBC = 2 or 3, contributions were
!                          incorrectly being set to zero. (Calc 7.n versions)
!      94.04.15  D.Gordon  Converted to Implicit None.
!      94.05.23  D.Gordon  Fixed bug - use_cubic, use_linear, use_spline were
!                          being dimensioned both Logical*2 and Real*8.
!      94.06.29  D.Gordon  Wobble contribution (DWOBC(2,2)) split into X and Y
!                          components (dwobxc(2) and dwobyc(2)) for
!                          compatability with SOLVE.
!      95.10.05  D.Gordon  Corrected wobble contributions when KWOBC=1 (Wobble
!                          module turned OFF). DO loops restructured.
!      95.11.27  D.Gordon  Added DWOBXC and DWOBYC to debug printout, removed
!                          DWOBC which is no longer used. Documentation
!                          corrected.
!      98.05.01  D. Gordon Common /WOBCM/ moved into include file cmwob.i.
!      2002 Sept Jim Ryan  Integer*2/4 mods.
!      2004.08.10 D. Gordon Added contributions for short period tidal
!                           and nutation polar motion.
!      2012Oct/Nov D.Gordon Mods for IERS 2010. Short period 'nutation'
!                           changed to 'libration'. 'WOBNUTAT' lcode changed
!                           to 'WOBLIBRA'. 
!      Jan. 2013 D. Gordon  Moved all PUT's to subroutine PUT_C.
!
!  WOBC Program Structure
!
!   Compute the contributions.
      Do K=1,2
        DWOBXC(k) = DWOBP(1,K) * WOBX
        DWOBYC(k) = DWOBP(2,K) * WOBY
      Enddo
!         print *,' DWOBXC (psec): ', DWOBXC(1)*1.D12,DWOBXC(2)*1.D12
!         print *,' DWOBYC (psec): ', DWOBYC(1)*1.D12,DWOBYC(2)*1.D12
!        print *,' DWOBP(1,1)/(1,2):', DWOBP(1,1), DWOBP(1,2)         
!        print *,' DWOBP(2,1)/(2,2):', DWOBP(2,1), DWOBP(2,1)         
!
!        print *,' WOBXti:         ', WOBXti
!        print *,' WOBXli, dWOBXli:', WOBXli, dWOBXli
!
!   Compute the short period (libration/nutation and tidal) contributions.
      DO K=1,2
        DWOBlib(K) = DWOBP(1,K)*WOBXli + DWOBP(2,K)*WOBYli
!
        DWOBorth(K) = DWOBP(1,K)*WOBXti + DWOBP(2,K)*WOBYti            
!       DWOBorth(K) = DWOBP(1,K) * Xti*CONVDS*1.0D-3 + &
!    &                DWOBP(2,K) * Yti*CONVDS*1.0D-3
      ENDDO
!      print *,' DWOBorth (psec): ', DWOBorth(1)*1.D12,DWOBorth(2)*1.D12
!      print *,' DWOBlib  (psec): ', DWOBlib(1)*1.D12, DWOBlib(2)*1.D12
!
!   Check KWOBC to see if wobble is to be turned off.
      IF (KWOBC .EQ. 1)  Then
        Do K=1,2
            DWOBXC(K) = 0.d0
            DWOBYC(K) = 0.d0
        Enddo
      ENDIF
!
!   PUT the wobble contributions => moved to subroutine PUT_C.
!
  300 Continue
!
!   Check KWOBD for debug output.
      IF ( KWOBD .EQ. 0 )  GO TO 600
      WRITE ( 6, 9 )
    9 FORMAT (1X, 'Debug output for subroutine WOBC.' )
      WRITE(6,8)' DWOBXC  ',DWOBXC
      WRITE(6,8)' DWOBYC  ',DWOBYC
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' DWOBP   ',DWOBP
      WRITE(6,8)' WOBX, WOBY ', WOBX, WOBY
      WRITE(6,8)' DWOBlib  ', DWOBlib
      WRITE(6,8)' DWOBorth ', DWOBorth
!     WRITE(6,8)' DWOBP   ',DWOBP(1,1),DWOBP(2,1),DWOBP(1,2),DWOBP(2,2)
!     print *,  ' DWOBXC (psec)  ', DWOBXC(1)*1.D12, DWOBXC(2)*1.D12
!     print *,  ' DWOBYC (psec)  ', DWOBYC(1)*1.D12, DWOBYC(2)*1.D12
!     print *,  ' DWOBlib (psec)  ', DWOBlib(1)*1.D12, DWOBlib(2)*1.D12
!     print *,  ' DWOBtid (psec)  ', DWOBtid(1)*1.D12, DWOBtid(2)*1.D12
!
!     Normal conclusion.
  600 RETURN
      END
!*************************************************************************
      SUBROUTINE WOBMU(XJD,tab_time,WOBXL,WOBYL,DWOBXL,DWOBYL)
      Implicit None
!
!    WOBMU is the Wobble module utility. It provides interpolated values of the
!    X and Y wobble at the epochs specified in the calling sequence. If the
!    specified epoch is outside the range of the interpolation table, the
!    program issues a message and stops.
!
!     Calling sequence - CALL WOBMU(XJD,UTC,WOBXL,WOBYL)
!
!      Input Variables:
!        1) XJD     -  The Julian date at 0:00 hours UTC of the epoch for
!                      interpolation. (days)
!        2) tab_time - The fraction of the day in the timescale of the
!                      input EOP series (CT, UTC, or ???).
!
!      Output variables:
!        1) WOBXL  -  The interpolated value of the X wobble.
!                     (left-handed, milliarcsec)
!        2) WOBYL  -  The interpolated value of the Y wobble.
!                     (left-handed, milliarcsec)
!
!     Common blocks used -
!
      INCLUDE 'cmwob11.i'
!        Variables 'FROM':
!          1) WOBIF(3)    - The wobble information array. (See above.)
!          2) XYWOB(2,10) - The tabular points for the X & Y offsets.
!                           (milliarcsec)
!
      INCLUDE 'ccon.i'
!     Variables 'FROM':
!        1) KWOBC - The Wobble module flow control flag.
!                   0 --> Default, module on; spline interpolation for 1-day
!                         series, cubic for 5-day series.
!                   1 --> Module off. No polar motion applied.
!                   2 --> Module on; linear interpolation for any series.
!                   3 --> Module on; cubic interpolation for 1-day series,
!                         spline for 5-day series.
!        2) KWOBD - The wobble module debug control flag.
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!            Variables 'FROM':
!              1. SECDAY - The number of seconds in a day (s/day).
!
!     Program specifications -
!
      Real*8 XJD, UTC, WOBXL, WOBYL, T, DWOBXL, DWOBYL, S, tab_time
      Real*8 XINT(4,2), F2(2), Y1(2,2), Y2(2,2)
      Real*8 x_spline, yx_spline, yy_spline, yxdot, yydot, yxdot2, &
     &       yydot2, yxdot3, yydot3
      Integer*4 INT, I, N, NN, NR, ILAST, ierr4
!
!     Subroutine interface:
!         Caller subroutines: WOBI, WOBG
!         Called subroutines: SPLINT4
!
!     Programmer - Bruce Schupler 12/23/77
!      89.07.26  Jim Ryan  Documentation simplifed and strings.
!      90.05.06  Jim Ryan  Mods for linear interpolation.
!      91.06.06  Jim Ryan  Linear interpolation mods and clean up.
!      93.12.17  D. Gordon Spline interpolation mods.
!      94.04.13  D. Gordon DFLOT changed to Fortran 77 DFLOTJ.
!      94.04.15  D. Gordon Converted to Implicit None.
!      94.05.23  D. Gordon Fixed bug - use_cubic, use_linear, use_spline were
!                          being dimensioned both Logical*2 and Real*8.
!      95.06.09  D. Gordon Cleaned up debug printout.
!      95.12.11  D. Gordon Adding computation of time derivatives of X- and
!                          Y-wobble for linear interpolation.
!      95.12.28  D. Gordon Adding computation of time derivatives of X- and
!                          Y-wobble for cubic polynomial interpolation. Debug
!                          printout mods and additions.
!      98.05.01  D. Gordon Common /WOBCM/ moved into include file cmwob.i.
!      2002 Sept Jim Ryan  Integer*2/4 mods.
!
!     WOBMU Program Structure
!
!    Convert UTC and XJD to the units of the interval of the table relative to
!    the first point of the table. INT is computed so that INT+2 is the number
!    of the tabular point just before (or at) the time of the observation and
!    INT+3 is the number of the point after the time of the observation.
!
      T =  (XJD  -  WOBIF(1))
      T = (T + tab_time) / WOBIF(2)
      INT = T
      T =  T - DFLOAT (INT)
      INT = INT - 1
!
!**************************************
!   Code for cubic spline interpolation
      IF (use_spline) then     ! Spline interpolation
!
!   Compute time of obs. and divide by interval
        x_spline = (xjd + tab_time)/ WOBIF(2)
!
!   In case the interval (WOBIF(2)) is not 1.0 days, divide by interval
!       x_spline = x_spline / WOBIF(2)
!
!  Perform cubic spline for X-wobble interpolation
        call splint4(xa,yax,y2sx,n_spline,x_spline,yx_spline,yxdot, &
     &               yxdot2,yxdot3,ierr4)
        WOBXL = yx_spline
        DWOBXL = yxdot / (WOBIF(2) * SECDAY)
!
!  Perform cubic spline for Y-wobble interpolation
        call splint4(xa,yay,y2sy,n_spline,x_spline,yy_spline,yydot, &
     &               yydot2,yydot3,ierr4)
        WOBYL = yy_spline
        DWOBYL = yydot / (WOBIF(2) * SECDAY)
!
      Endif               ! Spline interpolation
!
!**************************************
!   Code for cubic polynomial interpolation
      If(use_cubic) Then            !3rd order polynomial interpolation
!
!   Select the four tabular points from each of the XWOB and YWOB arrays and
!   verify that the interpolation is not outside the range of the table.
!   (NOTE: If the interpolation is outside the range of the table, a message is
!    written and the program terminates.)
!
        ILAST = IDINT ( WOBIF(3) )
        Do N = 1,4
          NN = INT  +  N
          IF ( ( NN .LT. 1 ) .OR. ( NN .GT. ILAST ) )  GO TO 900
          XINT(N,1) = XYWOB(1,NN)
          XINT(N,2) = XYWOB(2,NN)
        Enddo
!
!    Do the cubic interpolation.
        DO I = 1,2
          DO N = 1,2
            NR = N + 1
            F2(I) = ( XINT ( NR+1, I ) + XINT ( NR-1, I ) ) / 6.D0
            Y1(N,I) = + ( 4.D0 / 3.D0 ) * XINT ( NR, I ) - F2(I)
            Y2(N,I) = - ( 1.D0 / 3.D0 ) * XINT ( NR, I ) + F2(I)
          enddo
        enddo
!
       S = 1.D0 - T
       WOBXL = T * ( Y1(2,1)  +  T**2 * Y2(2,1) ) &
     &       + S * ( Y1(1,1)  +  S**2 * Y2(1,1) )
       WOBYL = T * ( Y1(2,2)  +  T**2 * Y2(2,2) ) &
     &       + S * ( Y1(1,2)  +  S**2 * Y2(1,2) )
!
       DWOBXL = ( Y1(2,1) + (3.D0*T**2*Y2(2,1)) &
     &          - Y1(1,1) - (3.D0*S**2*Y2(1,1)) ) / (WOBIF(2)*SECDAY)
       DWOBYL = ( Y1(2,2) + (3.D0*T**2*Y2(2,2)) &
     &          - Y1(1,2) - (3.D0*S**2*Y2(1,2)) ) / (WOBIF(2)*SECDAY)
!
      Endif                         !3rd order polynomial interpolation
!
!**************************************
!   Code for linear interpolation
      If(use_linear) Then           !2 point linear interpolation
        If(INT+1 .lt. 1  .or. &
     &     INT+1 .gt. DINT(WOBIF(3)+.001)) Then
          Write(6,'( &
     &    "Error in WOBMU! Attempted to interpolate polar motion",/, &
     &    "outside of PM table. INT =",i5)') INT
       Call TERMINATE_CALC( 'WOBMU ', int2(0), int2(0))
        Endif
!
!   Interpolate linearly. Don't change the units.
        WOBXL = (XYWOB(1,INT+3)-XYWOB(1,INT+2))*T + XYWOB(1,INT+2)
        WOBYL = (XYWOB(2,INT+3)-XYWOB(2,INT+2))*T + XYWOB(2,INT+2)
!   Compute time derivative.
        DWOBXL =  (XYWOB(1,INT+3)-XYWOB(1,INT+2)) / (WOBIF(2) * SECDAY)
        DWOBYL =  (XYWOB(2,INT+3)-XYWOB(2,INT+2)) / (WOBIF(2) * SECDAY)
!
      Endif                         !2 point linear interpolation
!
!**************************************
!    Check to see if debug output is requested.
      IF (KWOBD .NE. 1) GO TO 400
      WRITE(6,9)
      If(use_spline) write(6,'(" Spline interpolation used.")')
      If(use_cubic) write(6,'(" Cubic polynomial interpolation used.")')
      If(use_linear) write(6,'(" Linear interpolation used.")')
      WRITE(6,8)' T       ',T
      WRITE(6,7)' INT     ',INT
      WRITE(6,8)' XYWOB   ',XYWOB
      WRITE(6,9120) XJD, tab_time, WOBXL, WOBYL, DWOBXL, DWOBYL
!
      if (use_spline) then
        WRITE(6,8)' x_spline ', x_spline
        write (6,'("  xa: ",5d20.10,3(/,6x,5d20.10))') xa
        write (6,'("n_spline",i5,"x_spline ",d25.16)') n_spline,x_spline
        write (6,'(" yax: ",5d20.10,3(/,6x,5d20.10))') yax
        write (6,'("y2sx: ",5d20.10,3(/,6x,5d20.10))') y2sx
        write (6,8)' yx_spline ', yx_spline
        write (6,8)' yxdot, yxdot2, yxdot3 ', yxdot, yxdot2, yxdot
        write (6,'(" yay: ",5d20.10,3(/,6x,5d20.10))') yay
        write (6,'("y2sy: ",5d20.10,3(/,6x,5d20.10))') y2sy
        write (6,8)' yy_spline ', yy_spline
        write (6,8)' yydot, yydot2, yydot3 ', yydot, yydot2, yydot
      endif
!
      if (use_cubic) then
        WRITE(6,7)' ILAST ', ILAST
        WRITE(6,8)' XINT  ', XINT
        WRITE(6,8)' F2    ', F2
        WRITE(6,8)' Y1    ', Y1
        WRITE(6,8)' Y2    ', Y2
        WRITE(6,8)' S     ',  S
      endif
!
    7 FORMAT(A,15I8/(9X,15I8))
    8 FORMAT(A,4D25.16/(7X,5D25.16))
    9 FORMAT(1X,'Debug output for subroutine WOBMU')
 9120 FORMAT(1X,'   XJD = ',D30.16,3X,'tab_time = ',D30.16,/, &
     &       1X,' WOBXL = ',D30.16,3X,'   WOBYL = ',D30.16,/, &
     &       1X,'DWOBXL = ',D30.16,3X,'  DWOBYL = ',D30.16)
!
!     Normal Conclusion.
  400 RETURN
!
!     Abnormal conclusion.
  900 WRITE ( 6, 9300 )  NN, ILAST
 9300 FORMAT (1X, ' CALC has terminated in subroutine WOBMU.',/, &
     & ' The interpolation is outside the range of the wobble table.', &
     & /,'  NN = ', I2, ' ILAST = ', I2, '.' )
      CALL TERMINATE_CALC ( 'WOBMU ', int2(0), int2(0))
      END
!
!**************************************************************************
      SUBROUTINE XYLIB (GMST2K, FA2K, FAD2K, Xp, Yp, dXp, dYp)
      IMPLICIT None
!
!     Input Variables:
!          GMST2K(2) = Greenwich mean siderial time and its first time
!                      derivative (radians, radians/sec)
!          FA2K(14)  = Fundamental arguments from subroutine NUTFA (radians)
!          FAD2K(14) = Time derivatives of fundamental arguments (rad/sec)
!     Output Variables:
!          Xp  = Short term nutation correction to X-polar motion (mas)
!          Yp  = Short term nutation correction to Y-polar motion (mas)
!          dXp = Time derivative of Short term nutation correction to 
!                X-polar motion (mas/sec)
!          dYp = Time derivative of Short term nutation correction to 
!                Y-polar motion (mas/sec)
!
      REAL*8 GMST2K(2), Xp, Yp, dXp, dYp
      REAL*8 L, LP, fa(5), fad(5), ARG, dARG
      Integer*4 N, I
      REAL*8 XS(10,10), X1(100)
      EQUIVALENCE(XS(1,1),X1(1))
!
      INCLUDE 'ccon.i'
!
      REAL*8 FA2K(14), FAD2K(14)
!     COMMON / NFA2K / FA2K, FAD2K
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          Variables 'from':
!            1. SECDAY -  The number of seconds in a day. (s/day)
!            2. TWOPI  -  PI times 2.0D0
!            3. CONVDS -  THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!  N=Number of tidal terms to be used (10 for full set).
!  (This was an argument in the original zontids routine.)
      DATA  N/10/
!
!***********************************************************************
!     Short period nutation terms
!     From Table 5.1, IERS Conventions (2003)
!
!                  Multiple of                  Xp             Yp
!              l   l'   F    D  OMEGA Chi   sin    cos     sin     cos
!     DATA X1/-1., 0., -2.,  0., -1., 1.,  -0.44,  0.25,  -0.25,  -0.44, &
!    &        -1., 0., -2.,  0., -2., 1.,  -2.31,  1.32,  -1.32,  -2.31, &
!    &         1., 0., -2., -2., -2., 1.,  -0.44,  0.25,  -0.25,  -0.44, &
!    &         0., 0., -2.,  0., -1., 1.,  -2.14,  1.23,  -1.23,  -2.14, &
!    &         0., 0., -2.,  0., -2., 1., -11.36,  6.52,  -6.52, -11.36, &
!    &        -1., 0.,  0.,  0.,  0., 1.,   0.84, -0.48,   0.48,   0.84, &
!    &         0., 0., -2.,  2., -2., 1.,  -4.76,  2.73,  -2.73,  -4.76, &
!    &         0., 0.,  0.,  0.,  0., 1.,  14.27, -8.19,   8.19,  14.27, &
!    &         0., 0.,  0.,  0., -1., 1.,   1.93, -1.11,   1.11,   1.93, &
!    &         1., 0.,  0.,  0.,  0., 1.,   0.76, -0.43,   0.43,   0.76/
!
!***********************************************************************
!     Short period nutation terms
!     From Table 5.1a, IERS Conventions (2010)
!
!                  Multiple of                  Xp             Yp
!              l   l'   F    D  OMEGA Chi   sin    cos     sin     cos
      DATA X1/-1., 0., -2.,  0., -1., 1.,  -0.4 ,  0.3 ,  -0.3 ,  -0.4 , &
     &        -1., 0., -2.,  0., -2., 1.,  -2.3 ,  1.3 ,  -1.3 ,  -2.3 , &
     &         1., 0., -2., -2., -2., 1.,  -0.4 ,  0.3 ,  -0.3 ,  -0.4 , &
     &         0., 0., -2.,  0., -1., 1.,  -2.1 ,  1.2 ,  -1.2 ,  -2.1 , &
     &         0., 0., -2.,  0., -2., 1., -11.4 ,  6.5 ,  -6.5 , -11.4 , &
     &        -1., 0.,  0.,  0.,  0., 1.,   0.8 , -0.5 ,   0.5 ,   0.8 , &
     &         0., 0., -2.,  2., -2., 1.,  -4.8 ,  2.7 ,  -2.7 ,  -4.8 , &
     &         0., 0.,  0.,  0.,  0., 1.,  14.3 , -8.2 ,   8.2 ,  14.3 , &
     &         0., 0.,  0.,  0., -1., 1.,   1.9 , -1.1 ,   1.1 ,   1.9 , &
     &         1., 0.,  0.,  0.,  0., 1.,   0.8 , -0.4 ,   0.4 ,   0.8 /
!***********************************************************************
!
!
      Xp  = 0.0D+0
      Yp  = 0.0D+0
      dXp = 0.0D+0
      dYp = 0.0D+0
!
!     Sum zonal tide terms
!
      DO 10 I=1, N
!   Formation of multiples of arguments
      ARG = XS(1,I)*FA2K(1) + XS(2,I)*FA2K(2) + XS(3,I)*FA2K(3) &
     &    + XS(4,I)*FA2K(4) + XS(5,I)*FA2K(5) + XS(6,I)*(GMST2K(1)+PI)
      ARG = DMOD(ARG,TWOPI)
!     ARG = DMOD(ARG,1296000.0D0) * CONVDS
!   First derivative
      dARG = XS(1,I)*FAD2K(1) + XS(2,I)*FAD2K(2) + XS(3,I)*FAD2K(3) &
     &     + XS(4,I)*FAD2K(4) + XS(5,I)*FAD2K(5) + XS(6,I)*(GMST2K(2))
!
!     Evaluate zonal tidal terms (micro-arcsec)
       Xp  = XS(7,I)*DSIN(ARG) +  XS(8,I)*DCOS(ARG) + Xp
       Yp  = XS(9,I)*DSIN(ARG) + XS(10,I)*DCOS(ARG) + Yp
       dXp = XS(7,I)*DCOS(ARG)*dARG -  XS(8,I)*DSIN(ARG)*dARG + dXp
       dYp = XS(9,I)*DCOS(ARG)*dARG - XS(10,I)*DSIN(ARG)*dARG + dYp
   10 CONTINUE
!
!  Change from micro-arsecs to milli-arcsecs
      Xp  =  Xp*1.0D-3
      Yp  =  Yp*1.0D-3
      dXp = dXp*1.0D-3
      dYp = dYp*1.0D-3
!
!       print *, ' XYNUT: GMST2K:  ', GMST2K
!       print *, ' XYNUT: Xp, dXp: ', Xp, dXp
!       print *, ' XYNUT: Yp, dYp: ', Yp, dYp
!
      RETURN
      END
!
!**************************************************************************
      SUBROUTINE XYTID (GMST2K, FA2K, FAD2K, Xt, Yt, dXt, dYt)
      IMPLICIT None
!
!     Input Variables:
!          GMST2K(2) = Greenwich mean siderial time and its first time
!                      derivative (radians, radians/sec)
!          FA2K(14)  = Fundamental arguments from subroutine NUTFA (radians)
!          FAD2K(14) = Time derivatives of fundamental arguments (rad/sec)
!     Output Variables:
!          Xt =
!          Yt =
!
      REAL*8 GMST2K(2), Xt, Yt, dXt, dYt
      REAL*8 L, LP, fa(5), fad(5), ARG, dARG
      Integer*4 N, I
      REAL*8 XS(11,71), X1(781)
      EQUIVALENCE(XS(1,1),X1(1))
!
      INCLUDE 'ccon.i'
!
      REAL*8 FA2K(14), FAD2K(14)
!     COMMON / NFA2K / FA2K, FAD2K
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          Variables 'from':
!            1. SECDAY -  The number of seconds in a day. (s/day)
!            2. TWOPI  -  PI times 2.0D0
!            3. CONVDS -  THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!  N=Number of tidal terms to be used (71 for full set).
!  (This was an argument in the original zontids routine.)
      DATA  N/71/
!
!***********************************************************************
!     Short period ocean tidal terms
!     From Table 8.2, IERS Conventions (2003)
!                  Multiple of                    Xp            Yp
!        l   l' F   D OMGA Chi   Period       sin    cos    sin    cos
      DATA X1/ &
     & -1., 0.,-2.,-2.,-2., 1., 1.2113611,    0.0,   0.9,   -0.9, -0.1, &
     & -2., 0.,-2., 0.,-1., 1., 1.1671262,    0.1,   0.6,   -0.6,  0.1, &
     & -2., 0.,-2., 0.,-2., 1., 1.1669259,    0.3,   3.4,   -3.4,  0.3, &
     &  0., 0.,-2.,-2.,-1., 1., 1.1605476,    0.1,   0.8,   -0.8,  0.1, &
     &  0., 0.,-2.,-2.,-2., 1., 1.1603495,    0.5,   4.2,   -4.1,  0.5, &
     & -1., 0.,-2., 0.,-1., 1., 1.1196993,    1.2,   5.0,   -5.0,  1.2, &
     & -1., 0.,-2., 0.,-2., 1., 1.1195148,    6.2,  26.3,  -26.3,  6.2, &
     &  1., 0.,-2.,-2.,-1., 1., 1.1136429,    0.2,   0.9,   -0.9,  0.2, &
     &  1., 0.,-2.,-2.,-2., 1., 1.1134606,    1.3,   5.0,   -5.0,  1.3, &
     &  0., 0.,-2., 0., 0., 1., 1.0761465,   -0.3,  -0.8,    0.8, -0.3, &
     &  0., 0.,-2., 0.,-1., 1., 1.0759762,    9.2,  25.1,  -25.1,  9.2, &
     &  0., 0.,-2., 0.,-2., 1., 1.0758059,   48.8, 132.9, -132.9, 48.8, &
     & -2., 0., 0., 0., 0., 1., 1.0750901,   -0.3,  -0.9,    0.9, -0.3, &
     &  0., 0., 0.,-2., 0., 1., 1.0695055,   -0.7,  -1.7,    1.7, -0.7, &
     & -1., 0.,-2., 2.,-2., 1., 1.0406147,   -0.4,  -0.9,    0.9, -0.4, &
     &  1., 0.,-2., 0.,-1., 1., 1.0355395,   -0.3,  -0.6,    0.6, -0.3, &
     &  1., 0.,-2., 0.,-2., 1., 1.0353817,   -1.6,  -3.5,    3.5, -1.6, &
     & -1., 0., 0., 0., 0., 1., 1.0347187,   -4.5,  -9.6,    9.6, -4.5, &
     & -1., 0., 0., 0.,-1., 1., 1.0345612,   -0.9,  -1.9,    1.9, -0.9, &
     &  1., 0., 0.,-2., 0., 1., 1.0295447,   -0.9,  -1.8,    1.8, -0.9, &
     &  0.,-1.,-2., 2.,-2., 1., 1.0055058,    1.5,   3.0,   -3.0,  1.5, &
     &  0., 0.,-2., 2.,-1., 1., 1.0028933,   -0.3,  -0.6,    0.6, -0.3, &
     &  0., 0.,-2., 2.,-2., 1., 1.0027454,   26.1,  51.2,  -51.2, 26.1, &
     &  0., 1.,-2., 2.,-2., 1., 1.0000001,   -0.2,  -0.4,    0.4, -0.2, &
     &  0.,-1., 0., 0., 0., 1., 0.9999999,   -0.6,  -1.2,    1.2, -0.6, &
     &  0., 0., 0., 0., 1., 1., 0.9974159,    1.5,   3.0,   -3.0,  1.5, &
     &  0., 0., 0., 0., 0., 1., 0.9972695,  -77.5,-151.7,  151.7,-77.5, &
     &  0., 0., 0., 0.,-1., 1., 0.9971233,  -10.5, -20.6,   20.6,-10.5, &
     &  0., 0., 0., 0.,-2., 1., 0.9969771,    0.2,   0.4,   -0.4,  0.2, &
     &  0., 1., 0., 0., 0., 1., 0.9945541,   -0.6,  -1.2,    1.2, -0.6, &
     &  0., 0., 2.,-2., 2., 1., 0.9918532,   -1.1,  -2.1,    2.1, -1.1, &
     & -1., 0., 0., 2., 0., 1., 0.9669565,   -0.7,  -1.4,    1.4, -0.7, &
     &  1., 0., 0., 0., 0., 1., 0.9624365,   -3.5,  -7.3,    7.3, -3.5, &
     &  1., 0., 0., 0.,-1., 1., 0.9623003,   -0.7,  -1.4,    1.4, -0.7, &
     &  0., 0., 0., 2., 0., 1., 0.9341741,   -0.4,  -1.1,    1.1, -0.4, &
     &  2., 0., 0., 0., 0., 1., 0.9299547,   -0.2,  -0.5,    0.5, -0.2, &
     &  0., 0., 2., 0., 2., 1., 0.9294198,   -1.1,  -3.4,    3.4, -1.1, &
     &  0., 0., 2., 0., 1., 1., 0.9292927,   -0.7,  -2.2,    2.2, -0.7, &
     &  0., 0., 2., 0., 0., 1., 0.9291657,   -0.1,  -0.5,    0.5, -0.1, &
     &  1., 0., 2., 0., 2., 1., 0.8990932,    0.0,  -0.6,    0.6,  0.0, &
     &  1., 0., 2., 0., 1., 1., 0.8989743,    0.0,  -0.4,    0.4,  0.0, &
     & -3., 0.,-2., 0.,-2., 2., 0.5484264,   -0.5,   0.0,    0.6,  0.2, &
     & -1., 0.,-2.,-2.,-2., 2., 0.5469695,   -1.3,  -0.2,    1.5,  0.7, &
     & -2., 0.,-2., 0.,-2., 2., 0.5377239,   -6.1,  -1.6,    3.1,  3.4, &
     &  0., 0.,-2.,-2.,-2., 2., 0.5363232,   -7.6,  -2.0,    3.4,  4.2, &
     &  0., 1.,-2.,-2.,-2., 2., 0.5355369,   -0.5,  -0.1,    0.2,  0.3, &
     & -1.,-1.,-2., 0.,-2., 2., 0.5281939,    0.5,   0.1,   -0.1, -0.3, &
     & -1., 0.,-2., 0.,-1., 2., 0.5274721,    2.1,   0.5,   -0.4, -1.2, &
     & -1., 0.,-2., 0.,-2., 2., 0.5274312,  -56.9, -12.9,   11.1, 32.9, &
     & -1., 1.,-2., 0.,-2., 2., 0.5266707,   -0.5,  -0.1,    0.1,  0.3, &
     &  1., 0.,-2.,-2.,-2., 2., 0.5260835,  -11.0,  -2.4,    1.9,  6.4, &
     &  1., 1.,-2.,-2.,-2., 2., 0.5253269,   -0.5,  -0.1,    0.1,  0.3, &
     & -2., 0.,-2., 2.,-2., 2., 0.5188292,    1.0,   0.1,   -0.1, -0.6, &
     &  0.,-1.,-2., 0.,-2., 2., 0.5182593,    1.1,   0.1,   -0.1, -0.7, &
     &  0., 0.,-2., 0.,-1., 2., 0.5175645,   12.3,   1.0,   -1.4, -7.3, &
     &  0., 0.,-2., 0.,-2., 2., 0.5175251, -330.2, -27.0,   37.6,195.9, &
     &  0., 1.,-2., 0.,-2., 2., 0.5167928,   -1.0,  -0.1,    0.1,  0.6, &
     & -1., 0.,-2., 2.,-2., 2., 0.5092406,    2.5,  -0.3,   -0.4, -1.5, &
     &  1., 0.,-2., 0.,-2., 2., 0.5079842,    9.4,  -1.4,   -1.9, -5.6, &
     & -1., 0., 0., 0., 0., 2., 0.5078245,   -2.4,   0.4,    0.5,  1.4, &
     & -1., 0., 0., 0.,-1., 2., 0.5077866,   -1.0,   0.2,    0.2,  0.6, &
     &  0.,-1.,-2., 2.,-2., 2., 0.5006854,   -8.5,   3.5,    3.3,  5.1, &
     &  0., 0.,-2., 2.,-2., 2., 0.5000000, -144.1,  63.6,   59.2, 86.6, &
     &  0., 1.,-2., 2.,-2., 2., 0.4993165,    1.2,  -0.6,   -0.5, -0.7, &
     &  0., 0., 0., 0., 1., 2., 0.4986714,    0.5,  -0.2,   -0.2, -0.3, &
     &  0., 0., 0., 0., 0., 2., 0.4986348,  -38.5,  19.1,   17.7, 23.1, &
     &  0., 0., 0., 0.,-1., 2., 0.4985982,  -11.4,   5.8,    5.3,  6.9, &
     &  0., 0., 0., 0.,-2., 2., 0.4985616,   -1.2,   0.6,    0.6,  0.7, &
     &  1., 0., 0., 0., 0., 2., 0.4897717,   -1.8,   1.8,    1.7,  1.0, &
     &  1., 0., 0., 0.,-1., 2., 0.4897365,   -0.8,   0.8,    0.8,  0.5, &
     &  0., 0., 2., 0., 2., 2., 0.4810750,   -0.3,   0.6,    0.7,  0.2/
!
!***********************************************************************
      Xt  = 0.0D+0
      Yt  = 0.0D+0
      dXt = 0.0D+0
      dYt = 0.0D+0
!
!     Sum zonal tide terms
!
      DO 10 I=1, N
!   Formation of multiples of arguments
      ARG = XS(1,I)*FA2K(1) + XS(2,I)*FA2K(2) + XS(3,I)*FA2K(3) &
     &    + XS(4,I)*FA2K(4) + XS(5,I)*FA2K(5) + XS(6,I)*(GMST2K(1)+PI)
      ARG = DMOD(ARG,TWOPI)
!     ARG = DMOD(ARG,1296000.0D0) * CONVDS
!   First derivative
      dARG = XS(1,I)*FAD2K(1) + XS(2,I)*FAD2K(2) + XS(3,I)*FAD2K(3) &
     &     + XS(4,I)*FAD2K(4) + XS(5,I)*FAD2K(5) + XS(6,I)*(GMST2K(2))
!
!     Evaluate zonal tidal terms (micro-arcsec)
       Xt  = XS(8,I)*DSIN(ARG)  + XS(9,I)*DCOS(ARG)  + Xt
       Yt  = XS(10,I)*DSIN(ARG) + XS(11,I)*DCOS(ARG) + Yt
       dXt = XS(8,I)*DCOS(ARG)*dARG  - XS(9,I)*DSIN(ARG)*dARG  + dXt
       dYt = XS(10,I)*DCOS(ARG)*dARG - XS(11,I)*DSIN(ARG)*dARG + dYt
   10 CONTINUE
!
!  Change from micro-arsecs to milli-arcsecs
      Xt  =  Xt*1.0D-3
      Yt  =  Yt*1.0D-3
      dXt = dXt*1.0D-3
      dYt = dYt*1.0D-3
!
!       print *,' XYTID/GMST2K: ', GMST2K
!       print *,' XYTID/Xt,dXt: ', Xt,dXt
!       print *,' XYTID/Yt,dYt: ', Yt,dYt
!
      RETURN
      END
!
!**********************************************************************
      SUBROUTINE ORTHO_EOP (TMJD, Xt, Yt, UT1t, dXt, dYt, dUT1t )
      IMPLICIT None
!
!   Subroutines to compute the diurnal and semidiurnal variations
!   in the earth orientation from the version of Richard Ray's ocean
!   tide model that was listed in IERS Technical Note 21, July 1996.
!   This code includes the variations from 71 diurnal and semidiurnal
!   terms instead of the 8 that are listed in the report.
!
!...Purpose: to compute the diurnal and semidiurnal variations
!            in EOP (x,y,UT1) from ocean tides
!
!...Coded by: Richard Eanes, UT/CSR, Feb 1997
!             2004: D. Gordon, Modified for Calc 10 usage.
!
!...Input: time = Modified Julian Date
!
!...Output: eop = (delta_x, delta_y, delta_UT1)
!                 microarcsec for x and y, microsec for UT1
!
      REAL*8 TMJD, Xt, Yt, UT1t, dXt, dYt, dUT1t
      REAL*8 TIME, eop(3), orthow(12,3), H(12)
      REAL*8 d_H(12), d_eop(3)
      INTEGER*4 K, J
!
!...Diurnal and semidiurnal orthoweights fit to the 8 constituents
!   listed in IERS Technical Note 21, July 1996 which are from the
!   paper "Diurnal and Semidiurnal Variations in the Earth's Rotation
!   Rate Induced by Ocean Tides" by Ray, R.D., Steinberg, D.J.,
!   Chao, B.F., and Cartwright, D.E., Science, 264, pp. 830-832.
!
      Data Orthow / &
     & -6.77832,-14.86323,  0.47884, -1.45303,  0.16406,  0.42030, &
     &  0.09398, 25.73054, -4.77974,  0.28080,  1.94539, -0.73089, &
     & 14.86283, -6.77846,  1.45234,  0.47888, -0.42056,  0.16469, &
     & 15.30276, -4.30615,  0.07564,  2.28321, -0.45717, -1.62010, &
     & -1.76335,  1.03364, -0.27553,  0.34569, -0.12343, -0.10146, &
     & -0.47119,  1.28997, -0.19336,  0.02724,  0.08955,  0.04726/
!
! Initialize:
        Xt    = 0.0D0
        Yt    = 0.0D0
        UT1t  = 0.0D0
        dXt   = 0.0D0
        dYt   = 0.0D0
        dUT1t = 0.0D0
!
!...compute the partials of the tidal variations to the orthoweights
       time = TMJD
      Call CNMTX (Time, H)
!     Call CNMTX (TIME, H, d_H)
!       print *, 'Ortho_eop/H: ', H
!
!...compute eop changes
      do k=1,3
         eop(k) = 0.
!        d_eop(k) = 0.
         do j=1,12
            eop(k) = eop(k) + h(j)*orthow(j,k)
!           d_eop(k) = d_eop(k) + d_h(j)*orthow(j,k)
         enddo
      enddo
!   Change X and Y to milli-arcsec and UT1 to milli-sec
         Xt   = eop(1)*1.D-3
         Yt   = eop(2)*1.D-3
         UT1t = eop(3)*1.D-3
!        dXt   = d_eop(1)*1.D-3
!        dYt   = d_eop(2)*1.D-3
!        dUT1t = d_eop(3)*1.D-3
!
!        print *, ' ORTHO_EOP/Time: ', Time
!        print *, ' ORTHO_EOP/Xt,Yt,UT1t: ', Xt,Yt,UT1t
!        print *, ' ORTHO_EOP/dXt,dYt,dUT1t: ', dXt,dYt,dUT1t
!
      return
      end
!
!**********************************************************************
      SUBROUTINE CNMTX (DMJD, H)
      IMPLICIT None
!
!...Purpose: To compute the time dependent part of the second degree
!            diurnal and semidiurnal tidal potential from the dominant
!            spectral lines in the Cartwright-Tayler-Edden harmonic
!            decomposition.
!
!...Coded by: Richard Eanes, UT/CSR, Feb 1997
!             2004: D. Gordon, Modified for Calc 10 usage.
!
!...Input: DMJD = Modified Julian Date
!
!...Output: H = vector of length 12 with partials of the tidal
!           variation with respect to the orthoweights.
!
      Real*8    DMJD, H(12)
      Real*8    hs(71), phase(71), freq(71), twopi, dt, dt60, d1960, &
     &          pinm, alpha, ap, am, bp, bm, sp(6,2)
      Real*8    anm(2:3,0:3,-1:1), bnm(2:3,0:3,-1:1)
      Real*8    p(0:2,2), q(0:2,2)
      INTEGER*4 NLINES, i, j, k, m, n, nj(71), mj(71), nmax
      Character*7 Numarg(71), ndum
!
!...The orthotide weight factors
      Data ((sp(i,m),i=1,6),m=1,2) / &
     & 0.0298,  0.1408, +0.0805,  0.6002, +0.3025,  0.1517, &
     & 0.0200,  0.0905, +0.0638,  0.3476, +0.1645,  0.0923/
!
      Data twopi /6.2831853071796D0/
      Data dt / 2.D0 /
      Data nmax /2/
      Data nlines /71/
!
!...Tidal potential model for 71 diurnal and semidiurnal lines
!
      Data d1960/37076.5/
      data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=1,15) &
     &/2, 1,  -1.94,  9.0899831,  5.18688050, '117.655', &
     & 2, 1,  -1.25,  8.8234208,  5.38346657, '125.745', &
     & 2, 1,  -6.64, 12.1189598,  5.38439079, '125.755', &
     & 2, 1,  -1.51,  1.4425700,  5.41398343, '127.545', &
     & 2, 1,  -8.02,  4.7381090,  5.41490765, '127.555', &
     & 2, 1,  -9.47,  4.4715466,  5.61149372, '135.645', &
     & 2, 1, -50.20,  7.7670857,  5.61241794, '135.655', &
     & 2, 1,  -1.80, -2.9093042,  5.64201057, '137.445', &
     & 2, 1,  -9.54,  0.3862349,  5.64293479, '137.455', &
     & 2, 1,   1.52, -3.1758666,  5.83859664, '145.535', &
     & 2, 1, -49.45,  0.1196725,  5.83952086, '145.545', &
     & 2, 1,-262.21,  3.4152116,  5.84044508, '145.555', &
     & 2, 1,   1.70, 12.8946194,  5.84433381, '145.755', &
     & 2, 1,   3.43,  5.5137686,  5.87485066, '147.555', &
     & 2, 1,   1.94,  6.4441883,  6.03795537, '153.655'/
      Data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=16,30) &
     &/2, 1,   1.37, -4.2322016,  6.06754801, '155.445', &
     & 2, 1,   7.41, -0.9366625,  6.06847223, '155.455', &
     & 2, 1,  20.62,  8.5427453,  6.07236095, '155.655', &
     & 2, 1,   4.14, 11.8382843,  6.07328517, '155.665', &
     & 2, 1,   3.94,  1.1618945,  6.10287781, '157.455', &
     & 2, 1,  -7.14,  5.9693878,  6.24878055, '162.556', &
     & 2, 1,   1.37, -1.2032249,  6.26505830, '163.545', &
     & 2, 1,-122.03,  2.0923141,  6.26598252, '163.555', &
     & 2, 1,   1.02, -1.7847596,  6.28318449, '164.554', &
     & 2, 1,   2.89,  8.0679449,  6.28318613, '164.556', &
     & 2, 1,  -7.30,  0.8953321,  6.29946388, '165.545', &
     & 2, 1, 368.78,  4.1908712,  6.30038810, '165.555', &
     & 2, 1,  50.01,  7.4864102,  6.30131232, '165.565', &
     & 2, 1,  -1.08, 10.7819493,  6.30223654, '165.575', &
     & 2, 1,   2.93,  0.3137975,  6.31759007, '166.554'/
      Data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=31,45) &
     &/2, 1,   5.25,  6.2894282,  6.33479368, '167.555', &
     & 2, 1,   3.95,  7.2198478,  6.49789839, '173.655', &
     & 2, 1,  20.62, -0.1610030,  6.52841524, '175.455', &
     & 2, 1,   4.09,  3.1345361,  6.52933946, '175.465', &
     & 2, 1,   3.42,  2.8679737,  6.72592553, '183.555', &
     & 2, 1,   1.69, -4.5128771,  6.75644239, '185.355', &
     & 2, 1,  11.29,  4.9665307,  6.76033111, '185.555', &
     & 2, 1,   7.23,  8.2620698,  6.76125533, '185.565', &
     & 2, 1,   1.51, 11.5576089,  6.76217955, '185.575', &
     & 2, 1,   2.16,  0.6146566,  6.98835826, '195.455', &
     & 2, 1,   1.38,  3.9101957,  6.98928248, '195.465', &
     & 2, 2,   1.80, 20.6617051, 11.45675174, '225.855', &
     & 2, 2,   4.67, 13.2808543, 11.48726860, '227.655', &
     & 2, 2,  16.01, 16.3098310, 11.68477889, '235.755', &
     & 2, 2,  19.32,  8.9289802, 11.71529575, '237.555'/
      Data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=46,60) &
     &/2, 2,   1.30,  5.0519065, 11.73249771, '238.554', &
     & 2, 2,  -1.02, 15.8350306, 11.89560406, '244.656', &
     & 2, 2,  -4.51,  8.6624178, 11.91188181, '245.645', &
     & 2, 2, 120.99, 11.9579569, 11.91280603, '245.655', &
     & 2, 2,   1.13,  8.0808832, 11.93000800, '246.654', &
     & 2, 2,  22.98,  4.5771061, 11.94332289, '247.455', &
     & 2, 2,   1.06,  0.7000324, 11.96052486, '248.454', &
     & 2, 2,  -1.90, 14.9869335, 12.11031632, '253.755', &
     & 2, 2,  -2.18, 11.4831564, 12.12363121, '254.556', &
     & 2, 2, -23.58,  4.3105437, 12.13990896, '255.545', &
     & 2, 2, 631.92,  7.6060827, 12.14083318, '255.555', &
     & 2, 2,   1.92,  3.7290090, 12.15803515, '256.554', &
     & 2, 2,  -4.66, 10.6350594, 12.33834347, '263.655', &
     & 2, 2, -17.86,  3.2542086, 12.36886033, '265.455', &
     & 2, 2,   4.47, 12.7336164, 12.37274905, '265.655'/
      Data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=61,71) &
     &/2, 2,   1.97, 16.0291555, 12.37367327, '265.665', &
     & 2, 2,  17.20, 10.1602590, 12.54916865, '272.556', &
     & 2, 2, 294.00,  6.2831853, 12.56637061, '273.555', &
     & 2, 2,  -2.46,  2.4061116, 12.58357258, '274.554', &
     & 2, 2,  -1.02,  5.0862033, 12.59985198, '275.545', &
     & 2, 2,  79.96,  8.3817423, 12.60077620, '275.555', &
     & 2, 2,  23.83, 11.6772814, 12.60170041, '275.565', &
     & 2, 2,   2.59, 14.9728205, 12.60262463, '275.575', &
     & 2, 2,   4.47,  4.0298682, 12.82880334, '285.455', &
     & 2, 2,   1.95,  7.3254073, 12.82972756, '285.465', &
     & 2, 2,   1.17,  9.1574019, 13.06071921, '295.555'/
!
!...Compute the time dependent potential matrix
!
      do n =  2,3
       do m =  0,3
        do k = -1,1
         anm(n,m,k)   = 0.
         bnm(n,m,k)   = 0.
        enddo
       enddo
      enddo
!
      do k=-1,1
         dt60 = (dmjd - k*dt) - d1960
!        anm(2,1:2,k) = 0.
!        bnm(2,1:2,k) = 0.
         do j=1,nlines
            n = nj(j)
            m = mj(j)
            pinm = mod(n+m,2)*twopi/4.D0
            alpha = phase(j) + freq(j)*dt60 - pinm
            alpha = mod(alpha,twopi)
            anm(n,m,k) = anm(n,m,k) + hs(j)*cos(alpha)
            bnm(n,m,k) = bnm(n,m,k) - hs(j)*sin(alpha)
         enddo
      enddo
!
!...Orthogonalize the response terms
!
      do m = 1,2
        ap = anm(2,m,1) + anm(2,m,-1)
        am = anm(2,m,1) - anm(2,m,-1)
        bp = bnm(2,m,1) + bnm(2,m,-1)
        bm = bnm(2,m,1) - bnm(2,m,-1)
        p(0,m) = sp(1,m)*anm(2,m,0)
        p(1,m) = sp(2,m)*anm(2,m,0) - sp(3,m)*ap
        p(2,m) = sp(4,m)*anm(2,m,0) - sp(5,m)*ap + sp(6,m)*bm
        q(0,m) = sp(1,m)*bnm(2,m,0)
        q(1,m) = sp(2,m)*bnm(2,m,0) - sp(3,m)*bp
        q(2,m) = sp(4,m)*bnm(2,m,0) - sp(5,m)*bp - sp(6,m)*am
        anm(2,m,-1) = p(0,m)
        anm(2,m, 0) = p(1,m)
        anm(2,m, 1) = p(2,m)
        bnm(2,m,-1) = q(0,m)
        bnm(2,m, 0) = q(1,m)
        bnm(2,m, 1) = q(2,m)
      enddo
!
!...Fill partials vector
      j = 1
      do n=2,nmax
         do m = 1,n
            do k = -1,1
               h(j)   = anm(n,m,k)
               h(j+1) = bnm(n,m,k)
               j = j + 2
             enddo
         enddo
      enddo
!
      return
      end
!
!**********************************************************************
      SUBROUTINE CNMTXzz (DMJD, H, d_H)
      IMPLICIT None
!
!...Purpose: To compute the time dependent part of the second degree
!            diurnal and semidiurnal tidal potential from the dominant
!            spectral lines in the Cartwright-Tayler-Edden harmonic
!            decomposition
!
!...Coded by: Richard Eanes, UT/CSR, Feb 1997
!             2004: D. Gordon, Modified for Calc 10 usage.
!
!...Input: dmjd = modified julian date
!
!...Output: h = vector of length 12 with partials of the tidal
!           variation with respect to the orthoweights
!
      Real*8    DMJD, H(12), d_H(12)
      INTEGER*4 NLINES, i, j, k, m, n, nj(71), mj(71), nmax
!     Parameter (nlines=71)
      Character*7 numarg(71)
      Real*8                                            dt60
      Real*8    hs(71), phase(71), freq(71), twopi, dt,       d1960, &
     &          pinm, alpha, ap, am, bp, bm, sp(6,2)
      Real*8    d_dt60, d_alpha, d_ap, d_am, d_bp, d_bm
      Real*8    anm(2:3,0:3,-1:1), bnm(2:3,0:3,-1:1)
      Real*8    p(0:2,2), q(0:2,2)
      Real*8    d_anm(2:3,0:3,-1:1), d_bnm(2:3,0:3,-1:1)
      Real*8    d_p(0:2,2), d_q(0:2,2)
!
!...The orthotide weight factors
      data ((sp(i,m),i=1,6),m=1,2) / &
     & 0.0298,  0.1408, +0.0805,  0.6002, +0.3025,  0.1517, &
     & 0.0200,  0.0905, +0.0638,  0.3476, +0.1645,  0.0923/
!
      data twopi /6.2831853071796/
      data dt / 2. /
      data nmax /2/
      data nlines /71/
!
!...Tidal potential model for 71 diurnal and semidiurnal lines
!
      data d1960/37076.5/
      data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=1,15) &
     &/2, 1,  -1.94, 9.0899831, 5.18688050, '117.655', &
     & 2, 1,  -1.25, 8.8234208, 5.38346657, '125.745', &
     & 2, 1,  -6.64,12.1189598, 5.38439079, '125.755', &
     & 2, 1,  -1.51, 1.4425700, 5.41398343, '127.545', &
     & 2, 1,  -8.02, 4.7381090, 5.41490765, '127.555', &
     & 2, 1,  -9.47, 4.4715466, 5.61149372, '135.645', &
     & 2, 1, -50.20, 7.7670857, 5.61241794, '135.655', &
     & 2, 1,  -1.80,-2.9093042, 5.64201057, '137.445', &
     & 2, 1,  -9.54, 0.3862349, 5.64293479, '137.455', &
     & 2, 1,   1.52,-3.1758666, 5.83859664, '145.535', &
     & 2, 1, -49.45, 0.1196725, 5.83952086, '145.545', &
     & 2, 1,-262.21, 3.4152116, 5.84044508, '145.555', &
     & 2, 1,   1.70,12.8946194, 5.84433381, '145.755', &
     & 2, 1,   3.43, 5.5137686, 5.87485066, '147.555', &
     & 2, 1,   1.94, 6.4441883, 6.03795537, '153.655'/
      data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=16,30) &
     &/2, 1,   1.37,-4.2322016, 6.06754801, '155.445', &
     & 2, 1,   7.41,-0.9366625, 6.06847223, '155.455', &
     & 2, 1,  20.62, 8.5427453, 6.07236095, '155.655', &
     & 2, 1,   4.14,11.8382843, 6.07328517, '155.665', &
     & 2, 1,   3.94, 1.1618945, 6.10287781, '157.455', &
     & 2, 1,  -7.14, 5.9693878, 6.24878055, '162.556', &
     & 2, 1,   1.37,-1.2032249, 6.26505830, '163.545', &
     & 2, 1,-122.03, 2.0923141, 6.26598252, '163.555', &
     & 2, 1,   1.02,-1.7847596, 6.28318449, '164.554', &
     & 2, 1,   2.89, 8.0679449, 6.28318613, '164.556', &
     & 2, 1,  -7.30, 0.8953321, 6.29946388, '165.545', &
     & 2, 1, 368.78, 4.1908712, 6.30038810, '165.555', &
     & 2, 1,  50.01, 7.4864102, 6.30131232, '165.565', &
     & 2, 1,  -1.08,10.7819493, 6.30223654, '165.575', &
     & 2, 1,   2.93, 0.3137975, 6.31759007, '166.554'/
      data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=31,45) &
     &/2, 1,   5.25, 6.2894282, 6.33479368, '167.555', &
     & 2, 1,   3.95, 7.2198478, 6.49789839, '173.655', &
     & 2, 1,  20.62,-0.1610030, 6.52841524, '175.455', &
     & 2, 1,   4.09, 3.1345361, 6.52933946, '175.465', &
     & 2, 1,   3.42, 2.8679737, 6.72592553, '183.555', &
     & 2, 1,   1.69,-4.5128771, 6.75644239, '185.355', &
     & 2, 1,  11.29, 4.9665307, 6.76033111, '185.555', &
     & 2, 1,   7.23, 8.2620698, 6.76125533, '185.565', &
     & 2, 1,   1.51,11.5576089, 6.76217955, '185.575', &
     & 2, 1,   2.16, 0.6146566, 6.98835826, '195.455', &
     & 2, 1,   1.38, 3.9101957, 6.98928248, '195.465', &
     & 2, 2,   1.80,20.6617051,11.45675174, '225.855', &
     & 2, 2,   4.67,13.2808543,11.48726860, '227.655', &
     & 2, 2,  16.01,16.3098310,11.68477889, '235.755', &
     & 2, 2,  19.32, 8.9289802,11.71529575, '237.555'/
      data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=46,60) &
     &/2, 2,   1.30, 5.0519065,11.73249771, '238.554', &
     & 2, 2,  -1.02,15.8350306,11.89560406, '244.656', &
     & 2, 2,  -4.51, 8.6624178,11.91188181, '245.645', &
     & 2, 2, 120.99,11.9579569,11.91280603, '245.655', &
     & 2, 2,   1.13, 8.0808832,11.93000800, '246.654', &
     & 2, 2,  22.98, 4.5771061,11.94332289, '247.455', &
     & 2, 2,   1.06, 0.7000324,11.96052486, '248.454', &
     & 2, 2,  -1.90,14.9869335,12.11031632, '253.755', &
     & 2, 2,  -2.18,11.4831564,12.12363121, '254.556', &
     & 2, 2, -23.58, 4.3105437,12.13990896, '255.545', &
     & 2, 2, 631.92, 7.6060827,12.14083318, '255.555', &
     & 2, 2,   1.92, 3.7290090,12.15803515, '256.554', &
     & 2, 2,  -4.66,10.6350594,12.33834347, '263.655', &
     & 2, 2, -17.86, 3.2542086,12.36886033, '265.455', &
     & 2, 2,   4.47,12.7336164,12.37274905, '265.655'/
      data (nj(j),mj(j),hs(j),phase(j),freq(j),numarg(j),j=61,71) &
     &/2, 2,   1.97,16.0291555,12.37367327, '265.665', &
     & 2, 2,  17.20,10.1602590,12.54916865, '272.556', &
     & 2, 2, 294.00, 6.2831853,12.56637061, '273.555', &
     & 2, 2,  -2.46, 2.4061116,12.58357258, '274.554', &
     & 2, 2,  -1.02, 5.0862033,12.59985198, '275.545', &
     & 2, 2,  79.96, 8.3817423,12.60077620, '275.555', &
     & 2, 2,  23.83,11.6772814,12.60170041, '275.565', &
     & 2, 2,   2.59,14.9728205,12.60262463, '275.575', &
     & 2, 2,   4.47, 4.0298682,12.82880334, '285.455', &
     & 2, 2,   1.95, 7.3254073,12.82972756, '285.465', &
     & 2, 2,   1.17, 9.1574019,13.06071921, '295.555'/
!
!...Compute the time dependent potential matrix
!
         d_dt60 = 1./86400.
!
      do n =  2,3
       do m =  0,3
        do k = -1,1
         anm(n,m,k)   = 0.
         bnm(n,m,k)   = 0.
         d_anm(n,m,k) = 0.
         d_bnm(n,m,k) = 0.
        enddo
       enddo
      enddo
!
      do k=-1,1
         dt60 = (dmjd - k*dt) - d1960
!          write(6,1011)  dt60,d_dt60
!1011      format(' dt60,d_dt60 ', F20.10,F20.15)
!        anm(2,1:2,k) = 0.
!        bnm(2,1:2,k) = 0.
!        d_anm(2,1:2,k) = 0.
!        d_bnm(2,1:2,k) = 0.
         do j=1,nlines
            n = nj(j)
            m = mj(j)
            pinm = mod(n+m,2)*twopi/4.
            alpha = phase(j) + freq(j)*dt60 - pinm
            alpha = mod(alpha,twopi)
            d_alpha = freq(j)*d_dt60
!          if(j.le.2)  print *,'j,alpha,d_alpha ', j,alpha,d_alpha
            anm(n,m,k) = anm(n,m,k) + hs(j)*cos(alpha)
            bnm(n,m,k) = bnm(n,m,k) - hs(j)*sin(alpha)
            d_anm(n,m,k) = d_anm(n,m,k) - hs(j)*sin(alpha)*d_alpha
            d_bnm(n,m,k) = d_bnm(n,m,k) - hs(j)*cos(alpha)*d_alpha
         enddo
      enddo
!          print *,'anm   ', anm
!          print *,'d_anm ', d_anm
!          print *,'bnm   ', bnm
!          print *,'d_bnm ',d_bnm
!
!...Orthogonalize the response terms
!
      do m = 1,2
        ap = anm(2,m,1) + anm(2,m,-1)
        am = anm(2,m,1) - anm(2,m,-1)
        bp = bnm(2,m,1) + bnm(2,m,-1)
        bm = bnm(2,m,1) - bnm(2,m,-1)
        p(0,m) = sp(1,m)*anm(2,m,0)
        p(1,m) = sp(2,m)*anm(2,m,0) - sp(3,m)*ap
        p(2,m) = sp(4,m)*anm(2,m,0) - sp(5,m)*ap + sp(6,m)*bm
        q(0,m) = sp(1,m)*bnm(2,m,0)
        q(1,m) = sp(2,m)*bnm(2,m,0) - sp(3,m)*bp
        q(2,m) = sp(4,m)*bnm(2,m,0) - sp(5,m)*bp - sp(6,m)*am
        anm(2,m,-1) = p(0,m)
        anm(2,m, 0) = p(1,m)
        anm(2,m, 1) = p(2,m)
        bnm(2,m,-1) = q(0,m)
        bnm(2,m, 0) = q(1,m)
        bnm(2,m, 1) = q(2,m)
!
        d_ap = d_anm(2,m,1) + d_anm(2,m,-1)
        d_am = d_anm(2,m,1) - d_anm(2,m,-1)
        d_bp = d_bnm(2,m,1) + d_bnm(2,m,-1)
        d_bm = d_bnm(2,m,1) - d_bnm(2,m,-1)
        d_p(0,m) = sp(1,m)*d_anm(2,m,0)
        d_p(1,m) = sp(2,m)*d_anm(2,m,0) - sp(3,m)*d_ap
        d_p(2,m) = sp(4,m)*d_anm(2,m,0) - sp(5,m)*d_ap + sp(6,m)*d_bm
        d_q(0,m) = sp(1,m)*d_bnm(2,m,0)
        d_q(1,m) = sp(2,m)*d_bnm(2,m,0) - sp(3,m)*d_bp
        d_q(2,m) = sp(4,m)*d_bnm(2,m,0) - sp(5,m)*d_bp - sp(6,m)*d_am
        d_anm(2,m,-1) = d_p(0,m)
        d_anm(2,m, 0) = d_p(1,m)
        d_anm(2,m, 1) = d_p(2,m)
        d_bnm(2,m,-1) = d_q(0,m)
        d_bnm(2,m, 0) = d_q(1,m)
        d_bnm(2,m, 1) = d_q(2,m)
!
!        print *,'m ', m
!        print *,'ap,d_ap ', ap,d_ap
!        print *,'am,d_am ', am,d_am
!        print *,'bp,d_bp ', bp,d_bp
!        print *,'bm,d_bm ', bm,d_bm
!        print *,'p(0,m),d_p(0,m)', p(0,m),d_p(0,m)
!        print *,'p(1,m),d_p(1,m)', p(1,m),d_p(1,m)
!        print *,'p(2,m),d_p(2,m)', p(2,m),d_p(2,m)
!        print *,'q(0,m),d_q(0,m)', q(0,m),d_q(0,m)
!        print *,'q(1,m),d_q(1,m)', q(1,m),d_q(1,m)
!        print *,'q(2,m),d_q(2,m)', q(2,m),d_q(2,m)
!        print *,'anm(2,m,-1),d_anm(2,m,-1) ', anm(2,m,-1),d_anm(2,m,-1)
!        print *,'anm(2,m,0),d_anm(2,m,0) ', anm(2,m,0), d_anm(2,m,0)
!        print *,'anm(2,m,1),d_anm(2,m,1) ', anm(2,m,1), d_anm(2,m,1)
!        print *,'bnm(2,m,-1),d_bnm(2,m,-1) ', bnm(2,m,-1),d_bnm(2,m,-1)
!        print *,'bnm(2,m,0),d_bnm(2,m,0) ', bnm(2,m,0), d_bnm(2,m,0)
!        print *,'bnm(2,m,1),d_bnm(2,m,1) ', bnm(2,m,1), d_bnm(2,m,1)
!
      enddo
!
!...Fill partials vector
      j = 1
      do n=2,nmax
         do m = 1,n
            do k = -1,1
               h(j)   = anm(n,m,k)
               h(j+1) = bnm(n,m,k)
               d_h(j)   = d_anm(n,m,k)
               d_h(j+1) = d_bnm(n,m,k)
               j = j + 2
             enddo
         enddo
      enddo
!        print *,'h   ', h
!        print *,'d_h ', d_h
!
      return
      end
      SUBROUTINE UVG_un (STAR, EPBASE )
      IMPLICIT None
!
!       UVG computes the (U,V) coordinates of the baseline.
!       'UNCORRECTED' version.
!
!      CALLING SEQUENCE -
!        INPUT VARIABLES:
!          1. STAR(3)     - The J2000.0 Source unit vector.
!          2. EPBASE(3,2) - The J2000.0 Geocentric baseline position and
!                           velocity vectors. (m, m/sec)
!
!   COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!        VARIABLES 'FROM':
!          1. KASTC - The Dave Shaffer switch to turn on the computation
!                     of (U,V) coordinates. (Logic reversed 2001.01.12)
!                      = 0 ==> Switched ON. (default)
!                      = 1 ==> Switched OFF
!
      INCLUDE 'cphys11.i'
!        VARIABLES 'FROM':
!          1. VLIGHT - The velocity of light in a vacuum (m/sec).
!
      INCLUDE 'cuser11.i'
!        VARIABLES 'FROM'
!          1. Calc_user - 'A' for analysis centers, 'C' for correlators.
!
      INCLUDE 'get2s.i'
!       Variables from:
!          1. REF_FREQ - For databases, should be the correct reference
!                        frequency. For correlator usage, set to 1.0 MHz,
!                        should be multiplied later by the correct
!                        frequency or frequencies.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. U_V(2) - Baseline coordinates in the (U,V) plane, in
!                      units of fringes per arcsec. [Multiply by
!                      206264.81 to get the more conventional values.]
!                      Scaled by the value of REF_FREQ. 
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!        VARIABLES 'FROM':
!          1. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                      (RAD/ARCSECOND)
!
      Real*8 STAR(3), EPBASE(3,2)
      Real*8 DOTP, B(3), NCP(3), vectr(3), Bpr(3), NCPpr(3), W,         &
     &       VECMG
!     Integer*2 KERR, NDO(3)
!
!        Program variables:
!          1. U_V(2) -   Baseline coordinates in the (U,V) plane, in
!                        units of fringes per arcsec. [Multiply by
!                        206264.81 to get the more conventional values.]
!                        Scaled by the value of REF_FREQ.
!          2. REF_FREQ - For databases, should be the correct reference
!                        frequency. For correlator usage, set to 1.0 MHz,
!                        should be multiplied later by the correct
!                        frequency or frequencies.
!
!       PROGRAMMER:
!             David Gordon 1998.11.17 Subroutine created
!             David Gordon 2001.01.12 Logic reversed, default is to
!                          compute and add U/V coordinates, since the
!                          Mark IV correlators are not computing them.
!                          New access code ('UVF/MHz ', U/V coordinates in
!                          fringes per arcsec per MHz) added for Mark IV
!                          correlator usage.
!             Jim Ryan Sept 2002 Integer*2/4 mods.
!             David Gordon Dec. 2012 Moved GET's to GET_G and PUT's to
!                          PUT_G.
!
!       UVG PROGRAM STRUCTURE
!
      IF (KASTC .ne. 0) Go to 800
!
!  Set frequency to 1 MHz for correlators.
      If (Calc_user .eq. 'C')  REF_FREQ = 1.D6
      If (C_mode .eq. 'difx  ') REF_FREQ = 1.D6
!
!   Baseline vector
       B(1) = EPBASE(1,1) * REF_FREQ/VLIGHT*CONVDS
       B(2) = EPBASE(2,1) * REF_FREQ/VLIGHT*CONVDS
       B(3) = EPBASE(3,1) * REF_FREQ/VLIGHT*CONVDS
!
      If (C_mode .eq. 'difx  ') Then
       B(1) = EPBASE(1,1) 
       B(2) = EPBASE(2,1)
       B(3) = EPBASE(3,1)
      Endif
!
!   NCP unit vector
       NCP(1) = 0.D0
       NCP(2) = 0.D0
       NCP(3) = 1.D0
!
! Get component of baseline vector projected into the plane
!   perpendicular to the STAR vector:
        CALL CROSP (STAR,      B, vectr)
        CALL CROSP (vectr,  STAR,   Bpr)
! Get component of NCP vector projected into the plane perpendicular
!   to the STAR vector:
        CALL CROSP (STAR,   NCP, vectr)
        CALL CROSP (vectr, STAR, NCPpr)
! Convert to a unit vector
        CALL VUNIT (NCPpr, NCP)
!
        U_V(2) = DOTP (Bpr, NCP)
        CALL CROSP (Bpr, NCP, vectr)
        U_V(1) = VECMG (vectr)
         If (DOTP (STAR,vectr) .lt. 0.d0) U_V(1) = -U_V(1)
! Add third component
        W = DOTP(B, STAR)
        Wb = W
!
!      Write (6,*) 'UVG:STAR: U,V,W  ', U_V, W
!
!     Normal conclusion.
  800 CONTINUE
      RETURN
      END
!
!***********************************************************************
!
      SUBROUTINE UVG_ab (STAR_ab, EPBASE )
      IMPLICIT None
!
!       UVG computes the (U,V) coordinates of the baseline, using
!        the aberrated source unit vector.
!       'APPROXIMATE' version:
!
!      CALLING SEQUENCE -
!        INPUT VARIABLES:
!          1. STAR_ab(3,2) - The J2000.0 aberrated source unit vector.
!          2. EPBASE(3,2)  - The J2000.0 Geocentric baseline position and
!                            velocity vectors. (m, m/sec)
!
!   COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!        VARIABLES 'FROM':
!          1. KASTC - The Dave Shaffer switch to turn on the computation
!                     of (U,V) coordinates. (Logic reversed 2001.01.12)
!                      = 0 ==> Switched ON. (default)
!                      = 1 ==> Switched OFF
!
      INCLUDE 'cphys11.i'
!        VARIABLES 'FROM':
!          1. VLIGHT - The velocity of light in a vacuum (m/sec).
!
      INCLUDE 'cuser11.i'
!        VARIABLES 'FROM'
!          1. Calc_user - 'A' for analysis centers, 'C' for correlators.
!
      INCLUDE 'get2s.i'
!       Variables from:
!          1. REF_FREQ - For databases, should be the correct reference
!                        frequency. For correlator usage, set to 1.0 MHz,
!                        should be multiplied later by the correct
!                        frequency or frequencies.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. U_V(2) - Baseline coordinates in the (U,V) plane, in
!                      units of fringes per arcsec. [Multiply by
!                      206264.81 to get the more conventional values.]
!                      Scaled by the value of REF_FREQ. 
!
      Real*8         PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
      COMMON /CMATH/ PI,TWOPI,HALFPI,CONVD,CONVDS,CONVHS,SECDAY
!        VARIABLES 'FROM':
!          1. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                      (RAD/ARCSECOND)
!
      Real*8 STAR_ab(3,2), EPBASE(3,2)
      Real*8 DOTP, B(3), NCP(3), vectr(3), Bpr(3), NCPpr(3), W,         &
     &       VECMG, Starxx(3), Starab(3)
!     Integer*2 KERR, NDO(3)
!
!        Program variables:
!          1. U_V(2) -   Baseline coordinates in the (U,V) plane, in
!                        units of fringes per arcsec. [Multiply by
!                        206264.81 to get the more conventional values.]
!                        Scaled by the value of REF_FREQ.
!          2. REF_FREQ - For databases, should be the correct reference
!                        frequency. For correlator usage, set to 1.0 MHz,
!                        should be multiplied later by the correct
!                        frequency or frequencies.
!
!       PROGRAMMER:
!             David Gordon 1998.11.17 Subroutine created
!             David Gordon 2001.01.12 Logic reversed, default is to
!                          compute and add U/V coordinates, since the
!                          Mark IV correlators are not computing them.
!                          New access code ('UVF/MHz ', U/V coordinates in
!                          fringes per arcsec per MHz) added for Mark IV
!                          correlator usage.
!             Jim Ryan Sept 2002 Integer*2/4 mods.
!             David Gordon Dec. 2012 Moved GET's to GET_G and PUT's to
!                          PUT_G.
!
!       UVG PROGRAM STRUCTURE
!
!     IF (KASTC .ne. 0) Go to 800
!
!  Set frequency to 1 MHz for correlators.
      If (Calc_user .eq. 'C') REF_FREQ = 1.D6
      If (C_mode .eq. 'difx  ') REF_FREQ = 1.D6
!
! Take average of the two abberrated star vectors and renormalize
      Call VECAD(Star_ab(1,1), Star_ab(1,2), Starxx)
      Call Vunit(Starxx,Starab)
!
!   Baseline vector
       B(1) = EPBASE(1,1) * REF_FREQ/VLIGHT*CONVDS
       B(2) = EPBASE(2,1) * REF_FREQ/VLIGHT*CONVDS
       B(3) = EPBASE(3,1) * REF_FREQ/VLIGHT*CONVDS
!
      If (C_mode .eq. 'difx  ') Then
       B(1) = EPBASE(1,1) 
       B(2) = EPBASE(2,1)
       B(3) = EPBASE(3,1)
      Endif
!
!   NCP unit vector
       NCP(1) = 0.D0
       NCP(2) = 0.D0
       NCP(3) = 1.D0
!
! Get component of baseline vector projected into the plane
!   perpendicular to the STAR vector:
        CALL CROSP (STARab,      B, vectr)
        CALL CROSP (vectr,  STARab,   Bpr)
! Get component of NCP vector projected into the plane perpendicular
!   to the STAR vector:
        CALL CROSP (STARab,   NCP, vectr)
        CALL CROSP (vectr, STARab, NCPpr)
! Convert to a unit vector
        CALL VUNIT (NCPpr, NCP)
!
        U_V(2) = DOTP (Bpr, NCP)
        CALL CROSP (Bpr, NCP, vectr)
        U_V(1) = VECMG (vectr)
         If (DOTP (STARab,vectr) .lt. 0.d0) U_V(1) = -U_V(1)
! Add third component
        W = DOTP(B, STARab)
        Wb = W
!
!      Write (6,*) 'UVG:STARab: U,V,W  ', U_V, W
!
!     Normal conclusion.
  800 CONTINUE
      RETURN
      END
!
!**********************************************************************
      SUBROUTINE UVG_plus (EPBASE,STAR,STAR_plus,EARTH,SITEV)
      IMPLICIT None
!
! 5.1.1 UVG_plus: Modified version STRP, the partial derivative the delay
!       w.r.t. the STAR coordinates. It computes the partial derivatives
!       of the delay and rate with respect to the source declination and 
!       right ascension and converts them to the U and V analytic 
!       baseline vectors, in meters. Input source vector can be either
!       the source unit vector, the aberrated source unit vector, or  the
!       aberrated/refracted source unit vector.
!       For 'EXACT' version - use STAR_plus = aberrated/refracted source.
!       For 'NO ATMOS' version - use STAR_plus = aberrated source.
!
! 5.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. EPBASE(3,2) - THE J2000.0 GEOCENTRIC BASELINE VECTOR
!                              AND ITS CT TIME DERIVATIVE. (M, M/SEC)
!             2. STAR(3)     - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!             3. EARTH(3,3)  - The ssbc position, velocity, and acceleration
!                               of the Earth. (m, m/s, m/s**2)
!           OUTPUT VARIABLES:
!             1. CDX -  THE COSINE OF THE DECLINATION OF THE SOURCE
!             2. CRAX - THE COSINE OF THE RIGHT ASCENSION OF THE SOURCE
!             3. SDX -  THE SINE OF THE DECLINATION OF THE SOURCE
!             4. SRAX - THE SINE OF THE RIGHT ASCENSION OF THE SOURCE
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!           VARIABLES 'FROM':
!             1. VLIGHT  - THE VELOCITY OF LIGHT IN VACUUM.  (M/SEC)
!             2. VLIGHT2 - THE VELOCITY OF LIGHT IN VACUUM SQUARED.
!                          (M**2/SEC**2)
!
      INCLUDE 'cmxsr11.i'
!           VARIABLES 'FROM':
!             1. CD  - THE COSINE OF THE DECLINATION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!             2. CRA - THE COSINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!             3. SD  - THE SINE OF THE DECLINATION OF THE STAR BEING USED
!                      IN THE CURRENT OBSERVATION.
!             4. SRA - THE SINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1.  KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!             2.  KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. U_V(2) - Baseline coordinates in the (U,V) plane, in
!                      meters.
!
!
      Real*8 PR_RA, PR_DEC
      Common /Pmotn/ PR_RA, PR_DEC
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
       Real*8 DDEC(3), DRA(3),             EPBASE(3,2), STAR(3), CDX,   &
     &        CRAX, SDX, SRAX, EARTH(3,3), SITEV(3,2), c1, c2, tt,      &
     &        vg(3), bp(3), bv(3),  DOTP, XSTRP(2,2), STAR_plus(3)
       Integer*4 I
!
! 5.2.4 DATA BASE ACCESS - Moved to subroutine PUT_P ('STR PART').
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVP
!             CALLED SUBROUTINES: 
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES -
!             1. DDEC(3) - THE PARTIAL DERIVATIVE OF THE J2000.0 SOURCE UNIT
!                          VECTOR WITH RESPECT TO SOURCE DECLINATION. (1/RAD)
!             2. DRA(3)  - THE PARTIAL DERIVATIVE OF THE J2000.0 SOURCE UNIT
!                          VECTOR WITH RESPECT TO THE SOURCE RIGHT ASCENSION.
!                          (1/RAD)
!             3. c1, c2, tt, vg(3), b(3) -  Dummy variables used in computation
!                          of the partials.
!
! 5.2.9 PROGRAMMER - 77.01.13 Dale Markham
!                    77.07.14 Peter Denatale
!                    88.11.10 Bruce Schupler
!                    88.01.07 Jim Ryan
!                    89.07.09 Jim Ryan Documentation simplied.
!                    89.10.05 Jim Ryan CPHYS common made an include file
!                    89.12.12 Jim Ryan UNIX-like database interface
!                             implimented.
!                    01:11:25 Jim Ryan Term 2 of Shapiro's model added
!                             to the partials.
!                    David Gordon 94.04.15 Converted to Implicit None
!                    David Gordon 95.05.02 DSTRP passed back to DRIVR for use
!                             in PLXP.
!                    B. Archinal  95.11.13 Max # sources set in cmxsr.i.
!                    David Gordon 98.09.08 Changed partials computation to
!                             use CONSENSUS model (Step 10B). Makes no
!                             significant difference.
!                    David Gordon 2000.05.15 Bug correction, variable c1
!                             redefined (had been commented out).
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    David Gordon Jan. 2013  PUT moved to subroutine PUT_P.
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!                                             !!!!!!!!!!!!!!!
!!!!!!!!!!!!!!           NOT FOR NEAR-FIELD USE            !!!!!!!!!!!!!!! 
!!!!!!!!!!!!!!                                             !!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     STRP Program Structure
!
!  Get cosines and sines of RA and declnation.
       SDX  = STAR_plus(3)       ! sine of declination
       CDX  = DCOS(DASIN(SDX))   ! cosine of declination
       SRAX = STAR_plus(2)/CDX   ! sine of RA
       CRAX = STAR_plus(1)/CDX   ! cosine of RA
!
!  Compute the partial derivatives of the J2000.0 source unit vector with
!   respect to the source declination and with respect to the source R.A.
      DDEC(1) = - SDX * CRAX
      DDEC(2) = - SDX * SRAX
      DDEC(3) = + CDX
!
      DRA(1) = - CDX * SRAX
      DRA(2) = + CDX * CRAX
      DRA(3) = 0.D0
!
!   Complete the calculation of the partial derivatives.
      Do I=1,3
        vg(I) =  EARTH(I,2) + SITEV(I,2)
        bp(I) = -EPBASE(I,1)
        bv(I) = -EPBASE(I,2)
      Enddo
      c1 = 1.d0/VLIGHT
      tt = 1.d0 + c1*Dotp(STAR,vg)
!   Changed to Consensus model formula
      XSTRP(1,1) = -Dotp(bp,DRA )/(Vlight*tt) +                         &
     &              Dotp(STAR,bp)*Dotp(vg,DRA)/Vlight2
      U_V(1) = XSTRP(1,1)*VLIGHT/CDX
!
!!    XSTRP(1,2) = -Dotp(bv,DRA )/(Vlight*tt) +                         &
!!   &              Dotp(STAR,bv)*Dotp(vg,DRA)/Vlight2
!
      XSTRP(2,1) = -Dotp(bp,DDEC)/(Vlight*tt) +                         &
     &              Dotp(STAR,bp)*Dotp(vg,DDEC)/Vlight2
      U_V(2) = XSTRP(2,1)*VLIGHT
!
!!    XSTRP(2,2) = -Dotp(bv,DDEC)/(Vlight*tt) +                         &
!!   &              Dotp(STAR,bv)*Dotp(vg,DDEC)/Vlight2
!     WRITE(6,'(" New DSTRP: ",4D22.14)') DSTRP
!
!     write(6,*) 'UVG_no: ', XSTRP(1,1), XSTRP(2,1)
!
!   Copy some values from STRCM into dummy variables for use elsewhere
!     CDX = CD
!     CRAX = CRA
!     SDX = SD
!     SRAX = SRA
!
!   Check KSTRD for debug output.
      IF ( KSTRD .EQ. 0 )  GO TO 600
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine STRP." )
      WRITE(6,8)' CD     ',CD
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CRA    ',CRA
      WRITE(6,8)' DDEC   ',DDEC
      WRITE(6,8)' DRA    ',DRA
      WRITE(6,8)' DSTRP  ',DSTRP
      WRITE(6,8)' SD     ',SD
      WRITE(6,8)' SRA    ',SRA
      WRITE(6,8)' VLIGHT ',VLIGHT
      WRITE(6,8)' c1     ',c1
      WRITE(6,8)' c2     ',c2
      WRITE(6,8)' tt     ',tt
      WRITE(6,8)' vg     ',vg
      WRITE(6,8)' bp     ',bp
      WRITE(6,8)' bv     ',bv
!
      WRITE ( 6, 9200 )  EPBASE, STAR,CDX,SDX,CRAX,SRAX
 9200 FORMAT (1X, "EPBASE = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "STAR   = ", 3 ( D30.16, 10X ),/,1X, &
     &            "CDX    = ", D30.16,1X, &
     &            "SDX    = ", D30.16,1X, &
     &            "CRAX   = ", D30.16,/,1X, &
     &            "SRAX   = ", D30.16)
!
! NORMAL PROGRAM CONCLUSION.
!
  600 RETURN
      END
!***********************************************************************
      SUBROUTINE UT1G (AT, DUTCAT, UTC, XJD, CT, TT, FA2K, FAD2K,       &
     &           TC2000, TSKIP, DUT1AT, UT1,                            &
     &           Xti, Yti, UT1ti, dXti, dYti, dUT1ti)
      IMPLICIT None
!
!     UT1G is the UT1 module geometry section. It computes the instantaneous
!     offset between A1 and UT1 and the partial derivative of UT1 time with
!     respect to atomic time.
!
!     References - Ash,  M.E., 'Determination of Earth Satellite Orbits',
!     Lincoln Laboratory Technical Report 1972-5, 04/19/72, P. 42, 229-230.
!
!     Calling sequence -
!           Input variables:
!             1. AT     - The TAI fraction of the atomic time day. (days)
!             2. DUTCAT - The partial derivative of the UTC time with
!                         respect to the atomic time. (s/s)
!             3. UTC    - The UTC time fraction of the UTC day. (days)
!             4. XJD    - The Julian date at zero hours UTC of the date in
!                         question. (days)
!             5. CT     - The coordinate time fraction of the coordinate time
!                         day (days). [==> TDB]
!             6. TT     - The Terrestrial Time fraction of the day (days).
!             7. FA2K(14)-The fundamental arguments (used in UT1MU). (arcsec)
!             8. FAD2K(14)-The time derivatives of the fundamental arguments.
!                         (arcsec/century)
!             9. TC2000 - Time in Julian centuries since Jan. 1.5, 2000.
!                         (centuries)
!            10. TSKIP  - If 1, skip recomputations.
!           Output variables:
!             1. UT1    - The UT1 time of the day. (s)
!             2. DUT1AT - The partial derivative of the UT1 time with
!                         respect to atomic time. (s/s)
!             3. Xti    - Short period, ocean tidal contribution to
!                         X-polar motion. (milli-arc-seconds)
!             4. Yti    - Short period, ocean tidal contribution to
!                         Y-polar motion. (milli-arc-seconds)
!             5. UT1ti  - Short period, ocean tidal contribution to
!                         UT1 motion. (milli-seconds)
!
       Real*8 XJD, CT, TT, TC2000, ATMUT1,SHORTP,DIVUTC, &
     &        FA2K(14), FAD2K(14)
       Real*8 AT, DUTCAT, UTC, DUT1AT, UT1, tab_time
       Real*8 TMJD, Xti, Yti, UT1ti, dXti, dYti, dUT1ti, UT1li, dUT1li
       Integer*4 TSKIP
!
!    Common blocks used -
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!            Variables 'from':
!              1. SECDAY     -  The number of seconds in a day. (s/day)
!
      INCLUDE 'cmxut11.i'
!            Variables 'from':
!             1. UT1IF(4)   -  The UT1 information array. This array
!                              contains respectively: 1) The Julian
!                              date of the first tabular point,
!                              2) The increment in days of the tabular
!                              points, 3) The number of tabular points,
!                              4) The units of the UT1 tabular array per
!                              second. (days, days, unitless, s/table unit)
!             2. UT1PT(20)  -  The tabular values of the 'TAI - UT1' offset.
!             3. Y1(2)      -  An array used in the calculation of DIVUTC.
!             4. Y2(1)      -  An array used in the calculation of DIVUTC.
!             5. T          -  A time used in the calculation of DIVUTC.
!             6. S          -  Used in the calculation of DIVUTC.
!             7. UT1RS(20)  -  The table of 'TAI-UT1' (default) or 
!                              'TAI-UT1S' ['TAI-UT1' with fortnightly
!                              tidal terms removed using the model of
!                              Defrainge and Smits, 1999, as recommended
!                              by the IERS Conventions (2003)]. (seconds)
!             8. EOP_time_scale - EOP table time scale, allowed values:
!                              'TAI     ', 'TCG     ', 'TDB     ',
!                              'TDT     ', 'UTC     ', 'UNDEF   '.
!
      INCLUDE 'ccon.i'
!           Variables 'from':
!             1. KUT1C - UT1 module flow control flag, controls the
!                        temporary removal of periodic terms (UT1S)
!                        and the type of interpolation (spline or cubic)
!                        in the UT1 tables. Revised Sept/Oct 2005.
!                        = 0. Leave table as TAI-UT1.
!                           Do spline interpolation for a 1-day
!                           series. 5-day series no longer allowed!
!                        = 1. Module completely off, that is, UT1 set 
!                           equal to AT.
!                        = 2. Use TAI-UT1; use cubic interpolation for a
!                           1-day series. 5-day series no longer allowed!
!                        = 3. Use TAI-UT1; use linear interpolation for a
!                           1-day series. 5-day series no longer allowed!
!                        = 4. Convert table to TAI-UT1S. 
!                           Do spline interpolation for a 
!                           1-day series, then restore to true UT1 using
!                           the new UT1S model of Defrainge and Smits, 
!                           1999. 5-day series no longer allowed!
!             2. KUT1D - The module debug output flag.
!
       INCLUDE 'cuser11.i'
!          Variables from:
!            1. Calc_user - Calc user type. 'A' for Calc/SOLVE analysis.
!                           'C' for VLBI correlator.
!            2. Hifreq_tidal_EOP - Correlator option to add the high
!                           frequency (diurnal and sub-diurnal) EOP 
!                           correction for ocean tidal effects from 
!                           subroutine ORTHO_EOP. 
!                           'Y' => Add corrections to UT1, DUT1AT, ATMUT1.
!                           'N' => Don't add high frequency UT1 correction. 
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. ATMUT_1 -  The interpolated value of 'TAI - UT1'. (sec)
!
      Real*8  ATMUTC(3), ROTEPH(2,20), A1UTC(3), A1DIFF(3)
      COMMON / EOPCM / ATMUTC, ROTEPH, A1UTC, A1DIFF
!           VARIABLES 'TO':
!            1. ATMUTC(3) - THE 'TAI MINUS UTC' INFORMATION ARRAY. THIS ARRAY
!                           CONTAINS RESPECTIVELY THE EPOCH, VALUE, AND TIME
!                           RATE OF CHANGE OF 'TAI MINUS UTC'. Used in the
!                           atomic time module. (DAYS, SEC, SEC/SEC)
!
!     Database access - PUT ('UT1 -TAI'/-ATMUT1) moved to PUT_G
!
!     Subroutine interface -
!             Caller subroutines: DRIVG
!             Called subroutines: UT1MU, PUT
!
!     Program variables -
!           1. ATMUT1 -  The interpolated value of 'TAI - UT1'. (sec)
!           2. DIVUTC -  The partial derivative of 'TAI MINUS UT1'
!                        with respect to UTC.  (sec/sec)
!           3. SHORTP -  UT1S-UT1 (s). Notice the sense.
!                        The short period correction to ATMUT1. (sec)
!
       SAVE  ATMUT1
!
!     Programmer - Dale Markham   02/14/77
!      77.07.14: Peter Denatale
!      78.02.21: Bruce Schupler
!      88.12.21: Gregg Cooke   Initial CALC 7.4 mods.
!      89.07.11: Jim Ryan      Documentation simplified.
!      89.12.12: Jim Ryan      UNIX-like database interface implimented.
!      90.01.02: Jim Ryan      UT1-TAI stored rather than reverse.
!      90.06.19: Jim Ryan      Logic to always interpolate with UT1R added.
!      93:09:07: Norbert Zacharias Use fundam. arg. from DRIVR to UT1G to UT1MU.
!      93:03:17: David Gordon  UT1S added as default, new control flag scheme.
!      94.04.06: David Gordon  Changed to 'Implicit None'.
!      94.09.27: David Gordon  Removed unused 'XLOVEK' Love number.
!      98.01.27: David Gordon  Removed UT1R references.
!      98.02.09: David Gordon  Code to skip repeat computations.
!      98.04.13: David Gordon  Common /UT1CM/ moved to 'cmxut.i' include file.
!      98.11.05: David Gordon  SAVE block added to save ATMUT1.
!      2001.01.02 David Gordon Modified to get table scale from EOP_time_scale.
!                              Tab_time used in place of CT in UT1MU argument.
!      2002.09   Jim Ryan      Integer*2/4 mods.
!      2003.12.24 D. Gordon    Changed short period computations. Effects
!                              UT1 at the ~2-3 nsec level. .......
!      2003-2004 David Gordon  Updated for IERS Conventions 2003.
!      2007.12.28 D. Gordon    Option to add short period ocean tide 
!                              corrections to UT1 and X/Y polar motion. 
!      2012.04.19 D. Gordon    Added TT, Terrestrial Time. 
!      Dec. 2012  D. Gordon    Added put2s.i and moved PUT's to PUT_G.
!
!     UT1G Program structure
!
!     Obtain ATMUT1 (The interpolated value of 'TAI - UT1').
!
      IF (TSKIP .EQ. 1) GO TO 101
!
!  Determine time scale of EOP table epochs. CT (=TDB) is the default.
!        tab_time = CT
! Change to TT for consistency with Tskip. Differences is ~1 milli-sec.
         tab_time = TT
       If (EOP_time_scale .eq. 'UTC     ') tab_time = UTC
       If (EOP_time_scale .eq. 'TAI     ') tab_time = UTC + &
     &       ATMUTC(2)/SECDAY + ATMUTC(3)*(XJD-ATMUTC(1))
       If (EOP_time_scale .eq. 'TDT     ') tab_time = UTC + &
     &      (ATMUTC(2) + 32.184D0)/SECDAY + ATMUTC(3)*(XJD-ATMUTC(1))
!
      If(KUT1C.ne.1) Then
        CALL UT1MU (XJD,TAB_TIME,FA2K,FAD2K,TC2000,ATMUT1, &
     &              SHORTP,DIVUTC)
!
!  Compute the UT1 time of the day.
        UT1 = AT * SECDAY - ATMUT1
!  Compute the partial derivative of UT1 time with respect to atomic time.
        DUT1AT = 1.D0  -  DIVUTC * DUTCAT
      Else
        UT1    = AT * SECDAY
        DUT1AT = 1.D0
        ATMUT1 = 0.D0
      Endif
!
!   Compute the short period corrections to UT1 and X,Y polar motion
!    due to ocean tides using the Ortho_EOP subroutine. (msec)
!    Polar motion contributions (Xti, Yti) to be saved for subroutine WOBG.
!   (Time scale not defined for ORTHO_EOP, using TT.
         TMJD = (XJD - 2400000.5D0) + TT
       CALL ORTHO_EOP (TMJD, Xti, Yti, UT1ti, dXti, dYti, dUT1ti)
!
!   Compute the short period corrections to UT1 due to libration. (msec)
!      CALL UT1LIB (GMST2K, FA2K, FAD2K, UT1li, dUT1li)
!!!!! Can't do this here, GMST2K not yet defined!!!!!!!!!!!!!!!!!!
!
!     WRITE(6,*) 'UT1G: Xti, dXti (mas) ', Xti, dXti
!     WRITE(6,*) 'UT1G: Yti, dYti (mas) ', Yti, dYti
!     WRITE(6,*) 'UT1G: UT1 (sec) ', UT1 
!     WRITE(6,*) 'UT1G: UT1ti, dUT1ti(ms) ', UT1ti, dUT1ti
!!!   WRITE(6,*) 'UT1G: UT1li,dUT1li  ', UT1li, dUT1li
!     WRITE(6,*) 'UT1G: UT1 (sec)     ', UT1       
!     WRITE(6,*) 'UT1G: UT1 + UT1ti   ', UT1 + UT1ti*1.D-3         
!
!  Add in short period ocean tidal effects for correlator usage.
!     If (Calc_user .eq. 'C' .and. Hifreq_tidal_EOP .eq. 'Y') Then
!       UT1 = UT1 + UT1ti*1.D-3 
!       DUT1AT = DUT1AT + dUT1ti*1.D-3
!       ATMUT1 = ATMUT1 - UT1ti*1.D-3
!     Endif
!
 101  CONTINUE
!
       ATMUT_1 = ATMUT1
!     PUT the UT1 value into the database for this observation.
!     NOTE: This is UT1-TAI, not the opposite sense.
!        Moved to PUT_G.
!
!     Check KUT1D for debug output.
      IF ( KUT1D .ne. 0 )  Then
      WRITE ( 6, 9)
    9 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE UT1G." )
      WRITE(6,8)' ATMUT1  ',ATMUT1
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' DIVUTC  ',DIVUTC
    7 FORMAT(A,15I8/(9X,15I8))
      WRITE(6,8)' SECDAY  ',SECDAY
!
      WRITE ( 6, 9200 )  AT, DUTCAT, UTC, XJD, UT1, DUT1AT
 9200 FORMAT (1X, "AT     = ", D30.16, /, 1X, &
     &            "DUTCAT = ", D30.16, /, 1X, &
     &            "UTC    = ", D30.16, /, 1X, &
     &            "XJD    = ", D30.16, /, 1X, &
     &            "UT1    = ", D30.16, /, 1X, &
     &            "DUT1AT = ", D30.16, /, 1X)
!
      WRITE(6,8) ' TMJD        ', TMJD
      WRITE(6,8) ' Xti, dXti   ', Xti, dXti
      WRITE(6,8) ' Yti, dYti   ', Yti, dYti
      WRITE(6,8) ' UT1ti, dUT1ti ', UT1ti, dUT1ti
!
      Endif
!
!   7.    NORMAL PROGRAM CONCLUSION.
!
      RETURN
      END
!*********************************************************************
      SUBROUTINE UT1P (CFBASE, STAR, EARTH, RPN2K, RW2K, ERA2K, &
     &                 dERA2K, pERA2K, SITEV       )
      IMPLICIT None
!
!     UT1P is the UT1 module partial derivatives section. It computes the
!     partial derivatives of the delay and the delay rate with respect to the
!     instantaneous 'TAI - UT1'.
!
!     Calling sequence
!           Input variables:
!             1. CFBASE(3)  -  The crust fixed baseline vector.  (m)
!             2. STAR(3)    -  The J2000.0 source unit vector.
!             3. EARTH(3,3) -  The SSBC position, velocity, and acceleration of
!                              the Earth. (m, m/s, m/s**2)
!             4. RPN2K(3,3,2) - The precession-nutation portion of the
!                              complete crust
!                              fixed to J2000.0 rotation matrix and its CT time
!                              derivative (unitless,1/s).
!             5. RW2K(3,3,2) - The wobble portion of the complete crust fixed
!                              to J2000.0 rotation matrix and its first time
!                              derivative. (unitless, 1/sec)
!             6. ERA2K       - Earth rotation angle (Radians).
!             7. dERA2K      - Time derivative of Earth rotation angle.
!             8. pERA2K      - Partial derivative of the Earth rotation
!                              angle (ERA2K) w.r.t. UT1.
!             9. SITEV(3,2)  - THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF
!                              EACH OBSERVATION SITE. (M/SEC)
!
      Real*8 CFBASE(3), STAR(3), EARTH(3,3),             SITEV(3,2), &
     &       RPN2K(3,3,2), RW2K(3,3,2), pERA2K, ERA2K, dERA2K
!
!     Common blocks used -
!
      INCLUDE 'cphys11.i'
!            Variables 'from':
!              1. VLIGHT  - The defined speed of light. (m/s)
!              2. VLIGHT2 - THE VELOCITY OF LIGHT SQUARED.
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!             1. KUT1C  -  UT1 module flow control flag, controls the
!                          temporary removal of periodic terms (UT1S)
!                          and the type of interpolation (spline or cubic)
!                          in the UT1 tables. Revised Sept/Oct 2005.
!                          = 0. Leave table as TAI-UT1. Do spline 
!                             interpolation for a 1-day series. 
!                             No longer allow use of a 5-day series!
!                          = 1. Module completely off, that is, UT1 set equal
!                             to AT.
!                          = 2. Use TAI-UT1; use cubic interpolation for a
!                             1-day series. 5-day series no longer allowed!
!                          = 3. Use TAI-UT1; use linear interpolation for a
!                             1-day series. 5-day series no longer allowed!
!                          = 4. Convert table to TAI-UT1S. Do spline 
!                             interpolation for a 1-day series, then 
!                             restore to true UT1 using the UT1S model of
!                             Defrainge and Smits, 1999. 
!                             No longer allow use of a 5-day series.
!              2. KUT1D  -  The UT1 module debug output flag.
!
      INCLUDE 'put2s.i'
!       Variables to:
!          1. DUT1P(2,2) - The partial derivatives of the delay and rate
!                          with respect to the instantaneous value of
!                          'A1-UT1'. (s/s, s/s**2) The second index runs
!                              over the first and second derivatives.
!
!
!     Program specifications -
!
      Real*8  SBASE(3,2,2), TT,                                         &
     &       VG(3), VE(3), DOTP, pRS2K(3,3,2,2), SR2K(3,3,2,2)
      Integer*4 I, J, K
!
!    Database access => Moved to PUT_P ('UT1 PART'/DUT1P).
!
!     Subroutine interface -
!             Caller subroutines: DRIVP
!             Called subroutines: DDROT, DOTP, DROTT, MMUL5, VECRT
!
!     Program variables -
!          1. pRS2K(3,3,2,2) -  The partial derivatives of the diurnal spin
!                               matrix (DSM) and its time derivative w.r.t.
!                               the value of 'A1-UT1'. (1/s,1/s**2)
!                               The 4th index runs over the first and
!                               second partials of the DSM w.r.t. (TAI-UT1).
!                               The third index runs over the first and
!                               second partials of the first time derivative
!                               of the DSM w.r.t. (TAI-UT1).
!          2. SBASE(3,2,2)   -  The partial derivatives of the J2000.0 baseline
!                               position and velocity vectors with respect to
!                               the instantaneous value of 'A1-UT1'.
!                               (m/s,m/s**2). The final index counts the first
!                               and second partials.
!          3. SR2K(3,3,2,2)  -  The partial derivative of the complete crust
!                               fixed to J2000.0 rotation matrix and its
!                               derivative with respect to the instantaneous
!                               value of 'A1-UT1'. (1/s, 1/s**2)
!                               A 4th index value of 1 or 2 applies to the
!                               first derivative. A third index value of 1
!                               or 2 applies to the second derivative.
!          4. TT, VG, VE     -  Dummy variables used in the computation of the
!                               partials.
!
!     Programmer - Dale Markham   02/14/77
!      77.07.14  Peter Denatale
!      78.03.28  Bruce Schupler
!      80.07.11  Bruce Schupler
!      89.07.11  Jim Ryan      Documentation simplified.
!      89.10.05  Jim Ryan      CPHYS common made an include file.
!      89.12.12  Jim Ryan      UNIX-like database interface implemented.
!      91.05.30  Jim Ryan      Documentation simplified.
!      91.11.25  Jim Ryan      Second term in the Shapiro model added
!                              to the partials.
!      93.08.17  Norbert Zacharias  Output variable DUT1P added to arg.list
!      94.04.06  David Gordon  Changed to 'Implicit None'.
!      95.12.11  David Gordon  Changed RW(3,3) to RW(3,3,2).
!      98.01.27  David Gordon  Removed UT1R references.
!      2002.09   Jim Ryan      Integer*2/4 mods.
!      2003-2004 David Gordon  Updated for IERS Conventions 2003.
!      Dec. 2012 D. Gordon     PUT moved to PUT_P.
!
!     UT1P Program Structure
!
!   New code using Earth rotation angle, from IERS200
!
!     Construct the partial derivatives of the diurnal spin matrix
!     with respect to the instantaneous offset between A1 and UT1.
!
!    First partial w.r.t. TAI-UT1
!     CALL DROTT ( -ERA2K,-pERA2K, int2(3), pRS2K(1,1,1,1))
      CALL DROTT ( -ERA2K,+pERA2K, int2(3), pRS2K(1,1,1,1))
!    Second partial w.r.t. TAI-UT1
      CALL DDROT ( -ERA2K, +pERA2K*pERA2K, int2(3), pRS2K(1,1,1,2))
!
!     Construct the partial derivatives of the first CT time derivative of the
!     diurnal spin matrix with respect to the instantaneous offset between A1
!     and UT1. (NOTE: To a very good approximation the first partial is just the
!     second CT time derivative of the diurnal spin matrix.)
!
!    First partial of first CT time derivative w.r.t. TAI-UT1
!     CALL DDROT ( -ERA2K, +pERA2K*DERA2K , int2(3), pRS2K(1,1,2,1))
      CALL DDROT ( -ERA2K, -pERA2K*DERA2K , int2(3), pRS2K(1,1,2,1))
!    Second partial of first CT time derivative w.r.t. TAI-UT1
      CALL D3ROT( -ERA2K,-pERA2K*pERA2K*DERA2K,int2(3),pRS2K(1,1,2,2))
!
!     Compute the partial derivatives of the complete crust fixed to J2000.0
!     rotation matrix and of its first CT time derivative with respect to the
!     instantaneous offset between A1 and UT1. (NOTE: Of the three terms which
!     are used to compute the CT time derivative of the complete crust fixed to
!     J2000.0 rotation matrix, only the term which contains the CT time
!     derivative of the diurnal spin matrix is considered significant enough to
!     include in this partial derivatives section.)
!
!   First partial w.r.t. TAI-UT1
          CALL MMUL3 (RPN2K(1,1,1), pRS2K(1,1,1,1), RW2K(1,1,1), &
     &                SR2K(1,1,1,1))
!   Second partial w.r.t. TAI-UT1
          CALL MMUL3 (RPN2K(1,1,1), pRS2K(1,1,1,2), RW2K(1,1,1), &
     &                SR2K(1,1,1,2))
!
!   First partial of first CT time derivative w.r.t. TAI-UT1
          CALL MMUL3 (RPN2K(1,1,1), pRS2K(1,1,2,1), RW2K(1,1,1), &
     &                SR2K(1,1,2,1))
!   Second partial of first CT time derivative w.r.t. TAI-UT1
          CALL MMUL3 (RPN2K(1,1,1), pRS2K(1,1,2,2), RW2K(1,1,1), &
     &                SR2K(1,1,2,2))
!
!   Compute the partial derivatives of the J2000 baseline position and velocity
!   vectors with respect to the instantaneous offset between A1 and UT1.
!
          CALL VECRT ( SR2K(1,1,1,1), CFBASE, SBASE(1,1,1) )
          CALL VECRT ( SR2K(1,1,1,2), CFBASE, SBASE(1,2,1) )
!
          CALL VECRT ( SR2K(1,1,2,1), CFBASE, SBASE(1,1,2) )
          CALL VECRT ( SR2K(1,1,2,2), CFBASE, SBASE(1,2,2) )
!
!   Compute the partial derivatives of the delay and the delay rate with
!   respect to the instantaneous offset between A1 and UT1.
!   Changed to use the Consensus model definition
      Do I = 1,3
        VE(I) = EARTH(I,2)
        VG(I) = EARTH(I,2) + SITEV(I,2)
      Enddo
      TT = 1.d0 + DOTP(STAR,VG)/VLIGHT
!   First partial of delay w.r.t. TAI-UT1
      DUT1P(1,1) = DOTP(SBASE(1,1,1),STAR)/VLIGHT/TT                    &
     &           + Dotp(SBASE(1,1,1),VE)/VLIGHT2
!   Second partial of delay w.r.t. TAI-UT1
      DUT1P(2,1) = DOTP(SBASE(1,2,1),STAR)/VLIGHT/TT                    &
     &           + Dotp(SBASE(1,2,1),VE)/VLIGHT2
!   First partial of rate w.r.t. TAI-UT1
      DUT1P(1,2) = DOTP(SBASE(1,1,2),STAR)/VLIGHT/TT                    &
     &           + Dotp(SBASE(1,1,2),VE)/VLIGHT2
!   Second partial of rate w.r.t. TAI-UT1
      DUT1P(2,2) = DOTP(SBASE(1,2,2),STAR)/VLIGHT/TT                    &
     &           + Dotp(SBASE(1,2,2),VE)/VLIGHT2
!
!   PUT the UT1 partial derivatives.   Moved to PUT_P.
!
!   Check KUT1D for debug output.
      IF ( KUT1D .ne. 0 )  Then
      WRITE ( 6, 9)
    9 FORMAT (1X, "DEBUG OUTPUT FOR SUBROUTINE UT1P." )
!     WRITE(6,8)' DSDUT1  ',DSDUT1
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' DUT1P   ',DUT1P
      WRITE(6,8)' SBASE   ',SBASE
      WRITE(6,8)' VLIGHT  ',VLIGHT
      WRITE(6,8)' TT      ',TT
      WRITE(6,8)' VG      ',VG
      WRITE(6,8)' VE      ',VE
      WRITE(6,8)' ERA2K   ',ERA2K
      WRITE(6,8)' DERA2K  ',DERA2K
      WRITE(6,8)' pERA2K  ',pERA2K
      Write(6,1031) pRS2K
 1031  Format(1x,'UT1P/pRS2K: ',(12(/,3E25.15)))
       Write(6,1032) SR2K
 1032  Format(1x,'UT1P/SR2K: ',(12(/,3E25.15)))
       Write(6,1033) SBASE
 1033  Format(1x,'UT1P/SBASE: ',(4(/,3E25.15)))
!
      WRITE ( 6, 9200 ) CFBASE, RPN2K, RW2K, STAR
 9200 FORMAT (1X, "CFBASE = ", 3 ( D30.16, 10X ), /, 1X, &
     &            "RPN2K  = ", 6 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "RW2K   = ", 6 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "STAR   = ", 3 ( D30.16, 10X ) )
      Endif
!
!     Normal conclusion.
      RETURN
      END
!*********************************************************************
      SUBROUTINE UT1C (UT1ti, dUT1ti, UT1li, dUT1li)
      IMPLICIT None
!
!     UT1C is the UT1 module contributions section. It computes the
!      delay and rate contributions due to the short period ocean
!      tidal contribution to UT1.
!
!     Calling sequence
!       Input variables:
!         1. UT1ti  - Short period, ocean tidal contribution to
!                     UT1 motion. (milli-seconds)
!         2. dUT1ti - Time derivative of the short period, ocean tidal 
!                     contribution to UT1 motion. (milli-sec/sec)
!         3. Ut1li  - Short term libration correction to UT1 (milli-sec)
!         4. dUt1li - Time derivative of short term libration correction to
!                     UT1. (milli-sec/sec)
!
!   Common blocks used:
      INCLUDE 'put2s.i'
!       Variables from:
!         1. DUT1P(2,2) - The partial derivatives of the delay and rate
!                         with respect to the instantaneous value of
!                         'A1-UT1'. (s/s, s/s**2) The second index runs
!                         over the first and second derivatives.
!       Variables to:
!         1. UT1tid(2) - UT1 delay and rate contributions from short
!                        period UT1 corrections (sec, sec/sec).
!         2. UT1lib(2) - UT1 delay and rate contributions from short
!                        period libration corrections (sec, sec/sec).
!
!
!**   Real*8    DUT1P(2,2), UT1tid(2), UT1lib(2), UT1ti, dUT1ti, UT1li, &
      Real*8                                      UT1ti, dUT1ti, UT1li, &
     &          dUT1li
      Integer*4 K
!
!     Database access => Moved to PUT_C ('UT1ORTHO'/UT1tid and 
!                        'UT1LIBRA'/UT1lib).
!
!   Programmer - David Gordon 2004.10.15
!          David Gordon Jan. 2013  Moved all PUT's to subroutine PUT_C.
!
!  UT1C Program Structure
!
!   Compute the contributions.
!    The negative sign is because DUT1P is the partial w.r.t. (TAI-UT1)!
!    The rate contributions are incomplete, but they are negligibly small.
      UT1tid(1) = -DUT1P(1,1) * UT1ti * 1.0D-3
      UT1tid(2) = -DUT1P(1,2) * UT1ti * 1.0D-3
      UT1lib(1) = -DUT1P(1,1) * UT1li * 1.0D-3
      UT1lib(2) = -DUT1P(1,2) * UT1li * 1.0D-3
!
!       print *,' UT1C: DUT1P(1,1)/(1,2) ', DUT1P(1,1), DUT1P(1,2)
!       print *,' UT1C: DUT1P(2,1)/(2,2) ', DUT1P(2,1), DUT1P(2,2)
!       print *,' UT1C: UT1tid =  ', UT1tid 
!       print *,' UT1C: UT1lib =  ', UT1lib 
!
!
!     Normal conclusion.
      RETURN
      END
!
!*********************************************************************
      SUBROUTINE UT1MU (XJD,tab_time,FA2K,FAD2K,tc2000,ATMUT1,          &
     &                  SHORTP,DIVUTC)
      IMPLICIT None
!
!     UT1MU is the UT1 module utility. It calculates the difference between AT
!     and UT1 to the best precision that our model allows. It also returns
!     separately the tidal correction to the difference.
!
!     References -
!           ASH, M.E., "Determination of Earth Satellite Orbits", Lincoln
!           Laboratory Technical Report 1972-5, 04/19/1972, P. 42, 229-230.
!
      Real*8 XJD, tc2000, ATMUT1, SHORTP, DIVUTC, tab_time, FA2K(14),   &
     &       FAD2K(14)
!
!        Input variables:
!         1. XJD   - The Julian date at zero hours UTC of the day in question.
!         2. Tab_time - Fraction of the day in the time scale of the input
!                    EOP table (CT, UTC, or ???)
!         3. FA2K(14)-The fundamental arguments (as of NUTFA from file
!                    cnutm.f). (arcseconds)
!         4. FAD2K(14)-The time derivatives of the fundamental arguments
!                    FA2K(14). (arcseconds/century)
!         5. TC2000- Time in Julian centuries since J2000.
!
!        Output variables:
!         1. ATMUT1 - The interpolated value of 'TAI - UT1' (s).
!         2. SHORTP - 'UT1S-UT1' (seconds). Note sense.
!         3. DIVUTC - The partial derivative of 'TAI MINUS UT1' with respect
!                     to UTC. (SEC/SEC)
!
!     Common block used  -
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          Variables 'from':
!            1.  SECDAY  -  The number of seconds in a day. (s/day)
!            2.  TWOPI   -  PI times 2.0D0.
!
      INCLUDE 'cmxut11.i'
!      Variables 'from':
!        1. UT1IF -  The UT1 infomation array. (See above.)
!        2. UT1PT -  The tabular values of 'TAI - UT1'. (See above)
!        3. CENTJ -  The number of Julian days per Julian century. (days)
!        4. DJ1900 - The Julian date of January 1.5, 1900 (days).
!        5. DJ2000 - The Julian date of January 1.5, 2000 (days).
!        7. ISHRTFL  - The short period tidal terms flag, (unitless).
!                    = 0 --> UT1 table coming from input db is true UT1,
!                    (fortnightly tidal terms have not been removed).
!                    = -1 --> UT1 table coming from input db is UT1R, (Yoder
!                    fortnightly tidal terms HAVE been removed as in Bull. B).
!                     NOT SUPPORTED!!!!!
!                    = -2 --> UT1 table coming from input db is UT1S, (that is,
!                    the S tidal terms HAVE been removed)
!                     NOT SUPPORTED!!!!!
!        8. Usecubic - Set to true if cubic interpolation is to be used. False
!                    otherwise.
!        9. Uselinear - Set to true if linear interpolation is to be used.
!                    False otherwise.
!       10. Usespline - Set to true if spline interpolation is to be used.
!                    False otherwise.
!       11. UT1RS(20) - The table of 'TAI-UT1' or 'TAI-UT1S' ('TAI-UT1'
!                    with tidal terms removed using the model of
!                    Defrainge and Smits, 1999, as recommended
!                    by the IERS Conventions (2003)]. (seconds)
!
!      Variables 'to':
!        1. Y1(2) - A variable used in interpolation.
!        2. Y2(2) - Same.
!        3. T     - Same.
!        4. S     - Same.
!
      INCLUDE 'ccon.i'
!       Variables 'from':
!             1. KUT1C - UT1 module flow control flag, controls the
!                        temporary removal of periodic terms (UT1S)
!                        and the type of interpolation (spline or cubic)
!                        in the UT1 tables. Revised Sept. 2005.
!                        = 0. Leave table as TAI-UT1.
!                           Do spline interpolation for a 1-day
!                           series. No longer allow use of a 5-day series!
!                        = 1. Module completely off, that is, UT1 set equal
!                           to AT.
!                        = 2. Use TAI-UT1; use cubic interpolation for a
!                           1-day series. 5-day series no longer allowed!
!                        = 3. Use TAI-UT1; use linear interpolation for a
!                           1-day series. 5-day series no longer allowed!
!                        = 4. Convert table to TAI-UT1S.
!                           Do spline interpolation for a 
!                           1-day series, then restore to true UT1 using
!                           the new UT1S model of Defrainge and Smits, 
!                           1999. No longer allow use of a 5-day series.
!             2. KUT1D - The UT1 module debug control flag.
!
!     Program specifications
!
      Real*8 XINT(4), Dut, Dlod, Domega, Shortp_dot, F2
      Real*8 DUT_DOT, DUT1
      Real*8 x_spline, y_spline, ydot, ydot2, ydot3
      Integer*4 INT, ILAST, N, NN, NR, Ierr4
!
!     Subroutine Interface
!        Caller Subroutines: UT1G
!        Called Subroutines: DFLOTJ,IDINT,UT1S2K,splint4
!
!     Program variables:
!        1. XINT(4) - An array used in the interpolation procedure.
!
!     Programmer - Bruce Schupler 02/21/78
!      78.07.03  Bruce Schupler
!      85.04.13  David Gordon
!      89.07.11  Jim Ryan  Documentation simplified.
!      91.05.30  Jim Ryan  Documentation simplified furthur.
!      91.06.05  Jim Ryan  Interpolation modified to use linear interpolation.
!                          if the series is a 'one day' series.
!      91.06.19  Jim Ryan  Logic modified to always interpolate in the UT1R
!                          values. Important! Logic for computing the Ut1 time
!                          derivative moved here from UT1G (where it did not
!                          belong), and the effect of tidal terms on that
!                          derivative added.
!      91.11.05  Jim Ryan  SHORTP_DOT added to the computation of UT1 rate for
!                          linear interpolation. It was left out when linear
!                          was added.
!      93.03.17  D. Gordon Interpolation in UT1S added, new control flag scheme
!      93.09.07  Norbert Zacharias  Handle fundamental arguments, fa.
!      93 Dec.   D. Gordon Cubic spline interpolation added, modified control
!                          flag scheme for type of interpolation.
!      94.04.06  D. Gordon Changed to 'Implicit None'.
!      94.04.13  D. Gordon DFLOT changed to Fortran 77 DFLOTJ.
!      94.09.26  D. Gordon Added some debug printout, documentation
!                          corrections, cosmetic mods.
!      94.09.27  D. Gordon Removed unused 'XLOVEK' Love number.
!      98.01.21  D. Gordon Adding fad(5) to UT1RZT and UT1SZT.
!      98.01.27  D. Gordon Removing call to UT1RZT, and UT1R option.
!      98.04.13  D. Gordon Common /UT1CM/ moved to 'cmxut.i' include file.
!      2001.01.02 D.Gordon CT replaced with tab_time as input argument.
!      2002.09   Jim Ryan  Integer*4 conversion.
!      2003-2004 David Gordon Updated for IERS Conventions 2003.
!
!     UT1MU Program Structure
!
!     Convert tab_time and XJD to the units of the interval of the
!     table relative to
!     the first point of the table. INT is defined so that INT+2 is the number
!     of the point in the UT1 table immediately before (or at) the time of the
!     observation. (INT+2 is before and INT+3 is after the observation.)
!
      T = XJD  -  UT1IF(1)
!     T = ( T + CT ) / UT1IF(2)
      T = ( T + tab_time ) / UT1IF(2)
      INT = T
!     T = T - DFLOTJ ( INT )
      T = T - DFLOAT ( INT )
      INT = INT - 1
!
      IF (KUT1C.eq.4) Then
!       CALL UT1SZT (fa2k, fad2k, DUT, DLOD, DOMEGA)
        CALL UT1S2K (FA2K, FAD2K, DUT, DLOD, DOMEGA)
!        write(6,1021) DUT,DLOD,DOMEGA
!1021    format('UT1MU/UT1S2K: DUT,DLOD,DOMEGA = ', 3D25.16)
        SHORTP = -DUT
!    Convert rate of change from rad/sec to sec/sec
        SHORTP_DOT = -(DOMEGA/TWOPI)*SECDAY
!
      ELSE
!  Normal case: No UT1 smoothing
        SHORTP = 0.D0
        SHORTP_DOT = 0.D0
      ENDIF
!
!  Begin interpolation:
!
      IF (Usespline) then                      !Cubic spline interpolation
!   Compute time of obs. and divide by interval
!       X_spline = (XJD + Ct) / UT1IF(2)
        X_spline = (XJD + Tab_time) / UT1IF(2)
!
!   Do the spline interpolation
        Call Splint4 (XT,Ya,Y2s,Nspline,X_spline,Y_spline,Ydot,Ydot2, &
     &                Ydot3,Ierr4)
!
        ATMUT1 = Y_spline + SHORTP
        DIVUTC = Ydot / (UT1IF(2) * SECDAY) + SHORTP_DOT
!
      Endif                                     !Cubic spline interpolation
!
!***************************************
      IF (Usecubic) then                    !Four point cubic interpolation
!       Select the required four tabular points and verify that the
!       interpolation is not outside the range of the table.
!       (NOTE: If the interpolation is outside the range of the table,
!       a message is written and the program terminates.)
!
        ILAST = IDINT ( UT1IF(3) )
        DO  N = 1,4
          NN = INT  +  N
          IF ( ( NN .LT. 1 ) .OR. ( NN .GT. ILAST ) )  GO TO 1000
          XINT(N) = UT1RS(NN)
        ENDDO
!
!   Interpolate to determine the value of the 'TAI minus UT1' offset.
        DO  N = 1,2
          NR = N  +  1
          F2 = ( XINT (NR+1)  +  XINT (NR-1) ) / 6.D0
          Y1(N) = + ( 4.D0 / 3.D0 ) * XINT (NR)  -  F2
          Y2(N) = - ( 1.D0 / 3.D0 ) * XINT (NR)  +  F2
        ENDDO
!
        S = 1.D0  -  T
        ATMUT1 = &
     &     (  T * ( Y1(2)  +  T**2 * Y2(2) ) &
     &      + S * ( Y1(1)  +  S**2 * Y2(1) ) ) &
     &   + SHORTP
!
!   Compute the partial derivative of the 'IAT MINUS UT1' offset with respect
!    to UTC.
        DIVUTC = &
     &  ((  Y1(2)+3.d0*T**2*Y2(2) &
     &     -Y1(1)-3.d0*S**2*Y2(1) )/ &
     &    ( UT1IF(2) * SECDAY )     ) &
     &  + SHORTP_DOT
!
      ENDIF                                  !Four point cubic interpolation
!
!********************************************
      IF (Uselinear) Then           !Two point linear interpolation.
!
        If( INT+2 .lt. 1     .or. &
     &      INT+3 .gt. DINT(UT1IF(3)+.0001)) then
          Write(6,'( &
     &    "Error in UT1MU! Attemped to interpolate outside UT1 table.",/ &
     &    ,"INT =",I5," Table length =",i5)') INT, UT1IF(3)
          CALL TERMINATE_CALC( 'UT1MU ', int2(0), int2(0))
        Endif
!
        ATMUT1 = &
     &  ( (UT1RS(INT+3)-UT1RS(INT+2))*T+UT1RS(INT+2) ) + &
     &  SHORTP
!
        DIVUTC = (UT1RS(INT+3)-UT1RS(INT+2))/(UT1IF(2)*SECDAY) &
     &  + SHORTP_DOT
!
      ENDIF                          !Two point linear interpolation.
!
!******************************************************************************
!     Check for debug output.
      IF (KUT1D .ne. 0) THEN
        WRITE(6,'(" Debug output for subroutine UT1MU")')
        WRITE(6,88)' SHORTP, SHORTP_DOT ', SHORTP, SHORTP_DOT
 88     FORMAT(A,4D25.16/(9X,4D25.16))
 89     FORMAT(A,4I16/(9X,4I16))
        If(Usespline) Write(6,88)' XT      ', XT
        If(Usespline) Write(6,88)' Ya      ', Ya
        If(Usespline) Write(6,88)' Y2s     ', Y2s
        If(Usespline) Write(6,88)' X_spline,Y_spline', X_spline, &
     &                             Y_spline
        If(Usespline) Write(6,88)' Ydot,Ydot2,Ydot3 ', Ydot,Ydot2, &
     &                             Ydot3
        if(Usespline) Write(6,88)' Nspline, Ierr4 ',Nspline,Ierr4
        WRITE(6,89)' INT     ',INT
        WRITE(6,88)' T       ',T
        WRITE(6,88)' ATMUT1  ',ATMUT1
        WRITE(6,88)' DIVUTC  ',DIVUTC
        WRITE(6,88)' UT1IF   ',UT1IF
        WRITE(6,88)' UT1RS   ',UT1RS
!
!       WRITE(6,9200) XJD,CT,ATMUT1,SHORTP,DJ1900,CENTJ,DJ2000,TC2000
        WRITE(6,9200) XJD,tab_time,ATMUT1,SHORTP,DJ1900,CENTJ, &
     &                DJ2000,TC2000
 9200   FORMAT(1X,"XJD = ",D30.16,/,1X,"tab_time = ",D30.16,/, &
     &       1X,"ATMUT1 = ",D30.16,/,1X,"SHORTP = ",D30.16,/, &
     &       1X,"DJ1900 = ",D30.16,/,1X,"CENTJ = ",D30.16,/, &
     &       1X,"DJ2000 = ",D30.16,/,1X,"TC2000 = ",D30.16)
      ENDIF
!
!     Normal conclusion.
      RETURN
!
!     Abnormal termination.
 1000 CONTINUE
      WRITE(6,'(" CALC has terminated in subroutine UT1MU.", &
     &       /" The interpolation is outside the range of the UT1", &
     &       " table.  NN = ",I2," ILAST = ",I2," .")') NN, ILAST
      CALL TERMINATE_CALC ( 'UT1MU ', int2(0), int2(0))
      END
!************************************************************************
      BLOCK DATA UT1CMB
      IMPLICIT None
!
!     UT1BD is the UT1 module block data input and initialization section.
!
!     References 1) Ash, M.E., 'Determination of Earth Satellite Orbits",
!                   Lincoln Laboratory Technical Report 1972-5, 04/19/72, P. 42.
!                2  American Ephemeris and Nautical Almanac.
!                3) Melchior,"The Earth Tides".
!
      INCLUDE 'cmxut11.i'
!            Variables 'to':
!              1. CENTJ   -   The number of Julian days per Julian century.
!              2. DJ1900  -   The Julian date of Jan 1.5, 1900 (days).
!              3. DJ2000  -   The Julian date of Jan 1.5, 2000 (days).
!                             short period corrections to UT1 (See ref 4) (s).
!
!            Variables 'passed' from other module sections:
!              1. UT1IF(4)  -  The UT1 information array. (See above.)
!              2. UT1PT(20) -  The tabular values of 'IAT MINUS UT1'.
!
      DATA DJ1900, CENTJ / 2415020.0D0,36525.0D0/
      DATA DJ2000/2451545.0D0/
!
!    Constants used - DJ1900, CENTJ
!
!    Programmer - Dale Markham  02/14/77
!     77.07.14  Peter Denatale
!     78.02.21  Bruce Schuler
!     84.04.13  David Gordon
!     84.06.06  David Gordon
!     84.06.03  Savita Goel   CDS for A900.
!     94.04.06  David Gordon  Changed to 'Implicit None'.
!     94.09.27  David Gordon  Removed unused 'XLOVEK' Love number.
!     98.01.27  David Gordon  Removed Yoder coefficients.
!     98.04.13  David Gordon  Common /UT1CM/ moved to 'cmxut.i' include file.
!     03.02.25  Jim Ryan      Implicit none and type decs added by hand.
!
      END
!
!************************************************************************
      SUBROUTINE UT1SZT (FA2K, FAD2K, DUT, DLOD, DOMEGA)
      IMPLICIT None
!
!     Purpose: This subroutine evaluates the effects of zonal Earth tides on
!     the rotation of the Earth. The model used is from Yoder, Williams, and
!     Park (1981) and modified by the ocean effects as given in Dickman (1991)
!     as recommended by the IERS Standards, p. 117, 119-120 (1992).
!
!     Special Note: Under the UT1S definition, and as done by this routine,
!     zonal tides of _all_ periods are evaluated, including even those of
!     18.6 year period. Results will be substantially different (tenths of
!     seconds) from those evaluated with the "UT1R" algorithm, which only
!     includes the 41 terms for periods under 35 days. If you wish to determine
!     the effects from only those periods, please use the original Luzum
!     "zontids" routine, with N set to 41.  (B.A.)
!
!     Input Variables:
!          fa(5)  = Fundamental arguments from subroutine NUTFA (arcseconds)
!          fad(5) = Time derivatives of fundamental arguments (arcsec/century)
!     Output Variables:
!          DUT    - 'UT1 minus UT1S'. Effect on UT (Subtract from observation,
!                   add to IERS UT1). (sec)
!          DLOD   = Effect on length of day. (seconds).
!          DOMEGA = Effect on rotational speed (radians/second).
!
!     Written by:
!       Brian J. Luzum     92.08.11
!     Modifications:
!       Brent A. Archinal  92.08.27  Name changed from zontids to
!                                    ut1szt, N dropped from argument
!                                    list, comments improved.
!       "     "  "         92.10.27  Special note added above.
!       "     "  "         92.12.17  All real variables set to double
!                                    precision, at Jim Ray's suggestion
!                                    (email of 92.11.20).
!       David Gordon       93.03.17  Array X changed to XS, debug printout
!                                    added for calc 8.0.
!       Norbert Zacharias  93.09.16  Take fundam. arg. from subr. NUTFA
!       David Gordon       94.04.06  Changed to 'Implicit None'.
!       David Gordon       98.01.21  Extensive mods from John Gipson to use
!                                    the series expansion of DUT to calculate
!                                    DUT, DLOD, and DOMEGA instead of seperate
!                                    series expansions. fad(5) added to
!                                    subroutine call. DBLE's removed. CMATH
!                                    common block added. Variable SECCON
!                                    removed and replaced with 1/CONVDS. Sign
!                                    of X(7,62) corrected.
!     2002.09   Jim Ryan      Integer*4 conversion.
!
      REAL*8 T, DUT, DLOD, DOMEGA, F, D, OM, ARG
!     REAL*8 L, LP, fa(5), fad(5), ARG_DOT
      REAL*8 L, LP, FA2K(14), FAD2K(14), ARG_DOT
      Integer*4 N, I
      REAL*8 XS(11,62), X1(220), X2(220), X3(220), X4(22)
      EQUIVALENCE(XS(1,  1),X1(1))
      EQUIVALENCE(XS(1, 21),X2(1))
      EQUIVALENCE(XS(1, 41),X3(1))
      EQUIVALENCE(XS(1, 61),X4(1))
!
      INCLUDE 'ccon.i'
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          Variables 'from':
!            1. SECDAY -  The number of seconds in a day. (s/day)
!            2. TWOPI  -  PI times 2.0D0
!            3. CONVDS -  THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!
!  N=Number of tidal terms to be used (62 for full set).
!  (This was an argument in the original zontids routine.)
!
      DATA  N/62/
!
!***********************************************************************
!     Table of multiples of arguments and coefficients
!      (DLOD and DOMEGA tables no longer used, 98JAN21 -DG-)
!
!                  Multiple of            DUT        DLOD      DOMEGA
!             l   l'  F   D OMEGA     sin   cos    cos  sin   cos   sin
      DATA X1/1., 0., 2., 2., 2.,    -0.02, 0.00,  0.3, 0.0, -0.2,  0.0, &
     &        2., 0., 2., 0., 1.,    -0.04, 0.00,  0.4, 0.0, -0.3,  0.0, &
     &        2., 0., 2., 0., 2.,    -0.10, 0.00,  0.9, 0.0, -0.8,  0.0, &
     &        0., 0., 2., 2., 1.,    -0.05, 0.00,  0.4, 0.0, -0.4,  0.0, &
     &        0., 0., 2., 2., 2.,    -0.12, 0.00,  1.1, 0.0, -0.9,  0.0, &
     &        1., 0., 2., 0., 0.,    -0.04, 0.00,  0.3, 0.0, -0.2,  0.0, &
     &        1., 0., 2., 0., 1.,    -0.40, 0.01,  2.7, 0.1, -2.3, -0.1, &
     &        1., 0., 2., 0., 2.,    -0.98, 0.03,  6.7, 0.2, -5.7, -0.2, &
     &        3., 0., 0., 0., 0.,    -0.02, 0.00,  0.1, 0.0, -0.1,  0.0, &
     &       -1., 0., 2., 2., 1.,    -0.08, 0.00,  0.5, 0.0, -0.5,  0.0, &
     &       -1., 0., 2., 2., 2.,    -0.20, 0.00,  1.3, 0.0, -1.1,  0.0, &
     &        1., 0., 0., 2., 0.,    -0.08, 0.00,  0.5, 0.0, -0.4,  0.0, &
     &        2., 0., 2.,-2., 2.,     0.02, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        0., 1., 2., 0., 2.,     0.03, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        0., 0., 2., 0., 0.,    -0.30, 0.00,  1.4, 0.0, -1.2,  0.0, &
     &        0., 0., 2., 0., 1.,    -3.20, 0.09, 14.7, 0.4,-12.4, -0.4, &
     &        0., 0., 2., 0., 2.,    -7.73, 0.21, 35.6, 1.0,-30.0, -0.8, &
     &        2., 0., 0., 0.,-1.,     0.02, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        2., 0., 0., 0., 0.,    -0.34, 0.00,  1.5, 0.0, -1.3,  0.0, &
     &        2., 0., 0., 0., 1.,     0.02, 0.00, -0.1, 0.0,  0.1,  0.0/
      DATA X2/0.,-1., 2., 0., 2.,    -0.02, 0.00,  0.1, 0.0, -0.1,  0.0, &
     &        0., 0., 0., 2.,-1.,     0.05, 0.00, -0.2, 0.0,  0.2,  0.0, &
     &        0., 0., 0., 2., 0.,    -0.72, 0.02,  3.1, 0.1, -2.6, -0.1, &
     &        0., 0., 0., 2., 1.,    -0.05, 0.00,  0.2, 0.0, -0.2,  0.0, &
     &        0.,-1., 0., 2., 0.,    -0.05, 0.00,  0.2, 0.0, -0.2,  0.0, &
     &        1., 0., 2.,-2., 1.,     0.05, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        1., 0., 2.,-2., 2.,     0.10, 0.00, -0.3, 0.0,  0.2,  0.0, &
     &        1., 1., 0., 0., 0.,     0.04, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &       -1., 0., 2., 0., 0.,     0.05, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &       -1., 0., 2., 0., 1.,     0.18, 0.00, -0.4, 0.0,  0.3,  0.0, &
     &       -1., 0., 2., 0., 2.,     0.44, 0.00, -1.0, 0.0,  0.9,  0.0, &
     &        1., 0., 0., 0.,-1.,     0.53, 0.00, -1.2, 0.0,  1.0,  0.0, &
     &        1., 0., 0., 0., 0.,    -8.33, 0.12, 19.0, 0.3,-16.0, -0.2, &
     &        1., 0., 0., 0., 1.,     0.54, 0.00, -1.2, 0.0,  1.0,  0.0, &
     &        0., 0., 0., 1., 0.,     0.05, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        1.,-1., 0., 0., 0.,    -0.06, 0.00,  0.1, 0.0, -0.1,  0.0, &
     &       -1., 0., 0., 2.,-1.,     0.12, 0.00, -0.2, 0.0,  0.2,  0.0, &
     &       -1., 0., 0., 2., 0.,    -1.84, 0.02,  3.6, 0.0, -3.0,  0.0, &
     &       -1., 0., 0., 2., 1.,     0.13, 0.00, -0.3, 0.0,  0.2,  0.0, &
     &        1., 0.,-2., 2.,-1.,     0.02, 0.00,  0.0, 0.0,  0.0,  0.0/
      DATA X3/-1.,-1.,0., 2., 0.,    -0.09, 0.00,  0.2, 0.0, -0.1,  0.0, &
     &        0., 2., 2.,-2., 2.,    -0.06, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        0., 1., 2.,-2., 1.,     0.03, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        0., 1., 2.,-2., 2.,    -1.88, 0.00,  1.0, 0.0, -0.8,  0.0, &
     &        0., 0., 2.,-2., 0.,     0.25, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        0., 0., 2.,-2., 1.,     1.17, 0.00, -0.4, 0.0,  0.3,  0.0, &
     &        0., 0., 2.,-2., 2.,   -48.84, 0.11, 16.8, 0.0,-14.2,  0.0, &
     &        0., 2., 0., 0., 0.,    -0.19, 0.00,  0.1, 0.0, -0.1,  0.0, &
     &        2., 0., 0.,-2.,-1.,     0.05, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        2., 0., 0.,-2., 0.,    -0.55, 0.00,  0.2, 0.0, -0.1,  0.0, &
     &        2., 0., 0.,-2., 1.,     0.04, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        0.,-1., 2.,-2., 1.,    -0.05, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        0., 1., 0., 0.,-1.,     0.09, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        0.,-1., 2.,-2., 2.,     0.83, 0.00, -0.1, 0.0,  0.1,  0.0, &
     &        0., 1., 0., 0., 0.,   -15.55, 0.02,  2.6, 0.0, -2.2,  0.0, &
     &        0., 1., 0., 0., 1.,    -0.14, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        1., 0., 0.,-1., 0.,     0.03, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &        2., 0.,-2., 0., 0.,    -0.14, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &       -2., 0., 2., 0., 1.,     0.42, 0.00,  0.0, 0.0,  0.0,  0.0, &
     &       -1., 1., 0., 1., 0.,     0.04, 0.00,  0.0, 0.0,  0.0,  0.0/
      DATA X4/0., 0., 0., 0., 2.,     7.90, 0.00,  0.1, 0.0, -0.1,  0.0, &
     &        0., 0., 0., 0., 1., -1637.68,-0.10,-10.4, 0.0,  8.8,  0.0/
!       X4(18) corrected, old value +0.10, new value -0.10
!    /        0., 0., 0., 0., 1., -1637.68, 0.10,-10.4, 0.0,  8.8,  0.0/
!
!***********************************************************************
!
      DUT    = 0.0D+0
      DLOD   = 0.0D+0
      DOMEGA = 0.0D+0
!
!     Sum zonal tide terms
!
      DO 10 I=1,N
!   Formation of multiples of arguments
      ARG = XS(1,I)*fa2k(1) + XS(2,I)*fa2k(2) + XS(3,I)*fa2k(3) &
     &    + XS(4,I)*fa2k(4) + XS(5,I)*fa2k(5)
      ARG = DMOD(ARG,1296000.0D0) * CONVDS
!   First derivative
      ARG_DOT = XS(1,I)*fad2k(1)  + XS(2,I)*fad2k(2) + XS(3,I)*fad2k(3) &
     &    + XS(4,I)*fad2k(4) + XS(5,I)*fad2k(5)
!     Evaluate zonal tidal terms
      DUT    = XS(6,I)*DSIN(ARG) + XS(7,I)*DCOS(ARG) + DUT
      DLOD   = ( XS(6,I)*DCOS(ARG) - XS(7,I)*DSIN(ARG) )*ARG_DOT + DLOD
   10 CONTINUE
      DUT    = DUT    * 1.0D-4
      DLOD   = -DLOD * 1.0D-4 / (3.6525D+4 / CONVDS)
      DOMEGA = -DLOD * TWOPI / SECDAY**2
!
!     Check for debug output.
      IF (KUT1D .ne. 1) GO TO 600
      WRITE(6,9)
    9 FORMAT(1X,"Debug output for subroutine UT1SZT")
!     WRITE(6,9200) L,LP,F,D,OM,ARG,DUT,DLOD,DOMEGA
 9200 FORMAT(1X,"L = ",D30.16,/,1X,"LP = ",D30.16,/, &
     &       1X,"F = ",D30.16,/,1X,"D = ",D30.16,/, &
     &       1X,"OM = ",D30.16,/,1X,"ARG = ",D30.16,/, &
     &       1X,"DUT = ",D30.16,/,1X,"DLOD = ",D30.16,/, &
     &       1X,"DOMEGA = ",D30.16)
  600 CONTINUE
!
      RETURN
      END
!
!*************************************************************************
      SUBROUTINE UT1S2K (FA2K, FAD2K, DUT, DLOD, DOMEGA)
      IMPLICIT None
!
!     Purpose: This subroutine evaluates the effects of zonal Earth tides on
!     the rotation of the Earth. The model used is from Defraigne and Smits,
!     1999, as recommended by the IERS Conventions (2003).
!
!     Input Variables:
!          fa(5)  = Fundamental arguments from subroutine NUTFA (arcseconds)
!          fad(5) = Time derivatives of fundamental arguments (arcsec/century)
!     Output Variables:
!          DUT    - 'UT1 minus UT1S'. Effect on UT (Subtract from observation,
!                   add to IERS UT1). (sec)
!          DLOD   = Effect on length of day. (seconds).
!          DOMEGA = Effect on rotational speed (radians/second).
!
!     Written by:
!       Brian J. Luzum     92.08.11
!     Modifications:
!       Brent A. Archinal  92.08.27  Name changed from zontids to
!                                    ut1szt, N dropped from argument
!                                    list, comments improved.
!       "     "  "         92.10.27  Special note added above.
!       "     "  "         92.12.17  All real variables set to double
!                                    precision, at Jim Ray's suggestion
!                                    (email of 92.11.20).
!       David Gordon       93.03.17  Array X changed to XS, debug printout
!                                    added for calc 8.0.
!       Norbert Zacharias  93.09.16  Take fundam. arg. from subr. NUTFA
!       David Gordon       94.04.06  Changed to 'Implicit None'.
!       David Gordon       98.01.21  Extensive mods from John Gipson to use
!                                    the series expansion of DUT to calculate
!                                    DUT, DLOD, and DOMEGA instead of seperate
!                                    series expansions. fad(5) added to
!                                    subroutine call. DBLE's removed. CMATH
!                                    common block added. Variable SECCON
!                                    removed and replaced with 1/CONVDS. Sign
!                                    of X(7,62) corrected.
!       David Gordon  2003.11.24     Name changed to UT1S2K, modified for
!                                    Defraigne and Smits (1999) model, as
!                                    recommended in IERS Conventions (2003).
!
      REAL*8 DUT, DLOD, DOMEGA, ARG
      REAL*8 FA2K(14), FAD2K(14), ARG_DOT
      Integer*4 N, I
      REAL*8 XS(11,62), X1(220), X2(220), X3(220), X4(22)
      EQUIVALENCE(XS(1,  1),X1(1))
      EQUIVALENCE(XS(1, 21),X2(1))
      EQUIVALENCE(XS(1, 41),X3(1))
      EQUIVALENCE(XS(1, 61),X4(1))
!
      INCLUDE 'ccon.i'
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          Variables 'from':
!            1. SECDAY -  The number of seconds in a day. (s/day)
!            2. TWOPI  -  PI times 2.0D0
!            3. CONVDS -  THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!
!  N=Number of tidal terms to be used (62 for full set).
      DATA  N/62/
!
!***********************************************************************
!     Table of multiples of arguments and coefficients
!
!                  Multiple of            DUT        DLOD      DOMEGA
!             l   l'  F   D OMEGA     sin   cos    cos  sin   cos   sin
      DATA X1/1., 0., 2., 2., 2.,   -0.02, 0.00, 0.26, 0.00, -0.22, .00, &
     &        2., 0., 2., 0., 1.,   -0.04, 0.00, 0.38, 0.00, -0.32, .00, &
     &        2., 0., 2., 0., 2.,   -0.10, 0.00, 0.91, 0.00, -0.76, .00, &
     &        0., 0., 2., 2., 1.,   -0.05, 0.00, 0.45, 0.00, -0.38, .00, &
     &        0., 0., 2., 2., 2.,   -0.12, 0.00, 1.09, 0.01, -0.92,-.01, &
!
     &        1., 0., 2., 0., 0.,   -0.04, 0.00, 0.27, 0.00, -0.22, .0 , &
     &        1., 0., 2., 0., 1.,   -0.40, 0.00, 2.84, 0.02, -2.40,-.01, &
     &        1., 0., 2., 0., 2.,   -1.00, 0.01, 6.85, 0.04, -5.78,-.03, &
     &        3., 0., 0., 0., 0.,   -0.02, 0.00, 0.12, 0.00, -0.11, .00, &
     &       -1., 0., 2., 2., 1.,   -0.08, 0.00, 0.54, 0.00, -0.46, .00, &
!
     &       -1., 0., 2., 2., 2.,   -0.20, 0.00, 1.30, 0.01, -1.10,-.01, &
     &        1., 0., 0., 2., 0.,   -0.08, 0.00, 0.50, 0.00, -0.42, .00, &
     &        2., 0., 2.,-2., 2.,    0.02, 0.00,-0.11, 0.00,  0.09, .00, &
     &        0., 1., 2., 0., 2.,    0.03, 0.00,-0.12, 0.00,  0.10, .00, &
     &        0., 0., 2., 0., 0.,   -0.30, 0.00, 1.39, 0.01, -1.17,-.01, &
!
     &        0., 0., 2., 0., 1.,   -3.22, 0.02,14.86, 0.09,-12.54,-.08, &
     &        0., 0., 2., 0., 2.,   -7.79, 0.05,35.84, 0.22,-30.25,-.18, &
     &        2., 0., 0., 0.,-1.,    0.02, 0.00,-0.10, 0.00,  0.08, .00, &
     &        2., 0., 0., 0., 0.,   -0.34, 0.00, 1.55, 0.01, -1.31,-.01, &
     &        2., 0., 0., 0., 1.,    0.02, 0.00,-0.08, 0.00,  0.07, .00/
!
      DATA X2/0.,-1., 2., 0., 2.,   -0.02, 0.00, 0.11, 0.00, -0.09, .00, &
     &        0., 0., 0., 2.,-1.,    0.05, 0.00,-0.20, 0.00,  0.17, .00, &
     &        0., 0., 0., 2., 0.,   -0.74, 0.00, 3.14, 0.02, -2.65,-.02, &
     &        0., 0., 0., 2., 1.,   -0.05, 0.00, 0.22, 0.00, -0.19, .00, &
     &        0.,-1., 0., 2., 0.,   -0.05, 0.00, 0.21, 0.00, -0.17, .00, &
!
     &        1., 0., 2.,-2., 1.,    0.05, 0.00,-0.13, 0.00,  0.11, .00, &
     &        1., 0., 2.,-2., 2.,    0.10, 0.00,-0.26, 0.00,  0.22, .00, &
     &        1., 1., 0., 0., 0.,    0.04, 0.00,-0.10, 0.00,  0.08, .00, &
     &       -1., 0., 2., 0., 0.,    0.05, 0.00,-0.11, 0.00,  0.09, .00, &
     &       -1., 0., 2., 0., 1.,    0.18, 0.00,-0.41, 0.00,  0.35, .00, &
!
     &       -1., 0., 2., 0., 2.,    0.44, 0.00,-1.02,-0.01,  0.86, .01, &
     &        1., 0., 0., 0.,-1.,    0.54, 0.00,-1.23,-0.01,  1.04, .01, &
     &        1., 0., 0., 0., 0.,   -8.33, 0.06,18.99, 0.13,-16.03,-.11, &
     &        1., 0., 0., 0., 1.,    0.55, 0.00,-1.25,-0.01,  1.05, .01, &
     &        0., 0., 0., 1., 0.,    0.05, 0.00,-0.11, 0.00,  0.09, .00, &
!
     &        1.,-1., 0., 0., 0.,   -0.06, 0.00, 0.12, 0.00, -0.10, .00, &
     &       -1., 0., 0., 2.,-1.,    0.12, 0.00,-0.24, 0.00,  0.20, .00, &
     &       -1., 0., 0., 2., 0.,   -1.84, 0.01, 3.63, 0.02, -3.07,-.02, &
     &       -1., 0., 0., 2., 1.,    0.13, 0.00,-0.26, 0.00,  0.22, .00, &
     &        1., 0.,-2., 2.,-1.,    0.02, 0.00,-0.04, 0.00,  0.03, .03/
!
      DATA X3/-1.,-1.,0., 2., 0.,   -0.09, 0.00, 0.16, 0.00, -0.13, .00, &
     &        0., 2., 2.,-2., 2.,   -0.06, 0.00, 0.04, 0.00, -0.03, .00, &
     &        0., 1., 2.,-2., 1.,    0.03, 0.00,-0.02, 0.00,  0.01, .00, &
     &        0., 1., 2.,-2., 2.,   -1.91, 0.02, 0.98, 0.01, -0.83,-.01, &
     &        0., 0., 2.,-2., 0.,    0.26, 0.00,-0.09, 0.00,  0.08, .00, &
!
     &        0., 0., 2.,-2., 1.,    1.18,-0.01,-0.42, 0.00,  0.35, .00, &
     &        0., 0., 2.,-2., 2.,  -49.06, 0.43,16.88, 0.15,-14.25,-.13, &
     &        0., 2., 0., 0., 0.,   -0.20, 0.00, 0.07, 0.00, -0.06, .00, &
     &        2., 0., 0.,-2.,-1.,    0.05, 0.00,-0.02, 0.00,  0.01, .00, &
     &        2., 0., 0.,-2., 0.,   -0.56, 0.01, 0.17, 0.00, -0.14, .00, &
!
     &        2., 0., 0.,-2., 1.,    0.04, 0.00,-0.01, 0.00,  0.01, .00, &
     &        0.,-1., 2.,-2., 1.,   -0.05, 0.00, 0.01, 0.00, -0.01, .00, &
     &        0., 1., 0., 0.,-1.,    0.09, 0.00,-0.02, 0.00,  0.01, .00, &
     &        0.,-1., 2.,-2., 2.,    0.82,-0.01,-0.14, 0.00,  0.12, .00, &
     &        0., 1., 0., 0., 0.,  -15.65, 0.15, 2.69, 0.03, -2.27,-.02, &
!
     &        0., 1., 0., 0., 1.,   -0.14, 0.00, 0.02, 0.00, -0.02, .00, &
     &        1., 0., 0.,-1., 0.,    0.03, 0.00, 0.00, 0.00,  0.0 , .00, &
     &        2., 0.,-2., 0., 0.,   -0.14, 0.00,-0.01, 0.00,  0.01, .00, &
     &       -2., 0., 2., 0., 1.,    0.43,-0.01,-0.02, 0.00,  0.02, .00, &
     &       -1., 1., 0., 1., 0.,   -0.04, 0.00, 0.00, 0.00,  0.00, .00/
!
      DATA X4/0., 0., 0., 0., 2.,    8.20, 0.11, 0.15, 0.00, -0.13, .00, &
     &        0., 0., 0., 0., 1.,-1689.54,-25.04,-15.62,0.23,13.18,-.20/
!
!***********************************************************************
!
      DUT    = 0.0D+0
      DLOD   = 0.0D+0
      DOMEGA = 0.0D+0
!
!     Sum zonal tide terms
!
      DO 10 I=1,N
!   Formation of multiples of arguments
      ARG = XS(1,I)*FA2K(1) + XS(2,I)*FA2K(2) + XS(3,I)*FA2K(3) &
     &    + XS(4,I)*FA2K(4) + XS(5,I)*FA2K(5)
!!!   ARG = DMOD(ARG,1296000.0D0) * CONVDS
!  Already in radians!!!
      ARG = DMOD(ARG,1296000.0D0)
!   First derivative
      ARG_DOT = XS(1,I)*FAD2K(1)  + XS(2,I)*FAD2K(2) + XS(3,I)*FAD2K(3) &
     &    + XS(4,I)*FAD2K(4) + XS(5,I)*FAD2K(5)
! convert from radians/sec to arcsec/century
      ARG_DOT = ARG_DOT*(SECDAY*36525.D0)/CONVDS
!
!     Evaluate zonal tidal terms
      DUT    = XS(6,I)*DSIN(ARG) + XS(7,I)*DCOS(ARG) + DUT
      DLOD   = ( XS(6,I)*DCOS(ARG) - XS(7,I)*DSIN(ARG) )*ARG_DOT + DLOD
   10 CONTINUE
      DUT    = DUT    * 1.0D-4
      DLOD   = -DLOD * 1.0D-4 / (3.6525D+4 / CONVDS)
      DOMEGA = -DLOD * TWOPI / SECDAY**2
!
!     Check for debug output.
      IF (KUT1D .ne. 1) GO TO 600
!     WRITE(6,9)
    9 FORMAT(1X,"Debug output for subroutine UT1S2K")
!     WRITE(6,9200) L,LP,F,D,OM,ARG,DUT,DLOD,DOMEGA
 9200 FORMAT(1X,"L = ",D30.16,/,1X,"LP = ",D30.16,/, &
     &       1X,"F = ",D30.16,/,1X,"D = ",D30.16,/, &
     &       1X,"OM = ",D30.16,/,1X,"ARG = ",D30.16,/, &
     &       1X,"DUT = ",D30.16,/,1X,"DLOD = ",D30.16,/, &
     &       1X,"DOMEGA = ",D30.16)
  600 CONTINUE
!
      RETURN
      END
!*************************************************************************
!
      INTEGER*4 function get_leapsec(xjd,xleap)
      Implicit None
!
!     Routine to retrieve "leapsecond" (UTC step adjustment)
!     information for given date from default "leapsecond" file.
!     Passes back a five-element array of "leapsecond" information for
!     the given "xjd" (full) Julian date:
!
!       Position   Description
!       ---------------------------
!          1       Julian date just following step adjustment (always
!                  midnight).
!          2       The "leapsecond", i.e. TAI-UTC (seconds).
!          3       Epoch of rate of change (MJD days).
!          4       Rate of change of leapsecond (seconds/day).
!          5       Julian date just following next step adjustment.
!
!     Programmer:
!       Gregg Cooke      90.02.12  Creation.
!     Modifcations:
!       Gregg Cooke      90.03.30  Returns date following next
!                                  "leapsecond" as new fifth element
!                                  of xleap.  Also removed lpnam.
!       Kaybee Wilcox    92.04.23  Parameters obtained from param.i.
!       Brent Archinal   92.12.22  "getunit" properly used.  Many
!                                  other fixes made.  EOF Error return
!                                  fixed to only occur on first read
!                                  (wasn't working at all).  EOF on
!                                  later read okay, but properly handled.
!       D. Gordon        98.05.01  Added to Calc UT1 module.
!
!     Error  Returns:
!       >0   FORTRAN file I/O error.
!     -1201  Requested data is before first "leapsecond" in file.
!     -1301  No data found in "leapsecond" file (EOF on first read).
!
      INCLUDE 'param11.i'
!
!     Specifications:
!
!     LPDCB   --  Unit number of "leapsecond" file.
!     XLEAPR  --  Current "leapsecond" entry read from file.
!     BIGDT   --  Arbitrarily large Julian Date.
!
      Integer*4 get4unit
      Integer*4 k, i
      Integer*4 lpdcb, ierr
      Real*8 xjd, xleap(5), xleapr(4), bigdt
      Save lpdcb,bigdt
      Data lpdcb / 0 /, bigdt/1.D+99/
!
!     Program Structure:
!
!     Initialize the routine.  Get a unit number from get4unit. Then
!     open the "leapsecond" file.
!
      k = 0
      ierr = 0
      do i = 1,4
        xleapr(i) = 0.D0
        enddo
      xleap(5) = 0.D0
      get_leapsec = 0
      if(lpdcb.le.0) lpdcb = get4unit()
      open(UNIT=lpdcb,FILE=DFLEAP,STATUS='Old',IOSTAT=ierr)
      IF ( IERR .NE. 0 ) THEN
           WRITE ( 6, '(A)' ) 'Error in opening leap second file '//DFLEAP
           CALL TERMINATE_CALC ( 'get_leapsec', int2(0), int2(0) )
      END IF
!
!     Read through the file until the target date is passed.  Then
!     return with date just following the "leapsecond and the
!     "leapsecond" information.  Remember to save each record -- the
!     "leapsecond" record information BEFORE the target
!     date is really the one we want.
!
      do while(xjd.ge.xleapr(1) .and. ierr.eq.0)
         k = k + 1
         do i = 1, 4
            xleap(i) = xleapr(i)
         enddo
         read(lpdcb,'(17X,F9.1,12X,F10.7,12X,F6.0,4X,F9.7,1X)', &
     &        IOSTAT=ierr,END=800) xleapr
         IF ( IERR > 0 ) THEN
              WRITE ( 6, '(A)' ) 'Error in reading leap second file '//DFLEAP
              CALL TERMINATE_CALC ( 'get_leapsec', int2(0), int2(0) )
          END IF
      enddo
!
!     EOF and Error returns come here...
!     Set error if the target date was before the bounds of the
!     "leapsecond" file.  Also, send back the date of the next
!     "leapsecond".
!
  800 continue
      if(ierr.eq.-1) then
        xleapr(1) = bigdt
        if(k.ne.1) ierr = 0
        endif
  911 continue
      close(lpdcb)
      get_leapsec = ierr
      if (xjd.lt.xleapr(1) .and. k.eq.1) get_leapsec = -1201
      if (ierr.eq.-1) get_leapsec = -1301
      if (get_leapsec.eq.0) xleap(5) = xleapr(1)
      return
      end
!
!***********************************************************************
      SUBROUTINE spline(xa,ya,n,yp1,ypn,y2,ierr4)
      Implicit none
!
!     Subroutine spline is the initialization section of a two subroutine
!     module used to do cubic spline interpolations. Spline is called each
!     time you change to a new set of tabular points. Subroutine splint4
!     is the second half and does the actual interpolation.
!
!     Given arrays xa(i), and ya(i) for i=1 to n containing a tabulated
!     function ya(i) = f(xa(i)) with xa(1) < xa(2) <..< xa(n) and values
!     yp1 and ypn whichc are the first derivatives of the function f( ) at
!     points 1 and n, respectively, this routine returns an array
!     y2(i) for i=1 to n which contains the second derivatives of the
!     function f( ) at the tabulated points xa(i). If yp1 and/or ypn are
!     greater than or equal to 1.d30, the routine is signaled to set the
!     corresponding boundary condition for a natural spline, with zero
!     second derivatives on the boundary.
!
!     The cubic spline has the following properties.
!     1) It is continuous and exactly fits at the tabular values.
!     2) The first and second derivatives are everywhere continuous,
!        even at the tabular points when points are added to and
!        deleted from the set of five points used to interpolate.
!     3) The third derivative is not continuous, but rather a series
!        of disconnected constant values.
!     4) The fourth derivative is zero.
!     5) It requires a minimum of five points and values of the first
!        derivative at the two endpoints.
!
!     In order to guarantee that this routine is only used in the modes in
!     which it has been tested, we require that the values of xa be exactly
!     one unit apart.
!
!  References:  'Numerical Recipes in FORTRAN, 2nd Edition' page 109-110.
!
!  Calling sequence -
!
!     Input Variables:
!       1. xa(n) - Array of tabular (time) values corresponding to the ya
!                  array. The xa's must be evenly spaced.
!       2. ya(n) - Array of EOP values at the times corresponding to those
!                  in the xa array. i.e. ya(i) = f(xa(i)).
!       3. n     - Number of points in the xa and ya arrays.
!       4. yp1   - First derivative of the EOP function at the point i=1.
!       5. ypn   - First derivative of the EOP function at the point i=n.
!
!     Output variables:
!       1. y2(n) - Array containing the second derivatives of the
!                   interpolating function at the tabular points xa(i).
!       2. ierr4 - Error return code (0=good, 1=bad)
!
      INTEGER*4 n,NMAX,ierr4
      REAL*8 yp1,ypn,xa(20),ya(20),y2(20)
      PARAMETER (NMAX=25)
      INTEGER*4 i,k
      REAL*8 p,qn,sig,un,u(NMAX)
!
!  Program variables:
!       1. NMAX    - The largest anticipated value of n.
!       2. p       -
!       3. qn      -
!       4. sig     -
!       5. un      -
!       6. u(NMAX) -
!
!  Programmer:
!     93.11.22  Jim Ryan     - Initial coding and modification for Calc.
!     93.12.07  David Gordon - Make variables same as in subroutine splint4,
!                              Calc-like documentation inserted.
!
!  SPLINE program structure:
!
!  Verify that the values of xa are one unit apart.
      do i = 2,n
        If(dabs(xa(i)-xa(i-1)-1.d0) .gt. 1.d-8) then
!        pause 'spline: independent variable NOT one unit apart!'
         write(6,'("spline: independent variable NOT one unit apart!")')
         write(6,'("spline: i, xa(i), xa(i-1), diff",i5,3d20.15)')     &
     &    i, xa(i), xa(i-1),(xa(i)-xa(i-1))
         ierr4 = 1
         Stop
         return
        else
          ierr4 = 0
        endif
      enddo
!
!  Set lower boundary condition to be "natural" or else to have a specified
!  first derivative.
      if (yp1 .gt. .99e30) then
        y2(1)=0.
        u(1)=0.
      else
        y2(1)=-0.5
        u(1)=(3./(xa(2)-xa(1)))*((ya(2)-ya(1))/(xa(2)-xa(1))-yp1)
      endif
!
!  Decomposition loop of the tridiagonal algorithm. y2 and u used for temporary
!  storage of the decomposed factors.
      do 11 i=2,n-1
        sig=(xa(i)-xa(i-1))/(xa(i+1)-xa(i-1))
        p=sig*y2(i-1)+2.
        y2(i)=(sig-1.)/p
        u(i)=(6.*((ya(i+1)-ya(i))/(xa(i+1)-xa(i))- &
     &       (ya(i)-ya(i-1))/(xa(i)-xa(i-1)))/(xa(i+1)-xa(i-1))- &
     &       sig*u(i-1))/p
  11  continue
!
!  Set upper boundary condition to be "natural" or else to have a specified
!  first derivative.
      if (ypn .gt. .99e30) then
        qn=0.
        un=0.
      else
        qn=0.5
        un=(3./(xa(n)-xa(n-1)))*(ypn-(ya(n)-ya(n-1))/(xa(n)-xa(n-1)))
      endif
!
      y2(n)=(un-qn*u(n-1))/(qn*y2(n-1)+1.)
!
!  Backsubstitution loop of the tridiagonal algorithm.
      do 12 k=n-1,1,-1
        y2(k)=y2(k)*y2(k+1)+u(k)
  12  continue
!
      return
      END
!***********************************************************************
      SUBROUTINE splint4(xa,ya,y2,n,x,y,ydot,ydot2,ydot3,ierr4)
      Implicit none
!
!     Given the arrays xa(i) and ya(i) for i = 1 to n, which tabulate
!     a function with the xa(i)'s in time order, and given the array
!     y2(i), which is the previous output of subroutine spline, and
!     given a value of x, this routine returns the cubic spline
!     interpolated value of y and its first three derivatives.
!
!  References: 'Numerical Recipes in FORTRAN, 2nd Edition' page 109-110.
!
!  Calling sequence -
!
!     Input Variables:
!       1. xa(n) - Array of tabular (time) values corresponding to the ya
!                  array. The xa's must be evenly spaced.
!       2. ya(n) - Array of EOP values at the times corresponding to those
!                  in the xa array. i.e. ya(i) = f(xa(i)).
!       3. y2(n) - Array containing the second derivatives of the
!                  interpolating function at the tabular points xa(i).
!       4. n     - Number of points in the xa and ya arrays.
!       5. x     - Input time for which the corresponding interpolated value
!                  of y (= f(x)) is to be determined.
!
!     Output variables:
!       1. y     - The interpolated value.
!       2. ydot  - The 1st derivative of the interpolated value.
!       3. ydot2 - The 2nd derivative of the interpolated value.
!       4. ydot3 - The 3rd derivative of the interpolated value.
!       5. ierr4 - Error return code (0=good, 1=bad)
!
      INTEGER*4 n, ierr4
      REAL*8 x,y,xa(20),y2(20),ya(20),ydot,ydot2,ydot3
      INTEGER*4 k,khi,klo
      REAL*8 a,b,h,adot,bdot
!
!  Program variables - klo, khi, k, h, a, b, adot, bdot
!
!  Programmer:
!     93.11.22  Jim Ryan     - Initial coding and modification for Calc.
!                              First, second, and third derivatives added.
!     93.12.07  David Gordon - Make variables same as in subroutine spline,
!                              Calc-like documentation inserted.
!
!  SPLINT4 program structure:
!
!  Find right place in table by means of bisection. Optimized for sequential
!   calls being at random values of x.
      klo=1
      khi=n
1     if (khi-klo.gt.1) then
        k=(khi+klo)/2
        if(xa(k) .gt. x)then
          khi=k
        else
          klo=k
        endif
      go to 1
      endif
!
!  Make sure the xa's aren't the same values.
      h=xa(khi)-xa(klo)
      if (h.eq.0.) then
        write(6,'(" Bad xa input in splint4 ")')
        ierr4 = 1
      else
        ierr4 = 0
      endif
!
!  Evaluate cubic spline polynomial
      a=(xa(khi)-x)/h
      b=(x-xa(klo))/h
      y=a*ya(klo)+b*ya(khi)+((a**3-a)*y2(klo)+(b**3-b)*y2(khi))* &
     &  (h**2)/6.
!
!  First derivative
      adot = -1.d0/h
      bdot =  1.d0/h
      ydot = adot*ya(klo)+bdot*ya(khi) &
     &       +( (3.d0*a**2-1.d0)*adot*y2(klo) &
     &       +  (3.d0*b**2-1.d0)*bdot*y2(khi))*(h**2/6.d0)
!
!  Second derivative.
      ydot2 = (a*(adot**2)*y2(klo)+b*(bdot**2)*y2(khi))*(h**2)
!
!  Third derivative.
      ydot3 = ((adot**3)*y2(klo)+(bdot**3)*y2(khi))*(h**2)
!
      return
      END
!
!**************************************************************************
      SUBROUTINE UT1_LIB (GMST2K, FA2K, FAD2K, UT1li, dUT1li)
      IMPLICIT None
!
!     Input Variables:
!          GMST2K(2) = Greenwich mean siderial time and its first time
!                      derivative (radians, radians/sec)
!          FA2K(14)  = Fundamental arguments from subroutine NUTFA (radians)
!          FAD2K(14) = Time derivatives of fundamental arguments (rad/sec)
!     Output Variables:
!          Ut1li  = Short term libration correction to UT1 (milli-sec)
!          dUt1li = Time derivative of short term libration correction to 
!                UT1 (milli-sec/sec)
!
      REAL*8 GMST2K(2), UT1li, dUT1li, LODli, dLODli 
      REAL*8 L, LP, fa(5), fad(5), ARG, dARG
      Integer*4 N, I
      REAL*8 XS(10,11), X1(110)
      EQUIVALENCE(XS(1,1),X1(1))
      INCLUDE 'ccon.i'
!
      REAL*8 FA2K(14), FAD2K(14)
!     COMMON / NFA2K / FA2K, FAD2K
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!          Variables 'from':
!            1. SECDAY -  The number of seconds in a day. (s/day)
!            2. TWOPI  -  PI times 2.0D0
!            3. CONVDS -  THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!  N=Number of tidal terms to be used (10 for full set).
!  (This was an argument in the original zontids routine.)
      DATA  N/11/
!
!***********************************************************************
!     Short period UT1 libration terms
!     From Table 5.1b, IERS Conventions (2010)
!
!                  Multiple of               UT1           LOD
!          l    l'   F    D   OMEGA Chi   sin    cos    sin    cos
      DATA X1/                                                          &
     &    -2.,  0., -2.,  0., -2.,  2.,  0.05, -0.03,  -0.3,  -0.6,     &
     &     0.,  0., -2., -2., -2.,  2.,  0.06, -0.03,  -0.4,  -0.7,     &
     &    -1.,  0., -2.,  0., -2.,  2.,  0.35, -0.20,  -2.4,  -4.1,     &
     &     1.,  0., -2., -2., -2.,  2.,  0.07, -0.04,  -0.5,  -0.8,     &
     &     0.,  0., -2.,  0., -1.,  2., -0.07,  0.04,   0.5,   0.8,     &
     &     0.,  0., -2.,  0., -2.,  2.,  1.75, -1.01, -12.2, -21.3,     &
     &     1.,  0., -2.,  0., -2.,  2., -0.05,  0.03,   0.3,   0.6,     &
     &     0., -1., -2.,  2., -2.,  2.,  0.04, -0.03,  -0.3,  -0.6,     &
     &     0.,  0., -2.,  2., -2.,  2.,  0.76, -0.44,  -5.5,  -9.6,     &
     &     0.,  0.,  0.,  0.,  0.,  2.,  0.21, -0.12,  -1.5,  -2.6,     &
     &     0.,  0.,  0.,  0., -1.,  2.,  0.06, -0.04,  -0.4,  -0.8/
!
!
      UT1li  = 0.0D+0
      dUT1li = 0.0D+0
      LODli  = 0.0D+0
      dLODli = 0.0D+0
!
!     Sum zonal tide terms
!
      DO 10 I=1, N
!   Formation of multiples of arguments
      ARG = XS(1,I)*FA2K(1) + XS(2,I)*FA2K(2) + XS(3,I)*FA2K(3) &
     &    + XS(4,I)*FA2K(4) + XS(5,I)*FA2K(5) + XS(6,I)*(GMST2K(1)+PI)
      ARG = DMOD(ARG,TWOPI)
!     ARG = DMOD(ARG,1296000.0D0) * CONVDS
!   First derivative
      dARG = XS(1,I)*FAD2K(1) + XS(2,I)*FAD2K(2) + XS(3,I)*FAD2K(3) &
     &     + XS(4,I)*FAD2K(4) + XS(5,I)*FAD2K(5) + XS(6,I)*(GMST2K(2))
!
!   Evaluate zonal tidal terms (micro-arcsec)
      UT1li  = XS(7,I)*DSIN(ARG) +  XS(8,I)*DCOS(ARG) + UT1li
      LODli  = XS(9,I)*DSIN(ARG) + XS(10,I)*DCOS(ARG) + LODli
      dUT1li = XS(7,I)*DCOS(ARG)*dARG - XS(8,I)*DSIN(ARG)*dARG + dUT1li
      dLODli = XS(9,I)*DCOS(ARG)*dARG - XS(10,I)*DSIN(ARG)*dARG + dLODli
   10 CONTINUE
!
!  Change from micro-secs to milli-secs
      UT1li  =  UT1li*1.0D-3
      LODli  =  LODli*1.0D-3
      dUT1li = dUT1li*1.0D-3
      dLODli = dLODli*1.0D-3
!
!       print *, ' UT1LIB: UT1li =  ', UT1li 
!       print *, ' UT1LIB: dUT1li = ', dUT1li 
!       print *, ' UT1LIB: LODli =  ', LODli 
!       print *, ' UT1LIB: dLODli = ', dLODli 
!
      RETURN
      END
!
!***********************************************************************
!
      SUBROUTINE splyne(xa,ya,n,yp1,ypn,y2,ierr4)
      Implicit none
!
!     Subroutine spline is the initialization section of a two subroutine
!     module used to do cubic spline interpolations. Spline is called each
!     time you change to a new set of tabular points. Subroutine splint4
!     is the second half and does the actual interpolation.
!
!     Given arrays xa(i), and ya(i) for i=1 to n containing a tabulated
!     function ya(i) = f(xa(i)) with xa(1) < xa(2) <..< xa(n) and values
!     yp1 and ypn whichc are the first derivatives of the function f( ) at
!     points 1 and n, respectively, this routine returns an array
!     y2(i) for i=1 to n which contains the second derivatives of the
!     function f( ) at the tabulated points xa(i). If yp1 and/or ypn are
!     greater than or equal to 1.d30, the routine is signaled to set the
!     corresponding boundary condition for a natural spline, with zero
!     second derivatives on the boundary.
!
!     The cubic spline has the following properties.
!     1) It is continuous and exactly fits at the tabular values.
!     2) The first and second derivatives are everywhere continuous,
!        even at the tabular points when points are added to and
!        deleted from the set of five points used to interpolate.
!     3) The third derivative is not continuous, but rather a series
!        of disconnected constant values.
!     4) The fourth derivative is zero.
!     5) It requires a minimum of five points and values of the first
!        derivative at the two endpoints.
!
!     In order to guarantee that this routine is only used in the modes in
!     which it has been tested, we require that the values of xa be exactly
!     one unit apart.
!
!  References:  'Numerical Recipes in FORTRAN, 2nd Edition' page 109-110.
!
!  Calling sequence -
!
!     Input Variables:
!       1. xa(n) - Array of tabular (time) values corresponding to the ya
!                  array. The xa's must be evenly spaced.
!       2. ya(n) - Array of EOP values at the times corresponding to those
!                  in the xa array. i.e. ya(i) = f(xa(i)).
!       3. n     - Number of points in the xa and ya arrays.
!       4. yp1   - First derivative of the EOP function at the point i=1.
!       5. ypn   - First derivative of the EOP function at the point i=n.
!
!     Output variables:
!       1. y2(n) - Array containing the second derivatives of the
!                   interpolating function at the tabular points xa(i).
!       2. ierr4 - Error return code (0=good, 1=bad)
!
!     Common blocks used -
      INCLUDE 'd_input.i'
!            Variables 'from':
!             1) NF_row - Maximum number of rows  
!
!
      INTEGER*4 n,NMAX,ierr4
      REAL*8 yp1,ypn,xa(NF_row),ya(NF_row),y2(NF_row)
      PARAMETER (NMAX=1000)
      INTEGER*4 i,k
      REAL*8 p,qn,sig,un,u(NMAX)
!
!  Program variables:
!       1. NMAX    - The largest anticipated value of n.
!       2. p       -
!       3. qn      -
!       4. sig     -
!       5. un      -
!       6. u(NMAX) -
!
!  Programmer:
!     93.11.22  Jim Ryan     - Initial coding and modification for Calc.
!     93.12.07  David Gordon - Make variables same as in subroutine splint4,
!                              Calc-like documentation inserted.
!     Jan-Apri, 2012 D. Gordon - Modified for near-field objects.
!
!  SPLINE program structure:
!
!
!  Verify that the values of xa are one unit apart.
      do i = 2,n
        If(abs(xa(i)-xa(i-1)-1.d0) .gt. 1.d-8) then
!        pause 'splyne: independent variable NOT one unit apart!'
         write(6,'("splyne: independent variable NOT one unit apart!")')
         write(6,'("splyne: i, xa(i), xa(i-1), diff",i5,3d20.15)') &
     &    i, xa(i), xa(i-1),(xa(i)-xa(i-1))
         ierr4 = 1
         Stop
         return
        else
          ierr4 = 0
        endif
      enddo
!
!  Set lower boundary condition to be "natural" or else to have a specified
!  first derivative.
      if (yp1 .gt. .99e30) then
        y2(1)=0.
        u(1)=0.
      else
        y2(1)=-0.5
        u(1)=(3./(xa(2)-xa(1)))*((ya(2)-ya(1))/(xa(2)-xa(1))-yp1)
      endif
!
!  Decomposition loop of the tridiagonal algorithm. y2 and u used for temporary
!  storage of the decomposed factors.
      do 11 i=2,n-1
        sig=(xa(i)-xa(i-1))/(xa(i+1)-xa(i-1))
        p=sig*y2(i-1)+2.
        y2(i)=(sig-1.)/p
        u(i)=(6.*((ya(i+1)-ya(i))/(xa(i+1)-xa(i))- &
     &       (ya(i)-ya(i-1))/(xa(i)-xa(i-1)))/(xa(i+1)-xa(i-1))- &
     &       sig*u(i-1))/p
  11  continue
!
!  Set upper boundary condition to be "natural" or else to have a specified
!  first derivative.
      if (ypn .gt. .99e30) then
        qn=0.
        un=0.
      else
        qn=0.5
        un=(3./(xa(n)-xa(n-1)))*(ypn-(ya(n)-ya(n-1))/(xa(n)-xa(n-1)))
      endif
!
      y2(n)=(un-qn*u(n-1))/(qn*y2(n-1)+1.)
!
!  Backsubstitution loop of the tridiagonal algorithm.
      do 12 k=n-1,1,-1
        y2(k)=y2(k)*y2(k+1)+u(k)
  12  continue
!
      return
      END
!***********************************************************************
      SUBROUTINE splynt4(xa,ya,y2,n,x,y,ydot,ydot2,ydot3,ierr4)
      Implicit none
!
!     Given the arrays xa(i) and ya(i) for i = 1 to n, which tabulate
!     a function with the xa(i)'s in time order, and given the array
!     y2(i), which is the previous output of subroutine spline, and
!     given a value of x, this routine returns the cubic spline
!     interpolated value of y and its first three derivatives.
!
!  References: 'Numerical Recipes in FORTRAN, 2nd Edition' page 109-110.
!
!  Calling sequence -
!
!     Input Variables:
!       1. xa(n) - Array of tabular (time) values corresponding to the ya
!                  array. The xa's must be evenly spaced.
!       2. ya(n) - Array of EOP values at the times corresponding to those
!                  in the xa array. i.e. ya(i) = f(xa(i)).
!       3. y2(n) - Array containing the second derivatives of the
!                  interpolating function at the tabular points xa(i).
!       4. n     - Number of points in the xa and ya arrays.
!       5. x     - Input time for which the corresponding interpolated value
!                  of y (= f(x)) is to be determined.
!
!     Output variables:
!       1. y     - The interpolated value.
!       2. ydot  - The 1st derivative of the interpolated value.
!       3. ydot2 - The 2nd derivative of the interpolated value.
!       4. ydot3 - The 3rd derivative of the interpolated value.
!       5. ierr4 - Error return code (0=good, 1=bad)
!
!     Common blocks used -
      INCLUDE 'd_input.i'
!            Variables 'from':
!             1) NF_row - Maximum number of rows  
!
!
      INTEGER*4 n, ierr4
      REAL*8 x,y,xa(NF_row),y2(NF_row),ya(NF_row),ydot,ydot2,ydot3
      INTEGER*4 k,khi,klo
      REAL*8 a,b,h,adot,bdot
!
!  Program variables - klo, khi, k, h, a, b, adot, bdot
!
!  Programmer:
!     93.11.22  Jim Ryan     - Initial coding and modification for Calc.
!                              First, second, and third derivatives added.
!     93.12.07  David Gordon - Make variables same as in subroutine spline,
!                              Calc-like documentation inserted.
!     Jan-Apri, 2012 D. Gordon - Modified for near-field objects.
!
!  SPLINT4 program structure:
!
!  Find right place in table by means of bisection. Optimized for sequential
!   calls being at random values of x.
      klo=1
      khi=n
1     if (khi-klo.gt.1) then
        k=(khi+klo)/2
        if(xa(k) .gt. x)then
          khi=k
        else
          klo=k
        endif
      go to 1
      endif
!
!  Make sure the xa's aren't the same values.
      h=xa(khi)-xa(klo)
      if (h.eq.0.) then
!       write(6,'(" Bad xa input in splynt4 ")')
        write(6,*) 'Splynt: n,x,xa(1),xa(n): ', n,x,xa(1),xa(n)
        ierr4 = 1
      else
        ierr4 = 0
      endif
!
!  Evaluate cubic spline polynomial
      a=(xa(khi)-x)/h
      b=(x-xa(klo))/h
      y=a*ya(klo)+b*ya(khi)+((a**3-a)*y2(klo)+(b**3-b)*y2(khi))* &
     &  (h**2)/6.
!
!  First derivative
      adot = -1.d0/h
      bdot =  1.d0/h
      ydot = adot*ya(klo)+bdot*ya(khi) &
     &       +( (3.d0*a**2-1.d0)*adot*y2(klo) &
     &       +  (3.d0*b**2-1.d0)*bdot*y2(khi))*(h**2/6.d0)
!
!  Second derivative.
      ydot2 = (a*(adot**2)*y2(klo)+b*(bdot**2)*y2(khi))*(h**2)
!
!  Third derivative.
      ydot3 = ((adot**3)*y2(klo)+(bdot**3)*y2(khi))*(h**2)
!
      return
      END
!
!**************************************************************************
!
      Integer*4 function get4unit()
      IMPLICIT NONE                         !Added by IMP/jwr
!
!-----The following type specification statements added automatically
!     by imp/jwr July 2002
!
      INTEGER*4 iutot
!-----END of imp added lines.
!
!
! Purpose       Returns a unique unit number for each new call.
!
! Note          It is recommended that all code should call get4unit
!               in order to obtain unit numbers.  If this is not
!               desirable, the warning message below should be
!               disabled.
!
! Modified
!   B. Archinal         92.06.19  Rewritten.  Check made if unit
!   A. Myers                      already open.  Possible range
!                                 extended to include 1-4, 8-49 as unit
!                                 numbers.  Check made to see if too
!                                 many units in use.
!   D. Gordon         2012.04.26  Changed to Integer*4, renamed get4unit.
!
      logical*4 lopen
!
!  Ipoint contains the last unit assigned.  If7 is standard error.
!  Iutot is the total number of units used (including std in, out, err).
!  Iumax is maximum number of units allowed open on this system (this
!    can be changed as a system installation parameter under HP-UX
!    8.0 as "maxfiles" in the /etc/master file).
!
      Integer*4 ipoint,if7,iumax
      Save ipoint
!
!  Somewhat arbitrarily we start with 41.
!
      Data ipoint/40/,if7/6/,iutot/3/,iumax/60/
!
  100 ipoint = ipoint+1
      iutot = iutot + 1
!
!  If 100 or 5, 6, or 7, increment appropriately.
!
      if(ipoint.eq.100) ipoint = 1
      if(ipoint.gt.4.and.ipoint.lt.8) ipoint = 8
!
!  Terminate if out of unit numbers.
!
      if(iutot.gt.iumax) then
        write(if7,"(' *** ERROR *** Get4unit: All available unit'      &
     &  ,' numbers have been opened.'/ &
     &              '               Execution terminating.'/)")
        stop
      endif
!
!  Issue warning if unit already open, then increment again.
!
      inquire(unit=ipoint,opened=lopen)
      if(lopen) then
!        write(if7,"(' *** WARNING *** get4unit has determined that unit' &
!     &  ,' number',I3/ '                 has already been opened' &
!     &  ,' elsewhere.'/'                 Proceeding with next unit' &
!     &  ,' number.'/)") ipoint
        go to 100
       endif
!
!
      get4unit = ipoint
      return
      end
      SUBROUTINE TDBminusTT (DATE1,DATE2,UT,ELONG,U,V,TDBmTT,dTDBmTT,   &
     &           CTmTT,dCTmTT)
!
!  - - - - - - - - -
!   TDBminusTT: Modified version of SOFA routine iau_DTDB, taken from
!               SOFA release 2010-12-01. SOFA is the International 
!               Astronomical Union's 'Standards of Fundamental Astronomy'
!               software collection.
!    -April 2012: Converted to Fortran90 and name changed. Modified as 
!                 needed for Calc usage.
!    -Oct.  2012: Changed to a subroutine. CTmTT will be TDB-TT at geocenter,
!  - - - - - - - - -
!
!   The following is from the original SOFA documentation:
!  An approximation to TDB-TT, the difference between barycentric
!  dynamical time and terrestrial time, for an observer on the Earth.
!
!  The different time scales - proper, coordinate and realized - are
!  related to each other:
!
!            TAI             <-  physically realized
!             :
!          offset            <-  observed (nominally +32.184s)
!             :
!            TT              <-  terrestrial time
!             :
!    rate adjustment (L_G)   <-  definition of TT
!             :
!            TCG             <-  time scale for GCRS
!             :
!      "periodic" terms      <-  iau_DTDB is an implementation
!             :
!    rate adjustment (L_C)   <-  function of solar-system ephemeris
!             :
!            TCB             <-  time scale for BCRS
!             :
!    rate adjustment (-L_B)  <-  definition of TDB
!             :
!            TDB             <-  TCB scaled to track TT
!             :
!      "periodic" terms      <-  -iau_DTDB is an approximation
!             :
!            TT              <-  terrestrial time
!
!  Given:
!     DATE1,DATE2     d    date, TDB (Notes 1-3)
!     UT              d    universal time (UT1, fraction of one day)
!     ELONG           d    longitude (east positive, radians)
!     U               d    distance from Earth spin axis (km)
!     V               d    distance north of equatorial plane (km)
!
!  Returned:
!    TDBmTT           d    TDB-TT (seconds)
!    CTBmTT           d    TDB-TT at geocenter (seconds)
!
!  Notes:
!
!  1) The date DATE1+DATE2 is a Julian Date, apportioned in any
!     convenient way between the arguments DATE1 and DATE2. 
!     Although the date is, formally, barycentric dynamical time (TDB),
!     the terrestrial dynamical time (TT) can be used with no practical
!     effect on the accuracy of the prediction.
!
!  2) TT can be regarded as a coordinate time that is realized as an
!     offset of 32.184s from International Atomic Time, TAI.  TT is a
!     specific linear transformation of geocentric coordinate time TCG,
!     which is the time scale for the Geocentric Celestial Reference
!     System, GCRS.
!
!  3) TDB is a coordinate time, and is a specific linear transformation
!     of barycentric coordinate time TCB, which is the time scale for
!     the Barycentric Celestial Reference System, BCRS.
!
!  4) The difference TCG-TCB depends on the masses and positions of the
!     bodies of the solar system and the velocity of the Earth.  It is
!     dominated by a rate difference, the residual being of a periodic
!     character.  The latter, which is modeled by the present routine,
!     comprises a main (annual) sinusoidal term of amplitude
!     approximately 0.00166 seconds, plus planetary terms up to about
!     20 microseconds, and lunar and diurnal terms up to 2 microseconds.
!     These effects come from the changing transverse Doppler effect
!     and gravitational red-shift as the observer (on the Earth's
!     surface) experiences variations in speed (with respect to the
!     BCRS) and gravitational potential.
!
!  5) TDB can be regarded as the same as TCB but with a rate adjustment
!     to keep it close to TT, which is convenient for many applications.
!     The history of successive attempts to define TDB is set out in
!     Resolution 3 adopted by the IAU General Assembly in 2006, which
!     defines a fixed TDB(TCB) transformation that is consistent with
!     contemporary solar-system ephemerides.  Future ephemerides will
!     imply slightly changed transformations between TCG and TCB, which
!     could introduce a linear drift between TDB and TT;  however, any
!     such drift is unlikely to exceed 1 nanosecond per century.
!
!  6) The geocentric TDB-TT model used in the present routine is that of
!     Fairhead & Bretagnon (1990), in its full form.  It was originally
!     supplied by Fairhead (private communications with P.T.Wallace,
!     1990) as a Fortran subroutine.  The present routine contains an
!     adaptation of the Fairhead code.  The numerical results are
!     essentially unaffected by the changes, the differences with
!     respect to the Fairhead & Bretagnon original being at the 1D-20 s
!     level.
!
!     The topocentric part of the model is from Moyer (1981) and
!     Murray (1983), with fundamental arguments adapted from
!     Simon et al. 1994.  It is an approximation to the expression
!     ( v / c ) . ( r / c ), where v is the barycentric velocity of
!     the Earth, r is the geocentric position of the observer and
!     c is the speed of light.
!
!     By supplying zeroes for U and V, the topocentric part of the
!     model can be nullified, and the routine will return the Fairhead
!     & Bretagnon result alone.
!
!  7) During the interval 1950-2050, the absolute accuracy is better
!     than +/- 3 nanoseconds relative to time ephemerides obtained by
!     direct numerical integrations based on the JPL DE405 solar system
!     ephemeris.
!
!  8) It must be stressed that the present routine is merely a model,
!     and that numerical integration of solar-system ephemerides is the
!     definitive method for predicting the relationship between TCG and
!     TCB and hence between TT and TDB.
!
!  References:
!
!     Fairhead, L., & Bretagnon, P., Astron.Astrophys., 229, 240-247
!     (1990).
!
!     IAU 2006 Resolution 3.
!
!     McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003),
!     IERS Technical Note No. 32, BKG (2004)
!
!     Moyer, T.D., Cel.Mech., 23, 33 (1981).
!
!     Murray, C.A., Vectorial Astrometry, Adam Hilger (1983).
!
!     Seidelmann, P.K. et al., Explanatory Supplement to the
!     Astronomical Almanac, Chapter 2, University Science Books (1992).
!
!     Simon, J.L., Bretagnon, P., Chapront, J., Chapront-Touze, M.,
!     Francou, G. & Laskar, J., Astron.Astrophys., 282, 663-683 (1994).
!
!-----------------------------------------------------------------------

      IMPLICIT NONE
      Real*8 DATE1, DATE2, UT, ELONG, U, V, TDBmTT, dTDBmTT, CTmTT,     &
     &       dCTmTT
!  2Pi
      Real*8           D2PI
      PARAMETER ( D2PI = 6.283185307179586476925287D0 )
!  Degrees to radians
      Real*8           DD2R
      PARAMETER ( DD2R = 1.745329251994329576923691D-2 )
!  Reference epoch (J2000.0), JD
      Real*8           DJ00
      PARAMETER ( DJ00 = 2451545D0 )
!  Days per Julian millennium
      Real*8           DJM
      PARAMETER ( DJM = 365250D0 )
!
      Real*8 T, TSOL, W, ELSUN, EMSUN, D, ELJ, ELS, dT,                 &
     &       WT,  W0,  W1,  W2,  W3,  W4,  WF,  WJ,                     &
     &      dWT, dW0, dW1, dW2, dW3, dW4, dWF, dWJ
!
!  =====================
!  Fairhead et al. model
!  =====================
!
!  787 sets of three coefficients.
!
!  Each set is amplitude (microseconds)
!              frequency (radians per Julian millennium since J2000.0),
!              phase (radians).
!
!  Sets   1-474 are the T**0 terms,
!   "   475-679  "   "  T**1   "
!   "   680-764  "   "  T**2   "
!   "   765-784  "   "  T**3   "
!   "   785-787  "   "  T**4   "  .
!
      Real*8           FAIRHD(3,787)
      INTEGER*4 I,J
      DATA ((FAIRHD(I,J),I=1,3),J=  1, 10) /                         &
     & 1656.674564D-6,    6283.075849991D0, 6.240054195D0,           &
     &   22.417471D-6,    5753.384884897D0, 4.296977442D0,           &
     &   13.839792D-6,   12566.151699983D0, 6.196904410D0,           &
     &    4.770086D-6,     529.690965095D0, 0.444401603D0,           &
     &    4.676740D-6,    6069.776754553D0, 4.021195093D0,           &
     &    2.256707D-6,     213.299095438D0, 5.543113262D0,           &
     &    1.694205D-6,      -3.523118349D0, 5.025132748D0,           &
     &    1.554905D-6,   77713.771467920D0, 5.198467090D0,           &
     &    1.276839D-6,    7860.419392439D0, 5.988822341D0,           &
     &    1.193379D-6,    5223.693919802D0, 3.649823730D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 11, 20) /                         &
     &    1.115322D-6,    3930.209696220D0, 1.422745069D0,           &
     &    0.794185D-6,   11506.769769794D0, 2.322313077D0,           &
     &    0.447061D-6,      26.298319800D0, 3.615796498D0,           &
     &    0.435206D-6,    -398.149003408D0, 4.349338347D0,           &
     &    0.600309D-6,    1577.343542448D0, 2.678271909D0,           &
     &    0.496817D-6,    6208.294251424D0, 5.696701824D0,           &
     &    0.486306D-6,    5884.926846583D0, 0.520007179D0,           &
     &    0.432392D-6,      74.781598567D0, 2.435898309D0,           &
     &    0.468597D-6,    6244.942814354D0, 5.866398759D0,           &
     &    0.375510D-6,    5507.553238667D0, 4.103476804D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 21, 30) /                         &
     &    0.243085D-6,    -775.522611324D0, 3.651837925D0,           &
     &    0.173435D-6,   18849.227549974D0, 6.153743485D0,           &
     &    0.230685D-6,    5856.477659115D0, 4.773852582D0,           &
     &    0.203747D-6,   12036.460734888D0, 4.333987818D0,           &
     &    0.143935D-6,    -796.298006816D0, 5.957517795D0,           &
     &    0.159080D-6,   10977.078804699D0, 1.890075226D0,           &
     &    0.119979D-6,      38.133035638D0, 4.551585768D0,           &
     &    0.118971D-6,    5486.777843175D0, 1.914547226D0,           &
     &    0.116120D-6,    1059.381930189D0, 0.873504123D0,           &
     &    0.137927D-6,   11790.629088659D0, 1.135934669D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 31, 40) /                         &
     &    0.098358D-6,    2544.314419883D0, 0.092793886D0,           &
     &    0.101868D-6,   -5573.142801634D0, 5.984503847D0,           &
     &    0.080164D-6,     206.185548437D0, 2.095377709D0,           &
     &    0.079645D-6,    4694.002954708D0, 2.949233637D0,           &
     &    0.062617D-6,      20.775395492D0, 2.654394814D0,           &
     &    0.075019D-6,    2942.463423292D0, 4.980931759D0,           &
     &    0.064397D-6,    5746.271337896D0, 1.280308748D0,           &
     &    0.063814D-6,    5760.498431898D0, 4.167901731D0,           &
     &    0.048042D-6,    2146.165416475D0, 1.495846011D0,           &
     &    0.048373D-6,     155.420399434D0, 2.251573730D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 41, 50) /                         &
     &    0.058844D-6,     426.598190876D0, 4.839650148D0,           &
     &    0.046551D-6,      -0.980321068D0, 0.921573539D0,           &
     &    0.054139D-6,   17260.154654690D0, 3.411091093D0,           &
     &    0.042411D-6,    6275.962302991D0, 2.869567043D0,           &
     &    0.040184D-6,      -7.113547001D0, 3.565975565D0,           &
     &    0.036564D-6,    5088.628839767D0, 3.324679049D0,           &
     &    0.040759D-6,   12352.852604545D0, 3.981496998D0,           &
     &    0.036507D-6,     801.820931124D0, 6.248866009D0,           &
     &    0.036955D-6,    3154.687084896D0, 5.071801441D0,           &
     &    0.042732D-6,     632.783739313D0, 5.720622217D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 51, 60) /                         &
     &    0.042560D-6,  161000.685737473D0, 1.270837679D0,           &
     &    0.040480D-6,   15720.838784878D0, 2.546610123D0,           &
     &    0.028244D-6,   -6286.598968340D0, 5.069663519D0,           &
     &    0.033477D-6,    6062.663207553D0, 4.144987272D0,           &
     &    0.034867D-6,     522.577418094D0, 5.210064075D0,           &
     &    0.032438D-6,    6076.890301554D0, 0.749317412D0,           &
     &    0.030215D-6,    7084.896781115D0, 3.389610345D0,           &
     &    0.029247D-6,  -71430.695617928D0, 4.183178762D0,           &
     &    0.033529D-6,    9437.762934887D0, 2.404714239D0,           &
     &    0.032423D-6,    8827.390269875D0, 5.541473556D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 61, 70) /                         &
     &    0.027567D-6,    6279.552731642D0, 5.040846034D0,           &
     &    0.029862D-6,   12139.553509107D0, 1.770181024D0,           &
     &    0.022509D-6,   10447.387839604D0, 1.460726241D0,           &
     &    0.020937D-6,    8429.241266467D0, 0.652303414D0,           &
     &    0.020322D-6,     419.484643875D0, 3.735430632D0,           &
     &    0.024816D-6,   -1194.447010225D0, 1.087136918D0,           &
     &    0.025196D-6,    1748.016413067D0, 2.901883301D0,           &
     &    0.021691D-6,   14143.495242431D0, 5.952658009D0,           &
     &    0.017673D-6,    6812.766815086D0, 3.186129845D0,           &
     &    0.022567D-6,    6133.512652857D0, 3.307984806D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 71, 80) /                         &
     &    0.016155D-6,   10213.285546211D0, 1.331103168D0,           &
     &    0.014751D-6,    1349.867409659D0, 4.308933301D0,           &
     &    0.015949D-6,    -220.412642439D0, 4.005298270D0,           &
     &    0.015974D-6,   -2352.866153772D0, 6.145309371D0,           &
     &    0.014223D-6,   17789.845619785D0, 2.104551349D0,           &
     &    0.017806D-6,      73.297125859D0, 3.475975097D0,           &
     &    0.013671D-6,    -536.804512095D0, 5.971672571D0,           &
     &    0.011942D-6,    8031.092263058D0, 2.053414715D0,           &
     &    0.014318D-6,   16730.463689596D0, 3.016058075D0,           &
     &    0.012462D-6,     103.092774219D0, 1.737438797D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 81, 90) /                         &
     &    0.010962D-6,       3.590428652D0, 2.196567739D0,           &
     &    0.015078D-6,   19651.048481098D0, 3.969480770D0,           &
     &    0.010396D-6,     951.718406251D0, 5.717799605D0,           &
     &    0.011707D-6,   -4705.732307544D0, 2.654125618D0,           &
     &    0.010453D-6,    5863.591206116D0, 1.913704550D0,           &
     &    0.012420D-6,    4690.479836359D0, 4.734090399D0,           &
     &    0.011847D-6,    5643.178563677D0, 5.489005403D0,           &
     &    0.008610D-6,    3340.612426700D0, 3.661698944D0,           &
     &    0.011622D-6,    5120.601145584D0, 4.863931876D0,           &
     &    0.010825D-6,     553.569402842D0, 0.842715011D0 /
      DATA ((FAIRHD(I,J),I=1,3),J= 91,100) /                         &
     &    0.008666D-6,    -135.065080035D0, 3.293406547D0,           &
     &    0.009963D-6,     149.563197135D0, 4.870690598D0,           &
     &    0.009858D-6,    6309.374169791D0, 1.061816410D0,           &
     &    0.007959D-6,     316.391869657D0, 2.465042647D0,           &
     &    0.010099D-6,     283.859318865D0, 1.942176992D0,           &
     &    0.007147D-6,    -242.728603974D0, 3.661486981D0,           &
     &    0.007505D-6,    5230.807466803D0, 4.920937029D0,           &
     &    0.008323D-6,   11769.853693166D0, 1.229392026D0,           &
     &    0.007490D-6,   -6256.777530192D0, 3.658444681D0,           &
     &    0.009370D-6,  149854.400134205D0, 0.673880395D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=101,110) /                         &
     &    0.007117D-6,      38.027672636D0, 5.294249518D0,           &
     &    0.007857D-6,   12168.002696575D0, 0.525733528D0,           &
     &    0.007019D-6,    6206.809778716D0, 0.837688810D0,           &
     &    0.006056D-6,     955.599741609D0, 4.194535082D0,           &
     &    0.008107D-6,   13367.972631107D0, 3.793235253D0,           &
     &    0.006731D-6,    5650.292110678D0, 5.639906583D0,           &
     &    0.007332D-6,      36.648562930D0, 0.114858677D0,           &
     &    0.006366D-6,    4164.311989613D0, 2.262081818D0,           &
     &    0.006858D-6,    5216.580372801D0, 0.642063318D0,           &
     &    0.006919D-6,    6681.224853400D0, 6.018501522D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=111,120) /                         &
     &    0.006826D-6,    7632.943259650D0, 3.458654112D0,           &
     &    0.005308D-6,   -1592.596013633D0, 2.500382359D0,           &
     &    0.005096D-6,   11371.704689758D0, 2.547107806D0,           &
     &    0.004841D-6,    5333.900241022D0, 0.437078094D0,           &
     &    0.005582D-6,    5966.683980335D0, 2.246174308D0,           &
     &    0.006304D-6,   11926.254413669D0, 2.512929171D0,           &
     &    0.006603D-6,   23581.258177318D0, 5.393136889D0,           &
     &    0.005123D-6,      -1.484472708D0, 2.999641028D0,           &
     &    0.004648D-6,    1589.072895284D0, 1.275847090D0,           &
     &    0.005119D-6,    6438.496249426D0, 1.486539246D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=121,130) /                         &
     &    0.004521D-6,    4292.330832950D0, 6.140635794D0,           &
     &    0.005680D-6,   23013.539539587D0, 4.557814849D0,           &
     &    0.005488D-6,      -3.455808046D0, 0.090675389D0,           &
     &    0.004193D-6,    7234.794256242D0, 4.869091389D0,           &
     &    0.003742D-6,    7238.675591600D0, 4.691976180D0,           &
     &    0.004148D-6,    -110.206321219D0, 3.016173439D0,           &
     &    0.004553D-6,   11499.656222793D0, 5.554998314D0,           &
     &    0.004892D-6,    5436.993015240D0, 1.475415597D0,           &
     &    0.004044D-6,    4732.030627343D0, 1.398784824D0,           &
     &    0.004164D-6,   12491.370101415D0, 5.650931916D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=131,140) /                         &
     &    0.004349D-6,   11513.883316794D0, 2.181745369D0,           &
     &    0.003919D-6,   12528.018664345D0, 5.823319737D0,           &
     &    0.003129D-6,    6836.645252834D0, 0.003844094D0,           &
     &    0.004080D-6,   -7058.598461315D0, 3.690360123D0,           &
     &    0.003270D-6,      76.266071276D0, 1.517189902D0,           &
     &    0.002954D-6,    6283.143160294D0, 4.447203799D0,           &
     &    0.002872D-6,      28.449187468D0, 1.158692983D0,           &
     &    0.002881D-6,     735.876513532D0, 0.349250250D0,           &
     &    0.003279D-6,    5849.364112115D0, 4.893384368D0,           &
     &    0.003625D-6,    6209.778724132D0, 1.473760578D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=141,150) /                         &
     &    0.003074D-6,     949.175608970D0, 5.185878737D0,           &
     &    0.002775D-6,    9917.696874510D0, 1.030026325D0,           &
     &    0.002646D-6,   10973.555686350D0, 3.918259169D0,           &
     &    0.002575D-6,   25132.303399966D0, 6.109659023D0,           &
     &    0.003500D-6,     263.083923373D0, 1.892100742D0,           &
     &    0.002740D-6,   18319.536584880D0, 4.320519510D0,           &
     &    0.002464D-6,     202.253395174D0, 4.698203059D0,           &
     &    0.002409D-6,       2.542797281D0, 5.325009315D0,           &
     &    0.003354D-6,  -90955.551694697D0, 1.942656623D0,           &
     &    0.002296D-6,    6496.374945429D0, 5.061810696D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=151,160) /                         &
     &    0.003002D-6,    6172.869528772D0, 2.797822767D0,           &
     &    0.003202D-6,   27511.467873537D0, 0.531673101D0,           &
     &    0.002954D-6,   -6283.008539689D0, 4.533471191D0,           &
     &    0.002353D-6,     639.897286314D0, 3.734548088D0,           &
     &    0.002401D-6,   16200.772724501D0, 2.605547070D0,           &
     &    0.003053D-6,  233141.314403759D0, 3.029030662D0,           &
     &    0.003024D-6,   83286.914269554D0, 2.355556099D0,           &
     &    0.002863D-6,   17298.182327326D0, 5.240963796D0,           &
     &    0.002103D-6,   -7079.373856808D0, 5.756641637D0,           &
     &    0.002303D-6,   83996.847317911D0, 2.013686814D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=161,170) /                         &
     &    0.002303D-6,   18073.704938650D0, 1.089100410D0,           &
     &    0.002381D-6,      63.735898303D0, 0.759188178D0,           &
     &    0.002493D-6,    6386.168624210D0, 0.645026535D0,           &
     &    0.002366D-6,       3.932153263D0, 6.215885448D0,           &
     &    0.002169D-6,   11015.106477335D0, 4.845297676D0,           &
     &    0.002397D-6,    6243.458341645D0, 3.809290043D0,           &
     &    0.002183D-6,    1162.474704408D0, 6.179611691D0,           &
     &    0.002353D-6,    6246.427287062D0, 4.781719760D0,           &
     &    0.002199D-6,    -245.831646229D0, 5.956152284D0,           &
     &    0.001729D-6,    3894.181829542D0, 1.264976635D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=171,180) /                         &
     &    0.001896D-6,   -3128.388765096D0, 4.914231596D0,           &
     &    0.002085D-6,      35.164090221D0, 1.405158503D0,           &
     &    0.002024D-6,   14712.317116458D0, 2.752035928D0,           &
     &    0.001737D-6,    6290.189396992D0, 5.280820144D0,           &
     &    0.002229D-6,     491.557929457D0, 1.571007057D0,           &
     &    0.001602D-6,   14314.168113050D0, 4.203664806D0,           &
     &    0.002186D-6,     454.909366527D0, 1.402101526D0,           &
     &    0.001897D-6,   22483.848574493D0, 4.167932508D0,           &
     &    0.001825D-6,   -3738.761430108D0, 0.545828785D0,           &
     &    0.001894D-6,    1052.268383188D0, 5.817167450D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=181,190) /                         &
     &    0.001421D-6,      20.355319399D0, 2.419886601D0,           &
     &    0.001408D-6,   10984.192351700D0, 2.732084787D0,           &
     &    0.001847D-6,   10873.986030480D0, 2.903477885D0,           &
     &    0.001391D-6,   -8635.942003763D0, 0.593891500D0,           &
     &    0.001388D-6,      -7.046236698D0, 1.166145902D0,           &
     &    0.001810D-6,  -88860.057071188D0, 0.487355242D0,           &
     &    0.001288D-6,   -1990.745017041D0, 3.913022880D0,           &
     &    0.001297D-6,   23543.230504682D0, 3.063805171D0,           &
     &    0.001335D-6,    -266.607041722D0, 3.995764039D0,           &
     &    0.001376D-6,   10969.965257698D0, 5.152914309D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=191,200) /                         &
     &    0.001745D-6,  244287.600007027D0, 3.626395673D0,           &
     &    0.001649D-6,   31441.677569757D0, 1.952049260D0,           &
     &    0.001416D-6,    9225.539273283D0, 4.996408389D0,           &
     &    0.001238D-6,    4804.209275927D0, 5.503379738D0,           &
     &    0.001472D-6,    4590.910180489D0, 4.164913291D0,           &
     &    0.001169D-6,    6040.347246017D0, 5.841719038D0,           &
     &    0.001039D-6,    5540.085789459D0, 2.769753519D0,           &
     &    0.001004D-6,    -170.672870619D0, 0.755008103D0,           &
     &    0.001284D-6,   10575.406682942D0, 5.306538209D0,           &
     &    0.001278D-6,      71.812653151D0, 4.713486491D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=201,210) /                         &
     &    0.001321D-6,   18209.330263660D0, 2.624866359D0,           &
     &    0.001297D-6,   21228.392023546D0, 0.382603541D0,           &
     &    0.000954D-6,    6282.095528923D0, 0.882213514D0,           &
     &    0.001145D-6,    6058.731054289D0, 1.169483931D0,           &
     &    0.000979D-6,    5547.199336460D0, 5.448375984D0,           &
     &    0.000987D-6,   -6262.300454499D0, 2.656486959D0,           &
     &    0.001070D-6, -154717.609887482D0, 1.827624012D0,           &
     &    0.000991D-6,    4701.116501708D0, 4.387001801D0,           &
     &    0.001155D-6,     -14.227094002D0, 3.042700750D0,           &
     &    0.001176D-6,     277.034993741D0, 3.335519004D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=211,220) /                         &
     &    0.000890D-6,   13916.019109642D0, 5.601498297D0,           &
     &    0.000884D-6,   -1551.045222648D0, 1.088831705D0,           &
     &    0.000876D-6,    5017.508371365D0, 3.969902609D0,           &
     &    0.000806D-6,   15110.466119866D0, 5.142876744D0,           &
     &    0.000773D-6,   -4136.910433516D0, 0.022067765D0,           &
     &    0.001077D-6,     175.166059800D0, 1.844913056D0,           &
     &    0.000954D-6,   -6284.056171060D0, 0.968480906D0,           &
     &    0.000737D-6,    5326.786694021D0, 4.923831588D0,           &
     &    0.000845D-6,    -433.711737877D0, 4.749245231D0,           &
     &    0.000819D-6,    8662.240323563D0, 5.991247817D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=221,230) /                         &
     &    0.000852D-6,     199.072001436D0, 2.189604979D0,           &
     &    0.000723D-6,   17256.631536341D0, 6.068719637D0,           &
     &    0.000940D-6,    6037.244203762D0, 6.197428148D0,           &
     &    0.000885D-6,   11712.955318231D0, 3.280414875D0,           &
     &    0.000706D-6,   12559.038152982D0, 2.824848947D0,           &
     &    0.000732D-6,    2379.164473572D0, 2.501813417D0,           &
     &    0.000764D-6,   -6127.655450557D0, 2.236346329D0,           &
     &    0.000908D-6,     131.541961686D0, 2.521257490D0,           &
     &    0.000907D-6,   35371.887265976D0, 3.370195967D0,           &
     &    0.000673D-6,    1066.495477190D0, 3.876512374D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=231,240) /                         &
     &    0.000814D-6,   17654.780539750D0, 4.627122566D0,           &
     &    0.000630D-6,      36.027866677D0, 0.156368499D0,           &
     &    0.000798D-6,     515.463871093D0, 5.151962502D0,           &
     &    0.000798D-6,     148.078724426D0, 5.909225055D0,           &
     &    0.000806D-6,     309.278322656D0, 6.054064447D0,           &
     &    0.000607D-6,     -39.617508346D0, 2.839021623D0,           &
     &    0.000601D-6,     412.371096874D0, 3.984225404D0,           &
     &    0.000646D-6,   11403.676995575D0, 3.852959484D0,           &
     &    0.000704D-6,   13521.751441591D0, 2.300991267D0,           &
     &    0.000603D-6,  -65147.619767937D0, 4.140083146D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=241,250) /                         &
     &    0.000609D-6,   10177.257679534D0, 0.437122327D0,           &
     &    0.000631D-6,    5767.611978898D0, 4.026532329D0,           &
     &    0.000576D-6,   11087.285125918D0, 4.760293101D0,           &
     &    0.000674D-6,   14945.316173554D0, 6.270510511D0,           &
     &    0.000726D-6,    5429.879468239D0, 6.039606892D0,           &
     &    0.000710D-6,   28766.924424484D0, 5.672617711D0,           &
     &    0.000647D-6,   11856.218651625D0, 3.397132627D0,           &
     &    0.000678D-6,   -5481.254918868D0, 6.249666675D0,           &
     &    0.000618D-6,   22003.914634870D0, 2.466427018D0,           &
     &    0.000738D-6,    6134.997125565D0, 2.242668890D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=251,260) /                         &
     &    0.000660D-6,     625.670192312D0, 5.864091907D0,           &
     &    0.000694D-6,    3496.032826134D0, 2.668309141D0,           &
     &    0.000531D-6,    6489.261398429D0, 1.681888780D0,           &
     &    0.000611D-6, -143571.324284214D0, 2.424978312D0,           &
     &    0.000575D-6,   12043.574281889D0, 4.216492400D0,           &
     &    0.000553D-6,   12416.588502848D0, 4.772158039D0,           &
     &    0.000689D-6,    4686.889407707D0, 6.224271088D0,           &
     &    0.000495D-6,    7342.457780181D0, 3.817285811D0,           &
     &    0.000567D-6,    3634.621024518D0, 1.649264690D0,           &
     &    0.000515D-6,   18635.928454536D0, 3.945345892D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=261,270) /                         &
     &    0.000486D-6,    -323.505416657D0, 4.061673868D0,           &
     &    0.000662D-6,   25158.601719765D0, 1.794058369D0,           &
     &    0.000509D-6,     846.082834751D0, 3.053874588D0,           &
     &    0.000472D-6,  -12569.674818332D0, 5.112133338D0,           &
     &    0.000461D-6,    6179.983075773D0, 0.513669325D0,           &
     &    0.000641D-6,   83467.156352816D0, 3.210727723D0,           &
     &    0.000520D-6,   10344.295065386D0, 2.445597761D0,           &
     &    0.000493D-6,   18422.629359098D0, 1.676939306D0,           &
     &    0.000478D-6,    1265.567478626D0, 5.487314569D0,           &
     &    0.000472D-6,     -18.159247265D0, 1.999707589D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=271,280) /                         &
     &    0.000559D-6,   11190.377900137D0, 5.783236356D0,           &
     &    0.000494D-6,    9623.688276691D0, 3.022645053D0,           &
     &    0.000463D-6,    5739.157790895D0, 1.411223013D0,           &
     &    0.000432D-6,   16858.482532933D0, 1.179256434D0,           &
     &    0.000574D-6,   72140.628666286D0, 1.758191830D0,           &
     &    0.000484D-6,   17267.268201691D0, 3.290589143D0,           &
     &    0.000550D-6,    4907.302050146D0, 0.864024298D0,           &
     &    0.000399D-6,      14.977853527D0, 2.094441910D0,           &
     &    0.000491D-6,     224.344795702D0, 0.878372791D0,           &
     &    0.000432D-6,   20426.571092422D0, 6.003829241D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=281,290) /                         &
     &    0.000481D-6,    5749.452731634D0, 4.309591964D0,           &
     &    0.000480D-6,    5757.317038160D0, 1.142348571D0,           &
     &    0.000485D-6,    6702.560493867D0, 0.210580917D0,           &
     &    0.000426D-6,    6055.549660552D0, 4.274476529D0,           &
     &    0.000480D-6,    5959.570433334D0, 5.031351030D0,           &
     &    0.000466D-6,   12562.628581634D0, 4.959581597D0,           &
     &    0.000520D-6,   39302.096962196D0, 4.788002889D0,           &
     &    0.000458D-6,   12132.439962106D0, 1.880103788D0,           &
     &    0.000470D-6,   12029.347187887D0, 1.405611197D0,           &
     &    0.000416D-6,   -7477.522860216D0, 1.082356330D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=291,300) /                         &
     &    0.000449D-6,   11609.862544012D0, 4.179989585D0,           &
     &    0.000465D-6,   17253.041107690D0, 0.353496295D0,           &
     &    0.000362D-6,   -4535.059436924D0, 1.583849576D0,           &
     &    0.000383D-6,   21954.157609398D0, 3.747376371D0,           &
     &    0.000389D-6,      17.252277143D0, 1.395753179D0,           &
     &    0.000331D-6,   18052.929543158D0, 0.566790582D0,           &
     &    0.000430D-6,   13517.870106233D0, 0.685827538D0,           &
     &    0.000368D-6,   -5756.908003246D0, 0.731374317D0,           &
     &    0.000330D-6,   10557.594160824D0, 3.710043680D0,           &
     &    0.000332D-6,   20199.094959633D0, 1.652901407D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=301,310) /                         &
     &    0.000384D-6,   11933.367960670D0, 5.827781531D0,           &
     &    0.000387D-6,   10454.501386605D0, 2.541182564D0,           &
     &    0.000325D-6,   15671.081759407D0, 2.178850542D0,           &
     &    0.000318D-6,     138.517496871D0, 2.253253037D0,           &
     &    0.000305D-6,    9388.005909415D0, 0.578340206D0,           &
     &    0.000352D-6,    5749.861766548D0, 3.000297967D0,           &
     &    0.000311D-6,    6915.859589305D0, 1.693574249D0,           &
     &    0.000297D-6,   24072.921469776D0, 1.997249392D0,           &
     &    0.000363D-6,    -640.877607382D0, 5.071820966D0,           &
     &    0.000323D-6,   12592.450019783D0, 1.072262823D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=311,320) /                         &
     &    0.000341D-6,   12146.667056108D0, 4.700657997D0,           &
     &    0.000290D-6,    9779.108676125D0, 1.812320441D0,           &
     &    0.000342D-6,    6132.028180148D0, 4.322238614D0,           &
     &    0.000329D-6,    6268.848755990D0, 3.033827743D0,           &
     &    0.000374D-6,   17996.031168222D0, 3.388716544D0,           &
     &    0.000285D-6,    -533.214083444D0, 4.687313233D0,           &
     &    0.000338D-6,    6065.844601290D0, 0.877776108D0,           &
     &    0.000276D-6,      24.298513841D0, 0.770299429D0,           &
     &    0.000336D-6,   -2388.894020449D0, 5.353796034D0,           &
     &    0.000290D-6,    3097.883822726D0, 4.075291557D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=321,330) /                         &
     &    0.000318D-6,     709.933048357D0, 5.941207518D0,           &
     &    0.000271D-6,   13095.842665077D0, 3.208912203D0,           &
     &    0.000331D-6,    6073.708907816D0, 4.007881169D0,           &
     &    0.000292D-6,     742.990060533D0, 2.714333592D0,           &
     &    0.000362D-6,   29088.811415985D0, 3.215977013D0,           &
     &    0.000280D-6,   12359.966151546D0, 0.710872502D0,           &
     &    0.000267D-6,   10440.274292604D0, 4.730108488D0,           &
     &    0.000262D-6,     838.969287750D0, 1.327720272D0,           &
     &    0.000250D-6,   16496.361396202D0, 0.898769761D0,           &
     &    0.000325D-6,   20597.243963041D0, 0.180044365D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=331,340) /                         &
     &    0.000268D-6,    6148.010769956D0, 5.152666276D0,           &
     &    0.000284D-6,    5636.065016677D0, 5.655385808D0,           &
     &    0.000301D-6,    6080.822454817D0, 2.135396205D0,           &
     &    0.000294D-6,    -377.373607916D0, 3.708784168D0,           &
     &    0.000236D-6,    2118.763860378D0, 1.733578756D0,           &
     &    0.000234D-6,    5867.523359379D0, 5.575209112D0,           &
     &    0.000268D-6, -226858.238553767D0, 0.069432392D0,           &
     &    0.000265D-6,  167283.761587465D0, 4.369302826D0,           &
     &    0.000280D-6,   28237.233459389D0, 5.304829118D0,           &
     &    0.000292D-6,   12345.739057544D0, 4.096094132D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=341,350) /                         &
     &    0.000223D-6,   19800.945956225D0, 3.069327406D0,           &
     &    0.000301D-6,   43232.306658416D0, 6.205311188D0,           &
     &    0.000264D-6,   18875.525869774D0, 1.417263408D0,           &
     &    0.000304D-6,   -1823.175188677D0, 3.409035232D0,           &
     &    0.000301D-6,     109.945688789D0, 0.510922054D0,           &
     &    0.000260D-6,     813.550283960D0, 2.389438934D0,           &
     &    0.000299D-6,  316428.228673312D0, 5.384595078D0,           &
     &    0.000211D-6,    5756.566278634D0, 3.789392838D0,           &
     &    0.000209D-6,    5750.203491159D0, 1.661943545D0,           &
     &    0.000240D-6,   12489.885628707D0, 5.684549045D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=351,360) /                         &
     &    0.000216D-6,    6303.851245484D0, 3.862942261D0,           &
     &    0.000203D-6,    1581.959348283D0, 5.549853589D0,           &
     &    0.000200D-6,    5642.198242609D0, 1.016115785D0,           &
     &    0.000197D-6,     -70.849445304D0, 4.690702525D0,           &
     &    0.000227D-6,    6287.008003254D0, 2.911891613D0,           &
     &    0.000197D-6,     533.623118358D0, 1.048982898D0,           &
     &    0.000205D-6,   -6279.485421340D0, 1.829362730D0,           &
     &    0.000209D-6,  -10988.808157535D0, 2.636140084D0,           &
     &    0.000208D-6,    -227.526189440D0, 4.127883842D0,           &
     &    0.000191D-6,     415.552490612D0, 4.401165650D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=361,370) /                         &
     &    0.000190D-6,   29296.615389579D0, 4.175658539D0,           &
     &    0.000264D-6,   66567.485864652D0, 4.601102551D0,           &
     &    0.000256D-6,   -3646.350377354D0, 0.506364778D0,           &
     &    0.000188D-6,   13119.721102825D0, 2.032195842D0,           &
     &    0.000185D-6,    -209.366942175D0, 4.694756586D0,           &
     &    0.000198D-6,   25934.124331089D0, 3.832703118D0,           &
     &    0.000195D-6,    4061.219215394D0, 3.308463427D0,           &
     &    0.000234D-6,    5113.487598583D0, 1.716090661D0,           &
     &    0.000188D-6,    1478.866574064D0, 5.686865780D0,           &
     &    0.000222D-6,   11823.161639450D0, 1.942386641D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=371,380) /                         &
     &    0.000181D-6,   10770.893256262D0, 1.999482059D0,           &
     &    0.000171D-6,    6546.159773364D0, 1.182807992D0,           &
     &    0.000206D-6,      70.328180442D0, 5.934076062D0,           &
     &    0.000169D-6,   20995.392966449D0, 2.169080622D0,           &
     &    0.000191D-6,   10660.686935042D0, 5.405515999D0,           &
     &    0.000228D-6,   33019.021112205D0, 4.656985514D0,           &
     &    0.000184D-6,   -4933.208440333D0, 3.327476868D0,           &
     &    0.000220D-6,    -135.625325010D0, 1.765430262D0,           &
     &    0.000166D-6,   23141.558382925D0, 3.454132746D0,           &
     &    0.000191D-6,    6144.558353121D0, 5.020393445D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=381,390) /                         &
     &    0.000180D-6,    6084.003848555D0, 0.602182191D0,           &
     &    0.000163D-6,   17782.732072784D0, 4.960593133D0,           &
     &    0.000225D-6,   16460.333529525D0, 2.596451817D0,           &
     &    0.000222D-6,    5905.702242076D0, 3.731990323D0,           &
     &    0.000204D-6,     227.476132789D0, 5.636192701D0,           &
     &    0.000159D-6,   16737.577236597D0, 3.600691544D0,           &
     &    0.000200D-6,    6805.653268085D0, 0.868220961D0,           &
     &    0.000187D-6,   11919.140866668D0, 2.629456641D0,           &
     &    0.000161D-6,     127.471796607D0, 2.862574720D0,           &
     &    0.000205D-6,    6286.666278643D0, 1.742882331D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=391,400) /                         &
     &    0.000189D-6,     153.778810485D0, 4.812372643D0,           &
     &    0.000168D-6,   16723.350142595D0, 0.027860588D0,           &
     &    0.000149D-6,   11720.068865232D0, 0.659721876D0,           &
     &    0.000189D-6,    5237.921013804D0, 5.245313000D0,           &
     &    0.000143D-6,    6709.674040867D0, 4.317625647D0,           &
     &    0.000146D-6,    4487.817406270D0, 4.815297007D0,           &
     &    0.000144D-6,    -664.756045130D0, 5.381366880D0,           &
     &    0.000175D-6,    5127.714692584D0, 4.728443327D0,           &
     &    0.000162D-6,    6254.626662524D0, 1.435132069D0,           &
     &    0.000187D-6,   47162.516354635D0, 1.354371923D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=401,410) /                         &
     &    0.000146D-6,   11080.171578918D0, 3.369695406D0,           &
     &    0.000180D-6,    -348.924420448D0, 2.490902145D0,           &
     &    0.000148D-6,     151.047669843D0, 3.799109588D0,           &
     &    0.000157D-6,    6197.248551160D0, 1.284375887D0,           &
     &    0.000167D-6,     146.594251718D0, 0.759969109D0,           &
     &    0.000133D-6,   -5331.357443741D0, 5.409701889D0,           &
     &    0.000154D-6,      95.979227218D0, 3.366890614D0,           &
     &    0.000148D-6,   -6418.140930027D0, 3.384104996D0,           &
     &    0.000128D-6,   -6525.804453965D0, 3.803419985D0,           &
     &    0.000130D-6,   11293.470674356D0, 0.939039445D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=411,420) /                         &
     &    0.000152D-6,   -5729.506447149D0, 0.734117523D0,           &
     &    0.000138D-6,     210.117701700D0, 2.564216078D0,           &
     &    0.000123D-6,    6066.595360816D0, 4.517099537D0,           &
     &    0.000140D-6,   18451.078546566D0, 0.642049130D0,           &
     &    0.000126D-6,   11300.584221356D0, 3.485280663D0,           &
     &    0.000119D-6,   10027.903195729D0, 3.217431161D0,           &
     &    0.000151D-6,    4274.518310832D0, 4.404359108D0,           &
     &    0.000117D-6,    6072.958148291D0, 0.366324650D0,           &
     &    0.000165D-6,   -7668.637425143D0, 4.298212528D0,           &
     &    0.000117D-6,   -6245.048177356D0, 5.379518958D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=421,430) /                         &
     &    0.000130D-6,   -5888.449964932D0, 4.527681115D0,           &
     &    0.000121D-6,    -543.918059096D0, 6.109429504D0,           &
     &    0.000162D-6,    9683.594581116D0, 5.720092446D0,           &
     &    0.000141D-6,    6219.339951688D0, 0.679068671D0,           &
     &    0.000118D-6,   22743.409379516D0, 4.881123092D0,           &
     &    0.000129D-6,    1692.165669502D0, 0.351407289D0,           &
     &    0.000126D-6,    5657.405657679D0, 5.146592349D0,           &
     &    0.000114D-6,     728.762966531D0, 0.520791814D0,           &
     &    0.000120D-6,      52.596639600D0, 0.948516300D0,           &
     &    0.000115D-6,      65.220371012D0, 3.504914846D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=431,440) /                         &
     &    0.000126D-6,    5881.403728234D0, 5.577502482D0,           &
     &    0.000158D-6,  163096.180360983D0, 2.957128968D0,           &
     &    0.000134D-6,   12341.806904281D0, 2.598576764D0,           &
     &    0.000151D-6,   16627.370915377D0, 3.985702050D0,           &
     &    0.000109D-6,    1368.660252845D0, 0.014730471D0,           &
     &    0.000131D-6,    6211.263196841D0, 0.085077024D0,           &
     &    0.000146D-6,    5792.741760812D0, 0.708426604D0,           &
     &    0.000146D-6,     -77.750543984D0, 3.121576600D0,           &
     &    0.000107D-6,    5341.013788022D0, 0.288231904D0,           &
     &    0.000138D-6,    6281.591377283D0, 2.797450317D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=441,450) /                         &
     &    0.000113D-6,   -6277.552925684D0, 2.788904128D0,           &
     &    0.000115D-6,    -525.758811831D0, 5.895222200D0,           &
     &    0.000138D-6,    6016.468808270D0, 6.096188999D0,           &
     &    0.000139D-6,   23539.707386333D0, 2.028195445D0,           &
     &    0.000146D-6,   -4176.041342449D0, 4.660008502D0,           &
     &    0.000107D-6,   16062.184526117D0, 4.066520001D0,           &
     &    0.000142D-6,   83783.548222473D0, 2.936315115D0,           &
     &    0.000128D-6,    9380.959672717D0, 3.223844306D0,           &
     &    0.000135D-6,    6205.325306007D0, 1.638054048D0,           &
     &    0.000101D-6,    2699.734819318D0, 5.481603249D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=451,460) /                         &
     &    0.000104D-6,    -568.821874027D0, 2.205734493D0,           &
     &    0.000103D-6,    6321.103522627D0, 2.440421099D0,           &
     &    0.000119D-6,    6321.208885629D0, 2.547496264D0,           &
     &    0.000138D-6,    1975.492545856D0, 2.314608466D0,           &
     &    0.000121D-6,     137.033024162D0, 4.539108237D0,           &
     &    0.000123D-6,   19402.796952817D0, 4.538074405D0,           &
     &    0.000119D-6,   22805.735565994D0, 2.869040566D0,           &
     &    0.000133D-6,   64471.991241142D0, 6.056405489D0,           &
     &    0.000129D-6,     -85.827298831D0, 2.540635083D0,           &
     &    0.000131D-6,   13613.804277336D0, 4.005732868D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=461,470) /                         &
     &    0.000104D-6,    9814.604100291D0, 1.959967212D0,           &
     &    0.000112D-6,   16097.679950283D0, 3.589026260D0,           &
     &    0.000123D-6,    2107.034507542D0, 1.728627253D0,           &
     &    0.000121D-6,   36949.230808424D0, 6.072332087D0,           &
     &    0.000108D-6,  -12539.853380183D0, 3.716133846D0,           &
     &    0.000113D-6,   -7875.671863624D0, 2.725771122D0,           &
     &    0.000109D-6,    4171.425536614D0, 4.033338079D0,           &
     &    0.000101D-6,    6247.911759770D0, 3.441347021D0,           &
     &    0.000113D-6,    7330.728427345D0, 0.656372122D0,           &
     &    0.000113D-6,   51092.726050855D0, 2.791483066D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=471,480) /                         &
     &    0.000106D-6,    5621.842923210D0, 1.815323326D0,           &
     &    0.000101D-6,     111.430161497D0, 5.711033677D0,           &
     &    0.000103D-6,     909.818733055D0, 2.812745443D0,           &
     &    0.000101D-6,    1790.642637886D0, 1.965746028D0,           &
!
!  T
     &  102.156724D-6,    6283.075849991D0, 4.249032005D0,           &
     &    1.706807D-6,   12566.151699983D0, 4.205904248D0,           &
     &    0.269668D-6,     213.299095438D0, 3.400290479D0,           &
     &    0.265919D-6,     529.690965095D0, 5.836047367D0,           &
     &    0.210568D-6,      -3.523118349D0, 6.262738348D0,           &
     &    0.077996D-6,    5223.693919802D0, 4.670344204D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=481,490) /                         &
     &    0.054764D-6,    1577.343542448D0, 4.534800170D0,           &
     &    0.059146D-6,      26.298319800D0, 1.083044735D0,           &
     &    0.034420D-6,    -398.149003408D0, 5.980077351D0,           &
     &    0.032088D-6,   18849.227549974D0, 4.162913471D0,           &
     &    0.033595D-6,    5507.553238667D0, 5.980162321D0,           &
     &    0.029198D-6,    5856.477659115D0, 0.623811863D0,           &
     &    0.027764D-6,     155.420399434D0, 3.745318113D0,           &
     &    0.025190D-6,    5746.271337896D0, 2.980330535D0,           &
     &    0.022997D-6,    -796.298006816D0, 1.174411803D0,           &
     &    0.024976D-6,    5760.498431898D0, 2.467913690D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=491,500) /                         &
     &    0.021774D-6,     206.185548437D0, 3.854787540D0,           &
     &    0.017925D-6,    -775.522611324D0, 1.092065955D0,           &
     &    0.013794D-6,     426.598190876D0, 2.699831988D0,           &
     &    0.013276D-6,    6062.663207553D0, 5.845801920D0,           &
     &    0.011774D-6,   12036.460734888D0, 2.292832062D0,           &
     &    0.012869D-6,    6076.890301554D0, 5.333425680D0,           &
     &    0.012152D-6,    1059.381930189D0, 6.222874454D0,           &
     &    0.011081D-6,      -7.113547001D0, 5.154724984D0,           &
     &    0.010143D-6,    4694.002954708D0, 4.044013795D0,           &
     &    0.009357D-6,    5486.777843175D0, 3.416081409D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=501,510) /                         &
     &    0.010084D-6,     522.577418094D0, 0.749320262D0,           &
     &    0.008587D-6,   10977.078804699D0, 2.777152598D0,           &
     &    0.008628D-6,    6275.962302991D0, 4.562060226D0,           &
     &    0.008158D-6,    -220.412642439D0, 5.806891533D0,           &
     &    0.007746D-6,    2544.314419883D0, 1.603197066D0,           &
     &    0.007670D-6,    2146.165416475D0, 3.000200440D0,           &
     &    0.007098D-6,      74.781598567D0, 0.443725817D0,           &
     &    0.006180D-6,    -536.804512095D0, 1.302642751D0,           &
     &    0.005818D-6,    5088.628839767D0, 4.827723531D0,           &
     &    0.004945D-6,   -6286.598968340D0, 0.268305170D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=511,520) /                         &
     &    0.004774D-6,    1349.867409659D0, 5.808636673D0,           &
     &    0.004687D-6,    -242.728603974D0, 5.154890570D0,           &
     &    0.006089D-6,    1748.016413067D0, 4.403765209D0,           &
     &    0.005975D-6,   -1194.447010225D0, 2.583472591D0,           &
     &    0.004229D-6,     951.718406251D0, 0.931172179D0,           &
     &    0.005264D-6,     553.569402842D0, 2.336107252D0,           &
     &    0.003049D-6,    5643.178563677D0, 1.362634430D0,           &
     &    0.002974D-6,    6812.766815086D0, 1.583012668D0,           &
     &    0.003403D-6,   -2352.866153772D0, 2.552189886D0,           &
     &    0.003030D-6,     419.484643875D0, 5.286473844D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=521,530) /                         &
     &    0.003210D-6,      -7.046236698D0, 1.863796539D0,           &
     &    0.003058D-6,    9437.762934887D0, 4.226420633D0,           &
     &    0.002589D-6,   12352.852604545D0, 1.991935820D0,           &
     &    0.002927D-6,    5216.580372801D0, 2.319951253D0,           &
     &    0.002425D-6,    5230.807466803D0, 3.084752833D0,           &
     &    0.002656D-6,    3154.687084896D0, 2.487447866D0,           &
     &    0.002445D-6,   10447.387839604D0, 2.347139160D0,           &
     &    0.002990D-6,    4690.479836359D0, 6.235872050D0,           &
     &    0.002890D-6,    5863.591206116D0, 0.095197563D0,           &
     &    0.002498D-6,    6438.496249426D0, 2.994779800D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=531,540) /                         &
     &    0.001889D-6,    8031.092263058D0, 3.569003717D0,           &
     &    0.002567D-6,     801.820931124D0, 3.425611498D0,           &
     &    0.001803D-6,  -71430.695617928D0, 2.192295512D0,           &
     &    0.001782D-6,       3.932153263D0, 5.180433689D0,           &
     &    0.001694D-6,   -4705.732307544D0, 4.641779174D0,           &
     &    0.001704D-6,   -1592.596013633D0, 3.997097652D0,           &
     &    0.001735D-6,    5849.364112115D0, 0.417558428D0,           &
     &    0.001643D-6,    8429.241266467D0, 2.180619584D0,           &
     &    0.001680D-6,      38.133035638D0, 4.164529426D0,           &
     &    0.002045D-6,    7084.896781115D0, 0.526323854D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=541,550) /                         &
     &    0.001458D-6,    4292.330832950D0, 1.356098141D0,           &
     &    0.001437D-6,      20.355319399D0, 3.895439360D0,           &
     &    0.001738D-6,    6279.552731642D0, 0.087484036D0,           &
     &    0.001367D-6,   14143.495242431D0, 3.987576591D0,           &
     &    0.001344D-6,    7234.794256242D0, 0.090454338D0,           &
     &    0.001438D-6,   11499.656222793D0, 0.974387904D0,           &
     &    0.001257D-6,    6836.645252834D0, 1.509069366D0,           &
     &    0.001358D-6,   11513.883316794D0, 0.495572260D0,           &
     &    0.001628D-6,    7632.943259650D0, 4.968445721D0,           &
     &    0.001169D-6,     103.092774219D0, 2.838496795D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=551,560) /                         &
     &    0.001162D-6,    4164.311989613D0, 3.408387778D0,           &
     &    0.001092D-6,    6069.776754553D0, 3.617942651D0,           &
     &    0.001008D-6,   17789.845619785D0, 0.286350174D0,           &
     &    0.001008D-6,     639.897286314D0, 1.610762073D0,           &
     &    0.000918D-6,   10213.285546211D0, 5.532798067D0,           &
     &    0.001011D-6,   -6256.777530192D0, 0.661826484D0,           &
     &    0.000753D-6,   16730.463689596D0, 3.905030235D0,           &
     &    0.000737D-6,   11926.254413669D0, 4.641956361D0,           &
     &    0.000694D-6,    3340.612426700D0, 2.111120332D0,           &
     &    0.000701D-6,    3894.181829542D0, 2.760823491D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=561,570) /                         &
     &    0.000689D-6,    -135.065080035D0, 4.768800780D0,           &
     &    0.000700D-6,   13367.972631107D0, 5.760439898D0,           &
     &    0.000664D-6,    6040.347246017D0, 1.051215840D0,           &
     &    0.000654D-6,    5650.292110678D0, 4.911332503D0,           &
     &    0.000788D-6,    6681.224853400D0, 4.699648011D0,           &
     &    0.000628D-6,    5333.900241022D0, 5.024608847D0,           &
     &    0.000755D-6,    -110.206321219D0, 4.370971253D0,           &
     &    0.000628D-6,    6290.189396992D0, 3.660478857D0,           &
     &    0.000635D-6,   25132.303399966D0, 4.121051532D0,           &
     &    0.000534D-6,    5966.683980335D0, 1.173284524D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=571,580) /                         &
     &    0.000543D-6,    -433.711737877D0, 0.345585464D0,           &
     &    0.000517D-6,   -1990.745017041D0, 5.414571768D0,           &
     &    0.000504D-6,    5767.611978898D0, 2.328281115D0,           &
     &    0.000485D-6,    5753.384884897D0, 1.685874771D0,           &
     &    0.000463D-6,    7860.419392439D0, 5.297703006D0,           &
     &    0.000604D-6,     515.463871093D0, 0.591998446D0,           &
     &    0.000443D-6,   12168.002696575D0, 4.830881244D0,           &
     &    0.000570D-6,     199.072001436D0, 3.899190272D0,           &
     &    0.000465D-6,   10969.965257698D0, 0.476681802D0,           &
     &    0.000424D-6,   -7079.373856808D0, 1.112242763D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=581,590) /                         &
     &    0.000427D-6,     735.876513532D0, 1.994214480D0,           &
     &    0.000478D-6,   -6127.655450557D0, 3.778025483D0,           &
     &    0.000414D-6,   10973.555686350D0, 5.441088327D0,           &
     &    0.000512D-6,    1589.072895284D0, 0.107123853D0,           &
     &    0.000378D-6,   10984.192351700D0, 0.915087231D0,           &
     &    0.000402D-6,   11371.704689758D0, 4.107281715D0,           &
     &    0.000453D-6,    9917.696874510D0, 1.917490952D0,           &
     &    0.000395D-6,     149.563197135D0, 2.763124165D0,           &
     &    0.000371D-6,    5739.157790895D0, 3.112111866D0,           &
     &    0.000350D-6,   11790.629088659D0, 0.440639857D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=591,600) /                         &
     &    0.000356D-6,    6133.512652857D0, 5.444568842D0,           &
     &    0.000344D-6,     412.371096874D0, 5.676832684D0,           &
     &    0.000383D-6,     955.599741609D0, 5.559734846D0,           &
     &    0.000333D-6,    6496.374945429D0, 0.261537984D0,           &
     &    0.000340D-6,    6055.549660552D0, 5.975534987D0,           &
     &    0.000334D-6,    1066.495477190D0, 2.335063907D0,           &
     &    0.000399D-6,   11506.769769794D0, 5.321230910D0,           &
     &    0.000314D-6,   18319.536584880D0, 2.313312404D0,           &
     &    0.000424D-6,    1052.268383188D0, 1.211961766D0,           &
     &    0.000307D-6,      63.735898303D0, 3.169551388D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=601,610) /                         &
     &    0.000329D-6,      29.821438149D0, 6.106912080D0,           &
     &    0.000357D-6,    6309.374169791D0, 4.223760346D0,           &
     &    0.000312D-6,   -3738.761430108D0, 2.180556645D0,           &
     &    0.000301D-6,     309.278322656D0, 1.499984572D0,           &
     &    0.000268D-6,   12043.574281889D0, 2.447520648D0,           &
     &    0.000257D-6,   12491.370101415D0, 3.662331761D0,           &
     &    0.000290D-6,     625.670192312D0, 1.272834584D0,           &
     &    0.000256D-6,    5429.879468239D0, 1.913426912D0,           &
     &    0.000339D-6,    3496.032826134D0, 4.165930011D0,           &
     &    0.000283D-6,    3930.209696220D0, 4.325565754D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=611,620) /                         &
     &    0.000241D-6,   12528.018664345D0, 3.832324536D0,           &
     &    0.000304D-6,    4686.889407707D0, 1.612348468D0,           &
     &    0.000259D-6,   16200.772724501D0, 3.470173146D0,           &
     &    0.000238D-6,   12139.553509107D0, 1.147977842D0,           &
     &    0.000236D-6,    6172.869528772D0, 3.776271728D0,           &
     &    0.000296D-6,   -7058.598461315D0, 0.460368852D0,           &
     &    0.000306D-6,   10575.406682942D0, 0.554749016D0,           &
     &    0.000251D-6,   17298.182327326D0, 0.834332510D0,           &
     &    0.000290D-6,    4732.030627343D0, 4.759564091D0,           &
     &    0.000261D-6,    5884.926846583D0, 0.298259862D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=621,630) /                         &
     &    0.000249D-6,    5547.199336460D0, 3.749366406D0,           &
     &    0.000213D-6,   11712.955318231D0, 5.415666119D0,           &
     &    0.000223D-6,    4701.116501708D0, 2.703203558D0,           &
     &    0.000268D-6,    -640.877607382D0, 0.283670793D0,           &
     &    0.000209D-6,    5636.065016677D0, 1.238477199D0,           &
     &    0.000193D-6,   10177.257679534D0, 1.943251340D0,           &
     &    0.000182D-6,    6283.143160294D0, 2.456157599D0,           &
     &    0.000184D-6,    -227.526189440D0, 5.888038582D0,           &
     &    0.000182D-6,   -6283.008539689D0, 0.241332086D0,           &
     &    0.000228D-6,   -6284.056171060D0, 2.657323816D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=631,640) /                         &
     &    0.000166D-6,    7238.675591600D0, 5.930629110D0,           &
     &    0.000167D-6,    3097.883822726D0, 5.570955333D0,           &
     &    0.000159D-6,    -323.505416657D0, 5.786670700D0,           &
     &    0.000154D-6,   -4136.910433516D0, 1.517805532D0,           &
     &    0.000176D-6,   12029.347187887D0, 3.139266834D0,           &
     &    0.000167D-6,   12132.439962106D0, 3.556352289D0,           &
     &    0.000153D-6,     202.253395174D0, 1.463313961D0,           &
     &    0.000157D-6,   17267.268201691D0, 1.586837396D0,           &
     &    0.000142D-6,   83996.847317911D0, 0.022670115D0,           &
     &    0.000152D-6,   17260.154654690D0, 0.708528947D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=641,650) /                         &
     &    0.000144D-6,    6084.003848555D0, 5.187075177D0,           &
     &    0.000135D-6,    5756.566278634D0, 1.993229262D0,           &
     &    0.000134D-6,    5750.203491159D0, 3.457197134D0,           &
     &    0.000144D-6,    5326.786694021D0, 6.066193291D0,           &
     &    0.000160D-6,   11015.106477335D0, 1.710431974D0,           &
     &    0.000133D-6,    3634.621024518D0, 2.836451652D0,           &
     &    0.000134D-6,   18073.704938650D0, 5.453106665D0,           &
     &    0.000134D-6,    1162.474704408D0, 5.326898811D0,           &
     &    0.000128D-6,    5642.198242609D0, 2.511652591D0,           &
     &    0.000160D-6,     632.783739313D0, 5.628785365D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=651,660) /                         &
     &    0.000132D-6,   13916.019109642D0, 0.819294053D0,           &
     &    0.000122D-6,   14314.168113050D0, 5.677408071D0,           &
     &    0.000125D-6,   12359.966151546D0, 5.251984735D0,           &
     &    0.000121D-6,    5749.452731634D0, 2.210924603D0,           &
     &    0.000136D-6,    -245.831646229D0, 1.646502367D0,           &
     &    0.000120D-6,    5757.317038160D0, 3.240883049D0,           &
     &    0.000134D-6,   12146.667056108D0, 3.059480037D0,           &
     &    0.000137D-6,    6206.809778716D0, 1.867105418D0,           &
     &    0.000141D-6,   17253.041107690D0, 2.069217456D0,           &
     &    0.000129D-6,   -7477.522860216D0, 2.781469314D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=661,670) /                         &
     &    0.000116D-6,    5540.085789459D0, 4.281176991D0,           &
     &    0.000116D-6,    9779.108676125D0, 3.320925381D0,           &
     &    0.000129D-6,    5237.921013804D0, 3.497704076D0,           &
     &    0.000113D-6,    5959.570433334D0, 0.983210840D0,           &
     &    0.000122D-6,    6282.095528923D0, 2.674938860D0,           &
     &    0.000140D-6,     -11.045700264D0, 4.957936982D0,           &
     &    0.000108D-6,   23543.230504682D0, 1.390113589D0,           &
     &    0.000106D-6,  -12569.674818332D0, 0.429631317D0,           &
     &    0.000110D-6,    -266.607041722D0, 5.501340197D0,           &
     &    0.000115D-6,   12559.038152982D0, 4.691456618D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=671,680) /                         &
     &    0.000134D-6,   -2388.894020449D0, 0.577313584D0,           &
     &    0.000109D-6,   10440.274292604D0, 6.218148717D0,           &
     &    0.000102D-6,    -543.918059096D0, 1.477842615D0,           &
     &    0.000108D-6,   21228.392023546D0, 2.237753948D0,           &
     &    0.000101D-6,   -4535.059436924D0, 3.100492232D0,           &
     &    0.000103D-6,      76.266071276D0, 5.594294322D0,           &
     &    0.000104D-6,     949.175608970D0, 5.674287810D0,           &
     &    0.000101D-6,   13517.870106233D0, 2.196632348D0,           &
     &    0.000100D-6,   11933.367960670D0, 4.056084160D0,           &
!
!*  T^2
     &    4.322990D-6,    6283.075849991D0, 2.642893748D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=681,690) /                         &
     &    0.406495D-6,       0.000000000D0, 4.712388980D0,           &
     &    0.122605D-6,   12566.151699983D0, 2.438140634D0,           &
     &    0.019476D-6,     213.299095438D0, 1.642186981D0,           &
     &    0.016916D-6,     529.690965095D0, 4.510959344D0,           &
     &    0.013374D-6,      -3.523118349D0, 1.502210314D0,           &
     &    0.008042D-6,      26.298319800D0, 0.478549024D0,           &
     &    0.007824D-6,     155.420399434D0, 5.254710405D0,           &
     &    0.004894D-6,    5746.271337896D0, 4.683210850D0,           &
     &    0.004875D-6,    5760.498431898D0, 0.759507698D0,           &
     &    0.004416D-6,    5223.693919802D0, 6.028853166D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=691,700) /                         &
     &    0.004088D-6,      -7.113547001D0, 0.060926389D0,           &
     &    0.004433D-6,   77713.771467920D0, 3.627734103D0,           &
     &    0.003277D-6,   18849.227549974D0, 2.327912542D0,           &
     &    0.002703D-6,    6062.663207553D0, 1.271941729D0,           &
     &    0.003435D-6,    -775.522611324D0, 0.747446224D0,           &
     &    0.002618D-6,    6076.890301554D0, 3.633715689D0,           &
     &    0.003146D-6,     206.185548437D0, 5.647874613D0,           &
     &    0.002544D-6,    1577.343542448D0, 6.232904270D0,           &
     &    0.002218D-6,    -220.412642439D0, 1.309509946D0,           &
     &    0.002197D-6,    5856.477659115D0, 2.407212349D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=701,710) /                         &
     &    0.002897D-6,    5753.384884897D0, 5.863842246D0,           &
     &    0.001766D-6,     426.598190876D0, 0.754113147D0,           &
     &    0.001738D-6,    -796.298006816D0, 2.714942671D0,           &
     &    0.001695D-6,     522.577418094D0, 2.629369842D0,           &
     &    0.001584D-6,    5507.553238667D0, 1.341138229D0,           &
     &    0.001503D-6,    -242.728603974D0, 0.377699736D0,           &
     &    0.001552D-6,    -536.804512095D0, 2.904684667D0,           &
     &    0.001370D-6,    -398.149003408D0, 1.265599125D0,           &
     &    0.001889D-6,   -5573.142801634D0, 4.413514859D0,           &
     &    0.001722D-6,    6069.776754553D0, 2.445966339D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=711,720) /                         &
     &    0.001124D-6,    1059.381930189D0, 5.041799657D0,           &
     &    0.001258D-6,     553.569402842D0, 3.849557278D0,           &
     &    0.000831D-6,     951.718406251D0, 2.471094709D0,           &
     &    0.000767D-6,    4694.002954708D0, 5.363125422D0,           &
     &    0.000756D-6,    1349.867409659D0, 1.046195744D0,           &
     &    0.000775D-6,     -11.045700264D0, 0.245548001D0,           &
     &    0.000597D-6,    2146.165416475D0, 4.543268798D0,           &
     &    0.000568D-6,    5216.580372801D0, 4.178853144D0,           &
     &    0.000711D-6,    1748.016413067D0, 5.934271972D0,           &
     &    0.000499D-6,   12036.460734888D0, 0.624434410D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=721,730) /                         &
     &    0.000671D-6,   -1194.447010225D0, 4.136047594D0,           &
     &    0.000488D-6,    5849.364112115D0, 2.209679987D0,           &
     &    0.000621D-6,    6438.496249426D0, 4.518860804D0,           &
     &    0.000495D-6,   -6286.598968340D0, 1.868201275D0,           &
     &    0.000456D-6,    5230.807466803D0, 1.271231591D0,           &
     &    0.000451D-6,    5088.628839767D0, 0.084060889D0,           &
     &    0.000435D-6,    5643.178563677D0, 3.324456609D0,           &
     &    0.000387D-6,   10977.078804699D0, 4.052488477D0,           &
     &    0.000547D-6,  161000.685737473D0, 2.841633844D0,           &
     &    0.000522D-6,    3154.687084896D0, 2.171979966D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=731,740) /                         &
     &    0.000375D-6,    5486.777843175D0, 4.983027306D0,           &
     &    0.000421D-6,    5863.591206116D0, 4.546432249D0,           &
     &    0.000439D-6,    7084.896781115D0, 0.522967921D0,           &
     &    0.000309D-6,    2544.314419883D0, 3.172606705D0,           &
     &    0.000347D-6,    4690.479836359D0, 1.479586566D0,           &
     &    0.000317D-6,     801.820931124D0, 3.553088096D0,           &
     &    0.000262D-6,     419.484643875D0, 0.606635550D0,           &
     &    0.000248D-6,    6836.645252834D0, 3.014082064D0,           &
     &    0.000245D-6,   -1592.596013633D0, 5.519526220D0,           &
     &    0.000225D-6,    4292.330832950D0, 2.877956536D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=741,750) /                         &
     &    0.000214D-6,    7234.794256242D0, 1.605227587D0,           &
     &    0.000205D-6,    5767.611978898D0, 0.625804796D0,           &
     &    0.000180D-6,   10447.387839604D0, 3.499954526D0,           &
     &    0.000229D-6,     199.072001436D0, 5.632304604D0,           &
     &    0.000214D-6,     639.897286314D0, 5.960227667D0,           &
     &    0.000175D-6,    -433.711737877D0, 2.162417992D0,           &
     &    0.000209D-6,     515.463871093D0, 2.322150893D0,           &
     &    0.000173D-6,    6040.347246017D0, 2.556183691D0,           &
     &    0.000184D-6,    6309.374169791D0, 4.732296790D0,           &
     &    0.000227D-6,  149854.400134205D0, 5.385812217D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=751,760) /                         &
     &    0.000154D-6,    8031.092263058D0, 5.120720920D0,           &
     &    0.000151D-6,    5739.157790895D0, 4.815000443D0,           &
     &    0.000197D-6,    7632.943259650D0, 0.222827271D0,           &
     &    0.000197D-6,      74.781598567D0, 3.910456770D0,           &
     &    0.000138D-6,    6055.549660552D0, 1.397484253D0,           &
     &    0.000149D-6,   -6127.655450557D0, 5.333727496D0,           &
     &    0.000137D-6,    3894.181829542D0, 4.281749907D0,           &
     &    0.000135D-6,    9437.762934887D0, 5.979971885D0,           &
     &    0.000139D-6,   -2352.866153772D0, 4.715630782D0,           &
     &    0.000142D-6,    6812.766815086D0, 0.513330157D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=761,770) /                         &
     &    0.000120D-6,   -4705.732307544D0, 0.194160689D0,           &
     &    0.000131D-6,  -71430.695617928D0, 0.000379226D0,           &
     &    0.000124D-6,    6279.552731642D0, 2.122264908D0,           &
     &    0.000108D-6,   -6256.777530192D0, 0.883445696D0,           &
!
!  T^3
     &    0.143388D-6,    6283.075849991D0, 1.131453581D0,           &
     &    0.006671D-6,   12566.151699983D0, 0.775148887D0,           &
     &    0.001480D-6,     155.420399434D0, 0.480016880D0,           &
     &    0.000934D-6,     213.299095438D0, 6.144453084D0,           &
     &    0.000795D-6,     529.690965095D0, 2.941595619D0,           &
     &    0.000673D-6,    5746.271337896D0, 0.120415406D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=771,780) /                         &
     &    0.000672D-6,    5760.498431898D0, 5.317009738D0,           &
     &    0.000389D-6,    -220.412642439D0, 3.090323467D0,           &
     &    0.000373D-6,    6062.663207553D0, 3.003551964D0,           &
     &    0.000360D-6,    6076.890301554D0, 1.918913041D0,           &
     &    0.000316D-6,     -21.340641002D0, 5.545798121D0,           &
     &    0.000315D-6,    -242.728603974D0, 1.884932563D0,           &
     &    0.000278D-6,     206.185548437D0, 1.266254859D0,           &
     &    0.000238D-6,    -536.804512095D0, 4.532664830D0,           &
     &    0.000185D-6,     522.577418094D0, 4.578313856D0,           &
     &    0.000245D-6,   18849.227549974D0, 0.587467082D0 /
      DATA ((FAIRHD(I,J),I=1,3),J=781,787) /                         &
     &    0.000180D-6,     426.598190876D0, 5.151178553D0,           &
     &    0.000200D-6,     553.569402842D0, 5.355983739D0,           &
     &    0.000141D-6,    5223.693919802D0, 1.336556009D0,           &
     &    0.000104D-6,    5856.477659115D0, 4.239842759D0,           &
!
!  T^4
     &    0.003826D-6,    6283.075849991D0, 5.705257275D0,           &
     &    0.000303D-6,   12566.151699983D0, 5.407132842D0,           &
     &    0.000209D-6,     155.420399434D0, 1.989815753D0 /
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!  Time since J2000.0 in Julian millennia.
      T = ( ( DATE1-DJ00 ) + DATE2 ) / DJM
      dT = 1.D0 / (36525.D0 * 86400.D0)

!  =================
!  Topocentric terms
!  =================

!  Convert UT to local solar time in radians.
      TSOL = dMOD(UT,1D0) * D2PI + ELONG

!  FUNDAMENTAL ARGUMENTS:  Simon et al. 1994.

!  Combine time argument (millennia) with deg/arcsec factor.
      W = T / 3600D0

!  Sun Mean Longitude.
      ELSUN = dMOD(280.46645683D0 + 1296027711.03429D0 * W, 360D0)*DD2R

!  Sun Mean Anomaly.
      EMSUN = dMOD(357.52910918D0 + 1295965810.481D0 * W, 360D0) * DD2R

!  Mean Elongation of Moon from Sun.
      D = dMOD(297.85019547D0 + 16029616012.090D0 * W, 360D0) * DD2R

!  Mean Longitude of Jupiter.
      ELJ = dMOD(34.35151874D0 + 109306899.89453D0 * W, 360D0) * DD2R

!  Mean Longitude of Saturn.
      ELS = dMOD(50.07744430D0 + 44046398.47038D0 * W, 360D0) * DD2R

!  TOPOCENTRIC TERMS:  Moyer 1981 and Murray 1983.
      WT =  + 0.00029D-10 * U * dSIN(TSOL + ELSUN - ELS)              &
     &      + 0.00100D-10 * U * dSIN(TSOL - 2D0*EMSUN)                &
     &      + 0.00133D-10 * U * dSIN(TSOL - D)                        &
     &      + 0.00133D-10 * U * dSIN(TSOL + ELSUN - ELJ)              &
     &      - 0.00229D-10 * U * dSIN(TSOL + 2D0*ELSUN + EMSUN)        &
     &      -  0.0220D-10 * V * dCOS(ELSUN + EMSUN)                   &
     &      + 0.05312D-10 * U * dSIN(TSOL - EMSUN)                    &
     &      - 0.13677D-10 * U * dSIN(TSOL + 2D0*ELSUN)                &
     &      -  1.3184D-10 * V * dCOS(ELSUN)                           &
     &      + 3.17679D-10 * U * dSIN(TSOL)
!
      dWT = 0.D0
!  =====================
!  Fairhead et al. model
!  =====================

!  T**0
       W0 = 0.D0
      dW0 = 0.D0
      DO 10 J=474,1,-1
         W0 =  W0 + FAIRHD(1,J) * DSIN(FAIRHD(2,J)*T + FAIRHD(3,J))
        dW0 = dW0 + FAIRHD(1,J) * DCOS(FAIRHD(2,J)*T + FAIRHD(3,J)) *   &
     &       FAIRHD(2,J) * dT
 10   CONTINUE

!  T**1
       W1 = 0.D0
      dW1 = 0.D0
      DO 11 J=679,475,-1
         W1 =  W1 + FAIRHD(1,J) * DSIN(FAIRHD(2,J)*T + FAIRHD(3,J))
        dW1 = dW1 + FAIRHD(1,J) * DCOS(FAIRHD(2,J)*T + FAIRHD(3,J)) *   &
     &       FAIRHD(2,J) * dT
 11   CONTINUE

!  T**2
       W2 = 0.D0
      dW2 = 0.D0
      DO 12 J=764,680,-1
         W2 =  W2 + FAIRHD(1,J) * DSIN(FAIRHD(2,J)*T + FAIRHD(3,J))
        dW2 = dW2 + FAIRHD(1,J) * DCOS(FAIRHD(2,J)*T + FAIRHD(3,J)) *   & 
     &       FAIRHD(2,J) * dT
 12   CONTINUE

!  T**3
       W3 = 0.D0
      dW3 = 0.D0
      DO 13 J=784,765,-1
         W3 =  W3 + FAIRHD(1,J) * DSIN(FAIRHD(2,J)*T + FAIRHD(3,J))
        dW3 = dW3 + FAIRHD(1,J) * DCOS(FAIRHD(2,J)*T + FAIRHD(3,J)) *   &
     &       FAIRHD(2,J) * dT
 13   CONTINUE

!  T**4
       W4 = 0.D0
      dW4 = 0.D0
      DO 14 J=787,785,-1
         W4 =  W4 + FAIRHD(1,J) * DSIN(FAIRHD(2,J)*T + FAIRHD(3,J))
        dW4 = dW4 + FAIRHD(1,J) * DCOS(FAIRHD(2,J)*T + FAIRHD(3,J)) *   &
     &       FAIRHD(2,J) * dT
 14   CONTINUE

!  Multiply by powers of T and combine.
      WF = T * ( T * ( T * ( T * W4 + W3 ) + W2 ) + W1 ) + W0
      dWF = W1*dT + 2.D0*W2*T*dT + 3.D0*W3*T*T*dT + 4.D0*W4*T*T*T*dT

!  Adjustments to use JPL planetary masses instead of IAU.
       WJ =  0.00065D-6 * dSIN(6069.776754D0*T + 4.021194D0) +          &
     &       0.00033D-6 * dSIN( 213.299095D0*T + 5.543132D0) +          &
     &    ( -0.00196D-6 * dSIN(6208.294251D0*T + 5.696701D0) ) +        &
     &    ( -0.00173D-6 * dSIN(  74.781599D0*T + 2.435900D0) ) +        &
     &       0.03638D-6 * T * T
!
       dWJ = 0.00065D-6 * DCOS(6069.776754D0*T + 4.021194D0) *          &
     &       6069.776754D0 * dT +                                       &
     &       0.00033D-6 * DCOS( 213.299095D0*T + 5.543132D0) *          &
     &       213.299095D0 * dT  +                                       &
     &      (-0.00196D-6) * DCOS(6208.294251D0*T + 5.696701D0) *          &
     &       6208.294251D0 * dT +                                       &
     &      (-0.00173D-6) * DCOS(  74.781599D0*T + 2.435900D0) *          &
     &       74.781599D0 * dT   +                                       &
     &       2.D0 * 0.03638D-6 * T * dT 

!  ============
!  Final result
!  ============
!  TDB-TT in seconds.
        TDBmTT =  WT +  WF +  WJ
       dTDBmTT = dWT + dWF + dWJ
!  TDB-TT at geocenter in seconds.
        CTmTT =      WF +  WJ
       dCTmTT =     dWF + dWJ
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!*     write(6,*) ' TDBminusTT:  ' 
!*     write(6,*) 'TDBmTT,dTDBmTT ', TDBmTT,dTDBmTT 
!*     write(6,*) ' CTmTT, dCTmTT ', CTmTT, dCTmTT  
!*     write(6,*) '              ' 
!      Write(6,1010) WT*1.D9, WF*1.D9, WJ*1.D9
!      Write(6,1011) TDBmTT*1.D3, CTmTT*1.D3
!1010  Format('WT, WF, WJ (nsec):',3F24.6,/)
!1011  Format('TDBmTT (msec):',F20.10,' CTmTT (msec):',F20.10,/)
!      write(6,*) '                    '
!      write(6,*) ' T, dT  ', T, dT  
!      write(6,*) ' W0, W1, W2, W3, W4 ', W0,W1,W2,W3,W4
!      write(6,*) 'dW0,dW1,dW2,dW3,dW4 ', dW0,dW1,dW2,dW3,dW4
!      write(6,*) ' WT, WF, WJ ', WT, WF, WJ 
!      write(6,*) 'dWT,dWF,dWJ ', dWT, dWF, dWJ 
!      write(6,*) '                    '
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!  Finished.
!
      END
!----------------------------------------------------------------------
!  Nutation module utility, modified versions of SOFA subroutines.
!
!************************************************************************
      SUBROUTINE XYS2KA (DATE1, DATE2, CENT, DCENT, FA2K, FAD2K, &
     &                   X, Y, S )
!
!  - - - - - - - - -
!   X Y S 2 0 0 0 A
!  - - - - - - - - -
!
!  Implementation of Capitaine et al. (2002) series for X, Y and s+XY/2,
!  consistent with the IAU 2000A precession-nutation model.
!
!  Annexe to IERS Conventions 2000, Chapter 5
!
!  Given:
!     DATE1,DATE2   d      TT date (JD = DATE1+DATE2)
!
!  Returned:
!     X(2)          d      X-coordinate of CIP unit vector in GCRS
!                           and its time derivative.
!     Y(2)          d      Y-coordinate of CIP unit vector in GCRS
!                           and its time derivative.
!     S(2)          d      the quantity S, positioning the CEO
!                           and its time derivative.
!
!  Calls SOFA routine iau_ANPM.
!
!  This revision:  2002 December 17
!
!*************************************************************************
!   Modified version of XYS2000A for use in program Calc for VLBI analysis
!   and/or correlation. Name changed to XYS22KA. Input/outputs modified.
!   Time in centuries and funadmental luni-solar and planetary arguments
!   passed in. Time derivatives added. D. Gordon,
!   NASA/GSFC, Aug. 2004.
!
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
!
!     REAL*8           iau_ANPM
      REAL*8           DATE1, DATE2, CENT, DCENT, X(2), Y(2), S(2)
!  2Pi
      REAL*8           D2PI
      PARAMETER ( D2PI = 6.283185307179586476925287D0 )
!  Arcseconds to radians
      REAL*8           DAS2R
      PARAMETER ( DAS2R = 4.848136811095359935899141D-6 )
!  Reference epoch (J2000), JD
      REAL*8           DJ0
      PARAMETER ( DJ0 = 2451545D0 )
!  Days per Julian century
      REAL*8           DJC
      PARAMETER ( DJC = 36525D0 )
!  Time since J2000, in Julian centuries
      REAL*8           T
!  Miscellaneous
      INTEGER I, J
      REAL*8           A, S0, S1, S2, S3, S4, S5
!
!  Fundamental arguments
      REAL*8           FA(14), FAD(14), FA2K(14), FAD2K(14)
      REAL*8           dA, dS0, dS1, dS2, dS3, dS4, dS5, dTdt
!
!  ------------------------------
!  The series for X: declarations
!  ------------------------------
!
!  Number of terms in the series
      INTEGER NXP, NX0, NX1, NX2, NX3, NX4
      PARAMETER ( NXP=6, NX0=1306, NX1=253, NX2=36, NX3=4, NX4=1 )
!
!  Polynomial coefficients
      REAL*8           XP ( NXP )
!
!  Coefficients of l,l',F,D,Om,LMe,LVe,LE,LMa,LJu,LSa,LU,LN,pA
      INTEGER KX0 ( 14, NX0 ), &
     &        KX1 ( 14, NX1 ), &
     &        KX2 ( 14, NX2 ), &
     &        KX3 ( 14, NX3 ), &
     &        KX4 ( 14, NX4 )
!
!  Sine and cosine coefficients
      REAL*8           SX0 ( 2, NX0 ), &
     &                 SX1 ( 2, NX1 ), &
     &                 SX2 ( 2, NX2 ), &
     &                 SX3 ( 2, NX3 ), &
     &                 SX4 ( 2, NX4 )
!
!  ------------------------------
!  The series for Y: declarations
!  ------------------------------
!
!  Number of terms in the series
      INTEGER NYP, NY0, NY1, NY2, NY3, NY4
      PARAMETER ( NYP=6, NY0= 962, NY1=277, NY2=30, NY3=5, NY4=1 )
!
!  Polynomial coefficients
      REAL*8           YP ( NYP )
!
!  Coefficients of l,l',F,D,Om,LMe,LVe,LE,LMa,LJu,LSa,LU,LN,pA
      INTEGER KY0 ( 14, NY0 ), &
     &        KY1 ( 14, NY1 ), &
     &        KY2 ( 14, NY2 ), &
     &        KY3 ( 14, NY3 ), &
     &        KY4 ( 14, NY4 )
!
!  Sine and cosine coefficients
      REAL*8           SY0 ( 2, NY0 ), &
     &                 SY1 ( 2, NY1 ), &
     &                 SY2 ( 2, NY2 ), &
     &                 SY3 ( 2, NY3 ), &
     &                 SY4 ( 2, NY4 )
!
!  -----------------------------------
!  The series for s+XY/2: declarations
!  -----------------------------------
!
!  Number of terms in the series
      INTEGER NSP, NS0, NS1, NS2, NS3, NS4
      PARAMETER ( NSP=6, NS0=  33, NS1=  3, NS2=25, NS3=4, NS4=1 )
!
!  Polynomial coefficients
      REAL*8           SP ( NSP )
!
!  Coefficients of l,l',F,D,Om
      INTEGER KS0 ( 14, NS0 ), &
     &        KS1 ( 14, NS1 ), &
     &        KS2 ( 14, NS2 ), &
     &        KS3 ( 14, NS3 ), &
     &        KS4 ( 14, NS4 )
!
!  Sine and cosine coefficients
      REAL*8           SS0 ( 2, NS0 ), &
     &                 SS1 ( 2, NS1 ), &
     &                 SS2 ( 2, NS2 ), &
     &                 SS3 ( 2, NS3 ), &
     &                 SS4 ( 2, NS4 )
!
!  ----------------------------------
!  The series for X: numerical values
!  ----------------------------------
!
!  Polynomial coefficients
      DATA XP /     -16616.99D-6, &
     &          2004191742.88D-6, &
     &             -427219.05D-6, &
     &             -198620.54D-6, &
     &                 -46.05D-6, &
     &                   5.98D-6 /
!
!  Argument coefficients for t^0 terms
      DATA ( ( KX0(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   21,   30 ) / &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   31,   40 ) / &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  1,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   41,   50 ) / &
     &  0,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   51,   60 ) / &
     &  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -1, &
     &  0,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   61,   70 ) / &
     &  1, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   71,   80 ) / &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -2, &
     &  1,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -1,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   81,   90 ) / &
     &  1,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  2,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =   91,  100 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  2, &
     &  1,  0, -4,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  101,  110 ) / &
     &  0,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  111,  120 ) / &
     &  0,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  121,  130 ) / &
     &  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  131,  140 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2, -8,  3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -8,  3,  0,  0,  0,  2, &
     &  0,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2, &
     &  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2, -5,  0,  0,  0, &
     &  3,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  141,  150 ) / &
     &  2, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  2, -2,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  151,  160 ) / &
     &  0,  3,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  161,  170 ) / &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  2, &
     &  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0,  0, -2,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  171,  180 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  2, &
     &  1,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  181,  190 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1, &
     &  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  191,  200 ) / &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -2, &
     &  1,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  2, &
     &  4,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -1,  0,  0,  0, &
     &  1,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  201,  210 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  1, &
     &  2,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -2, &
     &  0,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  211,  220 ) / &
     &  2,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -2, &
     &  0,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -2,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  221,  230 ) / &
     &  0,  0,  4,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  2, &
     &  1,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  1,  0,  0,  0,  2, &
     &  2,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  231,  240 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  2, &
     &  0,  0,  1, -1,  1,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1, &
     &  1,  0,  0, -2,  0,  0, 19,-21,  3,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  241,  250 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, -2, &
     &  0,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  2, &
     &  3,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  251,  260 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  2, &
     &  1,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  2, &
     &  2,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -1, &
     &  1,  0,  0, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  261,  270 ) / &
     &  0,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  2, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  271,  280 ) / &
     &  4,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  3, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -2, &
     &  2,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  1,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  281,  290 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -1, &
     &  1, -1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,-18, 16,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  291,  300 ) / &
     &  2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -5,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -8, 13,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0, -6,  8,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  301,  310 ) / &
     &  1, -1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0, -2,  5,  0,  0,  0, &
     &  1,  0, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  311,  320 ) / &
     &  0,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  2, -5,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  2, &
     &  2,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-16,  4,  5,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  321,  330 ) / &
     &  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  2,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  331,  340 ) / &
     &  2,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -7,  0,  0,  0,  0,  0, -2, &
     &  2,  0, -4,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  1,  0,  0,  0, &
     &  3,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  341,  350 ) / &
     &  2,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -1,  0,  0,  0, &
     &  0,  2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  2, &
     &  1, -1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -1 /
      DATA ( ( KX0(I,J), I=1,14), J =  351,  360 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  1, -2,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  2, &
     &  1,  1, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0, -1 /
      DATA ( ( KX0(I,J), I=1,14), J =  361,  370 ) / &
     &  0,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0,  0, &
     &  3, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0,  0, -1,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  371,  380 ) / &
     &  0,  2,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  1, &
     &  2,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  381,  390 ) / &
     &  1,  0,  0, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1, &
     &  0,  0,  1, -1,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, &
     &  3,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  391,  400 ) / &
     &  0,  0,  0,  0,  0,  0,  8,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0, -1, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  1, -2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  1,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  401,  410 ) / &
     &  3,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  2, &
     &  2,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0, &
     &  2, -1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  411,  420 ) / &
     &  2,  0, -4, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, -2, &
     &  1,  1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -3,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  421,  430 ) / &
     &  1,  0,  2, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  2, -5,  0,  0,  0, &
     &  2,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  1, -1,  0,  0, -5,  7,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  431,  440 ) / &
     &  2,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -1, &
     &  1, -1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  441,  450 ) / &
     &  2, -2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  2, &
     &  2,  0,  0, -2,  0,  0,  0, -6,  8,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  451,  460 ) / &
     &  1, -1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  2,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -4, 10,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -5,  6,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  461,  470 ) / &
     &  2, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1,  0,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -4,  5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  471,  480 ) / &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &  1, -1, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -8,  3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  9,-11,  0,  0,  0,  0,  0, -2, &
     &  1,  0,  0, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  4,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  481,  490 ) / &
     &  0,  0,  2, -2,  1,  0,  0, -9, 13,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  491,  500 ) / &
     &  0,  0,  0,  0,  1,  0,  0, -2,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  501,  510 ) / &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  1, &
     &  1,  1, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  511,  520 ) / &
     &  2,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -1,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  1, &
     &  1,  1,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  521,  530 ) / &
     &  2,  0,  2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  2, &
     &  1,  1, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  531,  540 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -4,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  3,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -2,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  541,  550 ) / &
     &  3,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -8,  3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0, -2, &
     &  1, -2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0, -2,  5,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  551,  560 ) / &
     &  3,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0, -1,  1,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -1, &
     &  3,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  561,  570 ) / &
     &  1,  0,  0, -1, -1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  5,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -9,  4,  0,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0,  8,-14,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  3, -6,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  571,  580 ) / &
     &  1,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &  0,  2, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  4,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  581,  590 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0, -6,  8,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  591,  600 ) / &
     &  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -1,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  601,  610 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  1, &
     &  0,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0, -1,  0,  0,  0,  0, &
     &  1,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  611,  620 ) / &
     &  2,  1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -9, 15,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8, -8,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7,-11,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  621,  630 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  5,  0,  0,  2, &
     &  0,  1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  631,  640 ) / &
     &  3,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  641,  650 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -4,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  2, -5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  2, -5,  0,  0,  2, &
     &  1,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0, -1 /
      DATA ( ( KX0(I,J), I=1,14), J =  651,  660 ) / &
     &  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0, 11,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-15,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  1,  0,  0,  0,  2, &
     &  1,  0,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -7,  4,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  661,  670 ) / &
     &  0,  1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0, -8, 11,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  2, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  4, -3,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  0, -1 /
      DATA ( ( KX0(I,J), I=1,14), J =  671,  680 ) / &
     &  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-11,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5,  0, -2,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -4,  0,  0,  0,  0, &
     &  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  3, -1,  0,  0,  0, &
     &  2, -1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -2,  2,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  681,  690 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  3,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0, -6,  8,  0,  0,  0,  0,  0,  0, &
     &  1,  2, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  1,  0,  0,  0, &
     &  3,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  691,  700 ) / &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -5,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  1,  0, -3,  7, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -5,  0,  2,  0,  0,  0,  0, &
     &  0,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0,  0,  2,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  701,  710 ) / &
     &  0,  0,  2, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  2,  6,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  2, -4,  0, -3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9, -9,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  2, &
     &  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  711,  720 ) / &
     &  1,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  2, -4,  0,  0,  0,  0,  0, &
     &  1, -2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  721,  730 ) / &
     &  3, -1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  3,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  7,-13,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  3,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  731,  740 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  1, &
     &  1, -1,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  0,  5,  0,  0,  0, &
     &  3,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  741,  750 ) / &
     &  1,  0,  0, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  1, -1, -1,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  9,-17,  0,  0,  0,  0,  0, &
     &  3, -1, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  1 /
      DATA ( ( KX0(I,J), I=1,14), J =  751,  760 ) / &
     &  0,  0,  0,  0,  0,  0,  5,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-11,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0, -2, &
     &  1,  2,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  761,  770 ) / &
     &  2,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -4,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -5,  6,  0,  0,  0,  0,  0, &
     &  0,  0,  3,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1, -1,  0,  0, -1,  0,  3,  0,  0,  0,  0, &
     &  1,  2, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  771,  780 ) / &
     &  0,  0,  4, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  7,-13,  0,  0,  0,  0,  0, &
     &  5,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9,-12,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J =  781,  790 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  2,  0,  0,  0,  0, &
     &  1,  1, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0, -1,  2,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  791,  800 ) / &
     &  0,  2, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1, -1,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  2,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  3,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  3,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  801,  810 ) / &
     &  1, -1, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -5,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5,  0, -3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  811,  820 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  821,  830 ) / &
     &  1,  1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -8, 15,  0,  0,  0,  0,  0, &
     &  0,  2,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -6,  8,  0,  0,  0,  0,  0, &
     &  3, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1, -2,  0,  0, -1,  0,  2,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  831,  840 ) / &
     &  1,  2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0, -9, 13,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0, 20,-21,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  2,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -8, 11,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  2,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  2,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-12,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  841,  850 ) / &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -6,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  4,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  851,  860 ) / &
     &  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -6,  0,  0,  0,  0, -2, &
     &  0,  0,  2, -2,  1, -1,  0,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  861,  870 ) / &
     &  1, -2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  3,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -9, 17,  0,  0,  0,  0,  0, &
     &  1,  1,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  871,  880 ) / &
     &  3,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8, -8,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  8,-10,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  1 /
      DATA ( ( KX0(I,J), I=1,14), J =  881,  890 ) / &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0,  0, -2,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -2,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -6,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  891,  900 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  3, -7,  4,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -2,  0,  0,  0, &
     &  0,  0,  2,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  901,  910 ) / &
     &  0,  0,  0,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  1,  1,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2, -1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  2,  0, -4, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  911,  920 ) / &
     &  2,  0, -2, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1, -1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  4, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  921,  930 ) / &
     &  1,  0,  0, -2,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  1, -1,  0,-18, 17,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-12,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  8,-16,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J =  931,  940 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -7,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2, &
     &  0,  1,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  941,  950 ) / &
     &  2,  1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  1,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0, -3,  3,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  951,  960 ) / &
     &  1, -2,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1,  0,  0,  0, &
     &  1,  0, -2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  961,  970 ) / &
     &  0,  0,  2,  3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  971,  980 ) / &
     &  4, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  4, -5,  0,  0,  0, &
     &  2,  0, -1, -1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  3,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0, -4,  8, -3,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J =  981,  990 ) / &
     &  1,  0,  0,  0,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0, 17,-16,  0, -2,  0,  0,  0,  0, &
     &  1,  0, -1, -1, -1,  0, 20,-20,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  3, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  1, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9, -9,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  9,-11,  0,  0,  0,  0,  0, -1 /
      DATA ( ( KX0(I,J), I=1,14), J =  991, 1000 ) / &
     &  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5,-10,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -4,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -4,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -5,  0,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J = 1001, 1010 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -5,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -2, -2, &
     &  0,  2,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1011, 1020 ) / &
     &  1,  0, -1,  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  5, -8,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1, -1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1021, 1030 ) / &
     &  0,  0,  1, -1,  2,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1, -1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  2,  0, -2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1031, 1040 ) / &
     &  1,  0,  0, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  2,  0,  0, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1041, 1050 ) / &
     &  3,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  3, -6,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0, -4,  5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1051, 1060 ) / &
     &  0,  0,  1, -1,  0,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0,  0,  1,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  1, -2,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  3,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  2,  2,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1061, 1070 ) / &
     &  2,  0,  0, -2,  0,  0,  0, -4,  4,  0,  0,  0,  0,  0, &
     &  2, -2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1071, 1080 ) / &
     &  0,  0,  2, -2,  1,  0,  0, -3,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -5,  5,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  1, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0, -1,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -4,  6,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8, -9,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7,-10,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  1 /
      DATA ( ( KX0(I,J), I=1,14), J = 1081, 1090 ) / &
     &  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J = 1091, 1100 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3, -8,  3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0, &
     &  2,  1,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1101, 1110 ) / &
     &  3, -1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0, -4,  4,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1111, 1120 ) / &
     &  3,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -4,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &  3,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1121, 1130 ) / &
     &  0,  1,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &  0,  1,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1131, 1140 ) / &
     &  1,  0,  2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -6,  8,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -5,  6,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  2,  0, -1, -1,  1,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1141, 1150 ) / &
     &  2,  2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  3, -1,  0,  0,  0, &
     &  2, -1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0, -2,  2,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1151, 1160 ) / &
     &  5,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -2, -2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  2,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -8, 11,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1161, 1170 ) / &
     &  2,  0,  2, -2,  2,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0, -1,  0,  2,  0,  0,  0,  0,  0,  0, &
     &  4,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -6,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -4,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0, -1,  0,  0, -2,  0,  0,  0, &
     &  1, -1, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1171, 1180 ) / &
     &  2,  0, -1, -1,  0,  0,  0, -1,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, &
     &  4,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1181, 1190 ) / &
     &  2,  0,  1, -3,  1,  0, -6,  7,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  2, -5,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  5, -5,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  1,  5,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  0,  2,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0, -4,  4,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -2,  0,  0,  5, -9,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -5, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  3, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1191, 1200 ) / &
     &  1,  1, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -1,  0, -3,  5,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1, -1,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &  1,  0, -1, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  1,  0, -1,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1201, 1210 ) / &
     &  0,  0,  2,  2,  2,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -4,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -7,  9,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,-10, 15,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  1, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  1, -3,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -1,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -4,  6,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1211, 1220 ) / &
     &  0,  0,  0,  2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9,-13,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  8,-14,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  7,-11,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1221, 1230 ) / &
     &  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  5, -6, -4,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  2,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J = 1231, 1240 ) / &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  9,-17,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  7,-12,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -8,  1,  5,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J = 1241, 1250 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5,  0, -4,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -8,  3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  5,-13,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5,-16,  4,  5,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0, -1 /
      DATA ( ( KX0(I,J), I=1,14), J = 1251, 1260 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -5,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -7,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -9,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  2,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -3,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -8,  1,  5,  0,  0, -2 /
      DATA ( ( KX0(I,J), I=1,14), J = 1261, 1270 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1, -5,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -3,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -6,  3,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2 /
      DATA ( ( KX0(I,J), I=1,14), J = 1271, 1280 ) / &
     &  1,  1,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  0,  5,  0,  0,  0, &
     &  3,  0, -2, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -6,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1281, 1290 ) / &
     &  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  7,-13,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1, -1,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0, -3,  5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1291, 1300 ) / &
     &  0,  0,  1,  1,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -1,  2,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  0, -1,  0,  0,  0, &
     &  2,  1,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX0(I,J), I=1,14), J = 1301,  NX0 ) / &
     &  1,  0,  0, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  1,  0, -2,  4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^1 terms
      DATA ( ( KX1(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   21,   30 ) / &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  0,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   31,   40 ) / &
     &  0,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   41,   50 ) / &
     &  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -1, &
     &  0,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -1,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   51,   60 ) / &
     &  1, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -2, &
     &  1,  0, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   61,   70 ) / &
     &  1,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   71,   80 ) / &
     &  2,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  2, &
     &  1,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  2,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   81,   90 ) / &
     &  0,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1, &
     &  1,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =   91,  100 ) / &
     &  0,  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2, -5,  0,  0,  0, &
     &  1, -1,  0, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -8,  3,  0,  0,  0, -2, &
     &  1, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  101,  110 ) / &
     &  0,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -8,  3,  0,  0,  0,  2, &
     &  0,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  111,  120 ) / &
     &  1, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -2, &
     &  2, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2 /
      DATA ( ( KX1(I,J), I=1,14), J =  121,  130 ) / &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  3,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  131,  140 ) / &
     &  1,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1, &
     &  1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  2, &
     &  1,  0, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  2, &
     &  1,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  141,  150 ) / &
     &  1,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -1,  0,  0,  0, &
     &  1,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  1 /
      DATA ( ( KX1(I,J), I=1,14), J =  151,  160 ) / &
     &  2,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  2, &
     &  1,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  161,  170 ) / &
     &  1,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1, &
     &  0,  0,  1, -1,  1,  0, -5,  7,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  171,  180 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &  0,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0, -2, &
     &  1,  0, -2,  0, -2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -2,  0,  0,  0,  2, &
     &  0,  0,  4,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  181,  190 ) / &
     &  0,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  1,  0,  0,  0,  2, &
     &  1,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -2, &
     &  3,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  191,  200 ) / &
     &  1,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -1, &
     &  1,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  2, &
     &  3,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  2 /
      DATA ( ( KX1(I,J), I=1,14), J =  201,  210 ) / &
     &  2,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  2, &
     &  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  2, &
     &  0,  0,  2, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  3, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  211,  220 ) / &
     &  0,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  2, &
     &  3,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  221,  230 ) / &
     &  1,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -1, &
     &  2,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  2, &
     &  0,  0,  1, -1,  1,  0,  0, -5,  8, -3,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -2, &
     &  1, -1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  231,  240 ) / &
     &  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -2, &
     &  1,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  2, &
     &  1, -1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -8, 13,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -2 /
      DATA ( ( KX1(I,J), I=1,14), J =  241,  250 ) / &
     &  4,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0, -2,  5,  0,  0,  0, &
     &  2,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  2, -5,  0,  0,  0, &
     &  0,  2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &  2,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,-18, 16,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX1(I,J), I=1,14), J =  251,  NX1 ) / &
     &  1,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^2 terms
      DATA ( ( KX2(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX2(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX2(I,J), I=1,14), J =   21,   30 ) / &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KX2(I,J), I=1,14), J =   31,  NX2 ) / &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^3 terms
      DATA ( ( KX3(I,J), I=1,14), J =    1,  NX3 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^4 terms
      DATA ( ( KX4(I,J), I=1,14), J =    1,  NX4 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Sine and cosine coefficients for t^0 terms
      DATA ( ( SX0(I,J), I=1,2), J =    1,   10 ) / &
     &         -6844318.44D-6,       +1328.67D-6, &
     &          -523908.04D-6,        -544.76D-6, &
     &           -90552.22D-6,        +111.23D-6, &
     &           +82168.76D-6,         -27.64D-6, &
     &           +58707.02D-6,        +470.05D-6, &
     &           +28288.28D-6,         -34.69D-6, &
     &           -20557.78D-6,         -20.84D-6, &
     &           -15406.85D-6,         +15.12D-6, &
     &           -11991.74D-6,         +32.46D-6, &
     &            -8584.95D-6,          +4.42D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   11,   20 ) / &
     &            -6245.02D-6,          -6.68D-6, &
     &            +5095.50D-6,          +7.19D-6, &
     &            -4910.93D-6,          +0.76D-6, &
     &            +2521.07D-6,          -5.97D-6, &
     &            +2511.85D-6,          +1.07D-6, &
     &            +2372.58D-6,          +5.93D-6, &
     &            +2307.58D-6,          -7.52D-6, &
     &            -2053.16D-6,          +5.13D-6, &
     &            +1898.27D-6,          -0.72D-6, &
     &            -1825.49D-6,          +1.23D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   21,   30 ) / &
     &            -1534.09D-6,          +6.29D-6, &
     &            -1292.02D-6,          +0.00D-6, &
     &            -1234.96D-6,          +5.21D-6, &
     &            +1163.22D-6,          -2.94D-6, &
     &            +1137.48D-6,          -0.04D-6, &
     &            +1029.70D-6,          -2.63D-6, &
     &             -866.48D-6,          +0.52D-6, &
     &             -813.13D-6,          +0.40D-6, &
     &             +664.57D-6,          -0.40D-6, &
     &             -628.24D-6,          -0.64D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   31,   40 ) / &
     &             -603.52D-6,          +0.44D-6, &
     &             -556.26D-6,          +3.16D-6, &
     &             -512.37D-6,          -1.47D-6, &
     &             +506.65D-6,          +2.54D-6, &
     &             +438.51D-6,          -0.56D-6, &
     &             +405.91D-6,          +0.99D-6, &
     &             -122.67D-6,        +203.78D-6, &
     &             -305.78D-6,          +1.75D-6, &
     &             +300.99D-6,          -0.44D-6, &
     &             -292.37D-6,          -0.32D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   41,   50 ) / &
     &             +284.09D-6,          +0.32D-6, &
     &             -264.02D-6,          +0.99D-6, &
     &             +261.54D-6,          -0.95D-6, &
     &             +256.30D-6,          -0.28D-6, &
     &             -250.54D-6,          +0.08D-6, &
     &             +230.72D-6,          +0.08D-6, &
     &             +229.78D-6,          -0.60D-6, &
     &             -212.82D-6,          +0.84D-6, &
     &             +196.64D-6,          -0.84D-6, &
     &             +188.95D-6,          -0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   51,   60 ) / &
     &             +187.95D-6,          -0.24D-6, &
     &             -160.15D-6,         -14.04D-6, &
     &             -172.95D-6,          -0.40D-6, &
     &             -168.26D-6,          +0.20D-6, &
     &             +161.79D-6,          +0.24D-6, &
     &             +161.34D-6,          +0.20D-6, &
     &              +57.44D-6,         +95.82D-6, &
     &             +142.16D-6,          +0.20D-6, &
     &             -134.81D-6,          +0.20D-6, &
     &             +132.81D-6,          -0.52D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   61,   70 ) / &
     &             -130.31D-6,          +0.04D-6, &
     &             +121.98D-6,          -0.08D-6, &
     &             -115.40D-6,          +0.60D-6, &
     &             -114.49D-6,          +0.32D-6, &
     &             +112.14D-6,          +0.28D-6, &
     &             +105.29D-6,          +0.44D-6, &
     &              +98.69D-6,          -0.28D-6, &
     &              +91.31D-6,          -0.40D-6, &
     &              +86.74D-6,          -0.08D-6, &
     &              -18.38D-6,         +63.80D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   71,   80 ) / &
     &              +82.14D-6,          +0.00D-6, &
     &              +79.03D-6,          -0.24D-6, &
     &               +0.00D-6,         -79.08D-6, &
     &              -78.56D-6,          +0.00D-6, &
     &              +47.73D-6,         +23.79D-6, &
     &              +66.03D-6,          -0.20D-6, &
     &              +62.65D-6,          -0.24D-6, &
     &              +60.50D-6,          +0.36D-6, &
     &              +59.07D-6,          +0.00D-6, &
     &              +57.28D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   81,   90 ) / &
     &              -55.66D-6,          +0.16D-6, &
     &              -54.81D-6,          -0.08D-6, &
     &              -53.22D-6,          -0.20D-6, &
     &              -52.95D-6,          +0.32D-6, &
     &              -52.27D-6,          +0.00D-6, &
     &              +51.32D-6,          +0.00D-6, &
     &              -51.00D-6,          -0.12D-6, &
     &              +51.02D-6,          +0.00D-6, &
     &              -48.65D-6,          -1.15D-6, &
     &              +48.29D-6,          +0.20D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =   91,  100 ) / &
     &              -46.38D-6,          +0.00D-6, &
     &              -45.59D-6,          -0.12D-6, &
     &              -43.76D-6,          +0.36D-6, &
     &              -40.58D-6,          -1.00D-6, &
     &               +0.00D-6,         -41.53D-6, &
     &              +40.54D-6,          -0.04D-6, &
     &              +40.33D-6,          -0.04D-6, &
     &              -38.57D-6,          +0.08D-6, &
     &              +37.75D-6,          +0.04D-6, &
     &              +37.15D-6,          -0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  101,  110 ) / &
     &              +36.68D-6,          -0.04D-6, &
     &              -18.30D-6,         -17.30D-6, &
     &              -17.86D-6,         +17.10D-6, &
     &              -34.81D-6,          +0.04D-6, &
     &              -33.22D-6,          +0.08D-6, &
     &              +32.43D-6,          -0.04D-6, &
     &              -30.47D-6,          +0.04D-6, &
     &              -29.53D-6,          +0.04D-6, &
     &              +28.50D-6,          -0.08D-6, &
     &              +28.35D-6,          -0.16D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  111,  120 ) / &
     &              -28.00D-6,          +0.00D-6, &
     &              -27.61D-6,          +0.20D-6, &
     &              -26.77D-6,          +0.08D-6, &
     &              +26.54D-6,          -0.12D-6, &
     &              +26.54D-6,          +0.04D-6, &
     &              -26.17D-6,          +0.00D-6, &
     &              -25.42D-6,          -0.08D-6, &
     &              -16.91D-6,          +8.43D-6, &
     &               +0.32D-6,         +24.42D-6, &
     &              -19.53D-6,          +5.09D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  121,  130 ) / &
     &              -23.79D-6,          +0.00D-6, &
     &              +23.66D-6,          +0.00D-6, &
     &              -23.47D-6,          +0.16D-6, &
     &              +23.39D-6,          -0.12D-6, &
     &              -23.49D-6,          +0.00D-6, &
     &              -23.28D-6,          -0.08D-6, &
     &              -22.99D-6,          +0.04D-6, &
     &              -22.67D-6,          -0.08D-6, &
     &               +9.35D-6,         +13.29D-6, &
     &              +22.47D-6,          -0.04D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  131,  140 ) / &
     &               +4.89D-6,         -16.55D-6, &
     &               +4.89D-6,         -16.51D-6, &
     &              +21.28D-6,          -0.08D-6, &
     &              +20.57D-6,          +0.64D-6, &
     &              +21.01D-6,          +0.00D-6, &
     &               +1.23D-6,         -19.13D-6, &
     &              -19.97D-6,          +0.12D-6, &
     &              +19.65D-6,          -0.08D-6, &
     &              +19.58D-6,          -0.12D-6, &
     &              +19.61D-6,          -0.08D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  141,  150 ) / &
     &              -19.41D-6,          +0.08D-6, &
     &              -19.49D-6,          +0.00D-6, &
     &              -18.64D-6,          +0.00D-6, &
     &              +18.58D-6,          +0.04D-6, &
     &              -18.42D-6,          +0.00D-6, &
     &              +18.22D-6,          +0.00D-6, &
     &               -0.72D-6,         -17.34D-6, &
     &              -18.02D-6,          -0.04D-6, &
     &              +17.74D-6,          +0.08D-6, &
     &              +17.46D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  151,  160 ) / &
     &              -17.42D-6,          +0.00D-6, &
     &               -6.60D-6,         +10.70D-6, &
     &              +16.43D-6,          +0.52D-6, &
     &              -16.75D-6,          +0.04D-6, &
     &              +16.55D-6,          -0.08D-6, &
     &              +16.39D-6,          -0.08D-6, &
     &              +13.88D-6,          -2.47D-6, &
     &              +15.69D-6,          +0.00D-6, &
     &              -15.52D-6,          +0.00D-6, &
     &               +3.34D-6,         +11.86D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  161,  170 ) / &
     &              +14.72D-6,          -0.32D-6, &
     &              +14.92D-6,          -0.04D-6, &
     &               -3.26D-6,         +11.62D-6, &
     &              -14.64D-6,          +0.00D-6, &
     &               +0.00D-6,         +14.47D-6, &
     &              -14.37D-6,          +0.00D-6, &
     &              +14.32D-6,          -0.04D-6, &
     &              -14.10D-6,          +0.04D-6, &
     &              +10.86D-6,          +3.18D-6, &
     &              -10.58D-6,          -3.10D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  171,  180 ) / &
     &               -3.62D-6,          +9.86D-6, &
     &              -13.48D-6,          +0.00D-6, &
     &              +13.41D-6,          -0.04D-6, &
     &              +13.32D-6,          -0.08D-6, &
     &              -13.33D-6,          -0.04D-6, &
     &              -13.29D-6,          +0.00D-6, &
     &               -0.20D-6,         +13.05D-6, &
     &               +0.00D-6,         +13.13D-6, &
     &               -8.99D-6,          +4.02D-6, &
     &              -12.93D-6,          +0.04D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  181,  190 ) / &
     &               +2.03D-6,         +10.82D-6, &
     &              -12.78D-6,          +0.04D-6, &
     &              +12.24D-6,          +0.04D-6, &
     &               +8.71D-6,          +3.54D-6, &
     &              +11.98D-6,          -0.04D-6, &
     &              -11.38D-6,          +0.04D-6, &
     &              -11.30D-6,          +0.00D-6, &
     &              +11.14D-6,          -0.04D-6, &
     &              +10.98D-6,          +0.00D-6, &
     &              -10.98D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  191,  200 ) / &
     &               +0.44D-6,         -10.38D-6, &
     &              +10.46D-6,          +0.08D-6, &
     &              -10.42D-6,          +0.00D-6, &
     &              -10.30D-6,          +0.08D-6, &
     &               +6.92D-6,          +3.34D-6, &
     &              +10.07D-6,          +0.04D-6, &
     &              +10.02D-6,          +0.00D-6, &
     &               -9.75D-6,          +0.04D-6, &
     &               +9.75D-6,          +0.00D-6, &
     &               +9.67D-6,          -0.04D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  201,  210 ) / &
     &               -1.99D-6,          +7.72D-6, &
     &               +0.40D-6,          +9.27D-6, &
     &               -3.42D-6,          +6.09D-6, &
     &               +0.56D-6,          -8.67D-6, &
     &               -9.19D-6,          +0.00D-6, &
     &               +9.11D-6,          +0.00D-6, &
     &               +9.07D-6,          +0.00D-6, &
     &               +1.63D-6,          +6.96D-6, &
     &               -8.47D-6,          +0.00D-6, &
     &               -8.28D-6,          +0.04D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  211,  220 ) / &
     &               +8.27D-6,          +0.04D-6, &
     &               -8.04D-6,          +0.00D-6, &
     &               +7.91D-6,          +0.00D-6, &
     &               -7.84D-6,          -0.04D-6, &
     &               -7.64D-6,          +0.08D-6, &
     &               +5.21D-6,          -2.51D-6, &
     &               -5.77D-6,          +1.87D-6, &
     &               +5.01D-6,          -2.51D-6, &
     &               -7.48D-6,          +0.00D-6, &
     &               -7.32D-6,          -0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  221,  230 ) / &
     &               +7.40D-6,          -0.04D-6, &
     &               +7.44D-6,          +0.00D-6, &
     &               +6.32D-6,          -1.11D-6, &
     &               -6.13D-6,          -1.19D-6, &
     &               +0.20D-6,          -6.88D-6, &
     &               +6.92D-6,          +0.04D-6, &
     &               +6.48D-6,          -0.48D-6, &
     &               -6.94D-6,          +0.00D-6, &
     &               +2.47D-6,          -4.46D-6, &
     &               -2.23D-6,          -4.65D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  231,  240 ) / &
     &               -1.07D-6,          -5.69D-6, &
     &               +4.97D-6,          -1.71D-6, &
     &               +5.57D-6,          +1.07D-6, &
     &               -6.48D-6,          +0.08D-6, &
     &               +2.03D-6,          +4.53D-6, &
     &               +4.10D-6,          -2.39D-6, &
     &               +0.00D-6,          -6.44D-6, &
     &               -6.40D-6,          +0.00D-6, &
     &               +6.32D-6,          +0.00D-6, &
     &               +2.67D-6,          -3.62D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  241,  250 ) / &
     &               -1.91D-6,          -4.38D-6, &
     &               -2.43D-6,          -3.82D-6, &
     &               +6.20D-6,          +0.00D-6, &
     &               -3.38D-6,          -2.78D-6, &
     &               -6.12D-6,          +0.04D-6, &
     &               -6.09D-6,          -0.04D-6, &
     &               -6.01D-6,          -0.04D-6, &
     &               +3.18D-6,          -2.82D-6, &
     &               -5.05D-6,          +0.84D-6, &
     &               +5.85D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  251,  260 ) / &
     &               +5.69D-6,          -0.12D-6, &
     &               +5.73D-6,          -0.04D-6, &
     &               +5.61D-6,          +0.00D-6, &
     &               +5.49D-6,          +0.00D-6, &
     &               -5.33D-6,          +0.04D-6, &
     &               -5.29D-6,          +0.00D-6, &
     &               +5.25D-6,          +0.00D-6, &
     &               +0.99D-6,          +4.22D-6, &
     &               -0.99D-6,          +4.22D-6, &
     &               +0.00D-6,          +5.21D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  261,  270 ) / &
     &               +5.13D-6,          +0.04D-6, &
     &               -4.90D-6,          +0.00D-6, &
     &               -3.10D-6,          +1.79D-6, &
     &               -4.81D-6,          +0.04D-6, &
     &               -4.75D-6,          +0.00D-6, &
     &               +4.70D-6,          -0.04D-6, &
     &               -4.69D-6,          +0.00D-6, &
     &               -4.65D-6,          +0.00D-6, &
     &               +4.65D-6,          +0.00D-6, &
     &               -4.57D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  271,  280 ) / &
     &               +4.49D-6,          -0.04D-6, &
     &               -4.53D-6,          +0.00D-6, &
     &               +0.00D-6,          -4.53D-6, &
     &               +0.00D-6,          -4.53D-6, &
     &               -4.53D-6,          +0.00D-6, &
     &               +4.50D-6,          +0.00D-6, &
     &               -4.49D-6,          +0.00D-6, &
     &               +1.83D-6,          +2.63D-6, &
     &               +4.38D-6,          +0.00D-6, &
     &               +0.88D-6,          -3.46D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  281,  290 ) / &
     &               -2.70D-6,          +1.55D-6, &
     &               -4.22D-6,          +0.00D-6, &
     &               -4.10D-6,          -0.12D-6, &
     &               +3.54D-6,          -0.64D-6, &
     &               -3.50D-6,          +0.68D-6, &
     &               +4.18D-6,          +0.00D-6, &
     &               +4.14D-6,          +0.00D-6, &
     &               +4.10D-6,          +0.00D-6, &
     &               -4.06D-6,          +0.00D-6, &
     &               +2.70D-6,          -1.35D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  291,  300 ) / &
     &               -4.04D-6,          +0.00D-6, &
     &               -3.98D-6,          -0.04D-6, &
     &               -3.98D-6,          +0.04D-6, &
     &               +4.02D-6,          +0.00D-6, &
     &               +3.94D-6,          +0.00D-6, &
     &               +0.84D-6,          -3.10D-6, &
     &               +3.30D-6,          +0.60D-6, &
     &               -1.59D-6,          +2.27D-6, &
     &               -3.66D-6,          -0.20D-6, &
     &               -3.10D-6,          -0.72D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  301,  310 ) / &
     &               -3.82D-6,          +0.00D-6, &
     &               -3.62D-6,          -0.16D-6, &
     &               -3.74D-6,          +0.00D-6, &
     &               +3.74D-6,          +0.00D-6, &
     &               -3.74D-6,          +0.00D-6, &
     &               -3.71D-6,          +0.00D-6, &
     &               +3.02D-6,          +0.68D-6, &
     &               +3.70D-6,          +0.00D-6, &
     &               +3.30D-6,          +0.40D-6, &
     &               -3.66D-6,          +0.04D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  311,  320 ) / &
     &               +3.66D-6,          +0.04D-6, &
     &               -3.62D-6,          +0.00D-6, &
     &               -3.61D-6,          +0.00D-6, &
     &               -2.90D-6,          +0.68D-6, &
     &               +0.80D-6,          -2.78D-6, &
     &               +3.54D-6,          +0.00D-6, &
     &               -3.54D-6,          +0.00D-6, &
     &               -3.50D-6,          +0.00D-6, &
     &               +3.45D-6,          +0.00D-6, &
     &               +0.00D-6,          -3.42D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  321,  330 ) / &
     &               +3.38D-6,          +0.00D-6, &
     &               +2.27D-6,          -1.11D-6, &
     &               -3.34D-6,          +0.00D-6, &
     &               +3.34D-6,          +0.00D-6, &
     &               -3.30D-6,          +0.01D-6, &
     &               +3.31D-6,          +0.00D-6, &
     &               +3.30D-6,          +0.00D-6, &
     &               -3.30D-6,          +0.00D-6, &
     &               -1.39D-6,          -1.91D-6, &
     &               +3.30D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  331,  340 ) / &
     &               +3.26D-6,          +0.00D-6, &
     &               +3.26D-6,          +0.00D-6, &
     &               +3.22D-6,          -0.04D-6, &
     &               -3.26D-6,          +0.00D-6, &
     &               +2.51D-6,          -0.64D-6, &
     &               +3.14D-6,          +0.00D-6, &
     &               -2.63D-6,          -0.48D-6, &
     &               +3.10D-6,          +0.00D-6, &
     &               -3.06D-6,          +0.00D-6, &
     &               +2.94D-6,          -0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  341,  350 ) / &
     &               +3.06D-6,          +0.00D-6, &
     &               +0.00D-6,          +2.98D-6, &
     &               +2.98D-6,          +0.00D-6, &
     &               +2.07D-6,          +0.91D-6, &
     &               -2.98D-6,          +0.00D-6, &
     &               +2.94D-6,          +0.00D-6, &
     &               -2.94D-6,          +0.00D-6, &
     &               -2.94D-6,          +0.00D-6, &
     &               -2.90D-6,          +0.00D-6, &
     &               -0.56D-6,          -2.35D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  351,  360 ) / &
     &               -1.47D-6,          +1.39D-6, &
     &               +2.80D-6,          +0.00D-6, &
     &               -2.74D-6,          +0.00D-6, &
     &               -0.12D-6,          +2.63D-6, &
     &               +2.15D-6,          -0.60D-6, &
     &               -2.70D-6,          +0.00D-6, &
     &               +1.79D-6,          -0.88D-6, &
     &               -0.48D-6,          +2.19D-6, &
     &               +0.44D-6,          +2.23D-6, &
     &               +0.52D-6,          +2.07D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  361,  370 ) / &
     &               -2.59D-6,          +0.00D-6, &
     &               +2.55D-6,          +0.00D-6, &
     &               -1.11D-6,          +1.43D-6, &
     &               -2.51D-6,          +0.00D-6, &
     &               -2.51D-6,          +0.00D-6, &
     &               +2.51D-6,          +0.00D-6, &
     &               +0.00D-6,          -2.50D-6, &
     &               +2.47D-6,          +0.00D-6, &
     &               +2.11D-6,          -0.36D-6, &
     &               +1.67D-6,          +0.80D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  371,  380 ) / &
     &               +2.46D-6,          +0.00D-6, &
     &               -2.43D-6,          +0.00D-6, &
     &               -2.39D-6,          +0.00D-6, &
     &               -1.83D-6,          +0.56D-6, &
     &               -0.44D-6,          -1.95D-6, &
     &               +0.24D-6,          +2.15D-6, &
     &               +2.39D-6,          +0.00D-6, &
     &               +2.35D-6,          +0.00D-6, &
     &               +2.27D-6,          +0.00D-6, &
     &               -2.22D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  381,  390 ) / &
     &               -1.03D-6,          -1.15D-6, &
     &               +1.87D-6,          +0.32D-6, &
     &               -0.32D-6,          -1.87D-6, &
     &               +2.15D-6,          +0.00D-6, &
     &               -0.80D-6,          +1.35D-6, &
     &               +2.11D-6,          +0.00D-6, &
     &               -2.11D-6,          +0.00D-6, &
     &               -0.56D-6,          -1.55D-6, &
     &               +2.11D-6,          +0.00D-6, &
     &               -0.84D-6,          -1.27D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  391,  400 ) / &
     &               -1.99D-6,          +0.12D-6, &
     &               -0.24D-6,          +1.87D-6, &
     &               -0.24D-6,          -1.87D-6, &
     &               -2.03D-6,          +0.00D-6, &
     &               +2.03D-6,          +0.00D-6, &
     &               +2.03D-6,          +0.00D-6, &
     &               +2.03D-6,          +0.00D-6, &
     &               -0.40D-6,          +1.59D-6, &
     &               +1.99D-6,          +0.00D-6, &
     &               +1.95D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  401,  410 ) / &
     &               +1.95D-6,          +0.00D-6, &
     &               +1.91D-6,          +0.00D-6, &
     &               +1.19D-6,          -0.72D-6, &
     &               +1.87D-6,          +0.00D-6, &
     &               +1.87D-6,          +0.00D-6, &
     &               -1.27D-6,          +0.60D-6, &
     &               +0.72D-6,          -1.15D-6, &
     &               -0.99D-6,          +0.88D-6, &
     &               +1.87D-6,          +0.00D-6, &
     &               -1.87D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  411,  420 ) / &
     &               -1.83D-6,          +0.00D-6, &
     &               -1.79D-6,          +0.00D-6, &
     &               -1.79D-6,          +0.00D-6, &
     &               +1.79D-6,          +0.00D-6, &
     &               +0.00D-6,          -1.79D-6, &
     &               -1.79D-6,          +0.00D-6, &
     &               -1.75D-6,          +0.00D-6, &
     &               -1.75D-6,          +0.00D-6, &
     &               +1.75D-6,          +0.00D-6, &
     &               -1.47D-6,          -0.28D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  421,  430 ) / &
     &               -1.71D-6,          +0.00D-6, &
     &               +1.71D-6,          +0.00D-6, &
     &               +0.32D-6,          +1.39D-6, &
     &               +0.28D-6,          -1.43D-6, &
     &               -0.52D-6,          -1.19D-6, &
     &               +1.67D-6,          +0.00D-6, &
     &               -1.67D-6,          +0.00D-6, &
     &               +0.76D-6,          -0.91D-6, &
     &               -0.32D-6,          +1.35D-6, &
     &               -1.39D-6,          -0.28D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  431,  440 ) / &
     &               +1.63D-6,          +0.00D-6, &
     &               -1.59D-6,          +0.00D-6, &
     &               +1.03D-6,          -0.56D-6, &
     &               +1.59D-6,          +0.00D-6, &
     &               +1.55D-6,          +0.00D-6, &
     &               -0.28D-6,          -1.27D-6, &
     &               -0.64D-6,          +0.91D-6, &
     &               -0.32D-6,          -1.23D-6, &
     &               -1.55D-6,          +0.00D-6, &
     &               -1.51D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  441,  450 ) / &
     &               +1.51D-6,          +0.00D-6, &
     &               -1.51D-6,          +0.00D-6, &
     &               +1.51D-6,          +0.00D-6, &
     &               +1.47D-6,          +0.00D-6, &
     &               +1.47D-6,          +0.00D-6, &
     &               +0.95D-6,          -0.52D-6, &
     &               +1.23D-6,          -0.24D-6, &
     &               +0.60D-6,          +0.88D-6, &
     &               -1.47D-6,          +0.00D-6, &
     &               -1.43D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  451,  460 ) / &
     &               +1.43D-6,          +0.00D-6, &
     &               +1.43D-6,          +0.00D-6, &
     &               -0.68D-6,          -0.76D-6, &
     &               +0.95D-6,          -0.48D-6, &
     &               -0.95D-6,          -0.48D-6, &
     &               -1.19D-6,          -0.24D-6, &
     &               +0.36D-6,          -1.07D-6, &
     &               +0.95D-6,          +0.48D-6, &
     &               +1.43D-6,          +0.00D-6, &
     &               +1.39D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  461,  470 ) / &
     &               +1.39D-6,          +0.00D-6, &
     &               -1.39D-6,          +0.00D-6, &
     &               -1.39D-6,          +0.00D-6, &
     &               +0.00D-6,          +1.39D-6, &
     &               -0.12D-6,          -1.27D-6, &
     &               +0.56D-6,          +0.84D-6, &
     &               -0.44D-6,          -0.95D-6, &
     &               +0.32D-6,          -1.07D-6, &
     &               +1.03D-6,          -0.36D-6, &
     &               -0.28D-6,          +1.11D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  471,  480 ) / &
     &               +0.44D-6,          +0.95D-6, &
     &               -1.35D-6,          +0.00D-6, &
     &               +0.88D-6,          +0.48D-6, &
     &               -1.35D-6,          +0.00D-6, &
     &               +1.35D-6,          +0.00D-6, &
     &               +1.35D-6,          +0.00D-6, &
     &               -1.31D-6,          +0.00D-6, &
     &               +1.31D-6,          +0.00D-6, &
     &               -1.19D-6,          -0.12D-6, &
     &               +1.27D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  481,  490 ) / &
     &               +0.40D-6,          -0.88D-6, &
     &               +1.27D-6,          +0.00D-6, &
     &               +1.27D-6,          +0.00D-6, &
     &               -0.16D-6,          -1.11D-6, &
     &               -0.84D-6,          +0.44D-6, &
     &               +0.84D-6,          -0.44D-6, &
     &               +0.84D-6,          -0.44D-6, &
     &               -1.27D-6,          +0.00D-6, &
     &               -1.27D-6,          +0.00D-6, &
     &               +1.27D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  491,  500 ) / &
     &               -0.44D-6,          -0.84D-6, &
     &               +0.00D-6,          -1.27D-6, &
     &               -1.27D-6,          +0.00D-6, &
     &               -1.23D-6,          +0.00D-6, &
     &               -1.23D-6,          +0.00D-6, &
     &               +1.23D-6,          +0.00D-6, &
     &               +0.00D-6,          +1.23D-6, &
     &               -0.12D-6,          +1.11D-6, &
     &               +1.22D-6,          +0.00D-6, &
     &               +1.19D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  501,  510 ) / &
     &               -0.24D-6,          +0.95D-6, &
     &               -0.76D-6,          -0.44D-6, &
     &               +0.91D-6,          +0.28D-6, &
     &               +1.19D-6,          +0.00D-6, &
     &               +1.19D-6,          +0.00D-6, &
     &               +0.00D-6,          +1.19D-6, &
     &               +1.15D-6,          +0.00D-6, &
     &               +0.00D-6,          +1.15D-6, &
     &               -1.15D-6,          +0.00D-6, &
     &               +1.15D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  511,  520 ) / &
     &               -1.15D-6,          +0.00D-6, &
     &               +1.15D-6,          +0.00D-6, &
     &               +1.15D-6,          +0.00D-6, &
     &               -0.95D-6,          +0.20D-6, &
     &               +0.24D-6,          +0.91D-6, &
     &               -1.15D-6,          +0.00D-6, &
     &               -1.12D-6,          +0.00D-6, &
     &               -1.11D-6,          +0.00D-6, &
     &               -1.11D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.95D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  521,  530 ) / &
     &               -1.11D-6,          +0.00D-6, &
     &               +1.11D-6,          +0.00D-6, &
     &               +0.20D-6,          -0.91D-6, &
     &               -0.72D-6,          -0.40D-6, &
     &               -1.11D-6,          +0.00D-6, &
     &               -1.11D-6,          +0.00D-6, &
     &               +1.07D-6,          +0.00D-6, &
     &               -1.07D-6,          +0.00D-6, &
     &               +0.76D-6,          -0.32D-6, &
     &               +0.00D-6,          -1.07D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  531,  540 ) / &
     &               +1.07D-6,          +0.00D-6, &
     &               +1.07D-6,          +0.00D-6, &
     &               -1.07D-6,          +0.00D-6, &
     &               +1.07D-6,          +0.00D-6, &
     &               -0.84D-6,          -0.24D-6, &
     &               +0.00D-6,          -1.03D-6, &
     &               +1.03D-6,          +0.00D-6, &
     &               -1.03D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.80D-6, &
     &               +0.20D-6,          +0.84D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  541,  550 ) / &
     &               -1.03D-6,          +0.00D-6, &
     &               -1.03D-6,          +0.00D-6, &
     &               -0.99D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.76D-6, &
     &               -0.99D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.84D-6, &
     &               -0.99D-6,          +0.00D-6, &
     &               -0.64D-6,          +0.36D-6, &
     &               +0.99D-6,          +0.00D-6, &
     &               +0.36D-6,          -0.64D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  551,  560 ) / &
     &               -0.95D-6,          +0.00D-6, &
     &               -0.95D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.95D-6, &
     &               +0.64D-6,          +0.32D-6, &
     &               +0.00D-6,          -0.95D-6, &
     &               +0.84D-6,          +0.12D-6, &
     &               +0.20D-6,          +0.76D-6, &
     &               -0.95D-6,          +0.00D-6, &
     &               +0.95D-6,          +0.00D-6, &
     &               -0.95D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  561,  570 ) / &
     &               +0.00D-6,          +0.92D-6, &
     &               +0.91D-6,          +0.00D-6, &
     &               +0.91D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.52D-6, &
     &               -0.91D-6,          +0.00D-6, &
     &               -0.56D-6,          +0.36D-6, &
     &               +0.44D-6,          -0.48D-6, &
     &               -0.91D-6,          +0.00D-6, &
     &               -0.91D-6,          +0.00D-6, &
     &               -0.36D-6,          -0.56D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  571,  580 ) / &
     &               +0.91D-6,          +0.00D-6, &
     &               -0.88D-6,          +0.00D-6, &
     &               -0.88D-6,          +0.00D-6, &
     &               +0.60D-6,          -0.28D-6, &
     &               +0.88D-6,          +0.00D-6, &
     &               +0.36D-6,          -0.52D-6, &
     &               -0.52D-6,          +0.36D-6, &
     &               +0.52D-6,          +0.36D-6, &
     &               +0.00D-6,          +0.88D-6, &
     &               +0.56D-6,          +0.32D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  581,  590 ) / &
     &               +0.64D-6,          -0.24D-6, &
     &               +0.88D-6,          +0.00D-6, &
     &               +0.88D-6,          +0.00D-6, &
     &               +0.88D-6,          +0.00D-6, &
     &               +0.84D-6,          +0.00D-6, &
     &               -0.68D-6,          -0.16D-6, &
     &               +0.84D-6,          +0.00D-6, &
     &               +0.56D-6,          +0.28D-6, &
     &               -0.16D-6,          +0.68D-6, &
     &               +0.64D-6,          -0.20D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  591,  600 ) / &
     &               +0.16D-6,          +0.68D-6, &
     &               +0.72D-6,          -0.12D-6, &
     &               -0.83D-6,          +0.00D-6, &
     &               -0.80D-6,          +0.00D-6, &
     &               +0.80D-6,          +0.00D-6, &
     &               -0.80D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.52D-6, &
     &               +0.68D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.80D-6, &
     &               -0.32D-6,          +0.48D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  601,  610 ) / &
     &               +0.36D-6,          -0.44D-6, &
     &               -0.36D-6,          -0.44D-6, &
     &               -0.80D-6,          +0.00D-6, &
     &               +0.79D-6,          +0.00D-6, &
     &               +0.74D-6,          -0.04D-6, &
     &               -0.76D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.76D-6, &
     &               +0.16D-6,          +0.60D-6, &
     &               -0.76D-6,          +0.00D-6, &
     &               -0.76D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  611,  620 ) / &
     &               +0.76D-6,          +0.00D-6, &
     &               -0.76D-6,          +0.00D-6, &
     &               +0.76D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.64D-6, &
     &               +0.76D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.76D-6, &
     &               +0.76D-6,          +0.00D-6, &
     &               +0.64D-6,          -0.12D-6, &
     &               +0.16D-6,          -0.60D-6, &
     &               +0.76D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  621,  630 ) / &
     &               +0.00D-6,          -0.76D-6, &
     &               +0.28D-6,          -0.48D-6, &
     &               +0.32D-6,          +0.44D-6, &
     &               -0.76D-6,          +0.00D-6, &
     &               +0.72D-6,          +0.00D-6, &
     &               +0.72D-6,          +0.00D-6, &
     &               +0.48D-6,          -0.24D-6, &
     &               -0.72D-6,          +0.00D-6, &
     &               +0.72D-6,          +0.00D-6, &
     &               -0.72D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  631,  640 ) / &
     &               -0.72D-6,          +0.00D-6, &
     &               -0.71D-6,          +0.00D-6, &
     &               -0.68D-6,          +0.00D-6, &
     &               -0.68D-6,          +0.00D-6, &
     &               +0.68D-6,          +0.00D-6, &
     &               +0.68D-6,          +0.00D-6, &
     &               +0.68D-6,          +0.00D-6, &
     &               -0.68D-6,          +0.00D-6, &
     &               +0.56D-6,          -0.12D-6, &
     &               -0.68D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  641,  650 ) / &
     &               -0.68D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.48D-6, &
     &               -0.44D-6,          -0.24D-6, &
     &               -0.68D-6,          +0.00D-6, &
     &               +0.64D-6,          +0.00D-6, &
     &               +0.64D-6,          +0.00D-6, &
     &               -0.64D-6,          +0.00D-6, &
     &               +0.64D-6,          +0.00D-6, &
     &               -0.64D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.52D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  651,  660 ) / &
     &               -0.12D-6,          -0.52D-6, &
     &               -0.16D-6,          -0.48D-6, &
     &               -0.20D-6,          -0.44D-6, &
     &               -0.44D-6,          +0.20D-6, &
     &               -0.44D-6,          +0.20D-6, &
     &               +0.24D-6,          -0.40D-6, &
     &               -0.20D-6,          -0.44D-6, &
     &               -0.64D-6,          +0.00D-6, &
     &               +0.40D-6,          -0.24D-6, &
     &               -0.64D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  661,  670 ) / &
     &               +0.64D-6,          +0.00D-6, &
     &               -0.63D-6,          +0.00D-6, &
     &               -0.60D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               -0.60D-6,          +0.00D-6, &
     &               -0.60D-6,          +0.00D-6, &
     &               +0.60D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.24D-6,          -0.36D-6, &
     &               +0.12D-6,          +0.48D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  671,  680 ) / &
     &               +0.48D-6,          -0.12D-6, &
     &               +0.12D-6,          +0.48D-6, &
     &               +0.24D-6,          -0.36D-6, &
     &               +0.36D-6,          +0.24D-6, &
     &               +0.12D-6,          +0.48D-6, &
     &               +0.44D-6,          +0.16D-6, &
     &               -0.60D-6,          +0.00D-6, &
     &               -0.60D-6,          +0.00D-6, &
     &               +0.60D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.60D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  681,  690 ) / &
     &               +0.59D-6,          +0.00D-6, &
     &               -0.56D-6,          +0.00D-6, &
     &               -0.44D-6,          -0.12D-6, &
     &               +0.56D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.56D-6, &
     &               -0.56D-6,          +0.00D-6, &
     &               -0.56D-6,          +0.00D-6, &
     &               +0.56D-6,          +0.00D-6, &
     &               -0.56D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.40D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  691,  700 ) / &
     &               +0.44D-6,          -0.12D-6, &
     &               +0.20D-6,          -0.36D-6, &
     &               -0.36D-6,          -0.20D-6, &
     &               -0.56D-6,          +0.00D-6, &
     &               +0.55D-6,          +0.00D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.36D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  701,  710 ) / &
     &               -0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.52D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.40D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  711,  720 ) / &
     &               +0.00D-6,          -0.52D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               -0.51D-6,          +0.00D-6, &
     &               -0.51D-6,          +0.00D-6, &
     &               +0.48D-6,          +0.00D-6, &
     &               +0.48D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.32D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               -0.48D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  721,  730 ) / &
     &               +0.48D-6,          +0.00D-6, &
     &               +0.48D-6,          +0.00D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               -0.12D-6,          -0.36D-6, &
     &               -0.32D-6,          +0.16D-6, &
     &               +0.32D-6,          -0.16D-6, &
     &               -0.12D-6,          -0.36D-6, &
     &               +0.16D-6,          +0.32D-6, &
     &               +0.20D-6,          -0.28D-6, &
     &               -0.20D-6,          -0.28D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  731,  740 ) / &
     &               -0.36D-6,          +0.12D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               +0.32D-6,          -0.16D-6, &
     &               +0.48D-6,          +0.00D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.48D-6, &
     &               +0.48D-6,          +0.00D-6, &
     &               -0.48D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  741,  750 ) / &
     &               -0.48D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.48D-6, &
     &               +0.44D-6,          +0.00D-6, &
     &               -0.32D-6,          -0.12D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               +0.20D-6,          -0.24D-6, &
     &               +0.44D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               +0.44D-6,          +0.00D-6, &
     &               +0.20D-6,          -0.24D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  751,  760 ) / &
     &               +0.12D-6,          +0.32D-6, &
     &               -0.20D-6,          +0.24D-6, &
     &               +0.32D-6,          -0.12D-6, &
     &               +0.00D-6,          +0.44D-6, &
     &               +0.00D-6,          +0.44D-6, &
     &               +0.44D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               +0.44D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  761,  770 ) / &
     &               +0.44D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.16D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.12D-6,          +0.28D-6, &
     &               +0.40D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  771,  780 ) / &
     &               -0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.20D-6,          -0.20D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  781,  790 ) / &
     &               -0.12D-6,          -0.28D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               -0.20D-6,          -0.16D-6, &
     &               +0.36D-6,          +0.00D-6, &
     &               +0.36D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  791,  800 ) / &
     &               +0.24D-6,          -0.12D-6, &
     &               +0.20D-6,          -0.16D-6, &
     &               +0.00D-6,          +0.36D-6, &
     &               +0.00D-6,          +0.36D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.24D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               -0.36D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  801,  810 ) / &
     &               +0.36D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.36D-6, &
     &               +0.00D-6,          +0.36D-6, &
     &               +0.00D-6,          +0.36D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.36D-6, &
     &               +0.12D-6,          -0.24D-6, &
     &               -0.24D-6,          +0.12D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.36D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  811,  820 ) / &
     &               +0.36D-6,          +0.00D-6, &
     &               +0.24D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.36D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               +0.36D-6,          +0.00D-6, &
     &               +0.36D-6,          +0.00D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               +0.36D-6,          +0.00D-6, &
     &               -0.13D-6,          +0.22D-6, &
     &               -0.32D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  821,  830 ) / &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               -0.20D-6,          -0.12D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.20D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.32D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  831,  840 ) / &
     &               +0.32D-6,          +0.00D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               +0.12D-6,          -0.20D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.32D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.32D-6, &
     &               +0.00D-6,          -0.32D-6, &
     &               +0.00D-6,          -0.32D-6, &
     &               +0.32D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  841,  850 ) / &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.32D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.32D-6, &
     &               +0.00D-6,          -0.32D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.16D-6, &
     &               -0.16D-6,          +0.16D-6, &
     &               +0.00D-6,          +0.32D-6, &
     &               +0.20D-6,          +0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  851,  860 ) / &
     &               +0.20D-6,          +0.12D-6, &
     &               -0.20D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.20D-6, &
     &               +0.12D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.32D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  861,  870 ) / &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.12D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               -0.12D-6,          -0.16D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  871,  880 ) / &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.28D-6, &
     &               +0.00D-6,          +0.28D-6, &
     &               +0.00D-6,          -0.28D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  881,  890 ) / &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.12D-6,          -0.16D-6, &
     &               +0.00D-6,          +0.28D-6, &
     &               +0.00D-6,          -0.28D-6, &
     &               +0.12D-6,          -0.16D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.28D-6, &
     &               +0.00D-6,          +0.28D-6, &
     &               +0.00D-6,          -0.28D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  891,  900 ) / &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.12D-6,          -0.16D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.28D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  901,  910 ) / &
     &               +0.00D-6,          -0.28D-6, &
     &               +0.28D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.24D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  911,  920 ) / &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.24D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  921,  930 ) / &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.24D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.24D-6, &
     &               +0.12D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.24D-6, &
     &               -0.24D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  931,  940 ) / &
     &               +0.00D-6,          +0.24D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.24D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  941,  950 ) / &
     &               +0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               -0.24D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.24D-6, &
     &               +0.00D-6,          -0.24D-6, &
     &               +0.24D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  951,  960 ) / &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  961,  970 ) / &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  971,  980 ) / &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  981,  990 ) / &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6 /
      DATA ( ( SX0(I,J), I=1,2), J =  991, 1000 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1001, 1010 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1011, 1020 ) / &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1021, 1030 ) / &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.16D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1031, 1040 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1041, 1050 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.04D-6,          +0.12D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.00D-6,          -0.16D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1051, 1060 ) / &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1061, 1070 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6 /
!
      DATA ( ( SX0(I,J), I=1,2), J = 1071, 1080 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1081, 1090 ) / &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.00D-6,          +0.16D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1091, 1100 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1101, 1110 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.16D-6, &
     &               +0.00D-6,          +0.16D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1111, 1120 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               -0.16D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6, &
     &               +0.16D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1121, 1130 ) / &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.15D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1131, 1140 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1141, 1150 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1151, 1160 ) / &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1161, 1170 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1171, 1180 ) / &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.08D-6,          +0.04D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1181, 1190 ) / &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1191, 1200 ) / &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1201, 1210 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1211, 1220 ) / &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1221, 1230 ) / &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1231, 1240 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1241, 1250 ) / &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1251, 1260 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          -0.12D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1261, 1270 ) / &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1271, 1280 ) / &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1281, 1290 ) / &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1291, 1300 ) / &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
      DATA ( ( SX0(I,J), I=1,2), J = 1301,  NX0 ) / &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.11D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^1 terms
      DATA ( ( SX1(I,J), I=1,2), J =    1,   10 ) / &
     &            -3328.48D-6,     +205833.15D-6, &
     &             +197.53D-6,      +12814.01D-6, &
     &              +41.19D-6,       +2187.91D-6, &
     &              -35.85D-6,       -2004.36D-6, &
     &              +59.15D-6,        +501.82D-6, &
     &               -5.82D-6,        +448.76D-6, &
     &             -179.56D-6,        +164.33D-6, &
     &               +5.67D-6,        +288.49D-6, &
     &              +23.85D-6,        -214.50D-6, &
     &               +2.87D-6,        -154.91D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   11,   20 ) / &
     &               +2.14D-6,        -119.21D-6, &
     &               +1.17D-6,         -74.33D-6, &
     &               +1.47D-6,         +70.31D-6, &
     &               -0.42D-6,         +58.94D-6, &
     &               -0.95D-6,         +57.12D-6, &
     &               -1.08D-6,         -54.19D-6, &
     &               +0.92D-6,         +36.78D-6, &
     &               +0.68D-6,         -31.01D-6, &
     &               +0.74D-6,         +29.60D-6, &
     &               -0.60D-6,         -27.59D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   21,   30 ) / &
     &              -11.11D-6,         -15.07D-6, &
     &               -0.40D-6,         -24.05D-6, &
     &               -0.81D-6,         +19.06D-6, &
     &               +3.18D-6,         +15.32D-6, &
     &               -0.08D-6,         -17.90D-6, &
     &               -0.16D-6,         +15.55D-6, &
     &               -0.77D-6,         +14.40D-6, &
     &               -0.25D-6,         +11.67D-6, &
     &               +6.18D-6,          +3.58D-6, &
     &               -1.00D-6,          -7.27D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   31,   40 ) / &
     &               -0.99D-6,          +6.87D-6, &
     &               -0.27D-6,          +7.49D-6, &
     &               -0.30D-6,          +7.31D-6, &
     &               +0.20D-6,          +7.30D-6, &
     &               +0.33D-6,          +6.80D-6, &
     &               +0.27D-6,          -6.81D-6, &
     &               +0.35D-6,          +6.08D-6, &
     &               +0.35D-6,          +6.09D-6, &
     &               -0.14D-6,          -6.19D-6, &
     &               +0.14D-6,          +6.02D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   41,   50 ) / &
     &               +2.69D-6,          -2.76D-6, &
     &               -0.08D-6,          -4.93D-6, &
     &               +2.85D-6,          -1.77D-6, &
     &               -0.07D-6,          -4.27D-6, &
     &               -3.71D-6,          +0.38D-6, &
     &               +3.75D-6,          +0.04D-6, &
     &               -0.82D-6,          -2.73D-6, &
     &               -0.06D-6,          +2.93D-6, &
     &               -0.04D-6,          +2.83D-6, &
     &               +0.08D-6,          +2.75D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   51,   60 ) / &
     &               +0.07D-6,          +2.75D-6, &
     &               -0.07D-6,          +2.70D-6, &
     &               -0.07D-6,          +2.52D-6, &
     &               -0.05D-6,          -2.53D-6, &
     &               -0.04D-6,          +2.40D-6, &
     &               -0.06D-6,          -2.37D-6, &
     &               +0.69D-6,          -1.45D-6, &
     &               -0.04D-6,          +2.00D-6, &
     &               +1.99D-6,          +0.02D-6, &
     &               -0.94D-6,          +1.07D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   61,   70 ) / &
     &               +0.04D-6,          +1.91D-6, &
     &               -0.58D-6,          -1.36D-6, &
     &               -0.51D-6,          -1.25D-6, &
     &               -0.04D-6,          -1.59D-6, &
     &               +0.39D-6,          -1.23D-6, &
     &               +0.03D-6,          -1.57D-6, &
     &               -0.03D-6,          +1.50D-6, &
     &               +0.04D-6,          +1.48D-6, &
     &               -0.04D-6,          +1.45D-6, &
     &               +0.02D-6,          -1.36D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   71,   80 ) / &
     &               +0.03D-6,          -1.32D-6, &
     &               -0.03D-6,          -1.24D-6, &
     &               -0.02D-6,          -1.18D-6, &
     &               -0.03D-6,          +1.16D-6, &
     &               +0.02D-6,          +1.13D-6, &
     &               +0.04D-6,          -1.11D-6, &
     &               +0.02D-6,          +1.11D-6, &
     &               +0.03D-6,          -1.10D-6, &
     &               +0.03D-6,          +1.04D-6, &
     &               -0.51D-6,          +0.56D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   81,   90 ) / &
     &               +0.02D-6,          -0.98D-6, &
     &               -0.02D-6,          -0.94D-6, &
     &               -0.02D-6,          -0.89D-6, &
     &               -0.02D-6,          -0.88D-6, &
     &               +0.31D-6,          +0.60D-6, &
     &               +0.02D-6,          -0.87D-6, &
     &               -0.02D-6,          -0.87D-6, &
     &               -0.01D-6,          +0.83D-6, &
     &               -0.02D-6,          +0.77D-6, &
     &               +0.42D-6,          -0.36D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =   91,  100 ) / &
     &               -0.01D-6,          -0.73D-6, &
     &               +0.01D-6,          +0.71D-6, &
     &               +0.01D-6,          +0.68D-6, &
     &               +0.02D-6,          +0.66D-6, &
     &               -0.01D-6,          -0.62D-6, &
     &               -0.01D-6,          +0.62D-6, &
     &               -0.58D-6,          -0.03D-6, &
     &               -0.01D-6,          +0.58D-6, &
     &               +0.44D-6,          +0.14D-6, &
     &               +0.02D-6,          +0.56D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  101,  110 ) / &
     &               +0.01D-6,          -0.57D-6, &
     &               -0.13D-6,          -0.45D-6, &
     &               +0.01D-6,          +0.56D-6, &
     &               +0.01D-6,          -0.55D-6, &
     &               +0.01D-6,          +0.55D-6, &
     &               -0.52D-6,          +0.03D-6, &
     &               -0.01D-6,          +0.54D-6, &
     &               -0.01D-6,          -0.51D-6, &
     &               -0.41D-6,          -0.11D-6, &
     &               -0.01D-6,          +0.50D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  111,  120 ) / &
     &               +0.01D-6,          +0.48D-6, &
     &               +0.45D-6,          -0.04D-6, &
     &               +0.01D-6,          -0.48D-6, &
     &               +0.01D-6,          +0.46D-6, &
     &               -0.23D-6,          +0.24D-6, &
     &               +0.01D-6,          +0.46D-6, &
     &               +0.35D-6,          -0.11D-6, &
     &               +0.01D-6,          +0.45D-6, &
     &               +0.01D-6,          -0.45D-6, &
     &               +0.00D-6,          -0.45D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  121,  130 ) / &
     &               -0.01D-6,          +0.44D-6, &
     &               +0.35D-6,          +0.09D-6, &
     &               +0.01D-6,          +0.42D-6, &
     &               -0.01D-6,          -0.41D-6, &
     &               +0.09D-6,          -0.33D-6, &
     &               +0.00D-6,          +0.41D-6, &
     &               +0.01D-6,          +0.40D-6, &
     &               -0.01D-6,          -0.39D-6, &
     &               -0.39D-6,          -0.01D-6, &
     &               +0.01D-6,          -0.39D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  131,  140 ) / &
     &               -0.01D-6,          +0.38D-6, &
     &               +0.32D-6,          -0.07D-6, &
     &               -0.01D-6,          +0.36D-6, &
     &               -0.01D-6,          -0.36D-6, &
     &               +0.01D-6,          -0.34D-6, &
     &               +0.01D-6,          -0.34D-6, &
     &               +0.01D-6,          +0.33D-6, &
     &               -0.01D-6,          -0.32D-6, &
     &               +0.01D-6,          +0.32D-6, &
     &               -0.01D-6,          -0.32D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  141,  150 ) / &
     &               -0.01D-6,          -0.31D-6, &
     &               -0.31D-6,          +0.00D-6, &
     &               -0.07D-6,          -0.24D-6, &
     &               +0.10D-6,          -0.21D-6, &
     &               -0.01D-6,          -0.30D-6, &
     &               -0.01D-6,          +0.29D-6, &
     &               -0.01D-6,          -0.29D-6, &
     &               +0.00D-6,          +0.29D-6, &
     &               +0.23D-6,          +0.06D-6, &
     &               +0.26D-6,          +0.02D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  151,  160 ) / &
     &               +0.00D-6,          -0.27D-6, &
     &               +0.25D-6,          +0.02D-6, &
     &               +0.09D-6,          -0.18D-6, &
     &               +0.01D-6,          +0.25D-6, &
     &               +0.14D-6,          -0.11D-6, &
     &               +0.00D-6,          -0.25D-6, &
     &               +0.01D-6,          +0.24D-6, &
     &               -0.01D-6,          -0.24D-6, &
     &               +0.00D-6,          +0.23D-6, &
     &               +0.01D-6,          +0.23D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  161,  170 ) / &
     &               -0.01D-6,          -0.23D-6, &
     &               +0.00D-6,          -0.23D-6, &
     &               +0.00D-6,          -0.22D-6, &
     &               +0.00D-6,          +0.21D-6, &
     &               +0.01D-6,          +0.21D-6, &
     &               -0.17D-6,          +0.03D-6, &
     &               -0.17D-6,          +0.03D-6, &
     &               +0.00D-6,          -0.19D-6, &
     &               +0.14D-6,          -0.06D-6, &
     &               +0.03D-6,          -0.17D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  171,  180 ) / &
     &               -0.13D-6,          +0.06D-6, &
     &               +0.00D-6,          +0.19D-6, &
     &               +0.00D-6,          +0.19D-6, &
     &               -0.06D-6,          -0.13D-6, &
     &               +0.00D-6,          +0.18D-6, &
     &               -0.09D-6,          -0.09D-6, &
     &               +0.10D-6,          -0.09D-6, &
     &               +0.06D-6,          +0.12D-6, &
     &               +0.00D-6,          +0.18D-6, &
     &               +0.00D-6,          -0.18D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  181,  190 ) / &
     &               +0.00D-6,          +0.17D-6, &
     &               -0.03D-6,          +0.15D-6, &
     &               -0.01D-6,          -0.16D-6, &
     &               +0.00D-6,          +0.17D-6, &
     &               +0.00D-6,          -0.17D-6, &
     &               +0.11D-6,          +0.06D-6, &
     &               +0.00D-6,          -0.17D-6, &
     &               -0.08D-6,          +0.09D-6, &
     &               -0.17D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.16D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  191,  200 ) / &
     &               +0.01D-6,          +0.15D-6, &
     &               -0.13D-6,          -0.03D-6, &
     &               +0.00D-6,          +0.15D-6, &
     &               +0.00D-6,          +0.15D-6, &
     &               -0.13D-6,          +0.03D-6, &
     &               +0.10D-6,          -0.06D-6, &
     &               -0.07D-6,          +0.08D-6, &
     &               -0.09D-6,          -0.06D-6, &
     &               +0.00D-6,          +0.15D-6, &
     &               -0.07D-6,          -0.08D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  201,  210 ) / &
     &               +0.00D-6,          -0.14D-6, &
     &               +0.02D-6,          +0.12D-6, &
     &               +0.07D-6,          +0.08D-6, &
     &               -0.03D-6,          -0.11D-6, &
     &               -0.01D-6,          -0.14D-6, &
     &               +0.00D-6,          -0.14D-6, &
     &               +0.02D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.14D-6, &
     &               +0.00D-6,          +0.14D-6, &
     &               +0.00D-6,          +0.14D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  211,  220 ) / &
     &               +0.00D-6,          +0.13D-6, &
     &               +0.08D-6,          -0.06D-6, &
     &               +0.00D-6,          +0.13D-6, &
     &               +0.00D-6,          +0.13D-6, &
     &               +0.01D-6,          +0.13D-6, &
     &               +0.00D-6,          +0.13D-6, &
     &               +0.00D-6,          +0.13D-6, &
     &               -0.02D-6,          -0.11D-6, &
     &               +0.08D-6,          -0.04D-6, &
     &               +0.00D-6,          +0.13D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  221,  230 ) / &
     &               +0.00D-6,          +0.13D-6, &
     &               +0.01D-6,          -0.12D-6, &
     &               +0.00D-6,          +0.12D-6, &
     &               -0.02D-6,          -0.11D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.04D-6,          +0.08D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          +0.12D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  231,  240 ) / &
     &               +0.00D-6,          -0.12D-6, &
     &               +0.00D-6,          -0.11D-6, &
     &               +0.03D-6,          -0.09D-6, &
     &               +0.00D-6,          +0.11D-6, &
     &               -0.11D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.11D-6, &
     &               +0.00D-6,          -0.11D-6, &
     &               +0.07D-6,          +0.05D-6, &
     &               +0.11D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.11D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  241,  250 ) / &
     &               +0.00D-6,          -0.11D-6, &
     &               +0.02D-6,          -0.09D-6, &
     &               +0.00D-6,          +0.11D-6, &
     &               +0.02D-6,          +0.09D-6, &
     &               +0.00D-6,          -0.11D-6, &
     &               +0.00D-6,          +0.11D-6, &
     &               -0.08D-6,          -0.02D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               -0.03D-6,          -0.07D-6 /
      DATA ( ( SX1(I,J), I=1,2), J =  251,  NX1 ) / &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.10D-6 /
!
!  Sine and cosine coefficients for t^2 terms
      DATA ( ( SX2(I,J), I=1,2), J =    1,   10 ) / &
     &            +2038.00D-6,         +82.26D-6, &
     &             +155.75D-6,          -2.70D-6, &
     &              +26.92D-6,          -0.45D-6, &
     &              -24.43D-6,          +0.46D-6, &
     &              -17.36D-6,          -0.50D-6, &
     &               -8.41D-6,          +0.01D-6, &
     &               +6.08D-6,          -1.36D-6, &
     &               +4.59D-6,          +0.17D-6, &
     &               +3.57D-6,          -0.06D-6, &
     &               +2.54D-6,          +0.60D-6 /
      DATA ( ( SX2(I,J), I=1,2), J =   11,   20 ) / &
     &               +1.86D-6,          +0.00D-6, &
     &               -1.52D-6,          -0.07D-6, &
     &               +1.46D-6,          +0.04D-6, &
     &               -0.75D-6,          -0.02D-6, &
     &               -0.75D-6,          +0.00D-6, &
     &               -0.71D-6,          -0.01D-6, &
     &               -0.69D-6,          +0.02D-6, &
     &               +0.61D-6,          +0.02D-6, &
     &               +0.54D-6,          -0.04D-6, &
     &               -0.56D-6,          +0.00D-6 /
      DATA ( ( SX2(I,J), I=1,2), J =   21,   30 ) / &
     &               +0.46D-6,          -0.02D-6, &
     &               +0.38D-6,          -0.01D-6, &
     &               +0.37D-6,          -0.02D-6, &
     &               -0.34D-6,          +0.01D-6, &
     &               -0.35D-6,          +0.00D-6, &
     &               -0.31D-6,          +0.00D-6, &
     &               +0.19D-6,          -0.09D-6, &
     &               +0.26D-6,          +0.00D-6, &
     &               +0.24D-6,          -0.01D-6, &
     &               -0.20D-6,          +0.00D-6 /
      DATA ( ( SX2(I,J), I=1,2), J =   31,  NX2 ) / &
     &               +0.18D-6,          -0.01D-6, &
     &               +0.17D-6,          +0.00D-6, &
     &               +0.15D-6,          +0.01D-6, &
     &               -0.15D-6,          +0.00D-6, &
     &               -0.13D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^3 terms
      DATA ( ( SX3(I,J), I=1,2), J =    1,  NX3 ) / &
     &               +1.76D-6,         -20.39D-6, &
     &               +0.00D-6,          -1.27D-6, &
     &               +0.00D-6,          -0.22D-6, &
     &               +0.00D-6,          +0.20D-6 /
!
!  Sine and cosine coefficients for t^4 terms
      DATA ( ( SX4(I,J), I=1,2), J =    1,  NX4 ) / &
     &               -0.10D-6,          -0.02D-6 /
!
!  ----------------------------------
!  The series for Y: numerical values
!  ----------------------------------
!
!  Polynomial coefficients
      DATA YP /      -6950.78D-6, &
     &              -25381.99D-6, &
     &           -22407250.99D-6, &
     &                1842.28D-6, &
     &                1113.06D-6, &
     &                   0.99D-6 /
!
!  Argument coefficients for t^0 terms
      DATA ( ( KY0(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   21,   30 ) / &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  0,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   31,   40 ) / &
     &  1,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   41,   50 ) / &
     &  2,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -1, &
     &  0,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -1,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   51,   60 ) / &
     &  1,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -2, &
     &  1,  0, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   61,   70 ) / &
     &  1, -1,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   71,   80 ) / &
     &  2,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  2, &
     &  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  2,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   81,   90 ) / &
     &  0,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1, &
     &  3,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =   91,  100 ) / &
     &  0,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2, -5,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -8,  3,  0,  0,  0, -2, &
     &  1, -1,  0, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  101,  110 ) / &
     &  1,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -8,  3,  0,  0,  0,  2, &
     &  0,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -2, &
     &  2, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  111,  120 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  1, -1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -2, &
     &  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  0, -2,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  121,  130 ) / &
     &  1,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  3,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1, &
     &  1,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  131,  140 ) / &
     &  1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  2, &
     &  1,  0, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  2, &
     &  1,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -1,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  141,  150 ) / &
     &  0,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  1,  0, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  1, &
     &  2,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  151,  160 ) / &
     &  1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  161,  170 ) / &
     &  1,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &  0,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  171,  180 ) / &
     &  1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -2,  0,  0,  0,  2, &
     &  0,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  4,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  181,  190 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -2, &
     &  1,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -1, &
     &  2,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  191,  200 ) / &
     &  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, -2, &
     &  1,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  2, &
     &  3,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  2, &
     &  1,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  2, &
     &  0,  0,  2, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  201,  210 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  2, &
     &  1,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  3, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1, -1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  211,  220 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  2, &
     &  2,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -1, &
     &  1,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  221,  230 ) / &
     &  1,  0,  0,  0, -1,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -5,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -2, &
     &  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -8, 13,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0, -2,  5,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  231,  240 ) / &
     &  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  2, -5,  0,  0,  0, &
     &  2,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  241,  250 ) / &
     &  1,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  251,  260 ) / &
     &  0,  1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  1,  0,  0,  0, &
     &  3,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  1, -2,  0,  0,  0,  0,  0, &
     &  2, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  261,  270 ) / &
     &  0,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -1, &
     &  2, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  2, &
     &  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  2,  0,  0,  0,  2, &
     &  1,  1, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  271,  280 ) / &
     &  0,  0,  0,  0,  0,  0,  3, -7,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, -1, &
     &  1, -1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -4,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  281,  290 ) / &
     &  2,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  1, &
     &  0,  0,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  291,  300 ) / &
     &  1,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, -2, &
     &  2,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1, &
     &  1,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  301,  310 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0, -1, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -1 /
      DATA ( ( KY0(I,J), I=1,14), J =  311,  320 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  6,-16,  4,  5,  0,  0, -2, &
     &  2,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -1, &
     &  2,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  321,  330 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  8,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0, -1, &
     &  0,  1,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  331,  340 ) / &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  2, &
     &  1,  0, -2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  341,  350 ) / &
     &  1, -1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -1, &
     &  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  351,  360 ) / &
     &  2, -1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -4,  5,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -4, 10,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  2,  0, &
     &  2,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -3,  0,  0,  0,  2, &
     &  0,  0,  0,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  361,  370 ) / &
     &  2,  0, -4, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, -1, &
     &  2,  0, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -9, 13,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  371,  380 ) / &
     &  0,  0,  0,  0,  1,  0,  0, -2,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  1, &
     &  2,  0,  2,  0,  2,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  1 /
      DATA ( ( KY0(I,J), I=1,14), J =  381,  390 ) / &
     &  1,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &  1, -1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  391,  400 ) / &
     &  0,  1,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9,-11,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -8,  3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0, -2, &
     &  1,  1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  401,  410 ) / &
     &  0,  0,  0,  0,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -4,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  411,  420 ) / &
     &  1,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  8,-14,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  3, -6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, -2 /
      DATA ( ( KY0(I,J), I=1,14), J =  421,  430 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  1, &
     &  3,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -1,  0,  0,  2, &
     &  0,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  431,  440 ) / &
     &  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  1, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  2, &
     &  1,  1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  441,  450 ) / &
     &  2,  0,  0, -2,  1,  0, -6,  8,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  3,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -8,  3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  1, &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0, -2 /
      DATA ( ( KY0(I,J), I=1,14), J =  451,  460 ) / &
     &  1, -2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0, -1,  0,  0,  0,  0, &
     &  1,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  461,  470 ) / &
     &  1, -1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -9, 15,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  4,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  3, -9,  4,  0,  0,  0,  0, -2, &
     &  1,  0,  4,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  471,  480 ) / &
     &  2,  0, -2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  481,  490 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0, -2, &
     &  5,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -1,  0,  0,  2, &
     &  1, -1,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  491,  500 ) / &
     &  1, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7,-11,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  4, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  1 /
      DATA ( ( KY0(I,J), I=1,14), J =  501,  510 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  2, -5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  1,  0, -3,  7, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -7,  4,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  511,  520 ) / &
     &  1,  0, -2, -3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0, -6,  8,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  1,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  521,  530 ) / &
     &  0,  0,  0,  0,  1,  0,  3, -5,  0,  2,  0,  0,  0,  0, &
     &  0,  1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  2, -4,  0, -3,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9, -9,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0, 11,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-15,  0,  0,  0,  0, -2 /
      DATA ( ( KY0(I,J), I=1,14), J =  531,  540 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  2, -5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -4,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0, -2, &
     &  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -2,  2,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  541,  550 ) / &
     &  2, -1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  0,  0,  2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1, -1,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  2, -4,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  551,  560 ) / &
     &  1,  1,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  5,  0, -2,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0, -1, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  0,  5,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  561,  570 ) / &
     &  2,  0, -1, -1, -1,  0,  0, -1,  0,  3,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0, -8, 11,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  3,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  571,  580 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -5,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  1, &
     &  4,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  581,  590 ) / &
     &  1,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -5,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -6,  8,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -5,  6,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  591,  600 ) / &
     &  2,  0, -1, -1, -1,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  1, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  7,-13,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  3,  0,  0,  0,  2, &
     &  3, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  601,  610 ) / &
     &  3, -1, -2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  6,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9,-12,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  6,-11,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0, -2, &
     &  0,  0,  2, -2,  1, -1,  0,  2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  2,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  611,  620 ) / &
     &  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  5,-10,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5,  0, -3,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  2, &
     &  0,  0,  3,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -4,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  621,  630 ) / &
     &  0,  0,  2, -2,  2,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0, -1,  2,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  631,  640 ) / &
     &  4,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -8, 15,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -2,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  4,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  641,  650 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  2, &
     &  2, -2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -5,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  2, &
     &  5,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  651,  660 ) / &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  2,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -8, 11,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  2,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8, -8,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  8,-10,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  1 /
      DATA ( ( KY0(I,J), I=1,14), J =  661,  670 ) / &
     &  0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  2, -6,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2, &
     &  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  671,  680 ) / &
     &  1, -2, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  2,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  681,  690 ) / &
     &  0,  0,  2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  2,  0, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2, -1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1, -1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  1, -2,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  691,  700 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1,  0,  0,  0, &
     &  2,  0,  0, -3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -6,  8,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1,  1,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  701,  710 ) / &
     &  0,  0,  2,  0,  2,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  0,  1,  0, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -9, 17,  0,  0,  0,  0,  0, &
     &  1,  1,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -7,  9,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0,  0, -2 /
      DATA ( ( KY0(I,J), I=1,14), J =  711,  720 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  6,-10,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -6,  0,  0,  0,  0, -2, &
     &  4,  0,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  4, -5,  0,  0,  0, &
     &  2,  0,  0, -2, -2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  721,  730 ) / &
     &  1,  0,  2,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  1, -1,  0,-18, 17,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1, -1, -1,  0, 20,-20,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  731,  740 ) / &
     &  0,  0,  1, -1,  1,  0,  1, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  9,-11,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  8,-16,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0,  0, -2,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -2,  0,  0,  2 /
      DATA ( ( KY0(I,J), I=1,14), J =  741,  750 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -6,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2, &
     &  1,  0,  0, -1, -1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &  2, -1,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  751,  760 ) / &
     &  2,  0, -1, -1, -1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  5, -8,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  761,  770 ) / &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  1, -2,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -4, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  771,  780 ) / &
     &  0,  0,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  781,  790 ) / &
     &  0,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  1,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  791,  800 ) / &
     &  1,  0, -2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &  2,  0,  0, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0, -5,  6,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  801,  810 ) / &
     &  1,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  2,  0, -4,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &  2, -1,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  3, -1,  0,  0,  0, &
     &  1, -1, -4,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  811,  820 ) / &
     &  3,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -6,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -1, -1, -2,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  4,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  821,  830 ) / &
     &  3,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  831,  840 ) / &
     &  1,  1, -2, -3, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -6, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  3,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -1,  0, -3,  5,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1, -1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  841,  850 ) / &
     &  0,  3, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -3,  0,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0, -4,  4,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -5,  5,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  1, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  1, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  1, -3,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  851,  860 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0, -1,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -4,  6,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-12,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  7,-10,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  7,-11,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, -1 /
      DATA ( ( KY0(I,J), I=1,14), J =  861,  870 ) / &
     &  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  3, -8,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1, -4,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  9,-17,  0,  0,  0,  0, -2 /
      DATA ( ( KY0(I,J), I=1,14), J =  871,  880 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  5,-10,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -4,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0, -1 /
      DATA ( ( KY0(I,J), I=1,14), J =  881,  890 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -8,  3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -5,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -7,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0, -1 /
      DATA ( ( KY0(I,J), I=1,14), J =  891,  900 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  5,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -5,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  2, &
     &  1,  0,  4,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  4,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  7,-13,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  901,  910 ) / &
     &  1, -1,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0, -8, 11,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -6,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  2,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0, -2, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  1,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  911,  920 ) / &
     &  2, -1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -2,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -6, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  921,  930 ) / &
     &  3,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2, -3,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  2,  1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  3, -4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  931,  940 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  0,  1,  2, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  2,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  941,  950 ) / &
     &  0,  1, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  4, -4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  1,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  951,  960 ) / &
     &  3,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  2,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &  2, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY0(I,J), I=1,14), J =  961,  NY0 ) / &
     &  2,  0, -2, -2, -2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  1,  2,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^1 terms
      DATA ( ( KY1(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   21,   30 ) / &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   31,   40 ) / &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  1,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   41,   50 ) / &
     &  0,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   51,   60 ) / &
     &  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0, -1, &
     &  0,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   61,   70 ) / &
     &  1, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   71,   80 ) / &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0, -2, &
     &  1,  0, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -1,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   81,   90 ) / &
     &  1,  0,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &  2,  0, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =   91,  100 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  2, &
     &  1,  0, -4,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  101,  110 ) / &
     &  0,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -1,  2,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  111,  120 ) / &
     &  0,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  121,  130 ) / &
     &  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -1, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  131,  140 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  2, -8,  3,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  6, -8,  3,  0,  0,  0,  2, &
     &  0,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2, &
     &  1, -1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2, -5,  0,  0,  0, &
     &  3,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  141,  150 ) / &
     &  2, -1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  2, -2,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  2,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  151,  160 ) / &
     &  0,  3,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &  1, -1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  161,  170 ) / &
     &  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  2, &
     &  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  0,  0,  0,  0, -2,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  171,  180 ) / &
     &  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &  1,  0,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  181,  190 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1, &
     &  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2, -1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  2,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  191,  200 ) / &
     &  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, -2, &
     &  1,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  2, &
     &  4,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -1,  0,  0,  0, &
     &  1,  0, -2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2,  1,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  4, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  201,  210 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  0,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  1, &
     &  2,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -2, &
     &  0,  2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  211,  220 ) / &
     &  2,  0, -2, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, -2, &
     &  0,  1,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -4,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  2, -3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  4,  0, -2,  0,  0,  0,  2 /
      DATA ( ( KY1(I,J), I=1,14), J =  221,  230 ) / &
     &  0,  0,  4,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  2, &
     &  1,  1, -2, -4, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  2,  0,  1,  0,  0,  0,  2, &
     &  2,  0,  0, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-11,  0,  0,  0,  0,  0, -2, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0, -2 /
      DATA ( ( KY1(I,J), I=1,14), J =  231,  240 ) / &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  2, &
     &  0,  0,  1, -1,  1,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1, &
     &  1,  0,  2,  4,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  0,  0, 19,-21,  3,  0,  0,  0,  0,  0, &
     &  0,  0,  1,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  2,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  241,  250 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, -2, &
     &  0,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  2, &
     &  3,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  251,  260 ) / &
     &  0,  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  2, &
     &  1,  1,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  2, &
     &  2,  1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -1,  0,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, -1 /
      DATA ( ( KY1(I,J), I=1,14), J =  261,  270 ) / &
     &  0,  2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -4, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  4,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  3,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0, -2, &
     &  0,  0,  2, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, -2, &
     &  2,  1,  0, -4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY1(I,J), I=1,14), J =  271,  NY1 ) / &
     &  0,  0,  1, -1,  1,  0,  0,  3, -8,  3,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  2, &
     &  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0,  0,  0, -2, &
     &  4,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1, -1,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, -2 /
!
!  Argument coefficients for t^2 terms
      DATA ( ( KY2(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY2(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KY2(I,J), I=1,14), J =   21,  NY2 ) / &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  2,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &  0,  1,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^3 terms
      DATA ( ( KY3(I,J), I=1,14), J =    1,  NY3 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^4 terms
      DATA ( ( KY4(I,J), I=1,14), J =    1,  NY4 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Sine and cosine coefficients for t^0 terms
      DATA ( ( SY0(I,J), I=1,2), J =    1,   10 ) / &
     &            +1538.18D-6,    +9205236.26D-6, &
     &             -458.66D-6,     +573033.42D-6, &
     &             +137.41D-6,      +97846.69D-6, &
     &              -29.05D-6,      -89618.24D-6, &
     &              -17.40D-6,      +22438.42D-6, &
     &              +31.80D-6,      +20069.50D-6, &
     &              +36.70D-6,      +12902.66D-6, &
     &              -13.20D-6,       -9592.72D-6, &
     &             -192.40D-6,       +7387.02D-6, &
     &               +3.92D-6,       -6918.22D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   11,   20 ) / &
     &               +0.40D-6,       -5331.13D-6, &
     &               -0.90D-6,       -3323.89D-6, &
     &               +7.50D-6,       +3143.98D-6, &
     &               +7.80D-6,       +2636.13D-6, &
     &               -6.60D-6,       +2554.51D-6, &
     &               -2.00D-6,       -2423.59D-6, &
     &               +6.80D-6,       +1645.01D-6, &
     &               +0.00D-6,       -1387.00D-6, &
     &               +5.90D-6,       +1323.81D-6, &
     &               -0.30D-6,       -1233.89D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   21,   30 ) / &
     &               +0.30D-6,       -1075.60D-6, &
     &               -4.48D-6,        +852.85D-6, &
     &               +0.10D-6,        -800.34D-6, &
     &              +35.80D-6,        -674.99D-6, &
     &               -1.40D-6,        +695.54D-6, &
     &               -0.50D-6,        +684.99D-6, &
     &               -2.62D-6,        +643.75D-6, &
     &               -1.50D-6,        +522.11D-6, &
     &             +273.50D-6,        +164.70D-6, &
     &               +1.40D-6,        +335.24D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   31,   40 ) / &
     &               +1.90D-6,        +326.60D-6, &
     &               +0.40D-6,        +327.11D-6, &
     &               -0.50D-6,        -325.03D-6, &
     &               -0.40D-6,        +307.03D-6, &
     &               +0.50D-6,        +304.17D-6, &
     &               -0.10D-6,        -304.46D-6, &
     &               -0.40D-6,        -276.81D-6, &
     &               +0.90D-6,        +272.05D-6, &
     &               +0.30D-6,        +272.22D-6, &
     &               +1.20D-6,        +269.45D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   41,   50 ) / &
     &               +0.10D-6,        -220.67D-6, &
     &             +128.60D-6,         -77.10D-6, &
     &               +0.10D-6,        -190.79D-6, &
     &             +167.90D-6,          +0.00D-6, &
     &               -8.20D-6,        -123.48D-6, &
     &               +0.10D-6,        +131.04D-6, &
     &               +0.40D-6,        +126.64D-6, &
     &               +2.90D-6,        -122.28D-6, &
     &               +0.70D-6,        +123.20D-6, &
     &               +0.40D-6,        +123.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   51,   60 ) / &
     &               -0.30D-6,        +120.70D-6, &
     &               -0.50D-6,        +112.90D-6, &
     &               -0.20D-6,        -112.94D-6, &
     &               +0.20D-6,        +107.31D-6, &
     &               -0.30D-6,        -106.20D-6, &
     &              +31.90D-6,         -64.10D-6, &
     &               +0.00D-6,         +89.50D-6, &
     &              +89.10D-6,          +0.00D-6, &
     &               +0.00D-6,         +85.32D-6, &
     &               -0.20D-6,         -71.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   61,   70 ) / &
     &               +0.00D-6,         -70.01D-6, &
     &              +13.90D-6,         -55.30D-6, &
     &               +0.00D-6,         +67.25D-6, &
     &               +0.40D-6,         +66.29D-6, &
     &               -0.40D-6,         +64.70D-6, &
     &               +1.30D-6,         -60.90D-6, &
     &               -0.20D-6,         -60.92D-6, &
     &               +0.20D-6,         -59.20D-6, &
     &               +1.10D-6,         -55.55D-6, &
     &               +0.00D-6,         -55.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   71,   80 ) / &
     &               -0.10D-6,         -52.69D-6, &
     &               -0.20D-6,         +51.80D-6, &
     &               +1.00D-6,         -49.51D-6, &
     &               +0.00D-6,         +50.50D-6, &
     &               +2.50D-6,         +47.70D-6, &
     &               +0.10D-6,         +49.59D-6, &
     &               +0.10D-6,         -49.00D-6, &
     &              -23.20D-6,         +24.60D-6, &
     &               +0.40D-6,         +46.50D-6, &
     &               -0.10D-6,         -44.04D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   81,   90 ) / &
     &               -0.10D-6,         -42.19D-6, &
     &              +13.30D-6,         +26.90D-6, &
     &               -0.10D-6,         -39.90D-6, &
     &               -0.10D-6,         -39.50D-6, &
     &               +0.00D-6,         -39.11D-6, &
     &               -0.10D-6,         -38.92D-6, &
     &               +0.10D-6,         +36.95D-6, &
     &               -0.10D-6,         +34.59D-6, &
     &               +0.20D-6,         -32.55D-6, &
     &               -0.10D-6,         +31.61D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =   91,  100 ) / &
     &               +0.00D-6,         +30.40D-6, &
     &               +0.20D-6,         +29.40D-6, &
     &               +0.00D-6,         -27.91D-6, &
     &               +0.10D-6,         +27.50D-6, &
     &              -25.70D-6,          -1.70D-6, &
     &              +19.90D-6,          +5.90D-6, &
     &               +0.00D-6,         +25.80D-6, &
     &               +0.20D-6,         +25.20D-6, &
     &               +0.00D-6,         -25.31D-6, &
     &               +0.20D-6,         +25.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  101,  110 ) / &
     &               -0.10D-6,         +24.40D-6, &
     &               +0.10D-6,         -24.40D-6, &
     &              -23.30D-6,          +0.90D-6, &
     &               -0.10D-6,         +24.00D-6, &
     &              -18.00D-6,          -5.30D-6, &
     &               -0.10D-6,         -22.80D-6, &
     &               -0.10D-6,         +22.50D-6, &
     &               +0.10D-6,         +21.60D-6, &
     &               +0.00D-6,         -21.30D-6, &
     &               +0.10D-6,         +20.70D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  111,  120 ) / &
     &               +0.70D-6,         -20.10D-6, &
     &               +0.00D-6,         +20.51D-6, &
     &              +15.90D-6,          -4.50D-6, &
     &               +0.20D-6,         -19.94D-6, &
     &               +0.00D-6,         +20.11D-6, &
     &              +15.60D-6,          +4.40D-6, &
     &               +0.00D-6,         -20.00D-6, &
     &               +0.00D-6,         +19.80D-6, &
     &               +0.00D-6,         +18.91D-6, &
     &               +4.30D-6,         -14.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  121,  130 ) / &
     &               -0.10D-6,         -18.50D-6, &
     &               -0.10D-6,         +18.40D-6, &
     &               +0.00D-6,         +18.10D-6, &
     &               +1.00D-6,         +16.81D-6, &
     &               -0.10D-6,         -17.60D-6, &
     &              -17.60D-6,          +0.00D-6, &
     &               -1.30D-6,         -16.26D-6, &
     &               +0.00D-6,         -17.41D-6, &
     &              +14.50D-6,          -2.70D-6, &
     &               +0.00D-6,         +17.08D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  131,  140 ) / &
     &               +0.00D-6,         +16.21D-6, &
     &               +0.00D-6,         -16.00D-6, &
     &               +0.00D-6,         -15.31D-6, &
     &               +0.00D-6,         -15.10D-6, &
     &               +0.00D-6,         +14.70D-6, &
     &               +0.00D-6,         +14.40D-6, &
     &               -0.10D-6,         -14.30D-6, &
     &               +0.00D-6,         -14.40D-6, &
     &               +0.00D-6,         -13.81D-6, &
     &               +4.50D-6,          -9.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  141,  150 ) / &
     &              -13.80D-6,          +0.00D-6, &
     &               +0.00D-6,         -13.38D-6, &
     &               -0.10D-6,         +13.10D-6, &
     &              +10.30D-6,          +2.70D-6, &
     &               +0.00D-6,         +12.80D-6, &
     &               +0.00D-6,         -12.80D-6, &
     &              +11.70D-6,          +0.80D-6, &
     &               +0.00D-6,         -12.00D-6, &
     &              +11.30D-6,          +0.50D-6, &
     &               +0.00D-6,         +11.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  151,  160 ) / &
     &               +0.00D-6,         -11.20D-6, &
     &               +0.10D-6,         +10.90D-6, &
     &               +0.10D-6,         -10.77D-6, &
     &               +0.00D-6,         -10.80D-6, &
     &               -0.20D-6,         +10.47D-6, &
     &               +0.00D-6,         +10.50D-6, &
     &               +0.00D-6,         -10.40D-6, &
     &               +0.00D-6,         +10.40D-6, &
     &               +0.00D-6,         -10.20D-6, &
     &               +0.00D-6,         -10.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  161,  170 ) / &
     &               +0.00D-6,          +9.60D-6, &
     &               +0.10D-6,          +9.40D-6, &
     &               -7.60D-6,          +1.70D-6, &
     &               -7.70D-6,          +1.40D-6, &
     &               +1.40D-6,          -7.50D-6, &
     &               +6.10D-6,          -2.70D-6, &
     &               +0.00D-6,          -8.70D-6, &
     &               -5.90D-6,          +2.60D-6, &
     &               +0.00D-6,          +8.40D-6, &
     &               -0.20D-6,          -8.11D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  171,  180 ) / &
     &               -2.60D-6,          -5.70D-6, &
     &               +0.00D-6,          +8.30D-6, &
     &               +2.70D-6,          +5.50D-6, &
     &               +4.20D-6,          -4.00D-6, &
     &               -0.10D-6,          +8.00D-6, &
     &               +0.00D-6,          +8.09D-6, &
     &               -1.30D-6,          +6.70D-6, &
     &               +0.00D-6,          -7.90D-6, &
     &               +0.00D-6,          +7.80D-6, &
     &               -7.50D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  181,  190 ) / &
     &               -0.50D-6,          -7.20D-6, &
     &               +4.90D-6,          +2.70D-6, &
     &               +0.00D-6,          +7.50D-6, &
     &               +0.00D-6,          -7.50D-6, &
     &               +0.00D-6,          -7.49D-6, &
     &               +0.00D-6,          -7.20D-6, &
     &               +0.10D-6,          +6.90D-6, &
     &               -5.60D-6,          +1.40D-6, &
     &               -5.70D-6,          -1.30D-6, &
     &               +0.00D-6,          +6.90D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  191,  200 ) / &
     &               +4.20D-6,          -2.70D-6, &
     &               +0.00D-6,          +6.90D-6, &
     &               -3.10D-6,          +3.70D-6, &
     &               -3.90D-6,          -2.90D-6, &
     &               +0.00D-6,          +6.60D-6, &
     &               -3.10D-6,          -3.50D-6, &
     &               +1.10D-6,          -5.39D-6, &
     &               +0.00D-6,          -6.40D-6, &
     &               +0.90D-6,          +5.50D-6, &
     &               +0.00D-6,          -6.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  201,  210 ) / &
     &               -0.10D-6,          -6.20D-6, &
     &               +0.00D-6,          -6.10D-6, &
     &               +0.00D-6,          +6.10D-6, &
     &               +0.00D-6,          +6.10D-6, &
     &               +3.50D-6,          -2.50D-6, &
     &               +0.00D-6,          +6.00D-6, &
     &               +0.00D-6,          +5.90D-6, &
     &               -0.90D-6,          -4.80D-6, &
     &               +0.00D-6,          +5.70D-6, &
     &               +0.10D-6,          +5.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  211,  220 ) / &
     &               +0.00D-6,          +5.70D-6, &
     &               +0.00D-6,          +5.70D-6, &
     &               +0.00D-6,          +5.60D-6, &
     &               +0.00D-6,          +5.60D-6, &
     &               +0.20D-6,          -5.40D-6, &
     &               -0.90D-6,          -4.70D-6, &
     &               -0.40D-6,          -5.10D-6, &
     &               +0.00D-6,          +5.50D-6, &
     &               +0.00D-6,          -5.40D-6, &
     &               +0.00D-6,          -5.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  221,  230 ) / &
     &               +1.80D-6,          +3.60D-6, &
     &               +0.00D-6,          +5.30D-6, &
     &               +0.00D-6,          -5.30D-6, &
     &               +0.00D-6,          -5.20D-6, &
     &               +0.00D-6,          -5.19D-6, &
     &               +3.00D-6,          +2.10D-6, &
     &               +0.00D-6,          -5.10D-6, &
     &               +0.00D-6,          +5.07D-6, &
     &               +0.90D-6,          -4.10D-6, &
     &               -5.00D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  231,  240 ) / &
     &               +0.00D-6,          -5.00D-6, &
     &               +0.00D-6,          +5.00D-6, &
     &               +0.00D-6,          -5.00D-6, &
     &               +0.00D-6,          -4.90D-6, &
     &               +4.90D-6,          +0.00D-6, &
     &               +0.00D-6,          -4.90D-6, &
     &               +0.90D-6,          +3.90D-6, &
     &               +0.00D-6,          +4.80D-6, &
     &               -3.70D-6,          -1.10D-6, &
     &               +0.00D-6,          -4.72D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  241,  250 ) / &
     &               +0.00D-6,          +4.71D-6, &
     &               +0.00D-6,          -4.50D-6, &
     &               -1.50D-6,          -3.00D-6, &
     &               +0.00D-6,          -4.50D-6, &
     &               +0.30D-6,          -4.11D-6, &
     &               +0.00D-6,          +4.40D-6, &
     &               +0.00D-6,          -4.40D-6, &
     &               +0.00D-6,          +4.39D-6, &
     &               +0.00D-6,          -4.30D-6, &
     &               +0.00D-6,          +4.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  251,  260 ) / &
     &               +0.00D-6,          -4.30D-6, &
     &               +0.20D-6,          +4.03D-6, &
     &               +0.20D-6,          +4.00D-6, &
     &               -0.60D-6,          +3.50D-6, &
     &               +0.00D-6,          +4.10D-6, &
     &               +0.00D-6,          +4.00D-6, &
     &               +0.00D-6,          -4.00D-6, &
     &               +0.00D-6,          -3.91D-6, &
     &               +1.90D-6,          +2.00D-6, &
     &               +0.00D-6,          +3.90D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  261,  270 ) / &
     &               +0.00D-6,          +3.90D-6, &
     &               +0.00D-6,          -3.90D-6, &
     &               +3.10D-6,          -0.80D-6, &
     &               +0.00D-6,          +3.90D-6, &
     &               +0.00D-6,          +3.90D-6, &
     &               +0.00D-6,          +3.80D-6, &
     &               -0.20D-6,          +3.51D-6, &
     &               +0.00D-6,          -3.60D-6, &
     &               -2.10D-6,          +1.50D-6, &
     &               +0.00D-6,          -3.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  271,  280 ) / &
     &               +0.70D-6,          +2.80D-6, &
     &               -2.80D-6,          +0.70D-6, &
     &               +0.00D-6,          -3.50D-6, &
     &               -2.90D-6,          -0.60D-6, &
     &               +0.00D-6,          -3.40D-6, &
     &               +0.00D-6,          +3.40D-6, &
     &               +0.00D-6,          +3.36D-6, &
     &               +0.50D-6,          +2.80D-6, &
     &               +2.60D-6,          -0.70D-6, &
     &               +1.00D-6,          -2.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  281,  290 ) / &
     &               +0.00D-6,          -3.30D-6, &
     &               +0.00D-6,          +3.30D-6, &
     &               +0.00D-6,          +3.23D-6, &
     &               +0.00D-6,          +3.20D-6, &
     &               +0.00D-6,          -3.20D-6, &
     &               +0.00D-6,          -3.20D-6, &
     &               +0.00D-6,          +3.20D-6, &
     &               +2.90D-6,          -0.30D-6, &
     &               +0.08D-6,          +3.05D-6, &
     &               -0.70D-6,          -2.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  291,  300 ) / &
     &               +0.00D-6,          -3.08D-6, &
     &               +0.00D-6,          +3.00D-6, &
     &               -1.60D-6,          +1.40D-6, &
     &               -2.90D-6,          -0.10D-6, &
     &               +0.00D-6,          -2.90D-6, &
     &               -2.50D-6,          +0.40D-6, &
     &               +0.40D-6,          -2.50D-6, &
     &               +0.00D-6,          -2.90D-6, &
     &               +0.00D-6,          +2.89D-6, &
     &               +0.00D-6,          -2.80D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  301,  310 ) / &
     &               -2.50D-6,          +0.30D-6, &
     &               -2.50D-6,          -0.30D-6, &
     &               +0.00D-6,          -2.70D-6, &
     &               +2.70D-6,          +0.00D-6, &
     &               +0.00D-6,          -2.60D-6, &
     &               +0.00D-6,          -2.60D-6, &
     &               +0.00D-6,          +2.60D-6, &
     &               +2.10D-6,          +0.50D-6, &
     &               +0.00D-6,          +2.50D-6, &
     &               +0.80D-6,          +1.70D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  311,  320 ) / &
     &               +1.90D-6,          -0.60D-6, &
     &               +0.00D-6,          -2.50D-6, &
     &               +0.00D-6,          -2.40D-6, &
     &               +0.00D-6,          +2.40D-6, &
     &               +0.00D-6,          -2.40D-6, &
     &               +0.00D-6,          +2.40D-6, &
     &               -1.90D-6,          +0.50D-6, &
     &               -0.10D-6,          -2.30D-6, &
     &               +0.00D-6,          +2.30D-6, &
     &               +0.00D-6,          -2.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  321,  330 ) / &
     &               -1.40D-6,          +0.90D-6, &
     &               -0.10D-6,          -2.20D-6, &
     &               -0.20D-6,          -2.00D-6, &
     &               +0.00D-6,          +2.20D-6, &
     &               +0.00D-6,          -2.20D-6, &
     &               +0.00D-6,          +2.20D-6, &
     &               +0.00D-6,          +2.20D-6, &
     &               -1.80D-6,          -0.40D-6, &
     &               +0.00D-6,          +2.20D-6, &
     &               +0.00D-6,          +2.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  331,  340 ) / &
     &               -1.70D-6,          +0.40D-6, &
     &               -0.80D-6,          -1.30D-6, &
     &               -1.30D-6,          -0.80D-6, &
     &               +0.00D-6,          +2.10D-6, &
     &               +0.00D-6,          +2.10D-6, &
     &               +0.00D-6,          -2.10D-6, &
     &               +0.00D-6,          -2.10D-6, &
     &               +0.00D-6,          +2.10D-6, &
     &               +0.00D-6,          -2.00D-6, &
     &               +0.00D-6,          +2.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  341,  350 ) / &
     &               +0.00D-6,          +2.00D-6, &
     &               +0.00D-6,          +2.00D-6, &
     &               +0.00D-6,          -2.00D-6, &
     &               +2.00D-6,          +0.00D-6, &
     &               +1.10D-6,          -0.90D-6, &
     &               +1.60D-6,          -0.40D-6, &
     &               +0.00D-6,          -1.91D-6, &
     &               +0.00D-6,          -1.90D-6, &
     &               +0.00D-6,          +1.90D-6, &
     &               +0.00D-6,          -1.90D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  351,  360 ) / &
     &               +0.00D-6,          +1.90D-6, &
     &               +1.50D-6,          +0.40D-6, &
     &               -1.50D-6,          -0.40D-6, &
     &               -1.40D-6,          -0.50D-6, &
     &               -1.00D-6,          +0.90D-6, &
     &               +0.00D-6,          -1.90D-6, &
     &               -0.30D-6,          +1.60D-6, &
     &               +0.00D-6,          +1.90D-6, &
     &               +0.00D-6,          +1.90D-6, &
     &               +0.00D-6,          -1.80D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  361,  370 ) / &
     &               +0.00D-6,          -1.80D-6, &
     &               -1.10D-6,          +0.70D-6, &
     &               +0.20D-6,          -1.60D-6, &
     &               +0.00D-6,          +1.80D-6, &
     &               +0.00D-6,          -1.71D-6, &
     &               -1.20D-6,          -0.50D-6, &
     &               +1.50D-6,          +0.20D-6, &
     &               -0.60D-6,          -1.10D-6, &
     &               +0.60D-6,          +1.10D-6, &
     &               -0.60D-6,          -1.10D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  371,  380 ) / &
     &               -1.10D-6,          +0.60D-6, &
     &               -1.70D-6,          +0.00D-6, &
     &               +0.00D-6,          +1.60D-6, &
     &               +0.00D-6,          -1.60D-6, &
     &               +0.00D-6,          -1.60D-6, &
     &               +1.20D-6,          -0.40D-6, &
     &               -0.50D-6,          -1.10D-6, &
     &               +0.60D-6,          +1.00D-6, &
     &               -1.30D-6,          -0.30D-6, &
     &               +0.30D-6,          -1.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  381,  390 ) / &
     &               +0.00D-6,          +1.60D-6, &
     &               +0.00D-6,          -1.60D-6, &
     &               +0.00D-6,          -1.60D-6, &
     &               +1.10D-6,          -0.50D-6, &
     &               +0.00D-6,          -1.50D-6, &
     &               +0.00D-6,          -1.50D-6, &
     &               +0.00D-6,          +1.50D-6, &
     &               +0.00D-6,          -1.50D-6, &
     &               +0.00D-6,          -1.50D-6, &
     &               +1.50D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  391,  400 ) / &
     &               +0.00D-6,          -1.50D-6, &
     &               +1.30D-6,          -0.20D-6, &
     &               +0.00D-6,          -1.50D-6, &
     &               -1.20D-6,          -0.30D-6, &
     &               -1.40D-6,          +0.10D-6, &
     &               -0.50D-6,          +1.00D-6, &
     &               -0.50D-6,          +1.00D-6, &
     &               +0.20D-6,          -1.30D-6, &
     &               +0.00D-6,          +1.50D-6, &
     &               +0.00D-6,          +1.50D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  401,  410 ) / &
     &               +0.00D-6,          +1.50D-6, &
     &               +0.00D-6,          +1.49D-6, &
     &               +0.00D-6,          -1.41D-6, &
     &               +0.00D-6,          +1.41D-6, &
     &               +0.00D-6,          -1.40D-6, &
     &               +0.00D-6,          -1.40D-6, &
     &               +0.00D-6,          +1.40D-6, &
     &               +0.00D-6,          -1.40D-6, &
     &               +1.10D-6,          -0.30D-6, &
     &               +0.00D-6,          -1.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  411,  420 ) / &
     &               +0.00D-6,          +1.40D-6, &
     &               +1.40D-6,          +0.00D-6, &
     &               -0.30D-6,          +1.10D-6, &
     &               +0.20D-6,          +1.20D-6, &
     &               -1.30D-6,          +0.00D-6, &
     &               +0.00D-6,          -1.30D-6, &
     &               +0.00D-6,          +1.30D-6, &
     &               -0.70D-6,          -0.60D-6, &
     &               -0.80D-6,          +0.50D-6, &
     &               -0.20D-6,          -1.10D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  421,  430 ) / &
!
     &               +1.10D-6,          +0.20D-6, &
     &               +0.00D-6,          -1.30D-6, &
     &               +0.00D-6,          -1.30D-6, &
     &               +0.00D-6,          -1.30D-6, &
     &               +0.00D-6,          -1.30D-6, &
     &               +0.00D-6,          -1.29D-6, &
     &               +0.00D-6,          +1.20D-6, &
     &               +0.00D-6,          -1.20D-6, &
     &               -0.40D-6,          -0.80D-6, &
     &               +0.00D-6,          +1.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  431,  440 ) / &
     &               +1.20D-6,          +0.00D-6, &
     &               -0.70D-6,          -0.50D-6, &
     &               -1.00D-6,          +0.20D-6, &
     &               -1.00D-6,          +0.20D-6, &
     &               +0.20D-6,          -1.00D-6, &
     &               +0.40D-6,          +0.80D-6, &
     &               -0.40D-6,          +0.80D-6, &
     &               +0.00D-6,          -1.20D-6, &
     &               +0.00D-6,          +1.15D-6, &
     &               +0.00D-6,          +1.10D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  441,  450 ) / &
     &               -0.20D-6,          +0.90D-6, &
     &               -1.10D-6,          +0.00D-6, &
     &               +0.00D-6,          -1.10D-6, &
     &               -1.10D-6,          +0.00D-6, &
     &               +0.00D-6,          +1.10D-6, &
     &               +0.00D-6,          +1.10D-6, &
     &               +0.00D-6,          +1.10D-6, &
     &               +0.60D-6,          -0.50D-6, &
     &               -0.90D-6,          -0.20D-6, &
     &               -0.40D-6,          -0.70D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  451,  460 ) / &
     &               -0.50D-6,          +0.60D-6, &
     &               +0.00D-6,          +1.10D-6, &
     &               +0.00D-6,          -1.10D-6, &
     &               +0.00D-6,          +1.00D-6, &
     &               +1.00D-6,          +0.00D-6, &
     &               +0.80D-6,          -0.20D-6, &
     &               +0.00D-6,          +1.00D-6, &
     &               +0.00D-6,          +1.00D-6, &
     &               +0.00D-6,          -1.00D-6, &
     &               -1.00D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  461,  470 ) / &
     &               +0.00D-6,          +1.00D-6, &
     &               +1.00D-6,          +0.00D-6, &
     &               +1.00D-6,          +0.00D-6, &
     &               -0.80D-6,          -0.20D-6, &
     &               +0.40D-6,          +0.60D-6, &
     &               -0.40D-6,          -0.60D-6, &
     &               +0.00D-6,          -1.00D-6, &
     &               +0.00D-6,          +1.00D-6, &
     &               +0.00D-6,          +1.00D-6, &
     &               +0.00D-6,          +1.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  471,  480 ) / &
     &               +0.00D-6,          +1.00D-6, &
     &               +0.00D-6,          -1.00D-6, &
     &               +0.00D-6,          +0.91D-6, &
     &               +0.10D-6,          +0.80D-6, &
     &               +0.00D-6,          +0.90D-6, &
     &               +0.00D-6,          +0.90D-6, &
     &               +0.00D-6,          -0.90D-6, &
     &               +0.00D-6,          -0.90D-6, &
     &               -0.70D-6,          -0.20D-6, &
     &               +0.70D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  481,  490 ) / &
     &               -0.30D-6,          +0.60D-6, &
     &               +0.00D-6,          +0.90D-6, &
     &               +0.00D-6,          +0.90D-6, &
     &               +0.00D-6,          -0.90D-6, &
     &               -0.50D-6,          -0.40D-6, &
     &               -0.90D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.90D-6, &
     &               +0.00D-6,          +0.90D-6, &
     &               +0.00D-6,          +0.90D-6, &
     &               +0.00D-6,          -0.90D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  491,  500 ) / &
     &               +0.00D-6,          -0.90D-6, &
     &               +0.00D-6,          -0.80D-6, &
     &               +0.00D-6,          +0.80D-6, &
     &               +0.00D-6,          -0.80D-6, &
     &               +0.10D-6,          +0.70D-6, &
     &               -0.70D-6,          +0.10D-6, &
     &               -0.60D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.60D-6, &
     &               +0.00D-6,          +0.80D-6, &
     &               -0.50D-6,          +0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  501,  510 ) / &
     &               -0.50D-6,          -0.30D-6, &
     &               -0.50D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.80D-6, &
     &               -0.30D-6,          +0.50D-6, &
     &               -0.80D-6,          +0.00D-6, &
     &               -0.30D-6,          -0.50D-6, &
     &               -0.30D-6,          +0.50D-6, &
     &               -0.30D-6,          -0.50D-6, &
     &               +0.00D-6,          +0.80D-6, &
     &               +0.00D-6,          -0.80D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  511,  520 ) / &
     &               +0.00D-6,          -0.80D-6, &
     &               +0.00D-6,          -0.80D-6, &
     &               +0.00D-6,          +0.80D-6, &
     &               +0.00D-6,          +0.80D-6, &
     &               +0.00D-6,          -0.80D-6, &
     &               +0.00D-6,          +0.76D-6, &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.10D-6,          -0.60D-6, &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.70D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  521,  530 ) / &
     &               +0.00D-6,          -0.70D-6, &
     &               +0.00D-6,          -0.70D-6, &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.00D-6,          -0.70D-6, &
     &               -0.70D-6,          +0.00D-6, &
     &               -0.50D-6,          +0.20D-6, &
     &               -0.20D-6,          -0.50D-6, &
     &               +0.50D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.50D-6, &
     &               -0.20D-6,          -0.50D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  531,  540 ) / &
     &               +0.50D-6,          -0.20D-6, &
     &               -0.50D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.70D-6, &
     &               +0.00D-6,          -0.70D-6, &
     &               +0.70D-6,          +0.00D-6, &
     &               -0.60D-6,          -0.10D-6, &
     &               +0.60D-6,          -0.10D-6, &
     &               +0.40D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.70D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  541,  550 ) / &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.00D-6,          +0.70D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.10D-6,          -0.50D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.40D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.00D-6,          -0.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  551,  560 ) / &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.50D-6,          +0.10D-6, &
     &               -0.50D-6,          -0.10D-6, &
     &               -0.10D-6,          -0.50D-6, &
     &               +0.10D-6,          +0.50D-6, &
     &               +0.50D-6,          -0.10D-6, &
     &               -0.10D-6,          +0.50D-6, &
     &               +0.00D-6,          -0.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  561,  570 ) / &
     &               -0.40D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.60D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.20D-6,          +0.40D-6, &
     &               -0.40D-6,          +0.20D-6, &
     &               +0.30D-6,          +0.30D-6, &
     &               +0.40D-6,          -0.20D-6, &
     &               -0.40D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  571,  580 ) / &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.40D-6,          +0.20D-6, &
     &               -0.20D-6,          -0.40D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.00D-6,          +0.60D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.00D-6,          -0.60D-6, &
     &               +0.00D-6,          -0.60D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  581,  590 ) / &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.10D-6,          +0.40D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.10D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.30D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  591,  600 ) / &
     &               +0.20D-6,          +0.30D-6, &
     &               +0.40D-6,          -0.10D-6, &
     &               +0.40D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.30D-6,          +0.20D-6, &
     &               -0.30D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.30D-6, &
     &               -0.30D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.50D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  601,  610 ) / &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               -0.50D-6,          +0.00D-6, &
     &               +0.50D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               -0.50D-6,          +0.00D-6, &
     &               -0.50D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.40D-6,          +0.10D-6, &
     &               -0.40D-6,          -0.10D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  611,  620 ) / &
     &               +0.40D-6,          -0.10D-6, &
     &               -0.40D-6,          +0.10D-6, &
     &               +0.10D-6,          +0.40D-6, &
     &               +0.10D-6,          +0.40D-6, &
     &               -0.50D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          -0.50D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  621,  630 ) / &
     &               +0.50D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.50D-6, &
     &               +0.00D-6,          +0.50D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               -0.20D-6,          +0.20D-6, &
     &               -0.10D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  631,  640 ) / &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               -0.10D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               -0.20D-6,          -0.20D-6, &
     &               +0.20D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  641,  650 ) / &
     &               +0.20D-6,          +0.20D-6, &
     &               -0.10D-6,          +0.30D-6, &
     &               -0.30D-6,          +0.10D-6, &
     &               +0.10D-6,          +0.30D-6, &
     &               -0.10D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  651,  660 ) / &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               -0.40D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  661,  670 ) / &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.40D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  671,  680 ) / &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               -0.10D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.00D-6,          -0.40D-6, &
     &               +0.40D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  681,  690 ) / &
     &               +0.00D-6,          +0.40D-6, &
     &               +0.21D-6,          +0.10D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.20D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  691,  700 ) / &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               -0.20D-6,          +0.10D-6, &
     &               -0.10D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.10D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  701,  710 ) / &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               -0.20D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               -0.10D-6,          -0.20D-6, &
     &               -0.10D-6,          +0.20D-6, &
     &               +0.20D-6,          -0.10D-6, &
     &               -0.10D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.10D-6, &
     &               +0.20D-6,          -0.10D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  711,  720 ) / &
     &               -0.20D-6,          -0.10D-6, &
     &               -0.10D-6,          -0.20D-6, &
     &               +0.20D-6,          -0.10D-6, &
     &               +0.20D-6,          +0.10D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.30D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  721,  730 ) / &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  731,  740 ) / &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               -0.30D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  741,  750 ) / &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  751,  760 ) / &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  761,  770 ) / &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          +0.30D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.30D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  771,  780 ) / &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               -0.20D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.30D-6, &
     &               +0.00D-6,          -0.21D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  781,  790 ) / &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  791,  800 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  801,  810 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.10D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  811,  820 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  821,  830 ) / &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  831,  840 ) / &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  841,  850 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  851,  860 ) / &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  861,  870 ) / &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  871,  880 ) / &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  881,  890 ) / &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  891,  900 ) / &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.10D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  901,  910 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  911,  920 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  921,  930 ) / &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               -0.20D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  931,  940 ) / &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          +0.20D-6, &
     &               +0.00D-6,          -0.19D-6, &
     &               +0.00D-6,          +0.17D-6, &
     &               +0.00D-6,          +0.11D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.10D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  941,  950 ) / &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               -0.10D-6,          +0.00D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  951,  960 ) / &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.10D-6,          +0.00D-6, &
     &               +0.10D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          -0.10D-6, &
     &               +0.00D-6,          -0.10D-6 /
      DATA ( ( SY0(I,J), I=1,2), J =  961,  NY0 ) / &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          +0.10D-6 /
!
!  Sine and cosine coefficients for t^1 terms
      DATA ( ( SY1(I,J), I=1,2), J =    1,   10 ) / &
     &          +153041.82D-6,        +878.89D-6, &
     &           +11714.49D-6,        -289.32D-6, &
     &            +2024.68D-6,         -50.99D-6, &
     &            -1837.33D-6,         +47.75D-6, &
     &            -1312.21D-6,         -28.91D-6, &
     &             -632.54D-6,          +0.78D-6, &
     &             +459.68D-6,         -67.23D-6, &
     &             +344.50D-6,          +1.46D-6, &
     &             +268.14D-6,          -7.03D-6, &
     &             +192.06D-6,         +29.80D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   11,   20 ) / &
     &             +139.64D-6,          +0.15D-6, &
     &             -113.94D-6,          -1.06D-6, &
     &             +109.81D-6,          +3.18D-6, &
     &              -56.37D-6,          +0.13D-6, &
     &              -56.17D-6,          -0.02D-6, &
     &              -53.05D-6,          -1.23D-6, &
     &              -51.60D-6,          +0.17D-6, &
     &              +45.91D-6,          -0.11D-6, &
     &              -42.45D-6,          +0.02D-6, &
     &              +40.82D-6,          -1.03D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   21,   30 ) / &
     &              +34.30D-6,          -1.24D-6, &
     &              +28.89D-6,          +0.00D-6, &
     &              +27.61D-6,          -1.22D-6, &
     &              -25.43D-6,          +1.00D-6, &
     &              -26.01D-6,          +0.07D-6, &
     &              -23.02D-6,          +0.06D-6, &
     &              +19.37D-6,          -0.01D-6, &
     &              +14.05D-6,          -4.19D-6, &
     &              +18.18D-6,          -0.01D-6, &
     &              -14.86D-6,          -0.09D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   31,   40 ) / &
     &              +13.49D-6,          -0.01D-6, &
     &              +12.44D-6,          -0.27D-6, &
     &              +11.46D-6,          +0.03D-6, &
     &              -11.33D-6,          -0.06D-6, &
     &               -9.81D-6,          +0.01D-6, &
     &               -9.08D-6,          -0.02D-6, &
     &               +2.74D-6,          -4.56D-6, &
     &               +6.84D-6,          -0.04D-6, &
     &               -6.73D-6,          +0.01D-6, &
     &               +6.54D-6,          +0.01D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   41,   50 ) / &
     &               -6.35D-6,          -0.01D-6, &
     &               +5.90D-6,          -0.02D-6, &
     &               -5.85D-6,          +0.02D-6, &
     &               -5.73D-6,          +0.01D-6, &
     &               +5.60D-6,          +0.00D-6, &
     &               -5.16D-6,          +0.00D-6, &
     &               -5.14D-6,          +0.01D-6, &
     &               +4.76D-6,          -0.02D-6, &
     &               -4.40D-6,          +0.02D-6, &
     &               -4.22D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   51,   60 ) / &
     &               -4.20D-6,          +0.01D-6, &
     &               +3.58D-6,          +0.31D-6, &
     &               +3.87D-6,          +0.01D-6, &
     &               +3.76D-6,          +0.00D-6, &
     &               -3.62D-6,          -0.01D-6, &
     &               -3.61D-6,          +0.00D-6, &
     &               -1.28D-6,          -2.14D-6, &
     &               -3.18D-6,          +0.00D-6, &
     &               +3.01D-6,          +0.00D-6, &
     &               -2.97D-6,          +0.01D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   61,   70 ) / &
     &               +2.91D-6,          +0.00D-6, &
     &               -2.73D-6,          +0.00D-6, &
     &               +2.58D-6,          -0.01D-6, &
     &               +2.56D-6,          -0.01D-6, &
     &               -2.51D-6,          -0.01D-6, &
     &               -2.35D-6,          -0.01D-6, &
     &               -2.21D-6,          +0.01D-6, &
     &               -2.04D-6,          +0.01D-6, &
     &               -1.94D-6,          +0.00D-6, &
     &               +0.41D-6,          -1.43D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   71,   80 ) / &
     &               -1.84D-6,          +0.00D-6, &
     &               -1.77D-6,          +0.01D-6, &
     &               +0.00D-6,          +1.77D-6, &
     &               +1.76D-6,          +0.00D-6, &
     &               -1.07D-6,          -0.53D-6, &
     &               -1.48D-6,          +0.00D-6, &
     &               -1.40D-6,          +0.01D-6, &
     &               -1.35D-6,          -0.01D-6, &
     &               -1.32D-6,          +0.00D-6, &
     &               -1.28D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   81,   90 ) / &
     &               +1.24D-6,          +0.00D-6, &
     &               +1.23D-6,          +0.00D-6, &
     &               +1.19D-6,          +0.00D-6, &
     &               +1.18D-6,          -0.01D-6, &
     &               +1.17D-6,          +0.00D-6, &
     &               -1.15D-6,          +0.00D-6, &
     &               +1.14D-6,          +0.00D-6, &
     &               -1.14D-6,          +0.00D-6, &
     &               +1.09D-6,          +0.03D-6, &
     &               -1.08D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =   91,  100 ) / &
     &               +1.04D-6,          +0.00D-6, &
     &               +1.02D-6,          +0.00D-6, &
     &               +0.98D-6,          -0.01D-6, &
     &               +0.91D-6,          +0.02D-6, &
     &               +0.00D-6,          +0.93D-6, &
     &               -0.91D-6,          +0.00D-6, &
     &               -0.90D-6,          +0.00D-6, &
     &               +0.86D-6,          +0.00D-6, &
     &               -0.84D-6,          +0.00D-6, &
     &               -0.83D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  101,  110 ) / &
     &               -0.82D-6,          +0.00D-6, &
     &               +0.41D-6,          +0.39D-6, &
     &               +0.40D-6,          -0.38D-6, &
     &               +0.78D-6,          +0.00D-6, &
     &               +0.74D-6,          +0.00D-6, &
     &               -0.73D-6,          +0.00D-6, &
     &               +0.68D-6,          +0.00D-6, &
     &               +0.66D-6,          +0.00D-6, &
     &               -0.64D-6,          +0.00D-6, &
     &               -0.63D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  111,  120 ) / &
     &               +0.63D-6,          +0.00D-6, &
     &               +0.62D-6,          +0.00D-6, &
     &               +0.60D-6,          +0.00D-6, &
     &               -0.59D-6,          +0.00D-6, &
     &               -0.59D-6,          +0.00D-6, &
     &               +0.59D-6,          +0.00D-6, &
     &               +0.57D-6,          +0.00D-6, &
     &               +0.38D-6,          -0.19D-6, &
     &               -0.01D-6,          -0.55D-6, &
     &               +0.44D-6,          -0.11D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  121,  130 ) / &
     &               +0.53D-6,          +0.00D-6, &
     &               -0.53D-6,          +0.00D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               -0.52D-6,          +0.00D-6, &
     &               +0.53D-6,          +0.00D-6, &
     &               +0.52D-6,          +0.00D-6, &
     &               +0.51D-6,          +0.00D-6, &
     &               +0.51D-6,          +0.00D-6, &
     &               -0.21D-6,          -0.30D-6, &
     &               -0.50D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  131,  140 ) / &
     &               -0.11D-6,          +0.37D-6, &
     &               -0.11D-6,          +0.37D-6, &
     &               -0.48D-6,          +0.00D-6, &
     &               -0.46D-6,          -0.01D-6, &
     &               -0.47D-6,          +0.00D-6, &
     &               -0.03D-6,          +0.43D-6, &
     &               +0.45D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6, &
     &               -0.44D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  141,  150 ) / &
     &               +0.43D-6,          +0.00D-6, &
     &               +0.44D-6,          +0.00D-6, &
     &               +0.42D-6,          +0.00D-6, &
     &               -0.42D-6,          +0.00D-6, &
     &               +0.41D-6,          +0.00D-6, &
     &               -0.41D-6,          +0.00D-6, &
     &               +0.02D-6,          +0.39D-6, &
     &               +0.40D-6,          +0.00D-6, &
     &               -0.40D-6,          +0.00D-6, &
     &               -0.39D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  151,  160 ) / &
     &               +0.39D-6,          +0.00D-6, &
     &               +0.15D-6,          -0.24D-6, &
     &               -0.37D-6,          -0.01D-6, &
     &               +0.37D-6,          +0.00D-6, &
     &               -0.37D-6,          +0.00D-6, &
     &               -0.37D-6,          +0.00D-6, &
     &               -0.31D-6,          +0.06D-6, &
     &               -0.35D-6,          +0.00D-6, &
     &               +0.35D-6,          +0.00D-6, &
     &               -0.07D-6,          -0.27D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  161,  170 ) / &
     &               -0.33D-6,          +0.01D-6, &
     &               -0.33D-6,          +0.00D-6, &
     &               +0.07D-6,          -0.26D-6, &
     &               +0.33D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.32D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               +0.32D-6,          +0.00D-6, &
     &               -0.24D-6,          -0.07D-6, &
     &               +0.24D-6,          +0.07D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  171,  180 ) / &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.08D-6,          -0.22D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               -0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.30D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.29D-6, &
     &               +0.00D-6,          -0.29D-6, &
     &               +0.20D-6,          -0.09D-6, &
     &               +0.29D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  181,  190 ) / &
     &               -0.05D-6,          -0.24D-6, &
     &               +0.29D-6,          +0.00D-6, &
     &               -0.27D-6,          +0.00D-6, &
     &               -0.19D-6,          -0.08D-6, &
     &               -0.27D-6,          +0.00D-6, &
     &               +0.25D-6,          +0.00D-6, &
     &               +0.25D-6,          +0.00D-6, &
     &               -0.25D-6,          +0.00D-6, &
     &               +0.25D-6,          +0.00D-6, &
     &               -0.25D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  191,  200 ) / &
     &               -0.01D-6,          +0.23D-6, &
     &               -0.23D-6,          +0.00D-6, &
     &               +0.23D-6,          +0.00D-6, &
     &               +0.23D-6,          +0.00D-6, &
     &               -0.15D-6,          -0.07D-6, &
     &               -0.23D-6,          +0.00D-6, &
     &               -0.22D-6,          +0.00D-6, &
     &               +0.22D-6,          +0.00D-6, &
     &               -0.22D-6,          +0.00D-6, &
     &               -0.22D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  201,  210 ) / &
     &               +0.04D-6,          -0.17D-6, &
     &               -0.01D-6,          -0.21D-6, &
     &               +0.08D-6,          -0.14D-6, &
     &               -0.01D-6,          +0.19D-6, &
     &               +0.21D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               -0.04D-6,          -0.16D-6, &
     &               +0.19D-6,          +0.00D-6, &
     &               +0.19D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  211,  220 ) / &
     &               -0.19D-6,          +0.00D-6, &
     &               +0.18D-6,          +0.00D-6, &
     &               -0.18D-6,          +0.00D-6, &
     &               +0.18D-6,          +0.00D-6, &
     &               +0.17D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.06D-6, &
     &               +0.13D-6,          -0.04D-6, &
     &               -0.11D-6,          +0.06D-6, &
     &               +0.17D-6,          +0.00D-6, &
     &               +0.16D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  221,  230 ) / &
     &               -0.17D-6,          +0.00D-6, &
     &               -0.17D-6,          +0.00D-6, &
     &               -0.14D-6,          +0.02D-6, &
     &               +0.14D-6,          +0.03D-6, &
     &               +0.00D-6,          +0.15D-6, &
     &               -0.15D-6,          +0.00D-6, &
     &               -0.14D-6,          +0.01D-6, &
     &               +0.16D-6,          +0.00D-6, &
     &               -0.06D-6,          +0.10D-6, &
     &               +0.05D-6,          +0.10D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  231,  240 ) / &
     &               +0.02D-6,          +0.13D-6, &
     &               -0.11D-6,          +0.04D-6, &
     &               -0.12D-6,          -0.02D-6, &
     &               -0.05D-6,          -0.10D-6, &
     &               +0.14D-6,          +0.00D-6, &
     &               -0.09D-6,          +0.05D-6, &
     &               +0.00D-6,          +0.14D-6, &
     &               +0.14D-6,          +0.00D-6, &
     &               -0.14D-6,          +0.00D-6, &
     &               +0.04D-6,          +0.10D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  241,  250 ) / &
     &               -0.06D-6,          +0.08D-6, &
     &               +0.05D-6,          +0.09D-6, &
     &               -0.14D-6,          +0.00D-6, &
     &               +0.08D-6,          +0.06D-6, &
     &               +0.14D-6,          +0.00D-6, &
     &               +0.14D-6,          +0.00D-6, &
     &               +0.13D-6,          +0.00D-6, &
     &               -0.07D-6,          +0.06D-6, &
     &               +0.11D-6,          -0.02D-6, &
     &               -0.13D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  251,  260 ) / &
     &               -0.13D-6,          +0.00D-6, &
     &               -0.13D-6,          +0.00D-6, &
     &               -0.13D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               +0.12D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               +0.00D-6,          -0.12D-6, &
     &               -0.02D-6,          -0.09D-6, &
     &               +0.02D-6,          -0.09D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  261,  270 ) / &
     &               -0.11D-6,          +0.00D-6, &
     &               +0.11D-6,          +0.00D-6, &
     &               +0.07D-6,          -0.04D-6, &
     &               +0.11D-6,          +0.00D-6, &
     &               +0.11D-6,          +0.00D-6, &
     &               -0.11D-6,          +0.00D-6, &
     &               +0.10D-6,          +0.00D-6, &
     &               -0.10D-6,          +0.00D-6, &
     &               +0.10D-6,          +0.00D-6, &
     &               +0.10D-6,          +0.00D-6 /
      DATA ( ( SY1(I,J), I=1,2), J =  271,  NY1 ) / &
     &               +0.10D-6,          +0.00D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               +0.00D-6,          +0.10D-6, &
     &               -0.10D-6,          +0.00D-6, &
     &               +0.10D-6,          +0.00D-6, &
     &               -0.10D-6,          +0.00D-6, &
     &               +0.10D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^2 terms
      DATA ( ( SY2(I,J), I=1,2), J =    1,   10 ) / &
     &             +121.15D-6,       -2301.27D-6, &
     &               -0.98D-6,        -143.27D-6, &
     &               -0.27D-6,         -24.46D-6, &
     &               +0.24D-6,         +22.41D-6, &
     &               -1.19D-6,          -5.61D-6, &
     &               +3.57D-6,          -1.83D-6, &
     &               +0.24D-6,          -5.02D-6, &
     &               -0.04D-6,          -3.23D-6, &
     &               -0.48D-6,          +2.40D-6, &
     &               -0.10D-6,          +1.73D-6 /
      DATA ( ( SY2(I,J), I=1,2), J =   11,   20 ) / &
     &               -0.01D-6,          +1.33D-6, &
     &               -0.04D-6,          +0.83D-6, &
     &               -0.05D-6,          -0.79D-6, &
     &               +0.03D-6,          -0.66D-6, &
     &               +0.00D-6,          -0.64D-6, &
     &               +0.04D-6,          +0.61D-6, &
     &               -0.01D-6,          -0.41D-6, &
     &               -0.01D-6,          +0.35D-6, &
     &               -0.01D-6,          -0.33D-6, &
     &               +0.01D-6,          +0.31D-6 /
      DATA ( ( SY2(I,J), I=1,2), J =   21,  NY2 ) / &
     &               +0.01D-6,          +0.27D-6, &
     &               -0.07D-6,          -0.17D-6, &
     &               +0.07D-6,          +0.17D-6, &
     &               +0.02D-6,          -0.21D-6, &
     &               +0.01D-6,          +0.20D-6, &
     &               +0.01D-6,          -0.17D-6, &
     &               +0.01D-6,          -0.16D-6, &
     &               +0.00D-6,          -0.13D-6, &
     &               -0.07D-6,          -0.04D-6, &
     &               +0.02D-6,          +0.08D-6 /
!
!  Sine and cosine coefficients for t^3 terms
      DATA ( ( SY3(I,J), I=1,2), J =    1,  NY3 ) / &
     &              -15.23D-6,          -1.62D-6, &
     &               -1.16D-6,          -0.01D-6, &
     &               -0.20D-6,          +0.00D-6, &
     &               +0.18D-6,          +0.00D-6, &
     &               +0.13D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^4 terms
      DATA ( ( SY4(I,J), I=1,2), J =    1,  NY4 ) / &
     &               -0.01D-6,          +0.11D-6 /
!
!  ---------------------------------------
!  The series for s+XY/2: numerical values
!  ---------------------------------------
!
!  Polynomial coefficients
      DATA SP /    94D-6, &
     &           3808.35D-6, &
     &           -119.94D-6, &
     &         -72574.09D-6, &
     &             27.70D-6, &
     &             15.61D-6 /
!
!  Argument coefficients for t^0
      DATA ( ( KS0(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KS0(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KS0(I,J), I=1,14), J =   21,   30 ) / &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  4, -2,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KS0(I,J), I=1,14), J =   31,  NS0 ) / &
     &  0,  0,  2, -2,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^1
      DATA ( ( KS1(I,J), I=1,14), J =    1,  NS1 ) / &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^2
      DATA ( ( KS2(I,J), I=1,14), J =    1,   10 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  1, -2,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KS2(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KS2(I,J), I=1,14), J =   21,  NS2 ) / &
     &  0,  0,  2,  2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  1,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^3
      DATA ( ( KS3(I,J), I=1,14), J =    1,  NS3 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0, &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^4
      DATA ( ( KS4(I,J), I=1,14), J =    1,  NS4 ) / &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Sine and cosine coefficients for t^0
      DATA ( ( SS0(I,J), I=1,2), J =    1,   10 ) / &
     &            -2640.73D-6,          +0.39D-6, &
     &              -63.53D-6,          +0.02D-6, &
     &              -11.75D-6,          -0.01D-6, &
     &              -11.21D-6,          -0.01D-6, &
     &               +4.57D-6,          +0.00D-6, &
     &               -2.02D-6,          +0.00D-6, &
     &               -1.98D-6,          +0.00D-6, &
     &               +1.72D-6,          +0.00D-6, &
     &               +1.41D-6,          +0.01D-6, &
     &               +1.26D-6,          +0.01D-6 /
      DATA ( ( SS0(I,J), I=1,2), J =   11,   20 ) / &
     &               +0.63D-6,          +0.00D-6, &
     &               +0.63D-6,          +0.00D-6, &
     &               -0.46D-6,          +0.00D-6, &
     &               -0.45D-6,          +0.00D-6, &
     &               -0.36D-6,          +0.00D-6, &
     &               +0.24D-6,          +0.12D-6, &
     &               -0.32D-6,          +0.00D-6, &
     &               -0.28D-6,          +0.00D-6, &
     &               -0.27D-6,          +0.00D-6, &
     &               -0.26D-6,          +0.00D-6 /
      DATA ( ( SS0(I,J), I=1,2), J =   21,   30 ) / &
     &               +0.21D-6,          +0.00D-6, &
     &               -0.19D-6,          +0.00D-6, &
     &               -0.18D-6,          +0.00D-6, &
     &               +0.10D-6,          -0.05D-6, &
     &               -0.15D-6,          +0.00D-6, &
     &               +0.14D-6,          +0.00D-6, &
     &               +0.14D-6,          +0.00D-6, &
     &               -0.14D-6,          +0.00D-6, &
     &               -0.14D-6,          +0.00D-6, &
     &               -0.13D-6,          +0.00D-6 /
      DATA ( ( SS0(I,J), I=1,2), J =   31,  NS0 ) / &
     &               +0.11D-6,          +0.00D-6, &
     &               -0.11D-6,          +0.00D-6, &
     &               -0.11D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^1
      DATA ( ( SS1(I,J), I=1,2), J =    1,  NS1 ) / &
     &               -0.07D-6,          +3.57D-6, &
     &               +1.71D-6,          -0.03D-6, &
     &               +0.00D-6,          +0.48D-6 /
!
!  Sine and cosine coefficients for t^2
      DATA ( ( SS2(I,J), I=1,2), J =    1,   10 ) / &
     &             +743.53D-6,          -0.17D-6, &
     &              +56.91D-6,          +0.06D-6, &
     &               +9.84D-6,          -0.01D-6, &
     &               -8.85D-6,          +0.01D-6, &
     &               -6.38D-6,          -0.05D-6, &
     &               -3.07D-6,          +0.00D-6, &
     &               +2.23D-6,          +0.00D-6, &
     &               +1.67D-6,          +0.00D-6, &
     &               +1.30D-6,          +0.00D-6, &
     &               +0.93D-6,          +0.00D-6 /
      DATA ( ( SS2(I,J), I=1,2), J =   11,   20 ) / &
     &               +0.68D-6,          +0.00D-6, &
     &               -0.55D-6,          +0.00D-6, &
     &               +0.53D-6,          +0.00D-6, &
     &               -0.27D-6,          +0.00D-6, &
     &               -0.27D-6,          +0.00D-6, &
     &               -0.26D-6,          +0.00D-6, &
     &               -0.25D-6,          +0.00D-6, &
     &               +0.22D-6,          +0.00D-6, &
     &               -0.21D-6,          +0.00D-6, &
     &               +0.20D-6,          +0.00D-6 /
      DATA ( ( SS2(I,J), I=1,2), J =   21,  NS2 ) / &
     &               +0.17D-6,          +0.00D-6, &
     &               +0.13D-6,          +0.00D-6, &
     &               -0.13D-6,          +0.00D-6, &
     &               -0.12D-6,          +0.00D-6, &
     &               -0.11D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^3
      DATA ( ( SS3(I,J), I=1,2), J =    1,  NS3 ) / &
     &               +0.30D-6,         -23.51D-6, &
     &               -0.03D-6,          -1.39D-6, &
     &               -0.01D-6,          -0.24D-6, &
     &               +0.00D-6,          +0.22D-6 /
!
!  Sine and cosine coefficients for t^4
      DATA ( ( SS4(I,J), I=1,2), J =    1,  NS4 ) / &
     &               -0.26D-6,          -0.01D-6 /
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!  Interval between fundamental epoch J2000.0 and current date (JC).
!     T = ( ( DATE1-DJ0 ) + DATE2 ) / DJC
      T = CENT
!  Derivative of T w.r.t. time (centuries/sec)
      dTdt = DCENT
!
!  Fundamental Arguments
!
!  Mean Anomaly of the Moon.
!     FA(1) = iau_ANPM ( ( 485868.249036D0 +
!    :                   ( 715923.2178D0 +
!    :                   (     31.8792D0 +
!    :                   (      0.051635D0 +
!    :                   (     -0.00024470D0 )
!    :                   * T ) * T ) * T ) * T ) * DAS2R
!    :                   + MOD ( 1325D0*T, 1D0 ) * D2PI )
!
!  Mean Anomaly of the Sun.
!     FA(2) = iau_ANPM ( ( 1287104.793048D0 +
!    :                   ( 1292581.0481D0 +
!    :                   (      -0.5532D0 +
!    :                   (      +0.000136D0 +
!    :                   (      -0.00001149D0 )
!    :                   * T ) * T ) * T ) * T ) * DAS2R
!    :                   + MOD ( 99D0*T, 1D0 ) * D2PI )
!
!  Mean Longitude of the Moon minus Mean Longitude of the Ascending
!  Node of the Moon.
!     FA(3) = iau_ANPM ( (  335779.526232D0 +
!    :                   (  295262.8478D0 +
!    :                   (     -12.7512D0 +
!    :                   (      -0.001037D0 +
!    :                   (       0.00000417D0 )
!    :                   * T ) * T ) * T ) * T ) * DAS2R
!    :                   + MOD ( 1342D0*T, 1D0 ) * D2PI )
!
!  Mean Elongation of the Moon from the Sun.
!     FA(4) = iau_ANPM ( ( 1072260.703692D0 +
!    :                   ( 1105601.2090D0 +
!    :                   (      -6.3706D0 +
!    :                   (       0.006593D0 +
!    :                   (      -0.00003169D0 )
!    :                   * T ) * T ) * T ) * T ) * DAS2R
!    :                   + MOD ( 1236D0*T, 1D0 ) * D2PI )
!
!  Mean Longitude of the Ascending Node of the Moon.
!     FA(5) = iau_ANPM ( (  450160.398036D0 +
!    :                   ( -482890.5431D0 +
!    :                   (       7.4722D0 +
!    :                   (       0.007702D0 +
!    :                   (      -0.00005939D0 )
!    :                   * T ) * T ) * T ) * T ) * DAS2R
!    :                   + MOD ( -5D0*T, 1D0 ) * D2PI )
!
!*******************************************************************
!  FA(1) - FA(5) simplified, with time derivatives
!  Mean Anomaly of the Moon.
!     FA(1) = (485868.249036D0 + 715923.2178D0*T +
!    :        31.8792D0*T**2   + 0.051635D0*T**3 +
!    :        -0.00024470D0*T**4) * DAS2R
!    :        + DMOD (1325D0*T, 1D0) * D2PI
!     FA(1) = DMOD(FA(1),D2PI)
!     FAD(1) = (                  715923.2178D0   +
!    :       2.D0*31.8792D0*T  + 3.D0*0.051635D0*T**2 +
!    :        -4.D0*0.00024470D0*T**3) * dTdt * DAS2R
!    :        + 1325D0 * dTdt * D2PI
!     FAD(1) = FAD(1)/(36525.D0*86400.D0)
!
!  Mean Anomaly of the Sun.
!     FA(2) =  (1287104.793048D0 + 1292581.0481D0*T +
!    :         -0.5532D0*T**2    + 0.000136D0*T**3 +
!    :         -0.00001149D0*T**4) * DAS2R
!    :         + DMOD (99D0*T, 1D0) * D2PI
!     FA(2) = DMOD(FA(2),D2PI)
!     FAD(2) =  (                   1292581.0481D0 +
!    :         -2.D0*0.5532D0*T + 3.D0*0.000136D0*T**2 +
!    :         -4.D0*0.00001149D0*T**3) * dTdt * DAS2R
!    :         + 99D0 * dTdt * D2PI
!     FAD(2) = FAD(2)/(36525.D0*86400.D0)
!
!  Mean Longitude of the Moon minus Mean Longitude of the Ascending
!  Node of the Moon.
!     FA(3) = (335779.526232D0 + 295262.8478D0*T +
!    :        -12.7512D0*T**2  + -0.001037D0*T**3 +
!    :        0.00000417D0*T**4) * DAS2R
!    :        + DMOD (1342D0*T, 1D0) * D2PI
!     FA(3) = DMOD(FA(3),D2PI)
!     FAD(3) = (                  295262.8478D0 +
!    :        -2.D0*12.7512D0*T  + -3.D0*0.001037D0*T**2 +
!    :        4.D0*0.00000417D0*T**3) * dTdt * DAS2R
!    :        + 1342D0 * dTdt * D2PI
!     FAD(3) = FAD(3)/(36525.D0*86400.D0)
!
!  Mean Elongation of the Moon from the Sun.
!     FA(4) = (1072260.703692D0 + 1105601.2090D0*T +
!    :        -6.3706D0*T**2    + 0.006593D0*T**3 +
!    :        -0.00003169D0*T**4) * DAS2R
!    :        + DMOD (1236D0*T, 1D0) * D2PI
!     FA(4) = DMOD(FA(4),D2PI)
!     FAD(4) = (                   1105601.2090D0 +
!    :        -2.D0*6.3706D0*T + 3.D0*0.006593D0*T**2 +
!    :        -4.D0*0.00003169D0*T**3) * dTdt * DAS2R
!    :        + 1236D0 * dTdt * D2PI
!     FAD(4) = FAD(4)/(36525.D0*86400.D0)
!
!  Mean Longitude of the Ascending Node of the Moon.
!     FA(5) = (450160.398036D0 + -482890.5431D0*T +
!    :        7.4722D0*T**2    + 0.007702D0*T**3 +
!    :        -0.00005939D0*T**4) * DAS2R
!    :        + DMOD (-5D0*T, 1D0) * D2PI
!     FA(5) = DMOD(FA(5),D2PI)
!     FAD(5) = (                  -482890.5431D0 +
!    :        2.D0*7.4722D0*T + 3.D0*0.007702D0*T**2 +
!    :        -4.D0*0.00005939D0*T**3) * dTdt * DAS2R
!    :        + -5D0 * dTdt * D2PI
!     FAD(5) = FAD(5)/(36525.D0*86400.D0)
!
!*******************************************************************
!
!     FA( 6) = iau_ANPM ( 4.402608842D0 + 2608.7903141574D0 * T )
!     FA( 7) = iau_ANPM ( 3.176146697D0 + 1021.3285546211D0 * T )
!     FA( 8) = iau_ANPM ( 1.753470314D0 +  628.3075849991D0 * T )
!     FA( 9) = iau_ANPM ( 6.203480913D0 +  334.0612426700D0 * T )
!     FA(10) = iau_ANPM ( 0.599546497D0 +   52.9690962641D0 * T )
!     FA(11) = iau_ANPM ( 0.874016757D0 +   21.3299104960D0 * T )
!     FA(12) = iau_ANPM ( 5.481293872D0 +    7.4781598567D0 * T )
!     FA(13) = iau_ANPM ( 5.311886287D0 +    3.8133035638D0 * T )
!     FA(14) =          ( 0.024381750D0 +    0.00000538691D0 * T ) * T
!
!     FAD( 6) = 2608.7903141574D0/(36525.D0*86400.D0)
!     FAD( 7) = 1021.3285546211D0/(36525.D0*86400.D0)
!     FAD( 8) = 628.3075849991D0/(36525.D0*86400.D0)
!     FAD( 9) = 334.0612426700D0/(36525.D0*86400.D0)
!     FAD(10) = 52.9690962641D0/(36525.D0*86400.D0)
!     FAD(11) = 21.3299104960D0/(36525.D0*86400.D0)
!     FAD(12) = 7.4781598567D0/(36525.D0*86400.D0)
!     FAD(13) = 3.8133035638D0/(36525.D0*86400.D0)
!     FAD(14) = (0.024381750D0 + 2.D0*0.00000538691D0*T)/
!    *            (36525.D0*86400.D0)
!
!     FAD( 6) = 2608.7903141574D0 * dTdt
!     FAD( 7) = 1021.3285546211D0 * dTdt
!     FAD( 8) = 628.3075849991D0 * dTdt
!     FAD( 9) = 334.0612426700D0 * dTdt
!     FAD(10) = 52.9690962641D0 * dTdt
!     FAD(11) = 21.3299104960D0 * dTdt
!     FAD(12) = 7.4781598567D0 * dTdt
!     FAD(13) = 3.8133035638D0 * dTdt
!     FAD(14) = (0.024381750D0 + 2.D0*0.00000538691D0*T) * dTdt
!
!
!  Evaluate X.
      S0 = XP(1)
      S1 = XP(2)
      S2 = XP(3)
      S3 = XP(4)
      S4 = XP(5)
      S5 = XP(6)
       dS0 = 0.D0
       dS1 = 0.D0
       dS2 = 0.D0
       dS3 = 0.D0
       dS4 = 0.D0
       dS5 = 0.D0
!
      DO I = NX0,1,-1
         A = 0.D0
          dA = 0.D0
         DO J=1,14
            A = A + DBLE(KX0(J,I))*FA2K(J)
            dA = dA + DBLE(KX0(J,I))*FAD2K(J)
         END DO
         S0 = S0 + ( SX0(1,I)*SIN(A) + SX0(2,I)*COS(A) )
         dS0 =  dS0 + (SX0(1,I)*COS(A)*dA - SX0(2,I)*SIN(A)*dA)
      END DO
      DO I = NX1,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KX1(J,I))*FA2K(J)
            dA = dA + DBLE(KX1(J,I))*FAD2K(J)
         END DO
         S1 = S1 + ( SX1(1,I)*SIN(A) + SX1(2,I)*COS(A) )
         dS1 = dS1 + (SX1(1,I)*COS(A)*dA - SX1(2,I)*SIN(A)*dA)
      END DO
      DO I = NX2,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KX2(J,I))*FA2K(J)
            dA = dA + DBLE(KX2(J,I))*FAD2K(J)
         END DO
         S2 = S2 + ( SX2(1,I)*SIN(A) + SX2(2,I)*COS(A) )
         dS2 = dS2 + (SX2(1,I)*COS(A)*dA - SX2(2,I)*SIN(A)*dA)
      END DO
      DO I = NX3,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KX3(J,I))*FA2K(J)
            dA = dA + DBLE(KX3(J,I))*FAD2K(J)
         END DO
         S3 = S3 + ( SX3(1,I)*SIN(A) + SX3(2,I)*COS(A) )
         dS3 = dS3 + (SX3(1,I)*COS(A)*dA - SX3(2,I)*SIN(A)*dA)
      END DO
      DO I = NX4,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KX4(J,I))*FA2K(J)
            dA = dA + DBLE(KX4(J,I))*FAD2K(J)
         END DO
         S4 = S4 + ( SX4(1,I)*SIN(A) + SX4(2,I)*COS(A) )
         dS4 = dS4 + (SX4(1,I)*COS(A)*dA - SX4(2,I)*SIN(A)*dA)
      END DO
      X(1) = ( S0 + &
     &    ( S1 + &
     &    ( S2 + &
     &    ( S3 + &
     &    ( S4 + &
     &      S5 * T ) * T ) * T ) * T ) * T ) * DAS2R
!   Time derivative:
!     X(2) = (dS0 + (S1 + dS1*T) + (2.D0*S2*T + dS2*T**2) +
!    *        (3.D0*S3*T**2 + dS3*T**3 ) + (4.D0*S4*T**3 + dS4*T**4 ) +
!    *        (5.D0*S5*T**4 + dS5*T**5) ) * DAS2R/(36525.D0*86400.D0)
      X(2) = ( dS0 + (S1*dTdt + dS1*T) + (2.D0*S2*T*dTdt + dS2*T**2) + &
     &        (3.D0*S3*T**2*dTdt + dS3*T**3 ) + &
     &        (4.D0*S4*T**3*dTdt + dS4*T**4 ) + &
     &        (5.D0*S5*T**4*dTdt + dS5*T**5) ) * DAS2R
!
!  Evaluate Y.
      S0 = YP(1)
      S1 = YP(2)
      S2 = YP(3)
      S3 = YP(4)
      S4 = YP(5)
      S5 = YP(6)
       dS0 = 0.D0
       dS1 = 0.D0
       dS2 = 0.D0
       dS3 = 0.D0
       dS4 = 0.D0
       dS5 = 0.D0
!
      DO I = NY0,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KY0(J,I))*FA2K(J)
            dA = dA + DBLE(KY0(J,I))*FAD2K(J)
         END DO
         S0 = S0 + ( SY0(1,I)*SIN(A) + SY0(2,I)*COS(A) )
         dS0 = dS0 + (SY0(1,I)*COS(A)*dA - SY0(2,I)*SIN(A)*dA)
      END DO
      DO I = NY1,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KY1(J,I))*FA2K(J)
            dA = dA + DBLE(KY1(J,I))*FAD2K(J)
         END DO
         S1 = S1 + ( SY1(1,I)*SIN(A) + SY1(2,I)*COS(A) )
         dS1 = dS1 + (SY1(1,I)*COS(A)*dA - SY1(2,I)*SIN(A)*dA)
      END DO
      DO I = NY2,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KY2(J,I))*FA2K(J)
            dA = dA + DBLE(KY2(J,I))*FAD2K(J)
         END DO
         S2 = S2 + ( SY2(1,I)*SIN(A) + SY2(2,I)*COS(A) )
         dS2 = dS2 + (SY2(1,I)*COS(A)*dA - SY2(2,I)*SIN(A)*dA)
      END DO
      DO I = NY3,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KY3(J,I))*FA2K(J)
            dA = dA + DBLE(KY3(J,I))*FAD2K(J)
         END DO
         S3 = S3 + ( SY3(1,I)*SIN(A) + SY3(2,I)*COS(A) )
         dS3 = dS3 + (SY3(1,I)*COS(A)*dA - SY3(2,I)*SIN(A)*dA)
      END DO
      DO I = NY4,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KY4(J,I))*FA2K(J)
            dA = dA + DBLE(KY4(J,I))*FAD2K(J)
         END DO
         S4 = S4 + ( SY4(1,I)*SIN(A) + SY4(2,I)*COS(A) )
         dS4 = dS4 + ( SY4(1,I)*COS(A)*dA - SY4(2,I)*SIN(A)*dA)
      END DO
      Y(1) = ( S0 + &
     &    ( S1 + &
     &    ( S2 + &
     &    ( S3 + &
     &    ( S4 + &
     &      S5 * T ) * T ) * T ) * T ) * T ) * DAS2R
!  Time derivative:
!     Y(2) = (dS0 + (S1 + dS1*T) + (2.D0*S2*T + dS2*T**2) +
!    *        (3.D0*S3*T**2 + dS3*T**3 ) + (4.D0*S4*T**3 + dS4*T**4 ) +
!    *        (5.D0*S5*T**4 + dS5*T**5) ) * DAS2R/(36525.D0*86400.D0)
      Y(2) = ( dS0 + (S1*dTdt + dS1*T) + (2.D0*S2*T*dTdt + dS2*T**2) + &
     &        (3.D0*S3*T**2*dTdt + dS3*T**3 ) + &
     &        (4.D0*S4*T**3*dTdt + dS4*T**4 ) + &
     &        (5.D0*S5*T**4*dTdt + dS5*T**5) ) * DAS2R
!
!  Evaluate S.
      S0 = SP(1)
      S1 = SP(2)
      S2 = SP(3)
      S3 = SP(4)
      S4 = SP(5)
      S5 = SP(6)
       dS0 = 0.D0
       dS1 = 0.D0
       dS2 = 0.D0
       dS3 = 0.D0
       dS4 = 0.D0
       dS5 = 0.D0
!
      DO I = NS0,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KS0(J,I))*FA2K(J)
            dA = dA + DBLE(KS0(J,I))*FAD2K(J)
         END DO
         S0 = S0 + ( SS0(1,I)*SIN(A) + SS0(2,I)*COS(A) )
         dS0 = dS0 + (SS0(1,I)*COS(A)*dA - SS0(2,I)*SIN(A)*dA)
      END DO
      DO I = NS1,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KS1(J,I))*FA2K(J)
            dA = dA + DBLE(KS1(J,I))*FAD2K(J)
         END DO
         S1 = S1 + ( SS1(1,I)*SIN(A) + SS1(2,I)*COS(A) )
         dS1 = dS1 + (SS1(1,I)*COS(A)*dA - SS1(2,I)*SIN(A)*dA)
      END DO
      DO I = NS2,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KS2(J,I))*FA2K(J)
            dA = dA + DBLE(KS2(J,I))*FAD2K(J)
         END DO
         S2 = S2 + ( SS2(1,I)*SIN(A) + SS2(2,I)*COS(A) )
         dS2 = dS2 + (SS2(1,I)*COS(A)*dA - SS2(2,I)*SIN(A)*dA)
      END DO
      DO I = NS3,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KS3(J,I))*FA2K(J)
            dA = dA + DBLE(KS3(J,I))*FAD2K(J)
         END DO
         S3 = S3 + ( SS3(1,I)*SIN(A) + SS3(2,I)*COS(A) )
         dS3 = dS3 + (SS3(1,I)*COS(A)*dA - SS3(2,I)*SIN(A)*dA)
      END DO
      DO I = NS4,1,-1
         A = 0D0
          dA = 0D0
         DO J=1,14
            A = A + DBLE(KS4(J,I))*FA2K(J)
            dA = dA + DBLE(KS4(J,I))*FAD2K(J)
         END DO
         S4 = S4 + ( SS4(1,I)*SIN(A) + SS4(2,I)*COS(A) )
         dS4 = dS4 + (SS4(1,I)*COS(A)*dA - SS4(2,I)*SIN(A)*dA)
      END DO
      S(1) = ( S0 + &
     &    ( S1 + &
     &    ( S2 + &
     &    ( S3 + &
     &    ( S4 + &
     &      S5 * T ) * T ) * T ) * T ) * T ) * DAS2R - X(1)*Y(1)/2D0
!  Time derivative:
!     S(2) = ( (dS0 + (S1 + dS1*T) + (2.D0*S2*T + dS2*T**2) +
!    *        (3.D0*S3*T**2 + dS3*T**3 ) + (4.D0*S4*T**3 + dS4*T**4 ) +
!    *        (5.D0*S5*T**4 + dS5*T**5) ) * DAS2R
!    *        - (X(2)*Y(1)/2.D0 + X(1)*Y(2)/2.D0) ) /(36525.D0*86400.D0)
!     S(2) = ( (dS0 + (S1 + dS1*T) + (2.D0*S2*T + dS2*T**2) +
!    *        (3.D0*S3*T**2 + dS3*T**3 ) + (4.D0*S4*T**3 + dS4*T**4 ) +
!    *        (5.D0*S5*T**4 + dS5*T**5) ) * DAS2R/(36525.D0*86400.D0)
!    *        - (X(2)*Y(1)/2.D0 + X(1)*Y(2)/2.D0) )
      S(2) = ( (dS0 + (S1*dTdt + dS1*T) + (2.D0*S2*T*dTdt + dS2*T**2) + &
     &        (3.D0*S3*T**2*dTdt + dS3*T**3 ) + &
     &        (4.D0*S4*T**3*dTdt + dS4*T**4 ) + &
     &        (5.D0*S5*T**4*dTdt + dS5*T**5) ) * DAS2R &
     &      - (X(2)*Y(1)/2.D0 + X(1)*Y(2)/2.D0) )
!
      END
!************************************************************************
!  Copyright (C) 2001
!  Standards Of Fundamental Astronomy Review Board
!  of the International Astronomical Union.
!
!  This routine is part of the International Astronomical Union's
!  SOFA (Standards of Fundamental Astronomy) software collection.
!  =====================
!  SOFA Software License
!  =====================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING TERMS AND CONDITIONS
!  WHICH APPLY TO ITS USE.
!
!  1. The Software is owned by the IAU SOFA Review Board ("the Board").
!
!  2. The Software is made available free of charge for use by:
!
!     a) private individuals for non-profit research; and
!
!     b) non-profit educational, academic and research institutions.
!
!  3. Commercial use of the Software is specifically excluded from the
!     terms and conditions of this license.  Commercial use of the
!     Software is subject to the prior written agreement of the Board on
!     terms to be agreed.
!
!  4. The provision of any version of the Software under the terms and
!     conditions specified herein does not imply that future versions
!     will also be made available under the same terms and conditions.
!
!  5. The user may modify the Software for his/her own purposes.  The
!     user may distribute the modified software provided that the Board
!     is informed and that a copy of the modified software is made
!     available to the Board on request.  All modifications made by the
!     user shall be clearly identified to show how the modified software
!     differs from the original Software, and the name(s) of the
!     affected routine(s) shall be changed.  The original SOFA Software
!     License text must be present.
!
!  6. In any published work produced by the user and which includes
!     results achieved by using the Software, the user shall acknowledge
!     that the Software was used in producing the information contained
!     in such publication.
!
!  7. The user may incorporate or embed the Software into other software
!     products which he/she may then give away free of charge but not
!     sell provided the user makes due acknowledgement of the use which
!     he/she has made of the Software in creating such software
!     products.  Any redistribution of the Software in this way shall be
!     made under the same terms and conditions under which the user
!     received it from the SOFA Center.
!
!  8. The user shall not cause the Software to be brought into
!     disrepute, either by misuse, or use for inappropriate tasks, or by
!     inappropriate modification.
!
!  9. The Software is provided to the user "as is" and the Board makes
!     no warranty as to its use or performance.   The Board does not and
!     cannot warrant the performance or results which the user may
!     obtain by using the Software.  The Board makes no warranties,
!     express or implied, as to non-infringement of third party rights,
!     merchantability, or fitness for any particular purpose.  In no
!     event will the Board be liable to the user for any consequential,
!     incidental, or special damages, including any lost profits or lost
!     savings, even if a Board representative has been advised of such
!     damages, or for any claim by any third party.
!
!  Correspondence concerning SOFA software should be addressed as
!  follows:
!
!     Internet email: sofa@rl.ac.uk
!     Postal address: IAU SOFA Center
!                     Rutherford Appleton Laboratory
!                     Chilton, Didcot, Oxon OX11 0QX
!                     United Kingdom
!
!************************************************************************
!
      SUBROUTINE NU2KA (CENT,DCENT,DATE1,DATE2,FA2K,FAD2K,DPSI,DEPS )
!
!  - - - - - - - -
!   N U 2 0 0 0 A
!  - - - - - - - -
!
!  Nutation, IAU 2000A model (MHB_2000 without FCN).
!
!  Annexe to IERS Conventions 2000, Chapter 5
!
!  Given:
!     DATE1,DATE2    d   TT date (JD = DATE1+DATE2)
!
!  Returned:
!     DPSI,DEPS      d   nutation (luni-solar + planetary, radians)
!
!  This revision:  2002 November 25
!
!*************************************************************************
!   Modified version of NU2000A for use in program Calc for VLBI analysis
!   and/or corrleation. Name changed to NU2KA. Input/outputs  modified.
!   Time derivatives of DPSI and DEPS added. D. Gordon, NASA/GSFC,
!   Aug. 2004.
!
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
!
      REAL*8 CENT, DCENT, DATE1, DATE2, DPSI(2), DEPS(2)
!
! Fundamental arguments from subroutine NUTFA
      REAL*8 FA2K(14), FAD2K(14)
!     COMMON / NFA2K / FA2K, FAD2K
!
!  Arcseconds to radians
      DOUBLE PRECISION DAS2R
      PARAMETER ( DAS2R = 4.848136811095359935899141D-6 )
!
!  Milliarcseconds to radians
      DOUBLE PRECISION DMAS2R
      PARAMETER ( DMAS2R = DAS2R / 1.D3 )
!
!  Arc seconds in a full circle
      DOUBLE PRECISION TURNAS
      PARAMETER ( TURNAS = 1296000.D0 )
!
!  2Pi
      DOUBLE PRECISION D2PI
      PARAMETER ( D2PI = 6.283185307179586476925287D0 )
!
!  Units of 0.1 microarcsecond to radians
      DOUBLE PRECISION U2R
      PARAMETER ( U2R = DAS2R/1.D7 )
!
!  Reference epoch (J2000), JD
      DOUBLE PRECISION DJ0
      PARAMETER ( DJ0 = 2451545.D0 )
!
!  Days per Julian century
      DOUBLE PRECISION DJC
      PARAMETER ( DJC = 36525.D0 )
!
!  Miscellaneous
      DOUBLE PRECISION T, EL, ELP, F, D, OM, ARG, DP, DE, SARG, CARG, &
     &                 DPSILS, DEPSLS, DELP, &
     &                 AL, ALSU, AF, AD, AOM, ALME, ALVE, ALEA, ALMA, &
     &                 ALJU, ALSA, ALUR, ALNE, APA, DPSIPL, DEPSPL, &
     &                 DALNE
      REAL*8 dARG, dSARG, dCARG, dDP, dDE, dDPSILS, dDEPSLS, dAL, &
     &       dALSU, dAF, dAD, dAOM, dAPA, dDPSIPL, dDEPSPL
      INTEGER I, J
!
!  -------------------------
!  Luni-Solar nutation model
!  -------------------------
!
!  Number of terms in the luni-solar nutation model
      INTEGER NLS
      PARAMETER ( NLS = 678 )
!
!  Coefficients for fundamental arguments
      INTEGER NALS(5,NLS)
!
!  Longitude and obliquity coefficients
      DOUBLE PRECISION CLS(6,NLS)
!
!  ---------------
!  Planetary terms
!  ---------------
!
!  Number of terms in the planetary nutation model
      INTEGER NPL
      PARAMETER ( NPL = 687 )
!
!  Coefficients for fundamental arguments
      INTEGER NAPL(14,NPL)
!
!  Longitude and obliquity coefficients
      INTEGER ICPL(4,NPL)
!
!  ----------------------------------------
!  Tables of argument and term coefficients
!  ----------------------------------------
!
!  Luni-Solar argument multipliers:
!               L     L'    F     D     Om
!
      DATA ( ( NALS(I,J), I=1,5 ), J=  1, 10 ) / &
     &          0,    0,    0,    0,    1, &
     &          0,    0,    2,   -2,    2, &
     &          0,    0,    2,    0,    2, &
     &          0,    0,    0,    0,    2, &
     &          0,    1,    0,    0,    0, &
     &          0,    1,    2,   -2,    2, &
     &          1,    0,    0,    0,    0, &
     &          0,    0,    2,    0,    1, &
     &          1,    0,    2,    0,    2, &
     &          0,   -1,    2,   -2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 11, 20 ) / &
     &          0,    0,    2,   -2,    1, &
     &         -1,    0,    2,    0,    2, &
     &         -1,    0,    0,    2,    0, &
     &          1,    0,    0,    0,    1, &
     &         -1,    0,    0,    0,    1, &
     &         -1,    0,    2,    2,    2, &
     &          1,    0,    2,    0,    1, &
     &         -2,    0,    2,    0,    1, &
     &          0,    0,    0,    2,    0, &
     &          0,    0,    2,    2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 21, 30 ) / &
     &          0,   -2,    2,   -2,    2, &
     &         -2,    0,    0,    2,    0, &
     &          2,    0,    2,    0,    2, &
     &          1,    0,    2,   -2,    2, &
     &         -1,    0,    2,    0,    1, &
     &          2,    0,    0,    0,    0, &
     &          0,    0,    2,    0,    0, &
     &          0,    1,    0,    0,    1, &
     &         -1,    0,    0,    2,    1, &
     &          0,    2,    2,   -2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 31, 40 ) / &
     &          0,    0,   -2,    2,    0, &
     &          1,    0,    0,   -2,    1, &
     &          0,   -1,    0,    0,    1, &
     &         -1,    0,    2,    2,    1, &
     &          0,    2,    0,    0,    0, &
     &          1,    0,    2,    2,    2, &
     &         -2,    0,    2,    0,    0, &
     &          0,    1,    2,    0,    2, &
     &          0,    0,    2,    2,    1, &
     &          0,   -1,    2,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 41, 50 ) / &
     &          0,    0,    0,    2,    1, &
     &          1,    0,    2,   -2,    1, &
     &          2,    0,    2,   -2,    2, &
     &         -2,    0,    0,    2,    1, &
     &          2,    0,    2,    0,    1, &
     &          0,   -1,    2,   -2,    1, &
     &          0,    0,    0,   -2,    1, &
     &         -1,   -1,    0,    2,    0, &
     &          2,    0,    0,   -2,    1, &
     &          1,    0,    0,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 51, 60 ) / &
     &          0,    1,    2,   -2,    1, &
     &          1,   -1,    0,    0,    0, &
     &         -2,    0,    2,    0,    2, &
     &          3,    0,    2,    0,    2, &
     &          0,   -1,    0,    2,    0, &
     &          1,   -1,    2,    0,    2, &
     &          0,    0,    0,    1,    0, &
     &         -1,   -1,    2,    2,    2, &
     &         -1,    0,    2,    0,    0, &
     &          0,   -1,    2,    2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 61, 70 ) / &
     &         -2,    0,    0,    0,    1, &
     &          1,    1,    2,    0,    2, &
     &          2,    0,    0,    0,    1, &
     &         -1,    1,    0,    1,    0, &
     &          1,    1,    0,    0,    0, &
     &          1,    0,    2,    0,    0, &
     &         -1,    0,    2,   -2,    1, &
     &          1,    0,    0,    0,    2, &
     &         -1,    0,    0,    1,    0, &
     &          0,    0,    2,    1,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 71, 80 ) / &
     &         -1,    0,    2,    4,    2, &
     &         -1,    1,    0,    1,    1, &
     &          0,   -2,    2,   -2,    1, &
     &          1,    0,    2,    2,    1, &
     &         -2,    0,    2,    2,    2, &
     &         -1,    0,    0,    0,    2, &
     &          1,    1,    2,   -2,    2, &
     &         -2,    0,    2,    4,    2, &
     &         -1,    0,    4,    0,    2, &
     &          2,    0,    2,   -2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 81, 90 ) / &
     &          2,    0,    2,    2,    2, &
     &          1,    0,    0,    2,    1, &
     &          3,    0,    0,    0,    0, &
     &          3,    0,    2,   -2,    2, &
     &          0,    0,    4,   -2,    2, &
     &          0,    1,    2,    0,    1, &
     &          0,    0,   -2,    2,    1, &
     &          0,    0,    2,   -2,    3, &
     &         -1,    0,    0,    4,    0, &
     &          2,    0,   -2,    0,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J= 91,100 ) / &
     &         -2,    0,    0,    4,    0, &
     &         -1,   -1,    0,    2,    1, &
     &         -1,    0,    0,    1,    1, &
     &          0,    1,    0,    0,    2, &
     &          0,    0,   -2,    0,    1, &
     &          0,   -1,    2,    0,    1, &
     &          0,    0,    2,   -1,    2, &
     &          0,    0,    2,    4,    2, &
     &         -2,   -1,    0,    2,    0, &
     &          1,    1,    0,   -2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=101,110 ) / &
     &         -1,    1,    0,    2,    0, &
     &         -1,    1,    0,    1,    2, &
     &          1,   -1,    0,    0,    1, &
     &          1,   -1,    2,    2,    2, &
     &         -1,    1,    2,    2,    2, &
     &          3,    0,    2,    0,    1, &
     &          0,    1,   -2,    2,    0, &
     &         -1,    0,    0,   -2,    1, &
     &          0,    1,    2,    2,    2, &
     &         -1,   -1,    2,    2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=111,120 ) / &
     &          0,   -1,    0,    0,    2, &
     &          1,    0,    2,   -4,    1, &
     &         -1,    0,   -2,    2,    0, &
     &          0,   -1,    2,    2,    1, &
     &          2,   -1,    2,    0,    2, &
     &          0,    0,    0,    2,    2, &
     &          1,   -1,    2,    0,    1, &
     &         -1,    1,    2,    0,    2, &
     &          0,    1,    0,    2,    0, &
     &          0,   -1,   -2,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=121,130 ) / &
     &          0,    3,    2,   -2,    2, &
     &          0,    0,    0,    1,    1, &
     &         -1,    0,    2,    2,    0, &
     &          2,    1,    2,    0,    2, &
     &          1,    1,    0,    0,    1, &
     &          1,    1,    2,    0,    1, &
     &          2,    0,    0,    2,    0, &
     &          1,    0,   -2,    2,    0, &
     &         -1,    0,    0,    2,    2, &
     &          0,    1,    0,    1,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=131,140 ) / &
     &          0,    1,    0,   -2,    1, &
     &         -1,    0,    2,   -2,    2, &
     &          0,    0,    0,   -1,    1, &
     &         -1,    1,    0,    0,    1, &
     &          1,    0,    2,   -1,    2, &
     &          1,   -1,    0,    2,    0, &
     &          0,    0,    0,    4,    0, &
     &          1,    0,    2,    1,    2, &
     &          0,    0,    2,    1,    1, &
     &          1,    0,    0,   -2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=141,150 ) / &
     &         -1,    0,    2,    4,    1, &
     &          1,    0,   -2,    0,    1, &
     &          1,    1,    2,   -2,    1, &
     &          0,    0,    2,    2,    0, &
     &         -1,    0,    2,   -1,    1, &
     &         -2,    0,    2,    2,    1, &
     &          4,    0,    2,    0,    2, &
     &          2,   -1,    0,    0,    0, &
     &          2,    1,    2,   -2,    2, &
     &          0,    1,    2,    1,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=151,160 ) / &
     &          1,    0,    4,   -2,    2, &
     &         -1,   -1,    0,    0,    1, &
     &          0,    1,    0,    2,    1, &
     &         -2,    0,    2,    4,    1, &
     &          2,    0,    2,    0,    0, &
     &          1,    0,    0,    1,    0, &
     &         -1,    0,    0,    4,    1, &
     &         -1,    0,    4,    0,    1, &
     &          2,    0,    2,    2,    1, &
     &          0,    0,    2,   -3,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=161,170 ) / &
     &         -1,   -2,    0,    2,    0, &
     &          2,    1,    0,    0,    0, &
     &          0,    0,    4,    0,    2, &
     &          0,    0,    0,    0,    3, &
     &          0,    3,    0,    0,    0, &
     &          0,    0,    2,   -4,    1, &
     &          0,   -1,    0,    2,    1, &
     &          0,    0,    0,    4,    1, &
     &         -1,   -1,    2,    4,    2, &
     &          1,    0,    2,    4,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=171,180 ) / &
     &         -2,    2,    0,    2,    0, &
     &         -2,   -1,    2,    0,    1, &
     &         -2,    0,    0,    2,    2, &
     &         -1,   -1,    2,    0,    2, &
     &          0,    0,    4,   -2,    1, &
     &          3,    0,    2,   -2,    1, &
     &         -2,   -1,    0,    2,    1, &
     &          1,    0,    0,   -1,    1, &
     &          0,   -2,    0,    2,    0, &
     &         -2,    0,    0,    4,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=181,190 ) / &
     &         -3,    0,    0,    0,    1, &
     &          1,    1,    2,    2,    2, &
     &          0,    0,    2,    4,    1, &
     &          3,    0,    2,    2,    2, &
     &         -1,    1,    2,   -2,    1, &
     &          2,    0,    0,   -4,    1, &
     &          0,    0,    0,   -2,    2, &
     &          2,    0,    2,   -4,    1, &
     &         -1,    1,    0,    2,    1, &
     &          0,    0,    2,   -1,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=191,200 ) / &
     &          0,   -2,    2,    2,    2, &
     &          2,    0,    0,    2,    1, &
     &          4,    0,    2,   -2,    2, &
     &          2,    0,    0,   -2,    2, &
     &          0,    2,    0,    0,    1, &
     &          1,    0,    0,   -4,    1, &
     &          0,    2,    2,   -2,    1, &
     &         -3,    0,    0,    4,    0, &
     &         -1,    1,    2,    0,    1, &
     &         -1,   -1,    0,    4,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=201,210 ) / &
     &         -1,   -2,    2,    2,    2, &
     &         -2,   -1,    2,    4,    2, &
     &          1,   -1,    2,    2,    1, &
     &         -2,    1,    0,    2,    0, &
     &         -2,    1,    2,    0,    1, &
     &          2,    1,    0,   -2,    1, &
     &         -3,    0,    2,    0,    1, &
     &         -2,    0,    2,   -2,    1, &
     &         -1,    1,    0,    2,    2, &
     &          0,   -1,    2,   -1,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=211,220 ) / &
     &         -1,    0,    4,   -2,    2, &
     &          0,   -2,    2,    0,    2, &
     &         -1,    0,    2,    1,    2, &
     &          2,    0,    0,    0,    2, &
     &          0,    0,    2,    0,    3, &
     &         -2,    0,    4,    0,    2, &
     &         -1,    0,   -2,    0,    1, &
     &         -1,    1,    2,    2,    1, &
     &          3,    0,    0,    0,    1, &
     &         -1,    0,    2,    3,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=221,230 ) / &
     &          2,   -1,    2,    0,    1, &
     &          0,    1,    2,    2,    1, &
     &          0,   -1,    2,    4,    2, &
     &          2,   -1,    2,    2,    2, &
     &          0,    2,   -2,    2,    0, &
     &         -1,   -1,    2,   -1,    1, &
     &          0,   -2,    0,    0,    1, &
     &          1,    0,    2,   -4,    2, &
     &          1,   -1,    0,   -2,    1, &
     &         -1,   -1,    2,    0,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=231,240 ) / &
     &          1,   -1,    2,   -2,    2, &
     &         -2,   -1,    0,    4,    0, &
     &         -1,    0,    0,    3,    0, &
     &         -2,   -1,    2,    2,    2, &
     &          0,    2,    2,    0,    2, &
     &          1,    1,    0,    2,    0, &
     &          2,    0,    2,   -1,    2, &
     &          1,    0,    2,    1,    1, &
     &          4,    0,    0,    0,    0, &
     &          2,    1,    2,    0,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=241,250 ) / &
     &          3,   -1,    2,    0,    2, &
     &         -2,    2,    0,    2,    1, &
     &          1,    0,    2,   -3,    1, &
     &          1,    1,    2,   -4,    1, &
     &         -1,   -1,    2,   -2,    1, &
     &          0,   -1,    0,   -1,    1, &
     &          0,   -1,    0,   -2,    1, &
     &         -2,    0,    0,    0,    2, &
     &         -2,    0,   -2,    2,    0, &
     &         -1,    0,   -2,    4,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=251,260 ) / &
     &          1,   -2,    0,    0,    0, &
     &          0,    1,    0,    1,    1, &
     &         -1,    2,    0,    2,    0, &
     &          1,   -1,    2,   -2,    1, &
     &          1,    2,    2,   -2,    2, &
     &          2,   -1,    2,   -2,    2, &
     &          1,    0,    2,   -1,    1, &
     &          2,    1,    2,   -2,    1, &
     &         -2,    0,    0,   -2,    1, &
     &          1,   -2,    2,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=261,270 ) / &
     &          0,    1,    2,    1,    1, &
     &          1,    0,    4,   -2,    1, &
     &         -2,    0,    4,    2,    2, &
     &          1,    1,    2,    1,    2, &
     &          1,    0,    0,    4,    0, &
     &          1,    0,    2,    2,    0, &
     &          2,    0,    2,    1,    2, &
     &          3,    1,    2,    0,    2, &
     &          4,    0,    2,    0,    1, &
     &         -2,   -1,    2,    0,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=271,280 ) / &
     &          0,    1,   -2,    2,    1, &
     &          1,    0,   -2,    1,    0, &
     &          0,   -1,   -2,    2,    1, &
     &          2,   -1,    0,   -2,    1, &
     &         -1,    0,    2,   -1,    2, &
     &          1,    0,    2,   -3,    2, &
     &          0,    1,    2,   -2,    3, &
     &          0,    0,    2,   -3,    1, &
     &         -1,    0,   -2,    2,    1, &
     &          0,    0,    2,   -4,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=281,290 ) / &
     &         -2,    1,    0,    0,    1, &
     &         -1,    0,    0,   -1,    1, &
     &          2,    0,    2,   -4,    2, &
     &          0,    0,    4,   -4,    4, &
     &          0,    0,    4,   -4,    2, &
     &         -1,   -2,    0,    2,    1, &
     &         -2,    0,    0,    3,    0, &
     &          1,    0,   -2,    2,    1, &
     &         -3,    0,    2,    2,    2, &
     &         -3,    0,    2,    2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=291,300 ) / &
     &         -2,    0,    2,    2,    0, &
     &          2,   -1,    0,    0,    1, &
     &         -2,    1,    2,    2,    2, &
     &          1,    1,    0,    1,    0, &
     &          0,    1,    4,   -2,    2, &
     &         -1,    1,    0,   -2,    1, &
     &          0,    0,    0,   -4,    1, &
     &          1,   -1,    0,    2,    1, &
     &          1,    1,    0,    2,    1, &
     &         -1,    2,    2,    2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=301,310 ) / &
     &          3,    1,    2,   -2,    2, &
     &          0,   -1,    0,    4,    0, &
     &          2,   -1,    0,    2,    0, &
     &          0,    0,    4,    0,    1, &
     &          2,    0,    4,   -2,    2, &
     &         -1,   -1,    2,    4,    1, &
     &          1,    0,    0,    4,    1, &
     &          1,   -2,    2,    2,    2, &
     &          0,    0,    2,    3,    2, &
     &         -1,    1,    2,    4,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=311,320 ) / &
     &          3,    0,    0,    2,    0, &
     &         -1,    0,    4,    2,    2, &
     &          1,    1,    2,    2,    1, &
     &         -2,    0,    2,    6,    2, &
     &          2,    1,    2,    2,    2, &
     &         -1,    0,    2,    6,    2, &
     &          1,    0,    2,    4,    1, &
     &          2,    0,    2,    4,    2, &
     &          1,    1,   -2,    1,    0, &
     &         -3,    1,    2,    1,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=321,330 ) / &
     &          2,    0,   -2,    0,    2, &
     &         -1,    0,    0,    1,    2, &
     &         -4,    0,    2,    2,    1, &
     &         -1,   -1,    0,    1,    0, &
     &          0,    0,   -2,    2,    2, &
     &          1,    0,    0,   -1,    2, &
     &          0,   -1,    2,   -2,    3, &
     &         -2,    1,    2,    0,    0, &
     &          0,    0,    2,   -2,    4, &
     &         -2,   -2,    0,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=331,340 ) / &
     &         -2,    0,   -2,    4,    0, &
     &          0,   -2,   -2,    2,    0, &
     &          1,    2,    0,   -2,    1, &
     &          3,    0,    0,   -4,    1, &
     &         -1,    1,    2,   -2,    2, &
     &          1,   -1,    2,   -4,    1, &
     &          1,    1,    0,   -2,    2, &
     &         -3,    0,    2,    0,    0, &
     &         -3,    0,    2,    0,    2, &
     &         -2,    0,    0,    1,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=341,350 ) / &
     &          0,    0,   -2,    1,    0, &
     &         -3,    0,    0,    2,    1, &
     &         -1,   -1,   -2,    2,    0, &
     &          0,    1,    2,   -4,    1, &
     &          2,    1,    0,   -4,    1, &
     &          0,    2,    0,   -2,    1, &
     &          1,    0,    0,   -3,    1, &
     &         -2,    0,    2,   -2,    2, &
     &         -2,   -1,    0,    0,    1, &
     &         -4,    0,    0,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=351,360 ) / &
     &          1,    1,    0,   -4,    1, &
     &         -1,    0,    2,   -4,    1, &
     &          0,    0,    4,   -4,    1, &
     &          0,    3,    2,   -2,    2, &
     &         -3,   -1,    0,    4,    0, &
     &         -3,    0,    0,    4,    1, &
     &          1,   -1,   -2,    2,    0, &
     &         -1,   -1,    0,    2,    2, &
     &          1,   -2,    0,    0,    1, &
     &          1,   -1,    0,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=361,370 ) / &
     &          0,    0,    0,    1,    2, &
     &         -1,   -1,    2,    0,    0, &
     &          1,   -2,    2,   -2,    2, &
     &          0,   -1,    2,   -1,    1, &
     &         -1,    0,    2,    0,    3, &
     &          1,    1,    0,    0,    2, &
     &         -1,    1,    2,    0,    0, &
     &          1,    2,    0,    0,    0, &
     &         -1,    2,    2,    0,    2, &
     &         -1,    0,    4,   -2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=371,380 ) / &
     &          3,    0,    2,   -4,    2, &
     &          1,    2,    2,   -2,    1, &
     &          1,    0,    4,   -4,    2, &
     &         -2,   -1,    0,    4,    1, &
     &          0,   -1,    0,    2,    2, &
     &         -2,    1,    0,    4,    0, &
     &         -2,   -1,    2,    2,    1, &
     &          2,    0,   -2,    2,    0, &
     &          1,    0,    0,    1,    1, &
     &          0,    1,    0,    2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=381,390 ) / &
     &          1,   -1,    2,   -1,    2, &
     &         -2,    0,    4,    0,    1, &
     &          2,    1,    0,    0,    1, &
     &          0,    1,    2,    0,    0, &
     &          0,   -1,    4,   -2,    2, &
     &          0,    0,    4,   -2,    4, &
     &          0,    2,    2,    0,    1, &
     &         -3,    0,    0,    6,    0, &
     &         -1,   -1,    0,    4,    1, &
     &          1,   -2,    0,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=391,400 ) / &
     &         -1,    0,    0,    4,    2, &
     &         -1,   -2,    2,    2,    1, &
     &         -1,    0,    0,   -2,    2, &
     &          1,    0,   -2,   -2,    1, &
     &          0,    0,   -2,   -2,    1, &
     &         -2,    0,   -2,    0,    1, &
     &          0,    0,    0,    3,    1, &
     &          0,    0,    0,    3,    0, &
     &         -1,    1,    0,    4,    0, &
     &         -1,   -1,    2,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=401,410 ) / &
     &         -2,    0,    2,    3,    2, &
     &          1,    0,    0,    2,    2, &
     &          0,   -1,    2,    1,    2, &
     &          3,   -1,    0,    0,    0, &
     &          2,    0,    0,    1,    0, &
     &          1,   -1,    2,    0,    0, &
     &          0,    0,    2,    1,    0, &
     &          1,    0,    2,    0,    3, &
     &          3,    1,    0,    0,    0, &
     &          3,   -1,    2,   -2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=411,420 ) / &
     &          2,    0,    2,   -1,    1, &
     &          1,    1,    2,    0,    0, &
     &          0,    0,    4,   -1,    2, &
     &          1,    2,    2,    0,    2, &
     &         -2,    0,    0,    6,    0, &
     &          0,   -1,    0,    4,    1, &
     &         -2,   -1,    2,    4,    1, &
     &          0,   -2,    2,    2,    1, &
     &          0,   -1,    2,    2,    0, &
     &         -1,    0,    2,    3,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=421,430 ) / &
     &         -2,    1,    2,    4,    2, &
     &          2,    0,    0,    2,    2, &
     &          2,   -2,    2,    0,    2, &
     &         -1,    1,    2,    3,    2, &
     &          3,    0,    2,   -1,    2, &
     &          4,    0,    2,   -2,    1, &
     &         -1,    0,    0,    6,    0, &
     &         -1,   -2,    2,    4,    2, &
     &         -3,    0,    2,    6,    2, &
     &         -1,    0,    2,    4,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=431,440 ) / &
     &          3,    0,    0,    2,    1, &
     &          3,   -1,    2,    0,    1, &
     &          3,    0,    2,    0,    0, &
     &          1,    0,    4,    0,    2, &
     &          5,    0,    2,   -2,    2, &
     &          0,   -1,    2,    4,    1, &
     &          2,   -1,    2,    2,    1, &
     &          0,    1,    2,    4,    2, &
     &          1,   -1,    2,    4,    2, &
     &          3,   -1,    2,    2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=441,450 ) / &
     &          3,    0,    2,    2,    1, &
     &          5,    0,    2,    0,    2, &
     &          0,    0,    2,    6,    2, &
     &          4,    0,    2,    2,    2, &
     &          0,   -1,    1,   -1,    1, &
     &         -1,    0,    1,    0,    3, &
     &          0,   -2,    2,   -2,    3, &
     &          1,    0,   -1,    0,    1, &
     &          2,   -2,    0,   -2,    1, &
     &         -1,    0,    1,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=451,460 ) / &
     &         -1,    0,    1,    0,    1, &
     &         -1,   -1,    2,   -1,    2, &
     &         -2,    2,    0,    2,    2, &
     &         -1,    0,    1,    0,    0, &
     &         -4,    1,    2,    2,    2, &
     &         -3,    0,    2,    1,    1, &
     &         -2,   -1,    2,    0,    2, &
     &          1,    0,   -2,    1,    1, &
     &          2,   -1,   -2,    0,    1, &
     &         -4,    0,    2,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=461,470 ) / &
     &         -3,    1,    0,    3,    0, &
     &         -1,    0,   -1,    2,    0, &
     &          0,   -2,    0,    0,    2, &
     &          0,   -2,    0,    0,    2, &
     &         -3,    0,    0,    3,    0, &
     &         -2,   -1,    0,    2,    2, &
     &         -1,    0,   -2,    3,    0, &
     &         -4,    0,    0,    4,    0, &
     &          2,    1,   -2,    0,    1, &
     &          2,   -1,    0,   -2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=471,480 ) / &
     &          0,    0,    1,   -1,    0, &
     &         -1,    2,    0,    1,    0, &
     &         -2,    1,    2,    0,    2, &
     &          1,    1,    0,   -1,    1, &
     &          1,    0,    1,   -2,    1, &
     &          0,    2,    0,    0,    2, &
     &          1,   -1,    2,   -3,    1, &
     &         -1,    1,    2,   -1,    1, &
     &         -2,    0,    4,   -2,    2, &
     &         -2,    0,    4,   -2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=481,490 ) / &
     &         -2,   -2,    0,    2,    1, &
     &         -2,    0,   -2,    4,    0, &
     &          1,    2,    2,   -4,    1, &
     &          1,    1,    2,   -4,    2, &
     &         -1,    2,    2,   -2,    1, &
     &          2,    0,    0,   -3,    1, &
     &         -1,    2,    0,    0,    1, &
     &          0,    0,    0,   -2,    0, &
     &         -1,   -1,    2,   -2,    2, &
     &         -1,    1,    0,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=491,500 ) / &
     &          0,    0,    0,   -1,    2, &
     &         -2,    1,    0,    1,    0, &
     &          1,   -2,    0,   -2,    1, &
     &          1,    0,   -2,    0,    2, &
     &         -3,    1,    0,    2,    0, &
     &         -1,    1,   -2,    2,    0, &
     &         -1,   -1,    0,    0,    2, &
     &         -3,    0,    0,    2,    0, &
     &         -3,   -1,    0,    2,    0, &
     &          2,    0,    2,   -6,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=501,510 ) / &
     &          0,    1,    2,   -4,    2, &
     &          2,    0,    0,   -4,    2, &
     &         -2,    1,    2,   -2,    1, &
     &          0,   -1,    2,   -4,    1, &
     &          0,    1,    0,   -2,    2, &
     &         -1,    0,    0,   -2,    0, &
     &          2,    0,   -2,   -2,    1, &
     &         -4,    0,    2,    0,    1, &
     &         -1,   -1,    0,   -1,    1, &
     &          0,    0,   -2,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=511,520 ) / &
     &         -3,    0,    0,    1,    0, &
     &         -1,    0,   -2,    1,    0, &
     &         -2,    0,   -2,    2,    1, &
     &          0,    0,   -4,    2,    0, &
     &         -2,   -1,   -2,    2,    0, &
     &          1,    0,    2,   -6,    1, &
     &         -1,    0,    2,   -4,    2, &
     &          1,    0,    0,   -4,    2, &
     &          2,    1,    2,   -4,    2, &
     &          2,    1,    2,   -4,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=521,530 ) / &
     &          0,    1,    4,   -4,    4, &
     &          0,    1,    4,   -4,    2, &
     &         -1,   -1,   -2,    4,    0, &
     &         -1,   -3,    0,    2,    0, &
     &         -1,    0,   -2,    4,    1, &
     &         -2,   -1,    0,    3,    0, &
     &          0,    0,   -2,    3,    0, &
     &         -2,    0,    0,    3,    1, &
     &          0,   -1,    0,    1,    0, &
     &         -3,    0,    2,    2,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=531,540 ) / &
     &          1,    1,   -2,    2,    0, &
     &         -1,    1,    0,    2,    2, &
     &          1,   -2,    2,   -2,    1, &
     &          0,    0,    1,    0,    2, &
     &          0,    0,    1,    0,    1, &
     &          0,    0,    1,    0,    0, &
     &         -1,    2,    0,    2,    1, &
     &          0,    0,    2,    0,    2, &
     &         -2,    0,    2,    0,    2, &
     &          2,    0,    0,   -1,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=541,550 ) / &
     &          3,    0,    0,   -2,    1, &
     &          1,    0,    2,   -2,    3, &
     &          1,    2,    0,    0,    1, &
     &          2,    0,    2,   -3,    2, &
     &         -1,    1,    4,   -2,    2, &
     &         -2,   -2,    0,    4,    0, &
     &          0,   -3,    0,    2,    0, &
     &          0,    0,   -2,    4,    0, &
     &         -1,   -1,    0,    3,    0, &
     &         -2,    0,    0,    4,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=551,560 ) / &
     &         -1,    0,    0,    3,    1, &
     &          2,   -2,    0,    0,    0, &
     &          1,   -1,    0,    1,    0, &
     &         -1,    0,    0,    2,    0, &
     &          0,   -2,    2,    0,    1, &
     &         -1,    0,    1,    2,    1, &
     &         -1,    1,    0,    3,    0, &
     &         -1,   -1,    2,    1,    2, &
     &          0,   -1,    2,    0,    0, &
     &         -2,    1,    2,    2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=561,570 ) / &
     &          2,   -2,    2,   -2,    2, &
     &          1,    1,    0,    1,    1, &
     &          1,    0,    1,    0,    1, &
     &          1,    0,    1,    0,    0, &
     &          0,    2,    0,    2,    0, &
     &          2,   -1,    2,   -2,    1, &
     &          0,   -1,    4,   -2,    1, &
     &          0,    0,    4,   -2,    3, &
     &          0,    1,    4,   -2,    1, &
     &          4,    0,    2,   -4,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=571,580 ) / &
     &          2,    2,    2,   -2,    2, &
     &          2,    0,    4,   -4,    2, &
     &         -1,   -2,    0,    4,    0, &
     &         -1,   -3,    2,    2,    2, &
     &         -3,    0,    2,    4,    2, &
     &         -3,    0,    2,   -2,    1, &
     &         -1,   -1,    0,   -2,    1, &
     &         -3,    0,    0,    0,    2, &
     &         -3,    0,   -2,    2,    0, &
     &          0,    1,    0,   -4,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=581,590 ) / &
     &         -2,    1,    0,   -2,    1, &
     &         -4,    0,    0,    0,    1, &
     &         -1,    0,    0,   -4,    1, &
     &         -3,    0,    0,   -2,    1, &
     &          0,    0,    0,    3,    2, &
     &         -1,    1,    0,    4,    1, &
     &          1,   -2,    2,    0,    1, &
     &          0,    1,    0,    3,    0, &
     &         -1,    0,    2,    2,    3, &
     &          0,    0,    2,    2,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=591,600 ) / &
     &         -2,    0,    2,    2,    2, &
     &         -1,    1,    2,    2,    0, &
     &          3,    0,    0,    0,    2, &
     &          2,    1,    0,    1,    0, &
     &          2,   -1,    2,   -1,    2, &
     &          0,    0,    2,    0,    1, &
     &          0,    0,    3,    0,    3, &
     &          0,    0,    3,    0,    2, &
     &         -1,    2,    2,    2,    1, &
     &         -1,    0,    4,    0,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=601,610 ) / &
     &          1,    2,    2,    0,    1, &
     &          3,    1,    2,   -2,    1, &
     &          1,    1,    4,   -2,    2, &
     &         -2,   -1,    0,    6,    0, &
     &          0,   -2,    0,    4,    0, &
     &         -2,    0,    0,    6,    1, &
     &         -2,   -2,    2,    4,    2, &
     &          0,   -3,    2,    2,    2, &
     &          0,    0,    0,    4,    2, &
     &         -1,   -1,    2,    3,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=611,620 ) / &
     &         -2,    0,    2,    4,    0, &
     &          2,   -1,    0,    2,    1, &
     &          1,    0,    0,    3,    0, &
     &          0,    1,    0,    4,    1, &
     &          0,    1,    0,    4,    0, &
     &          1,   -1,    2,    1,    2, &
     &          0,    0,    2,    2,    3, &
     &          1,    0,    2,    2,    2, &
     &         -1,    0,    2,    2,    2, &
     &         -2,    0,    4,    2,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=621,630 ) / &
     &          2,    1,    0,    2,    1, &
     &          2,    1,    0,    2,    0, &
     &          2,   -1,    2,    0,    0, &
     &          1,    0,    2,    1,    0, &
     &          0,    1,    2,    2,    0, &
     &          2,    0,    2,    0,    3, &
     &          3,    0,    2,    0,    2, &
     &          1,    0,    2,    0,    2, &
     &          1,    0,    3,    0,    3, &
     &          1,    1,    2,    1,    1 /
      DATA ( ( NALS(I,J), I=1,5 ), J=631,640 ) / &
     &          0,    2,    2,    2,    2, &
     &          2,    1,    2,    0,    0, &
     &          2,    0,    4,   -2,    1, &
     &          4,    1,    2,   -2,    2, &
     &         -1,   -1,    0,    6,    0, &
     &         -3,   -1,    2,    6,    2, &
     &         -1,    0,    0,    6,    1, &
     &         -3,    0,    2,    6,    1, &
     &          1,   -1,    0,    4,    1, &
     &          1,   -1,    0,    4,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=641,650 ) / &
     &         -2,    0,    2,    5,    2, &
     &          1,   -2,    2,    2,    1, &
     &          3,   -1,    0,    2,    0, &
     &          1,   -1,    2,    2,    0, &
     &          0,    0,    2,    3,    1, &
     &         -1,    1,    2,    4,    1, &
     &          0,    1,    2,    3,    2, &
     &         -1,    0,    4,    2,    1, &
     &          2,    0,    2,    1,    1, &
     &          5,    0,    0,    0,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=651,660 ) / &
     &          2,    1,    2,    1,    2, &
     &          1,    0,    4,    0,    1, &
     &          3,    1,    2,    0,    1, &
     &          3,    0,    4,   -2,    2, &
     &         -2,   -1,    2,    6,    2, &
     &          0,    0,    0,    6,    0, &
     &          0,   -2,    2,    4,    2, &
     &         -2,    0,    2,    6,    1, &
     &          2,    0,    0,    4,    1, &
     &          2,    0,    0,    4,    0 /
      DATA ( ( NALS(I,J), I=1,5 ), J=661,670 ) / &
     &          2,   -2,    2,    2,    2, &
     &          0,    0,    2,    4,    0, &
     &          1,    0,    2,    3,    2, &
     &          4,    0,    0,    2,    0, &
     &          2,    0,    2,    2,    0, &
     &          0,    0,    4,    2,    2, &
     &          4,   -1,    2,    0,    2, &
     &          3,    0,    2,    1,    2, &
     &          2,    1,    2,    2,    1, &
     &          4,    1,    2,    0,    2 /
      DATA ( ( NALS(I,J), I=1,5 ), J=671,678 ) / &
     &         -1,   -1,    2,    6,    2, &
     &         -1,    0,    2,    6,    1, &
     &          1,   -1,    2,    4,    1, &
     &          1,    1,    2,    4,    2, &
     &          3,    1,    2,    2,    2, &
     &          5,    0,    2,    0,    1, &
     &          2,   -1,    2,    4,    2, &
     &          2,    0,    2,    4,    1 /
!
!  Luni-Solar nutation coefficients, unit 1e-7 arcsec:
!  longitude (sin, t*sin, cos), obliquity (cos, t*cos, sin)
!
      DATA ( ( CLS(I,J), I=1,6 ), J=  1, 10 ) / &
     & -172064161D0, -174666D0,  33386D0, 92052331D0,  9086D0, 15377D0, &
     &  -13170906D0,   -1675D0, -13696D0,  5730336D0, -3015D0, -4587D0, &
     &   -2276413D0,    -234D0,   2796D0,   978459D0,  -485D0,  1374D0, &
     &    2074554D0,     207D0,   -698D0,  -897492D0,   470D0,  -291D0, &
     &    1475877D0,   -3633D0,  11817D0,    73871D0,  -184D0, -1924D0, &
     &    -516821D0,    1226D0,   -524D0,   224386D0,  -677D0,  -174D0, &
     &     711159D0,      73D0,   -872D0,    -6750D0,     0D0,   358D0, &
     &    -387298D0,    -367D0,    380D0,   200728D0,    18D0,   318D0, &
     &    -301461D0,     -36D0,    816D0,   129025D0,   -63D0,   367D0, &
     &     215829D0,    -494D0,    111D0,   -95929D0,   299D0,   132D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 11, 20 ) / &
     &     128227D0,     137D0,    181D0,   -68982D0,    -9D0,    39D0, &
     &     123457D0,      11D0,     19D0,   -53311D0,    32D0,    -4D0, &
     &     156994D0,      10D0,   -168D0,    -1235D0,     0D0,    82D0, &
     &      63110D0,      63D0,     27D0,   -33228D0,     0D0,    -9D0, &
     &     -57976D0,     -63D0,   -189D0,    31429D0,     0D0,   -75D0, &
     &     -59641D0,     -11D0,    149D0,    25543D0,   -11D0,    66D0, &
     &     -51613D0,     -42D0,    129D0,    26366D0,     0D0,    78D0, &
     &      45893D0,      50D0,     31D0,   -24236D0,   -10D0,    20D0, &
     &      63384D0,      11D0,   -150D0,    -1220D0,     0D0,    29D0, &
     &     -38571D0,      -1D0,    158D0,    16452D0,   -11D0,    68D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 21, 30 ) / &
     &      32481D0,       0D0,      0D0,   -13870D0,     0D0,     0D0, &
     &     -47722D0,       0D0,    -18D0,      477D0,     0D0,   -25D0, &
     &     -31046D0,      -1D0,    131D0,    13238D0,   -11D0,    59D0, &
     &      28593D0,       0D0,     -1D0,   -12338D0,    10D0,    -3D0, &
     &      20441D0,      21D0,     10D0,   -10758D0,     0D0,    -3D0, &
     &      29243D0,       0D0,    -74D0,     -609D0,     0D0,    13D0, &
     &      25887D0,       0D0,    -66D0,     -550D0,     0D0,    11D0, &
     &     -14053D0,     -25D0,     79D0,     8551D0,    -2D0,   -45D0, &
     &      15164D0,      10D0,     11D0,    -8001D0,     0D0,    -1D0, &
     &     -15794D0,      72D0,    -16D0,     6850D0,   -42D0,    -5D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 31, 40 ) / &
     &      21783D0,       0D0,     13D0,     -167D0,     0D0,    13D0, &
     &     -12873D0,     -10D0,    -37D0,     6953D0,     0D0,   -14D0, &
     &     -12654D0,      11D0,     63D0,     6415D0,     0D0,    26D0, &
     &     -10204D0,       0D0,     25D0,     5222D0,     0D0,    15D0, &
     &      16707D0,     -85D0,    -10D0,      168D0,    -1D0,    10D0, &
     &      -7691D0,       0D0,     44D0,     3268D0,     0D0,    19D0, &
     &     -11024D0,       0D0,    -14D0,      104D0,     0D0,     2D0, &
     &       7566D0,     -21D0,    -11D0,    -3250D0,     0D0,    -5D0, &
     &      -6637D0,     -11D0,     25D0,     3353D0,     0D0,    14D0, &
     &      -7141D0,      21D0,      8D0,     3070D0,     0D0,     4D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 41, 50 ) / &
     &      -6302D0,     -11D0,      2D0,     3272D0,     0D0,     4D0, &
     &       5800D0,      10D0,      2D0,    -3045D0,     0D0,    -1D0, &
     &       6443D0,       0D0,     -7D0,    -2768D0,     0D0,    -4D0, &
     &      -5774D0,     -11D0,    -15D0,     3041D0,     0D0,    -5D0, &
     &      -5350D0,       0D0,     21D0,     2695D0,     0D0,    12D0, &
     &      -4752D0,     -11D0,     -3D0,     2719D0,     0D0,    -3D0, &
     &      -4940D0,     -11D0,    -21D0,     2720D0,     0D0,    -9D0, &
     &       7350D0,       0D0,     -8D0,      -51D0,     0D0,     4D0, &
     &       4065D0,       0D0,      6D0,    -2206D0,     0D0,     1D0, &
     &       6579D0,       0D0,    -24D0,     -199D0,     0D0,     2D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 51, 60 ) / &
     &       3579D0,       0D0,      5D0,    -1900D0,     0D0,     1D0, &
     &       4725D0,       0D0,     -6D0,      -41D0,     0D0,     3D0, &
     &      -3075D0,       0D0,     -2D0,     1313D0,     0D0,    -1D0, &
     &      -2904D0,       0D0,     15D0,     1233D0,     0D0,     7D0, &
     &       4348D0,       0D0,    -10D0,      -81D0,     0D0,     2D0, &
     &      -2878D0,       0D0,      8D0,     1232D0,     0D0,     4D0, &
     &      -4230D0,       0D0,      5D0,      -20D0,     0D0,    -2D0, &
     &      -2819D0,       0D0,      7D0,     1207D0,     0D0,     3D0, &
     &      -4056D0,       0D0,      5D0,       40D0,     0D0,    -2D0, &
     &      -2647D0,       0D0,     11D0,     1129D0,     0D0,     5D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 61, 70 ) / &
     &      -2294D0,       0D0,    -10D0,     1266D0,     0D0,    -4D0, &
     &       2481D0,       0D0,     -7D0,    -1062D0,     0D0,    -3D0, &
     &       2179D0,       0D0,     -2D0,    -1129D0,     0D0,    -2D0, &
     &       3276D0,       0D0,      1D0,       -9D0,     0D0,     0D0, &
     &      -3389D0,       0D0,      5D0,       35D0,     0D0,    -2D0, &
     &       3339D0,       0D0,    -13D0,     -107D0,     0D0,     1D0, &
     &      -1987D0,       0D0,     -6D0,     1073D0,     0D0,    -2D0, &
     &      -1981D0,       0D0,      0D0,      854D0,     0D0,     0D0, &
     &       4026D0,       0D0,   -353D0,     -553D0,     0D0,  -139D0, &
     &       1660D0,       0D0,     -5D0,     -710D0,     0D0,    -2D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 71, 80 ) / &
     &      -1521D0,       0D0,      9D0,      647D0,     0D0,     4D0, &
     &       1314D0,       0D0,      0D0,     -700D0,     0D0,     0D0, &
     &      -1283D0,       0D0,      0D0,      672D0,     0D0,     0D0, &
     &      -1331D0,       0D0,      8D0,      663D0,     0D0,     4D0, &
     &       1383D0,       0D0,     -2D0,     -594D0,     0D0,    -2D0, &
     &       1405D0,       0D0,      4D0,     -610D0,     0D0,     2D0, &
     &       1290D0,       0D0,      0D0,     -556D0,     0D0,     0D0, &
     &      -1214D0,       0D0,      5D0,      518D0,     0D0,     2D0, &
     &       1146D0,       0D0,     -3D0,     -490D0,     0D0,    -1D0, &
     &       1019D0,       0D0,     -1D0,     -527D0,     0D0,    -1D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 81, 90 ) / &
     &      -1100D0,       0D0,      9D0,      465D0,     0D0,     4D0, &
     &       -970D0,       0D0,      2D0,      496D0,     0D0,     1D0, &
     &       1575D0,       0D0,     -6D0,      -50D0,     0D0,     0D0, &
     &        934D0,       0D0,     -3D0,     -399D0,     0D0,    -1D0, &
     &        922D0,       0D0,     -1D0,     -395D0,     0D0,    -1D0, &
     &        815D0,       0D0,     -1D0,     -422D0,     0D0,    -1D0, &
     &        834D0,       0D0,      2D0,     -440D0,     0D0,     1D0, &
     &       1248D0,       0D0,      0D0,     -170D0,     0D0,     1D0, &
     &       1338D0,       0D0,     -5D0,      -39D0,     0D0,     0D0, &
     &        716D0,       0D0,     -2D0,     -389D0,     0D0,    -1D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J= 91,100 ) / &
     &       1282D0,       0D0,     -3D0,      -23D0,     0D0,     1D0, &
     &        742D0,       0D0,      1D0,     -391D0,     0D0,     0D0, &
     &       1020D0,       0D0,    -25D0,     -495D0,     0D0,   -10D0, &
     &        715D0,       0D0,     -4D0,     -326D0,     0D0,     2D0, &
     &       -666D0,       0D0,     -3D0,      369D0,     0D0,    -1D0, &
     &       -667D0,       0D0,      1D0,      346D0,     0D0,     1D0, &
     &       -704D0,       0D0,      0D0,      304D0,     0D0,     0D0, &
     &       -694D0,       0D0,      5D0,      294D0,     0D0,     2D0, &
     &      -1014D0,       0D0,     -1D0,        4D0,     0D0,    -1D0, &
     &       -585D0,       0D0,     -2D0,      316D0,     0D0,    -1D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=101,110 ) / &
     &       -949D0,       0D0,      1D0,        8D0,     0D0,    -1D0, &
     &       -595D0,       0D0,      0D0,      258D0,     0D0,     0D0, &
     &        528D0,       0D0,      0D0,     -279D0,     0D0,     0D0, &
     &       -590D0,       0D0,      4D0,      252D0,     0D0,     2D0, &
     &        570D0,       0D0,     -2D0,     -244D0,     0D0,    -1D0, &
     &       -502D0,       0D0,      3D0,      250D0,     0D0,     2D0, &
     &       -875D0,       0D0,      1D0,       29D0,     0D0,     0D0, &
     &       -492D0,       0D0,     -3D0,      275D0,     0D0,    -1D0, &
     &        535D0,       0D0,     -2D0,     -228D0,     0D0,    -1D0, &
     &       -467D0,       0D0,      1D0,      240D0,     0D0,     1D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=111,120 ) / &
     &        591D0,       0D0,      0D0,     -253D0,     0D0,     0D0, &
     &       -453D0,       0D0,     -1D0,      244D0,     0D0,    -1D0, &
     &        766D0,       0D0,      1D0,        9D0,     0D0,     0D0, &
     &       -446D0,       0D0,      2D0,      225D0,     0D0,     1D0, &
     &       -488D0,       0D0,      2D0,      207D0,     0D0,     1D0, &
     &       -468D0,       0D0,      0D0,      201D0,     0D0,     0D0, &
     &       -421D0,       0D0,      1D0,      216D0,     0D0,     1D0, &
     &        463D0,       0D0,      0D0,     -200D0,     0D0,     0D0, &
     &       -673D0,       0D0,      2D0,       14D0,     0D0,     0D0, &
     &        658D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=121,130 ) / &
     &       -438D0,       0D0,      0D0,      188D0,     0D0,     0D0, &
     &       -390D0,       0D0,      0D0,      205D0,     0D0,     0D0, &
     &        639D0,     -11D0,     -2D0,      -19D0,     0D0,     0D0, &
     &        412D0,       0D0,     -2D0,     -176D0,     0D0,    -1D0, &
     &       -361D0,       0D0,      0D0,      189D0,     0D0,     0D0, &
     &        360D0,       0D0,     -1D0,     -185D0,     0D0,    -1D0, &
     &        588D0,       0D0,     -3D0,      -24D0,     0D0,     0D0, &
     &       -578D0,       0D0,      1D0,        5D0,     0D0,     0D0, &
     &       -396D0,       0D0,      0D0,      171D0,     0D0,     0D0, &
     &        565D0,       0D0,     -1D0,       -6D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=131,140 ) / &
     &       -335D0,       0D0,     -1D0,      184D0,     0D0,    -1D0, &
     &        357D0,       0D0,      1D0,     -154D0,     0D0,     0D0, &
     &        321D0,       0D0,      1D0,     -174D0,     0D0,     0D0, &
     &       -301D0,       0D0,     -1D0,      162D0,     0D0,     0D0, &
     &       -334D0,       0D0,      0D0,      144D0,     0D0,     0D0, &
     &        493D0,       0D0,     -2D0,      -15D0,     0D0,     0D0, &
     &        494D0,       0D0,     -2D0,      -19D0,     0D0,     0D0, &
     &        337D0,       0D0,     -1D0,     -143D0,     0D0,    -1D0, &
     &        280D0,       0D0,     -1D0,     -144D0,     0D0,     0D0, &
     &        309D0,       0D0,      1D0,     -134D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=141,150 ) / &
     &       -263D0,       0D0,      2D0,      131D0,     0D0,     1D0, &
     &        253D0,       0D0,      1D0,     -138D0,     0D0,     0D0, &
     &        245D0,       0D0,      0D0,     -128D0,     0D0,     0D0, &
     &        416D0,       0D0,     -2D0,      -17D0,     0D0,     0D0, &
     &       -229D0,       0D0,      0D0,      128D0,     0D0,     0D0, &
     &        231D0,       0D0,      0D0,     -120D0,     0D0,     0D0, &
     &       -259D0,       0D0,      2D0,      109D0,     0D0,     1D0, &
     &        375D0,       0D0,     -1D0,       -8D0,     0D0,     0D0, &
     &        252D0,       0D0,      0D0,     -108D0,     0D0,     0D0, &
     &       -245D0,       0D0,      1D0,      104D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=151,160 ) / &
     &        243D0,       0D0,     -1D0,     -104D0,     0D0,     0D0, &
     &        208D0,       0D0,      1D0,     -112D0,     0D0,     0D0, &
     &        199D0,       0D0,      0D0,     -102D0,     0D0,     0D0, &
     &       -208D0,       0D0,      1D0,      105D0,     0D0,     0D0, &
     &        335D0,       0D0,     -2D0,      -14D0,     0D0,     0D0, &
     &       -325D0,       0D0,      1D0,        7D0,     0D0,     0D0, &
     &       -187D0,       0D0,      0D0,       96D0,     0D0,     0D0, &
     &        197D0,       0D0,     -1D0,     -100D0,     0D0,     0D0, &
     &       -192D0,       0D0,      2D0,       94D0,     0D0,     1D0, &
     &       -188D0,       0D0,      0D0,       83D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=161,170 ) / &
     &        276D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &       -286D0,       0D0,      1D0,        6D0,     0D0,     0D0, &
     &        186D0,       0D0,     -1D0,      -79D0,     0D0,     0D0, &
     &       -219D0,       0D0,      0D0,       43D0,     0D0,     0D0, &
     &        276D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &       -153D0,       0D0,     -1D0,       84D0,     0D0,     0D0, &
     &       -156D0,       0D0,      0D0,       81D0,     0D0,     0D0, &
     &       -154D0,       0D0,      1D0,       78D0,     0D0,     0D0, &
     &       -174D0,       0D0,      1D0,       75D0,     0D0,     0D0, &
     &       -163D0,       0D0,      2D0,       69D0,     0D0,     1D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=171,180 ) / &
     &       -228D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         91D0,       0D0,     -4D0,      -54D0,     0D0,    -2D0, &
     &        175D0,       0D0,      0D0,      -75D0,     0D0,     0D0, &
     &       -159D0,       0D0,      0D0,       69D0,     0D0,     0D0, &
     &        141D0,       0D0,      0D0,      -72D0,     0D0,     0D0, &
     &        147D0,       0D0,      0D0,      -75D0,     0D0,     0D0, &
     &       -132D0,       0D0,      0D0,       69D0,     0D0,     0D0, &
     &        159D0,       0D0,    -28D0,      -54D0,     0D0,    11D0, &
     &        213D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &        123D0,       0D0,      0D0,      -64D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=181,190 ) / &
     &       -118D0,       0D0,     -1D0,       66D0,     0D0,     0D0, &
     &        144D0,       0D0,     -1D0,      -61D0,     0D0,     0D0, &
     &       -121D0,       0D0,      1D0,       60D0,     0D0,     0D0, &
     &       -134D0,       0D0,      1D0,       56D0,     0D0,     1D0, &
     &       -105D0,       0D0,      0D0,       57D0,     0D0,     0D0, &
     &       -102D0,       0D0,      0D0,       56D0,     0D0,     0D0, &
     &        120D0,       0D0,      0D0,      -52D0,     0D0,     0D0, &
     &        101D0,       0D0,      0D0,      -54D0,     0D0,     0D0, &
     &       -113D0,       0D0,      0D0,       59D0,     0D0,     0D0, &
     &       -106D0,       0D0,      0D0,       61D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=191,200 ) / &
     &       -129D0,       0D0,      1D0,       55D0,     0D0,     0D0, &
     &       -114D0,       0D0,      0D0,       57D0,     0D0,     0D0, &
     &        113D0,       0D0,     -1D0,      -49D0,     0D0,     0D0, &
     &       -102D0,       0D0,      0D0,       44D0,     0D0,     0D0, &
     &        -94D0,       0D0,      0D0,       51D0,     0D0,     0D0, &
     &       -100D0,       0D0,     -1D0,       56D0,     0D0,     0D0, &
     &         87D0,       0D0,      0D0,      -47D0,     0D0,     0D0, &
     &        161D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         96D0,       0D0,      0D0,      -50D0,     0D0,     0D0, &
     &        151D0,       0D0,     -1D0,       -5D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=201,210 ) / &
     &       -104D0,       0D0,      0D0,       44D0,     0D0,     0D0, &
     &       -110D0,       0D0,      0D0,       48D0,     0D0,     0D0, &
     &       -100D0,       0D0,      1D0,       50D0,     0D0,     0D0, &
     &         92D0,       0D0,     -5D0,       12D0,     0D0,    -2D0, &
     &         82D0,       0D0,      0D0,      -45D0,     0D0,     0D0, &
     &         82D0,       0D0,      0D0,      -45D0,     0D0,     0D0, &
     &        -78D0,       0D0,      0D0,       41D0,     0D0,     0D0, &
     &        -77D0,       0D0,      0D0,       43D0,     0D0,     0D0, &
     &          2D0,       0D0,      0D0,       54D0,     0D0,     0D0, &
     &         94D0,       0D0,      0D0,      -40D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=211,220 ) / &
     &        -93D0,       0D0,      0D0,       40D0,     0D0,     0D0, &
     &        -83D0,       0D0,     10D0,       40D0,     0D0,    -2D0, &
     &         83D0,       0D0,      0D0,      -36D0,     0D0,     0D0, &
     &        -91D0,       0D0,      0D0,       39D0,     0D0,     0D0, &
     &        128D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &        -79D0,       0D0,      0D0,       34D0,     0D0,     0D0, &
     &        -83D0,       0D0,      0D0,       47D0,     0D0,     0D0, &
     &         84D0,       0D0,      0D0,      -44D0,     0D0,     0D0, &
     &         83D0,       0D0,      0D0,      -43D0,     0D0,     0D0, &
     &         91D0,       0D0,      0D0,      -39D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=221,230 ) / &
     &        -77D0,       0D0,      0D0,       39D0,     0D0,     0D0, &
     &         84D0,       0D0,      0D0,      -43D0,     0D0,     0D0, &
     &        -92D0,       0D0,      1D0,       39D0,     0D0,     0D0, &
     &        -92D0,       0D0,      1D0,       39D0,     0D0,     0D0, &
     &        -94D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         68D0,       0D0,      0D0,      -36D0,     0D0,     0D0, &
     &        -61D0,       0D0,      0D0,       32D0,     0D0,     0D0, &
     &         71D0,       0D0,      0D0,      -31D0,     0D0,     0D0, &
     &         62D0,       0D0,      0D0,      -34D0,     0D0,     0D0, &
     &        -63D0,       0D0,      0D0,       33D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=231,240 ) / &
     &        -73D0,       0D0,      0D0,       32D0,     0D0,     0D0, &
     &        115D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &       -103D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         63D0,       0D0,      0D0,      -28D0,     0D0,     0D0, &
     &         74D0,       0D0,      0D0,      -32D0,     0D0,     0D0, &
     &       -103D0,       0D0,     -3D0,        3D0,     0D0,    -1D0, &
     &        -69D0,       0D0,      0D0,       30D0,     0D0,     0D0, &
     &         57D0,       0D0,      0D0,      -29D0,     0D0,     0D0, &
     &         94D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &         64D0,       0D0,      0D0,      -33D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=241,250 ) / &
     &        -63D0,       0D0,      0D0,       26D0,     0D0,     0D0, &
     &        -38D0,       0D0,      0D0,       20D0,     0D0,     0D0, &
     &        -43D0,       0D0,      0D0,       24D0,     0D0,     0D0, &
     &        -45D0,       0D0,      0D0,       23D0,     0D0,     0D0, &
     &         47D0,       0D0,      0D0,      -24D0,     0D0,     0D0, &
     &        -48D0,       0D0,      0D0,       25D0,     0D0,     0D0, &
     &         45D0,       0D0,      0D0,      -26D0,     0D0,     0D0, &
     &         56D0,       0D0,      0D0,      -25D0,     0D0,     0D0, &
     &         88D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &        -75D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=251,260 ) / &
     &         85D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         49D0,       0D0,      0D0,      -26D0,     0D0,     0D0, &
     &        -74D0,       0D0,     -3D0,       -1D0,     0D0,    -1D0, &
     &        -39D0,       0D0,      0D0,       21D0,     0D0,     0D0, &
     &         45D0,       0D0,      0D0,      -20D0,     0D0,     0D0, &
     &         51D0,       0D0,      0D0,      -22D0,     0D0,     0D0, &
     &        -40D0,       0D0,      0D0,       21D0,     0D0,     0D0, &
     &         41D0,       0D0,      0D0,      -21D0,     0D0,     0D0, &
     &        -42D0,       0D0,      0D0,       24D0,     0D0,     0D0, &
     &        -51D0,       0D0,      0D0,       22D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=261,270 ) / &
     &        -42D0,       0D0,      0D0,       22D0,     0D0,     0D0, &
     &         39D0,       0D0,      0D0,      -21D0,     0D0,     0D0, &
     &         46D0,       0D0,      0D0,      -18D0,     0D0,     0D0, &
     &        -53D0,       0D0,      0D0,       22D0,     0D0,     0D0, &
     &         82D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &         81D0,       0D0,     -1D0,       -4D0,     0D0,     0D0, &
     &         47D0,       0D0,      0D0,      -19D0,     0D0,     0D0, &
     &         53D0,       0D0,      0D0,      -23D0,     0D0,     0D0, &
     &        -45D0,       0D0,      0D0,       22D0,     0D0,     0D0, &
     &        -44D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=271,280 ) / &
     &        -33D0,       0D0,      0D0,       16D0,     0D0,     0D0, &
     &        -61D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         28D0,       0D0,      0D0,      -15D0,     0D0,     0D0, &
     &        -38D0,       0D0,      0D0,       19D0,     0D0,     0D0, &
     &        -33D0,       0D0,      0D0,       21D0,     0D0,     0D0, &
     &        -60D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         48D0,       0D0,      0D0,      -10D0,     0D0,     0D0, &
     &         27D0,       0D0,      0D0,      -14D0,     0D0,     0D0, &
     &         38D0,       0D0,      0D0,      -20D0,     0D0,     0D0, &
     &         31D0,       0D0,      0D0,      -13D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=281,290 ) / &
     &        -29D0,       0D0,      0D0,       15D0,     0D0,     0D0, &
     &         28D0,       0D0,      0D0,      -15D0,     0D0,     0D0, &
     &        -32D0,       0D0,      0D0,       15D0,     0D0,     0D0, &
     &         45D0,       0D0,      0D0,       -8D0,     0D0,     0D0, &
     &        -44D0,       0D0,      0D0,       19D0,     0D0,     0D0, &
     &         28D0,       0D0,      0D0,      -15D0,     0D0,     0D0, &
     &        -51D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -36D0,       0D0,      0D0,       20D0,     0D0,     0D0, &
     &         44D0,       0D0,      0D0,      -19D0,     0D0,     0D0, &
     &         26D0,       0D0,      0D0,      -14D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=291,300 ) / &
     &        -60D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         35D0,       0D0,      0D0,      -18D0,     0D0,     0D0, &
     &        -27D0,       0D0,      0D0,       11D0,     0D0,     0D0, &
     &         47D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         36D0,       0D0,      0D0,      -15D0,     0D0,     0D0, &
     &        -36D0,       0D0,      0D0,       20D0,     0D0,     0D0, &
     &        -35D0,       0D0,      0D0,       19D0,     0D0,     0D0, &
     &        -37D0,       0D0,      0D0,       19D0,     0D0,     0D0, &
     &         32D0,       0D0,      0D0,      -16D0,     0D0,     0D0, &
     &         35D0,       0D0,      0D0,      -14D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=301,310 ) / &
     &         32D0,       0D0,      0D0,      -13D0,     0D0,     0D0, &
     &         65D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         47D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         32D0,       0D0,      0D0,      -16D0,     0D0,     0D0, &
     &         37D0,       0D0,      0D0,      -16D0,     0D0,     0D0, &
     &        -30D0,       0D0,      0D0,       15D0,     0D0,     0D0, &
     &        -32D0,       0D0,      0D0,       16D0,     0D0,     0D0, &
     &        -31D0,       0D0,      0D0,       13D0,     0D0,     0D0, &
     &         37D0,       0D0,      0D0,      -16D0,     0D0,     0D0, &
     &         31D0,       0D0,      0D0,      -13D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=311,320 ) / &
     &         49D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         32D0,       0D0,      0D0,      -13D0,     0D0,     0D0, &
     &         23D0,       0D0,      0D0,      -12D0,     0D0,     0D0, &
     &        -43D0,       0D0,      0D0,       18D0,     0D0,     0D0, &
     &         26D0,       0D0,      0D0,      -11D0,     0D0,     0D0, &
     &        -32D0,       0D0,      0D0,       14D0,     0D0,     0D0, &
     &        -29D0,       0D0,      0D0,       14D0,     0D0,     0D0, &
     &        -27D0,       0D0,      0D0,       12D0,     0D0,     0D0, &
     &         30D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -11D0,       0D0,      0D0,        5D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=321,330 ) / &
     &        -21D0,       0D0,      0D0,       10D0,     0D0,     0D0, &
     &        -34D0,       0D0,      0D0,       15D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        6D0,     0D0,     0D0, &
     &        -36D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -9D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &        -21D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &        -29D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &        -15D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &        -20D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=331,340 ) / &
     &         28D0,       0D0,      0D0,        0D0,     0D0,    -2D0, &
     &         17D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -22D0,       0D0,      0D0,       12D0,     0D0,     0D0, &
     &        -14D0,       0D0,      0D0,        7D0,     0D0,     0D0, &
     &         24D0,       0D0,      0D0,      -11D0,     0D0,     0D0, &
     &         11D0,       0D0,      0D0,       -6D0,     0D0,     0D0, &
     &         14D0,       0D0,      0D0,       -6D0,     0D0,     0D0, &
     &         24D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         18D0,       0D0,      0D0,       -8D0,     0D0,     0D0, &
     &        -38D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=341,350 ) / &
     &        -31D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -16D0,       0D0,      0D0,        8D0,     0D0,     0D0, &
     &         29D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -18D0,       0D0,      0D0,       10D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &        -17D0,       0D0,      0D0,       10D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &         16D0,       0D0,      0D0,       -6D0,     0D0,     0D0, &
     &         22D0,       0D0,      0D0,      -12D0,     0D0,     0D0, &
     &         20D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=351,360 ) / &
     &        -13D0,       0D0,      0D0,        6D0,     0D0,     0D0, &
     &        -17D0,       0D0,      0D0,        9D0,     0D0,     0D0, &
     &        -14D0,       0D0,      0D0,        8D0,     0D0,     0D0, &
     &          0D0,       0D0,      0D0,       -7D0,     0D0,     0D0, &
     &         14D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         19D0,       0D0,      0D0,      -10D0,     0D0,     0D0, &
     &        -34D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -20D0,       0D0,      0D0,        8D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -5D0,     0D0,     0D0, &
     &        -18D0,       0D0,      0D0,        7D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=361,370 ) / &
     &         13D0,       0D0,      0D0,       -6D0,     0D0,     0D0, &
     &         17D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &         15D0,       0D0,      0D0,       -8D0,     0D0,     0D0, &
     &        -11D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &         13D0,       0D0,      0D0,       -5D0,     0D0,     0D0, &
     &        -18D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -35D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &        -19D0,       0D0,      0D0,       10D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=371,380 ) / &
     &        -26D0,       0D0,      0D0,       11D0,     0D0,     0D0, &
     &          8D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         10D0,       0D0,      0D0,       -6D0,     0D0,     0D0, &
     &        -21D0,       0D0,      0D0,        9D0,     0D0,     0D0, &
     &        -15D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -5D0,     0D0,     0D0, &
     &        -29D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -19D0,       0D0,      0D0,       10D0,     0D0,     0D0, &
     &         12D0,       0D0,      0D0,       -5D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=381,390 ) / &
     &         22D0,       0D0,      0D0,       -9D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &        -20D0,       0D0,      0D0,       11D0,     0D0,     0D0, &
     &        -20D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -17D0,       0D0,      0D0,        7D0,     0D0,     0D0, &
     &         15D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          8D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &         14D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        6D0,     0D0,     0D0, &
     &         25D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=391,400 ) / &
     &        -13D0,       0D0,      0D0,        6D0,     0D0,     0D0, &
     &        -14D0,       0D0,      0D0,        8D0,     0D0,     0D0, &
     &         13D0,       0D0,      0D0,       -5D0,     0D0,     0D0, &
     &        -17D0,       0D0,      0D0,        9D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        6D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &         10D0,       0D0,      0D0,       -6D0,     0D0,     0D0, &
     &        -15D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -22D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         28D0,       0D0,      0D0,       -1D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=401,410 ) / &
     &         15D0,       0D0,      0D0,       -7D0,     0D0,     0D0, &
     &         23D0,       0D0,      0D0,      -10D0,     0D0,     0D0, &
     &         12D0,       0D0,      0D0,       -5D0,     0D0,     0D0, &
     &         29D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &        -25D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         22D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -18D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         15D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &        -23D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         12D0,       0D0,      0D0,       -5D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=411,420 ) / &
     &         -8D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &        -19D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         21D0,       0D0,      0D0,       -9D0,     0D0,     0D0, &
     &         23D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &        -16D0,       0D0,      0D0,        8D0,     0D0,     0D0, &
     &        -19D0,       0D0,      0D0,        9D0,     0D0,     0D0, &
     &        -22D0,       0D0,      0D0,       10D0,     0D0,     0D0, &
     &         27D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         16D0,       0D0,      0D0,       -8D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=421,430 ) / &
     &         19D0,       0D0,      0D0,       -8D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &         -9D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         -9D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         -8D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         18D0,       0D0,      0D0,       -9D0,     0D0,     0D0, &
     &         16D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &        -10D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &        -23D0,       0D0,      0D0,        9D0,     0D0,     0D0, &
     &         16D0,       0D0,      0D0,       -1D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=431,440 ) / &
     &        -12D0,       0D0,      0D0,        6D0,     0D0,     0D0, &
     &         -8D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         30D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         24D0,       0D0,      0D0,      -10D0,     0D0,     0D0, &
     &         10D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &        -16D0,       0D0,      0D0,        7D0,     0D0,     0D0, &
     &        -16D0,       0D0,      0D0,        7D0,     0D0,     0D0, &
     &         17D0,       0D0,      0D0,       -7D0,     0D0,     0D0, &
     &        -24D0,       0D0,      0D0,       10D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        5D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=441,450 ) / &
     &        -24D0,       0D0,      0D0,       11D0,     0D0,     0D0, &
     &        -23D0,       0D0,      0D0,        9D0,     0D0,     0D0, &
     &        -13D0,       0D0,      0D0,        5D0,     0D0,     0D0, &
     &        -15D0,       0D0,      0D0,        7D0,     0D0,     0D0, &
     &          0D0,       0D0,  -1988D0,        0D0,     0D0, -1679D0, &
     &          0D0,       0D0,    -63D0,        0D0,     0D0,   -27D0, &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          0D0,       0D0,      5D0,        0D0,     0D0,     4D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          0D0,       0D0,    364D0,        0D0,     0D0,   176D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=451,460 ) / &
     &          0D0,       0D0,  -1044D0,        0D0,     0D0,  -891D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          0D0,       0D0,    330D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=461,470 ) / &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          0D0,       0D0,      5D0,        0D0,     0D0,     0D0, &
     &          0D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=471,480 ) / &
     &         -5D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &          0D0,       0D0,    -12D0,        0D0,     0D0,   -10D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=481,490 ) / &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          0D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=491,500 ) / &
     &         -8D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=501,510 ) / &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,       -3D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=511,520 ) / &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          8D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=521,530 ) / &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &        -13D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=531,540 ) / &
     &         10D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         10D0,       0D0,     13D0,        6D0,     0D0,    -5D0, &
     &          0D0,       0D0,     30D0,        0D0,     0D0,    14D0, &
     &          0D0,       0D0,   -162D0,        0D0,     0D0,  -138D0, &
     &          0D0,       0D0,     75D0,        0D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=541,550 ) / &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          9D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=551,560 ) / &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -6D0,       0D0,     -3D0,        3D0,     0D0,     1D0, &
     &          0D0,       0D0,     -3D0,        0D0,     0D0,    -2D0, &
     &         11D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         11D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=561,570 ) / &
     &         -1D0,       0D0,      3D0,        3D0,     0D0,    -1D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          0D0,       0D0,    -13D0,        0D0,     0D0,   -11D0, &
     &          3D0,       0D0,      6D0,        0D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        3D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=571,580 ) / &
     &          8D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         11D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          8D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         11D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        3D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=581,590 ) / &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -8D0,       0D0,      0D0,        4D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=591,600 ) / &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          0D0,       0D0,    -26D0,        0D0,     0D0,   -11D0, &
     &          0D0,       0D0,    -10D0,        0D0,     0D0,    -5D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &        -13D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=601,610 ) / &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -7D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=611,620 ) / &
     &         13D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &        -11D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=621,630 ) / &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &        -12D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &          0D0,       0D0,     -5D0,        0D0,     0D0,    -2D0, &
     &         -7D0,       0D0,      0D0,        4D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=631,640 ) / &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         12D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=641,650 ) / &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          6D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=651,660 ) / &
     &         -6D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,       -4D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -5D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        3D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         10D0,       0D0,      0D0,        0D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=661,670 ) / &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          7D0,       0D0,      0D0,       -3D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &         11D0,       0D0,      0D0,        0D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &         -6D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          5D0,       0D0,      0D0,       -2D0,     0D0,     0D0 /
      DATA ( ( CLS(I,J), I=1,6 ), J=671,678 ) / &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -4D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0, &
     &          4D0,       0D0,      0D0,       -2D0,     0D0,     0D0, &
     &          3D0,       0D0,      0D0,       -1D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        1D0,     0D0,     0D0, &
     &         -3D0,       0D0,      0D0,        2D0,     0D0,     0D0 /
!
!  Planetary argument multipliers:
!              L   L'  F   D   Om  Me  Ve  E  Ma  Ju  Sa  Ur  Ne  pre
!
      DATA ( ( NAPL(I,J), I=1,14 ), J=  1, 10 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -8, 16, -4, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  8,-16,  4,  5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1,  2,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -4,  8, -1, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0,  3, -8,  3,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  0,  0, 10, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0, -2,  6, -3,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 11, 20 ) / &
     &         0,  0,  1, -1,  1,  0,  0, -5,  8, -3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -4,  8, -3,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -8,  1,  5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  6,  4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  2, -5,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -5,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0, -2,  5,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 21, 30 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0, -2,  5,  0,  0,  2, &
     &         2,  0, -1, -1,  0,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0, 19,-21,  3,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  2, -4,  0, -3,  0,  0,  0,  0, &
     &         1,  0,  0, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0, -4, 10,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  0,  2,  0,  0, -5,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -7,  4,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  1, -1,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  0,  2,  0, -2,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 31, 40 ) / &
     &        -1,  0,  0,  0,  0,  0, 18,-16,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  1,  1,  2,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &        -1,  0,  1, -1,  1,  0, 18,-17,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  1,  1,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -8, 13,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  2, -2,  2,  0, -8, 11,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -8, 13,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  8,-14,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 41, 50 ) / &
     &         0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0,  1, &
     &        -2,  0,  0,  2,  1,  0,  0,  2,  0, -4,  5,  0,  0,  0, &
     &        -2,  0,  0,  2,  2,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -3,  1,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  3, -5,  0,  2,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -4,  3,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -1,  2,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &        -1,  0,  1,  0,  1,  0,  3, -5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 51, 60 ) / &
     &        -1,  0,  0,  1,  0,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -2, -2,  0,  0,  0, &
     &        -2,  0,  2,  0,  2,  0,  0, -5,  9,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0, -1,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  2,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  2, &
     &        -1,  0,  0,  1,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  0,  2,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 61, 70 ) / &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -9, 17,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  2,  0, -3,  5,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  2,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0, 17,-16,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  1, -3,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  0,  5, -6,  0,  0,  0,  0,  0, &
     &         0,  0, -2,  2,  0,  0,  0,  9,-13,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0,  0,  1,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 71, 80 ) / &
     &         0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  0,  1,  0,  0,  0, &
     &         0,  0, -2,  2,  0,  0,  5, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  1,  0,  5, -7,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  6, -8,  0,  0,  0,  0,  0,  0, &
     &         2,  0,  1, -3,  1,  0, -6,  7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  2,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  1,  0,  0,  1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  2,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 81, 90 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -8, 15,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -8, 15,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -9, 15,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &         1,  0, -1, -1,  0,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &         2,  0,  0, -2,  0,  0,  2, -5,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -5,  5,  0,  0,  0, &
     &         2,  0,  0, -2,  1,  0,  0, -6,  8,  0,  0,  0,  0,  0, &
     &         2,  0,  0, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J= 91,100 ) / &
     &        -2,  0,  1,  1,  0,  0,  0,  1,  0, -3,  0,  0,  0,  0, &
     &        -2,  0,  1,  1,  1,  0,  0,  1,  0, -3,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -1, -5,  0,  0,  0, &
     &        -1,  0,  0,  1,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &        -1,  0,  1,  1,  1,  0,-20, 20,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0, 20,-21,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  8,-15,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0,-10, 15,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=101,110 ) / &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0, -2,  4,  0,  0,  0, &
     &         2,  0,  0, -2,  1,  0, -6,  8,  0,  0,  0,  0,  0,  0, &
     &         0,  0, -2,  2,  1,  0,  5, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -1,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  1,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=111,120 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2, &
     &         0,  0,  2, -2,  1,  0,  0, -9, 13,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  7,-13,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  9,-17,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -9, 17,  0,  0,  0,  0,  2, &
     &         1,  0,  0, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &         1,  0,  0, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  2,  0,  0, -1,  2,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=121,130 ) / &
     &         0,  0, -1,  1,  1,  0,  0,  0,  2,  0,  0,  0,  0,  0, &
     &         0,  0, -2,  2,  0,  1,  0, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -5,  0,  2,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  0,  2,  0, -3,  1,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  8,-13,  0,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  8,-12,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0, -8, 11,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  1,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  1,  0, 18,-16,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=131,140 ) / &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  1,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  3, -7,  4,  0,  0,  0,  0,  0, &
     &        -2,  0,  1,  1,  1,  0,  0, -3,  7,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0, -2,  5,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  0,  0, -2,  5,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &         1,  0,  0,  0,  1,  0,-10,  3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  1,  0, 10, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=141,150 ) / &
     &         0,  0,  0,  0,  1,  0,  0,  0,  0,  2, -5,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  2, -5,  0,  0,  0, &
     &         2,  0, -1, -1,  1,  0,  0,  3, -7,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0,  0, -5,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -3,  7, -4,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &         1,  0,  0,  0,  1,  0,-18, 16,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  1,  1,  1,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -8, 13,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=151,160 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0,  0, -2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  2,  0,  0,  0,  0,  1, &
     &        -1,  0,  0,  1,  1,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  1,  1,  0,  0,  3, -4,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0, -2,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  2,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=161,170 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  2, &
     &         0,  0,  1, -1,  0,  0,  3, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -2,  4,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  5, -7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  5, -8,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  6, -8,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -8, 15,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=171,180 ) / &
     &        -2,  0,  0,  2,  1,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  1,  0,  0,  6, -8,  0,  0,  0,  0,  0, &
     &         1,  0,  0, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=181,190 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  2, &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0,  0, -1,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  0,  0,  0, -1,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  0, -1,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -7, 13,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  7,-13,  0,  0,  0,  0,  0, &
     &         2,  0,  0, -2,  1,  0,  0, -5,  6,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -8, 11,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1, -1,  0,  2,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=191,200 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  0,  3,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  2, &
     &        -2,  0,  0,  2,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &         2,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0,  0, -2,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=201,210 ) / &
     &         0,  0,  0,  0,  1,  0,  0,  1, -2,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0,  0, -2,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -2,  0,  0,  2,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0,  3, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -3,  5,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -3,  5,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=211,220 ) / &
     &         0,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -3,  5,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0,  1, -4,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  4,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -3,  4,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  4,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  8,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=221,230 ) / &
     &         0,  0,  2, -2,  2,  0, -5,  6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -5,  8,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  8,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -5,  8,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  2,  0,  0, -1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  0,  0, -1,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -2,  0,  1,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=231,240 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -6, 11,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6,-11,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0, -1,  0,  4,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0,  0,  0, &
     &         2,  0,  0, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  2,  0,  0, -2,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -7,  9,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=241,250 ) / &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  2, &
     &         0,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  2, &
     &         0,  0,  0,  0,  1,  0,  3, -5,  0,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  2, -4,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -4,  4,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=251,260 ) / &
     &         0,  0,  1, -1,  2,  0, -5,  7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  6,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -4,  6,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  6,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  6,  0,  0,  0,  0,  2, &
     &         0,  0, -1,  1,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -5,  9,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -5,  9,  0,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=261,270 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  5, -9,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &        -2,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0, -2,  2,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -6, 10,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -6, 10,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -2,  3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -2,  3,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=271,280 ) / &
     &         0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0, -1,  0,  3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -8,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -4,  8,  0,  0,  0,  0,  2, &
     &         0,  0, -2,  2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -4,  7,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=281,290 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -4,  7,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -7,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -5, 10,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  1,  0, -1,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  5,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  5,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -5,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=291,300 ) / &
     &         0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  1, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -1,  2,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -1,  2,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -7, 11,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -7, 11,  0,  0,  0,  0,  0,  1, &
     &         0,  0, -2,  2,  0,  0,  4, -4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2, -3,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0, -4,  4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=301,310 ) / &
     &         0,  0, -1,  1,  0,  0,  4, -5,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -4,  7,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0, -4,  6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -4,  7,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -4,  6,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -4,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0, -4,  5,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -4,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=311,320 ) / &
     &        -2,  0,  0,  2,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0, &
     &         0,  0, -1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  5,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  3,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -7, 12,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -1,  1,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -1,  1,  0,  0,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=321,330 ) / &
     &         0,  0,  1, -1,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  1, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  5,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  4,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -4,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -6, 10,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -6, 10,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=331,340 ) / &
     &         0,  0,  2, -2,  1,  0,  0, -3,  0,  3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  7,  0,  0,  0,  0,  2, &
     &        -2,  0,  0,  2,  0,  0,  4, -4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -5,  8,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -8,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  3,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  2, -4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -2,  4,  0,  0,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=341,350 ) / &
     &         0,  0,  1, -1,  1,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -2,  4,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -6,  9,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -6,  9,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -4,  6,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -6,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  3, -4,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=351,360 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  2,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -5,  9,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -3,  4,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -3,  4,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -4,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  1,  0,  0,  2, -2,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=361,370 ) / &
     &         0,  0,  0,  0,  1,  0,  0, -1,  0,  2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -3,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  1, -5,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  1,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -3,  5,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -3,  4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -2,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=371,380 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  0, -1,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0, -2,  2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -8, 14,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  2, -5,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -8,  3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -8,  3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -8,  3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=381,390 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -3,  8, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0, -2,  5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 12,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 12,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  1, -2,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  1,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  2,  0,  0,  2, &
     &         0,  0,  2, -2,  1,  0, -5,  5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=391,400 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  3, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -3,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -3,  6,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  7,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  7,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0, -5,  6,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=401,410 ) / &
     &         0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0, -1,  0,  3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  2,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  6,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  1,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -6,  9,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6, -9,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -2,  2,  0,  0,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=411,420 ) / &
     &         0,  0,  1, -1,  1,  0, -2,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  2, -2,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  0,  3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -5,  7,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -7,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  1, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -1,  3,  0,  0,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=421,430 ) / &
     &         0,  0,  1, -1,  1,  0, -1,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -1,  3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -7, 10,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -7, 10,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -4,  8,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -4,  5,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -4,  5,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  4, -5,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=431,440 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -2,  0,  5,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -9, 13,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  5,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  0,  4,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -4,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  7,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=441,450 ) / &
     &         0,  0,  0,  0,  0,  0, -2,  5,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -2,  5,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -6,  8,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -6,  8,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  6, -8,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  1,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  9,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=451,460 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5, 10,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -3,  3,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -3,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=461,470 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -5, 13,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -2,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0, -1,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -6, 15,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 15,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=471,480 ) / &
     &         0,  0,  0,  0,  0,  0, -3,  9, -4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  2, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  8, -1, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6, -8,  3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  1, -1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=481,490 ) / &
     &         0,  0,  0,  0,  0,  0,  0, -6, 16, -4, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  8, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -2,  8, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6, -8,  1,  5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  3, -5,  4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 11,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 11,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -8, 11,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, 11,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=491,500 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  0,  1,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  3, -3,  0,  2,  0,  0,  0,  2, &
     &         0,  0,  2, -2,  1,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &         0,  0,  1, -1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -3,  7,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  6,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=501,510 ) / &
     &         0,  0,  0,  0,  0,  0, -5,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  5, -6,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0,  2,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  6,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  7, -9,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=511,520 ) / &
     &         0,  0,  0,  0,  0,  0, -1,  4,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -1,  4,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -7,  9,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -7,  9,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -4,  4,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  4, -4,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=521,530 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -3,  0,  5,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -9, 12,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -4,  0,  0,  0,  0, &
     &         0,  0,  2, -2,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=531,540 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -2,  6,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -6,  7,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  6, -7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -2,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -2,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=541,550 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0, -1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -2,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0,  0, -1,  0,  0,  2, &
     &         0,  0,  2, -2,  1,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0, -8, 16,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0,  2, -5,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  7, -8,  3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -5, 16, -4, -5,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=551,560 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0, -1,  8, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 10,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8, 10,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -8, 10,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  2,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  3,  0,  1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -3,  8,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -5,  5,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=561,570 ) / &
     &         0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  5, -5,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6, -5,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  7, -8,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=571,580 ) / &
     &         0,  0,  0,  0,  0,  0,  4, -3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  1,  2,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -9, 11,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -9, 11,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  4,  0, -4,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4,  0, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -6,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  6, -6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  4,  0, -2,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=581,590 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  3, -1,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4,  0, -1,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4,  0,  0, -2,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5, -2,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  8, -9,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  5, -4,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=591,600 ) / &
     &         0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  2,  1,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -7,  7,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  7, -7,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  4, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  5,  0, -4,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=601,610 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  5,  0, -3,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  5,  0, -2,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -8,  8,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  8, -8,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  5, -3,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0, -9,  9,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -9,  9,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0, -9,  9,  0,  0,  0,  0,  0,  1 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=611,620 ) / &
     &         0,  0,  0,  0,  0,  0,  9, -9,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  6, -4,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  2, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  1, &
     &         0,  0,  0,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  2 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=621,630 ) / &
     &         0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  2, &
     &         1,  0,  0, -2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &        -1,  0,  0,  2,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &        -2,  0,  0,  2,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=631,640 ) / &
     &        -1,  0,  0,  0,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &        -1,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  2,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         1,  0, -1,  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  0,  2,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &        -2,  0,  0,  0,  0,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &         1,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &        -1,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  1, -1,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=641,650 ) / &
     &        -1,  0,  0,  0,  0,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &        -1,  0,  0,  2,  1,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  0,  0,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &        -1,  0,  0,  2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &        -1,  0,  0,  2,  0,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  0, -2,  1,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &         1,  0,  2, -2,  2,  0, -3,  3,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  2, -2,  2,  0,  0, -2,  0,  2,  0,  0,  0,  0, &
     &         1,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  0,  0,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=651,660 ) / &
     &         0,  0,  0, -2,  0,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0, -2,  0,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0, -2,  2,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0, -2,  3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  0,  2,  0,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &         0,  0,  1,  1,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  2,  0,  2,  0, 10, -3,  0,  0,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=661,670 ) / &
     &         0,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &        -1,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &         2,  0,  2, -2,  2,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  1,  0,  0, -2,  0,  3,  0,  0,  0,  0, &
     &         0,  0,  1,  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  2,  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &        -2,  0,  2,  2,  2,  0,  0,  2,  0, -2,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=671,680 ) / &
     &         0,  0,  2,  0,  2,  0,  2, -3,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  0,  1,  0, -1,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  2, -2,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  2,  2,  2,  0,  0, -1,  0,  1,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  2,  0, -1,  1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  2,  2,  2,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &         2,  0,  2,  0,  2,  0,  0,  2,  0, -3,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  2,  0,  0, -4,  8, -3,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  2,  0,  0,  4, -8,  3,  0,  0,  0,  0 /
      DATA ( ( NAPL(I,J), I=1,14 ), J=681,687 ) / &
     &         1,  0,  1,  1,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  0,  2,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &         2,  0,  2,  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0, &
     &        -1,  0,  2,  2,  2,  0,  0,  2,  0, -2,  0,  0,  0,  0, &
     &        -1,  0,  2,  2,  2,  0,  3, -3,  0,  0,  0,  0,  0,  0, &
     &         1,  0,  2,  0,  2,  0,  1, -1,  0,  0,  0,  0,  0,  0, &
     &         0,  0,  2,  2,  2,  0,  0,  2,  0, -2,  0,  0,  0,  0 /
!
!  Planetary nutation coefficients, unit 1e-7 arcsec:
!  longitude (sin, cos), obliquity (sin, cos)
!
      DATA ( ( ICPL(I,J), I=1,4 ), J=  1, 10 ) / &
     &       1440,          0,          0,          0, &
     &         56,       -117,        -42,        -40, &
     &        125,        -43,          0,        -54, &
     &          0,          5,          0,          0, &
     &          3,         -7,         -3,          0, &
     &          3,          0,          0,         -2, &
     &       -114,          0,          0,         61, &
     &       -219,         89,          0,          0, &
     &         -3,          0,          0,          0, &
     &       -462,       1604,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 11, 20 ) / &
     &         99,          0,          0,        -53, &
     &         -3,          0,          0,          2, &
     &          0,          6,          2,          0, &
     &          3,          0,          0,          0, &
     &        -12,          0,          0,          0, &
     &         14,       -218,        117,          8, &
     &         31,       -481,       -257,        -17, &
     &       -491,        128,          0,          0, &
     &      -3084,       5123,       2735,       1647, &
     &      -1444,       2409,      -1286,       -771 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 21, 30 ) / &
     &         11,        -24,        -11,         -9, &
     &         26,         -9,          0,          0, &
     &        103,        -60,          0,          0, &
     &          0,        -13,         -7,          0, &
     &        -26,        -29,        -16,         14, &
     &          9,        -27,        -14,         -5, &
     &         12,          0,          0,         -6, &
     &         -7,          0,          0,          0, &
     &          0,         24,          0,          0, &
     &        284,          0,          0,       -151 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 31, 40 ) / &
     &        226,        101,          0,          0, &
     &          0,         -8,         -2,          0, &
     &          0,         -6,         -3,          0, &
     &          5,          0,          0,         -3, &
     &        -41,        175,         76,         17, &
     &          0,         15,          6,          0, &
     &        425,        212,       -133,        269, &
     &       1200,        598,        319,       -641, &
     &        235,        334,          0,          0, &
     &         11,        -12,         -7,         -6 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 41, 50 ) / &
     &          5,         -6,          3,          3, &
     &         -5,          0,          0,          3, &
     &          6,          0,          0,         -3, &
     &         15,          0,          0,          0, &
     &         13,          0,          0,         -7, &
     &         -6,         -9,          0,          0, &
     &        266,        -78,          0,          0, &
     &       -460,       -435,       -232,        246, &
     &          0,         15,          7,          0, &
     &         -3,          0,          0,          2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 51, 60 ) / &
     &          0,        131,          0,          0, &
     &          4,          0,          0,          0, &
     &          0,          3,          0,          0, &
     &          0,          4,          2,          0, &
     &          0,          3,          0,          0, &
     &        -17,        -19,        -10,          9, &
     &         -9,        -11,          6,         -5, &
     &         -6,          0,          0,          3, &
     &        -16,          8,          0,          0, &
     &          0,          3,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 61, 70 ) / &
     &         11,         24,         11,         -5, &
     &         -3,         -4,         -2,          1, &
     &          3,          0,          0,         -1, &
     &          0,         -8,         -4,          0, &
     &          0,          3,          0,          0, &
     &          0,          5,          0,          0, &
     &          0,          3,          2,          0, &
     &         -6,          4,          2,          3, &
     &         -3,         -5,          0,          0, &
     &         -5,          0,          0,          2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 71, 80 ) / &
     &          4,         24,         13,         -2, &
     &        -42,         20,          0,          0, &
     &        -10,        233,          0,          0, &
     &         -3,          0,          0,          1, &
     &         78,        -18,          0,          0, &
     &          0,          3,          1,          0, &
     &          0,         -3,         -1,          0, &
     &          0,         -4,         -2,          1, &
     &          0,         -8,         -4,         -1, &
     &          0,         -5,          3,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 81, 90 ) / &
     &         -7,          0,          0,          3, &
     &        -14,          8,          3,          6, &
     &          0,          8,         -4,          0, &
     &          0,         19,         10,          0, &
     &         45,        -22,          0,          0, &
     &         -3,          0,          0,          0, &
     &          0,         -3,          0,          0, &
     &          0,          3,          0,          0, &
     &          3,          5,          3,         -2, &
     &         89,        -16,         -9,        -48 /
      DATA ( ( ICPL(I,J), I=1,4 ), J= 91,100 ) / &
     &          0,          3,          0,          0, &
     &         -3,          7,          4,          2, &
     &       -349,        -62,          0,          0, &
     &        -15,         22,          0,          0, &
     &         -3,          0,          0,          0, &
     &        -53,          0,          0,          0, &
     &          5,          0,          0,         -3, &
     &          0,         -8,          0,          0, &
     &         15,         -7,         -4,         -8, &
     &         -3,          0,          0,          1 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=101,110 ) / &
     &        -21,        -78,          0,          0, &
     &         20,        -70,        -37,        -11, &
     &          0,          6,          3,          0, &
     &          5,          3,          2,         -2, &
     &        -17,         -4,         -2,          9, &
     &          0,          6,          3,          0, &
     &         32,         15,         -8,         17, &
     &        174,         84,         45,        -93, &
     &         11,         56,          0,          0, &
     &        -66,        -12,         -6,         35 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=111,120 ) / &
     &         47,          8,          4,        -25, &
     &          0,          8,          4,          0, &
     &         10,        -22,        -12,         -5, &
     &         -3,          0,          0,          2, &
     &        -24,         12,          0,          0, &
     &          5,         -6,          0,          0, &
     &          3,          0,          0,         -2, &
     &          4,          3,          1,         -2, &
     &          0,         29,         15,          0, &
     &         -5,         -4,         -2,          2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=121,130 ) / &
     &          8,         -3,         -1,         -5, &
     &          0,         -3,          0,          0, &
     &         10,          0,          0,          0, &
     &          3,          0,          0,         -2, &
     &         -5,          0,          0,          3, &
     &         46,         66,         35,        -25, &
     &        -14,          7,          0,          0, &
     &          0,          3,          2,          0, &
     &         -5,          0,          0,          0, &
     &        -68,        -34,        -18,         36 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=131,140 ) / &
     &          0,         14,          7,          0, &
     &         10,         -6,         -3,         -5, &
     &         -5,         -4,         -2,          3, &
     &         -3,          5,          2,          1, &
     &         76,         17,          9,        -41, &
     &         84,        298,        159,        -45, &
     &          3,          0,          0,         -1, &
     &         -3,          0,          0,          2, &
     &         -3,          0,          0,          1, &
     &        -82,        292,        156,         44 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=141,150 ) / &
     &        -73,         17,          9,         39, &
     &         -9,        -16,          0,          0, &
     &          3,          0,         -1,         -2, &
     &         -3,          0,          0,          0, &
     &         -9,         -5,         -3,          5, &
     &       -439,          0,          0,          0, &
     &         57,        -28,        -15,        -30, &
     &          0,         -6,         -3,          0, &
     &         -4,          0,          0,          2, &
     &        -40,         57,         30,         21 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=151,160 ) / &
     &         23,          7,          3,        -13, &
     &        273,         80,         43,       -146, &
     &       -449,        430,          0,          0, &
     &         -8,        -47,        -25,          4, &
     &          6,         47,         25,         -3, &
     &          0,         23,         13,          0, &
     &         -3,          0,          0,          2, &
     &          3,         -4,         -2,         -2, &
     &        -48,       -110,        -59,         26, &
     &         51,        114,         61,        -27 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=161,170 ) / &
     &       -133,          0,          0,         57, &
     &          0,          4,          0,          0, &
     &        -21,         -6,         -3,         11, &
     &          0,         -3,         -1,          0, &
     &        -11,        -21,        -11,          6, &
     &        -18,       -436,       -233,          9, &
     &         35,         -7,          0,          0, &
     &          0,          5,          3,          0, &
     &         11,         -3,         -1,         -6, &
     &         -5,         -3,         -1,          3 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=171,180 ) / &
     &        -53,         -9,         -5,         28, &
     &          0,          3,          2,          1, &
     &          4,          0,          0,         -2, &
     &          0,         -4,          0,          0, &
     &        -50,        194,        103,         27, &
     &        -13,         52,         28,          7, &
     &        -91,        248,          0,          0, &
     &          6,         49,         26,         -3, &
     &         -6,        -47,        -25,          3, &
     &          0,          5,          3,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=181,190 ) / &
     &         52,         23,         10,        -23, &
     &         -3,          0,          0,          1, &
     &          0,          5,          3,          0, &
     &         -4,          0,          0,          0, &
     &         -4,          8,          3,          2, &
     &         10,          0,          0,          0, &
     &          3,          0,          0,         -2, &
     &          0,          8,          4,          0, &
     &          0,          8,          4,          1, &
     &         -4,          0,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=191,200 ) / &
     &         -4,          0,          0,          0, &
     &         -8,          4,          2,          4, &
     &          8,         -4,         -2,         -4, &
     &          0,         15,          7,          0, &
     &       -138,          0,          0,          0, &
     &          0,         -7,         -3,          0, &
     &          0,         -7,         -3,          0, &
     &         54,          0,          0,        -29, &
     &          0,         10,          4,          0, &
     &         -7,          0,          0,          3 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=201,210 ) / &
     &        -37,         35,         19,         20, &
     &          0,          4,          0,          0, &
     &         -4,          9,          0,          0, &
     &          8,          0,          0,         -4, &
     &         -9,        -14,         -8,          5, &
     &         -3,         -9,         -5,          3, &
     &       -145,         47,          0,          0, &
     &        -10,         40,         21,          5, &
     &         11,        -49,        -26,         -7, &
     &      -2150,          0,          0,        932 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=211,220 ) / &
     &        -12,          0,          0,          5, &
     &         85,          0,          0,        -37, &
     &          4,          0,          0,         -2, &
     &          3,          0,          0,         -2, &
     &        -86,        153,          0,          0, &
     &         -6,          9,          5,          3, &
     &          9,        -13,         -7,         -5, &
     &         -8,         12,          6,          4, &
     &        -51,          0,          0,         22, &
     &        -11,       -268,       -116,          5 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=221,230 ) / &
     &          0,         12,          5,          0, &
     &          0,          7,          3,          0, &
     &         31,          6,          3,        -17, &
     &        140,         27,         14,        -75, &
     &         57,         11,          6,        -30, &
     &        -14,        -39,          0,          0, &
     &          0,         -6,         -2,          0, &
     &          4,         15,          8,         -2, &
     &          0,          4,          0,          0, &
     &         -3,          0,          0,          1 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=231,240 ) / &
     &          0,         11,          5,          0, &
     &          9,          6,          0,          0, &
     &         -4,         10,          4,          2, &
     &          5,          3,          0,          0, &
     &         16,          0,          0,         -9, &
     &         -3,          0,          0,          0, &
     &          0,          3,          2,         -1, &
     &          7,          0,          0,         -3, &
     &        -25,         22,          0,          0, &
     &         42,        223,        119,        -22 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=241,250 ) / &
     &        -27,       -143,        -77,         14, &
     &          9,         49,         26,         -5, &
     &      -1166,          0,          0,        505, &
     &         -5,          0,          0,          2, &
     &         -6,          0,          0,          3, &
     &         -8,          0,          1,          4, &
     &          0,         -4,          0,          0, &
     &        117,          0,          0,        -63, &
     &         -4,          8,          4,          2, &
     &          3,          0,          0,         -2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=251,260 ) / &
     &         -5,          0,          0,          2, &
     &          0,         31,          0,          0, &
     &         -5,          0,          1,          3, &
     &          4,          0,          0,         -2, &
     &         -4,          0,          0,          2, &
     &        -24,        -13,         -6,         10, &
     &          3,          0,          0,          0, &
     &          0,        -32,        -17,          0, &
     &          8,         12,          5,         -3, &
     &          3,          0,          0,         -1 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=261,270 ) / &
     &          7,         13,          0,          0, &
     &         -3,         16,          0,          0, &
     &         50,          0,          0,        -27, &
     &          0,         -5,         -3,          0, &
     &         13,          0,          0,          0, &
     &          0,          5,          3,          1, &
     &         24,          5,          2,        -11, &
     &          5,        -11,         -5,         -2, &
     &         30,         -3,         -2,        -16, &
     &         18,          0,          0,         -9 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=271,280 ) / &
     &          8,        614,          0,          0, &
     &          3,         -3,         -1,         -2, &
     &          6,         17,          9,         -3, &
     &         -3,         -9,         -5,          2, &
     &          0,          6,          3,         -1, &
     &       -127,         21,          9,         55, &
     &          3,          5,          0,          0, &
     &         -6,        -10,         -4,          3, &
     &          5,          0,          0,          0, &
     &         16,          9,          4,         -7 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=281,290 ) / &
     &          3,          0,          0,         -2, &
     &          0,         22,          0,          0, &
     &          0,         19,         10,          0, &
     &          7,          0,          0,         -4, &
     &          0,         -5,         -2,          0, &
     &          0,          3,          1,          0, &
     &         -9,          3,          1,          4, &
     &         17,          0,          0,         -7, &
     &          0,         -3,         -2,         -1, &
     &        -20,         34,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=291,300 ) / &
     &        -10,          0,          1,          5, &
     &         -4,          0,          0,          2, &
     &         22,        -87,          0,          0, &
     &         -4,          0,          0,          2, &
     &         -3,         -6,         -2,          1, &
     &        -16,         -3,         -1,          7, &
     &          0,         -3,         -2,          0, &
     &          4,          0,          0,          0, &
     &        -68,         39,          0,          0, &
     &         27,          0,          0,        -14 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=301,310 ) / &
     &          0,         -4,          0,          0, &
     &        -25,          0,          0,          0, &
     &        -12,         -3,         -2,          6, &
     &          3,          0,          0,         -1, &
     &          3,         66,         29,         -1, &
     &        490,          0,          0,       -213, &
     &        -22,         93,         49,         12, &
     &         -7,         28,         15,          4, &
     &         -3,         13,          7,          2, &
     &        -46,         14,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=311,320 ) / &
     &         -5,          0,          0,          0, &
     &          2,          1,          0,          0, &
     &          0,         -3,          0,          0, &
     &        -28,          0,          0,         15, &
     &          5,          0,          0,         -2, &
     &          0,          3,          0,          0, &
     &        -11,          0,          0,          5, &
     &          0,          3,          1,          0, &
     &         -3,          0,          0,          1, &
     &         25,        106,         57,        -13 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=321,330 ) / &
     &          5,         21,         11,         -3, &
     &       1485,          0,          0,          0, &
     &         -7,        -32,        -17,          4, &
     &          0,          5,          3,          0, &
     &         -6,         -3,         -2,          3, &
     &         30,         -6,         -2,        -13, &
     &         -4,          4,          0,          0, &
     &        -19,          0,          0,         10, &
     &          0,          4,          2,         -1, &
     &          0,          3,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=331,340 ) / &
     &          4,          0,          0,         -2, &
     &          0,         -3,         -1,          0, &
     &         -3,          0,          0,          0, &
     &          5,          3,          1,         -2, &
     &          0,         11,          0,          0, &
     &        118,          0,          0,        -52, &
     &          0,         -5,         -3,          0, &
     &        -28,         36,          0,          0, &
     &          5,         -5,          0,          0, &
     &         14,        -59,        -31,         -8 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=341,350 ) / &
     &          0,          9,          5,          1, &
     &       -458,          0,          0,        198, &
     &          0,        -45,        -20,          0, &
     &          9,          0,          0,         -5, &
     &          0,         -3,          0,          0, &
     &          0,         -4,         -2,         -1, &
     &         11,          0,          0,         -6, &
     &          6,          0,          0,         -2, &
     &        -16,         23,          0,          0, &
     &          0,         -4,         -2,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=351,360 ) / &
     &         -5,          0,          0,          2, &
     &       -166,        269,          0,          0, &
     &         15,          0,          0,         -8, &
     &         10,          0,          0,         -4, &
     &        -78,         45,          0,          0, &
     &          0,         -5,         -2,          0, &
     &          7,          0,          0,         -4, &
     &         -5,        328,          0,          0, &
     &          3,          0,          0,         -2, &
     &          5,          0,          0,         -2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=361,370 ) / &
     &          0,          3,          1,          0, &
     &         -3,          0,          0,          0, &
     &         -3,          0,          0,          0, &
     &          0,         -4,         -2,          0, &
     &      -1223,        -26,          0,          0, &
     &          0,          7,          3,          0, &
     &          3,          0,          0,          0, &
     &          0,          3,          2,          0, &
     &         -6,         20,          0,          0, &
     &       -368,          0,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=371,380 ) / &
     &        -75,          0,          0,          0, &
     &         11,          0,          0,         -6, &
     &          3,          0,          0,         -2, &
     &         -3,          0,          0,          1, &
     &        -13,        -30,          0,          0, &
     &         21,          3,          0,          0, &
     &         -3,          0,          0,          1, &
     &         -4,          0,          0,          2, &
     &          8,        -27,          0,          0, &
     &        -19,        -11,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=381,390 ) / &
     &         -4,          0,          0,          2, &
     &          0,          5,          2,          0, &
     &         -6,          0,          0,          2, &
     &         -8,          0,          0,          0, &
     &         -1,          0,          0,          0, &
     &        -14,          0,          0,          6, &
     &          6,          0,          0,          0, &
     &        -74,          0,          0,         32, &
     &          0,         -3,         -1,          0, &
     &          4,          0,          0,         -2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=391,400 ) / &
     &          8,         11,          0,          0, &
     &          0,          3,          2,          0, &
     &       -262,          0,          0,        114, &
     &          0,         -4,          0,          0, &
     &         -7,          0,          0,          4, &
     &          0,        -27,        -12,          0, &
     &        -19,         -8,         -4,          8, &
     &        202,          0,          0,        -87, &
     &         -8,         35,         19,          5, &
     &          0,          4,          2,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=401,410 ) / &
     &         16,         -5,          0,          0, &
     &          5,          0,          0,         -3, &
     &          0,         -3,          0,          0, &
     &          1,          0,          0,          0, &
     &        -35,        -48,        -21,         15, &
     &         -3,         -5,         -2,          1, &
     &          6,          0,          0,         -3, &
     &          3,          0,          0,         -1, &
     &          0,         -5,          0,          0, &
     &         12,         55,         29,         -6 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=411,420 ) / &
     &          0,          5,          3,          0, &
     &       -598,          0,          0,          0, &
     &         -3,        -13,         -7,          1, &
     &         -5,         -7,         -3,          2, &
     &          3,          0,          0,         -1, &
     &          5,         -7,          0,          0, &
     &          4,          0,          0,         -2, &
     &         16,         -6,          0,          0, &
     &          8,         -3,          0,          0, &
     &          8,        -31,        -16,         -4 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=421,430 ) / &
     &          0,          3,          1,          0, &
     &        113,          0,          0,        -49, &
     &          0,        -24,        -10,          0, &
     &          4,          0,          0,         -2, &
     &         27,          0,          0,          0, &
     &         -3,          0,          0,          1, &
     &          0,         -4,         -2,          0, &
     &          5,          0,          0,         -2, &
     &          0,         -3,          0,          0, &
     &        -13,          0,          0,          6 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=431,440 ) / &
     &          5,          0,          0,         -2, &
     &        -18,        -10,         -4,          8, &
     &         -4,        -28,          0,          0, &
     &         -5,          6,          3,          2, &
     &         -3,          0,          0,          1, &
     &         -5,         -9,         -4,          2, &
     &         17,          0,          0,         -7, &
     &         11,          4,          0,          0, &
     &          0,         -6,         -2,          0, &
     &         83,         15,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=441,450 ) / &
     &         -4,          0,          0,          2, &
     &          0,       -114,        -49,          0, &
     &        117,          0,          0,        -51, &
     &         -5,         19,         10,          2, &
     &         -3,          0,          0,          0, &
     &         -3,          0,          0,          2, &
     &          0,         -3,         -1,          0, &
     &          3,          0,          0,          0, &
     &          0,         -6,         -2,          0, &
     &        393,          3,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=451,460 ) / &
     &         -4,         21,         11,          2, &
     &         -6,          0,         -1,          3, &
     &         -3,          8,          4,          1, &
     &          8,          0,          0,          0, &
     &         18,        -29,        -13,         -8, &
     &          8,         34,         18,         -4, &
     &         89,          0,          0,          0, &
     &          3,         12,          6,         -1, &
     &         54,        -15,         -7,        -24, &
     &          0,          3,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=461,470 ) / &
     &          3,          0,          0,         -1, &
     &          0,         35,          0,          0, &
     &       -154,        -30,        -13,         67, &
     &         15,          0,          0,          0, &
     &          0,          4,          2,          0, &
     &          0,          9,          0,          0, &
     &         80,        -71,        -31,        -35, &
     &          0,        -20,         -9,          0, &
     &         11,          5,          2,         -5, &
     &         61,        -96,        -42,        -27 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=471,480 ) / &
     &         14,          9,          4,         -6, &
     &        -11,         -6,         -3,          5, &
     &          0,         -3,         -1,          0, &
     &        123,       -415,       -180,        -53, &
     &          0,          0,          0,        -35, &
     &         -5,          0,          0,          0, &
     &          7,        -32,        -17,         -4, &
     &          0,         -9,         -5,          0, &
     &          0,         -4,          2,          0, &
     &        -89,          0,          0,         38 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=481,490 ) / &
     &          0,        -86,        -19,         -6, &
     &          0,          0,        -19,          6, &
     &       -123,       -416,       -180,         53, &
     &          0,         -3,         -1,          0, &
     &         12,         -6,         -3,         -5, &
     &        -13,          9,          4,          6, &
     &          0,        -15,         -7,          0, &
     &          3,          0,          0,         -1, &
     &        -62,        -97,        -42,         27, &
     &        -11,          5,          2,          5 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=491,500 ) / &
     &          0,        -19,         -8,          0, &
     &         -3,          0,          0,          1, &
     &          0,          4,          2,          0, &
     &          0,          3,          0,          0, &
     &          0,          4,          2,          0, &
     &        -85,        -70,        -31,         37, &
     &        163,        -12,         -5,        -72, &
     &        -63,        -16,         -7,         28, &
     &        -21,        -32,        -14,          9, &
     &          0,         -3,         -1,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=501,510 ) / &
     &          3,          0,          0,         -2, &
     &          0,          8,          0,          0, &
     &          3,         10,          4,         -1, &
     &          3,          0,          0,         -1, &
     &          0,         -7,         -3,          0, &
     &          0,         -4,         -2,          0, &
     &          6,         19,          0,          0, &
     &          5,       -173,        -75,         -2, &
     &          0,         -7,         -3,          0, &
     &          7,        -12,         -5,         -3 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=511,520 ) / &
     &         -3,          0,          0,          2, &
     &          3,         -4,         -2,         -1, &
     &         74,          0,          0,        -32, &
     &         -3,         12,          6,          2, &
     &         26,        -14,         -6,        -11, &
     &         19,          0,          0,         -8, &
     &          6,         24,         13,         -3, &
     &         83,          0,          0,          0, &
     &          0,        -10,         -5,          0, &
     &         11,         -3,         -1,         -5 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=521,530 ) / &
     &          3,          0,          1,         -1, &
     &          3,          0,          0,         -1, &
     &         -4,          0,          0,          0, &
     &          5,        -23,        -12,         -3, &
     &       -339,          0,          0,        147, &
     &          0,        -10,         -5,          0, &
     &          5,          0,          0,          0, &
     &          3,          0,          0,         -1, &
     &          0,         -4,         -2,          0, &
     &         18,         -3,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=531,540 ) / &
!
     &          9,        -11,         -5,         -4, &
     &         -8,          0,          0,          4, &
     &          3,          0,          0,         -1, &
     &          0,          9,          0,          0, &
     &          6,         -9,         -4,         -2, &
     &         -4,        -12,          0,          0, &
     &         67,        -91,        -39,        -29, &
     &         30,        -18,         -8,        -13, &
     &          0,          0,          0,          0, &
     &          0,       -114,        -50,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=541,550 ) / &
     &          0,          0,          0,         23, &
     &        517,         16,          7,       -224, &
     &          0,         -7,         -3,          0, &
     &        143,         -3,         -1,        -62, &
     &         29,          0,          0,        -13, &
     &         -4,          0,          0,          2, &
     &         -6,          0,          0,          3, &
     &          5,         12,          5,         -2, &
     &        -25,          0,          0,         11, &
     &         -3,          0,          0,          1 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=551,560 ) / &
     &          0,          4,          2,          0, &
     &        -22,         12,          5,         10, &
     &         50,          0,          0,        -22, &
     &          0,          7,          4,          0, &
     &          0,          3,          1,          0, &
     &         -4,          4,          2,          2, &
     &         -5,        -11,         -5,          2, &
     &          0,          4,          2,          0, &
     &          4,         17,          9,         -2, &
     &         59,          0,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=561,570 ) / &
     &          0,         -4,         -2,          0, &
     &         -8,          0,          0,          4, &
     &         -3,          0,          0,          0, &
     &          4,        -15,         -8,         -2, &
     &        370,         -8,          0,       -160, &
     &          0,          0,         -3,          0, &
     &          0,          3,          1,          0, &
     &         -6,          3,          1,          3, &
     &          0,          6,          0,          0, &
     &        -10,          0,          0,          4 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=571,580 ) / &
     &          0,          9,          4,          0, &
     &          4,         17,          7,         -2, &
     &         34,          0,          0,        -15, &
     &          0,          5,          3,          0, &
     &         -5,          0,          0,          2, &
     &        -37,         -7,         -3,         16, &
     &          3,         13,          7,         -2, &
     &         40,          0,          0,          0, &
     &          0,         -3,         -2,          0, &
     &       -184,         -3,         -1,         80 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=581,590 ) / &
     &         -3,          0,          0,          1, &
     &         -3,          0,          0,          0, &
     &          0,        -10,         -6,         -1, &
     &         31,         -6,          0,        -13, &
     &         -3,        -32,        -14,          1, &
     &         -7,          0,          0,          3, &
     &          0,         -8,         -4,          0, &
     &          3,         -4,          0,          0, &
     &          0,          4,          0,          0, &
     &          0,          3,          1,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=591,600 ) / &
     &         19,        -23,        -10,          2, &
     &          0,          0,          0,        -10, &
     &          0,          3,          2,          0, &
     &          0,          9,          5,         -1, &
     &         28,          0,          0,          0, &
     &          0,         -7,         -4,          0, &
     &          8,         -4,          0,         -4, &
     &          0,          0,         -2,          0, &
     &          0,          3,          0,          0, &
     &         -3,          0,          0,          1 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=601,610 ) / &
     &         -9,          0,          1,          4, &
     &          3,         12,          5,         -1, &
     &         17,         -3,         -1,          0, &
     &          0,          7,          4,          0, &
     &         19,          0,          0,          0, &
     &          0,         -5,         -3,          0, &
     &         14,         -3,          0,         -1, &
     &          0,          0,         -1,          0, &
     &          0,          0,          0,         -5, &
     &          0,          5,          3,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=611,620 ) / &
     &         13,          0,          0,          0, &
     &          0,         -3,         -2,          0, &
     &          2,          9,          4,          3, &
     &          0,          0,          0,         -4, &
     &          8,          0,          0,          0, &
     &          0,          4,          2,          0, &
     &          6,          0,          0,         -3, &
     &          6,          0,          0,          0, &
     &          0,          3,          1,          0, &
     &          5,          0,          0,         -2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=621,630 ) / &
     &          3,          0,          0,         -1, &
     &         -3,          0,          0,          0, &
     &          6,          0,          0,          0, &
     &          7,          0,          0,          0, &
     &         -4,          0,          0,          0, &
     &          4,          0,          0,          0, &
     &          6,          0,          0,          0, &
     &          0,         -4,          0,          0, &
     &          0,         -4,          0,          0, &
     &          5,          0,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=631,640 ) / &
     &         -3,          0,          0,          0, &
     &          4,          0,          0,          0, &
     &         -5,          0,          0,          0, &
     &          4,          0,          0,          0, &
     &          0,          3,          0,          0, &
     &         13,          0,          0,          0, &
     &         21,         11,          0,          0, &
     &          0,         -5,          0,          0, &
     &          0,         -5,         -2,          0, &
     &          0,          5,          3,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=641,650 ) / &
     &          0,         -5,          0,          0, &
     &         -3,          0,          0,          2, &
     &         20,         10,          0,          0, &
     &        -34,          0,          0,          0, &
     &        -19,          0,          0,          0, &
     &          3,          0,          0,         -2, &
     &         -3,          0,          0,          1, &
     &         -6,          0,          0,          3, &
     &         -4,          0,          0,          0, &
     &          3,          0,          0,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=651,660 ) / &
     &          3,          0,          0,          0, &
     &          4,          0,          0,          0, &
     &          3,          0,          0,         -1, &
     &          6,          0,          0,         -3, &
     &         -8,          0,          0,          3, &
     &          0,          3,          1,          0, &
     &         -3,          0,          0,          0, &
     &          0,         -3,         -2,          0, &
     &        126,        -63,        -27,        -55, &
     &         -5,          0,          1,          2 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=661,670 ) / &
     &         -3,         28,         15,          2, &
     &          5,          0,          1,         -2, &
     &          0,          9,          4,          1, &
     &          0,          9,          4,         -1, &
     &       -126,        -63,        -27,         55, &
     &          3,          0,          0,         -1, &
     &         21,        -11,         -6,        -11, &
     &          0,         -4,          0,          0, &
     &        -21,        -11,         -6,         11, &
     &         -3,          0,          0,          1 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=671,680 ) / &
     &          0,          3,          1,          0, &
     &          8,          0,          0,         -4, &
     &         -6,          0,          0,          3, &
     &         -3,          0,          0,          1, &
     &          3,          0,          0,         -1, &
     &         -3,          0,          0,          1, &
     &         -5,          0,          0,          2, &
     &         24,        -12,         -5,        -11, &
     &          0,          3,          1,          0, &
     &          0,          3,          1,          0 /
      DATA ( ( ICPL(I,J), I=1,4 ), J=681,687 ) / &
     &          0,          3,          2,          0, &
     &        -24,        -12,         -5,         10, &
     &          4,          0,         -1,         -2, &
     &         13,          0,          0,         -6, &
     &          7,          0,          0,         -3, &
     &          3,          0,          0,         -1, &
     &          3,          0,          0,         -1 /
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!  Interval between fundamental epoch J2000.0 and given date (JC).
!     T = ( ( DATE1-DJ0 ) + DATE2 ) / DJC
      T = CENT
!
!  -------------------
!  LUNI-SOLAR NUTATION
!  -------------------
!
!  Fundamental (Delaunay) arguments from Simon et al. (1994)
!
!  Mean anomaly of the Moon.
!     EL  = MOD (         485868.249036D0 +
!    :            T*( 1717915923.2178D0 +
!    :            T*(         31.8792D0 +
!    :            T*(          0.051635D0 +
!    :            T*(        - 0.00024470D0 )))), TURNAS ) * DAS2R
!
!  Mean anomaly of the Sun.
!!!  ELP Differs slightly from FA2K(2)
      ELP = MOD (        1287104.79305D0 + &
     &            T*(  129596581.0481D0 + &
     &            T*(        - 0.5532D0 + &
     &            T*(          0.000136D0 + &
     &            T*(        - 0.00001149D0 )))), TURNAS ) * DAS2R
!!!  DELP equals FAD2K(2)
!     DELP   =  (    129596581.0481D0 +
!    :         -2.D0*0.5532D0*T + 3.D0*0.000136D0*T**2 +
!    :         -4.D0*0.00001149D0*T**3) * DCENT * DAS2R
!     DELP   = DELP/(36525.D0*86400.D0)
!        print *,' NU2KA/ELP,DELP: ', ELP,DELP
!
!  Mean argument of the latitude of the Moon.
!     F   = MOD (         335779.526232D0 +
!    :            T*( 1739527262.8478D0 +
!    :            T*(       - 12.7512D0 +
!    :            T*(       -  0.001037D0 +
!    :            T*(          0.00000417D0 )))), TURNAS ) * DAS2R
!
!  Mean elongation of the Moon from the Sun.
!     D   = MOD (        1072260.70369D0 +
!    :            T*( 1602961601.2090D0 +
!    :            T*(        - 6.3706D0 +
!    :            T*(          0.006593D0 +
!    :            T*(        - 0.00003169D0 )))), TURNAS ) * DAS2R
!
!  Mean longitude of the ascending node of the Moon.
!     OM  = MOD (         450160.398036D0 +
!    :            T*(  - 6962890.5431D0 +
!    :            T*(          7.4722D0 +
!    :            T*(          0.007702D0 +
!    :            T*(        - 0.00005939D0 )))), TURNAS ) * DAS2R
!
!
!
!  Initialize the nutation values.
!     DP = 0D0
!     DE = 0D0
!
!  Summation of luni-solar nutation series (in reverse order).
!     DO 100 I = NLS, 1, -1
!
!     Argument and functions.
!        ARG = MOD ( DBLE ( NALS(1,I) ) * EL  +
!    :               DBLE ( NALS(2,I) ) * ELP +
!    :               DBLE ( NALS(3,I) ) * F   +
!    :               DBLE ( NALS(4,I) ) * D   +
!    :               DBLE ( NALS(5,I) ) * OM, D2PI )
!        SARG = SIN(ARG)
!        CARG = COS(ARG)
!
!     Term.
!        DP = DP + ( CLS(1,I) + CLS(2,I) * T ) * SARG
!    :           +   CLS(3,I)                  * CARG
!        DE = DE + ( CLS(4,I) + CLS(5,I) * T ) * CARG
!    :           +   CLS(6,I)                  * SARG
!
!100  CONTINUE
!$$    print *,'NU200A: DP,DE #1 ', DP,DE
!  Summation of luni-solar nutation series (in reverse order).
        DP = 0D0
        DE = 0D0
        dDP = 0D0
        dDE = 0D0
      DO 101 I = NLS, 1, -1
!
!     Argument and functions.
         ARG = MOD ( DBLE ( NALS(1,I) ) * FA2K(1) + &
     &               DBLE ( NALS(2,I) ) * ELP     + &
     &               DBLE ( NALS(3,I) ) * FA2K(3) + &
     &               DBLE ( NALS(4,I) ) * FA2K(4) + &
     &               DBLE ( NALS(5,I) ) * FA2K(5), D2PI )
        dARG =     ( DBLE ( NALS(1,I) ) * FAD2K(1) + &
     &               DBLE ( NALS(2,I) ) * FAD2K(2) + &
     &               DBLE ( NALS(3,I) ) * FAD2K(3) + &
     &               DBLE ( NALS(4,I) ) * FAD2K(4) + &
     &               DBLE ( NALS(5,I) ) * FAD2K(5) )
         SARG = SIN(ARG)
         CARG = COS(ARG)
         dSARG =  COS(ARG)*dARG
         dCARG = -SIN(ARG)*dARG
!
!     Term.
         DP = DP + ( CLS(1,I) + CLS(2,I) * T ) * SARG &
     &           +   CLS(3,I)                  * CARG
         DE = DE + ( CLS(4,I) + CLS(5,I) * T ) * CARG &
     &           +   CLS(6,I)                  * SARG
!
         dDP = dDP + CLS(1,I)*dSARG + CLS(2,I)*DCENT*SARG + &
     &         CLS(2,I)*T*dSARG + CLS(3,I)*dCARG
         dDE = dDE + CLS(4,I)*dCARG + CLS(5,I)*DCENT*CARG + &
     &         CLS(5,I)*T*dCARG + CLS(6,I)*dSARG
!
 101  CONTINUE
!
!  Convert from 0.1 microarcsec units to radians.
      DPSILS = DP * U2R
      DEPSLS = DE * U2R
      dDPSILS = dDP * U2R
      dDEPSLS = dDE * U2R
!
!
!  PLANETARY NUTATION
!    [Less accurate computations than FA2K(1-5)]
!
!  Mean anomaly of the Moon.
      AL   = MOD ( 2.35555598D0 + 8328.6914269554D0 * T, D2PI )
      dAL  = 8328.6914269554D0 * DCENT
!
!  Mean anomaly of the Sun.
      ALSU = MOD ( 6.24006013D0 + 628.301955D0 * T, D2PI )
      dALSU = 628.301955D0 * DCENT
!
!  Mean argument of the latitude of the Moon.
      AF  = MOD ( 1.627905234D0 + 8433.466158131D0 * T, D2PI )
      dAF = 8433.466158131D0 * DCENT
!
!  Mean elongation of the Moon from the Sun.
      AD  = MOD ( 5.198466741D0 + 7771.3771468121D0 * T, D2PI )
      dAD = 7771.3771468121D0 * DCENT
!
!  Mean longitude of the ascending node of the Moon.
      AOM  = MOD ( 2.18243920D0 - 33.757045D0 * T, D2PI )
      dAOM = -33.757045D0 * DCENT
!
!  General accumulated precession in longitude.
      APA  = ( 0.02438175D0 + 0.00000538691D0 * T ) * T
      dAPA  = 0.02438175D0*DCENT + 2.D0*0.00000538691D0*T*DCENT
!
!  Planetary longitudes, Mercury through Neptune (Souchay et al. 1999).
      ALME = MOD ( 4.402608842D0 + 2608.7903141574D0 * T, D2PI )
      ALVE = MOD ( 3.176146697D0 + 1021.3285546211D0 * T, D2PI )
      ALEA = MOD ( 1.753470314D0 +  628.3075849991D0 * T, D2PI )
      ALMA = MOD ( 6.203480913D0 +  334.0612426700D0 * T, D2PI )
      ALJU = MOD ( 0.599546497D0 +   52.9690962641D0 * T, D2PI )
      ALSA = MOD ( 0.874016757D0 +   21.3299104960D0 * T, D2PI )
! Uranus and Neptune longitudes differ slightly from IERS Standards (2003)
      ALUR = MOD ( 5.481293871D0 +    7.4781598567D0 * T, D2PI )
      ALNE = MOD ( 5.321159000D0 +    3.8127774000D0 * T, D2PI )
!
!     DALUR     = 7.4781598567D0 * DCENT
      DALNE     = 3.812777400D0 * DCENT
!
!     Write (6,780) ALME,ALVE,ALEA,ALMA,ALJU,ALSA,ALUR,ALNE
!780  Format(' NU2000A: ALME,ALVE,ALEA,ALMA,ALJU,ALSA,ALUR,ALNE:',
!    *        /,2(5E22.15,/))
!        print *,' NU2KA/DALNE: ', DALNE
!
!  Initialize the nutation values.
      DP = 0D0
      DE = 0D0
!
!  Summation of planetary nutation series (in reverse order).
!     DO 200 I = NPL, 1, -1
!
!     Argument and functions.
!        ARG = MOD ( DBLE ( NAPL( 1,I) ) * AL   +
!    :               DBLE ( NAPL( 2,I) ) * ALSU +
!    :               DBLE ( NAPL( 3,I) ) * AF   +
!    :               DBLE ( NAPL( 4,I) ) * AD   +
!    :               DBLE ( NAPL( 5,I) ) * AOM  +
!    :               DBLE ( NAPL( 6,I) ) * ALME +
!    :               DBLE ( NAPL( 7,I) ) * ALVE +
!    :               DBLE ( NAPL( 8,I) ) * ALEA +
!    :               DBLE ( NAPL( 9,I) ) * ALMA +
!    :               DBLE ( NAPL(10,I) ) * ALJU +
!    :               DBLE ( NAPL(11,I) ) * ALSA +
!    :               DBLE ( NAPL(12,I) ) * ALUR +
!    :               DBLE ( NAPL(13,I) ) * ALNE +
!    :               DBLE ( NAPL(14,I) ) * APA, D2PI )
!        SARG = SIN(ARG)
!        CARG = COS(ARG)
!
!     Term.
!        DP = DP + DBLE( ICPL(1,I)) * SARG + DBLE( ICPL(2,I)) * CARG
!        DE = DE + DBLE( ICPL(3,I)) * SARG + DBLE( ICPL(4,I)) * CARG
!
!200  CONTINUE
!$$    print *,'NU200A: DP,DE #3 ', DP,DE
!
!  Summation of planetary nutation series (in reverse order).
         DP = 0.D0
         DE = 0.D0
         dDP = 0.D0
         dDE = 0.D0
      DO 201 I = NPL, 1, -1
!
!     Argument and functions.
         ARG = MOD ( DBLE ( NAPL( 1,I) ) * AL   + &
     &               DBLE ( NAPL( 2,I) ) * ALSU + &
     &               DBLE ( NAPL( 3,I) ) * AF   + &
     &               DBLE ( NAPL( 4,I) ) * AD   + &
     &               DBLE ( NAPL( 5,I) ) * AOM  + &
     &               DBLE ( NAPL( 6,I) ) * FA2K(6) + &
     &               DBLE ( NAPL( 7,I) ) * FA2K(7) + &
     &               DBLE ( NAPL( 8,I) ) * FA2K(8) + &
     &               DBLE ( NAPL( 9,I) ) * FA2K(9) + &
     &               DBLE ( NAPL(10,I) ) * FA2K(10) + &
     &               DBLE ( NAPL(11,I) ) * FA2K(11) + &
     &               DBLE ( NAPL(12,I) ) * ALUR     + &
     &               DBLE ( NAPL(13,I) ) * ALNE     + &
     &               DBLE ( NAPL(14,I) ) * APA, D2PI )
!
        dARG =     ( DBLE ( NAPL( 1,I) ) * dAL   + &
     &               DBLE ( NAPL( 2,I) ) * dALSU + &
     &               DBLE ( NAPL( 3,I) ) * dAF   + &
     &               DBLE ( NAPL( 4,I) ) * dAD   + &
     &               DBLE ( NAPL( 5,I) ) * dAOM  + &
     &               DBLE ( NAPL( 6,I) ) * FAD2K(6) + &
     &               DBLE ( NAPL( 7,I) ) * FAD2K(7) + &
     &               DBLE ( NAPL( 8,I) ) * FAD2K(8) + &
     &               DBLE ( NAPL( 9,I) ) * FAD2K(9) + &
     &               DBLE ( NAPL(10,I) ) * FAD2K(10) + &
     &               DBLE ( NAPL(11,I) ) * FAD2K(11) + &
     &               DBLE ( NAPL(12,I) ) * FAD2K(12) + &
     &               DBLE ( NAPL(13,I) ) * DALNE     + &
     &               DBLE ( NAPL(14,I) ) * dAPA )
!
         SARG = SIN(ARG)
         CARG = COS(ARG)
         dSARG =  COS(ARG)*dARG
         dCARG = -SIN(ARG)*dARG
!
!     Term.
         DP = DP + DBLE( ICPL(1,I)) * SARG + DBLE( ICPL(2,I)) * CARG
         DE = DE + DBLE( ICPL(3,I)) * SARG + DBLE( ICPL(4,I)) * CARG
        dDP = dDP + DBLE(ICPL(1,I)) * dSARG + DBLE(ICPL(2,I)) * dCARG
        dDE = dDE + DBLE(ICPL(3,I)) * dSARG + DBLE(ICPL(4,I)) * dCARG
!
 201  CONTINUE
!
!  Convert from 0.1 microarcsec units to radians.
      DPSIPL = DP * U2R
      DEPSPL = DE * U2R
      dDPSIPL = dDP * U2R
      dDEPSPL = dDE * U2R
!
!
!  TOTAL
!
!  Add planetary and luni-solar components.
      DPSI(1) = DPSIPL + DPSILS
      DEPS(1) = DEPSPL + DEPSLS
      DPSI(2) = dDPSIPL + dDPSILS
      DEPS(2) = dDEPSPL + dDEPSLS
!
      Return
      END
!************************************************************************
!  Copyright (C) 2001
!  Standards Of Fundamental Astronomy Review Board
!  of the International Astronomical Union.
!
!  This routine is part of the International Astronomical Union's
!  SOFA (Standards of Fundamental Astronomy) software collection.
!  =====================
!  SOFA Software License
!  =====================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING TERMS AND CONDITIONS
!  WHICH APPLY TO ITS USE.
!
!  1. The Software is owned by the IAU SOFA Review Board ("the Board").
!
!  2. The Software is made available free of charge for use by:
!
!     a) private individuals for non-profit research; and
!
!     b) non-profit educational, academic and research institutions.
!
!  3. Commercial use of the Software is specifically excluded from the
!     terms and conditions of this license.  Commercial use of the
!     Software is subject to the prior written agreement of the Board on
!     terms to be agreed.
!
!  4. The provision of any version of the Software under the terms and
!     conditions specified herein does not imply that future versions
!     will also be made available under the same terms and conditions.
!
!  5. The user may modify the Software for his/her own purposes.  The
!     user may distribute the modified software provided that the Board
!     is informed and that a copy of the modified software is made
!     available to the Board on request.  All modifications made by the
!     user shall be clearly identified to show how the modified software
!     differs from the original Software, and the name(s) of the
!     affected routine(s) shall be changed.  The original SOFA Software
!     License text must be present.
!
!  6. In any published work produced by the user and which includes
!     results achieved by using the Software, the user shall acknowledge
!     that the Software was used in producing the information contained
!     in such publication.
!
!  7. The user may incorporate or embed the Software into other software
!     products which he/she may then give away free of charge but not
!     sell provided the user makes due acknowledgement of the use which
!     he/she has made of the Software in creating such software
!     products.  Any redistribution of the Software in this way shall be
!     made under the same terms and conditions under which the user
!     received it from the SOFA Center.
!
!  8. The user shall not cause the Software to be brought into
!     disrepute, either by misuse, or use for inappropriate tasks, or by
!     inappropriate modification.
!
!  9. The Software is provided to the user "as is" and the Board makes
!     no warranty as to its use or performance.   The Board does not and
!     cannot warrant the performance or results which the user may
!     obtain by using the Software.  The Board makes no warranties,
!     express or implied, as to non-infringement of third party rights,
!     merchantability, or fitness for any particular purpose.  In no
!     event will the Board be liable to the user for any consequential,
!     incidental, or special damages, including any lost profits or lost
!     savings, even if a Board representative has been advised of such
!     damages, or for any claim by any third party.
!
!  Correspondence concerning SOFA software should be addressed as
!  follows:
!
!     Internet email: sofa@rl.ac.uk
!     Postal address: IAU SOFA Center
!                     Rutherford Appleton Laboratory
!                     Chilton, Didcot, Oxon OX11 0QX
!                     United Kingdom
!
!***********************************************************************
      BLOCK DATA NUTCMB
      IMPLICIT None
!
! 7.    NUTBD
!
! 7.1   NUTBD PROGRAM SPECIFICATION
!
! 7.1.1 NUTBD IS THE NUTATION MODULE BLOCK DATA INITIALIZATION SECTION.
!       THE NUTATION SERIES IS ESTABLISHED HERE. THIS VERSION CONTAINS
!       THE 1980 IAU THEORY OF NUTATION, FROM THE WORK OF J. M. WAHR,
!       SPECIFICALLY, THE WAHR NUTATION SERIES FOR AXIS B OF GILBERT &
!       DZIEWONSKI EARTH MODEL 1066A.
!
! 7.1.3 REFERENCES - 1) 'THE EXPLANATORY SUPPLEMENT TO THE AMERICAN
!                    EPHEMERIS AND NAUTICAL ALMANAC", P. 41-45, 98
!
!                    2) LIESKE, J.H., ET AL., EXPRESSIONS FOR THE
!                    PRECESSIONAL QUANTITIES BASED ON THE IAU (1976)
!                    SYSTEM OF ASTRONOMICAL CONSTANTS,
!                    ASTRON. ASTROPHYS. 58, 1-16, 1977.
!
!                    3) SEIDELMANN, P. K., 1980 IAU THEORY OF NUTATION:
!                    THE FINAL REPORT OF THE IAU WORKING GROUP ON
!                    NUTATION, CELEST. MECH. 27, PP. 79-106 (1982).
!
!                    4) WAHR, J. M., THE FORCED NUTATIONS OF ... EARTH,
!                    GEOPHYS. J. ROY. ASTR. SOC. 64, PP. 705-727 (1981).
!
! 7.2   NUTBD PROGRAM INTERFACE
!
! 7.2.1 CALLING SEQUENCE - NONE
!
! 7.2.2 COMMON BLOCK -
!
      REAL*8 X(9,120)
      COMMON / XWAHR / X
!
!!!!  Real*8 CENTJ, DJ2000, EC(4), ARGP(2,6)
      Real*8                EC(4)
!!!   Integer*4 NOT, NOP, IDP(6)
      Integer*4 NOT
!!!!  COMMON / NUTCM / CENTJ, DJ2000, EC, ARGP, NOT, NOP, IDP
      COMMON / NUTCMW /                EC,       NOT
!           VARIABLES 'TO':
!!!!           1. CENTJ   - THE NUMBER OF COORDINATE TIME DAYS PER JULIAN
!!!!                        CENTURY. (DAYS/CENTURY) (CENTJ = 36525.D0)
!!!!           2. DJ2000  - THE JULIAN DATE OF THE EPOCH JANUARY 1.5, 2000.
!!!!                        (DAYS) (DJ2000 = 2451545.D0)
!              3. EC(4)   - THE CONSTANTS APPEARING IN TERMS 1-4 IN THE
!                           CALCULATION OF THE MEAN OBLIQUITY OF THE ECLIPTIC.
!                           (ARCSEC) (SEE REFERENCES)
!                           ( EC(1) = +8.4381448D4, EC(2) = -46.815D0,
!                             EC(3) = -5.9D-4, EC(4) = +1.813D-3 )
!              4. NOT     - THE NUMBER OF TERMS IN THE NUTATION SERIES.
!                           (NOT = 106)
!              5. X(9,120)- THE ARRAY CONTAINING THE NUTATION SERIES.
!                           (X = 1980 IAU THEORY OF NUTATION)
!!!!           6. NOP     - THE NUMBER OF NUTATION TERMS DESIGNATED FOR WHICH
!!!!                        PARTIALS ARE TO BE COMPUTED. (NOP = 6)
!                                  (Obsolete?)
!!!!           7. IDP(6)  - IDENTIFICATION NUMBERS (TERM NUMBERS) OF DESIGNATED
!!!!                        NUTATION TERMS FOR WHICH PARTIALS ARE TO BE COMPUTED
!!!!                        ( IDP(1) =  1, IDP(2) =  2, IDP(3) =  3,
!!!!                          IDP(4) =  4, IDP(5) =  5, IDP(6) =  7 )
!!!!           8. ARGP(2,6)-ARGUMENTS (COMBINATIONS OF FUNDAMENTAL ARGUMENTS)
!!!!                        AND THEIR DERIVATIVES OF DESIGNATED NUTATION TERMS
!!!!                        FOR WHICH PARTIALS ARE TO BE COMPUTED.
!!!!                        (COMPUTED IN NUTW. SET TO 0.0D0 HERE)
!!!!                               (Obsolete?)
!
! 7.2.3 PROGRAM SPECIFICATIONS -
      Real*8  X1(180), X2(180), X3(180), X4(180), X5(180), X6(180)
      EQUIVALENCE (X(1,  1),X1(1))
      EQUIVALENCE (X(1, 21),X2(1))
      EQUIVALENCE (X(1, 41),X3(1))
      EQUIVALENCE (X(1, 61),X4(1))
      EQUIVALENCE (X(1, 81),X5(1))
      EQUIVALENCE (X(1,101),X6(1))
!
!!!   DATA  CENTJ  / 36525.D0 /, &
!!!  &      DJ2000 / 2451545.D0 /, &
      DATA  EC     / 8.4381448D4, -46.8150D0, -5.9D-4, 1.813D-3 /, &
     &      NOT    / 106 /
!!!  &      NOT    / 106 /, &
!!!  &      NOP    / 6 /, &
!!!  &      IDP    / 1, 2, 3, 4, 5, 7 /, &
!!!  &      ARGP   / 12 * 0.0D0 /
!***********************************************************************
!
!               1980 IAU THEORY OF NUTATION (WAHR THEORY)
!           TABLE OF MULTIPLES OF ARGUMENTS AND COEFFICIENTS
!
!                   MULTIPLE OF            LONGITUDE        OBLIQUITY
!              L    L'   F    D  OMEGA   COEFF. OF SIN    COEFF. OF COS
      DATA X1/ 0.,  0.,  0.,  0.,  1., -171996., -174.2,  92025.,  8.9, &
     &         0.,  0.,  2., -2.,  2.,  -13187.,   -1.6,   5736., -3.1, &
     &         0.,  0.,  2.,  0.,  2.,   -2274.,   -0.2,    977., -0.5, &
     &         0.,  0.,  0.,  0.,  2.,    2062.,    0.2,   -895.,  0.5, &
     &         0.,  1.,  0.,  0.,  0.,    1426.,   -3.4,     54., -0.1, &
     &         1.,  0.,  0.,  0.,  0.,     712.,    0.1,     -7.,  0.0, &
     &         0.,  1.,  2., -2.,  2.,    -517.,    1.2,    224., -0.6, &
     &         0.,  0.,  2.,  0.,  1.,    -386.,   -0.4,    200.,  0.0, &
     &         1.,  0.,  2.,  0.,  2.,    -301.,    0.0,    129., -0.1, &
     &         0., -1.,  2., -2.,  2.,     217.,   -0.5,    -95.,  0.3, &
     &         1.,  0.,  0., -2.,  0.,    -158.,    0.0,     -1.,  0.0, &
     &         0.,  0.,  2., -2.,  1.,     129.,    0.1,    -70.,  0.0, &
     &        -1.,  0.,  2.,  0.,  2.,     123.,    0.0,    -53.,  0.0, &
     &         1.,  0.,  0.,  0.,  1.,      63.,    0.1,    -33.,  0.0, &
     &         0.,  0.,  0.,  2.,  0.,      63.,    0.0,     -2.,  0.0, &
     &        -1.,  0.,  2.,  2.,  2.,     -59.,    0.0,     26.,  0.0, &
     &        -1.,  0.,  0.,  0.,  1.,     -58.,   -0.1,     32.,  0.0, &
     &         1.,  0.,  2.,  0.,  1.,     -51.,    0.0,     27.,  0.0, &
     &         2.,  0.,  0., -2.,  0.,      48.,    0.0,      1.,  0.0, &
     &        -2.,  0.,  2.,  0.,  1.,      46.,    0.0,    -24.,  0.0/
      DATA X2/ 0.,  0.,  2.,  2.,  2.,     -38.,    0.0,     16.,  0.0, &
     &         2.,  0.,  2.,  0.,  2.,     -31.,    0.0,     13.,  0.0, &
     &         2.,  0.,  0.,  0.,  0.,      29.,    0.0,     -1.,  0.0, &
     &         1.,  0.,  2., -2.,  2.,      29.,    0.0,    -12.,  0.0, &
     &         0.,  0.,  2.,  0.,  0.,      26.,    0.0,     -1.,  0.0, &
     &         0.,  0.,  2., -2.,  0.,     -22.,    0.0,      0.,  0.0, &
     &        -1.,  0.,  2.,  0.,  1.,      21.,    0.0,    -10.,  0.0, &
     &         0.,  2.,  0.,  0.,  0.,      17.,   -0.1,      0.,  0.0, &
     &         0.,  2.,  2., -2.,  2.,     -16.,    0.1,      7.,  0.0, &
     &        -1.,  0.,  0.,  2.,  1.,      16.,    0.0,     -8.,  0.0, &
     &         0.,  1.,  0.,  0.,  1.,     -15.,    0.0,      9.,  0.0, &
     &         1.,  0.,  0., -2.,  1.,     -13.,    0.0,      7.,  0.0, &
     &         0., -1.,  0.,  0.,  1.,     -12.,    0.0,      6.,  0.0, &
     &         2.,  0., -2.,  0.,  0.,      11.,    0.0,      0.,  0.0, &
     &        -1.,  0.,  2.,  2.,  1.,     -10.,    0.0,      5.,  0.0, &
     &         1.,  0.,  2.,  2.,  2.,      -8.,    0.0,      3.,  0.0, &
     &         0., -1.,  2.,  0.,  2.,      -7.,    0.0,      3.,  0.0, &
     &         0.,  0.,  2.,  2.,  1.,      -7.,    0.0,      3.,  0.0, &
     &         1.,  1.,  0., -2.,  0.,      -7.,    0.0,      0.,  0.0, &
     &         0.,  1.,  2.,  0.,  2.,       7.,    0.0,     -3.,  0.0/
      DATA X3/-2.,  0.,  0.,  2.,  1.,      -6.,    0.0,      3.,  0.0, &
     &         0.,  0.,  0.,  2.,  1.,      -6.,    0.0,      3.,  0.0, &
     &         2.,  0.,  2., -2.,  2.,       6.,    0.0,     -3.,  0.0, &
     &         1.,  0.,  0.,  2.,  0.,       6.,    0.0,      0.,  0.0, &
     &         1.,  0.,  2., -2.,  1.,       6.,    0.0,     -3.,  0.0, &
     &         0.,  0.,  0., -2.,  1.,      -5.,    0.0,      3.,  0.0, &
     &         0., -1.,  2., -2.,  1.,      -5.,    0.0,      3.,  0.0, &
     &         2.,  0.,  2.,  0.,  1.,      -5.,    0.0,      3.,  0.0, &
     &         1., -1.,  0.,  0.,  0.,       5.,    0.0,      0.,  0.0, &
     &         1.,  0.,  0., -1.,  0.,      -4.,    0.0,      0.,  0.0, &
     &         0.,  0.,  0.,  1.,  0.,      -4.,    0.0,      0.,  0.0, &
     &         0.,  1.,  0., -2.,  0.,      -4.,    0.0,      0.,  0.0, &
     &         1.,  0., -2.,  0.,  0.,       4.,    0.0,      0.,  0.0, &
     &         2.,  0.,  0., -2.,  1.,       4.,    0.0,     -2.,  0.0, &
     &         0.,  1.,  2., -2.,  1.,       4.,    0.0,     -2.,  0.0, &
     &         1.,  1.,  0.,  0.,  0.,      -3.,    0.0,      0.,  0.0, &
     &         1., -1.,  0., -1.,  0.,      -3.,    0.0,      0.,  0.0, &
     &        -1., -1.,  2.,  2.,  2.,      -3.,    0.0,      1.,  0.0, &
     &         0., -1.,  2.,  2.,  2.,      -3.,    0.0,      1.,  0.0, &
     &         1., -1.,  2.,  0.,  2.,      -3.,    0.0,      1.,  0.0/
      DATA X4/ 3.,  0.,  2.,  0.,  2.,      -3.,    0.0,      1.,  0.0, &
     &        -2.,  0.,  2.,  0.,  2.,      -3.,    0.0,      1.,  0.0, &
     &         1.,  0.,  2.,  0.,  0.,       3.,    0.0,      0.,  0.0, &
     &        -1.,  0.,  2.,  4.,  2.,      -2.,    0.0,      1.,  0.0, &
     &         1.,  0.,  0.,  0.,  2.,      -2.,    0.0,      1.,  0.0, &
     &        -1.,  0.,  2., -2.,  1.,      -2.,    0.0,      1.,  0.0, &
     &         0., -2.,  2., -2.,  1.,      -2.,    0.0,      1.,  0.0, &
     &        -2.,  0.,  0.,  0.,  1.,      -2.,    0.0,      1.,  0.0, &
     &         2.,  0.,  0.,  0.,  1.,       2.,    0.0,     -1.,  0.0, &
     &         3.,  0.,  0.,  0.,  0.,       2.,    0.0,      0.,  0.0, &
     &         1.,  1.,  2.,  0.,  2.,       2.,    0.0,     -1.,  0.0, &
     &         0.,  0.,  2.,  1.,  2.,       2.,    0.0,     -1.,  0.0, &
     &         1.,  0.,  0.,  2.,  1.,      -1.,    0.0,      0.,  0.0, &
     &         1.,  0.,  2.,  2.,  1.,      -1.,    0.0,      1.,  0.0, &
     &         1.,  1.,  0., -2.,  1.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  1.,  0.,  2.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  1.,  2., -2.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  1., -2.,  2.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         1.,  0., -2.,  2.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         1.,  0., -2., -2.,  0.,      -1.,    0.0,      0.,  0.0/
      DATA X5/ 1.,  0.,  2., -2.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         1.,  0.,  0., -4.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         2.,  0.,  0., -4.,  0.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  0.,  2.,  4.,  2.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  0.,  2., -1.,  2.,      -1.,    0.0,      0.,  0.0, &
     &        -2.,  0.,  2.,  4.,  2.,      -1.,    0.0,      1.,  0.0, &
     &         2.,  0.,  2.,  2.,  2.,      -1.,    0.0,      0.,  0.0, &
     &         0., -1.,  2.,  0.,  1.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  0., -2.,  0.,  1.,      -1.,    0.0,      0.,  0.0, &
     &         0.,  0.,  4., -2.,  2.,       1.,    0.0,      0.,  0.0, &
     &         0.,  1.,  0.,  0.,  2.,       1.,    0.0,      0.,  0.0, &
     &         1.,  1.,  2., -2.,  2.,       1.,    0.0,     -1.,  0.0, &
     &         3.,  0.,  2., -2.,  2.,       1.,    0.0,      0.,  0.0, &
     &        -2.,  0.,  2.,  2.,  2.,       1.,    0.0,     -1.,  0.0, &
     &        -1.,  0.,  0.,  0.,  2.,       1.,    0.0,     -1.,  0.0, &
     &         0.,  0., -2.,  2.,  1.,       1.,    0.0,      0.,  0.0, &
     &         0.,  1.,  2.,  0.,  1.,       1.,    0.0,      0.,  0.0, &
     &        -1.,  0.,  4.,  0.,  2.,       1.,    0.0,      0.,  0.0, &
     &         2.,  1.,  0., -2.,  0.,       1.,    0.0,      0.,  0.0, &
     &         2.,  0.,  0.,  2.,  0.,       1.,    0.0,      0.,  0.0/
      DATA X6/ 2.,  0.,  2., -2.,  1.,       1.,    0.0,     -1.,  0.0, &
     &         2.,  0., -2.,  0.,  1.,       1.,    0.0,      0.,  0.0, &
     &         1., -1.,  0., -2.,  0.,       1.,    0.0,      0.,  0.0, &
     &        -1.,  0.,  0.,  1.,  1.,       1.,    0.0,      0.,  0.0, &
     &        -1., -1.,  0.,  2.,  1.,       1.,    0.0,      0.,  0.0, &
     &         0.,  1.,  0.,  1.,  0.,       1.,    0.0,      0.,  0.0, &
     &                      126 *  0./
!
!***********************************************************************
!
! 7.2.4 CONSTANTS USED - CENTJ, DJ2000, EC(4), NOT, X(9,120),
!                    NOP, IDP(6), ARGP(2,6)
!
! 7.2.5 PROGRAMMER - DALE MARKHAM   01/13/77
!                    PETER DENATALE 07/12/77
!                    BRUCE SCHUPLER 12/22/77
!                    CHOPO MA       08/04/81
!                    GEORGE KAPLAN  04/24/84
!                    David Gordon   94.04.15 Converted to Implicit None.
!                    David Gordon   95.09.27 X(9,120) table changed from Real*4
!                                   to Real*8
!                    David Gordon   98.02.03 Removed X(9,120) from COMMON
!                                   /NUTCM/ and put it into COMMON /XWAHR/,
!                                   and removed it from most subroutines.
!
! 7.3   NUTBD PROGRAM STRUCTURE - NONE
!
      END
!
!**********************************************************************
      SUBROUTINE NUTW (CENT, DPSI, DEPS)
      IMPLICIT None
!
! 1.    NUTW
!
! 1.1   NUTW PROGRAM SPECIFICATION
!
! 1.1.1 THIS SUBROUTINE EVALUATES THE NUTATION SERIES AND RETURNS THE
!       VALUES FOR NUTATION IN LONGITUDE AND NUTATION IN OBLIQUITY.
!       The fundamental arguments and derivatives are calculated
!       in NUTFA to be called prior to NUTW.
!
! 1.1.2 RESTRICTIONS - NONE
!
! 1.1.3 REFERENCES - 1) KAPLAN, G. H. (ED.), THE IAU RESOLUTIONS ... ,
!                       USNO CIRCULAR NO. 163, U. S. NAVAL OBSERV'Y (1981).
!
! 1.2   NUTW PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE - CALL NUTW(CENT, fa, fad, DPSI, DEPS)
!    INPUT VARIABLES:
!      1. CENT   - The number of Julian centuries between the observation
!                  epoch and January 1.5, 2000. (centuries)
!      2. FA(5)  - Fundamental arguments. (arcseconds) (see NUTFA)
!      3. FAD(5) - The CT derivatives of the fundamental arguments. (see NUTFA)
!    OUTPUT VARIABLES:
!      1. DPSI(2) - THE NUTATION IN LONGITUDE AND ITS CT TIME DERIVATIVE
!                   (ARCSEC,ARCSEC/SEC)
!      2. DEPS(2) - THE NUTATION IN OBLIQUITY AND ITS CT TIME DERIVATIVE
!                   (ARCSEC,ARCSEC/SEC)
!
! 1.2.2 COMMON BLOCKS USED -
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!     VARIABLES 'FROM':
!       1. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS.
!       2. SECDAY - THE NUMBER OF COORDINATE TIME SECONDS PER COORDINATE
!                   TIME DAY. (SECONDS/DAY)
!
      INCLUDE 'ccon.i'
!     VARIABLES 'FROM':
!       1. KNUTD - THE NUTATION MODULE DEBUG CONTROL FLAG
!
      REAL*8 FA(5), FAD(5)
!!!!  Real*8 CENTJ, DJ2000, EC(4), ARGP(2,6)
      Real*8 CENTJ, DJ2000, EC(4)
!!!!  Integer*4 NOT, NOP, IDP(6)
      Integer*4 NOT
!!!!  COMMON / NUTCM / CENTJ, DJ2000, EC, ARGP, NOT, NOP, IDP
      COMMON / NUTCMW /                EC,       NOT
      COMMON / NUTCM / CENTJ, DJ2000
      REAL*8 X(9,120)
      COMMON / XWAHR / X
!
!     VARIABLES 'FROM':
!        1. CENTJ - THE NUMBER OF COORDINATE TIME DAYS PER JULIAN CENTURY.
!                   (DAYS/CENTURY)
!        2. NOT   - THE NUMBER OF TERMS IN THE NUTATION SERIES.
!        3. X(9,120)-ARRAY CONTAINING THE NUTATION SERIES.
!!!!     4. NOP   - THE NUMBER OF NUTATION TERMS DESIGNATED FOR WHICH
!!!!                PARTIALS ARE TO BE COMPUTED. (NOP .LE. 6)
!!!!                    (obsolete?)
!!!!     5. IDP(6)- IDENTIFICATION NUMBERS (TERM NUMBERS) OF DESIGNATED
!!!!                NUTATION TERMS FOR WHICH PARTIALS ARE TO BE COMPUTED.
!
!     VARIABLES 'TO':
!!!!     1. ARGP(2,6) - ARGUMENTS (COMBINATIONS OF FUNDAMENTAL ARGUMENTS)
!!!!                    AND THEIR DERIVATIVES OF DESIGNATED NUTATION TERMS
!!!!                    FOR WHICH PARTIALS ARE TO BE COMPUTED.
!!!!                        (obsolete?)
!
! 1.2.3 PROGRAM SPECIFICATIONS
!
      Real*8 DPSI(2),DEPS(2), CENT, SEC360, ARG, ARGDOT
      REAL*8 EL, ELP, F, D, OM, ELC(5), ELPC(5), FC(5), &
     &       DC(5), OMC(5), CENT2, CENT3
      Integer*4 I, J, N
!
!  Code added from Calc 8!!!
!     Constants used -
!       ELC(5)   - COEFFICIENTS USED IN THE CALCULATION OF EL
!       ELPC(5)  - COEFFICIENTS USED IN THE CALCULATION OF ELP
!       FC(5)    - COEFFICIENTS USED IN THE CALCULATION OF F
!       DC(5)    - COEFFICIENTS USED IN THE CALCULATION OF D
!       OMC(5)   - COEFFICIENTS USED IN THE CALCULATION OF OM
!
!       COEFFICIENTS ARE IN THE ORDER CUBIC, QUDRATIC, LINEAR, CONSTANT,
!       AND INTEGRAL NUMBER OF TURNS.
!
      DATA ELC /0.064D0,31.310D0,715922.633D0,485866.733D0,1325.0D0/
      DATA ELPC /-0.012D0,-0.577D0,1292581.224D0,1287099.804D00,99.0D0/
      DATA FC /0.011D0,-13.257D0,295263.137D0,335778.877D0,1342.0D0/
      DATA DC /0.019D0,-6.891D0,1105601.328D0,1072261.307D0,1236.0D0/
      DATA OMC /0.008D0,7.455D0,-482890.539D0,450160.280D0,-5.0D0/
!
!   SEC360 = ARCSECONDS IN ONE TURN
      DATA SEC360 / 1296000.D0 /
!
!
! 1.2.4 DATA BASE ACCESS - NONE
!
! 1.2.5 EXTERNAL INPUT/OUTPUT - POSSIBLE DEBUG
!
! 1.2.6 SUBROUTINE INTERFACE
!       CALLER SUBROUTINES - NUTG
!       CALLED SUBROUTINES - DSIN, DCOS, DMOD
!
!
! 1.2.8 PROGRAM VARIABLES
!      1. ARG    - THE COMBINATION OF FUNDAMENTAL ARGUMENTS USED
!                  TO COMPUTE THE NUTATION (RADIANS)
!      2. ARGDOT - THE DERIVATIVE OF ARG (RADIANS/CENTURY)
!
! 1.2.9 PROGRAMMER:
!          810804  CHOPO MA
!          840000  GEORGE KAPLAN
!          930901  Norbert Zacharias: put fundamental arguments computation
!                  into subroutine NUTFA.
!          David Gordon 94.04.15 Converted to Implicit None.
!          David Gordon 95.09.27 Conversion of nutation series coefficients to
!                  double precision removed - no longer necessary.
!          Jim Ryan 2002.09 Integer*4 conversion.
!          David Gordon 2004.07.30 Adding computation of fundamental
!                  arguments consistent with Wahr nutation, taken from
!                  Calc 8 and IERS Standards (1992).
!
!  Code added to compute fundamental arguments consistent with Wahr nutation,
!   taken from Calc 8.
      CENT2 = CENT * CENT
      CENT3 = CENT * CENT2
!
!  Computation of the fundamental arguments and derivatives
!
      EL = ELC(1) * CENT3 + ELC(2) * CENT2 + ELC(3) * CENT &
     &     + ELC(4) + DMOD( ELC(5) * CENT, 1.D0 ) * SEC360
      FA (1) = DMOD( EL, SEC360 )
      FAD(1) = 3.D0 * ELC(1) * CENT2 + 2.D0 * ELC(2) * CENT &
     &         + ELC(3) + ELC(5) * SEC360
!
      ELP = ELPC(1) * CENT3 + ELPC(2) * CENT2 + ELPC(3) * CENT &
     &     + ELPC(4) + DMOD( ELPC(5) * CENT, 1.D0 ) * SEC360
      FA (2) = DMOD( ELP, SEC360 )
      FAD(2) = 3.D0 * ELPC(1) * CENT2 + 2.D0 * ELPC(2) * CENT &
     &         + ELPC(3) + ELPC(5) * SEC360
!
      F = FC(1) * CENT3 + FC(2) * CENT2 + FC(3) * CENT &
     &     + FC(4) + DMOD( FC(5) * CENT, 1.D0 ) * SEC360
      FA (3) = DMOD( F, SEC360 )
      FAD(3) = 3.D0 * FC(1) * CENT2 + 2.D0 * FC(2) * CENT &
     &         + FC (3) + FC(5) * SEC360
!
      D = DC(1) * CENT3 + DC(2) * CENT2 + DC(3) * CENT &
     &     + DC(4) + DMOD( DC(5) * CENT, 1.D0 ) * SEC360
      FA (4) = DMOD( D, SEC360 )
      FAD(4) = 3.D0 * DC(1) * CENT2 + 2.D0 * DC(2) * CENT &
     &         + DC(3) + DC(5) * SEC360
!
      OM = OMC(1) * CENT3 + OMC(2) * CENT2 + OMC(3) * CENT &
     &     + OMC(4) + DMOD( OMC(5) * CENT, 1.D0 ) * SEC360
      FA (5) = DMOD( OM, SEC360 )
      FAD(5) = 3.D0 * OMC(1) * CENT2 + 2.D0 * OMC(2) * CENT &
     &         + OMC(3) + OMC(5) * SEC360
!
!  INITIALIZE OUTPUT
      DPSI(1) = 0.0D0
      DPSI(2) = 0.0D0
      DEPS(1) = 0.0D0
      DEPS(2) = 0.0D0
!
!  SUM NUTATION SERIES TERMS, FROM SMALLEST TO LARGEST
!
!!!   N = NOP
!
      DO J=1,NOT
        I = NOT + 1 - J
!
!   FORMATION OF MULTIPLES OF ARGUMENTS
!
        ARG = X(1,I) * FA(1) &                   ! EL    arcseconds
     &      + X(2,I) * FA(2) &                   ! ELP
     &      + X(3,I) * FA(3) &                   ! F
     &      + X(4,I) * FA(4) &                   ! D
     &      + X(5,I) * FA(5)                  ! OM
        ARG = DMOD(ARG,SEC360) * CONVDS     ! radian
!
!   FORMATION OF MULTIPLES FOR DERIVATIVES
!
        ARGDOT = X(1,I) * FAD(1) &   ! ELD
     &         + X(2,I) * FAD(2) &   ! ELPD
     &         + X(3,I) * FAD(3) &   ! FD
     &         + X(4,I) * FAD(4) &   ! DD
     &         + X(5,I) * FAD(5)  ! OMD
        ARGDOT = ARGDOT * CONVDS
!
!   STORE VALUES OF ARGUMENTS AND DERIVATIVES OF SPECIFIC TERMS
!
!!!     IF (N.GT.0) THEN
!!!       IF (IDP(N).EQ.I) THEN
!!!         ARGP(1,N) = ARG
!!!         ARGP(2,N) = ARGDOT
!!!         N = N - 1
!!!       ENDIF
!!!     ENDIF
!
!   EVALUATE NUTATION AND DERIVATIVES OF NUTATION
!
        DPSI(1) = (X(6,I) + X(7,I)*CENT) * DSIN(ARG) &
     &          + DPSI(1)
        DPSI(2) = DPSI(2) + X(7,I) * DSIN(ARG) + (X(6,I) &
     &          + X(7,I) * CENT) * ARGDOT * DCOS(ARG)
        DEPS(1) = (X(8,I) + X(9,I)*CENT) * DCOS(ARG) &
     &          + DEPS(1)
        DEPS(2) = DEPS(2) + X(9,I) * DCOS(ARG) - (X(8,I) &
     &          + X(9,I) * CENT) * ARGDOT * DSIN(ARG)
!
      ENDDO  ! j=1,not
!
!   CONVERT TO PROPER UNITS
!
      DPSI(1) = DPSI(1) * 1.0D-4
      DPSI(2) = DPSI(2) * 1.0D-4 / (CENTJ * SECDAY)
      DEPS(1) = DEPS(1) * 1.0D-4
      DEPS(2) = DEPS(2) * 1.0D-4 / (CENTJ * SECDAY)
!
! SEE IF WE NEED DEBUG OUTPUT
      IF (KNUTD .NE. 0) THEN
        WRITE (6,9)
    9   FORMAT (1X,'Debug output for subroutine NUTW.')
    8   FORMAT(A,4D25.16/(7X,5D25.16))
        WRITE(6,8)' SEC360  ',SEC360
        WRITE(6,8)' ARG     ',ARG
        WRITE(6,8)' ARGDOT  ',ARGDOT
        WRITE (6,9200) CONVDS, CENTJ, SECDAY, CENT, DEPS, DPSI
9200    FORMAT (1X,'CONVDS = ',D25.16,/,1X,'CENTJ = ',D25.16,/,1X, &
     &       'SECDAY = ',D25.16,/,1X,'CENT = ',D25.16,/,1X, &
     &       'DEPS = ',2(D25.16,2X),/,1X,'DPSI = ',2(D25.16,2X), /)
      ENDIF
!
      RETURN
      END
!***************************************************************
      Subroutine dscan(Iscan, Kjob)  
      implicit none
!
!      Common blocks used -
!
      INCLUDE 'ccon.i'
!       Variables 'to':
!         1. ILUOUT - A flag controlling output.
!
      INCLUDE 'cmxst11.i'
!       Variables 'to':
!         1. NUMSIT    - The total number of sites in the data base.
!         2. Zero_site - The site number of the site at the geocenter.
!
      INCLUDE 'cmxsr11.i'
!       Variables 'to':
!         1. NUMSTR - The total number of stars (radio sources) in the
!                     data base.
      Character*20 SrcName(MAX_ARC_SRC)
      Equivalence (LNSTAR(1,1), SrcName(1))
!
      INCLUDE 'cmxut11.i'
!       Variables 'to':
!         1. Xintv(2)    - First and last Julian Date of the current scan.
!         2. Intrvl(5,2) - First and last time tag of data in the current
!                          scan. (First index: year, month, day,
!                          hour, minute. Second index: first, last.)
!
      INCLUDE 'd_input.i'
!           Input variables:
!             1) calc_file_name - Job file '.calc' file name.
!
      INCLUDE 'c2poly.i'
!
!
!   Program specifications -
!
      Character*200 Buf1
      CHARACTER*12  Scan12
      Real*8    JDY2K, Jsecstart, Jsecstop, Jsec2
      Real*8    FJD2, Fday
      Real*8    JD1, JD2, StrtUTCmin, StopUTCmin, ProcMin
      Integer*4 IX, IX1, IX2, Iscan, Min2, IOS, ScanN, Kjob
      Integer*4 JTAG1(5), JTAG2(5)
      Integer*4 get4unit
      Integer*4 I, N, Unit1, J
      SAVE      Unit1
!
!     PROGRAMMER - David Gordon January 2015 
!                  DG, 2016-July-07  Kjob added to conserve LU numbers
!
!
!     Initialize scan inputs.
        ScanID       = '          '
        ScanNum      = -1
        ScanStrt     = -1 
        ScanDur      = -1
        PointingSrc  = -1
        NumPhCntr    = -1
        PhCntrNum    = -1
        Do I = 1, 500
         PhCntr(I)   = -1
        Enddo
        Near_Far = 'Far-field '
!
      If (Iscan .gt. 1) Go to 200
!
!  First time: open the file and read down to the 'SCAN' section.
       If (Kjob .eq. 1) Unit1 = get4unit()
       OPEN(Unit1,FILE=calc_file_name,STATUS='OLD',ACTION='READ',IOSTAT=IOS)
       IF(IOS.ne.0) Write(6,'("Open Error for file: ",A128)') calc_file_name
!
 100  Continue
      Read(Unit1,'(A200)',end=200) Buf1
      If (Buf1(1:10).eq.'NUM SCANS:') Go to 200
      Go to 100
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
 200  Continue
!
      Read (Unit1,'(A200)',end=300) Buf1
!
      If (Buf1(1:4).eq.'SCAN') Then
       IX = INDEX(Buf1,'IDENTIFIER:')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) ScanN
        If(ScanN+1 .eq. Iscan)  Then 
         ScanNum = ScanN + 1            ! For Fortran
         Scan12 = Buf1((IX+11):(IX+22)) 
         Scan12 = ADJUSTL(Scan12)
         ScanID = Scan12(1:10)
         Go To 200
        Else
         Backspace(Unit1)
         Go to 300 
        Endif
       Endif 
!
       IX = INDEX(Buf1,'START (S):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) ScanN
        If(ScanN+1 .eq. Iscan)  Then 
         ScanNum = ScanN + 1            ! For Fortran
         Read(Buf1((IX+10):(IX+17)),*) ScanStrt
         Go To 200
        Else           
         Backspace(Unit1)
         Go to 300
        Endif
       Endif 
!
       IX = INDEX(Buf1,'DUR (S):')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) ScanN
        If(ScanN+1 .eq. Iscan)  Then 
         ScanNum = ScanN + 1            ! For Fortran
         Read(Buf1((IX+8):(IX+17)),*) ScanDur
         Go To 200
        Else           
         Backspace(Unit1)
         Go to 300
        Endif
       Endif 
!
       IX = INDEX(Buf1,'POINTING SRC:')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) ScanN
        If(ScanN+1 .eq. Iscan)  Then 
         ScanNum = ScanN + 1            ! For Fortran
         Read(Buf1((IX+13):(IX+16)),*) PointingSrc 
          PointingSrc = PointingSrc + 1                    ! For Fortran
         Go To 200
        Else           
         Backspace(Unit1)
         Go to 300
        Endif
       Endif 
!
       IX = INDEX(Buf1,'NUM PHS CTRS:')
       If (IX .gt. 0) Then
        Read(Buf1(5:IX-1),*) ScanN
        If(ScanN+1 .eq. Iscan)  Then 
         ScanNum = ScanN + 1            ! For Fortran
         Read(Buf1((IX+13):(IX+16)),*) NumPhCntr
         Go To 200
        Else           
         Backspace(Unit1)
         Go to 300
        Endif
       Endif 
!
!      IX = INDEX(Buf1,'PHS CTR 0:')
       IX1 = INDEX(Buf1,'PHS CTR')
       IX2 = INDEX(Buf1,':')
       If (IX1 .gt. 0 .and. IX2 .gt. 0) Then
        Read(Buf1(5:IX1-1),*) ScanN
        If(ScanN+1 .eq. Iscan)  Then 
         ScanNum = ScanN + 1            ! For Fortran
         Read(Buf1((IX1+7):(IX2-1)),*) PhCntrNum
          PhCntrNum = PhCntrNum +1                         ! For Fortran
         Read(Buf1((IX2+1):(IX2+6)),*) PhCntr(PhCntrNum)
          PhCntr(PhCntrNum) = PhCntr(PhCntrNum) +1         ! For Fortran
         Go To 200
        Else           
         Backspace(Unit1)
         Go to 300
        Endif
       Endif 
!
      Endif 
!
      Go to 200
!
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
 300  Continue
!
      If (Iscan .eq. NumScans) Close(Unit1)
!
!
!     Get the start and stop times, all on the even minute
       JTAG1(1) = StartYr
       JTAG1(2) = StartMo
       JTAG1(3) = StartDay
       JTAG1(4) = StartHr
       JTAG1(5) = StartMin
       Jsecstart = StartSec + ScanStrt 
! Recompute starting yr, month, day, hr, min, sec.
        IF (Jsecstart .ge. 59.999999999D0) Call FixEpoch(JTAG1,Jsecstart)
!
       JTAG2(1) = JTAG1(1)
       JTAG2(2) = JTAG1(2)
       JTAG2(3) = JTAG1(3)
       JTAG2(4) = JTAG1(4)
       JTAG2(5) = JTAG1(5)
! Stop time plus 1 second (to get an additional polynomial interval
!  if stop time is on the even minute).
       Jsecstop = Jsecstart + ScanDur + 1
        IF (Jsecstop .ge. 59.999999999D0) Call FixEpoch(JTAG2,Jsecstop)
!
! Convert start and stop times to the even minute before and after the
!  scan start and stop.
       Intrvl(1,1) = JTAG1(1)
       Intrvl(2,1) = JTAG1(2)
       Intrvl(3,1) = JTAG1(3)
       Intrvl(4,1) = JTAG1(4)
        Min2 = JTAG1(5)/2
        JTAG1(5) = Min2*2  
       Intrvl(5,1) = JTAG1(5)
!  Julian date of 2-minute interval start time
       JD1  = JDY2K (JTAG1(1),JTAG1(2),JTAG1(3)) 
       Xintv(1) = JD1 + JTAG1(4)/24.D0 + JTAG1(5)/1440.D0
!
        Jsec2 = Jsecstop + 119
        Call FixEpoch(JTAG2,Jsec2)
       Intrvl(1,2) = JTAG2(1)
       Intrvl(2,2) = JTAG2(2)
       Intrvl(3,2) = JTAG2(3)
       Intrvl(4,2) = JTAG2(4)
        Min2 = JTAG2(5)/2
        JTAG2(5) = Min2*2  
       Intrvl(5,2) = JTAG2(5)
!  Julian date of 2-minute interval stop time
       JD2  = JDY2K (JTAG2(1),JTAG2(2),JTAG2(3)) 
       Xintv(2) = JD2 + JTAG2(4)/24.D0 + JTAG2(5)/1440.D0
!  
! Start/Stop time in UTC minutes (1 day = 1440 minutes)
        StrtUTCmin = (Xintv(1) - JD1) * 1440.D0
        StopUTCmin = (Xintv(2) - JD1) * 1440.D0
        ProcMin = StopUTCmin - StrtUTCmin + .00001
!         # of 2-minute intervals this scan
        Intrvls2min = ProcMin/2 + 1   ! Add an extra 2-minutes
!         # of calc epochs this scan
        NumEpochs = ((ProcMin*60. + .001)/d_interval) + 1
!
!      write(6,*) 'dScan: Numsrc,Numstr,NumSpace: ', Numsrc,Numstr,NumSpace
!      write(6,*) 'dScan: SrcName: ', (SrcName(J), J=1,Numsrc)
!      write(6,*) 'dScan: SpName: ', (SpName(J), J=1,NumSpace)
!  Far-field or Near-field?
      If(NumSpace .ge. 1) Then
       Do J = 1, NumSpace
        If(SrcName(PointingSrc) .eq. SpName(J)) Then
         Near_Far = 'Near-field'
         If(Verbose .ge. 1) Write(6,1011) NF_Model, Iscan-1, SrcName(PointingSrc)
 1011    Format(' Using the ',A8,' Near-field model for scan ',I3,'  Source ',A20)
         Call SPACEI(J)
         Go to 310
        Endif
       Enddo
 310   Continue
      Endif
       If(Verbose .ge. 1 .and. Near_Far .eq. 'Far-field ')              &
     &            write(6,1012) Iscan-1, SrcName(PointingSrc)
 1012    Format(' Using the Far-field model for scan ',I3,'  Source ',A20)
!
!     Go back to the main.
      RETURN
      END
      SUBROUTINE NFSTRG (XJD, UTC, Isource, EARTH, SITEP, SITEV, SUN,   &
     &           XMOON,R2K6, STAR, STARdt, STAR12, STAR12dt, T0_T1, R1, &
     &           R1dt, R1mag, R1magdt, R2, R2dt, R2mag, R2magdt,STARff, &
     &           R1_TDB, R2_TDB, R1mag_TDB, R2mag_TDB, Site2_TDB,       &
     &           Sourc20)
      IMPLICIT None
!
! 4.1.1 Near-field version of the STAR Module. 
!       Reference: M. Sekido and T. Fukushima, 'A VLBI delay model for
!                  radio sources at a finite distance', J. Geodesy, 
!                  vol. 80, pp. 137-149, 2006.
!
! 4.2   STRG PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!         INPUT:
!          1. Isource - Source # if in 'difx' mode.
!          2. R2K6(3,3,3) - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                           MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                           CEO-based version. (UNITLESS, 1/SEC, 1/SEC**2)
!         OUTPUT VARIABLES:
!          1. STAR(3)  -  THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!
! 4.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cmxsr11.i'
!       VARIABLES 'FROM':
!          1. LNSTAR(10,MAX_ARC_SRC)- THE EIGHT ALPHANUMERIC CHARACTER NAMES
!                                     OF THE STARS IN THE STAR CATALOG.
!                                     Up to 20 characters long in difx mode.
!          2. NUMSTR                - THE NUMBER OF STARS IN THE STAR
!                                     CATALOG.
!          3. RADEC(2,MAX_ARC_SRC)  - THE RIGHT ASCENSIONS AND DECLINATIONS
!                                     OF THE STARS IN THE STAR CATALOG.
!                                     (RAD, RAD)
!       VARIABLES 'TO':
!          1. CD  - THE COSINE OF THE DECLINATION OF THE STAR BEING USED IN
!                   THE CURRENT OBSERVATION. (UNITLESS)
!          2. CRA - THE COSINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                   USED IN THE CURRENT OBSERVATION. (UNITLESS)
!          3. SD  - THE SINE OF THE DECLINATION OF THE STAR BEING USED IN
!                   THE CURRENT OBSERVATION. (UNITLESS)
!          4. SRA - THE SINE OF THE RIGHT ASCENSION OF THE STAR BEING USED
!                   IN THE CURRENT OBSERVATION. (UNITLESS)
!
      INCLUDE 'ccon.i'
!       VARIABLES 'FROM':
!          1. KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!          2. KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cuser11.i'
!       Variables 'from':
!          1. C_mode     - Calc 11 mode. Either 'mark3 ', 'difx  ', or
!                          'nusolve'.
!          2. Near_field - Logical*4 flag for source type. 
!               ====>  Not currently used.
!                          = .False. for far-field sources (normal mode). 
!                          = .True. for near-field sources (spacecraft). 
!
      INCLUDE 'get2s.i'
!       Variables to:
!          1. LSTRNM(4) - THE EIGHT ALPHAMERIC CHARACTER STAR NAME FOR THE
!                         CURRENT OBSERVATION. (ALPHAMERIC)
!
      INCLUDE 'd_input.i'
!       Variables to:
!          1. 
!       Variables from:
!          1. NF_flag - Near field flag giving coordinate definition of 
!                       the near field object. Either 'GC' - geocentric,
!                       or 'BC' - barycentric or ?????.  
!               ====>  Not currently used. Assumed to be geocentric.
!          2. L_time  - Option to solve for light-travel time, if not
!                       built into the near-field object ephemeris.
!
      INCLUDE 'cphys11.i'
!           VARIABLES 'FROM':
!             1. VLIGHT  - THE VELOCITY OF LIGHT IN VACUUM.  (M/SEC)
!
      Real*8         PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON /CMATH/ PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!         CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS
!                 (RAD/ARCSECOND)
!
! 4.2.3 PROGRAM SPECIFICATIONS -
      Real*8  STAR(3), XJD, UTC, STAR12(3,2), EARTH(3,3), SITEP(3,2),   &
     &        SITEV(3,2), STARdt(3), STAR12dt(3,2), SUN(3,2),           &
     &        XMOON(3,2), R2K6(3,3,3)
      Real*8 VECMG, DOTP, R1(3), R2(3), R1dt(3), R2dt(3), R1mag, R2mag, &
     &       R1magdt, R2magdt, UTC0, T0_T1, DTgrav, R12(3), Div,        &
     &       STARff(3), STAR12dt0(3,2), R1dt0(3), R2dt0(3)
      Real*8 Sptimem1, Sptimep1, SPpm1(3), SPpp1(3), R1m1(3), R2m1(3),  &
     &       R1p1(3), R2p1(3), STAR12m1(3,2), STAR12p1(3,2),            &
     &       SITEPm1(3,2), SITEPp1(3,2)
!
! 4.2.4 DATA BASE ACCESS -
!
! 4.2.8 PROGRAM VARIABLES -
      REAL*8    RIGHT_ASC, DECLINATION, Xepoch, XJAN1, Xdays, Difyrs,   &
     &          JDepoch, JDY2K
      Real*8  Sptime, xMJD
!
      Real*8 Xp_spline, Yp_spline, Zp_spline, Xv_spline, Yv_spline,     &
     &       Zv_spline, Xpdot, Ypdot, Zpdot, Xvdot, Yvdot, Zvdot
!     Real*8 SPpxyz(3), SPvxyz(3), SPv2xyz(3), SPaxyz(3), yxdot2,yxdot3
      Real*8 yxdot2, yxdot3
      Real*8 ECEFp(3), ECEFv(3), ECEFa(3), SP1(3), SP2(3), SP3(3),      &
     &       SP4(3), SP5(3), SP6(3)
!
      Real*8 Site1_TDB(3), Site2_TDB(3), SPp_TDB(3), U_Sun, U, dU,      &
     &       vecmg1, F1, VdotR1, VdotR2, VdotNFO, R1_TDB(3), R2_TDB(3), &
     &       STAR12_TDB(3,2), R1mag_TDB, R2mag_TDB, STAR_TDB(3),        &
     &       VsubEarth(3), R_Earth_Sun(3), V_Earth_Sun(3)
!
      Real*8 tau, dP2(3), P2(3), V2(3), dV2(3)
      Real*8 Star_ab(3), VS1(3), VS2(3), VS3(3)
      Real*8 STARmag, uSTAR(3), K1(3), K2(3), STARssbc(3)
!
      Integer*4 N, NN, IM, ID, Ieph, I, J, Isource, Ierr4, I4, MJDx
!     Integer*2 NDO(3), KERR
!
      Character*20 SrcName(MAX_ARC_SRC), SName, Sourc20
      Equivalence (LNSTAR(1,1), SrcName(1))
      Equivalence (LSTRNM(1), SName)
!
!
! 4.2.9 PROGRAMMER - David Gordon Feb. 2013 
!
!     Construct the arrays which will hold the information for the
!     source being used in the current observation in order to pass
!     this information to the remainder of CALC.
!
!     Match the current source name against the names in the star catalog.
!     If no match, send a message and quit.
      IF (C_mode .eq. 'mark3 ') Then
  300  DO 310  NN = 1, NUMSTR
           N = NN
           IF  ( ( LNSTAR(1,N) .EQ. LSTRNM(1) ) &
     &     .AND. ( LNSTAR(2,N) .EQ. LSTRNM(2) ) &
     &     .AND. ( LNSTAR(3,N) .EQ. LSTRNM(3) ) &
     &     .AND. ( LNSTAR(4,N) .EQ. LSTRNM(4) ) )  GO TO 320
  310  CONTINUE
!       Write(6,*) 'NUMSTR= ', NUMSTR
!       Write(6,*) 'LSTRNM= ', LSTRNM(1), LSTRNM(2), LSTRNM(3), LSTRNM(4)
!       Write(6,*) 'LNSTAR= ', LNSTAR(1,1),LNSTAR(2,1),LNSTAR(3,1),LNSTAR(4,1)
       GO TO 600
      ENDIF
!
      IF (C_mode .eq. 'difx  ') Then
       N = Isource
       SName = SrcName(N)
       Sourc20 = SName
!       Write(6,*) ' Subroutine NFSTRG: '
!       Write(6,*) 'NUMSTR: ', NUMSTR
!       Write(6,'(" SName, SrcName: ",A20,2X,A20)') SName,SrcName(N)
!       Write(6,'(" STRNM= ",4A2)' ) LSTRNM
      ENDIF
!
  320 CONTINUE
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Do spline interpolations to get spacecraft position and velocity 
!   for the current epoch (at the time of transmission).
!       write (6,*) ' '
         MJDx = XJD - 2400000.5D0  + .00001    ! Integer 
         xMJD = MJDx                           ! Real
!       write (6,*) ' XJD,UTC,MJDx,xMJD  ', XJD,UTC,MJDx,xMJD 
        UTC0 = UTC
!           Correct for light travel time or not?
          I4 = 1
          If (L_time .eq. 'solve     ') I4 = 4 
      DO I = 1,I4       ! Iterate I4 times if solving light time equation
!  Convert UTC time to tabular table time
!       Sptime = ( (XJD+UTC0) - SpcIF(1) ) / SpcIF(2)
        Sptime = ( (xMJD + UTC0) - SpcIF(1) ) / SpcIF(2)
!       write (6,*) 'NFSTRG: '
!       write (6,*) ' UTC, xMJD+UTC0 ', UTC, (xMJD+UTC0)
!       write (6,*) ' SpcIF   ', SpcIF
!       write (6,*) ' I, UTC0    ', I, UTC0 
!       write (6,*) ' I, Sptime: ', I, Sptime
!       write (6,*) ' '
       Call Splynt4(Xc,ySPxp,y2SPxp,S_spline,Sptime,Xp_spline,Xpdot,    &
     &               yxdot2,yxdot3,ierr4)
       SPpxyz(1) = Xp_spline
       SPv2xyz(1) = Xpdot / (SpcIF(2) * 86400.D0) 
       Call Splynt4(Xc,ySPyp,y2SPyp,S_spline,Sptime,Yp_spline,Ypdot,    &
     &               yxdot2,yxdot3,ierr4)
        SPpxyz(2) = Yp_spline
        SPv2xyz(2) = Ypdot / (SpcIF(2) * 86400.D0) 
       Call Splynt4(Xc,ySPzp,y2SPzp,S_spline,Sptime,Zp_spline,Zpdot,    &
     &               yxdot2,yxdot3,ierr4)
        SPpxyz(3) = Zp_spline
        SPv2xyz(3) = Zpdot / (SpcIF(2) * 86400.D0) 
!
        If (I .eq. 4) Go to 77
!      Estimate T0, time when signal left near-field object
        CALL VECSB (SPpxyz, SITEP(1,1), R1) 
        T0_T1 = VECMG(R1)/VLIGHT 
!        write (6,*) 'I, T0_T1: ', I, T0_T1 
        UTC0 = UTC - (T0_T1/86400.D0) 
         Call DELTGRAV (T0_T1, EARTH, SITEP, SUN, XMOON, DTgrav)
        UTC0 = UTC0 - DTgrav/86400.D0
         T0_T1 = T0_T1 + DTgrav
!        write (6,*) 'I, T0_T1+DTgrav: ', I, T0_T1 
!        write (6,*) 'NFSTRG: I, T0_T1, DTgrav: ', I, T0_T1, DTgrav 
!        
 77     Continue
      ENDDO
!
!      write (6,*) 'UTC,UTC0,DTgrav', UTC*86400.D0,UTC0*86400.D0,DTgrav
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Near-field test
!   Multiply satelite positions by 10, 
!    Don't change velocities
!      write (6,*) ' SPACECRAFT POSITIONS TIMES 1.D6. ' 
!       SPpxyz(1) = SPpxyz(1) * 1.D6
!       SPpxyz(2) = SPpxyz(2) * 1.D6
!       SPpxyz(3) = SPpxyz(3) * 1.D6
!        T0_T1    =     T0_T1 * 1.D6    
!        write (6,*) '                 ' 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
      Call Splynt4(Xc,ySPxv,y2SPxv,S_spline,Sptime,Xv_spline,Xvdot,     &
     &               yxdot2,yxdot3,ierr4)
       SPvxyz(1) = Xv_spline
       SPaxyz(1) = Xvdot / (SpcIF(2) * 86400.D0) 
      Call Splynt4(Xc,ySPyv,y2SPyv,S_spline,Sptime,Yv_spline,Yvdot,     &
     &               yxdot2,yxdot3,ierr4)
       SPvxyz(2) = Yv_spline
       SPaxyz(2) = Yvdot / (SpcIF(2) * 86400.D0) 
      Call Splynt4(Xc,ySPzv,y2SPzv,S_spline,Sptime,Zv_spline,Zvdot,     &
     &               yxdot2,yxdot3,ierr4)
!       write (6,*) ' Sptime: ', Sptime
       SPvxyz(3) = Zv_spline
       SPaxyz(3) = Zvdot / (SpcIF(2) * 86400.D0) 
!
!     Write (6,*) 'Xp_spline,Yp_spline,Zp_spline: ', Xp_spline,         &
!    &             Yp_spline, Zp_spline
!     Write (6,*) 'Xv_spline, Yv_spline, Zv_spline: ', Xv_spline,       &
!    &             Yv_spline, Zv_spline
!     Write (6,*) 'Xpdot, Ypdot, Zpdot: ', Xpdot, Ypdot, Zpdot 
!     Write (6,*) 'Xvdot, Yvdot, Zvdot: ', Xvdot, Yvdot, Zvdot 
!     Write (6,*) 'SPpxyz', SPpxyz
!     Write (6,*) 'SPvxyz: ', SPvxyz
!     Write (6,*) 'SPv2xyz: ', SPv2xyz
!     Write (6,*) 'SPaxyz: ', SPaxyz
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Near-field test
!   Multiply near-field positions by factors of 10, and set velocities
!    and accelerations to zero. 
!      write (6,*) ' Near-field positions times 1.D6. ' 
!       SPpxyz(1) = SPpxyz(1) * 1.D6
!       SPpxyz(2) = SPpxyz(2) * 1.D6
!       SPpxyz(3) = SPpxyz(3) * 1.D6
!        T0_T1    =     T0_T1 * 1.D6    
!       SPvxyz(1) = 0.D0
!       SPvxyz(2) = 0.D0
!       SPvxyz(3) = 0.D0
!       SPaxyz(1) = 0.D0
!       SPaxyz(2) = 0.D0
!       SPaxyz(3) = 0.D0
!        write (6,*) '                 ' 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!      write(6,*) ' SPpxyz ', SPpxyz
!  If frame is geocentric Earth-fixed, convert to geocentric J2000
      If (SpFrame .eq. 'ECEF') Then
       Do I = 1,3
        ECEFp(I) = SPpxyz(I) 
        ECEFv(I) = SPvxyz(I) 
        ECEFa(I) = SPaxyz(I) 
       Enddo
       CALL VECRT ( R2K6(1,1,1), ECEFp, SPpxyz )
!
       CALL VECRT ( R2K6(1,1,2), ECEFp, SP1 )
       CALL VECRT ( R2K6(1,1,1), ECEFv, SP2 )
       CALL VECAD (SP1, SP2, SPvxyz)
!
       CALL VECRT ( R2K6(1,1,3), ECEFp, SP1 )
       CALL VECRT ( R2K6(1,1,2), ECEFv, SP2 )
       CALL VECRT ( R2K6(1,1,2), ECEFv, SP3 )
       CALL VECRT ( R2K6(1,1,1), ECEFa, SP4 )
       CALL VECAD (SP1, SP2, SP5)
       CALL VECAD (SP3, SP4, SP6)
       CALL VECAD (SP5, SP6, SPaxyz )
!
!      write(6,*) ' SpFrame: ', SpFrame
!      write(6,*) ' ECEFp  ', ECEFp 
!      write(6,*) ' SPpxyz ', SPpxyz
!      write(6,*) ' ECEFv  ', ECEFv 
!      write(6,*) ' SPvxyz ', SPvxyz
!      write(6,*) ' ECEFa  ', ECEFa 
!      write(6,*) ' SPaxyz ', SPaxyz
      Endif
!
!  If frame is SSBC J2000, convert to geocentric J2000
      If (SpFrame .eq. 'SSBC') Then
       CALL VECSB (SPpxyz, EARTH(1,1), SPpxyz)
       CALL VECSB (SPvxyz, EARTH(1,2), SPvxyz)
       CALL VECSB (SPaxyz, EARTH(1,3), SPaxyz)
      Endif
!
!  Spacecraft coordinates should now be geocentric J2000.
!
      CALL VECSB (SPpxyz, SITEP(1,1), R1) 
      CALL VUNIT (R1, STAR12(1,1))
      CALL VECSB (SPvxyz, SITEV(1,1), R1dt) 
       R1mag = VECMG(R1)
       R1magdt = (0.5D0/R1mag)*2.D0*DOTP(R1,R1dt)
       Do I = 1, 3
        STAR12dt(I,1) = R1dt(I)/R1mag - R1(I)*R1magdt/R1mag**2 
       Enddo
!  STAR12dt0( ) does NOT contain the effects of Earth rotation:
!     CALL VECEQ (SPvxyz, R1dt0)
!     CALL VECDV(R1dt0, R1mag, STAR12dt0(1,1))
!
      CALL VECSB (SPpxyz, SITEP(1,2), R2) 
      CALL VUNIT (R2, STAR12(1,2))
      CALL VECSB (SPvxyz, SITEV(1,2), R2dt) 
       R2mag = VECMG(R2)
       R2magdt = (0.5D0/R2mag)*2.D0*DOTP(R2,R2dt)
       Do I = 1, 3
        STAR12dt(I,2) = R2dt(I)/R2mag - R2(I)*R2magdt/R2mag**2 
       Enddo
!  STAR12dt0( ) does NOT contain the effects of Earth rotation:
!     CALL VECEQ (SPvxyz, R2dt0)
!     CALL VECDV(R2dt0, R2mag, STAR12dt0(1,2))
!
!  Compute pseudo source vector, STAR(3)
       CALL VECAD (R1, R2, R12)
        Div = R1mag + R2mag
       CALL VECDV (R12, Div, STAR)  
!
!!        write(6,*) 'R2T1: '
!!        write(6,*) 'R2 ',  R2
!!        write(6,*) 'R2mag ',  R2mag
!!        write(6,*) 'STAR12(1,2) ', STAR12(1,2),STAR12(2,2),STAR12(3,2)
!!        write(6,*) 'STAR ', STAR
!
      Do I = 1,3
       STARdt(I) = (R1dt(I)+R2dt(I))/Div - STAR(I)*(R1magdt+R2magdt)/Div
      Enddo
!!!!!! Test: use R2 at time T2
!?         tau = (R1mag - R2mag)/Vlight
!?         Call Vecmu(SITEV(1,2),tau,dP2)
!?         Call Vecsb(SITEP(1,2),dP2,P2)
!?         Call Vecsb(SPpxyz, P2, R2)
!?          R2mag = VECMG(R2)
!!        write(6,*) 'R2T2: '
!!        write(6,*) ' tau ', tau
!!        write(6,*) ' dP2 ', dP2
!!        write(6,*) '  P2 ',  P2
!!        write(6,*) '  R2 ',  R2
!!        write(6,*) '  R2mag ',  R2mag
!!        write(6,*) '   '
!
!?         tau = (R1mag - R2mag)/Vlight
!?         Call Vecmu(SITEV(1,2),tau,dP2)
!?         Call Vecsb(SITEP(1,2),dP2,P2)
!?         Call Vecsb(SPpxyz, P2, R2)
!?          R2mag = VECMG(R2)
!!        write(6,*) ' tau ', tau
!!        write(6,*) ' dP2 ', dP2
!!        write(6,*) '  P2 ',  P2
!!        write(6,*) '  R2 ',  R2
!!        write(6,*) '  R2mag ',  R2mag
!?       CALL VUNIT (R2, STAR12(1,2))
!!        write(6,*) 'STAR12(1,2) ', STAR12(1,2),STAR12(2,2),STAR12(3,2)
!!!      Call Vecmu(SITEA(1,2),tau,dV2)
!!!      Call Vecsb(SITEV(1,2),dV2,V2)
!      CALL VECSB (SPvxyz, V2, R2dt) 
!?       R2mag = VECMG(R2)
!?       R2magdt = (0.5D0/R2mag)*2.D0*DOTP(R2,R2dt)
!?       Do I = 1, 3
!?        STAR12dt(I,2) = R2dt(I)/R2mag - R2(I)*R2magdt/R2mag**2 
!?       Enddo
!  Compute pseudo source vector, STAR(3)
!?       CALL VECAD (R1, R2, R12)
!?        Div = R1mag + R2mag
!?       CALL VECDV (R12, Div, STAR)  
!         write(6,*) 'STAR ', STAR
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!   Convert spacecraft and site vectors from TT to TDB  
       Do I = 1, 3
        VsubEarth(I) = EARTH(I,2)      !  SSBC Earth Velocity
        R_Earth_Sun(I)  = -SUN(I,1)    !  Vector from Sun to Earth
        V_Earth_Sun(I)  = -SUN(I,2)    !  Velocity of Earth w.r.t. the Sun
       Enddo
! 
!       Sun's potential:
       U_Sun  = GMSUN/VLIGHT2
       vecmg1 = VECMG(R_Earth_Sun)
       U      = U_Sun/vecmg1
!!!      write(6,*) 'GMSUN,VLIGHT2,R_Earth_Sun ',  GMSUN,VLIGHT2,R_Earth_Sun 
!   Derivative:
!??    dU = -U_Sun * Dotp(R_Earth_Sun,V_Earth_Sun) / vecmg1**3
       F1 = 1.D0 - U - 1.48082686741D-8 
!        write(6,*) 'vecmg1, U, F1 ', vecmg1, U, F1 
!
        VdotR1 = DOTP(VsubEarth,SITEP(1,1))
        VdotR2 = DOTP(VsubEarth,SITEP(1,2))
        VdotNFO = DOTP(VsubEarth,SPpxyz)     
! 
        Call Vecad(VsubEarth,SITEV(1,1),VS1)
        Call Vecad(VsubEarth,SITEV(1,2),VS2)
        Call Vecad(VsubEarth,SPvxyz    ,VS3)
!       VdotR1 = DOTP(VS1      ,SITEP(1,1))
!       VdotR2 = DOTP(VS2      ,SITEP(1,2))
!       VdotNFO = DOTP(VS3      ,SPpxyz)     
!
!   TDB vectors:
       Do I = 1,3
!       Site1_TDB(I) = SITEP(I,1)*F1 - 0.5D0*(VdotR1/VLIGHT2)*(VsubEarth(I)+SITEV(I,1))
!       Site2_TDB(I) = SITEP(I,2)*F1 - 0.5D0*(VdotR2/VLIGHT2)*(VsubEarth(I)+SITEV(I,2))
!       SPp_TDB(I) = SPpxyz(I)*F1 - 0.5D0*(VdotNFO/VLIGHT2)*(VsubEarth(I)+SPvxyz(I))
        Site1_TDB(I) = SITEP(I,1)*F1 - 0.5D0*(VdotR1/VLIGHT2)*(VS1(I))
        Site2_TDB(I) = SITEP(I,2)*F1 - 0.5D0*(VdotR2/VLIGHT2)*(VS2(I))
        SPp_TDB(I) = SPpxyz(I)*F1 - 0.5D0*(VdotNFO/VLIGHT2)*(VS3(I))
       Enddo
!      Do I = 1,3
!       R1_TDB(I) = R1(I)*F1 - 0.5D0*((DOTP(VsubEarth,R1))*VsubEarth(I)/VLIGHT2)
!       R2_TDB(I) = R2(I)*F1 - 0.5D0*((DOTP(VsubEarth,R2))*VsubEarth(I)/VLIGHT2)
!      Enddo
!
      CALL VECSB (SPp_TDB, Site1_TDB, R1_TDB) 
      CALL VUNIT (R1_TDB, STAR12_TDB(1,1))
!??   CALL VECSB (SPvxyz, SITEV(1,1), R1dt) 
       R1mag_TDB = VECMG(R1_TDB)
!??    R1magdt = (0.5D0/R1mag)*2.D0*DOTP(R1,R1dt)
!??    Do I = 1, 3
!??     STAR12dt(I,1) = R1dt(I)/R1mag - R1(I)*R1magdt/R1mag**2 
!??    Enddo
!  STAR12dt0( ) does NOT contain the effects of Earth rotation:
!     CALL VECEQ (SPvxyz, R1dt0)
!     CALL VECDV(R1dt0, R1mag, STAR12dt0(1,1))
!
      CALL VECSB (SPp_TDB, Site2_TDB, R2_TDB) 
      CALL VUNIT (R2_TDB, STAR12_TDB(1,2))
!??   CALL VECSB (SPvxyz, SITEV(1,2), R2dt) 
       R2mag_TDB = VECMG(R2_TDB)
!??    R2magdt = (0.5D0/R2mag)*2.D0*DOTP(R2,R2dt)
!??    Do I = 1, 3
!??     STAR12dt(I,2) = R2dt(I)/R2mag - R2(I)*R2magdt/R2mag**2 
!??    Enddo
!  STAR12dt0( ) does NOT contain the effects of Earth rotation:
!     CALL VECEQ (SPvxyz, R2dt0)
!     CALL VECDV(R2dt0, R2mag, STAR12dt0(1,2))
!
!  Compute pseudo source vector, STAR(3)
       CALL VECAD (R1_TDB, R2_TDB, R12)
        Div = R1mag_TDB + R2mag_TDB
       CALL VECDV (R12, Div, STAR_TDB)  
       CALL VECDV (R12, Div, STAR    )      ! Now corrected to TDB!
!       write(6,*) 'R1,   R2   ', R1, R2
!       write(6,*) 'R1TDB,R2TDB', R1_TDB, R2_TDB
!       write(6,*) 'STAR,STAR_TDB', STAR, STAR_TDB
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  For Sekido model, compute apparent source pseudo vector at SSBC
!    due to abberation.
!       STARmag = VECMG(STAR)
!       Call VUNIT(STAR, uSTAR)
!       Do I = 1,3 
!        K1(I) = uSTAR(I) + (-1.D0)*VsubEarth(I)/VLIGHT -          &
!    &    (-1.D0)*uSTAR(I)*(DOTP(uSTAR,VsubEarth))/VLIGHT 
!       Enddo
!       Call VUNIT(K1,K2)
!       Call VECMU(K2,STARmag, STARssbc)
!       write(6,*) 'STAEssbc ', STAEssbc
!       Do I = 1,3   ! Abberation Test
!        STAR(I) = Starssbc(I)
!       Enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!??   Do I = 1,3
!??    STARdt(I) = (R1dt(I)+R2dt(I))/Div - STAR(I)*(R1magdt+R2magdt)/Div
!??   Enddo
!!!!
!!!   Write (6,*) 'SITEP1: ', SITEP(1,1),SITEP(2,1),SITEP(3,1),Site1_TDB
!!!   Write (6,*) 'SITEP2: ', SITEP(1,2),SITEP(2,2),SITEP(3,2),Site2_TDB
!!!   Write (6,*) 'SPp:    ', SPpxyz, SPp_TDB 
!!!   Write (6,*) 'R1:     ', R1, R1_TDB
!!!   Write (6,*) 'R1mag:  ', R1mag, R1mag_TDB
!!!   Write (6,*) 'R2:     ', R2, R2_TDB
!!!   Write (6,*) 'R2mag:  ', R2mag, R2mag_TDB
!!!   Write (6,*) 'STAR12(1): ', STAR12(1,1), STAR12(2,1), STAR12(3,1), &
!!!  &            STAR12_TDB(1,1), STAR12_TDB(2,1), STAR12_TDB(3,1)
!!!   Write (6,*) 'STAR12(2): ', STAR12(1,2), STAR12(2,2), STAR12(3,2), &
!!!  &            STAR12_TDB(1,2), STAR12_TDB(2,2), STAR12_TDB(3,2)
!!!    Write (6,*) 'STAR   ', STAR, STAR_TDB
!!!    Write (6,*) 'STAR-ratio', STAR(1)/STAR_TDB(1),STAR(2)/STAR_TDB(2), &
!!!  &                           STAR(3)/STAR_TDB(3)
!!!    Write (6,*) '       '                 
!
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!      Write (6,*) '          '
!      Write (6,*) 'SPpxyz:   ', SPpxyz
!      Write (6,*) 'SITEP(1): ', SITEP(1,1), SITEP(2,1), SITEP(3,1)
!      Write (6,*) '          '
!      Write (6,*) 'SPvxyz:   ', SPvxyz
!      Write (6,*) 'SPv2xyz:  ', SPv2xyz
!      Write (6,*) 'SITEV(1): ', SITEV(1,1), SITEV(2,1), SITEV(3,1)
!      Write (6,*) '          '
!      Write (6,*) 'SPaxyz:   ', SPaxyz
!      Write (6,*) 'SITEA(1): ', SITEA(1,1), SITEA(2,1), SITEA(3,1)
!      Write (6,*) '          '
!      Write (6,*) 'R1:       ', R1      
!      Write (6,*) 'R1dt:     ', R1dt      
!      Write (6,*) 'R1mag:    ', R1mag
!      Write (6,*) 'R1magdt:  ', R1magdt
!      Write (6,*) '          '
!      Write (6,*) 'STAR12(1):', STAR12(1,1), STAR12(2,1), STAR12(3,1)
!      Write (6,*) 'STAR12dt: ', STAR12dt(1,1), STAR12dt(2,1),          &
!    &              STAR12dt(3,1)
!      Write (6,*) 'STAR12dt0: ', STAR12dt0(1,1), STAR12dt0(2,1),       &
!    &              STAR12dt0(3,1)
!      Write (6,*) '          '
!      Write (6,*) 'SPpxyz:   ', SPpxyz
!      Write (6,*) 'SITEP(2): ', SITEP(1,2), SITEP(2,2), SITEP(3,2)
!      Write (6,*) '          '
!      Write (6,*) 'SPvxyz:   ', SPvxyz
!      Write (6,*) 'SITEV(2): ', SITEV(1,2), SITEV(2,2), SITEV(3,2)
!      Write (6,*) '          '
!      Write (6,*) 'R2:       ', R2
!      Write (6,*) 'R2dt:     ', R2dt
!      Write (6,*) 'R2mag:    ', R2mag
!      Write (6,*) 'R2magdt:  ', R2magdt
!      Write (6,*) '          '
!      Write (6,*) 'STAR12(2):', STAR12(1,2), STAR12(2,2), STAR12(3,2)
!      Write (6,*) 'STAR12dt:  ', STAR12dt(1,2), STAR12dt(2,2),         &
!    &              STAR12dt(3,2)
!      Write (6,*) 'STAR12dt0: ', STAR12dt0(1,2), STAR12dt0(2,2),       &
!    &              STAR12dt0(3,2)
!      Write (6,*) '          '
!      Write (6,*) 'R12       ', R12     
!      Write (6,*) 'Div       ', Div     
!      Write (6,*) 'STAR      ', STAR    
!      Write (6,*) 'STARdt    ', STARdt  
!      Write (6,*) '          '
!
!***********************************************************************
!   Compute a pseudo RA and Declination
      Call VUNIT (STAR, STARff)
       RIGHT_ASC = DATAN2(STARff(2),STARff(1))
       DECLINATION = DASIN (STARff(3))
!
        RADEC(1,Isource) = RIGHT_ASC 
        RADEC(2,Isource) = DECLINATION
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!*    SD = DSIN ( DECLINATION)
!*    CD = DCOS ( DECLINATION)
!*    SRA = DSIN ( RIGHT_ASC )
!*    CRA = DCOS ( RIGHT_ASC )
!    Compute the equivalent Far-field source position unit vector.
!*    STARff(1) = CD * CRA
!*    STARff(2) = CD * SRA
!*    STARff(3) = SD
!       Write (6,*) '          '
!       Write (6,*) 'STARff    ', STARff  
!       Write (6,*) 'Far-Field RA,DEC: ', RIGHT_ASC, DECLINATION
!       Write (6,*) '          '
!
!!!!!!!!!!!!!!!!!!!! DEBUG !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     WRITE ( 6, 9207 )  STAR, LSTRNM
!9207 FORMAT (1X, "STAR   = ", 3 ( D30.16, 10X ), /, 1X, &
!    &            "LSTRNM = ", 4A2, / )
!!!!!!!!!!!!!!!!!!!! DEBUG !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Compute Star unit vectors at -1 and +1 seconds
!*      Sptimem1 = Sptime - 1.D0/(86400.D0*SpcIF(2))
!*      Sptimep1 = Sptime + 1.D0/(86400.D0*SpcIF(2))
!*      Write(6,*) 'Sptime, -1, +1', Sptime, Sptimem1, Sptimep1
!
!*     Call Splynt4(Xc,ySPxp,y2SPxp,S_spline,Sptimem1,Xp_spline,Xpdot,  &
!*   &               yxdot2,yxdot3,ierr4)
!*      SPpm1(1) = Xp_spline
!*     Call Splynt4(Xc,ySPyp,y2SPyp,S_spline,Sptimem1,Yp_spline,Ypdot,  &
!*   &               yxdot2,yxdot3,ierr4)
!*      SPpm1(2) = Yp_spline
!*     Call Splynt4(Xc,ySPzp,y2SPzp,S_spline,Sptimem1,Zp_spline,Zpdot,  &
!*   &               yxdot2,yxdot3,ierr4)
!*      SPpm1(3) = Zp_spline
!*     Write (6,*) 'SPpm1: ', SPpm1 
!
!*     Call Splynt4(Xc,ySPxp,y2SPxp,S_spline,Sptimep1,Xp_spline,Xpdot,  &
!*   &               yxdot2,yxdot3,ierr4)
!*      SPpp1(1) = Xp_spline
!*     Call Splynt4(Xc,ySPyp,y2SPyp,S_spline,Sptimep1,Yp_spline,Ypdot,  &
!*   &               yxdot2,yxdot3,ierr4)
!*      SPpp1(2) = Yp_spline
!*     Call Splynt4(Xc,ySPzp,y2SPzp,S_spline,Sptimep1,Zp_spline,Zpdot,  &
!*   &               yxdot2,yxdot3,ierr4)
!*      SPpp1(3) = Zp_spline
!*     Write (6,*) 'SPpp1: ', SPpp1 
!
!*      CALL VECSB(SITEP(1,1),SITEV(1,1), SITEPm1(1,1))
!*    CALL VECSB (SPpm1, SITEPm1(1,1), R1m1)
!*    CALL VUNIT (R1m1, STAR12m1(1,1))
!*      CALL VECSB(SITEP(1,2),SITEV(1,2), SITEPm1(1,2))
!*    CALL VECSB (SPpm1, SITEPm1(1,2), R2m1)
!*    CALL VUNIT (R2m1, STAR12m1(1,2))
!*     Write (6,*) 'STAR12m1(1): ', STAR12m1(1,1),STAR12m1(2,1),STAR12m1(3,1)
!*     Write (6,*) 'STAR12m1(2): ', STAR12m1(1,2),STAR12m1(2,2),STAR12m1(3,2)
!
!*      CALL VECAD(SITEP(1,1),SITEV(1,1), SITEPp1(1,1))
!*    CALL VECSB (SPpp1, SITEPp1(1,1), R1p1)
!*    CALL VUNIT (R1p1, STAR12p1(1,1))
!*      CALL VECAD(SITEP(1,2),SITEV(1,2), SITEPp1(1,2))
!*    CALL VECSB (SPpp1, SITEPp1(1,2), R2p1)
!*    CALL VUNIT (R2p1, STAR12p1(1,2))
!*     Write (6,*) 'STAR12p1(1): ', STAR12p1(1,1),STAR12p1(2,1),STAR12p1(3,1)
!*     Write (6,*) 'STAR12p1(2): ', STAR12p1(1,2),STAR12p1(2,2),STAR12p1(3,2)
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     Check KSTRD for debug output.
      IF ( KSTRD .EQ. 0 )  GO TO 500
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine STRG." )
!
      WRITE(6,8)' CD      ',CD
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CRA     ',CRA
      WRITE(6,8)' RADEC   ',RADEC
      WRITE(6,7)' NUMSTR  ',NUMSTR
    7 FORMAT(A,15I8/(9X,15I8))
      WRITE(6,8)' SD      ',SD
      WRITE(6,8)' SRA     ',SRA
!
      WRITE ( 6, 9200 )  STAR, LSTRNM, LNSTAR
 9200 FORMAT (1X, "STAR   = ", 3 ( D30.16, 10X ), /, 1X, &
     &            "LSTRNM = ", 4A2, /, 1X, &
     &            "LNSTAR = ", 10 ( 10 ( 4A2, 2X ), /, 1X ) )
!
!   5.    NORMAL PROGRAM CONCLUSION.
!
  500 RETURN
!
!   6.    ABNORMAL PROGRAM TERMINATION.
!
  600 WRITE ( 6, 9300 )
 9300 FORMAT (" CALC has terminated in subroutine STRG.  ", &
     &        ' The source identification was not successful. ' )
!
      CALL TERMINATE_CALC ( 'STRG  ', int2(0), int2(0))
      END
!**********************************************************************
      SUBROUTINE NFSTRP (EPBASE,STAR,EARTH,SITEV, CDX,CRAX,SDX,SRAX)
      IMPLICIT None
!
! 5.1.1 STRP is the partial derivatives section of the STAR module. It computes
!       the partial derivatives of the delay and rate with respect to the source
!       declination and right ascension.
!
! 5.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1. EPBASE(3,2) - THE J2000.0 GEOCENTRIC BASELINE VECTOR
!                              AND ITS CT TIME DERIVATIVE. (M, M/SEC)
!             2. STAR(3)     - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!             3. EARTH(3,3)  - The ssbc position, velocity, and acceleration
!                               of the Earth. (m, m/s, m/s**2)
!           OUTPUT VARIABLES:
!             1. CDX -  THE COSINE OF THE DECLINATION OF THE SOURCE
!             2. CRAX - THE COSINE OF THE RIGHT ASCENSION OF THE SOURCE
!             3. SDX -  THE SINE OF THE DECLINATION OF THE SOURCE
!             4. SRAX - THE SINE OF THE RIGHT ASCENSION OF THE SOURCE
!**           5. DSTRP(2,2)-THE PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!**                     RATE WITH RESPECT TO THE SOURCE RIGHT ASCENSION AND
!**                     DECLINATION. (sec/rad, sec/sec-rad) THE FIRST INDEX
!**                     RUNS OVER RA AND DEC, THE SECOND RUNS OVER DELAY AND
!**                     DELAY RATE.
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!           VARIABLES 'FROM':
!             1. VLIGHT  - THE VELOCITY OF LIGHT IN VACUUM.  (M/SEC)
!             2. VLIGHT2 - THE VELOCITY OF LIGHT IN VACUUM SQUARED.
!                          (M**2/SEC**2)
      INCLUDE 'cmxsr11.i'
!           VARIABLES 'FROM':
!             1. CD  - THE COSINE OF THE DECLINATION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!             2. CRA - THE COSINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!             3. SD  - THE SINE OF THE DECLINATION OF THE STAR BEING USED
!                      IN THE CURRENT OBSERVATION.
!             4. SRA - THE SINE OF THE RIGHT ASCENSION OF THE STAR BEING
!                      USED IN THE CURRENT OBSERVATION.
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1.  KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!             2.  KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables to:
!         1. DSTRP(2,2) - THE PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!                         RATE WITH RESPECT TO THE SOURCE RIGHT ASCENSION AND
!                         DECLINATION. (sec/rad, sec/sec-rad) THE FIRST INDEX
!                         RUNS OVER RA AND DEC, THE SECOND RUNS OVER DELAY AND
!                         DELAY RATE.
!
!
      Real*8 PR_RA, PR_DEC
      Common /Pmotn/ PR_RA, PR_DEC
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
       Real*8 DDEC(3), DRA(3),             EPBASE(3,2), STAR(3), CDX,   &
     &        CRAX, SDX, SRAX, EARTH(3,3), SITEV(3,2), c1, c2, tt,      &
     &        vg(3), bp(3), bv(3),            DOTP
!*   &        vg(3), bp(3), bv(3), PMCONT(2), DOTP
       Integer*4 I
!
! 5.2.4 DATA BASE ACCESS -
!**         'PUT' VARIABLES:
!**           1. DSTRP(2,2) - THE PARTIAL DERIVATIVES OF THE DELAY AND OF THE
!**                           DELAY RATE WITH RESPECT TO THE SOURCE RIGHT
!**                           ASCENSION AND DECLINATION. (sec/rad, sec/sec-rad)
!**                           THE FIRST INDEX RUNS OVER RIGHT ASCENSION AND
!**                           DECLINATION, THE SECOND INDEX RUNS OVER THE DELAY
!**                           AND THE DELAY RATE.
!**         ACCESS CODES:
!**           1. 'STR PART' - THE DATA BASE ACCESS CODE FOR THE STAR MODULE
!**                           PARTIAL DERIVATIVES ARRAY.
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVP
!             CALLED SUBROUTINES: PUT4
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES -
!             1. DDEC(3) - THE PARTIAL DERIVATIVE OF THE J2000.0 SOURCE UNIT
!                          VECTOR WITH RESPECT TO SOURCE DECLINATION. (1/RAD)
!             2. DRA(3)  - THE PARTIAL DERIVATIVE OF THE J2000.0 SOURCE UNIT
!                          VECTOR WITH RESPECT TO THE SOURCE RIGHT ASCENSION.
!                          (1/RAD)
!             3. c1, c2, tt, vg(3), b(3) -  Dummy variables used in computation
!                          of the partials.
!
! 5.2.9 PROGRAMMER - 77.01.13 Dale Markham
!                    77.07.14 Peter Denatale
!                    88.11.10 Bruce Schupler
!                    88.01.07 Jim Ryan
!                    89.07.09 Jim Ryan Documentation simplied.
!                    89.10.05 Jim Ryan CPHYS common made an include file
!                    89.12.12 Jim Ryan UNIX-like database interface
!                             implimented.
!                    01:11:25 Jim Ryan Term 2 of Shapiro's model added
!                             to the partials.
!                    David Gordon 94.04.15 Converted to Implicit None
!                    David Gordon 95.05.02 DSTRP passed back to DRIVR for use
!                             in PLXP.
!                    B. Archinal  95.11.13 Max # sources set in cmxsr.i.
!                    David Gordon 98.09.08 Changed partials computation to
!                             use CONSENSUS model (Step 10B). Makes no
!                             significant difference.
!                    David Gordon 2000.05.15 Bug correction, variable c1
!                             redefined (had been commented out).
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!                    David Gordon Jan. 2013  PUT moved to subroutine PUT_P.
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!                                             !!!!!!!!!!!!!!!
!!!!!!!!!!!!!!           NOT FOR NEAR-FIELD USE            !!!!!!!!!!!!!!! 
!!!!!!!!!!!!!!                                             !!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!     STRP Program Structure
!
!  Compute the partial derivatives of the J2000.0 source unit vector with
!   respect to the source declination and with respect to the source R.A.
      DDEC(1) = - SD * CRA
      DDEC(2) = - SD * SRA
      DDEC(3) = + CD
!
      DRA(1) = - CD * SRA
      DRA(2) = + CD * CRA
      DRA(3) = 0.D0
!******************************************************************************
!   Complete the calculation of the partial derivatives.
!     c1 = 1.d0/VLIGHT
!     c2 = c1**2
!     Do i=1,3
!       vg(i) =  EARTH(I,2)
!       bp(i) = -EPBASE(I,1)
!       bv(i) = -EPBASE(I,2)
!     Enddo
!     tt = 1.d0 - c1*Dotp(STAR,vg)
!
!     DSTRP(1,1)=-c1*Dotp(bp,DRA )*tt+c2*Dotp(STAR,bp)*Dotp(vg,DRA)
!     DSTRP(1,2)=-c1*Dotp(bv,DRA )*tt+c2*Dotp(STAR,bv)*Dotp(vg,DRA)
!     DSTRP(2,1)=-c1*Dotp(bp,DDEC)*tt+c2*Dotp(STAR,bp)*Dotp(vg,DDEC)
!     DSTRP(2,2)=-c1*Dotp(bv,DDEC)*tt+c2*Dotp(STAR,bv)*Dotp(vg,DDEC)
!     WRITE(6,'(" Old DSTRP: ",4D22.14)') DSTRP
!******************************************************************************
!
!   Complete the calculation of the partial derivatives.
      Do I=1,3
        vg(I) =  EARTH(I,2) + SITEV(I,2)
        bp(I) = -EPBASE(I,1)
        bv(I) = -EPBASE(I,2)
      Enddo
      c1 = 1.d0/VLIGHT
      tt = 1.d0 + c1*Dotp(STAR,vg)
!   Changed to Consensus model formula
      DSTRP(1,1) = -Dotp(bp,DRA )/(Vlight*tt) +                         &
     &              Dotp(STAR,bp)*Dotp(vg,DRA)/Vlight2
      DSTRP(1,2) = -Dotp(bv,DRA )/(Vlight*tt) +                         &
     &              Dotp(STAR,bv)*Dotp(vg,DRA)/Vlight2
      DSTRP(2,1) = -Dotp(bp,DDEC)/(Vlight*tt) +                         &
     &              Dotp(STAR,bp)*Dotp(vg,DDEC)/Vlight2
      DSTRP(2,2) = -Dotp(bv,DDEC)/(Vlight*tt) +                         &
     &              Dotp(STAR,bv)*Dotp(vg,DDEC)/Vlight2
!     WRITE(6,'(" New DSTRP: ",4D22.14)') DSTRP
!
!   PUT the partials into the database.
!**   CALL PUT4 ('STR PART      ', DSTRP, int2(2), int2(2), int2(1))
!
!   Copy some values from STRCM into dummy variables for use elsewhere
      CDX = CD
      CRAX = CRA
      SDX = SD
      SRAX = SRA
!
!   Check KSTRD for debug output.
      IF ( KSTRD .EQ. 0 )  GO TO 600
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine STRP." )
      WRITE(6,8)' CD     ',CD
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CRA    ',CRA
      WRITE(6,8)' DDEC   ',DDEC
      WRITE(6,8)' DRA    ',DRA
      WRITE(6,8)' DSTRP  ',DSTRP
      WRITE(6,8)' SD     ',SD
      WRITE(6,8)' SRA    ',SRA
      WRITE(6,8)' VLIGHT ',VLIGHT
      WRITE(6,8)' c1     ',c1
      WRITE(6,8)' c2     ',c2
      WRITE(6,8)' tt     ',tt
      WRITE(6,8)' vg     ',vg
      WRITE(6,8)' bp     ',bp
      WRITE(6,8)' bv     ',bv
!
      WRITE ( 6, 9200 )  EPBASE, STAR,CDX,SDX,CRAX,SRAX
 9200 FORMAT (1X, "EPBASE = ", 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            "STAR   = ", 3 ( D30.16, 10X ),/,1X, &
     &            "CDX    = ", D30.16,1X, &
     &            "SDX    = ", D30.16,1X, &
     &            "CRAX   = ", D30.16,/,1X, &
     &            "SRAX   = ", D30.16)
!
! NORMAL PROGRAM CONCLUSION.
!
  600 RETURN
      END
!***********************************************************************
!**   SUBROUTINE STRC (DSTRP)
      SUBROUTINE NFSTRC ( )
      IMPLICIT None
!
! 5.1.1 STRC is the contributions section of the STAR module. It computes
!       contributions to the delay and rate due to proper motions. Used
!       only when KSTRC = 1 or 2.
!
! 5.2.1 CALLING SEQUENCE -
!**     INPUT VARIABLES:
!**       1. DSTRP(2,2)-THE PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!**                     RATE WITH RESPECT TO THE SOURCE RIGHT ASCENSION AND
!**                     DECLINATION. (sec/rad, sec/sec-rad) THE FIRST INDEX
!**                     RUNS OVER RA AND DEC, THE SECOND RUNS OVER DELAY AND
!**                     DELAY RATE.
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!             1. KSTRC - THE STAR MODULE FLOW CONTROL FLAG.
!             2. KSTRD - THE STAR MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables from:
!         1. DSTRP(2,2)-THE PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!                       RATE WITH RESPECT TO THE SOURCE RIGHT ASCENSION AND
!                       DECLINATION. (sec/rad, sec/sec-rad) THE FIRST INDEX
!                       RUNS OVER RA AND DEC, THE SECOND RUNS OVER DELAY AND
!                       DELAY RATE.
!       Variables to:
!         1. PMCONT(2) - If KSTRC = 1, these are the contributions to
!                        the delay and rate to correct for the effect
!                        of proper motion; add to theoreticals.
!                        If KSTRC = 2, these are the contributions to
!                        return the delay and rate to their non-proper
!                        motion values; add to theoreticals. (sec, sec/sec).
!
      Real*8 PR_RA, PR_DEC
      Common /Pmotn/ PR_RA, PR_DEC
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!**    Real*8 DSTRP(2,2), PMCONT(2)
!
! 5.2.4 DATA BASE ACCESS -
!**        'PUT' VARIABLES:
!**          1. PMCONT(2) - If KSTRC = 1, these are the contributions to
!**                         the delay and rate to correct for the effect
!**                         of proper motion; add to theoreticals.
!**                         If KSTRC = 2, these are the contributions to
!**                         return the delay and rate to their non-proper
!**                         motion values; add to theoreticals. (sec, sec/sec).
!**        ACCESS CODES:
!**          1. 'PMOTNCON' - The data base access code for the proper motion
!**                          contribution.
!**          2. 'PMOT2CON' - The data base access code for the proper motion
!                            removal contribution.
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVP
!             CALLED SUBROUTINES: PUT4
!
! 5.2.9 PROGRAMMER - 98.09.15 D. Gordon - subroutine created
!                    Jim Ryan Sept 2002 Integer*2/4 mods.
!
!     STRC Program Structure
!
!  Check for proper motion computations
      IF (KSTRC.eq.1 .or. KSTRC.eq.2) THEN
        PMCONT(1) = PR_RA*DSTRP(1,1) + PR_DEC*DSTRP(2,1)
        PMCONT(2) = PR_RA*DSTRP(1,2) + PR_DEC*DSTRP(2,2)
!**     IF (KSTRC.eq.1) CALL PUT4 ('PMOTNCON      ', PMCONT, int2(2), &
!**  &      int2(1), int2(1))
!**     IF (KSTRC.eq.2) CALL PUT4 ('PMOT2CON      ', PMCONT, int2(2), &
!**  &      int2(1), int2(1))
      ELSE
       Return
      ENDIF
!
!** DEBUG *************************************************************
      WRITE(6,8)'STRP: DSTRP  ', DSTRP
      WRITE(6,8)'STRP: PMCONT ', PMCONT
!
!   Check KSTRD for debug output.
      IF (KSTRD .EQ. 0)  THEN
       WRITE ( 6, 9)
    9  FORMAT (1X, "Debug output for subroutine STRC." )
    8  FORMAT(A,4D25.16/(7X,5D25.16))
       WRITE(6,8)' DSTRP  ',DSTRP
       WRITE(6,8)'STRP: PMCONT ', PMCONT
      ENDIF
!
! NORMAL PROGRAM CONCLUSION.
!
  600 RETURN
      END
!
!**********************************************************************
!
      SUBROUTINE DELTGRAV ( T0_T1, EARTH, SITEP, SUN, XMOON, DTgrav)
      IMPLICIT NONE
!
      REAL*8 T0_T1, EARTH(3,3), SITEP(3,2), SUN(3,2), XMOON(3,2), DTgrav
      Real*8 dSun(3), SunT0(3), R0sun(3), dMoon(3), MoonT0(3),          &
     &       R0moon(3), dPlan(3), PlanT0(3), R0gp(3), DT(9), VECMG,     &
     &       DTsun, DTmoon
      Integer*4 I
!
!     Program Interface
!       Input variables:
!         1. T0_T1      - 
!         8. SITEP(3,2) - The J2000.0 geocentric position vectors of each
!                         observing site. (m)
!        10. SUN(3,2)   - The J2000.0 geocentric Sun position and velocity
!                         vectors. (m, m/sec)
!        11. XMOON(3,2) - The J2000.0 geocentric Moon position and velocity
!                         vectors. (m, m/sec)
!       Output variables:
!         1. DTgrav     - 

!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) - Geocentric satellite position (meters). 
!
!
       INCLUDE 'cphys11.i'
!          Variables 'from':
!            1. VLIGHT  - The velocity of light in vacuum.  (m/sec)
!            2. VLIGHT2 - The velocity of light squared. (m/sec)**2
!            3. VLIGHT3 - THE VELOCITY OF LIGHT IN VACUUM CUBED.
!                         (M**3/SEC**3)
!            4. GMSUN, GMMOON, GMEARTH, GMPLANET(7) - Gravitational constant
!                         times the masses of the Sun, Moon, Earth, and the
!                         other planets except Pluto.

!
      INCLUDE 'csolsys11.i'
!       Variables 'from':
!         2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                             of all planets except the Earth and Pluto.
!                             (meters, meters/sec) The first index runs over
!                             X,Y, and Z, the second runs over position and
!                             velocity, and the third runs over the planets,
!                             where
!                                    1 = Mercury
!                                    2 = Venus
!                                    3 = Mars
!                                    4 = Jupiter
!                                    5 = Saturn
!                                    6 = Uranus
!                                    7 = Neptune
!
!!!!!
       CALL VECMU(SUN(1,2),T0_T1,dSun)
       CALL VECSB (SUN(1,1),dSun, SunT0  )
       CALL VECSB (SunT0   ,SPpxyz, R0sun)
       DTsun = 2.D0 * GMSUN/VLIGHT3 *                                   &
     & DLOG( (VECMG(SunT0) + VECMG(R0sun) + VECMG(SPpxyz    )) /        &
     &       (VECMG(SunT0) + VECMG(R0sun) - VECMG(SPpxyz     )))
!       Write(6,*) '   '
!       Write(6,*) 'DELTGRAV: '
!       Write(6,*) 'T0_T1 ', T0_T1
!       Write(6,*) 'GMSUN ', GMSUN 
!       Write(6,*) 'VLIGHT3 ', VLIGHT3 
!       Write(6,*) 'SUN   ', SUN
!       Write(6,*) 'dSun  ', dSun
!       Write(6,*) 'SunT0 ', SunT0
!       Write(6,*) 'R0sun ', R0sun
!       Write(6,*) 'DTsun(psec) ', DTsun * 1.D12
!
       CALL VECMU (XMOON(1,2),T0_T1, dMoon)
       CALL VECSB (XMOON(1,1),dMoon, MoonT0)
       CALL VECSB (MoonT0,SPpxyz, R0moon)
       DTmoon = 2.D0 * GMMOON/VLIGHT3 *                                 &
     & DLOG( (VECMG(MoonT0) + VECMG(R0moon) + VECMG(SPpxyz    )) /      &
     &       (VECMG(MoonT0) + VECMG(R0moon) - VECMG(SPpxyz     )))
!       Write(6,*) '   '
!       Write(6,*) 'GMMOON ', GMMOON
!       Write(6,*) 'XMOON  ', XMOON
!       Write(6,*) 'dMoon  ', dMoon
!       Write(6,*) 'MoonT0 ', MoonT0
!       Write(6,*) 'R0moon ', R0moon
!       Write(6,*) 'DTmoon(psec) ', DTmoon * 1.D12
!
      DO I = 1,7
        CALL VECMU (GPLANET(1,2,I),T0_T1, dPlan)
        CALL VECSB (GPLANET(1,1,I),dPlan, PlanT0)
        CALL VECSB (PlanT0,SPpxyz, R0gp)
        DT(I) = 2.D0 * GMPLANET(I)/VLIGHT3 *                            &
     &  DLOG( (VECMG(PlanT0) + VECMG(R0gp) + VECMG(SPpxyz    )) /       &
     &      (VECMG(PlanT0) + VECMG(R0gp) - VECMG(SPpxyz    )))
!       Write(6,*) '   '
!       Write(6,*) 'GMPLANET ', GMPLANET(I) 
!       Write(6,*) 'I,GPLANET  ', I, GPLANET(1,1,I),GPLANET(2,1,I),     &
!    &     GPLANET(3,1,I), GPLANET(1,2,I),GPLANET(2,2,I),GPLANET(3,2,I)
!       Write(6,*) 'dPlan  ', dPlan
!       Write(6,*) 'PlanT0 ', PlanT0
!       Write(6,*) 'R0gp   ', R0gp  
!       Write(6,*) 'DT(I)(psec) ', DT(I) * 1.D12 
!       Write(6,*) '   '
      ENDDO
!
      DTgrav = DTsun + DTmoon
      Do I = 1,7
       DTgrav = DTgrav + DT(I)
      Enddo
!       Write(6,*) '   '
!       Write(6,*) 'DTgrav(psec) ', DTgrav * 1.D12 
!       Write(6,*) '   '
!
      Return
      End
!
!**********************************************************************
!
      Subroutine NFSTewns( R1, R1dt, R1mag, R1magdt, R2, R2dt, R2mag,   &
     &           R2magdt, STAR, STARdt, STAR12, STAR12dt, SITEP, SITEV, &
     &           R1_TDB, R2_TDB, R1mag_TDB, R2mag_TDB, Site2_TDB,       &
     &            K_EWNS, STAR2         )
      IMPLICIT None
!
      INCLUDE 'd_input.i'
!       Variables from:
!          1. SPpxyz(3) - Geocentric satellite position (meters). 
!
      Real*8 SpEWNS(3,4), R1EWNS(3,4), R2EWNS(3,4), R1EWNSmag(4),       &
     &       R2EWNSmag(4), STAR12EWNS(3,4,2), STARewns(3,4)
      Common / NFewns/ SpEWNS, R1EWNS, R2EWNS, R1EWNSmag, R2EWNSmag,    &
     &       STAR12EWNS, STARewns
!
      Real*8 STAR(3), STAR12(3,2), STARdt(3), STAR12dt(3,2), R1(3),     &
     &       R2(3), R1dt(3), R2dt(3), R1mag, R2mag, R1magdt, R2magdt,   &
     &       SITEP(3,2), SITEV(3,2), R1_TDB(3), R2_TDB(3), R1mag_TDB,   &
     &       R2mag_TDB, Site2_TDB(3)             
      Real*8 Zee(3), West(3), South(3), UnitW(3), UnitS(3), W1(3),      &
     &       E1(3), StarW(3), StarE(3), S1(3), N1(3), StarS(3),         &
     &       StarN(3), StE(3), StW(3), StN(3), StS(3), R1E(3), R1W(3),  &
     &       R1N(3), R1S(3), div, VECMG, TAN0001
      Real*8 STAR2(3,4), K_EWNS(3,4)
      Real*8 R12(3), K12(3)
      Integer*4 I, K
!
!     write(6,*) '********* NFSTewns ********* '         
      Zee(1) = 0.D0
      Zee(2) = 0.D0
      Zee(3) = 1.D0
      TAN0001 = DTAN(.0001D0)
!
!
! R1 vector goes from the geocenter to the NFO, in J2000 frame.
! The geocenter is assumed to have coordinates (0,0,0).
! Take cross product of the R1 vector and the Z-unit vector. Result 
!   is a vector in the West direction in the plane tangent to the 
!   celestial sphere at the NFO as seen from the geocenter.
      Call Crosp(R1  ,Zee,West)
!       write(6,*) 'R1_TDB  :  ', R1_TDB   
!       write(6,*) 'West:  ', West
      Call VUNIT(West, UnitW)      ! make it a unit vector
!       write(6,*) 'UnitW: ', UnitW
! Compute a .0001 radian rotation of R1 in West and East directions
      Do I = 1,3
!      W1(I) = R1_TDB(I) + TAN0001 * UnitW(I) * R1mag_TDB
!      E1(I) = R1_TDB(I) - TAN0001 * UnitW(I) * R1mag_TDB
       W1(I) = R1    (I) + TAN0001 * UnitW(I) * R1mag    
       E1(I) = R1    (I) - TAN0001 * UnitW(I) * R1mag    
      Enddo
! Convert to unit vectors and then scale by R1mag
      Call VUNIT(W1, StarW)
      Call VUNIT(E1, StarE)
! Scale up to R1 magnitude
      Do I = 1,3
!      StarW(I) = StarW(I) * R1mag_TDB
!      StarE(I) = StarE(I) * R1mag_TDB
       StarW(I) = StarW(I) * R1mag
       StarE(I) = StarE(I) * R1mag
      Enddo
!       write(6,*) '        '
!       write(6,*) 'R2_TDB ', R2_TDB
!       write(6,*) 'SPpxyz ', SPpxyz
!       write(6,*) 'R1_TDB ', R1_TDB
!       write(6,*) 'R1     ', R1    
!       write(6,*) 'StarW: ', StarW
!       write(6,*) 'StarE: ', StarE
!
! Now do same in N-S direction
!     Call Crosp(R1_TDB,UnitW,South)
      Call Crosp(R1    ,UnitW,South)
      Call VUNIT(South,UnitS)
!       write(6,*) 'South: ', South
!       write(6,*) 'UnitS: ', UnitS
! Compute a .0001 radian rotation of R1 in North and South directions
      Do I = 1,3
!      S1(I) = R1_TDB(I) + TAN0001 * UnitS(I) * R1mag_TDB
!      N1(I) = R1_TDB(I) - TAN0001 * UnitS(I) * R1mag_TDB
       S1(I) = R1    (I) + TAN0001 * UnitS(I) * R1mag    
       N1(I) = R1    (I) - TAN0001 * UnitS(I) * R1mag    
      Enddo
! Convert to unit vectors
      Call VUNIT(S1, StarS)
      Call VUNIT(N1, StarN)
! Scale up to R1 magnitude
      Do I = 1,3
!      StarN(I) = StarN(I) * R1mag_TDB
!      StarS(I) = StarS(I) * R1mag_TDB
       StarN(I) = StarN(I) * R1mag
       StarS(I) = StarS(I) * R1mag
      Enddo
      Do I = 1,3     ! For Duev and ranging models
       SpEWNS(I,1) = StarE(I)
       SpEWNS(I,2) = StarW(I)
       SpEWNS(I,3) = StarN(I)
       SpEWNS(I,4) = StarS(I)
      Enddo
!       write(6,*) 'StarS: ', StarS
!       write(6,*) 'StarN: ', StarN
!
! Find R1, R2, Star12, and STAR for each of the 4 offsets
      Do K = 1, 4      ! Run over the 4 offset positions
        CALL VECSB (SpEWNS(1,K), SITEP(1,1), R1EWNS(1,K))
        CALL VUNIT (R1EWNS(1,K), STAR12EWNS(1,K,1))
        R1EWNSmag(K) = VECMG(R1EWNS(1,K))
!
        CALL VECSB (SpEWNS(1,K), SITEP(1,2), R2EWNS(1,K))
        CALL VUNIT (R2EWNS(1,K), STAR12EWNS(1,K,2))
        R2EWNSmag(K) = VECMG(R2EWNS(1,K))
! Pseudo star vectors
        CALL VECAD (R1EWNS(1,K), R2EWNS(1,K), R12)
         Div = R1EWNSmag(K) + R2EWNSmag(K)
        CALL VECDV (R12, Div, STARewns(1,K))
      Enddo
!       write(6,*) 'SPpxyz ', SPpxyz
!       write(6,*) 'SPeast ', SpEWNS(1,1), SpEWNS(2,1), SpEWNS(3,1) 
!       write(6,*) 'SPwest ', SpEWNS(1,2), SpEWNS(2,2), SpEWNS(3,2) 
!       write(6,*) 'SPnorth', SpEWNS(1,3), SpEWNS(2,3), SpEWNS(3,3) 
!       write(6,*) 'SPsouth', SpEWNS(1,4), SpEWNS(2,4), SpEWNS(3,4) 
!       write(6,*) '       '
!       write(6,*) 'SITEP-1', SITEP(1,1), SITEP(2,1), SITEP(3,1)
!       write(6,*) 'R1     ', R1    
!       write(6,*) 'R1east ', R1EWNS(1,1), R1EWNS(2,1), R1EWNS(3,1)
!       write(6,*) 'R1west ', R1EWNS(1,2), R1EWNS(2,2), R1EWNS(3,2)
!       write(6,*) 'R1south', R1EWNS(1,3), R1EWNS(2,3), R1EWNS(3,3)
!       write(6,*) 'R1north', R1EWNS(1,4), R1EWNS(2,4), R1EWNS(3,4)
!       write(6,*) '       '
!       write(6,*) 'SITEP-2', SITEP(1,2), SITEP(2,2), SITEP(3,2)
!       write(6,*) 'R2     ', R2    
!       write(6,*) 'R2east ', R2EWNS(1,1), R2EWNS(2,1), R2EWNS(3,1)
!       write(6,*) 'R2west ', R2EWNS(1,2), R2EWNS(2,2), R2EWNS(3,2)
!       write(6,*) 'R2south', R2EWNS(1,3), R2EWNS(2,3), R2EWNS(3,3)
!       write(6,*) 'R2north', R2EWNS(1,4), R2EWNS(2,4), R2EWNS(3,4)
!       write(6,*) '       '
!       write(6,*) 'STAR12(1)  ', STAR12(1,1), STAR12(2,1), STAR12(3,1)
!       write(6,*) 'STAR12(1)E ', STAR12EWNS(1,1,1), STAR12EWNS(2,1,1), STAR12EWNS(3,1,1)
!       write(6,*) 'STAR12(1)W ', STAR12EWNS(1,2,1), STAR12EWNS(2,2,1), STAR12EWNS(3,2,1)
!       write(6,*) 'STAR12(1)N ', STAR12EWNS(1,3,1), STAR12EWNS(2,3,1), STAR12EWNS(3,3,1)
!       write(6,*) 'STAR12(1)S ', STAR12EWNS(1,4,1), STAR12EWNS(2,4,1), STAR12EWNS(3,4,1)
!       write(6,*) '       '
!       write(6,*) 'STAR12(2)  ', STAR12(1,2), STAR12(2,2), STAR12(3,2)
!       write(6,*) 'STAR12(2)E ', STAR12EWNS(1,1,2), STAR12EWNS(2,1,2), STAR12EWNS(3,1,2)
!       write(6,*) 'STAR12(2)W ', STAR12EWNS(1,2,2), STAR12EWNS(2,2,2), STAR12EWNS(3,2,2)
!       write(6,*) 'STAR12(2)N ', STAR12EWNS(1,3,2), STAR12EWNS(2,3,2), STAR12EWNS(3,3,2)
!       write(6,*) 'STAR12(2)S ', STAR12EWNS(1,4,2), STAR12EWNS(2,4,2), STAR12EWNS(3,4,2)
!       write(6,*) '       '
!       write(6,*) 'STAR      ', STAR  
!       write(6,*) 'STAReast  ', STARewns(1,1), STARewns(2,1), STARewns(3,1)
!       write(6,*) 'STARwest  ', STARewns(1,2), STARewns(2,2), STARewns(3,2)
!       write(6,*) 'STARnorth ', STARewns(1,3), STARewns(2,3), STARewns(3,3)
!       write(6,*) 'STARsouth ', STARewns(1,4), STARewns(2,4), STARewns(3,4)
!       write(6,*) '       '
!
!   STAR2(3,4) = unit vectors from site 2 to the four offset positions (EWNS).
!   K_EWNS(3,4) = pseudo unit vectors from site 2 to the four offset
!      positions (EWNS). Same magnitude as STAR(3) (??). 
        CALL VECSB (StarE, SITEP(1,2), StE)  
        CALL VECSB (StarW, SITEP(1,2), StW)  
        CALL VECSB (StarN, SITEP(1,2), StN)  
        CALL VECSB (StarS, SITEP(1,2), StS)  
!       CALL VECSB (StarE, Site2_TDB,  StE)  
!       CALL VECSB (StarW, Site2_TDB,  StW)  
!       CALL VECSB (StarN, Site2_TDB,  StN)  
!       CALL VECSB (StarS, Site2_TDB,  StS)  
        Call Vunit(StE, STAR2(1,1))
        Call Vunit(StW, STAR2(1,2))
        Call Vunit(StN, STAR2(1,3))
        Call Vunit(StS, STAR2(1,4))
!        write(6,*) ' last week:  '
!        write(6,*) ' STAR12(n,2): ', STAR12(1,2), STAR12(2,2),STAR12(3,2)
!        write(6,*) ' STAR2(n,1):  ', STAR2(1,1), STAR2(2,1), STAR2(3,1)
!        write(6,*) ' STAR2(n,2):  ', STAR2(1,2), STAR2(2,2), STAR2(3,2)
!        write(6,*) ' STAR2(n,3):  ', STAR2(1,3), STAR2(2,3), STAR2(3,3)
!        write(6,*) ' STAR2(n,4):  ', STAR2(1,4), STAR2(2,4), STAR2(3,4)
!
!  Compute pseudo source vectors STARewns(3,4)
!!     CALL VECAD (R1_TDB, R2_TDB, R12)
!!      div = R1mag_TDB + VECMG(R12)
!!      div = R1mag_TDB + R2mag_TDB     
!!      CALL VECDV (R12, div, K12)
!
!      CALL VECAD (R1_TDB, StE, R1E)
!       div = R1mag_TDB + VECMG(StE)
!       CALL VECDV (R1E, div, K_EWNS(1,1)) 
!
!      CALL VECAD (R1_TDB, StW, R1W)
!       div = R1mag_TDB + VECMG(StW)
!       CALL VECDV (R1W, div, K_EWNS(1,2)) 
!
!      CALL VECAD (R1_TDB, StN, R1N)
!       div = R1mag_TDB + VECMG(StN)
!       CALL VECDV (R1N, div, K_EWNS(1,3)) 
!
!      CALL VECAD (R1_TDB, StS, R1S)
!       div = R1mag_TDB + VECMG(StS)
!       CALL VECDV (R1S, div, K_EWNS(1,4)) 
!        write(6,*) '             '
!!       write(6,*) 'K12     :   ', K12(1), K12(2), K12(3)
!        write(6,*) '      STAR: ', STAR(1), STAR(2), STAR(3)
!        write(6,*) 'K_EWNS(,1): ', K_EWNS(1,1), K_EWNS(2,1),K_EWNS(3,1)
!        write(6,*) 'K_EWNS(,2): ', K_EWNS(1,2), K_EWNS(2,2),K_EWNS(3,2)
!        write(6,*) 'K_EWNS(,3): ', K_EWNS(1,3), K_EWNS(2,3),K_EWNS(3,3)
!        write(6,*) 'K_EWNS(,4): ', K_EWNS(1,4), K_EWNS(2,4),K_EWNS(3,4)
!        write(6,*) '            ' 
!
!       STOP
!
      Return
      End
      SUBROUTINE NUTG (CENT, FA2K, FAD2K, XJD, TT, TSKIP, EPS,         &
     &           EPSMNR, RPN2K6, X06, Y06, S06) 
!
      IMPLICIT None
!
! 4.    NUTG
!
! 4.1   NUTG PROGRAM SPECIFICATION
!
! 4.1.1 NUTG IS THE NUTATION MODULE GEOMETRY SECTION. IT CALCULATES THE 
!       NUTATION PORTION OF THE COMPLETE CRUST FIXED TO J2000.0 ROTATION 
!       MATRIX AND ITS CT TIME DERIVATIVE. 
!
! 4.1.3 REFERENCES -
!       1) 'THE EXPLANATORY SUPPLEMENT TO THE AMERICAN EPHEMERIS AND
!          NAUTICAL ALMANAC", P. 41-45, 98.
!       2) 'SPHERICAL AND PRACTICAL ASTRONOMY AS APPLIED TO GEODESY', I.
!          MUELLER, 1969, P. 68-75. (NOTE: THE REFERENCE IN MUELLER REFERS
!          TO THE COMPUTATION OF THE NUTATION PORTION OF THE COMPLETE
!          J2000.0 TO CRUST FIXED ROTATION MATRIX. HOWEVER, CALC REQUIRES
!          THE TRANSPOSE OF THIS MATRIX. CARE MUST BE TAKEN WHEN COMPARING
!          THIS REFERENCE TO THE FOLLOWING PROGRAM.)
!       3) LIESKE, J.H., ET AL., EXPRESSIONS FOR THE PRECESSIONAL QUANTITIES
!          BASED ON THE IAU (1976) SYSTEM OF ASTRONOMICAL CONSTANTS, ASTRON.
!          ASTROPHYS. 58, 1-16, 1977.
!       4) IERS Technical Note 32, IERS Conventions (2003).
!       5) IERS Technical Note 36, IERS Conventions (2010).
!
! 4.2   NUTG PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!              1. CENT      -  The number of Julian centuries elapsed since the
!                              epoch January 1.5, 2000. (centuries)
!                              Now uses TT.
!              2. FA2K(14)  -  The fundamental arguments. (arcsec)
!              3. FAD2K(14) -  The CT time derivatives of the fundamental
!                              arguments. (arcsec/century)
!              4. XJD       -  The Julian Date at zero hours UTC of the
!                              observation.
!              6. TSKIP     -  Skip nutation recomputation if TSKIP=1.
!              7. TT        -  Terrestrial time fraction of the day.
!           OUTPUT VARIABLES:
!              1. X06(2)    -  X-component of the CIP (Celestial
!                              Intermediate Pole) in the GCRS (Geocentric
!                              Celestial Reference System), and its time
!                              derivative. (Radians, Radians/sec)
!              2. Y06(2)    -  Y-component of the CIP (Celestial
!                              Intermediate Pole) in the GCRS (Geocentric
!                              Celestial Reference System), and its time
!                              derivative. (Radians, Radians/sec)
!              3. S06(2)    -  Position of the CEO (Celestial Ephemeris
!                              Origin) on the equator of the CIP, and its
!                              time derivative. (Radians, Radians/sec)
!                              TIME DERIVATIVE. (RAD, RAD/SEC)
!              4. RPN2K6(3,3,2)-The Bias Precession Nutation portion of
!                              the complete Fixed to J2000.0 rotation
!                              matrix and its CT time derivative,
!                              consistent with the IERS Conventions
!                              (2003). (unitless, 1/sec)
!
!      Program Variables:
!              1. DEPS2K6(2) - The nutation in obliquity and its TT time
!                              derivative computed from the IAU2006/2000A 
!                              Precession/Nutation model. (rad, rad/sec) 
!              2. DPSI2K6(2) - The nutation in longitude and its TT time
!                              derivative computed from the IAU2006/2000A
!                              Precession/Nutation model. (rad, rad/sec) 
!              3. DEPS2K(2)  - The nutation in obliquity and its TT time
!                              derivative computed from the IAU2000/2000A 
!                              Precession/Nutation model. (rad, rad/sec) 
!              4. DPSI2K(2)  - The nutation in longitude and its TT time
!                              derivative computed from the IAU2000/2000A
!                              Precession/Nutation model. (rad, rad/sec) 
!              5. DPSI(2) -    The nutation in longitude and its TT time
!                              derivative as computed using the IAU1976/1980
!                              Precession/Nutation models (Wahr nutation).
!                              (arcsec, arcsec/sec)
!              6. DEPS(2) -    The nutation in obliquity and its TT time
!                              derivative as computed using the IAU1976/1980
!                              Precession/Nutation models (Wahr nutation).
!                              (arcsec, arcsec/sec)
!
! 4.2.2 COMMON BLOCKS USED -
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!           VARIABLES 'FROM':
!              1. CONVDS  -  THE CONVERSION FACTOR OF RADIANS PER ARCSECOND.
!                            (RAD/ARCSEC)
!              2. SECDAY  -  THE NUMBER OF COORDINATE TIME SECONDS PER
!                            COORDINATE TIME DAY.  (SEC/DAY)
!
      Real*8 CENTJ, DJ2000
      COMMON / NUTCM / CENTJ, DJ2000
!            VARIABLES 'FROM':
!              1. CENTJ  -  THE NUMBER OF COORDINATE TIME DAYS PER JULIAN
!                           CENTURY. (DAYS/CENTURY)
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KNUTC - THE NUTATION MODULE FLOW CONTROL FLAG.
!                         KNUTC = 0 TO TURN ON THE IERS 1996 NUTATION MODEL
!                         KNUTC = 1 TO TURN OFF THE NUTATION MODULE
!              2. KNUTD - THE NUTATION MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables to:
!        1. NUT6XYS(3,2) - Variable used to hold the X, Y, and S nutation
!                          values computed using the IAU2000/2006 
!                          Nutation/Precession models, and 'PUT' into the
!                          'NUT06XYS' database access code. 
!        2. NUT2006(2,2) - Variable used to hold the IAU2006/2000A 
!                          classical nutation values (DPSI and DEPS) and 
!                          their time derivatives. (rad, rad/sec)
!        3. NUTWAHR(2,2) - Variable used to hold the Wahr DPSI and DEPS and
!                          their time derivatives. (rad, rad/sec)
!
      INCLUDE 'cuser11.i'
!       Variables from:
!        1. C_mode - Character*6 variable that determines the type of
!                    usage. 
!                     'mark3 ' for regular calc (geodetic databases).
!                     'difx  ' for difx correlator usage (dcalc).
!                     'nusolv' for future nuSolve usage.
!     
!************************************************************************
! 4.2.3 PROGRAM SPECIFICATIONS -
      REAL*8 CENT,xFA(5),xFAD(5),xFUNDARG(28), FA2K(14), FAD2K(14)
      Real*8 EPS(2), EPSMN(2), EPSMNR, DCENT            
      Real*8 XJD, CT, EPSA(2), DPSI(2), DEPS(2)
      Real*8 TT, X06(2), Y06(2), S06(2)
      Real*8 RBPN6(3,3), dRBPN6(3,3), RPN2K6(3,3,2)
      Real*8 DPSI2K(2), DEPS2K(2), DPSI2K6(2), DEPS2K6(2), FJ2, dFJ2
      Integer*4 TSKIP, M, N, II, JJ
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
! 4.2.4 DATA BASE ACCESS - None, moved to subroutine PUT_G.
!
! 4.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVR
!             CALLED SUBROUTINES: DROTT, MADD3, MMUL3, ROTAT, NUTW
!
! 4.2.7 CONSTANTS USED - CONVDS, CENTJ, DJ2000, SECDAY
!
! 4.2.8 PROGRAM VARIABLES -
!         1. DCENT     -  THE CT TIME DERIVATIVE OF THE VARIABLE CENT.
!                         (CENTURIES/SEC)
!
! 4.2.9 PROGRAMMER
!        77.01.13  DALE MARKHAM
!        77.07.12  PETER DENATALE
!        78.03.15  BRUCE SCHUPLER
!        79.02.01  BRUCE SCHUPLER
!        79.06.06  BRUCE SCHUPLER
!        81.08.04  CHOPO MA
!        81.08.24  JIM RYAN
!        89.06.30  Jim Ryan: Documetation clean up.
!        89.12.12  Jim Ryan: UNIX-like database interface implemented
!        93.09.01  Norbert Zacharias: put parts of NUTG,NUTW into NUTFA
!                  for equation of equinox update EQE
!        94.04.15  David Gordon: Converted to Implicit None.
!        98.02.03  D. Gordon: Default changed to IERS 1996 Nutation. Call to
!                  Subroutine KSV_1996 (from Tom Herring, modified at USNO)
!                  added. Added PUT for 'NUT 1996'. Other minor mods.
!        98.11.12  D. Gordon: Added code to compute the correction in longitude
!                  for the effect of geodesic nutation, according to Fukushima
!                  (IERS Conventions (1996), page 37).
!       2002.09    J. Ryan: Integer*4 conversion.
!       2003/2004  David Gordon: Mods for IERS Conventions 2003.
!       Aug. 2012  David Gordon: Mods for IERS Conventions 2010.
!       Dec. 2012  David Gordon: Removed IAU2000 Nutation/Precession.
!                  Moved 'PUT' to PUT_G. 
!       2014.01.09 David Gordon: Put back the classical nutation
!                  (psi and epsilon) computation (from Calc10). Added
!                  code to convert it to the IAU2006 Precession 
!                  model values. Also added back the Wahr nutation
!                  computation. These are needed in Solve to get 
!                  classical nutation adjustments with respect to the
!                  old Wahr model. 
!
!  NUTG PROGRAM STRUCTURE
!
!  Compute the CT time derivative of CENT.
      DCENT = 1.D0 / ( CENTJ * SECDAY )
!
!********************************************************************
!  Obtain the CEO-based bias-precession-nutation matrix.
!
      IF(TSKIP.EQ.1) GO TO 665
!
!  Compute the X,Y,S nutation/precession values using the IAU2000A/2006
!   Nutation/Precession models.
      CALL  XY2K6 (XJD,TT,CENT,DCENT,FA2K,FAD2K,X06,Y06)
      CALL  S02K6 (XJD,TT,CENT,DCENT,FA2K,FAD2K,X06,Y06,S06)
!
        NUT6XYS(1,1) = X06(1)
        NUT6XYS(1,2) = X06(2)
        NUT6XYS(2,1) = Y06(1)
        NUT6XYS(2,2) = Y06(2)
        NUT6XYS(3,1) = S06(1)
        NUT6XYS(3,2) = S06(2)
!   Compute the intermediate-to-GCRS rotation matrix
      CALL BPN2K(X06, Y06, S06, RBPN6, dRBPN6 )
      Do II = 1,3
       Do JJ = 1,3
        RPN2K6(II,JJ,1) =  RBPN6(II,JJ)
        RPN2K6(II,JJ,2) = dRBPN6(II,JJ)
       Enddo
      Enddo
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  In order to continue generating the eops file, we need to compute some
!   obsolete nutation quantities. These are needed for geodetic analysis
!   only. Skip for correlator version.
       IF (C_mode .eq. 'difx  ') Go to 665 
!
!   Compute the classical Wahr nutation model values. 
        CALL NUTW (CENT, DPSI, DEPS)
         DPSI(1) = DPSI(1) * CONVDS
         DEPS(1) = DEPS(1) * CONVDS
         DPSI(2) = DPSI(2) * CONVDS
         DEPS(2) = DEPS(2) * CONVDS
        NUTWAHR(1,1) = DPSI(1)
        NUTWAHR(1,2) = DPSI(2)
        NUTWAHR(2,1) = DEPS(1)
        NUTWAHR(2,2) = DEPS(2)
!
! Compute the classical nutation with respect to IAU2006/2000 P/N.
!   First compute IAU2000A nutation:
        CALL NU2KA (CENT,DCENT,XJD,CT,FA2K,FAD2K,DPSI2K,DEPS2K)
!   Then compute corrections for 2006 Precession
!      Factor for secular variation of J2:
        FJ2  = -2.7774D-6 * CENT
        dFJ2 = -2.7774D-6 * DCENT
!      Apply P03 adjustments:
        DPSI2K6(1) = DPSI2K(1) + DPSI2K(1)*(.4697D-6 + FJ2)
        DPSI2K6(2) = DPSI2K(2) + DPSI2K(1)*dFJ2 + DPSI2K(2)*(.4697D-6+FJ2)
        DEPS2K6(1) = DEPS2K(1) + DEPS2K(1)*FJ2
        DEPS2K6(2) = DEPS2K(2) + DEPS2K(1)*dFJ2 + DEPS2K(2)*FJ2
!
        NUT2006(1,1) = DPSI2K6(1)
        NUT2006(1,2) = DPSI2K6(2)
        NUT2006(2,1) = DEPS2K6(1)
        NUT2006(2,2) = DEPS2K6(2)
!
!     WRITE(6,8)'            '                     
!     WRITE(6,8)' CENT,DCENT ', CENT,DCENT
!     WRITE(6,8)' FJ2, dFJ2  ', FJ2, dFJ2 
!     WRITE(6,8)' DPSI(1),DEPS(1) (mas) ', DPSI(1)*1.D3/CONVDS, DEPS(1)*1.D3/CONVDS 
!     WRITE(6,8)' DPSI2K(1),DEPS2K(1)   ', DPSI2K(1)*1.D3/CONVDS, DEPS2K(1)*1.D3/CONVDS 
!     WRITE(6,8)' DPSI2K6(1),DEPS2K6(1) ', DPSI2K6(1)*1.D3/CONVDS,DEPS2K6(1)*1.D3/CONVDS 
!     WRITE(6,8)'            '                     
!     WRITE(6,8)' DPSI(2),DEPS(2) (mas) ', DPSI(2)*1.D3/CONVDS, DEPS(2)*1.D3/CONVDS 
!     WRITE(6,8)' DPSI2K(2),DEPS2K(2)   ', DPSI2K(2)*1.D3/CONVDS, DEPS2K(2)*1.D3/CONVDS 
!     WRITE(6,8)' DPSI2K6(2),DEPS2K6(2) ', DPSI2K6(2)*1.D3/CONVDS,DEPS2K6(2)*1.D3/CONVDS 
!     WRITE(6,8)'            '                     
!     WRITE(6,8)' DPSI(1),DEPS(1) (rad)', DPSI(1), DEPS(1)
!     WRITE(6,8)' DPSI2K(1),DEPS2K(1)  ', DPSI2K(1), DEPS2K(1)
!     WRITE(6,8)'            '                     
!     WRITE(6,8)' DPSI(2),DEPS(2) (rad)', DPSI(2), DEPS(2)
!     WRITE(6,8)' DPSI2K(2),DEPS2K(2)  ', DPSI2K(2), DEPS2K(2)
!
 665   Continue
!
!  Nutation 'PUT' moved to PUT_G.
!
!
!  Check KNUTC to determine if the nutation module is to be turned off.
      IF ( KNUTC .EQ. 1 )  THEN
!   Set the position portion of the nutation matrix to the identity matrix.
       CALL ROTAT ( 0.D0, int2(3), RPN2K6(1,1,1))
!   Set the velocity portion of the nutation matrix to 0.0D0.
       DO 600 N=1,3
         DO 600 M=1,3
          RPN2K6(M,N,2) = 0.0D0
  600  CONTINUE
      ENDIF
!
!   Check KNUTD for debug output.
  700 IF (KNUTD .EQ. 0) GO TO 800
      WRITE (6,9100)
 9100 FORMAT (1X, "Debug output for subroutine NUTG." )
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' CENT    ',CENT
      WRITE(6,8)' DCENT   ',DCENT
      WRITE(6,8)' CENTJ   ',CENTJ
      WRITE(6,8)' SECDAY  ',SECDAY
      WRITE(6,8)' CONVDS  ',CONVDS
      WRITE(6,8)' NUT6XYS ',NUT6XYS
      Write(6,1019) RPN2K6
 1019 Format(1x,'RPN2K6, CEO-based Nutation Matrix:',(6(/,3E25.15)))
!
  800 RETURN
      END
!********************************************************************
        SUBROUTINE NUTP (CFBASE, Xn, Yn, Sn, STAR, RPN2K6, RS2K, RW2K,  &
     &                   TSKIP)
        IMPLICIT None
!
! 5.    NUTP
!
! 5.1   NUTP PROGRAM SPECIFICATION
!
! 5.1.1 NUTP IS THE NUTATION MODULE PARTIAL DERIVATIVES SECTION. NUTP COMPUTES
!       THE PARTIAL DERIVATIVES OF THE DELAY AND OF THE DELAY RATE W.R.T. the
!       X and Y precession/nutation at the epoch of the observation.
!
! 5.1.2 RESTRICTIONS - NONE
!
! 5.1.3 REFERENCES - 1) IERS Conventions 2010
!                    2) SOFA library.
!
! 5.2   NUTP PROGRAM INTERFACE
!
! 5.2.1 CALLING SEQUENCE -
!
!          INPUT VARIABLES:
!             1. CFBASE(3) -  THE CRUST FIXED BASELINE VECTOR. (M)
!             3. Xn(2)     -  X-component of the CIP (Celestial
!                             Intermediate Pole) in the GCRS (Geocentric
!                             Celestial Reference System), and its time
!                             derivative. (Radians, Radians/sec)
!             4. Yn(2)     -  Y-component of the CIP (Celestial
!                             Intermediate Pole) in the GCRS (Geocentric
!                             Celestial Reference System), and its time
!                             derivative. (Radians, Radians/sec)
!             5. Sn(2)     -  Position of the CEO (Celestial Ephemeris
!                             Origin) on the equator of the CIP, and its
!                             time derivative. (Radians, Radians/sec)
!            10. STAR(3)   -  THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!            11. RPN2K6(3,3,2)-THE PRECESSION-NUTATION PORTION OF THE CRUST
!                             FIXED TO J2000.0 ROTATION MATRIX and it first
!                             time derivative. (unitless, 1/sec)
!                             Updated to use 2000/2006 Nut/Prec models.
!            12. RS2K(3,3,3)- THE DIURNAL SPIN PORTION OF THE COMPLETE CRUST
!                             FIXED TO J2000.0 ROTATION MATRIX AND ITS FIRST
!                             two CT TIME DERIVATIVEs. (UNITLESS, 1/SEC)
!            13. RW2K(3,3,2)- THE WOBBLE PORTION OF THE COMPLETE CRUST FIXED
!                             TO J2000.0 ROTATION MATRIX and its time
!                             derivative. (unitless, 1/sec)
!            18. TSKIP      - Skip recomputations if TSKIP=1.
!
!          OUTPUT VARIABLES:
!             1. DN   (2,2) - PARTIAL DERIVATIVES OF THE DELAY AND RATE
!                             W.R.T  (SEC/RAD, SEC/SEC/RAD)
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!           VARIABLES 'FROM':
!              1. KNUTC - THE NUTATION MODULE FLOW CONTROL FLAG.
!              2. KNUTD - THE NUTATION MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'cphys11.i'
!           VARIABLES 'FROM':
!              1.  VLIGHT - THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!
      INCLUDE 'put2s.i'
!       Variables to:
!         1. DNUXY(2,2) - Partial derivatives of the delay and rate
!                             w.r.t. X and Y CEO-based nutation.
!
! 5.2.3 PROGRAM SPECIFICATIONS -
      Real*8 CFBASE(3),         RDNP(3,3), STAR(3),                     &
     &       RPN2K6(3,3,2),RS2K(3,3,3),RW2K(3,3,2),Xn(2),Yn(2),Sn(2)
      Real*8 DOTP
      REAL*8 RBPNX(3,3,2),RBPNY(3,3,2)
      REAL*8 R2KX(3,3,3), R2KY(3,3,3),                                  &
     &       pBL_X(3,2),pBL_Y(3,2)
      REAL*8 dRX1(3,3), dRX2(3,3), dRX3(3,3), ddRX1(3,3), ddRX2(3,3),   &
     &       ddRX3(3,3), ddRX4(3,3), ddRX11(3,3), ddRX12(3,3),          &
     &       ddRX13(3,3), dRY1(3,3), dRY2(3,3), dRY3(3,3), ddRY1(3,3),  &
     &       ddRY2(3,3), ddRY3(3,3), ddRY4(3,3), ddRY11(3,3),           &
     &       ddRY12(3,3), ddRY13(3,3)
      Integer*4 TSKIP, N
       SAVE  R2KX, R2KY
!
! 5.2.4 DATA BASE ACCESS => Moved to PUT_P.
!
! 5.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVR
!             CALLED SUBROUTINES: MMUL3, MADD3, VECRT
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES -
!          1. RBPNX(3,3,2)  - Partial derivative of RPN2K6 w.r.t. X nutation.
!          2. RBPNY(3,3,2)  - Partial derivative of RPN2K6 w.r.t. Y nutation.
!          3. R2KX(3,3,3)   - Partial derivative of R2K w.r.t. X nutation.
!          4. R2KY(3,3,3)   - Partial derivative of R2K w.r.t. Y nutation.
!         10. pBL_X(3,2)    - Partial derivatives of the baseline vector
!                             w.r.t. X nutation.
!         11. pBL_Y(3,2)    - Partial derivatives of the baseline vector
!                             w.r.t. Y nutation.
!
! 5.2.9 PROGRAMMER - DOUG ROBERTSON 09/07/82
!                    GEORGE KAPLAN 04/24/84
!                    DAVID GORDON 11/13/84 REDIMENSIONED NUT# PART AND DNUTPT
!                    Jim Ryan     89:10:05 CPHYS common made an include file
!                    Jim Ryan     89.12.12 UNIX-like database interface
!                                 implimented.
!                    David Gordon 94.04.15 Converted to Implicit None.
!                    David Gordon 95.12.11 Changed RW(3,3) to RW(3,3,2).
!                    David Gordon 95.12.12 RS improperly dimensioned as
!                                 (3,3,2). Changed to (3,3,3). RP and RN
!                                 improperly dimensioned as (3,3). Changed to
!                                 (3,3,2).
!                    David Gordon 98.02.03  Removed DNUTPT and computation
!                                 and PUT's of 'NT1 PART', 'NT2 PART', etc.
!                    Jim Ryan 2002.09 Integer*4 conversion.
!                    David Gordon 2003-2004 Mods for 2003 IERS Conventions.
!                    David Gordon Aug. 2012 Mods for 2010 IERS Conventions.
!                    David Gordon Jan. 2013 Moved PUT into subroutine PUT_P.
!
! 5.3   NUTP PROGRAM STRUCTURE
!
!  Start New Code
!
!    Skip site independent computations if same time as previous obs.
       IF(TSKIP.EQ.1) GO TO 150
!
!    Compute partial derivatives of the IERS2000/2006 CEO Bias/Prec/Nut
!     rotation matrix (RPN2K6) w.r.t. X and Y.
      CALL BPN2KP(Xn,Yn,Sn,RBPNX,RBPNY)
!
!    Compute partial derivatives of the IERS2000 CEO-based transformation
!     matrix (R2K) w.r.t. the X and Y nutation quantities.
!
!   Partials of R2K6(1,1,1).
      CALL MMUL3 (RBPNX(1,1,1), RS2K(1,1,1), RW2K(1,1,1), R2KX(1,1,1))
      CALL MMUL3 (RBPNY(1,1,1), RS2K(1,1,1), RW2K(1,1,1), R2KY(1,1,1))
!
!   Partials of first time derivative, R2K6(1,1,2).
      CALL MMUL3 ( RBPNX(1,1,2), RS2K(1,1,1), RW2K(1,1,1), dRX1 )
      CALL MMUL3 ( RBPNX(1,1,1), RS2K(1,1,2), RW2K(1,1,1), dRX2 )
      CALL MMUL3 ( RBPNX(1,1,1), RS2K(1,1,1), RW2K(1,1,2), dRX3 )
      CALL MADD3 ( dRX1, dRX2, dRX3, R2KX(1,1,2 ) )
!
      CALL MMUL3 ( RBPNY(1,1,2), RS2K(1,1,1), RW2K(1,1,1), dRY1 )
      CALL MMUL3 ( RBPNY(1,1,1), RS2K(1,1,2), RW2K(1,1,1), dRY2 )
      CALL MMUL3 ( RBPNY(1,1,1), RS2K(1,1,1), RW2K(1,1,2), dRY3 )
      CALL MADD3 ( dRY1, dRY2, dRY3, R2KY(1,1,2 ) )
!
!!!!!!!!!!!!!!!! Second derivatives not needed !!!!!!!!!!!!!!!!!!!!!!!!!!!!
!   Partials of second time derivative, R2K6(1,1,3).
!
      CALL MMUL3 ( RBPNX(1,1,2), RS2K(1,1,2), RW2K(1,1,1), ddRX1 )
      CALL MMUL3 ( RBPNX(1,1,2), RS2K(1,1,1), RW2K(1,1,2), ddRX2 )
       CALL MADD2 (ddRX1, ddRX2, ddRX11)
!     CALL MMUL3 ( RBPNX(1,1,2), RS2K(1,1,2), RW2K(1,1,1), ddRX1 )
      CALL MMUL3 ( RBPNX(1,1,1), RS2K(1,1,3), RW2K(1,1,1), ddRX3 )
      CALL MMUL3 ( RBPNX(1,1,1), RS2K(1,1,2), RW2K(1,1,2), ddRX4 )
       CALL MADD3 (ddRX1, ddRX3, ddRX4, ddRX12)
!     CALL MMUL3 ( RBPNX(1,1,2), RS2K(1,1,1), RW2K(1,1,2), ddRX2 )
!     CALL MMUL3 ( RBPNX(1,1,1), RS2K(1,1,2), RW2K(1,1,2), ddRX4 )
       CALL MADD2 (ddRX2, ddRX4, ddRX13)
!     Complete the second derivative
      CALL MADD3 ( ddRX11, ddRX12, ddRX13, R2KX(1,1,3) )
!
      CALL MMUL3 ( RBPNY(1,1,2), RS2K(1,1,2), RW2K(1,1,1), ddRY1 )
      CALL MMUL3 ( RBPNY(1,1,2), RS2K(1,1,1), RW2K(1,1,2), ddRY2 )
       CALL MADD2 (ddRY1, ddRY2, ddRY11)
!     CALL MMUL3 ( RBPNY(1,1,2), RS2K(1,1,2), RW2K(1,1,1), ddRY1 )
      CALL MMUL3 ( RBPNY(1,1,1), RS2K(1,1,3), RW2K(1,1,1), ddRY3 )
      CALL MMUL3 ( RBPNY(1,1,1), RS2K(1,1,2), RW2K(1,1,2), ddRY4 )
       CALL MADD3 (ddRY1, ddRY3, ddRY4, ddRY12)
!     CALL MMUL3 ( RBPNY(1,1,2), RS2K(1,1,1), RW2K(1,1,2), ddRY2 )
!     CALL MMUL3 ( RBPNY(1,1,1), RS2K(1,1,2), RW2K(1,1,2), ddRY4 )
       CALL MADD2 (ddRY2, ddRY4, ddRY13)
!     Complete the second derivative
      CALL MADD3 ( ddRY11, ddRY12, ddRY13, R2KY(1,1,3) )
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
 150   Continue
!
!   Compute partials of the baseline vector and its first time
!    derivative with respect to X and Y.
          CALL VECRT(R2KX(1,1,1),CFBASE,pBL_X(1,1))
          CALL VECRT(R2KX(1,1,2),CFBASE,pBL_X(1,2))
          CALL VECRT(R2KY(1,1,1),CFBASE,pBL_Y(1,1))
          CALL VECRT(R2KY(1,1,2),CFBASE,pBL_Y(1,2))
!
!
!   Compute the partials of the delay and delay rate with respect to
!    X and Y.
!     X partials
          DNUXY(1,1) = DOTP(pBL_X(1,1),STAR) / VLIGHT
          DNUXY(1,2) = DOTP(pBL_X(1,2),STAR) / VLIGHT
!     Y partials
          DNUXY(2,1) = DOTP(pBL_Y(1,1),STAR) / VLIGHT
          DNUXY(2,2) = DOTP(pBL_Y(1,2),STAR) / VLIGHT
!
!   End New Code
!
 800      Continue
!
!     CHECK KNUTD TO DETERMINE IF DEBUG OUTPUT IS NECESSARY.
      If(KNUTD.EQ.0) GO TO 900
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine NUTP." )
       Write(6,1012) RBPNX
 1012 Format(' NUTP/RBPNX, Partials CEO Bias/Prec/Nut:',(6(/,3E25.15)))
       Write(6,1013) RBPNY
 1013 Format(' NUTP/RBPNY, Partials CEO Bias/Prec/Nut:',(6(/,3E25.15)))
       Write(6,1015) R2KX
 1015 Format(' NUTP/R2KX, X Partials R2K:',(6(/,3E25.15)))
       Write(6,1016) R2KY
 1016 Format(' NUTP/R2KY, Y Partials R2K:',(6(/,3E25.15)))
       Write(6,1035) pBL_X
 1035  Format(1x,' NUTP/pBL_X: ',(2(/,3E25.15)))
       Write(6,1036) pBL_Y
 1036  Format(1x,' NUTP/pBL_Y: ',(2(/,3E25.15)))
       Write(6,1039) DNUXY
 1039  Format(1x,' NUTP/DNUXY: ',(2(/,2E25.15)))
!
!   9.    NORMAL PROGRAM CONCLUSION.
!
  900 RETURN
      END
!***********************************************************************
      SUBROUTINE NUTC ()
      IMPLICIT None
!
! 1.    NUTC
!
! 1.1   NUTC PROGRAM SPECIFICATION
!
! 1.1.1 NUTC computes the contributions to convert from the IERS 1996 nutation
!       model back to the old IAU 1980 (Wahr) model, and places them in the
!       data base.
!
! 1.2   NUTC PROGRAM INTERFACE
!
!         Input variables:
!            1. NUTDIF(2,2) - Nutation difference: IAU1980 minus IAU2000A.
!                             First index over psi and epsilon; second
!                             index over difference and derivative of
!                             difference. (radians, radians/sec)
!            2. DNUpe(2,2)  - PARTIAL DERIVATIVES OF THE DELAY AND THE DELAY
!                             RATE W.R.T DPSI AND DEPS. (SEC/RAD,
!                             SEC/SEC/RAD)
!
        Real*8 NUTDIF(2,2), DNUpe(2,2)
!
! 1.2.2 COMMON BLOCKS USED
      INCLUDE 'ccon.i'
!
! 1.2.3 PROGRAM SPECIFICATIONS
!
! 1.2.4 DATA BASE ACCESS - NONE
!
! 1.2.5 EXTERNAL INPUT/OUTPUT - NONE
!
! 1.2.6 SUBROUTINE INTERFACE - NONE
!        Caller subroutine: DRIVR
!
! 1.2.7 CONSTANTS USED - NONE
!
! 1.2.8 PROGRAM VARIABLES
!
! 1.2.9 PROGRAMMER -
!         BRUCE SCHUPLER 11/2/77
!         D. Gordon 94.04.15 Converted to Implicit None.
!         D. Gordon 98.02.03  Documentation and code added to compute Wahr
!                   nutation contribution and place it in the data base.
!         D. Gordon 98.11.12  Computation and PUT of the delay and rate
!                   contributions for the Fukushima geodesic nutation in
!                   longitude correction, access code 'GDNUTCON'.
!         Jim Ryan 2002.09 Integer*4 conversion.
!         David Gordon 2003/2004 Mods for IERS Conventions 2003.
!         David Gordon Aug 2012 - Stub - no longer does anything.
!
! 1.3   NUTC PROGRAM STRUCTURE
!
!
      RETURN
      END
!***********************************************************************
      BLOCK DATA NUTCMM
      IMPLICIT None
!
! 7.    NUTBD
!
! 7.1   NUTBD PROGRAM SPECIFICATION
!
! 7.1.1 NUTBD IS THE NUTATION MODULE BLOCK DATA INITIALIZATION SECTION.
!       THE NUTATION SERIES IS ESTABLISHED HERE. THIS VERSION CONTAINS
!       THE 1980 IAU THEORY OF NUTATION, FROM THE WORK OF J. M. WAHR,
!       SPECIFICALLY, THE WAHR NUTATION SERIES FOR AXIS B OF GILBERT &
!       DZIEWONSKI EARTH MODEL 1066A.
!
! 7.1.3 REFERENCES - 1) 'THE EXPLANATORY SUPPLEMENT TO THE AMERICAN
!                    EPHEMERIS AND NAUTICAL ALMANAC", P. 41-45, 98
!
!                    2) LIESKE, J.H., ET AL., EXPRESSIONS FOR THE
!                    PRECESSIONAL QUANTITIES BASED ON THE IAU (1976)
!                    SYSTEM OF ASTRONOMICAL CONSTANTS,
!                    ASTRON. ASTROPHYS. 58, 1-16, 1977.
!
!                    3) SEIDELMANN, P. K., 1980 IAU THEORY OF NUTATION:
!                    THE FINAL REPORT OF THE IAU WORKING GROUP ON
!                    NUTATION, CELEST. MECH. 27, PP. 79-106 (1982).
!
!                    4) WAHR, J. M., THE FORCED NUTATIONS OF ... EARTH,
!                    GEOPHYS. J. ROY. ASTR. SOC. 64, PP. 705-727 (1981).
!
! 7.2   NUTBD PROGRAM INTERFACE
!
! 7.2.1 CALLING SEQUENCE - NONE
!
! 7.2.2 COMMON BLOCK -
!
!**   Real*8 CENTJ, DJ2000, EC(4), ARGP(2,6)
      Real*8 CENTJ, DJ2000
!**   Integer*4 NOT, NOP, IDP(6)
!**   COMMON / NUTCM / CENTJ, DJ2000, EC, ARGP, NOT, NOP, IDP
      COMMON / NUTCM / CENTJ, DJ2000
!           VARIABLES 'TO':
!              1. CENTJ   - THE NUMBER OF COORDINATE TIME DAYS PER JULIAN
!                           CENTURY. (DAYS/CENTURY) (CENTJ = 36525.D0)
!              2. DJ2000  - THE JULIAN DATE OF THE EPOCH JANUARY 1.5, 2000.
!                           (DAYS) (DJ2000 = 2451545.D0)
!              3. EC(4)   - THE CONSTANTS APPEARING IN TERMS 1-4 IN THE
!                           CALCULATION OF THE MEAN OBLIQUITY OF THE ECLIPTIC.
!                           (ARCSEC) (SEE REFERENCES)
!                           ( EC(1) = +8.4381448D4, EC(2) = -46.815D0,
!                             EC(3) = -5.9D-4, EC(4) = +1.813D-3 )
!              4. NOT     - THE NUMBER OF TERMS IN THE NUTATION SERIES.
!                           (NOT = 106)
!              5. X(9,120)- THE ARRAY CONTAINING THE NUTATION SERIES.
!                           (X = 1980 IAU THEORY OF NUTATION)
!              6. NOP     - THE NUMBER OF NUTATION TERMS DESIGNATED FOR WHICH
!                           PARTIALS ARE TO BE COMPUTED. (NOP = 6)
!                                  (Obsolete?)
!              7. IDP(6)  - IDENTIFICATION NUMBERS (TERM NUMBERS) OF DESIGNATED
!                           NUTATION TERMS FOR WHICH PARTIALS ARE TO BE COMPUTED
!                           ( IDP(1) =  1, IDP(2) =  2, IDP(3) =  3,
!                             IDP(4) =  4, IDP(5) =  5, IDP(6) =  7 )
!              8. ARGP(2,6)-ARGUMENTS (COMBINATIONS OF FUNDAMENTAL ARGUMENTS)
!                           AND THEIR DERIVATIVES OF DESIGNATED NUTATION TERMS
!                           FOR WHICH PARTIALS ARE TO BE COMPUTED.
!                           (COMPUTED IN NUTW. SET TO 0.0D0 HERE)
!                                  (Obsolete?)
!
! 7.2.3 PROGRAM SPECIFICATIONS -
!
      DATA  CENTJ  / 36525.D0 /, &
     &      DJ2000 / 2451545.D0 /
!**  &      EC     / 8.4381448D4, -46.8150D0, -5.9D-4, 1.813D-3 /, &
!**  &      NOT    / 106 /, &
!**  &      NOP    / 6 /, &
!**  &      IDP    / 1, 2, 3, 4, 5, 7 /, &
!**  &      ARGP   / 12 * 0.0D0 /
!***********************************************************************
!
! 7.2.4 CONSTANTS USED - CENTJ, DJ2000, EC(4), NOT, X(9,120),
!                    NOP, IDP(6), ARGP(2,6)
!
! 7.2.5 PROGRAMMER - DALE MARKHAM   01/13/77
!                    PETER DENATALE 07/12/77
!                    BRUCE SCHUPLER 12/22/77
!                    CHOPO MA       08/04/81
!                    GEORGE KAPLAN  04/24/84
!                    David Gordon   94.04.15 Converted to Implicit None.
!                    David Gordon   95.09.27 X(9,120) table changed from Real*4
!                                   to Real*8
!                    David Gordon   98.02.03 Removed X(9,120) from COMMON
!                                   /NUTCM/ and put it into COMMON /XWAHR/,
!                                   and removed it from most subroutines.
!                   David Gordon 2012.April/Oct. Removed Wahr nutation stuff.
!
! 7.3   NUTBD PROGRAM STRUCTURE - NONE
!
      END
!
!***********************************************************************
      SUBROUTINE NUTFA (XJD, TT, CT, CENT, FA2K, FAD2K)
      IMPLICIT NONE
!
!  NUTFA computes the number of Julian centuries since J2000 and the fundamental
!  arguments and derivatives to be used in the nutation series.
!
!  References: D.McCarthy, IERS Technical Note 32, IERS Conventions (2003).
!
!  Calling sequence:
!    input:
!           1. XJD  -  THE JULIAN DATE AT ZERO HOURS UTC OF THE DATE IN
!                      QUESTION. (DAYS)
!           2. CT   -  THE COORDINATE TIME FRACTION OF THE COORDINATE TIME DAY.
!                      (DAYS)
!           3. TT   -  Terrestrial Time (days).
!    output:
!           1. CENT -  The number of Julian centuries elapsed since the epoch
!                      January 1.5 2000.(centuries)
!           4. FA2K(14)- The fundamental arguments for the nutation theory,
!                      updated for the IERS Conventions 2003.  (radians)
!               1 = mean anomaly of the moon
!                 = mean longitude of the moon minus the
!                   mean longitude of the moon's perigee     (l)
!               2 = mean anomaly of the sun
!                 = mean longitude of the sun minus the
!                   mean longitude of the sun's perigee      (l')
!               3 = mean longitude of the moon minus omega   (F)
!               4 = mean elongation of the moon from the sun (D)
!               5 = longitude of the asc.node of the moon's
!                   mean orbit on the ecliptic,
!                   measured from the mean equinox of date   (omega)
!               6-13 = Planetary longitudes, Mercury through Neptune.
!               14  = General accumulated precession in longitude.
!           3. FAD2K(14)- The CT time derivatives of the fundamental arguments.
!                      (radians/second)
!
      REAL*8 XJD, TT, CT, CENT, EL, ELP, F, D, OM, SEC360, CENT2,CENT3, &
     &       CENT4, DAYSJ, ELC2(5), ELPC2(5), FC2(5),                   &
     &       DC2(5), OMC2(5), dTdt
      REAL*8 FA2K(14), FAD2K(14)
!
!**   Real*8 CENTJ, DJ2000, EC(4), ARGP(2,6)
      Real*8 CENTJ, DJ2000
!**   Integer*4 NOT, NOP, IDP(6)
!**   COMMON / NUTCM / CENTJ, DJ2000, EC, ARGP, NOT, NOP, IDP
      COMMON / NUTCM / CENTJ, DJ2000
!     Variables from:
!        1. CENTJ   -  The number of coordinate time days per Julian century.
!                      (days/century)
!        2. DJ2000  -  The Julian date of the epoch January 1.5, 2000. (days)
!
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!           VARIABLES 'FROM':
!              1. TWOPI   -  TWOPI
!              2. SECDAY  -  THE NUMBER OF COORDINATE TIME SECONDS PER
!                            COORDINATE TIME DAY. (SEC/DAY)
!
      INCLUDE 'ccon.i'
!     Variables from:
!        1. KNUTD  -  nutation module debug flag
!
!     Subroutine interface:
!       Caller subroutines: DRIVR, UT1I
!       Called subroutines: DMOD
!
!     Constants used -
!       ELC(5)   - COEFFICIENTS USED IN THE CALCULATION OF EL
!       ELPC(5)  - COEFFICIENTS USED IN THE CALCULATION OF ELP
!       FC(5)    - COEFFICIENTS USED IN THE CALCULATION OF F
!       DC(5)    - COEFFICIENTS USED IN THE CALCULATION OF D
!       OMC(5)   - COEFFICIENTS USED IN THE CALCULATION OF OM
!
      DATA SEC360 / 1296000.0D0 /       ! arcseconds in one turn
!
!     DATA statements for the revised fundamental arguments.
!     Simons et al., 1994 values
!      -Conform to IERS Conventions (2003)-
      DATA ELC2   / -0.00024470d0,       0.051635d0,  31.8792d0, &
     &          1717915923.2178d0,  485868.249036d0/
      DATA ELPC2  / -0.00001149d0,      +0.000136d0,  -0.5532d0, &
     &           129596581.0481d0,  1287104.793048d0/
      DATA FC2    /  0.00000417d0,      -0.001037d0, -12.7512d0, &
     &          1739527262.8478d0,  335779.526232d0/
      DATA DC2    / -0.00003169d0,       0.006593d0,  -6.3706d0, &
     &          1602961601.2090d0,  1072260.703692d0/
      DATA OMC2   /-0.00005939d0,        0.007702d0,   7.4722d0, &
     &           -6962890.5431d0,   450160.398036d0/
!
!  Programmer:
!    93.09.01  Norbert Zacharias - Fundamental arguments computation put into
!              separate subroutine, taken from old NUTG subroutine.
!    98.01.28  David Gordon - Coefficients and computations modified to conform
!              to IERS Conventions (1996).
!                    Jim Ryan 2002.09 Integer*4 conversion.
!    2003.     David Gordon - Revised for IERS Conventions (2003).
!    2012.     David Gordon - Revised for IERS Conventions (2010). CENT now
!                             computed using TT, terrestrial time.
!
!-------------------------------------------------------------------------------
!  Compute the number of Julian days elapsed since the epoch January 1.5, 2000.
!     DAYSJ = XJD + CT - DJ2000
      DAYSJ = XJD + TT - DJ2000
!  Derivative of CENT w.r.t. time (centuries/sec)
      dTdt = 1.D0/(CENTJ*86400.D0)
!
!  Compute the number of Julian centuries elapsed since the epoch January 1.5,
!   2000.
!     CENT  = ((XJD - DJ2000) + CT) / CENTJ
      CENT  = ((XJD - DJ2000) + TT) / CENTJ
      CENT2 = CENT * CENT
      CENT3 = CENT * CENT2
      CENT4 = CENT2 * CENT2
!
!-----------------------------------------------------------
!
!  Revised computation of the fundamental arguments and derivatives.
!   IERS Conventions (2003)
!
      EL = ELC2(1)*CENT4 + ELC2(2)*CENT3 + ELC2(3)*CENT2                &
     &   + ELC2(4)*CENT  + ELC2(5)
      FA2K(1)  = DMOD( EL, SEC360 )
      FAD2K(1) = 4.D0*ELC2(1)*CENT3 + 3.D0*ELC2(2)*CENT2                &
     &       + 2.D0*ELC2(3)*CENT  +      ELC2(4)
!
      ELP = ELPC2(1)*CENT4 + ELPC2(2)*CENT3 + ELPC2(3)*CENT2            &
     &    + ELPC2(4)*CENT  + ELPC2(5)
      FA2K (2) = DMOD( ELP, SEC360 )
      FAD2K(2) = 4.D0*ELPC2(1)*CENT3 + 3.D0*ELPC2(2)*CENT2              &
     &       + 2.D0*ELPC2(3)*CENT  +      ELPC2(4)
!
      F = FC2(1)*CENT4 + FC2(2)*CENT3 + FC2(3)*CENT2                    &
     &  + FC2(4)*CENT  + FC2(5)
      FA2K (3) = DMOD( F, SEC360 )
      FAD2K(3) = 4.D0*FC2(1)*CENT3 + 3.D0*FC2(2)*CENT2                  &
     &       + 2.D0*FC2(3)*CENT  +      FC2(4)
!
      D = DC2(1)*CENT4 + DC2(2)*CENT3 + DC2(3)*CENT2                    &
     &  + DC2(4)*CENT  + DC2(5)
      FA2K (4) = DMOD( D, SEC360 )
      FAD2K(4) = 4.D0*DC2(1)*CENT3 + 3.D0*DC2(2)*CENT2                  &
     &       + 2.D0*DC2(3)*CENT  +      DC2(4)
!
      OM = OMC2(1)*CENT4 + OMC2(2)*CENT3 + OMC2(3)*CENT2                &
     &   + OMC2(4)*CENT  + OMC2(5)
      FA2K (5) = DMOD( OM, SEC360 )
      FAD2K(5) = 4.D0*OMC2(1)*CENT3 + 3.D0*OMC2(2)*CENT2                &
     &       + 2.D0*OMC2(3)*CENT  +      OMC2(4)
!  Convert to radians and radians/sec:
      FA2K(1)  =  FA2K(1) * CONVDS
      FA2K(2)  =  FA2K(2) * CONVDS
      FA2K(3)  =  FA2K(3) * CONVDS
      FA2K(4)  =  FA2K(4) * CONVDS
      FA2K(5)  =  FA2K(5) * CONVDS
      FAD2K(1)  =  FAD2K(1) * CONVDS/(SECDAY*CENTJ)
      FAD2K(2)  =  FAD2K(2) * CONVDS/(SECDAY*CENTJ)
      FAD2K(3)  =  FAD2K(3) * CONVDS/(SECDAY*CENTJ)
      FAD2K(4)  =  FAD2K(4) * CONVDS/(SECDAY*CENTJ)
      FAD2K(5)  =  FAD2K(5) * CONVDS/(SECDAY*CENTJ)
!
!  Planetary longitudes, Mercury through Neptune (Souchay et al. 1999).
      FA2K( 6) = ( 4.402608842D0 + 2608.7903141574D0 * CENT )
        FA2K(6) = DMOD(FA2K(6),TWOPI)
      FA2K( 7) = ( 3.176146697D0 + 1021.3285546211D0 * CENT )
        FA2K(7) = DMOD(FA2K(7),TWOPI)
      FA2K( 8) = ( 1.753470314D0 +  628.3075849991D0 * CENT )
        FA2K(8) = DMOD(FA2K(8),TWOPI)
      FA2K( 9) = ( 6.203480913D0 +  334.0612426700D0 * CENT )
        FA2K(9) = DMOD(FA2K(9),TWOPI)
      FA2K(10) = ( 0.599546497D0 +   52.9690962641D0 * CENT )
        FA2K(10) = DMOD(FA2K(10),TWOPI)
      FA2K(11) = ( 0.874016757D0 +   21.3299104960D0 * CENT )
        FA2K(11) = DMOD(FA2K(11),TWOPI)
      FA2K(12) = ( 5.481293872D0 +    7.4781598567D0 * CENT )
        FA2K(12) = DMOD(FA2K(12),TWOPI)
      FA2K(13) = ( 5.311886287D0 +    3.8133035638D0 * CENT )
        FA2K(13) = DMOD(FA2K(13),TWOPI)
!  General accumulated precession in longitude.
      FA2K(14) = ( 0.024381750D0*CENT + 0.00000538691D0*CENT2)
!
      FAD2K( 6) = 2608.7903141574D0 * dTdt
      FAD2K( 7) = 1021.3285546211D0 * dTdt
      FAD2K( 8) = 628.3075849991D0 * dTdt
      FAD2K( 9) = 334.0612426700D0 * dTdt
      FAD2K(10) = 52.9690962641D0 * dTdt
      FAD2K(11) = 21.3299104960D0 * dTdt
      FAD2K(12) = 7.4781598567D0 * dTdt
      FAD2K(13) = 3.8133035638D0 * dTdt
      FAD2K(14) = (0.024381750D0 + 2.D0*0.00000538691D0*CENT) * dTdt
!
!  Debug output
      IF (knutd.NE.0) THEN
        WRITE (6,'(1x,a)') 'Debug output for subroutine NUTFA'
       WRITE (6,8) ' CENT,  ', cent
    8         FORMAT(A,4D25.16/(7X,5D25.16))
      Write (6,787) FA2K
 787  Format(' FA2K:',/,3(5E22.15,/))
      Write (6,788) FAD2K
 788  Format(' FAD2K:',/,3(5E22.15,/))
!
!     Write (6,778) FAD(1)*CONVDS/(SECDAY*CENTJ),
!    *   FAD(2)*CONVDS/(SECDAY*CENTJ),FAD(3)*CONVDS/(SECDAY*CENTJ),
!    *   FAD(4)*CONVDS/(SECDAY*CENTJ),FAD(5)*CONVDS/(SECDAY*CENTJ)
!778  Format(' NUTFA: FAD (rad/sec):',/, (5E22.15,/))
      ENDIF
!
      RETURN
      END
!*************************************************************************
      SUBROUTINE BPN2K ( X, Y, S, RBPN, dRBPN )
!
!  CEO-based bias-precession-nutation matrix.
!  Annexe to IERS Conventions 2000, Chapter 5
!
!  Given:
!     X(2),Y(2)        d      CIP coordinates and time derivatives
!     S(2)             d      the quantity s and time derivatives
!                             (radians)
!  Returned:
!     RBPN        d(3,3)   intermediate-to-celestial matrix ("Q")
!
!  Modified SOFA subroutine for use in Calc. Added time derivative
!  of bias-precession-nutation matrix.
!
!-----------------------------------------------------------------------
      IMPLICIT NONE
      DOUBLE PRECISION X(2), Y(2), S(2), RBPN(3,3)
      DOUBLE PRECISION X2, Y2, R2, R, Z, A, AXY, RR(3,3), RL(3,3)
      DOUBLE PRECISION dX2, dY2, dR2, dZ, dA, dAXY,dRR(3,3),dRL(3,3), &
     &                 RR1(3,3), RR2(3,3), dRBPN(3,3)
      Integer*2 Int1,Int2,Int3
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
         Int1 = 1
         Int2 = 2
         Int3 = 3
!
!  Prepare to evaluate expression (10).
      X2 = X(1)*X(1)
       dX2 = 2.D0*X(1)*X(2)
!       print *,' X2,dX2: ', X2,dX2
      Y2 = Y(1)*Y(1)
       dY2 = 2.D0*Y(1)*Y(2)
!       print *,' Y2,dY2: ', Y2,dY2
      R2 = X2 + Y2
       dR2 = dX2 + dY2
!       print *,' R2,dR2: ', R2,dR2
      R = DSQRT (R2)
      Z = DSQRT (1.D0 - R2)
       dZ = -dR2/(2.D0*DSQRT(1D0 - R2))
!       print *,'  Z, dZ: ',  Z, dZ
      A = 1D0 / ( 1.D0 + Z )
       dA = -dZ/(1.D0 + Z)**2
!       print *,'  A, dA: ',  A, dA
      AXY = A*X(1)*Y(1)
       dAXY = dA*X(1)*Y(1) + A*X(2)*Y(1) + A*X(1)*Y(2)
!       print *,' AXY,dAXY: ',  AXY,dAXY
!
!  Right-hand matrix.
      CALL ROTAT(S(1),Int3,RR)
      CALL DROTT(S(1),S(2),Int3,dRR)
!
!  Left-hand matrix.
      RL(1,1) = 1.D0-A*X2
      RL(1,2) = -AXY
      RL(1,3) = X(1)
      RL(2,1) = -AXY
      RL(2,2) = 1.D0-A*Y2
      RL(2,3) = Y(1)
      RL(3,1) = -X(1)
      RL(3,2) = -Y(1)
      RL(3,3) = 1.D0-A*R2
!
      dRL(1,1) = -dA*X2 - A*dX2
      dRL(1,2) = -dAXY
      dRL(1,3) = X(2)
      dRL(2,1) = -dAXY
      dRL(2,2) = -dA*Y2 - A*dY2
      dRL(2,3) = Y(2)
      dRL(3,1) = -X(2)
      dRL(3,2) = -Y(2)
      dRL(3,3) = -dA*R2 - A*dR2
!
!  The result is the product of the two matrices.
      CALL MMUL2 (RL, RR, RBPN)
!  Derivative of RBPN:
      CALL MMUL2 (dRL, RR, RR1)
      CALL MMUL2 (RL, dRR, RR2)
      CALL MADD2 (RR1, RR2, dRBPN)
!      Write(6,1012) RBPN,dRBPN
 1012  Format(1x,'BPN2K/RBPN,dRBPN:',(6(/,3E25.15)))
!
      RETURN
      END
!***************************************************************************
      SUBROUTINE BPN2KP ( X, Y, S, RBPNX, RBPNY )
!
!  CEO-based bias-precession-nutation matrix.
!  Given:
!     X(2),Y(2)        d      CIP coordinates
!     S(2)             d      the quantity s (radians)
!  Returned:
!     RBPN        d(3,3)   intermediate-to-celestial matrix ("Q")
!
!
!  Modified SOFA subroutine for use in Calc. Computes partial derivatives
!  of the bias-precession-nutation matrix and its time derivative w.r.t.
!  X and Y nutation.
!-----------------------------------------------------------------------
      IMPLICIT NONE
      DOUBLE PRECISION X(2), Y(2), S(2), RBPNX(3,3,2), RBPNY(3,3,2)
      DOUBLE PRECISION X2, Y2, R2, R, Z, A, AXY, RR(3,3), RL(3,3)
      DOUBLE PRECISION dX2, dY2, dR2, dZ, dA, dAXY,dRR(3,3),dRL(3,3), &
     &                 RR1(3,3), RR2(3,3), dRBPN(3,3)
      Double PRECISION p_X2_x, p_dX2_x,p_Y2_y,p_dY2_y,p_R2_x, &
     &       p_R2_y,p_dR2_x,p_dR2_y,p_Z_x,p_Z_y,p_dZ_x,p_dZ_y, &
     &       p_A_x,p_A_y,p_dA_x,p_dA_y,p_AXY_x,p_AXY_y,p_dAXY_x, &
     &       p_dAXY_y, RLX(3,3), RLY(3,3), &
     &       dRLX(3,3), dRLY(3,3)
      Integer*2 Int1,Int2,Int3
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
         Int1 = 1
         Int2 = 2
         Int3 = 3
!       print *,' X, Y, S: ',  X, Y, S
!
!  Prepare to evaluate expression (10).
      X2 = X(1)*X(1)
      dX2 = 2.D0*X(1)*X(2)
       p_X2_x = 2.D0*X(1)
       p_dX2_x = 2.D0*X(2)
!       print *,'X2,dX2: ', X2,dX2
!       print *,'p_X2_x,p_dX2_x: ', p_X2_x,p_dX2_x
!
      Y2 = Y(1)*Y(1)
      dY2 = 2.D0*Y(1)*Y(2)
       p_Y2_y = 2.D0*Y(1)
       p_dY2_y = 2.D0*Y(2)
!       print *,'Y2,dY2: ', Y2,dY2
!       print *,'p_Y2_y,p_dY2_y: ', p_Y2_y,p_dY2_y
!
      R2 = X2 + Y2
      dR2 = dX2 + dY2
       p_R2_x = p_X2_x
       p_R2_y = p_Y2_y
       p_dR2_x = p_dX2_x
       p_dR2_y = p_dY2_y
!       print *,'R2,dR2: ', R2,dR2
!       print *,'p_R2_x,p_dR2_x: ', p_R2_x,p_dR2_x
!       print *,'p_R2_y,p_dR2_y: ', p_R2_y,p_dR2_y
!
!     R = DSQRT (R2)
!
      Z = DSQRT (1.D0 - R2)
      dZ = -dR2/(2.D0*DSQRT(1D0 - R2))
       p_Z_x = -X(1)/Z
       p_Z_y = -Y(1)/Z
       p_dZ_x = -p_dX2_x/(2.D0*Z) + dR2*p_Z_x/(2.D0*(Z**2))
       p_dZ_y = -p_dY2_y/(2.D0*Z) + dR2*p_Z_y/(2.D0*(Z**2))
!       print *,'Z,dZ: ', Z,dZ
!       print *,'p_Z_x,p_dZ_x: ', p_Z_x,p_dZ_x
!       print *,'p_Z_y,p_dZ_y: ', p_Z_y,p_dZ_y
!
      A = 1D0 / ( 1.D0 + Z )
      dA = -dZ/(1.D0 + Z)**2
       p_A_x = -p_Z_x/(1.D0 + Z)**2
       p_A_y = -p_Z_y/(1.D0 + Z)**2
       p_dA_x = -p_dZ_x/(1.D0+Z)**2 + 2.D0*dZ*p_Z_x/(1.D0+Z)**3
       p_dA_y = -p_dZ_y/(1.D0+Z)**2 + 2.D0*dZ*p_Z_y/(1.D0+Z)**3
!       print *,'A,dA: ', A,dA
!       print *,'p_A_x,p_dA_x: ', p_A_x,p_dA_x
!       print *,'p_A_y,p_dA_y: ', p_A_y,p_dA_y
!
      AXY = A*X(1)*Y(1)
      dAXY = dA*X(1)*Y(1) + A*X(2)*Y(1) + A*X(1)*Y(2)
       p_AXY_x = p_A_x*X(1)*Y(1) + A*Y(1)
       p_AXY_y = p_A_y*X(1)*Y(1) + A*X(1)
       p_dAXY_x = p_dA_x*X(1)*Y(1) + dA*Y(1) + p_A_x*X(2)*Y(1) + &
     &            p_A_x*X(1)*Y(2) + A*Y(2)
       p_dAXY_y = p_dA_y*X(1)*Y(1) + dA*X(1) + p_A_y*X(2)*Y(1) + &
     &            A*X(2) + p_A_y*X(1)*Y(2)
!       print *,'AXY,dAXY: ', AXY,dAXY
!       print *,'p_AXY_x,p_dAXY_x: ', p_AXY_x,p_dAXY_x
!       print *,'p_AXY_y,p_dAXY_y: ', p_AXY_y,p_dAXY_y
!
!
!  Right-hand matrix.
      CALL ROTAT(S(1),Int3,RR)
      CALL DROTT(S(1),S(2),Int3,dRR)
!
!  Left-hand matrix w.r.t. X.
      RLX(1,1) = -p_A_x*X2 - A*p_X2_x
      RLX(1,2) = -p_AXY_x
      RLX(1,3) = 1.D0
      RLX(2,1) = -p_AXY_x
      RLX(2,2) = -p_A_x*Y2
      RLX(2,3) = 0.D0
      RLX(3,1) = -1.D0
      RLX(3,2) = 0.D0
      RLX(3,3) = -p_A_x*R2 - A*p_R2_x
!
      RLY(1,1) = -p_A_y*X2
      RLY(1,2) = -p_AXY_y
      RLY(1,3) = 0.D0
      RLY(2,1) = -p_AXY_y
      RLY(2,2) = -p_A_y*Y2 - A*p_Y2_y
      RLY(2,3) = 1.D0
      RLY(3,1) =  0.D0
      RLY(3,2) = -1.D0
      RLY(3,3) = -p_A_y*R2 - A*p_R2_y
!
!      dRLX(1,1) = -dA*X2 - A*dX2
      dRLX(1,1) = -p_dA_x*X2 - dA*p_X2_x - p_A_x*dX2 - A*p_dX2_x
      dRLY(1,1) = -p_dA_y*X2             - p_A_y*dX2
!      dRLX(1,2) = -dAXY
      dRLX(1,2) = -p_dAXY_x
      dRLY(1,2) = -p_dAXY_y
!      dRLX(1,3) =  X(2)
      dRLX(1,3) =  0.D0
      dRLY(1,3) =  0.D0
!      dRLX(2,1) = -dAXY
      dRLX(2,1) = -p_dAXY_x
      dRLY(2,1) = -p_dAXY_y
!     dRLX(2,2) = -dA*Y2 - A*dY2
      dRLX(2,2) = -p_dA_x*Y2 - p_A_x*dY2
      dRLY(2,2) = -p_dA_y*Y2 -dA*p_Y2_y - p_A_y*dY2 - A*p_dY2_y
!      dRLX(2,3) =  Y(2)
      dRLX(2,3) =  0.D0
      dRLY(2,3) =  0.D0
!      dRLX(3,1) = -X(2)
      dRLX(3,1) =  0.D0
      dRLY(3,1) =  0.D0
!      dRLX(3,2) = -Y(2)
      dRLX(3,2) =  0.D0
      dRLY(3,2) =  0.D0
!      dRLX(3,3) = -dA*R2 - A*dR2
      dRLX(3,3) = -p_dA_x*R2 - dA*p_R2_x - p_A_x*dR2 - A*p_dR2_x
      dRLY(3,3) = -p_dA_y*R2 - dA*p_R2_y - p_A_y*dR2 - A*p_dR2_y
!
!  The partials are the two matrices.
      CALL MMUL2 (RLX, RR, RBPNX(1,1,1))
      CALL MMUL2 (RLY, RR, RBPNY(1,1,1))
!  The partials of the derivative matrix w.r.t. X
      CALL MMUL2 (dRLX, RR, RR1)
      CALL MMUL2 (RLX, dRR, RR2)
      CALL MADD2 (RR1, RR2, RBPNX(1,1,2))
!  The partials of the derivative matrix w.r.t. Y
      CALL MMUL2 (dRLY, RR, RR1)
      CALL MMUL2 (RLY, dRR, RR2)
      CALL MADD2 (RR1, RR2, RBPNY(1,1,2))
!      Write(6,1012) RBPNdX
!1012  Format(1x,'RBPNdX:',(6(/,3E25.15)))
!      Write(6,1014) RBPNdY
!1014  Format(1x,'RBPNdY:',(6(/,3E25.15)))
      RETURN
      END
!*************************************************************************
      SUBROUTINE PEP ( XJD, ET, TSKIP, EARTH, SUN, XMOON )
      IMPLICIT None
!
! 4.    PEP
!
! 4.1   PEP PROGRAM SPECIFICATION
!
! 4.1.1 PEP is the utility which obtains the solar system geometry
!       from the JPL DE405/LE405 ephemeris. Positions and velocities
!       are obtained for the Sun, Moon, and all planets except Pluto.
!       Acceleration is also obtained for the Earth.
!
!       Users Note: The JPL DE405 ephemeris used here was created by
!       merging the two Unix binary ephemeris files for 1950-2000 and
!       2000-2050, obtained from the JPL site. We use the standard JPL
!       subroutines
!
!       PLEPH, STATE, INTERP, and SPLIT, with a few modifications, but all
!       unchanged from Calc 9.
!
!       October 2012: Now using the JPL DE421 ephemeris, little Endian
!       version.
!
! 4.1.2 RESTRICTIONS - None
!
! 4.1.3 REFERENCES - JPL anonymous FTP site
!                    ftp://ssd.jpl.nasa.gov/pub/eph/planets/ascii/421
!
! 4.2   PEP PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!           INPUT VARIABLES:
!             1.  XJD   - The Julian date at zero hours UTC of the date in
!                         question. (days)
!             2.  CT    - The coordinate time fraction of the coordinate time
!                         day (days).
!             3.  ET    - Ephemeris time (days). Using TDB at the geocenter.
!             4.  TSKIP - Flag telling whether to compute new values or use
!                         previous values. If TSKIP = 0 => new time, compute
!                         new values. If TSKIP = 1 => same time as previous
!                         observation, re-use previous values.
!
!           OUTPUT VARIABLES:
!             1. EARTH(3,3) - THE J2000.0 BARYCENTRIC EARTH POSITION, VELOCITY,
!                             AND ACCELERATION VECTORS. (M, M/SEC, M/SEC**2)
!                             (THE FIRST INDEX RUNS OVER THE VECTOR
!                             COMPONENTS, THE SECOND RUNS OVER THE POSITION,
!                             VELOCITY, AND ACCELERATION RESPECTIVELY.)
!             2. SUN(3,2)   - THE J2000.0 GEOCENTRIC SUN POSITION AND VELOCITY
!                             VECTORS. (M, M/SEC)
!             3. XMOON(3,2) - THE J2000.0 GEOCENTRIC MOON POSITION AND VELOCITY
!                             VECTORS. (M, M/SEC)
!
! 4.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'csolsys11.i'
!         VARIABLES 'TO':
!           1. SPLANET(3,2,7) - The J2000.0 Solar System Barycentric positions
!                               and velocities of all planets except the Earth
!                               and Pluto. (meters, meters/sec) The first index
!                               runs over X, Y, and Z, the second runs over
!                               position and velocity, and the third runs over
!                               the planets, where
!                                      1 = Mercury
!                                      2 = Venus
!                                      3 = Mars
!                                      4 = Jupiter
!                                      5 = Saturn
!                                      6 = Uranus
!                                      7 = Neptune
!           2. GPLANET(3,2,7) - The J2000.0 Geocentric positions and velocities
!                               of all planets except the Earth and Pluto.
!                               (meters, meters/sec) The first index runs over
!                               X, Y, and Z, the second runs over position and
!                               velocity, and the third runs over the planets,
!                               where
!                                      1 = Mercury
!                                      2 = Venus
!                                      3 = Mars
!                                      4 = Jupiter
!                                      5 = Saturn
!                                      6 = Uranus
!                                      7 = Neptune
!          3. SUNb(3,2)       - Barycentric Sun position and velocity.
!          4. MOONb(3,2)      - Barycentric Moon position and velocity.
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KPEPD - THE PEP UTILITY ROUTINE DEBUG OUTPUT FLAG.
!              2. KPEPC - The PEP module flow control flag (No options).
!
      INCLUDE 'put2s.i'
!       Variables to:
!         1. EARTH1(3,3) - THE J2000.0 BARYCENTRIC EARTH POSITION, VELOCITY,
!                          AND ACCELERATION VECTORS. (M, M/SEC, M/SEC**2)
!                          (THE FIRST INDEX RUNS OVER THE VECTOR
!                          COMPONENTS, THE SECOND RUNS OVER THE POSITION,
!                          VELOCITY, AND ACCELERATION RESPECTIVELY.)
!         2. SUN1(3,2)   - THE J2000.0 GEOCENTRIC SUN POSITION AND VELOCITY
!                          VECTORS. (M, M/SEC)
!         3. XMOON1(3,2) - THE J2000.0 GEOCENTRIC MOON POSITION AND VELOCITY
!                          VECTORS. (M, M/SEC)
!
!
! 4.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8  EARTH(3,3),SUN(3,2),XMOON(3,2)
      INTEGER*4 TSKIP, TARG, CENT, IPV, IERR, ITARG, I, K
      Real*8 XJD, TJD, CT, OBSDIF, ET
      Real*8  POS(3), VEL(3), RRD(6)
      Equivalence ( RRD(1), POS(1) )
      Equivalence ( RRD(4), VEL(1) )
      Real*8 tplus1, tminus1, rplus1(6), rminus1(6)
!
!     Real*8 unit_planet(3)
!     Real*8 S_planet, G_planet, x, y, z, DEC, DEC_min, DEC_sec, theta, &
!    &       RA, RA_hrs, RA_min, RA_sec, Vecmg
!     Integer*4 K_deg, K_min, I_hrs, I_min
!
! 4.2.4 DATA BASE ACCESS - None
!
! 4.2.5 EXTERNAL INPUT/OUTPUT - Possible debug and error output
!
! 4.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: PLEPH
!
! 4.2.7 CONSTANTS USED - NONE
!
! 4.2.8 PROGRAM VARIABLES -
!          1. Targ    - Integer number of the 'target' object in subroutine
!                       PLEPH (see PLEPH).
!          2. Cent    - Integer number of the reference point in subroutine
!                       PLEPH (see PLEPH). Here we use cent=12 ==> SSBC.
!          3. Pos(3)  - J2000 position of 'targ' with respect to 'cent', as
!                       returned by subroutine PLEPH. (km)
!          4. Vel(3)  - J2000 velocity of 'targ' with respect to 'cent', as
!                       returned by subroutine PLEPH. (km/sec)
!          5. TJD     - Time of the current observation (Julian days).
!
! 4.2.9 PROGRAMMER - KATHY WATTS    04/25/77
!                    PETER DENATALE 07/19/77
!                    BRUCE SCHUPLER 11/17/77
!                    BRUCE SCHUPLER 01/08/80
!                    CHOPO MA       08/04/81
!                    Jim Ryan 89.07.25 Documentation simplified.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                    implimented.
!                    David Gordon, Brent Archinal  Oct/Nov 1993 - Use of JPL
!                                  DE/LE200 ephemeris added for Sun, Moon, and
!                                  all planets except Pluto. New common block
!                                  /SOLSYS/ added to hold planetary information.
!                    David Gordon 94.01.07 Code added to compare time with
!                                 time of previous scan and skip solar system
!                                 ephemeris calculations if they are the same.
!                    David Gordon 94.04.18 Converted to Implicit None.
!                    David Gordon 94.06.07 Documentation expanded.
!                    David Gordon/Michael Kesteven 94.06.07 Mods for SUN and
!                                 DEC ALPHA compatibility: rrd(12) put in call
!                                 to PLEPH.
!                    David Gordon 98.02.05 DPSI and DEPS (database nutation)
!                                 removed. Computation repeat/no repeat logic
!                                 moved to DRIVG. Options to get Sun, Moon,
!                                 Earth from data base removed.
!                    David Gordon 98.07.13 Converted to read JPL DE/LE403
!                                 Ephemeris for compliance with the IERS 1996
!                                 Conventions. Old code would not work so
!                                 now using the standard JPL ephemeris
!                                 subroutines, with slight modifications.
!                                 Earth's acceleration obtained by doing a
!                                 numerical differentiation of the velocity
!                                 at +1/-1 second from the time tag epoch.
!                    David Gordon 99.01.14 Added PUT's for 'EARTH CE',
!                                 'SUN DATA', and 'MOONDATA' - Earth, Sun,
!                                 and Moon Coordinates. This is to avoid an
!                                 angry lynch mob after Dbedit is updated to
!                                 no longer put these in at data base creation
!                                 time.
!                   Jim Ryan 2002 Sept. Interger*4 updates.
!                   D. Gordon 2004.04.21 Updated to use DE405 ephemeris.
!                   D. Gordon 2012.10.17 Updated to use DE421 ephemeris, 
!                                 and to use TDB at geocenter as time
!                                 argument.
!                   D. Gordon Dec. 2012. EARTH, SUN, MOON moved to 'put2s.i'.
!                                 Moved all PUT's to subroutine PUT_G. 
!                                 
!
!     PEP Program Structure
!
!    Compute new values or use previous values?
       IF (TSKIP .eq. 1) Go to 510
!
!     Get the solar system geometry of the current observation from the
!     DE/LE405 file.
!
!--- CT of observation.
!     TJD = XJD + CT
!    Ephereris time of observation.
      TJD = XJD + ET
!
!   Get SSBC Earth position, velocity, and acceleration vectors
      targ=3       ! Earth
      cent=12      ! Barycentric
!
!  First get Earth position and velocity 1 second before and one second later
      tminus1 = tjd - 1.d0/8.64d4
      tplus1  = tjd + 1.d0/8.64d4
      call pleph(tminus1,targ,cent,rminus1)
      call pleph(tplus1,targ,cent,rplus1)
!
      call pleph(tjd,targ,cent,rrd)
      do i=1,3
        earth(i,1) = pos(i)*1.D3   !convert from km's to meters
        earth(i,2) = vel(i)*1.D3
        earth(i,3) = (rplus1(i+3) - rminus1(i+3))*1.D3 / 2.D0   !Acceleration
         earth1(i,1) = earth(i,1) 
         earth1(i,2) = earth(i,2) 
         earth1(i,3) = earth(i,3) 
      enddo
!
!   Get SSBC Sun position and velocity vectors
      targ=11      ! Sun
      cent=12      ! Barycentric
      call pleph(tjd,targ,cent,rrd)
!    Convert to geocentric coordinates
      do i=1,3
        sun(i,1) = pos(i)*1.D3 - earth(i,1)
        sun(i,2) = vel(i)*1.D3 - earth(i,2)
         sun1(i,1) = sun(i,1)
         sun1(i,2) = sun(i,2)
        SUNb(i,1) = pos(i)*1.D3    ! Barycentric Sun position
        SUNb(i,2) = vel(i)*1.D3    ! Barycentric Sun velocity
      enddo
!
!   Get SSBC Moon position and velocity vectors
      targ=10      ! Moon
      cent=12      ! Barycentric
      call pleph(tjd,targ,cent,rrd)
!    Convert to geocentric coordinates
      do i=1,3
        xmoon(i,1) = pos(i)*1.D3 - earth(i,1)
        xmoon(i,2) = vel(i)*1.D3 - earth(i,2)
         xmoon1(i,1) = xmoon(i,1) 
         xmoon1(i,2) = xmoon(i,2) 
        MOONb(i,1) = pos(i)*1.D3   ! Barycentric Moon position
        MOONb(i,2) = vel(i)*1.D3   ! Barycentric Moon velocity
      enddo
!
!    Get SSBC position and velocity vectors for all other planets except
!     Pluto (1=Mercury, 2=Venus, 3=Mars, 4=Jupiter, 5=Saturn, 6=Uranus,
!     and 7=Neptune)
       cent = 12     ! in SSBC coordinates
      Do itarg=1,7
        if (itarg.le.2)  targ = itarg     ! Mercury and Venus
        if (itarg.gt.2)  targ = itarg+1   ! Mars, Jupiter, etc. (skip Earth)
        call pleph(tjd,targ,cent,rrd)
!
        k = itarg      ! Planet index
        do i=1,3
          SPLANET(i,1,k) = pos(i)*1.D3                    ! SSBC position
          SPLANET(i,2,k) = vel(i)*1.D3                    ! SSBC velocity
          GPLANET(i,1,k) = SPLANET(i,1,k) - Earth(i,1)   ! Geocentric position
          GPLANET(i,2,k) = SPLANET(i,2,k) - Earth(i,2)   ! Geocentric velocity
        enddo
!
      Enddo
!
 510  Continue
!
!   PUT's  for Earth, Sun, and Moon coordinates moved to PUT_G.
!
!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
!
!   Test code to convert to RA and Dec. Keep for future usefulness.
!      do k = 1,7
!        S_planet = Vecmg(SPLANET(1,1,k)) / 1.4959787061D11   ! in AU's
!        G_planet = Vecmg(GPLANET(1,1,k)) / 1.4959787061D11   ! in AU's
!        write(6,'(" k, S_planet, G_planet = ",i3,2f12.7)')
!    .         k, S_planet, G_planet
!
!        call Vunit(GPLANET(1,1,k),unit_planet)
!        x = unit_planet(1)
!        y = unit_planet(2)
!        z = unit_planet(3)
!        write(6,'(" x, y, z = ",3f12.8)') x,y,z
!
!        DEC = DASIND(z)           ! Declination in degrees
!        DEC_min = (DEC - INT(DEC)) * 60.D0
!        DEC_sec = (DEC_min - INT(DEC_min)) * 60.D0
!        K_deg = DEC
!        K_min = DEC_min
!
!        theta = DATAND( DABS (y/x) )
!        if (x.ge.0 .and. y.ge.0) RA =  theta                ! RA in degrees
!        if (x.le.0 .and. y.ge.0) RA = -theta + 180.D0       ! RA in degrees
!        if (x.le.0 .and. y.le.0) RA =  theta + 180.D0       ! RA in degrees
!        if (x.ge.0 .and. y.le.0) RA = -theta + 360.D0       ! RA in degrees
!        RA_hrs = RA/15.D0
!        RA_min = (RA_hrs - INT(RA_hrs)) * 60.D0
!        RA_sec = (RA_min - INT(RA_min)) * 60.D0
!        I_hrs = RA_hrs
!        I_min = RA_min
!        write(6,'("   RA, hr, min, sec = ", F10.5,i5,i3,f6.2 )')
!    .        RA, I_hrs, I_min, RA_sec
!        write(6,'(" DEC, deg, min, sec = ", F10.5,i5,i3,f6.2 )')
!    .        DEC, K_deg, K_min, DEC_sec
!      enddo
!
!CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
!
!     Check KPEPD for debug output.
      IF ( KPEPD .ne. 0 )  Then
!
        WRITE (6,'(" Debug output for subroutine PEP.")')
!
!       write(6,'(2x," Ephemeris information from JPL DE/LE405", &
        write(6,'(2x," Ephemeris information from JPL DE421", &
     &        " Ephemeris:")')
        write(6,'("XJD, ET, TJD: ",3D25.16)') XJD, ET, TJD
        WRITE ( 6, 9200 )  EARTH, SUN, XMOON
 9200   FORMAT (1X, 'EARTH = ', 3 ( 3 ( D30.16, 10X ), /, 1X ), &
     &              'SUN   = ', 2 ( 3 ( D30.16, 10X ), /, 1X ), &
     &              'XMOON = ', 2 ( 3 ( D30.16, 10X ), /, 1X ) )
!
        do k = 1,7
          write(6,'(/)')
          write(6,'("SPLANET(",I1,") = ",3d25.16)') k, &
     &          SPLANET(1,1,k),SPLANET(2,1,k),SPLANET(3,1,k)
          write(6,'("SPLANET(",I1,") = ",3d25.16)') k, &
     &          SPLANET(1,2,k),SPLANET(2,2,k),SPLANET(3,2,k)
          write(6,'("GPLANET(",I1,") = ",3d25.16)') k, &
     &          GPLANET(1,1,k),GPLANET(2,1,k),GPLANET(3,1,k)
          write(6,'("GPLANET(",I1,") = ",3d25.16)') k, &
     &          GPLANET(1,2,k),GPLANET(2,2,k),GPLANET(3,2,k)
        enddo
!
      Endif
!
      RETURN
      END
!
!***************************************************************************
      SUBROUTINE PLEPH ( ET, NTARG, NCENT, RRD )
      Implicit None
!
!  The following code is from JPL with only a few necessary modifications:
!
!
!  NOTE : Over the years, different versions of PLEPH have had a fifth argument:
!  sometimes, an error return statement number; sometimes, a logical denoting
!  whether or not the requested date is covered by the ephemeris.  We apologize
!  for this inconsistency; in this present version, we use only the four
!  necessary arguments and do the testing outside of the subroutine.
!
!     THIS SUBROUTINE READS THE JPL PLANETARY EPHEMERIS AND GIVES THE
!     POSITION AND VELOCITY OF THE POINT 'NTARG' WITH RESPECT TO 'NCENT'.
!
!     CALLING SEQUENCE PARAMETERS:
!
!       ET = D.P. JULIAN EPHEMERIS DATE AT WHICH INTERPOLATION IS WANTED.
!
!       ** NOTE THE ENTRY DPLEPH FOR A DOUBLY-DIMENSIONED TIME **
!          THE REASON FOR THIS OPTION IS DISCUSSED IN THE SUBROUTINE STATE
!
!     NTARG = INTEGER NUMBER OF 'TARGET' POINT.
!     NCENT = INTEGER NUMBER OF CENTER POINT.
!
!            THE NUMBERING CONVENTION FOR 'NTARG' AND 'NCENT' IS:
!                1 = MERCURY           8 = NEPTUNE
!                2 = VENUS             9 = PLUTO
!                3 = EARTH            10 = MOON
!                4 = MARS             11 = SUN
!                5 = JUPITER          12 = SOLAR-SYSTEM BARYCENTER
!                6 = SATURN           13 = EARTH-MOON BARYCENTER
!                7 = URANUS           14 = NUTATIONS (LONGITUDE AND OBLIQ)
!                                     15 = LIBRATIONS, IF ON EPH FILE
!             (IF NUTATIONS ARE WANTED, SET NTARG = 14. FOR LIBRATIONS,
!              SET NTARG = 15. SET NCENT=0.)
!
!      RRD = OUTPUT 6-WORD D.P. ARRAY CONTAINING POSITION AND VELOCITY
!            OF POINT 'NTARG' RELATIVE TO 'NCENT'. THE UNITS ARE AU AND
!            AU/DAY. FOR LIBRATIONS THE UNITS ARE RADIANS AND RADIANS
!            PER DAY. IN THE CASE OF NUTATIONS THE FIRST FOUR WORDS OF
!            RRD WILL BE SET TO NUTATIONS AND RATES, HAVING UNITS OF
!            RADIANS AND RADIANS/DAY.
!
!            The option is available to have the units in km and km/sec.
!            For this, set km=.true. in the STCOMX common block.
!
      REAL*8  RRD(6),ET2Z(2),ET2(2),PV(6,13), ET, AU, EMRAT
      REAL*8  SS(3),CVAL(400),PVSUN(6)
!  BL1,BL2 added for padding. Common STCOMX rearranged.
      LOGICAL*2 BSAVE,KM,BARY, BL1,BL2
      LOGICAL*2 FIRST
      DATA FIRST/.TRUE./
      INTEGER*4 LIST(12), IPT(39), DENUM, NTARG, NCENT, NCON, I, K
!
      COMMON/EPHHDR/CVAL,SS,AU,EMRAT,DENUM,NCON,IPT
!     COMMON/STCOMX/KM,BARY,PVSUN
      COMMON/STCOMX/PVSUN, KM, BARY, BL1, BL2
!

      ET2(1)=0.D0
      IF(FIRST) CALL STATE(ET2,LIST,PV,RRD)
      FIRST=.FALSE.
!
!  INITIALIZE ET2 FOR 'STATE' AND SET UP COMPONENT COUNT
      ET2(1)=ET
      ET2(2)=0.D0
!     GO TO 11
!
!     ENTRY POINT 'DPLEPH' FOR DOUBLY-DIMENSIONED TIME ARGUMENT
!          (SEE THE DISCUSSION IN THE SUBROUTINE STATE)
!     ENTRY DPLEPH(ET2Z,NTARG,NCENT,RRD)
!     ET2(1)=ET2Z(1)
!     ET2(2)=ET2Z(2)
!
  11  DO I=1,6
      RRD(I)=0.D0
      ENDDO
!
!
  96  IF(NTARG .EQ. NCENT) RETURN
!
      DO I=1,12
      LIST(I)=0
      ENDDO
!
!   CHECK FOR NUTATION CALL
      IF(NTARG.NE.14) GO TO 97
        IF(IPT(35).GT.0) THEN
          LIST(11)=2
          CALL STATE(ET2,LIST,PV,RRD)
          RETURN
        ELSE
          WRITE(6,297)
  297     FORMAT(' *****  NO NUTATIONS ON THE EPHEMERIS FILE  *****')
          STOP
        ENDIF
!
!   CHECK FOR LIBRATIONS
  97  IF(NTARG.NE.15) GO TO 98
        IF(IPT(38).GT.0) THEN
          LIST(12)=2
          CALL STATE(ET2,LIST,PV,RRD)
          DO I=1,6
          RRD(I)=PV(I,11)
          ENDDO
          RETURN
        ELSE
          WRITE(6,298)
  298     FORMAT(' *****  NO LIBRATIONS ON THE EPHEMERIS FILE  *****')
          STOP
        ENDIF
!
!   FORCE BARYCENTRIC OUTPUT BY 'STATE'
  98  BSAVE=BARY
      BARY=.TRUE.
!
!   SET UP PROPER ENTRIES IN 'LIST' ARRAY FOR STATE CALL
      DO I=1,2
      K=NTARG
      IF(I .EQ. 2) K=NCENT
      IF(K .LE. 10) LIST(K)=2
      IF(K .EQ. 10) LIST(3)=2
      IF(K .EQ. 3) LIST(10)=2
      IF(K .EQ. 13) LIST(3)=2
      ENDDO
!
!   MAKE CALL TO STATE
      CALL STATE(ET2,LIST,PV,RRD)
!
      IF(NTARG .EQ. 11 .OR. NCENT .EQ. 11) THEN
      DO I=1,6
      PV(I,11)=PVSUN(I)
      ENDDO
      ENDIF
!
      IF(NTARG .EQ. 12 .OR. NCENT .EQ. 12) THEN
      DO I=1,6
      PV(I,12)=0.D0
      ENDDO
      ENDIF
!
      IF(NTARG .EQ. 13 .OR. NCENT .EQ. 13) THEN
      DO I=1,6
      PV(I,13)=PV(I,3)
      ENDDO
      ENDIF
!
      IF(NTARG*NCENT .EQ. 30 .AND. NTARG+NCENT .EQ. 13) THEN
      DO I=1,6
      PV(I,3)=0.D0
      ENDDO
      GO TO 99
      ENDIF
!
      IF(LIST(3) .EQ. 2) THEN
      DO I=1,6
      PV(I,3)=PV(I,3)-PV(I,10)/(1.D0+EMRAT)
      ENDDO
      ENDIF
!
      IF(LIST(10) .EQ. 2) THEN
      DO I=1,6
      PV(I,10)=PV(I,3)+PV(I,10)
      ENDDO
      ENDIF
!
  99  DO I=1,6
      RRD(I)=PV(I,NTARG)-PV(I,NCENT)
      ENDDO
!
      BARY=BSAVE
!
      RETURN
      END
!
!*****************************************************************************
      SUBROUTINE INTERP(BUF,T,NCF,NCM,NA,IFL,PV)
      Implicit None
!
!     THIS SUBROUTINE DIFFERENTIATES AND INTERPOLATES A
!     SET OF CHEBYSHEV COEFFICIENTS TO GIVE POSITION AND VELOCITY
!
!     CALLING SEQUENCE PARAMETERS:
!
!       INPUT:
!         BUF   1ST LOCATION OF ARRAY OF D.P. CHEBYSHEV COEFFICIENTS OF POSITION
!           T   T(1) IS DP FRACTIONAL TIME IN INTERVAL COVERED BY
!               COEFFICIENTS AT WHICH INTERPOLATION IS WANTED
!               (0 .LE. T(1) .LE. 1).  T(2) IS DP LENGTH OF WHOLE
!               INTERVAL IN INPUT TIME UNITS.
!         NCF   # OF COEFFICIENTS PER COMPONENT
!         NCM   # OF COMPONENTS PER SET OF COEFFICIENTS
!          NA   # OF SETS OF COEFFICIENTS IN FULL ARRAY
!               (I.E., # OF SUB-INTERVALS IN FULL INTERVAL)
!          IFL  INTEGER FLAG: =1 FOR POSITIONS ONLY
!                             =2 FOR POS AND VEL
!
!       OUTPUT:
!         PV   INTERPOLATED QUANTITIES REQUESTED.  DIMENSION
!               EXPECTED IS PV(NCM,IFL), DP.
!
      SAVE
      REAL*8  BUF(NCF,NCM,*), T(2), PV(NCM,*), PC(18), VC(18), &
     &        DNA, DT1, TEMP, TC, TWOT, VFAC
      INTEGER*4 NCF, NCM, NA, IFL, L, NP, NV, I, J
!
      DATA NP/2/
      DATA NV/3/
      DATA TWOT/0.D0/
      DATA PC(1),PC(2)/1.D0,0.D0/
      DATA VC(2)/1.D0/
!
!       ENTRY POINT. GET CORRECT SUB-INTERVAL NUMBER FOR THIS SET
!       OF COEFFICIENTS AND THEN GET NORMALIZED CHEBYSHEV TIME
!       WITHIN THAT SUBINTERVAL.
!
      DNA=DBLE(NA)
      DT1=DINT(T(1))
      TEMP=DNA*T(1)
      L=IDINT(TEMP-DT1)+1
!
!
!   TC IS THE NORMALIZED CHEBYSHEV TIME (-1 .LE. TC .LE. 1)
      TC=2.D0*(DMOD(TEMP,1.D0)+DT1)-1.D0
!
!       CHECK TO SEE WHETHER CHEBYSHEV TIME HAS CHANGED,
!       AND COMPUTE NEW POLYNOMIAL VALUES IF IT HAS.
!       (THE ELEMENT PC(2) IS THE VALUE OF T1(TC) AND HENCE
!       CONTAINS THE VALUE OF TC ON THE PREVIOUS CALL.)
!
      IF(TC.NE.PC(2)) THEN
        NP=2
        NV=3
        PC(2)=TC
        TWOT=TC+TC
      ENDIF
!
!  BE SURE THAT AT LEAST 'NCF' POLYNOMIALS HAVE BEEN EVALUATED
!  AND ARE STORED IN THE ARRAY 'PC'.
      IF(NP.LT.NCF) THEN
        DO 1 I=NP+1,NCF
        PC(I)=TWOT*PC(I-1)-PC(I-2)
    1   CONTINUE
        NP=NCF
      ENDIF
!
!   INTERPOLATE TO GET POSITION FOR EACH COMPONENT
      DO 2 I=1,NCM
      PV(I,1)=0.D0
      DO 3 J=NCF,1,-1
      PV(I,1)=PV(I,1)+PC(J)*BUF(J,I,L)
    3 CONTINUE
    2 CONTINUE
      IF(IFL.LE.1) RETURN
!
!  IF VELOCITY INTERPOLATION IS WANTED, BE SURE ENOUGH
!  DERIVATIVE POLYNOMIALS HAVE BEEN GENERATED AND STORED.
      VFAC=(DNA+DNA)/T(2)
      VC(3)=TWOT+TWOT
      IF(NV.LT.NCF) THEN
        DO 4 I=NV+1,NCF
        VC(I)=TWOT*VC(I-1)+PC(I-1)+PC(I-1)-VC(I-2)
    4   CONTINUE
        NV=NCF
      ENDIF
!
!  INTERPOLATE TO GET VELOCITY FOR EACH COMPONENT
      DO 5 I=1,NCM
      PV(I,2)=0.D0
      DO 6 J=NCF,2,-1
      PV(I,2)=PV(I,2)+VC(J)*BUF(J,I,L)
    6 CONTINUE
      PV(I,2)=PV(I,2)*VFAC
    5 CONTINUE
!
      RETURN
      END
!
!****************************************************************************
      SUBROUTINE SPLIT(TT,FR)
      Implicit None
!
!   THIS SUBROUTINE BREAKS A D.P. NUMBER INTO A D.P. INTEGER
!   AND A D.P. FRACTIONAL PART.
!
!   CALLING SEQUENCE PARAMETERS:
!       TT = D.P. INPUT NUMBER
!       FR = D.P. 2-WORD OUTPUT ARRAY.
!            FR(1) CONTAINS INTEGER PART.
!            FR(2) CONTAINS FRACTIONAL PART.
!            FOR NEGATIVE INPUT NUMBERS, FR(1) CONTAINS THE NEXT
!            MORE NEGATIVE INTEGER; FR(2) CONTAINS A POSITIVE FRACTION.
!
!   CALLING SEQUENCE DECLARATIONS
      REAL*8 TT, FR(2)
!
!   MAIN ENTRY -- GET INTEGER AND FRACTIONAL PARTS
      FR(1)=DINT(TT)
      FR(2)=TT-FR(1)
!
      IF(TT.GE.0.D0 .OR. FR(2).EQ.0.D0) RETURN
!
!   MAKE ADJUSTMENTS FOR NEGATIVE INPUT NUMBER
      FR(1)=FR(1)-1.D0
      FR(2)=FR(2)+1.D0
!
      RETURN
      END
!
!************************************************************************
      SUBROUTINE STATE(ET2,LIST,PV,PNUT)
      Implicit None
!
! THIS SUBROUTINE READS AND INTERPOLATES THE JPL PLANETARY EPHEMERIS FILE
!
!     CALLING SEQUENCE PARAMETERS:
!
!     INPUT:
!         ET2   DP 2-WORD JULIAN EPHEMERIS EPOCH AT WHICH INTERPOLATION
!               IS WANTED.  ANY COMBINATION OF ET2(1)+ET2(2) WHICH FALLS
!               WITHIN THE TIME SPAN ON THE FILE IS A PERMISSIBLE EPOCH.
!                A. FOR EASE IN PROGRAMMING, THE USER MAY PUT THE
!                   ENTIRE EPOCH IN ET2(1) AND SET ET2(2)=0.
!                B. FOR MAXIMUM INTERPOLATION ACCURACY, SET ET2(1) =
!                   THE MOST RECENT MIDNIGHT AT OR BEFORE INTERPOLATION
!                   EPOCH AND SET ET2(2) = FRACTIONAL PART OF A DAY
!                   ELAPSED BETWEEN ET2(1) AND EPOCH.
!                C. AS AN ALTERNATIVE, IT MAY PROVE CONVENIENT TO SET
!                   ET2(1) = SOME FIXED EPOCH, SUCH AS START OF INTEGRATION,
!                   AND ET2(2) = ELAPSED INTERVAL BETWEEN THEN AND EPOCH.
!        LIST   12-WORD INTEGER ARRAY SPECIFYING WHAT INTERPOLATION
!               IS WANTED FOR EACH OF THE BODIES ON THE FILE.
!                         LIST(I)=0, NO INTERPOLATION FOR BODY I
!                                =1, POSITION ONLY
!                                =2, POSITION AND VELOCITY
!               THE DESIGNATION OF THE ASTRONOMICAL BODIES BY I IS:
!                         I = 1: MERCURY
!                           = 2: VENUS
!                           = 3: EARTH-MOON BARYCENTER
!                           = 4: MARS
!                           = 5: JUPITER
!                           = 6: SATURN
!                           = 7: URANUS
!                           = 8: NEPTUNE
!                           = 9: PLUTO
!                           =10: GEOCENTRIC MOON
!                           =11: NUTATIONS IN LONGITUDE AND OBLIQUITY
!                           =12: LUNAR LIBRATIONS (IF ON FILE)
!
!     OUTPUT:
!          PV     DP 6 X 11 ARRAY THAT WILL CONTAIN REQUESTED INTERPOLATED
!               QUANTITIES.  THE BODY SPECIFIED BY LIST(I) WILL HAVE ITS
!               STATE IN THE ARRAY STARTING AT PV(1,I).  (ON ANY GIVEN
!               CALL, ONLY THOSE WORDS IN 'PV' WHICH ARE AFFECTED BY THE
!               FIRST 10 'LIST' ENTRIES (AND BY LIST(12) IF LIBRATIONS ARE
!               ON THE FILE) ARE SET.  THE REST OF THE 'PV' ARRAY
!               IS UNTOUCHED.)  THE ORDER OF COMPONENTS STARTING IN
!               PV(1,I) IS: X,Y,Z,DX,DY,DZ.
!                 ALL OUTPUT VECTORS ARE REFERENCED TO THE EARTH MEAN
!               EQUATOR AND EQUINOX OF J2000 IF THE DE NUMBER IS 200 OR
!               GREATER; OF B1950 IF THE DE NUMBER IS LESS THAN 200.
!                 THE MOON STATE IS ALWAYS GEOCENTRIC; THE OTHER NINE STATES
!               ARE EITHER HELIOCENTRIC OR SOLAR-SYSTEM BARYCENTRIC,
!               DEPENDING ON THE SETTING OF COMMON FLAGS (SEE BELOW).
!                 LUNAR LIBRATIONS, IF ON FILE, ARE PUT INTO PV(K,11) IF
!               LIST(12) IS 1 OR 2.
!         NUT     DP 4-WORD ARRAY THAT WILL CONTAIN NUTATIONS AND RATES,
!               DEPENDING ON THE SETTING OF LIST(11).  THE ORDER OF
!               QUANTITIES IN NUT IS:
!                        D PSI  (NUTATION IN LONGITUDE)
!                        D EPSILON (NUTATION IN OBLIQUITY)
!                        D PSI DOT
!                        D EPSILON DOT
!           *     STATEMENT # FOR ERROR RETURN, IN CASE OF EPOCH OUT OF
!               RANGE OR I/O ERRORS.
!
!     COMMON AREA STCOMX:
!          KM   LOGICAL FLAG DEFINING PHYSICAL UNITS OF THE OUTPUT
!               STATES. KM = .TRUE., KM AND KM/SEC
!                          = .FALSE., AU AND AU/DAY
!               DEFAULT VALUE = .FALSE.  (KM DETERMINES TIME UNIT
!               FOR NUTATIONS AND LIBRATIONS.  ANGLE UNIT IS ALWAYS RADIANS.)
!        BARY   LOGICAL FLAG DEFINING OUTPUT CENTER.
!               ONLY THE 9 PLANETS ARE AFFECTED.
!                        BARY = .TRUE. =\ CENTER IS SOLAR-SYSTEM BARYCENTER
!                             = .FALSE. =\ CENTER IS SUN
!               DEFAULT VALUE = .FALSE.
!       PVSUN   DP 6-WORD ARRAY CONTAINING THE BARYCENTRIC POSITION AND
!               VELOCITY OF THE SUN.
!
      SAVE
      REAL*8    ET2(2),PV(6,12),PNUT(4),T(2),PJD(4),BUF(1500), &
     & SS(3),CVAL(400),PVSUN(6,1), AU, EMRAT, S, AUFAC
!    . SS(3),CVAL(400),PVSUN(3,2), AU, EMRAT, S, AUFAC
      INTEGER*4 LIST(12),IPT(3,13), NUMDE, NCON, NRFILE, &
     &          IRECSZ, NCOEFFS, I, J, K, NRL, NR
      INTEGER*4 I2, I3
      DATA I2 /2/
      DATA I3 /3/
      LOGICAL*2 FIRST
      DATA FIRST/.TRUE./
      CHARACTER*6 TTL(14,3),CNAM(400)
!     CHARACTER*80 NAMFIL
!  BL1,BL2 added for padding. Common STCOMX rearranged.
      LOGICAL*2 KM,BARY, BL1, BL2
!
      INCLUDE 'param11.i'
!       Variables from:
!         1. JPL_405 - Character string giving the complete path name of
!                      the JPL DE405 ephemeris.
!
      COMMON/EPHHDR/CVAL,SS,AU,EMRAT,NUMDE,NCON,IPT
      COMMON/CHRHDR/CNAM,TTL
!     COMMON/STCOMX/KM,BARY,PVSUN
      COMMON/STCOMX/PVSUN, KM, BARY, BL1, BL2
       DATA KM/.TRUE./
!
!  Program Mods -
!      D.Gordon 2005.02.18 Changed JPL_eph to JPL_405, IRECL to I_RECL,
!                          KSIZE to K_SIZE_JPL, and NRECL to N_RECL_JPL to
!                          avoid conflicts with Calc 9 in param.i
!                          file.
!----------------------------------------------------------------------
!
!   ENTRY POINT - 1ST TIME IN, GET POINTER DATA, ETC., FROM EPH FILE
      IF(FIRST) THEN
        FIRST=.FALSE.
!
      NRFILE=12
      I_RECL_JPL = N_RECL_JPL * K_SIZE_JPL
!      print *, ' PEP: I_RECL_JPL, N_RECL_JPL, K_SIZE_JPL ', I_RECL_JPL, N_RECL_JPL, K_SIZE_JPL
!
      NCOEFFS = K_SIZE_JPL/2
!     NCOEFFS = I_RECL_JPL/N_RECL_JPL/2
!
!     OPEN(NRFILE, FILE=JPL_405, ACCESS='DIRECT', FORM='UNFORMATTED', &
!    &     RECL=I_RECL_JPL, STATUS='OLD')
      OPEN(NRFILE, FILE=JPL_DE421, ACCESS='DIRECT', FORM='UNFORMATTED', &
     &     RECL=I_RECL_JPL, STATUS='OLD')
!
      READ(NRFILE,REC=1)TTL,CNAM,SS,NCON,AU,EMRAT, &
     & ((IPT(I,J),I=1,3),J=1,12),NUMDE,(IPT(I,13),I=1,3)
!
      READ(NRFILE,REC=2)CVAL
!
!       write(6,'("JPL_405: ", A)' ) JPL_405
!       write(6,'("I_RECL_JPL: ", I)' ) I_RECL_JPL
!       write(6,'("TTL: ", 3(14(a6)/))') TTL
!       write(6,'("CNAM: ",40(10(a6,1x)/))') CNAM
!       write(6,'("SS: ",3d25.16)') SS
!       write(6,'("NCON, NUMDE: ",2i10)') NCON, NUMDE
!       write(6,'("AU, EMRAT: ",2d25.16)') AU, EMRAT
!       write(6,'("IPT: ",3(13i8,/))') IPT
      NRL=0
!
      ENDIF
!
!       ********** MAIN ENTRY POINT **********
      IF(ET2(1) .EQ. 0.D0) RETURN
!
      S=ET2(1)-.5D0
      CALL SPLIT(S,PJD(1))
      CALL SPLIT(ET2(2),PJD(3))
      PJD(1)=PJD(1)+PJD(3)+.5D0
      PJD(2)=PJD(2)+PJD(4)
      CALL SPLIT(PJD(2),PJD(3))
      PJD(1)=PJD(1)+PJD(3)
!
!       ERROR RETURN FOR EPOCH OUT OF RANGE
      IF(PJD(1)+PJD(4).LT.SS(1) .OR. PJD(1)+PJD(4).GT.SS(2)) GO TO 98
!
!       CALCULATE RECORD # AND RELATIVE TIME IN INTERVAL
      NR=IDINT((PJD(1)-SS(1))/SS(3))+3
      IF(PJD(1).EQ.SS(2)) NR=NR-1
      T(1)=((PJD(1)-(DBLE(NR-3)*SS(3)+SS(1)))+PJD(4))/SS(3)
!
!       READ CORRECT RECORD IF NOT IN CORE
      IF(NR.NE.NRL) THEN
        NRL=NR
!      print *, '!!!!!!!!!! STATE: NR = ', NR
        READ(NRFILE,REC=NR,ERR=99)(BUF(K),K=1,NCOEFFS)
      ENDIF
!
      IF(KM) THEN
      T(2)=SS(3)*86400.D0
      AUFAC=1.D0
      ELSE
      T(2)=SS(3)
      AUFAC=1.D0/AU
      ENDIF
!
!   INTERPOLATE SSBARY SUN
!     CALL INTERP(BUF(IPT(1,11)),T,IPT(2,11),3,IPT(3,11),2,PVSUN)
      CALL INTERP(BUF(IPT(1,11)),T,IPT(2,11),I3,IPT(3,11),I2,PVSUN)
      DO I=1,6
       PVSUN(I,1)=PVSUN(I,1)*AUFAC
      ENDDO
!
!   CHECK AND INTERPOLATE WHICHEVER BODIES ARE REQUESTED
!
      DO 4 I=1,10
       IF(LIST(I).EQ.0) GO TO 4
!      CALL INTERP(BUF(IPT(1,I)),T,IPT(2,I),3,IPT(3,I),
!    &  LIST(I),PV(1,I))
       CALL INTERP(BUF(IPT(1,I)),T,IPT(2,I),I3,IPT(3,I), &
     &  LIST(I),PV(1,I))
!
       DO J=1,6
        IF(I.LE.9 .AND. .NOT.BARY) THEN
        PV(J,I)=PV(J,I)*AUFAC-PVSUN(J,1)
        ELSE
        PV(J,I)=PV(J,I)*AUFAC
        ENDIF
       ENDDO
!
   4  CONTINUE
!
!   DO NUTATIONS IF REQUESTED (AND IF ON FILE)
      IF(LIST(11).GT.0 .AND. IPT(2,12).GT.0) THEN
!      CALL INTERP(BUF(IPT(1,12)),T,IPT(2,12),2,IPT(3,12),
!    * LIST(11),PNUT)
       CALL INTERP(BUF(IPT(1,12)),T,IPT(2,12),I2,IPT(3,12), &
     & LIST(11),PNUT)
      ENDIF
!
!   GET LIBRATIONS IF REQUESTED (AND IF ON FILE)
      IF(LIST(12).GT.0 .AND. IPT(2,13).GT.0) THEN
!      CALL INTERP(BUF(IPT(1,13)),T,IPT(2,13),3,IPT(3,13),
!    * LIST(12),PV(1,11))
       CALL INTERP(BUF(IPT(1,13)),T,IPT(2,13),I3,IPT(3,13), &
     & LIST(12),PV(1,11))
      ENDIF
!
      RETURN
!
  98  WRITE(6,198)ET2(1)+ET2(2),SS(1),SS(2)
 198  format(' ***  Requested JED,',f12.2, &
     & ' not within ephemeris limits,',2f12.2,'  ***')
!
      STOP
!
   99 WRITE(6,'(2F12.2,"  ERROR RETURN IN STATE")') ET2
      STOP
      END
      SUBROUTINE SITG (AXOFF, CFBASE, CFLAT, CFLON, CFSITE, CFSITN,     &
     &                 KAXIS, OCEAMP, OCEPHS,  SITLAT, SITLON, SITRAD,  &
     &                 TCTOCF, RTTOCF, ZPATH, SITHEIGHT, GEOLAT,        &
     &                 AXTILT, ROTAXIS, OPTLcoef)
      IMPLICIT None
!
! 4.    SITG
!
! 4.1   SITG PROGRAM SPECIFICATION
!
! 4.1.1 SITG is the Site Module geometry section. SITG calculates the site
!       geometry for the stations participating in the current observation.
!
! 4.1.2 RESTRICTIONS - NONE
!
! 4.1.3 REFERENCES - MARKHAM'S X-DOCUMENT
!
! 4.2   SITG PROGRAM INTERFACE
!
! 4.2.1 CALLING SEQUENCE -
!
!         OUTPUT VARIABLES:
!           1. AXOFF(2)      - THE ANTENNA AXIS OFFSETS AT EACH SITE. (M)
!           2. CFBASE(3)     - THE CRUST FIXED BASELINE VECTOR. (M)
!           3. CFLAT(3,2)    - THE PARTIAL DERIVATIVES OF THE SITE CRUST FIXED
!                              VECTOR COMPONENTS WITH RESPECT TO THE GEODETIC
!                              LATITUDES AT EACH OBSERVATION SITE. (M/RAD)
!           4. CFLON(3,2)    - THE PARTIAL DERIVATIVES OF THE SITE CRUST FIXED
!                              VECTOR COMPONENTS WITH RESPECT TO THE EAST
!                              LONGITUDES AT EACH OBSERVATION SITE.  (M/RAD)
!           5. CFSITE(3,2)   - THE CRUST FIXED SITE VECTORS AT EACH SITE. (M)
!           6. CFSITN(3,2)   - THE CRUST FIXED SITE NORMAL UNIT VECTORS AT
!                              EACH OBSERVATION SITE. (UNITLESS)
!           7. KAXIS(2)      - THE ANTENNA AXIS TYPES FOR EACH SITE. (UNITLESS)
!           8. OCEAMP(11,3,2)- THE TOPOCENTRIC OCEAN LOADING AMPLITUDES FOR
!                    ( J,K,L)  THE 11 MAIN TIDES (J=1,11),
!                                      K=1 : VERTICAL,
!                                      K=2 : EAST-WEST, AND
!                                      K=3 : NORTH-SOUTH DIRECTION
!                               FOR EACH OBSERVATION SITE (L=1,2). (M)
!           9. OCEPHS(11,3,2)- THE OCEAN LOADING PHASES AT EACH SITE. (RAD)
!          10. SITLAT(2)     - THE GEODETIC LATITUDE AT EACH SITE. (RAD)
!          11. SITLON(2)     - THE EAST LONGITUDE AT EACH SITE. (RAD)
!          12. SITRAD(2)     - THE SPHERICAL EARTH RADIUS OF EACH SITE. (M)
!          13. TCTOCF(3,3,2) - THE ROTATION MATRIX WHICH ROTATES THE
!                              TOPOCENTRIC REFERENCE SYSTEM TO THE CRUST FIXED
!                              REFERENCE SYSTEM AT EACH SITE. (UNITLESS)
!          14. RTTOCF(3,3,2) - The rotation matrix which rotates the
!                              'radial-transverse' reference system to the
!                              crust fixed reference system at each site.
!          15. ZPATH(2)      - THE ZENITH ELECTRICAL PATH LENGTH AT EACH
!                              OBSERVATION SITE.  (SEC)
!          16. SITHEIGHT(2)  - The height above the geoid at each site. (m)
!          17. GEOLAT(2)     - The geocentric latitude at each site. (rad)
!          18. AXTILT(2,2)   - Antenna fixed axis tilts (arc-seconds).
!                              First index runs over the two orthogonal
!                              tilt directions (Alt-Az: 1 => East,
!                              2 => North; (X-Y (N-S or E-W fixed) and
!                              Equatorial: 1 => Az error, 2 => Elev error).
!                              Second index runs over the two stations.
!
      INCLUDE 'cmxst11.i'
!
      INCLUDE 'cobsn11.i'
!          Variables from:
!            1. Nzero  -  Set to 1 or 2 if station 1 or 2 is at the geocenter,
!                         then used downstream. Otherwise equals zero. For
!                         correlator usage.
!
      INCLUDE 'ccon.i'
!          VARIABLES 'FROM':
!            1.  KSITC  -  THE SITE MODULE FLOW CONTROL FLAG.
!            2.  KSITD  -  THE SITE MODULE DEBUG OUTPUT FLAG.
!
      INCLUDE 'get2s.i'
!       Variables from:
!          1. LNBASE(4,2) - THE EIGHT CHARACTER SITE NAMES OF THE BASELINE
!                           OF THE CURRENT OBSERVATION. (ALPHAMERIC)
!
! 4.2.3 PROGRAM SPECIFICATIONS -
      Real*8  AXOFF(2),CFBASE(3),CFLAT(3,2),CFLON(3,2),CFSITE(3,2),     &
     &        CFSITN(3,2),OCEAMP(11,3,2),OCEPHS(11,3,2),SITLAT(2),      &
     &        SITLON(2),SITRAD(2),TCTOCF(3,3,2),ZPATH(2),SITHEIGHT(2),  &
     &        RTTOCF(3,3,2), GEOLAT(2), AXTILT(2,2), ROTAXIS(3,3,2),    &
     &        OPTLcoef(6,2)
!     Integer*2  KAXIS(2), LNBASE(4,2), NDO(3), KERR
      Integer*2  KAXIS(2)
      Integer*4  I, J, K, L, N, NN, ix, jx
!
! 4.2.4 DATA BASE ACCESS - Moved to GET_G ('BASELINE').
!
! 4.2.6 SUBROUTINE INTERFACE -
!           CALLER SUBROUTINES: DRIVG
!           CALLED SUBROUTINES: TERMINATE_CALC, VECSB
!
! 4.2.7 CONSTANTS USED - NONE
!
! 4.2.8 PROGRAM VARIABLES -
!            3.  LOC...(4) - CONTAINS THE NAMES OF THE STATIONS WITH KNOWN
!                            PARAMETERS OF HORIZONTAL DISPLACEMENT DUE TO
!                            OCEAN LOADING.
!
! 4.2.9 PROGRAMMER - DALE MARKHAM    01/13/77
!                    PETER DENATALE  07/13/77
!                    CHOPO MA        08/06/81
!                    HAROLD M. SCHUH 10/08/83
!                    SAVITA GOEL 06/03/87 (CDS FOR A900)
!                    LOTHAR MOHLMANN 03/23/89
!                    89.07.20 Jim Ryan Documentation simplified.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                                      implimented.
!                    93.03.30 MSW SITCM common and maximum number of station
!                             variable put into newly created include file
!                             "cmxst.i".
!                    94.02.04 David Gordon SITHEIGHT(2) added, station heights
!                             above geoid (meters).
!                    David Gordon 94.04.16 Converted to Implicit None.
!                    David Gordon 98.06.26 Adding rotation matrix RTTOCF(3,3,2)
!                             and geocentric latitudes GEOLAT(2), for use later
!                             in the solid Earth tide module.
!                    David Gordon 98.07.29 Added 'Include cobsn.i' with
!                             variable Nzero, and code to determine when a
!                             station is at the geocenter.
!                    Jim Ryan 02.Sept Integer*2/4 Updates.
!                    D. Gordon 2004.05.18 Axis tilt code added.
!                    D. Gordon 2007.01.11 Fixed bug in NZERO logic.
!                    D. Gordon 2012 Nov. Added OPTLcoef(6,2), the 6 ocean
!                              pole tide loading coefficients for each site.
!
!     SITG program structure.
!
!     GET the baseline name. (Moved to GET_G, 'BASELINE'/LNBASE).
!
!   Set geocenter indicator to zero
      Nzero = 0
!
!     Construct the arrays to hold the geometry of the stations participating
!     in the current observation so that this information can be passed to the
!     rest of the program.
!
!     Loop for sites 1 and 2.
  310 DO 3130  L = 1,2
!
!       Determine the identification of the stations participating in
!       the current observation. If the baseline identification is not
!       successful, a message is written and the program terminates.
!
        DO 320  NN = 1, NUMSIT
          N = NN
          IF   ( ( LNSITE(1,NN) .EQ. LNBASE(1,L) )                      &
     &    .AND.  ( LNSITE(2,NN) .EQ. LNBASE(2,L) )                      &
     &    .AND.  ( LNSITE(3,NN) .EQ. LNBASE(3,L) )                      &
     &    .AND. ( LNSITE(4,NN) .EQ. LNBASE(4,L) ) )  GO TO 330
  320   CONTINUE
!
        GO TO 700
!
!       Check to see if the ID of the baseline has changed from that of the
!       previous observation. If not, then retain the current site geometry.
!
  330   CONTINUE
!!!!!!!!IF ( NLAST(L) .EQ. N )  GO TO 3130
        NLAST(L) = N
!
!       Construct the array to hold the crust fixed site vectors.
        CFSITE(1,L) = SITXYZ(1,N)
        CFSITE(2,L) = SITXYZ(2,N)
        CFSITE(3,L) = SITXYZ(3,N)
!
!       Construct the array to hold the site spherical radii.
        SITRAD(L) = CFRAD(N)
!
!       Construct the array to hold the site normal unit vectors.
        CFSITN(1,L) = SNRM(1,N)
        CFSITN(2,L) = SNRM(2,N)
        CFSITN(3,L) = SNRM(3,N)
!
!       Construct the arrays to hold the geodetic latitudes and the East
!       longitudes. Also now an array for geocentric latitude.
        SITLAT(L) = XLAT(N)
        SITLON(L) = XLON(N)
        SITHEIGHT(L) = HEIGHT(N)
        GEOLAT(L) = GLAT(N)
!
!       Construct arrays to hold the partial derivatives of the crust fixed site
!       coordinates with respect to the longitudes and the geodetic latitudes.
!
        CFLON(1,L) = PLON(1,N)
        CFLON(2,L) = PLON(2,N)
        CFLON(3,L) = PLON(3,N)
!
        CFLAT(1,L) = PLAT(1,N)
        CFLAT(2,L) = PLAT(2,N)
        CFLAT(3,L) = PLAT(3,N)
!
!       Construct the array to hold the site antenna axis offsets.
        AXOFF(L) = SITAXO(N)
!
!       Construct the array to hold the site antenna types.
        KAXIS(L) = KTYPE(N)
!
!       Construct the array to hold the site antenna axis tilts.
        AXTILT(1,L) = Dbtilt(1,N)
        AXTILT(2,L) = Dbtilt(2,N)
!
!       Construct arrays to hold the fixed axis rotation matrices
        Do ix = 1,3
         Do jx = 1,3
          ROTAXIS(ix,jx,L) = Rotilt(ix,jx,N)
         Enddo
        Enddo
!
!       Construct the array to hold the topocentric to crust fixed
!       rotation matrices. Now also an array for the radial-transverse
!       rotation matrices.
        DO 3112  J = 1,3
          DO 3111  I = 1,3
            TCTOCF(I,J,L) = TCROT(I,J,N)
            RTTOCF(I,J,L) = RTROT(I,J,N)
 3111     CONTINUE
 3112   CONTINUE
!
!       Construct the array to hold the zenith electrical path lengths
        ZPATH(L) = SITZEN(N)
!
!       Construct the arrays to hold the site ocean loading amplitudes
!       and phases.
        DO J = 1, 11
          OCEAMP(J,1,L) = SITOAM(J,N)
          OCEAMP(J,2,L) = SITHOA(J,1,N)
          OCEAMP(J,3,L) = SITHOA(J,2,N)
!
          OCEPHS(J,1,L) = SITOPH(J,N)
          OCEPHS(J,2,L) = SITHOP(J,1,N)
          OCEPHS(J,3,L) = SITHOP(J,2,N)
        ENDDO
!
!       Construct the array to hold the site ocean pole tide 
!        loading coefficients.
        Do J = 1,6
         OPTLcoef(J,L) = OPTL6(J,N)
        Enddo
!
!       WRITE (6,*)  '         ' 
!       WRITE (6,*)  ' SITG: Zero_site, N =  ', Zero_site, N 
!       WRITE (6,*)  '         ' 
!  Check for geocenter station
       If(Zero_site .ne. 0 .and. N .eq. Zero_site) Then
!       Nzero = N
        Nzero = L
!       WRITE (6,*)  ' SITG: Geocenter Site Found, Nzero =  ', Nzero
       Endif
!
!     Close the loop which runs over the sites.
 3130 CONTINUE
!
!     Construct the array to hold the crust fixed baseline vector.
      CALL VECSB ( CFSITE(1,1), CFSITE(1,2), CFBASE )
!
!     Check KSITD for debug output.
      IF ( KSITD .EQ. 0 )  GO TO 600
      WRITE ( 6, 1)
    1 FORMAT (1X, 'Debug output for subroutine SITG.' )
      WRITE(6,8)' CFRAD   ',(CFRAD(J),J=1,NUMSIT)
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,7)' KTYPE   ',(KTYPE(J),J=1,NUMSIT)
    7 FORMAT(/,A,15I8/(7X,15I8))
      WRITE(6,7)' NLAST   ',NLAST
      WRITE(6,7)' NUMSIT  ',NUMSIT
      WRITE(6,4)' PLAT    ',(( PLAT(J,K),J=1,3),K=1,NUMSIT)
    4 FORMAT(/,A,3D25.16/(9X,3D25.16))
      WRITE(6,4)' PLON    ',(( PLON(J,K),J=1,3),K=1,NUMSIT)
      WRITE(6,8)' SITAXO  ',( SITAXO(J),J=1,NUMSIT)
      WRITE(6,9)' SITOAM, ',((SITOAM(J,K),J=1,11),K=1,NUMSIT)
      WRITE(6,9)' SITOPH, ',((SITOPH(J,K),J=1,11),K=1,NUMSIT)
      WRITE(6,9)' SITHOA, ',(((SITHOA(J,L,K),J=1,11),L=1,2),K=1,        &
     &            NUMSIT)
      WRITE(6,9)' SITHOP, ',(((SITHOP(J,L,K),J=1,11),L=1,2),K=1,        &
     &            NUMSIT)
    9 FORMAT(/,A,11F7.4,/,(9X,11F7.4))
      WRITE(6,6)' SITXYZ  ',((SITXYZ(J,K),J=1,3),K=1,NUMSIT)
    6 FORMAT(/,A,3F20.4,/,(9X,3F20.4))
      WRITE(6,8)' SITZEN  ',(SITZEN(K),K=1,NUMSIT)
      WRITE(6,4)' SNRM    ',((SNRM(I,J),I=1,3),J=1,NUMSIT)
      WRITE(6,4)' TCROT   ',(((TCROT(I,J,K),I=1,3),J=1,3),K=1,          &
     &            NUMSIT)
    5 FORMAT(/,A,/,3(3F20.4,/)/)
      WRITE(6,8)' XLAT    ',(XLAT(J),J=1,NUMSIT)
      WRITE(6,8)' XLON    ',(XLON(J),J=1,NUMSIT)
      WRITE(6,8)' GLAT    ',(GLAT(J),J=1,NUMSIT)
      WRITE(6,8)' HEIGHT  ',(HEIGHT(J),J=1,NUMSIT)
!
      WRITE ( 6, 9200 )  AXOFF, CFBASE, CFLAT, CFLON, CFSITE,           &
     &           CFSITN, KAXIS, OCEAMP, OCEPHS, SITLAT, SITLON,         &
     &           SITRAD, TCTOCF, ZPATH,  LNBASE
 9200 FORMAT (1X, 'AXOFF  = ', 2 ( D30.16, 10X ), /, 1X,                &
     &            'CFBASE = ', 3 ( D30.16, 10X ), /, 1X,                &
     &            'CFLAT  = ',/, 2 ( 3 ( D30.16, 10X ), /, 1X ),        &
     &            'CFLON  = ',/, 2 ( 3 ( D30.16, 10X ), /, 1X ),        &
     &            'CFSITE = ',/, 2 ( 3 ( D30.16, 10X ), /, 1X ),        &
     &            'CFSITN = ',/, 2 ( 3 ( D30.16, 10X ), /, 1X ),        &
     &            'KAXIS  = ',/, 2 ( I2, 10X ), /, 1X,                  &
     &            'OCEAMP = ',/,2( 3( 11F10.4,/ ),/),/,1X,              &
     &            'OCEPHS = ',/,2( 3( 11F10.4,/ ),/,1X ),/,1X,          &
     &            'SITLAT = ', 2 ( D30.16, 10X ), /, 1X,                &
     &            'SITLON = ', 2 ( D30.16, 10X ), /, 1X,                &
     &            'SITRAD = ', 2 ( D30.16, 10X ), /, 1X,                &
     &            'TCTOCF = ',/,6( 3 ( D30.16, 10X ), /, 1X ),          &
     &            'ZPATH  = ', 2 ( D30.16, 10X ), /, 1X,                &
     &            'LNBASE = ', 4A2,1X,4A2)
!
!     Normal conclusiton.
  600 RETURN
!
!     Abnormal conclusion.       .
  700 WRITE ( 6, 9300 )
 9300 FORMAT (1X, 'CALC has been terminated in subroutine SITG.  ',     &
     &            'The baseline identification was not successful.')
      CALL TERMINATE_CALC ( 'SITG  ', int2(0), int2(0))
      END
!*************************************************************************
      SUBROUTINE SITP (R2K, STAR, STAR12, EARTH, SITEV)
      IMPLICIT None
!
! 5.    SITP
!
! 5.1   SITP PROGRAM SPECIFICATION
!
! 5.1.1 SITP is the Site Module partial derivatives section. SITP
!       computes the partial derivatives of the delay and the rate with
!       respect to the site crust fixed vector components at each site.
!
! 5.1.2 RESTRICTIONS - NONE
!
! 5.1.3 REFERENCES - MARKHAM'S X-DOCUMENT
!
! 5.2   SITP PROGRAM INTERFACE
!
! 5.2.1 CALLING SEQUENCE -
!
!         INPUT VARIABLES:
!           1. R2K(3,3,3) - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                           MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                           (UNITLESS, 1/SEC, 1/SEC**2)
!           2. STAR(3)    - THE J2000.0 SOURCE UNIT VECTOR. (UNITLESS)
!          2.5 STAR12(3,2) - The J2000.0 source unit vectors from stations
!                           1 and 2. (unitless). For Far-field sources,
!                           these are the same as STAR(3)
!           3. EARTH(3,3) - The position, velocity, and acceleration of the
!                           Earth relative to the SSBC. (m, m/s, m/s**2)
!           4. SITEV(3,2) - THE J2000.0 GEOCENTRIC VELOCITY VECTORS OF EACH
!                           OBSERVATION SITE. (M/SEC)
!
!         OUTPUT VARIABLES: NONE
!
! 5.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'cphys11.i'
!          VARIABLES 'FROM':
!            1.  VLIGHT  -  THE VELOCITY OF LIGHT IN VACUUM. (M/SEC)
!            2.  VLIGHT2 -  THE VELOCITY OF LIGHT SQUARED.
!
      INCLUDE 'ccon.i'
!          VARIABLES 'FROM':
!            1.  KSITC  -  THE SITE MODULE FLOW CONTROL FLAG.
!            2.  KSITD  -  THE SITE MODULE DEBUG OUTPUT FLAG.
!
     INCLUDE 'put2s.i'
!       Variables to:
!          1. DSITP(3,2,2) - THE PARTIAL DERIVATIVES OF THE DELAY AND THE
!                            DELAY RATE WITH RESPECT TO THE CRUST FIXED SITE
!                            COORDINATES AT EACH OBSERVATION SITE. THE FIRST
!                            INDEX RUNS OVER THE SITE COORDINATES, THE SECOND
!                            INDEX RUNS OVER THE SITES, AND THE THIRD RUNS
!                            OVER THE DELAY AND THE DELAY RATE.
!                            (SEC/M, SEC/SEC-M)
!
!
! 5.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 R2K(3,3,3), STAR(3), EARTH(3,3), SITEV(3,2), DBDX1(3,2),   &
     &       DBDX2(3,2), DBDY1(3,2), DBDY2(3,2), DBDZ1(3,2),            &
     &       DBDZ2(3,2),               VG(3), VE(3), c1, c2, tt, DOTP,  &
     &       STAR12(3,2)
      Integer*4 I, K
!
! 5.2.4 DATA BASE ACCESS => Moved to PUT_P ('SIT PART'/DSITP). 
!
! 5.2.6 SUBROUTINE INTERFACE -
!           CALLER SUBROUTINES: DRIVP
!           CALLED SUBROUTINES: DOTP
!
! 5.2.7 CONSTANTS USED - VLIGHT
!
! 5.2.8 PROGRAM VARIABLES -
!       1.  DBDX1(3,2)  -  THE PARTIAL DERIVATIVES OF THE J2000.0 BASELINE
!                          POSITION AND VELOCITY VECTORS WITH RESPECT TO THE
!                          X-COMPONENT OF THE CRUST FIXED SITE VECTOR AT
!                          OBSERVATION SITE #1. (M/M, M/M-SEC)
!       2.  DBDX2(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE
!                          X-COMPONENT AT SITE #2.  (M/M, M/M-SEC)
!       3.  DBDY1(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE
!                          Y-COMPONENT AT SITE #1.  (M/M, M/M-SEC)
!       4.  DBDY2(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE
!                          Y-COMPONENT AT SITE #2.  (M/M, M/M-SEC)
!       5.  DBDZ1(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE
!                          Z-COMPONENT AT SITE #1.  (M/M, M/M-SEC)
!       6.  DBDZ2(3,2)  -  THE PARTIAL DERIVATIVES WITH RESPECT TO THE
!                          Z-COMPONENT AT SITE #2.  (M/M, M/M-SEC)
!       7.  VE(3)       -  A local copy of the velocity of the Earth
!                          relative to the SSBC.
!       8.  ci          -  1.d0/VLIGHT
!       9.  tt          -  A term common to all partials.
!
! 5.2.9 PROGRAMMER - DALE MARKHAM   01/13/77
!                    PETER DENATALE 07/13/77
!                    CHOPO MA       08/06/81
!                    89.07.20 Jim Ryan Documentation simplified.
!                    Jim Ryan 89:10:05 CPHYS common made an include file.
!                    Jim Ryan 89.12.12 UNIX-like database interface
!                                   implimented.
!                    Jim Ryan 91.11.22 Next term from the delay and rate
!                                   theoreticals added to partials computation.
!                    David Gordon 94.04.16 Converted to Implicit None.
!                    David Gordon 98.10.15 Added SITEV to input arguments.
!                                   Changed site delay and rate partials
!                                   computations to use the Consensus formula.
!                                   Differences are very small and probably
!                                   not noticeable.
!                    Jim Ryan 02.Sept Integer*2/4 Updates.
!                    David Gordon Jan. 2013  Changed to use STAR12(3,2) for 
!                                   near-field case. Moved PUT into subroutine
!                                   PUT_P.
!
!     SITP program structure
!
!     Loop twice for delay and rate partials for both sites.
!      [Index K runs over the delays and rates.]
      DO 300  K = 1,2
!
!   Loop three times for the calculation of the partials with respect to the
!    crust fixed vector components.
        DO 140  I = 1,3
!
!    Compute the partial derivatives of the J2000.0 baseline position and
!    velocity vectors with respect to the crust fixed vector coordinates
!    at site #2.
          DBDX2(I,K) = R2K(I,1,K)
          DBDY2(I,K) = R2K(I,2,K)
          DBDZ2(I,K) = R2K(I,3,K)
!
!    Compute the partial derivatives of the J2000.0 baseline position and
!    velocity vectors with respect to the crust fixed site coordinates
!    at site #1.
          DBDX1(I,K) = - R2K(I,1,K)
          DBDY1(I,K) = - R2K(I,2,K)
          DBDZ1(I,K) = - R2K(I,3,K)
!
!    Close the loop running over the vector components.
  140   CONTINUE
!
!    Complete the calculation of the partial derivatives of the delay and the
!    rate with respect to the crust fixed site vector components at each site.
!
!    First make a local copy of the velocity of the Earth.
!       DO I =1,3
!         VG(I) = EARTH(I,2)
!       Enddo
!       c1 = 1.d0/VLIGHT
!       c2 = 1.d0/VLIGHT2
!       tt = 1.d0 - c1*DOTP(star,vg)
!
!       DSITP(1,1,K)=-c1*DOTP(DBDX1(1,K),STAR)*tt-c2*DOTP(DBDX1(1,K),VG)
!       DSITP(2,1,K)=-c1*DOTP(DBDY1(1,K),STAR)*tt-c2*DOTP(DBDY1(1,K),VG)
!       DSITP(3,1,K)=-c1*DOTP(DBDZ1(1,K),STAR)*tt-c2*DOTP(DBDZ1(1,K),VG)
!       DSITP(1,2,K)=-c1*DOTP(DBDX2(1,K),STAR)*tt-c2*DOTP(DBDX2(1,K),VG)
!       DSITP(2,2,K)=-c1*DOTP(DBDY2(1,K),STAR)*tt-c2*DOTP(DBDY2(1,K),VG)
!       DSITP(3,2,K)=-c1*DOTP(DBDZ2(1,K),STAR)*tt-c2*DOTP(DBDZ2(1,K),VG)
!     WRITE(6,8)' Old DSITP ', DSITP(1,1,K), DSITP(2,1,K),DSITP(3,1,K)
!     WRITE(6,8)' Old DSITP ', DSITP(1,2,K), DSITP(2,2,K),DSITP(3,2,K)
!
! Change to use the Consensus model definition
        DO I =1,3
          VG(I) = EARTH(I,2) + SITEV(I,2)
          VE(I) = EARTH(I,2)
        Enddo
         tt = 1.d0 + DOTP(STAR,VG)/VLIGHT
!
!*      DSITP(1,1,K) = -DOTP(DBDX1(1,K),STAR)/VLIGHT/tt &
!*   &                 - DOTP(DBDX1(1,K),VE)/VLIGHT2
!*      DSITP(2,1,K) = -DOTP(DBDY1(1,K),STAR)/VLIGHT/tt &
!*   &                 - DOTP(DBDY1(1,K),VE)/VLIGHT2
!*      DSITP(3,1,K) = -DOTP(DBDZ1(1,K),STAR)/VLIGHT/tt &
!*   &                 - DOTP(DBDZ1(1,K),VE)/VLIGHT2
!*      DSITP(1,2,K) = -DOTP(DBDX2(1,K),STAR)/VLIGHT/tt &
!*   &                 - DOTP(DBDX2(1,K),VE)/VLIGHT2
!*      DSITP(2,2,K) = -DOTP(DBDY2(1,K),STAR)/VLIGHT/tt &
!*   &                 - DOTP(DBDY2(1,K),VE)/VLIGHT2
!*      DSITP(3,2,K) = -DOTP(DBDZ2(1,K),STAR)/VLIGHT/tt &
!*   &                 - DOTP(DBDZ2(1,K),VE)/VLIGHT2
!
!! Modified tio use STAR12(3,2) for near-field computations
!!       X,Y,Z for station 1:
        DSITP(1,1,K) = -DOTP(DBDX1(1,K),STAR12(1,1))/VLIGHT/tt          &
     &                 - DOTP(DBDX1(1,K),VE)/VLIGHT2
        DSITP(2,1,K) = -DOTP(DBDY1(1,K),STAR12(1,1))/VLIGHT/tt          &
     &                 - DOTP(DBDY1(1,K),VE)/VLIGHT2
        DSITP(3,1,K) = -DOTP(DBDZ1(1,K),STAR12(1,1))/VLIGHT/tt          &
     &                 - DOTP(DBDZ1(1,K),VE)/VLIGHT2
!!       X,Y,Z for station 2:
        DSITP(1,2,K) = -DOTP(DBDX2(1,K),STAR12(1,2))/VLIGHT/tt          &
     &                 - DOTP(DBDX2(1,K),VE)/VLIGHT2
        DSITP(2,2,K) = -DOTP(DBDY2(1,K),STAR12(1,2))/VLIGHT/tt          &
     &                 - DOTP(DBDY2(1,K),VE)/VLIGHT2
        DSITP(3,2,K) = -DOTP(DBDZ2(1,K),STAR12(1,2))/VLIGHT/tt          &
     &                 - DOTP(DBDZ2(1,K),VE)/VLIGHT2
!
!    Close the loop which runs over the partials of the delay and rate.
  300 CONTINUE
!
!    PUT the site module partials. => Moved to PUT_P.
!
!    Check KSITD for debug output.
      IF ( KSITD .EQ. 0 )  GO TO 700
      WRITE ( 6, 9)
    9 FORMAT (1X, 'Debug output for subroutine SITP.' )
    8 FORMAT(A,4D25.16/(7X,5D25.16))
      WRITE(6,8)' DBDX1   ',DBDX1
      WRITE(6,8)' DBDX2   ',DBDX2
      WRITE(6,8)' DBDY1   ',DBDY1
      WRITE(6,8)' DBDY2   ',DBDY2
      WRITE(6,8)' DBDZ1   ',DBDZ1
      WRITE(6,8)' DBDZ2   ',DBDZ2
      WRITE(6,8)' DSITP   ',DSITP
      WRITE(6,8)' VLIGHT  ',VLIGHT
      WRITE(6,8)' c1      ',c1
      WRITE(6,8)' c2      ',c2
      WRITE(6,8)' tt      ',tt
      WRITE(6,8)' vg      ',vg
      WRITE ( 6, 9200 )  R2K, STAR
 9200 FORMAT (1X, 'R2K =  ', 9 ( 3 ( D30.16, 10X ), /, 1X ), &
     &            'STAR = ',     3 ( D30.16, 10X ) )
!
!     Normal conclusion.
  700 RETURN
      END
!*************************************************************************
      SUBROUTINE bkplh(XYZ,PLH,PI,A,FL)
      IMPLICIT NONE
!
! NAME             bkplh.f
!
! VERSION          93.01.27
!
! WRITTEN          B. Archinal, USNO, July 20-23, 1990.
!                  Name changed from "borkow" to "bkplh", and arguments
!                  adapted for efficient use by Calc (csitm), Dbcal,
!                  and Solve.  BA, 93.01.27.
!
! PURPOSE          Converts XYZ coordinates to Phi, Lambda, H
!                  ellipsoidal coordinates.
!
! References       Borkowski, K. M. (1989).  "Accurate Algorithms to
!                  transform geocentric to geodetic coordinates"
!                  *Bulletin Geodesique*, v. 63, pp. 50-56.  Also see
!                  Borkowski, K. M. (1987).  "Transformation of
!                  Geocentric to Geodetic Coordinates without
!                  Approximations", *Astrophysics and Space Science*,
!                  v. 139, n. 1, pp. 1-4.  Correction in (1988), v. 146,
!                  n. 1, p. 201.
!
! Note             Will not work for points on the Z axis, i.e. if
!                  if X=Y=0 (Phi = +/- 90 degrees).
!
! Calling sequence CALL bkplh ( XYZ, PLH, PI, A, FL )
!
! ARGUMENT LIST
!
!  PARM       TYPE DESCRIPTION
!
!  XYZ(3)     D    INPUT - XYZ Cartesian coordinates of point.
!                  XYZ(1) and XYZ(2) must not both be zero.  Units are
!                  those of A below.
!  PLH(3)     D    OUTPUT - Ellipsoidal coordinates of point, in
!                  geodetic latitude, longitude, and height.  Units
!                  for latitude and longitude are in radians, units
!                  of height are those of A below.
!  PI         D    INPUT - Ratio of circumference to diameter of circle.
!                  Unitless.
!  A          D    INPUT - Semi-major axis of ellipsoid.  Units are
!                  of distance (meters, kilometers, miles, etc.).
!  FL         D    INPUT - Flattening of ellipsoid.  Unitless.
!
!
! SUBPROGRAMS USED
!  Fortran         DABS      DACOS     DATAN     DATAN2   DCOS
!                  DSIN      DSQRT
!
! COMMON BLOCKS    None.
!
! INPUT            None.
!
! OUTPUT           None, unless diagnostic printout uncommented.
!
! LANGUAGE         Fortran 77. --- Now Fortran 95! 
!
!===================================================================
!
      Real*8 A,B,D,DABS,DACOS,DATAN,DATAN2,DCOS,DSIN, &
     &       DSQRT,E,F,FL,G,P,PI,Q,R,T,V,X,Y,Z,ZLONG
      Real*8 XYZ(3),PLH(3)
!     INTEGER IOUT
!
!--- XYZ.
      X=XYZ(1)
      Y=XYZ(2)
      Z=XYZ(3)
!--- Semi-minor axis.
      B=A*(1.D0-FL)
!--- Set sign of B to that of Z in order to get sign of Phi correct.
      IF(Z.LT.0.D0) B=-B
!--- Intermediate Values for Latitude.
      R=DSQRT(X*X+Y*Y)
      E=(B*Z-(A*A-B*B))/(A*R)
      F=(B*Z+(A*A-B*B))/(A*R)
      P=4.D0/3.D0 * (E*F+1)
      Q=2.D0 * (E*E - F*F)
      D=P*P*P+Q*Q
      IF(D.GE.0.D0) then
        V=(DSQRT(D)-Q)**(1.D0/3.D0) - (DSQRT(D)+Q)**(1.D0/3.D0)
        else
        V=2.D0 * DSQRT(-P) * DCOS (1.D0/3.D0 * &
     &  DACOS(Q/(P * DSQRT(-P))))
        endif
!   (Improve V - not really necessary except near axes.)
      IF(V*V.LT.DABS(P)) V=-(V*V*V + 2.D0*Q)/(3.D0*P)
      G=(DSQRT(E*E+V)+E)/2.D0
      T=DSQRT( G*G  + (F-V*G)/(2.D0*G-E) ) - G
      PLH(1)=DATAN( (A*(1.D0-T*T))/(2.D0*B*T) )
!--- HEIGHT.
      PLH(3)=(R-A*T)*DCOS(PLH(1)) + (Z-B)*DSIN(PLH(1))
!--- LONGITUDE.
      ZLONG=DATAN2(Y,X)
      IF(ZLONG.LT.0.D0) ZLONG=ZLONG+2.D0*PI
      PLH(2)=ZLONG
!
!   Diagnostic output.
!
!     IOUT=11
!     WRITE(IOUT,901) A,F,B
! 901 FORMAT(' A,F,B:',3D25.16)
!     WRITE(IOUT,902) X, Y, Z
! 902 FORMAT(' X, Y, Z:',3D25.16)
!     WRITE(IOUT,903) R,E,F
! 903 FORMAT(' R, E, F:',3D25.16)
!     WRITE(IOUT,904) P,Q,D
! 904 FORMAT(' P, Q, D:',3D25.16)
!     WRITE(IOUT,905) V,G,T
! 905 FORMAT(' V, G, T:',3D25.16)
!--- Check.
!     CHK1=T*T*T*T + 2.D0 * E *T*T*T + 2.D0 * F *T - 1.D0
!     CHK2=V*V*V + 3.D0*P*V + 2.D0*Q
!     WRITE(IOUT,906) CHK1,CHK2
! 906 FORMAT('Check values (=0):',2D25.16)
      RETURN
      END
      SUBROUTINE C_HARDISP(CENT,UT1,UTC,OCEAMP,OCEPHS,FA2K,L,DZ,DW,DS)
!
!   This and the following subroutines are a modified version of 
!   program HARDISP, originally written by D. Agnew. It was obtained 
!   from the IERS Conventions (2010) software collection, at
!   ftp://tai.bipm.org/conv2010/chapter7. It has been converted from
!   Fortran 77 to Fortran 90. The inputs and outputs have been 
!   modified extensively for Calc usage. All routines were renamed
!   as below: 
!
!   Main HARDISP      ==> Subroutine C_HARDISP.
!   Subroutine ADMINT ==> Subroutine C_ADMINT.
!   Subroutine TDFRPH ==> Subroutine C_TDFRPH.
!   Subroutine SHELLS ==> Subroutine C_SHELLS.
!   Subroutine SPLINE ==> Subroutine C_SPLINE.
!   Subroutine RECURS ==> Subroutine C_RECURS.
!   Function EVAL     ==> Function C_EVAL.
!   
!
!  
!
!  This program uses a list of station displacements in the BLQ
!  format used by Scherneck and Bos for ocean loading, and outputs a
!  time series of computed tidal displacements, using an expanded set
!  of tidal constituents, whose amplitudes and phases are found by
!  spline interpolation of the tidal admittance.  A total of 342
!  constituent tides are included, which gives a precision of about
!  0.1%.
!
!  Given:
!     Input ocean loading coefficients.
!     Time in cenmturies from 2000.0 (CENT).
!     Fundamental arguments (FA2K(14)). 
!
!  Returned:
!     DZ - Radial tidal ocean loading displacement (meters)
!     DW - West tidal ocean loading displacement (meters)
!     DS - South tidal ocean loading displacement (meters)
!
!  Called:
!     C_ADMINT          Returns the ocean loading displacement amplitude,
!                       frequency, and phase of a set of tidal constituents
!     C_RECURS          Performs sine and cosine recursion
!
!  References:
!
!   Petit, G. and Luzum, B. (eds.), IERS Conventions (2010),
!   IERS Technical Note No. 36, BKG (2010)
!
!  Revisions:  
!  2005 August  Duncan Agnew     Original code, which is based on the 
!                                program hartid distributed with the 
!                                SPOTL loading package
!  2005 November D. Agnew        Corrected error in reading displacements
!  2005 December D. Agnew        Hartmann-Wenzel harmonics in admint
!                                subroutine
!  2007 December 17 G. Petit     Corrected 'intial' to 'initial' 
!                                (noted by T. Springer)
!  2008 June     D. Agnew        Corrected long-period tides, modernized
!                                control flow, added explicit typing, increased
!                                number of harmonics and added one decimal to
!                                their amplitudes
!  2009 February 16 G. Petit     Updated etutc subroutine for 2009.0 leap
!                                second
!  2009 June     25 B. Stetzler  Initial standardization of code
!  2009 June     26 B. Stetzler  Provided two test cases
!  2009 July     02 B. Stetzler  Capitalization for backwards compatibility
!  2009 August   19 B. Stetzler  Updated test cases
!  2012 November    D. Gordon    Changed to a subroutine with epoch and 
!                                ocean loading coefficients passed in 
!                                and converted to Fortran 90.
!-----------------------------------------------------------------------

      IMPLICIT NONE
      INTEGER*4 I,IDAY,IMONTH,IRNT,IRHI,IRLI,IT(5),LUO,NB,NL,NP,NT,     &
     &        NTIN,KK,NTOUT,MDAY, L
!+---------------------------------------------------------------------
!
!  Parameters below set the buffer size for computing the tides
!  recursively (NL), the number of harmonics used in the prediction
!  (NT; this must also be set in the subroutine admint) and the number
!  of harmonics read in (NTIN).
!
!----------------------------------------------------------------------
      PARAMETER (NL=600)
      PARAMETER (NT=342)
      PARAMETER (NTIN=11)

!     CHARACTER*40 DUMM
      REAL*4 SAMP
      REAL*8 F(NT),PZ(NT),PS(NT),PW(NT),SCR(3*NT)
      REAL*8 DR,PI

      REAL*8 OCEAMP(11,3,2), OCEPHS(11,3,2), CENT, FA2K(14), UT1,UTC
      REAL*4 TAMP(3,NTIN),TPH(3,NTIN)
      REAL*4 AMP(NTIN),PHASE(NTIN)
      REAL*4 AZ(NT),HCZ(2*NT)
      REAL*4 AS(NT),HCS(2*NT)
      REAL*4 AW(NT),HCW(2*NT)
      REAL*4 DZ(NL),DS(NL),DW(NL)
      REAL*4 WF(NT)
      INTEGER*4 IDT(6,NTIN)
!     COMMON/DATE/IT, CENT
      DATA DR/0.01745329252D0/,IRLI/1/
      PARAMETER ( PI = 3.1415926535897932384626433D0 ) 
      DATA LUO/6/

!  Cartwright-Tayler numbers of tides used in Scherneck lists:
!      M2, S2, N2, K2, K1, O1, P1, Q1, Mf, Mm, Ssa

      DATA IDT/                                                         &
     &  2, 0, 0, 0, 0, 0,   2, 2,-2, 0, 0, 0,   2,-1, 0, 1, 0, 0,       &
     &  2, 2, 0, 0, 0, 0,   1, 1, 0, 0, 0, 0,   1,-1, 0, 0, 0, 0,       &
     &  1, 1,-2, 0, 0, 0,   1,-2, 0, 1, 0, 0,   0, 2, 0, 0, 0, 0,       &
     &  0, 1, 0,-1, 0, 0,   0, 0, 2, 0, 0, 0/
!+----------------------------------------------------------------------
!
      IRNT = 1
      SAMP = 1.
!
!   Loop twice for the calculation of the displacements due to ocean
!   loading at sites #1 and 2.
!!!!  DO L=1,2      ! Start of Station Loop
!
       DO I=1,3
        DO KK=1,NTIN
         TAMP(I,KK) = OCEAMP(KK,I,L)
         TPH(I,KK)  = OCEPHS(KK,I,L)/DR
        ENDDO
       ENDDO
!
! Change sign for phase, to be negative for lags
       DO I=1,3
        DO KK=1,NTIN
          TPH(I,KK)=-TPH(I,KK)
        ENDDO
       ENDDO
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!     Do I=1,3
!      Write(6,1021) (TAMP(I,KK), KK=1,11)
!     Enddo
!1021 Format('TAMP: ',11F8.5)
!     Do I=1,3
!      Write(6,1022) (TPH(I,KK),  KK=1,11)
!     Enddo
!1022 Format('TPH:  ',11F8.1)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!+---------------------------------------------------------------------
!
!  Find amplitudes and phases for all constituents, for each of the
!  three displacements. Note that the same frequencies are returned 
!  each time.
!
!  BLQ format order is vertical, horizontal EW, horizontal NS
!----------------------------------------------------------------------
      DO I=1,NTIN
        AMP(I)=TAMP(1,I)
        PHASE(I)=TPH(1,I)
      ENDDO
      CALL C_ADMINT(AMP,IDT,PHASE,CENT,FA2K,UTC,AZ,F,PZ,NTIN,NTOUT)
      DO I=1,NTIN
        AMP(I)=TAMP(2,I)
        PHASE(I)=TPH(2,I)
      ENDDO
      CALL C_ADMINT(AMP,IDT,PHASE,CENT,FA2K,UTC,AW,F,PW,NTIN,NTOUT)
      DO I=1,NTIN
        AMP(I)=TAMP(3,I)
        PHASE(I)=TPH(3,I)
      ENDDO
      CALL C_ADMINT(AMP,IDT,PHASE,CENT,FA2K,UTC,AS,F,PS,NTIN,NTOUT)
!
!  set up for recursion, by normalizing frequencies, and converting
!  phases to radians
!
      DO I=1,NTOUT
        PZ(I) = DR*PZ(I)
        PS(I) = DR*PS(I)
        PW(I) = DR*PW(I)
        F(I) = SAMP*PI*F(I)/43200.D0
        WF(I) = F(I)
      ENDDO
!
!+---------------------------------------------------------------------
!
!  Loop over times, nl output points at a time. At the start of each
!  such block, convert from amp and phase to sin and cos (hc array) at
!  the start of the block. The computation of values within each
!  block is done recursively, since the times are equi-spaced.
!
!----------------------------------------------------------------------
!
 11   IRHI = MIN(IRLI+NL-1,IRNT)
      NP = IRHI - IRLI + 1
!
! Set up harmonic coefficients, compute tide, and write out
      DO I=1,NT
        HCZ(2*I-1) = AZ(I)*DCOS(PZ(I))
        HCZ(2*I)  = -AZ(I)*DSIN(PZ(I))
        HCS(2*I-1) = AS(I)*DCOS(PS(I))
        HCS(2*I)  = -AS(I)*DSIN(PS(I))
        HCW(2*I-1) = AW(I)*DCOS(PW(I))
        HCW(2*I)  = -AW(I)*DSIN(PW(I))
      ENDDO
      CALL C_RECURS(DZ,NP,HCZ,NTOUT,WF,SCR)
      CALL C_RECURS(DS,NP,HCS,NTOUT,WF,SCR)
      CALL C_RECURS(DW,NP,HCW,NTOUT,WF,SCR)
!     WRITE(LUO,120) (DZ(I),DW(I),DS(I),I=1,NP)
 120  FORMAT('DZ,DW,DS: ',3F14.6)
!?    IF(IRHI.EQ.IRNT) STOP
!?    IRLI = IRHI + 1
!
!  Reset phases to the start of the new section
!?    DO I=1,NT
!?      PZ(I) = DMOD(PZ(I) + NP*F(I),2.D0*PI)
!?      PS(I) = DMOD(PS(I) + NP*F(I),2.D0*PI)
!?      PW(I) = DMOD(PW(I) + NP*F(I),2.D0*PI)
!?    ENDDO
!???  GO TO 11
!
!!!!   D_UEN(L,1) =  DZ
!!!!   D_UEN(L,2) = -DW
!!!!   D_UEN(L,3) = -DS
!
!!!!  ENDDO     ! End of Station Loop
!  Finished.
!
        RETURN
!       STOP
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!  ==================================
!  IERS Conventions Software License
!  ==================================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING TERMS AND CONDITIONS
!  WHICH APPLY TO ITS USE.
!
!  1. The Software is provided by the IERS Conventions Center ("the
!     Center").
!
!  2. Permission is granted to anyone to use the Software for any
!     purpose, including commercial applications, free of charge,
!     subject to the conditions and restrictions listed below.
!
!  3. You (the user) may adapt the Software and its algorithms for your
!     own purposes and you may distribute the resulting "derived work"
!     to others, provided that the derived work complies with the
!     following requirements:
!
!     a) Your work shall be clearly identified so that it cannot be
!        mistaken for IERS Conventions software and that it has been
!        neither distributed by nor endorsed by the Center.
!
!     b) Your work (including source code) must contain descriptions of
!        how the derived work is based upon and/or differs from the
!        original Software.
!
!     c) The name(s) of all modified routine(s) that you distribute
!        shall be changed.
! 
!     d) The origin of the IERS Conventions components of your derived
!        work must not be misrepresented; you must not claim that you
!        wrote the original Software.
!
!     e) The source code must be included for all routine(s) that you
!        distribute.  This notice must be reproduced intact in any
!        source distribution. 
!
!  4. In any published work produced by the user and which includes
!     results achieved by using the Software, you shall acknowledge
!     that the Software was used in obtaining those results.
!
!  5. The Software is provided to the user "as is" and the Center makes
!     no warranty as to its use or performance.   The Center does not
!     and cannot warrant the performance or results which the user may
!     obtain by using the Software.  The Center makes no warranties,
!     express or implied, as to non-infringement of third party rights,
!     merchantability, or fitness for any particular purpose.  In no
!     event will the Center be liable to the user for any consequential,
!     incidental, or special damages, including any lost profits or lost
!     savings, even if a Center representative has been advised of such
!     damages, or for any claim by any third party.
!
!  Correspondence concerning IERS Conventions software should be
!  addressed as follows:
!
!                     Gerard Petit
!     Internet email: gpetit[at]bipm.org
!     Postal address: IERS Conventions Center
!                     Time, frequency and gravimetry section, BIPM
!                     Pavillon de Breteuil
!                     92312 Sevres  FRANCE
!
!     or
!
!                     Brian Luzum
!     Internet email: brian.luzum[at]usno.navy.mil
!     Postal address: IERS Conventions Center
!                     Earth Orientation Department
!                     3450 Massachusetts Ave, NW
!                     Washington, DC 20392
!
      END
!
!-----------------------------------------------------------------------
      SUBROUTINE C_ADMINT(AMPIN,IDTIN,PHIN,CENT,FA2K,UTC,AMP,F,P,NIN,   &
     &           NOUT)
!
!
!  This routine is a modified version of subroutine ADMINT, taken 
!  from the International Earth Rotation and
!  Reference Systems Service (IERS) Conventions software collection.
!
!  This subroutine returns the ocean loading displacement amplitude,
!  frequency, and phase of a set of tidal constituents generated by
!  the Bos-Scherneck website at http://www.oso.chalmers.se/~loading/.
!  The variable NIN is input as the number wanted, and the variable 
!  NOUT is returned as the number provided.  The constituents used
!  are stored in the arrays IDD (Doodson number) and TAMP
!  (Cartwright-Edden amplitude).  The actual amp and phase of each
!  of these are determined by spline interpolation of the real and
!  imaginary part of the admittance, as specified at a subset of the
!  constituents.
!
!  Input:
!     AMPIN     R*4      Cartwright-Edden amplitude of tidal constituents
!     IDTIN     I*4      Doodson number of tidal constituents
!     PHIN      R*4      Phase of tidal constituents
!     NIN       I*4      Number of harmonics used
!     CENT      R*8      TT (Terrestrial Time) in fractional centuries
!                         from 2000.0.
!     FA2K(14)  R*8      The 14 fundamental arguments, consistent with
!                         IERS onventions (2010).
!     UTC       R*8      UTC time, in fractional days.
!
!  Output:  
!     AMP       R*4      Amplitude due to ocean loading
!     F         R*8      Frequency due to ocean loading
!     P         R*8      Phase due to ocean loading
!     NOUT      I*4      Number of harmonics returned
!
!  Called:
!     C_TDFRPH           Returns frequency and phase of a tidal
!                        constituent with given Doodson number            
!     C_SPLINE           Sets up array for cubic spline interpolation
!     C_EVAL             Performs cubic spline interpolation 
!     C_SHELLS           Sorts an array using Shell Sort
!
!  References:
!     McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003),
!     IERS Technical Note No. 32, BKG (2004)
!
!  Revisions:  
!  2009 June 17 B.E. Stetzler  Initial changes to header
!  2009 June 18 B.E. Stetzler  Used IMPLICIT NONE, declared more variables,
!                              and added D0 to DOUBLE PRECISION variables 
!  2009 August 19 B.E.Stetzler Capitalized all variables for FORTRAN 77
!                              compatibility
!  2012 November  D. Gordon    Converted to Fortran 90 and modified for 
!                              use in Calc 11.
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
      INTEGER*4 I,          J,K,    LL,NCON,NDI,NIN,NLP,NOUT,NSD,NT,    &
     &          II,KK
!
!+----------------------------------------------------------------------
!  The parameters below set the number of harmonics used in the prediction
!  (nt; This must also be set in the main program) and the number of
!  constituents whose amp and phase may be specified (ncon)
!-----------------------------------------------------------------------
      PARAMETER (NT=342)
      PARAMETER (NCON=20)
!
      REAL*8    F(*),FR,P(*),PR
      REAL*8    CENT, FA2K(14), UTC
      REAL*4    DTR,C_EVAL,AM,RE,SF
!
      REAL*4    AMPIN(*),PHIN(*),AMP(*)
      INTEGER*4 IDTIN(6,*) 

!  Arrays containing information about all stored constituents
      REAL*4    TAMP(NT)
      INTEGER*4 IDD(6,NT)
!
!  Arrays containing information about the subset whose amp and phase may
!  be specified, and scratch arrays for the spline routines for which
!  at most ncon constituents may be specified.
!
      REAL*4    RL(NCON),AIM(NCON),RF(NCON),          SCR(NCON),        &
     & ZDI(NCON),ZDR(NCON),DI(NCON),DR(NCON),SDI(NCON),SDR(NCON)
      INTEGER*4 KEY(NCON)
      DATA DTR/.01745329252/
      DATA RL/NCON*0.0/,AIM/NCON*0.0/,RF/NCON*0.0/
      DATA ZDI/NCON*0.0/,ZDR/NCON*0.0/,DI/NCON*0.0/,DR/NCON*0.0/
      DATA SDI/NCON*0.0/,SDR/NCON*0.0/
      DATA TAMP/                                                        &
     &  .632208, .294107, .121046, .079915, .023818,-.023589, .022994,  &
     &  .019333,-.017871, .017192, .016018, .004671,-.004662,-.004519,  &
     &  .004470, .004467, .002589,-.002455,-.002172, .001972, .001947,  &
     &  .001914,-.001898, .001802, .001304, .001170, .001130, .001061,  &
     & -.001022,-.001017, .001014, .000901,-.000857, .000855, .000855,  &
     &  .000772, .000741, .000741,-.000721, .000698, .000658, .000654,  &
     & -.000653, .000633, .000626,-.000598, .000590, .000544, .000479,  &
     & -.000464, .000413,-.000390, .000373, .000366, .000366,-.000360,  &
     & -.000355, .000354, .000329, .000328, .000319, .000302, .000279,  &
     & -.000274,-.000272, .000248,-.000225, .000224,-.000223,-.000216,  &
     &  .000211, .000209, .000194, .000185,-.000174,-.000171, .000159,  &
     &  .000131, .000127, .000120, .000118, .000117, .000108, .000107,  &
     &  .000105,-.000102, .000102, .000099,-.000096, .000095,-.000089,  &
     & -.000085,-.000084,-.000081,-.000077,-.000072,-.000067, .000066,  &
     &  .000064, .000063, .000063, .000063, .000062, .000062,-.000060,  &
     &  .000056, .000053, .000051, .000050, .368645,-.262232,-.121995,  &
     & -.050208, .050031,-.049470, .020620, .020613, .011279,-.009530,  &
     & -.009469,-.008012, .007414,-.007300, .007227,-.007131,-.006644,  &
     &  .005249, .004137, .004087, .003944, .003943, .003420, .003418,  &
     &  .002885, .002884, .002160,-.001936, .001934,-.001798, .001690,  &
     &  .001689, .001516, .001514,-.001511, .001383, .001372, .001371,  &
     & -.001253,-.001075, .001020, .000901, .000865,-.000794, .000788,  &
     &  .000782,-.000747,-.000745, .000670,-.000603,-.000597, .000542,  &
     &  .000542,-.000541,-.000469,-.000440, .000438, .000422, .000410,  &
     & -.000374,-.000365, .000345, .000335,-.000321,-.000319, .000307,  &
     &  .000291, .000290,-.000289, .000286, .000275, .000271, .000263,  &
     & -.000245, .000225, .000225, .000221,-.000202,-.000200,-.000199,  &
     &  .000192, .000183, .000183, .000183,-.000170, .000169, .000168,  &
     &  .000162, .000149,-.000147,-.000141, .000138, .000136, .000136,  &
     &  .000127, .000127,-.000126,-.000121,-.000121, .000117,-.000116,  &
     & -.000114,-.000114,-.000114, .000114, .000113, .000109, .000108,  &
     &  .000106,-.000106,-.000106, .000105, .000104,-.000103,-.000100,  &
     & -.000100,-.000100, .000099,-.000098, .000093, .000093, .000090,  &
     & -.000088, .000083,-.000083,-.000082,-.000081,-.000079,-.000077,  &
     & -.000075,-.000075,-.000075, .000071, .000071,-.000071, .000068,  &
     &  .000068, .000065, .000065, .000064, .000064, .000064,-.000064,  &
     & -.000060, .000056, .000056, .000053, .000053, .000053,-.000053,  &
     &  .000053, .000053, .000052, .000050,-.066607,-.035184,-.030988,  &
     &  .027929,-.027616,-.012753,-.006728,-.005837,-.005286,-.004921,  &
     & -.002884,-.002583,-.002422, .002310, .002283,-.002037, .001883,  &
     & -.001811,-.001687,-.001004,-.000925,-.000844, .000766, .000766,  &
     & -.000700,-.000495,-.000492, .000491, .000483, .000437,-.000416,  &
     & -.000384, .000374,-.000312,-.000288,-.000273, .000259, .000245,  &
     & -.000232, .000229,-.000216, .000206,-.000204,-.000202, .000200,  &
     &  .000195,-.000190, .000187, .000180,-.000179, .000170, .000153,  &
     & -.000137,-.000119,-.000119,-.000112,-.000110,-.000110, .000107,  &
     & -.000095,-.000095,-.000091,-.000090,-.000081,-.000079,-.000079,  &
     &  .000077,-.000073, .000069,-.000067,-.000066, .000065, .000064,  &
     & -.000062, .000060, .000059,-.000056, .000055,-.000051/
      DATA IDD/                                                         &
     &  2, 0, 0, 0, 0, 0,   2, 2,-2, 0, 0, 0,   2,-1, 0, 1, 0, 0,       & 
     &  2, 2, 0, 0, 0, 0,   2, 2, 0, 0, 1, 0,   2, 0, 0, 0,-1, 0,       & 
     &  2,-1, 2,-1, 0, 0,   2,-2, 2, 0, 0, 0,   2, 1, 0,-1, 0, 0,       & 
     &  2, 2,-3, 0, 0, 1,   2,-2, 0, 2, 0, 0,   2,-3, 2, 1, 0, 0,       & 
     &  2, 1,-2, 1, 0, 0,   2,-1, 0, 1,-1, 0,   2, 3, 0,-1, 0, 0,       & 
     &  2, 1, 0, 1, 0, 0,   2, 2, 0, 0, 2, 0,   2, 2,-1, 0, 0,-1,       & 
     &  2, 0,-1, 0, 0, 1,   2, 1, 0, 1, 1, 0,   2, 3, 0,-1, 1, 0,       & 
     &  2, 0, 1, 0, 0,-1,   2, 0,-2, 2, 0, 0,   2,-3, 0, 3, 0, 0,       & 
     &  2,-2, 3, 0, 0,-1,   2, 4, 0, 0, 0, 0,   2,-1, 1, 1, 0,-1,       & 
     &  2,-1, 3,-1, 0,-1,   2, 2, 0, 0,-1, 0,   2,-1,-1, 1, 0, 1,       & 
     &  2, 4, 0, 0, 1, 0,   2,-3, 4,-1, 0, 0,   2,-1, 2,-1,-1, 0,       & 
     &  2, 3,-2, 1, 0, 0,   2, 1, 2,-1, 0, 0,   2,-4, 2, 2, 0, 0,       & 
     &  2, 4,-2, 0, 0, 0,   2, 0, 2, 0, 0, 0,   2,-2, 2, 0,-1, 0,       & 
     &  2, 2,-4, 0, 0, 2,   2, 2,-2, 0,-1, 0,   2, 1, 0,-1,-1, 0,       & 
     &  2,-1, 1, 0, 0, 0,   2, 2,-1, 0, 0, 1,   2, 2, 1, 0, 0,-1,       & 
     &  2,-2, 0, 2,-1, 0,   2,-2, 4,-2, 0, 0,   2, 2, 2, 0, 0, 0,       & 
     &  2,-4, 4, 0, 0, 0,   2,-1, 0,-1,-2, 0,   2, 1, 2,-1, 1, 0,       & 
     &  2,-1,-2, 3, 0, 0,   2, 3,-2, 1, 1, 0,   2, 4, 0,-2, 0, 0,       & 
     &  2, 0, 0, 2, 0, 0,   2, 0, 2,-2, 0, 0,   2, 0, 2, 0, 1, 0,       & 
     &  2,-3, 3, 1, 0,-1,   2, 0, 0, 0,-2, 0,   2, 4, 0, 0, 2, 0,       & 
     &  2, 4,-2, 0, 1, 0,   2, 0, 0, 0, 0, 2,   2, 1, 0, 1, 2, 0,       & 
     &  2, 0,-2, 0,-2, 0,   2,-2, 1, 0, 0, 1,   2,-2, 1, 2, 0,-1,       & 
     &  2,-1, 1,-1, 0, 1,   2, 5, 0,-1, 0, 0,   2, 1,-3, 1, 0, 1,       & 
     &  2,-2,-1, 2, 0, 1,   2, 3, 0,-1, 2, 0,   2, 1,-2, 1,-1, 0,       & 
     &  2, 5, 0,-1, 1, 0,   2,-4, 0, 4, 0, 0,   2,-3, 2, 1,-1, 0,       & 
     &  2,-2, 1, 1, 0, 0,   2, 4, 0,-2, 1, 0,   2, 0, 0, 2, 1, 0,       & 
     &  2,-5, 4, 1, 0, 0,   2, 0, 2, 0, 2, 0,   2,-1, 2, 1, 0, 0,       & 
     &  2, 5,-2,-1, 0, 0,   2, 1,-1, 0, 0, 0,   2, 2,-2, 0, 0, 2,       & 
     &  2,-5, 2, 3, 0, 0,   2,-1,-2, 1,-2, 0,   2,-3, 5,-1, 0,-1,       & 
     &  2,-1, 0, 0, 0, 1,   2,-2, 0, 0,-2, 0,   2, 0,-1, 1, 0, 0,       & 
     &  2,-3, 1, 1, 0, 1,   2, 3, 0,-1,-1, 0,   2, 1, 0, 1,-1, 0,       & 
     &  2,-1, 2, 1, 1, 0,   2, 0,-3, 2, 0, 1,   2, 1,-1,-1, 0, 1,       & 
     &  2,-3, 0, 3,-1, 0,   2, 0,-2, 2,-1, 0,   2,-4, 3, 2, 0,-1,       & 
     &  2,-1, 0, 1,-2, 0,   2, 5, 0,-1, 2, 0,   2,-4, 5, 0, 0,-1,       & 
     &  2,-2, 4, 0, 0,-2,   2,-1, 0, 1, 0, 2,   2,-2,-2, 4, 0, 0,       & 
     &  2, 3,-2,-1,-1, 0,   2,-2, 5,-2, 0,-1,   2, 0,-1, 0,-1, 1,       & 
     &  2, 5,-2,-1, 1, 0,   1, 1, 0, 0, 0, 0,   1,-1, 0, 0, 0, 0,       & 
     &  1, 1,-2, 0, 0, 0,   1,-2, 0, 1, 0, 0,   1, 1, 0, 0, 1, 0,       & 
     &  1,-1, 0, 0,-1, 0,   1, 2, 0,-1, 0, 0,   1, 0, 0, 1, 0, 0,       & 
     &  1, 3, 0, 0, 0, 0,   1,-2, 2,-1, 0, 0,   1,-2, 0, 1,-1, 0,       & 
     &  1,-3, 2, 0, 0, 0,   1, 0, 0,-1, 0, 0,   1, 1, 0, 0,-1, 0,       & 
     &  1, 3, 0, 0, 1, 0,   1, 1,-3, 0, 0, 1,   1,-3, 0, 2, 0, 0,       & 
     &  1, 1, 2, 0, 0, 0,   1, 0, 0, 1, 1, 0,   1, 2, 0,-1, 1, 0,       & 
     &  1, 0, 2,-1, 0, 0,   1, 2,-2, 1, 0, 0,   1, 3,-2, 0, 0, 0,       & 
     &  1,-1, 2, 0, 0, 0,   1, 1, 1, 0, 0,-1,   1, 1,-1, 0, 0, 1,       & 
     &  1, 4, 0,-1, 0, 0,   1,-4, 2, 1, 0, 0,   1, 0,-2, 1, 0, 0,       & 
     &  1,-2, 2,-1,-1, 0,   1, 3, 0,-2, 0, 0,   1,-1, 0, 2, 0, 0,       & 
     &  1,-1, 0, 0,-2, 0,   1, 3, 0, 0, 2, 0,   1,-3, 2, 0,-1, 0,       & 
     &  1, 4, 0,-1, 1, 0,   1, 0, 0,-1,-1, 0,   1, 1,-2, 0,-1, 0,       & 
     &  1,-3, 0, 2,-1, 0,   1, 1, 0, 0, 2, 0,   1, 1,-1, 0, 0,-1,       & 
     &  1,-1,-1, 0, 0, 1,   1, 0, 2,-1, 1, 0,   1,-1, 1, 0, 0,-1,       & 
     &  1,-1,-2, 2, 0, 0,   1, 2,-2, 1, 1, 0,   1,-4, 0, 3, 0, 0,       & 
     &  1,-1, 2, 0, 1, 0,   1, 3,-2, 0, 1, 0,   1, 2, 0,-1,-1, 0,       & 
     &  1, 0, 0, 1,-1, 0,   1,-2, 2, 1, 0, 0,   1, 4,-2,-1, 0, 0,       & 
     &  1,-3, 3, 0, 0,-1,   1,-2, 1, 1, 0,-1,   1,-2, 3,-1, 0,-1,       & 
     &  1, 0,-2, 1,-1, 0,   1,-2,-1, 1, 0, 1,   1, 4,-2, 1, 0, 0,       & 
     &  1,-4, 4,-1, 0, 0,   1,-4, 2, 1,-1, 0,   1, 5,-2, 0, 0, 0,       & 
     &  1, 3, 0,-2, 1, 0,   1,-5, 2, 2, 0, 0,   1, 2, 0, 1, 0, 0,       & 
     &  1, 1, 3, 0, 0,-1,   1,-2, 0, 1,-2, 0,   1, 4, 0,-1, 2, 0,       & 
     &  1, 1,-4, 0, 0, 2,   1, 5, 0,-2, 0, 0,   1,-1, 0, 2, 1, 0,       & 
     &  1,-2, 1, 0, 0, 0,   1, 4,-2, 1, 1, 0,   1,-3, 4,-2, 0, 0,       & 
     &  1,-1, 3, 0, 0,-1,   1, 3,-3, 0, 0, 1,   1, 5,-2, 0, 1, 0,       & 
     &  1, 1, 2, 0, 1, 0,   1, 2, 0, 1, 1, 0,   1,-5, 4, 0, 0, 0,       & 
     &  1,-2, 0,-1,-2, 0,   1, 5, 0,-2, 1, 0,   1, 1, 2,-2, 0, 0,       & 
     &  1, 1,-2, 2, 0, 0,   1,-2, 2, 1, 1, 0,   1, 0, 3,-1, 0,-1,       & 
     &  1, 2,-3, 1, 0, 1,   1,-2,-2, 3, 0, 0,   1,-1, 2,-2, 0, 0,       & 
     &  1,-4, 3, 1, 0,-1,   1,-4, 0, 3,-1, 0,   1,-1,-2, 2,-1, 0,       & 
     &  1,-2, 0, 3, 0, 0,   1, 4, 0,-3, 0, 0,   1, 0, 1, 1, 0,-1,       & 
     &  1, 2,-1,-1, 0, 1,   1, 2,-2, 1,-1, 0,   1, 0, 0,-1,-2, 0,       & 
     &  1, 2, 0, 1, 2, 0,   1, 2,-2,-1,-1, 0,   1, 0, 0, 1, 2, 0,       & 
     &  1, 0, 1, 0, 0, 0,   1, 2,-1, 0, 0, 0,   1, 0, 2,-1,-1, 0,       & 
     &  1,-1,-2, 0,-2, 0,   1,-3, 1, 0, 0, 1,   1, 3,-2, 0,-1, 0,       & 
     &  1,-1,-1, 0,-1, 1,   1, 4,-2,-1, 1, 0,   1, 2, 1,-1, 0,-1,       & 
     &  1, 0,-1, 1, 0, 1,   1,-2, 4,-1, 0, 0,   1, 4,-4, 1, 0, 0,       & 
     &  1,-3, 1, 2, 0,-1,   1,-3, 3, 0,-1,-1,   1, 1, 2, 0, 2, 0,       & 
     &  1, 1,-2, 0,-2, 0,   1, 3, 0, 0, 3, 0,   1,-1, 2, 0,-1, 0,       & 
     &  1,-2, 1,-1, 0, 1,   1, 0,-3, 1, 0, 1,   1,-3,-1, 2, 0, 1,       & 
     &  1, 2, 0,-1, 2, 0,   1, 6,-2,-1, 0, 0,   1, 2, 2,-1, 0, 0,       & 
     &  1,-1, 1, 0,-1,-1,   1,-2, 3,-1,-1,-1,   1,-1, 0, 0, 0, 2,       & 
     &  1,-5, 0, 4, 0, 0,   1, 1, 0, 0, 0,-2,   1,-2, 1, 1,-1,-1,       & 
     &  1, 1,-1, 0, 1, 1,   1, 1, 2, 0, 0,-2,   1,-3, 1, 1, 0, 0,       & 
     &  1,-4, 4,-1,-1, 0,   1, 1, 0,-2,-1, 0,   1,-2,-1, 1,-1, 1,       & 
     &  1,-3, 2, 2, 0, 0,   1, 5,-2,-2, 0, 0,   1, 3,-4, 2, 0, 0,       & 
     &  1, 1,-2, 0, 0, 2,   1,-1, 4,-2, 0, 0,   1, 2, 2,-1, 1, 0,       & 
     &  1,-5, 2, 2,-1, 0,   1, 1,-3, 0,-1, 1,   1, 1, 1, 0, 1,-1,       & 
     &  1, 6,-2,-1, 1, 0,   1,-2, 2,-1,-2, 0,   1, 4,-2, 1, 2, 0,       & 
     &  1,-6, 4, 1, 0, 0,   1, 5,-4, 0, 0, 0,   1,-3, 4, 0, 0, 0,       & 
     &  1, 1, 2,-2, 1, 0,   1,-2, 1, 0,-1, 0,   0, 2, 0, 0, 0, 0,       & 
     &  0, 1, 0,-1, 0, 0,   0, 0, 2, 0, 0, 0,   0, 0, 0, 0, 1, 0,       & 
     &  0, 2, 0, 0, 1, 0,   0, 3, 0,-1, 0, 0,   0, 1,-2, 1, 0, 0,       & 
     &  0, 2,-2, 0, 0, 0,   0, 3, 0,-1, 1, 0,   0, 0, 1, 0, 0,-1,       & 
     &  0, 2, 0,-2, 0, 0,   0, 2, 0, 0, 2, 0,   0, 3,-2, 1, 0, 0,       & 
     &  0, 1, 0,-1,-1, 0,   0, 1, 0,-1, 1, 0,   0, 4,-2, 0, 0, 0,       & 
     &  0, 1, 0, 1, 0, 0,   0, 0, 3, 0, 0,-1,   0, 4, 0,-2, 0, 0,       & 
     &  0, 3,-2, 1, 1, 0,   0, 3,-2,-1, 0, 0,   0, 4,-2, 0, 1, 0,       & 
     &  0, 0, 2, 0, 1, 0,   0, 1, 0, 1, 1, 0,   0, 4, 0,-2, 1, 0,       & 
     &  0, 3, 0,-1, 2, 0,   0, 5,-2,-1, 0, 0,   0, 1, 2,-1, 0, 0,       & 
     &  0, 1,-2, 1,-1, 0,   0, 1,-2, 1, 1, 0,   0, 2,-2, 0,-1, 0,       & 
     &  0, 2,-3, 0, 0, 1,   0, 2,-2, 0, 1, 0,   0, 0, 2,-2, 0, 0,       & 
     &  0, 1,-3, 1, 0, 1,   0, 0, 0, 0, 2, 0,   0, 0, 1, 0, 0, 1,       & 
     &  0, 1, 2,-1, 1, 0,   0, 3, 0,-3, 0, 0,   0, 2, 1, 0, 0,-1,       & 
     &  0, 1,-1,-1, 0, 1,   0, 1, 0, 1, 2, 0,   0, 5,-2,-1, 1, 0,       & 
     &  0, 2,-1, 0, 0, 1,   0, 2, 2,-2, 0, 0,   0, 1,-1, 0, 0, 0,       & 
     &  0, 5, 0,-3, 0, 0,   0, 2, 0,-2, 1, 0,   0, 1, 1,-1, 0,-1,       & 
     &  0, 3,-4, 1, 0, 0,   0, 0, 2, 0, 2, 0,   0, 2, 0,-2,-1, 0,       & 
     &  0, 4,-3, 0, 0, 1,   0, 3,-1,-1, 0, 1,   0, 0, 2, 0, 0,-2,       & 
     &  0, 3,-3, 1, 0, 1,   0, 2,-4, 2, 0, 0,   0, 4,-2,-2, 0, 0,       & 
     &  0, 3, 1,-1, 0,-1,   0, 5,-4, 1, 0, 0,   0, 3,-2,-1,-1, 0,       & 
     &  0, 3,-2, 1, 2, 0,   0, 4,-4, 0, 0, 0,   0, 6,-2,-2, 0, 0,       & 
     &  0, 5, 0,-3, 1, 0,   0, 4,-2, 0, 2, 0,   0, 2, 2,-2, 1, 0,       & 
     &  0, 0, 4, 0, 0,-2,   0, 3,-1, 0, 0, 0,   0, 3,-3,-1, 0, 1,       & 
     &  0, 4, 0,-2, 2, 0,   0, 1,-2,-1,-1, 0,   0, 2,-1, 0, 0,-1,       & 
     &  0, 4,-4, 2, 0, 0,   0, 2, 1, 0, 1,-1,   0, 3,-2,-1, 1, 0,       & 
     &  0, 4,-3, 0, 1, 1,   0, 2, 0, 0, 3, 0,   0, 6,-4, 0, 0, 0/
!
!  Initialize variables.
      K   = 0
      NLP = 0
      NDI = 0
      NSD = 0
!
      DO LL=1,NIN
!  See if Doodson numbers match
         DO KK=1,NT
            II = 0
            DO I=1,6
               II = II + IABS(IDD(I,KK)-IDTIN(I,LL))
            ENDDO
            IF(II.EQ.0) GO TO 5
         ENDDO
!  If you have a match, put line into array
 5       IF(II.EQ.0.AND.K.LT.NCON) THEN
            K = K + 1
            RL(K) = AMPIN(LL)*COS(DTR*PHIN(LL))/ABS(TAMP(KK))
            AIM(K)= AMPIN(LL)*SIN(DTR*PHIN(LL))/ABS(TAMP(KK))
!+---------------------------------------------------------------------
!  Now have real and imaginary parts of admittance, scaled by Cartwright-
!  Edden amplitude. Admittance phase is whatever was used in the original
!  expression. (Usually phase is given relative to some reference,
!  but amplitude is in absolute units). Next get frequency.
!----------------------------------------------------------------------
            CALL C_TDFRPH(IDD(1,KK),CENT,FA2K,UTC,FR,PR)
            RF(K) = FR
         ENDIF
      ENDDO
!+---------------------------------------------------------------------
!  Done going through constituents; there are k of them.
!  Have specified admittance at a number of points. Sort these by frequency
!  and separate diurnal and semidiurnal, recopying admittances to get them
!  in order using Shell Sort.
!----------------------------------------------------------------------
!
      CALL C_SHELLS(RF,KEY,K)
      DO I=1,K
         IF(RF(I).LT.0.5) NLP = NLP + 1
         IF(RF(I).LT.1.5.AND.RF(I).GT.0.5) NDI = NDI + 1
         IF(RF(I).LT.2.5.AND.RF(I).GT.1.5) NSD = NSD + 1
         SCR(I) = RL(KEY(I))
      ENDDO
      DO I=1,K
         RL(I) = SCR(I)
         SCR(I) = AIM(KEY(I))
      ENDDO
      DO I=1,K
         AIM(I) = SCR(I)
      ENDDO
!+---------------------------------------------------------------------
!  now set up splines (8 cases - four species, each real and imaginary)
!  We have to allow for the case when there are no constituent amplitudes
!  for the long-period tides.
!----------------------------------------------------------------------
      IF(NLP.NE.0) CALL C_SPLINE(NLP,RF,RL,ZDR,SCR)
      IF(NLP.NE.0) CALL C_SPLINE(NLP,RF,AIM,ZDI,SCR)
      CALL C_SPLINE(NDI,RF(NLP+1),RL(NLP+1),DR,SCR)
      CALL C_SPLINE(NDI,RF(NLP+1),AIM(NLP+1),DI,SCR)
      CALL C_SPLINE(NSD,RF(NLP+NDI+1),RL(NLP+NDI+1),SDR,SCR)
      CALL C_SPLINE(NSD,RF(NLP+NDI+1),AIM(NLP+NDI+1),SDI,SCR)
!  Evaluate all harmonics using the interpolated admittance
      J = 1
      DO I=1,NT
         IF(IDD(1,I).EQ.0.AND.NLP.EQ.0) GO TO 11
         CALL C_TDFRPH(IDD(1,I),CENT,FA2K,UTC,F(J),P(J))
!  Compute phase corrections to equilibrium tide using function C_EVAL
         IF(IDD(1,I).EQ.0) P(J) = P(J) + 180.
         IF(IDD(1,I).EQ.1) P(J) = P(J) + 90.
         SF = F(J)
         IF(IDD(1,I).EQ.0) RE = C_EVAL(SF,NLP,RF,RL,ZDR)
         IF(IDD(1,I).EQ.0) AM = C_EVAL(SF,NLP,RF,AIM,ZDI)
         IF(IDD(1,I).EQ.1) RE = C_EVAL(SF,NDI,RF(NLP+1),RL(NLP+1),DR)
         IF(IDD(1,I).EQ.1) AM = C_EVAL(SF,NDI,RF(NLP+1),AIM(NLP+1),DI)
         IF(IDD(1,I).EQ.2) RE =                                         &
     &      C_EVAL(SF,NSD,RF(NLP+NDI+1),RL(NLP+NDI+1),SDR)
         IF(IDD(1,I).EQ.2) AM =                                         &
     &      C_EVAL(SF,NSD,RF(NLP+NDI+1),AIM(NLP+NDI+1),SDI)
         AMP(J) = TAMP(I)*SQRT(RE**2+AM**2)
         P(J) = P(J) + ATAN2(AM,RE)/DTR
         IF(P(J).GT.180) P(J)=P(J)-360.
         J = J + 1
 11      CONTINUE
      ENDDO
      NOUT = J - 1
      RETURN
!
      END
!
!  Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!-----------------------------------------------------------------------
      SUBROUTINE C_TDFRPH (IDOOD,CENT,FA2K,UTC,FREQ,PHASE)
!+
!  - - - - - - - - - - -
!   T D F R P H 
!  - - - - - - - - - - -
!
!  This routine is part of the International Earth Rotation and
!  Reference Systems Service (IERS) Conventions software collection.
!
!  This subroutine returns the frequency and phase of a tidal
!  constituent when its Doodson number is given as input. 
!
!  Given:
!     idood       i      Doodson number of a tidal constituent
!     CENT
!     UTC
!     FA2k(14)
!
!  Returned:
!     freq        d      Frequency of a tidal constituent
!     phase       d      Phase of a tidal constituent (Note 1)
!
!  Notes:
!
!  1) The phases must be decreased by 90 degrees if the sum of the order 
!     and the species number is odd (as for the 2nd degree diurnals, and 
!     3rd degree low frequency and semidiurnals).
!     
!     These phases may need further adjustment to allow for the spherical
!     harmonic normalization used; e.g. for that used for the potential
!     by Cartwright and Tayler, 180 degrees must be added for (species,
!     order) = (1,2), (1,3), or (3,3). 
!
!
!  Test case:
!     given input: For June 25, 2009 0 Hr 0 Min, M2 tide
!                  DATA IDOOD = / 2, 0, 0, 0, 0, 0 /  
!
!     expected output: FREQ = 1.93227361605688D0
!                      PHASE = 132.8193176853237674D0
!
!  References:
!
!     Petit, G. and Luzum, B. (eds.), IERS Conventions (2010),
!     IERS Technical Note No. 36, BKG (2010)
!
!  Revisions:  
!  2009 June   15 B.E.Stetzler  Initial changes to code 
!  2009 August 19 B.E.Stetzler  Capitalized all variables for FORTRAN
!                               77 compatibility
!  2010 March  19 B.E.Stetzler  Provided test case
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
      SAVE   D,DD,OLDCENT,T,DAYFR,F1,F2,F3,F4,F5,FD1,FD2,FD3,FD4,FD5
      INTEGER*4 I,INITIAL,ITM(5),JD,JULDAT,LEAP
      REAL*8 YEAR,DELTA,FREQ,PHASE,D(6),DAYFR,DD(6),DJD,F1,F2,F3,F4,F5, &
     &       FD1,FD2,FD3,FD4,FD5,T, CENT, FA2K(14), DTR, OLDCENT, UTC,  &
     &       DelC
      INTEGER*4 IDOOD(6),ITM2(6),ITMSAVE(5)
      DATA DTR/.01745329252/
      DATA OLDCENT/-1.0000000D0/
!
! Common block 'date' stores time information in Universal Time (UT)
!
!------------------------------------------------------------------------
!  Test to see if time has changed; if so, set the phases and frequencies
!  for each of the Doodson arguments
!------------------------------------------------------------------------
      INITIAL=0
!
      DelC = DABS(OLDCENT - CENT)
      IF (DelC .lt. 1.D-13) INITIAL=1
!
      IF (INITIAL .eq. 0) THEN      
!
! Convert times to Julian days (UT) then to Julian centuries from J2000.0
!   (ET)
!
!       CALL TOYMD(ITM,ITM2)
!       JD = JULDAT(ITM2)
!       DAYFR=  ITM(3)/24.0D0 + ITM(4)/1440.0D0 + ITM(5)/84600.0D0
!       YEAR=ITM(1)+(ITM(2)+DAYFR)/(365.0D0+LEAP(ITM(1)))
!       CALL ETUTC(YEAR,DELTA)
!       DJD= JD - 0.5D0 + DAYFR
!       T = (DJD - 2451545.0D0 + DELTA/86400.0D0)/36525.0D0
!
        T = CENT
        DAYFR = UTC
!
!
! IERS expressions for the Delaunay arguments, in degrees
!
!       F1 =     134.9634025100D0 +                                     &
!    &    T*( 477198.8675605000D0 +                                     &
!    &    T*(      0.0088553333D0 +                                     &
!    &    T*(      0.0000143431D0 +                                     &
!    &    T*(     -0.0000000680D0 ))))
!       F2 =     357.5291091806D0 +                                     &
!    &    T*(  35999.0502911389D0 +                                     &
!    &    T*(     -0.0001536667D0 +                                     &
!    &    T*(      0.0000000378D0 +                                     &
!    &    T*(     -0.0000000032D0 ))))
!       F3 =      93.2720906200D0 +                                     &
!    &    T*( 483202.0174577222D0 +                                     &
!    &    T*(     -0.0035420000D0 +                                     &
!    &    T*(     -0.0000002881D0 +                                     &
!    &    T*(      0.0000000012D0 ))))
!       F4 =     297.8501954694D0 +                                     &
!    &    T*( 445267.1114469445D0 +                                     &
!    &    T*(     -0.0017696111D0 +                                     &
!    &    T*(      0.0000018314D0 +                                     &
!    &    T*(     -0.0000000088D0 ))))
!       F5 =     125.0445550100D0 +                                     &
!    &    T*(  -1934.1362619722D0 +                                     &
!    &    T*(      0.0020756111D0 +                                     &
!    &    T*(      0.0000021394D0 +                                     &
!    &    T*(     -0.0000000165D0 ))))
!
!      write(6,1007) F1,F2,F3,F4,F5
 1007  format(' tdfrph.f: Original F1,F2,F3,F4,F5:',5F16.4)
       F1 = FA2K(1)/DTR
       F2 = FA2K(2)/DTR
       F3 = FA2K(3)/DTR
       F4 = FA2K(4)/DTR
       F5 = FA2K(5)/DTR
!      write(6,1008) F1,F2,F3,F4,F5
!1008  format('tdfrph.f: F1,F2,F3,F4,F5 from FA2K:',5F16.4)
!      write(6,1009) T, DAYFR
!1009  format('tdfrph.f: T,DAYFR:',2F20.12)
!
!  Convert to Doodson (Darwin) variables
!
        D(1) = 360.0D0*DAYFR - F4
        D(2) = F3 + F5
        D(3) = D(2) - F4
        D(4) = D(2) - F1
        D(5) = -F5
        D(6) = D(3) - F2
!
!       Write(6,1010) D
 1010   Format(' D= ',6F18.6)

!  Find frequencies of Delauney variables (in cycles/day), and from these
!  the same for the Doodson arguments
!
        FD1 =  0.0362916471D0 + 0.0000000013D0*T
        FD2 =  0.0027377786D0
        FD3 =  0.0367481951D0 - 0.0000000005D0*T
        FD4 =  0.0338631920D0 - 0.0000000003D0*T
        FD5 = -0.0001470938D0 + 0.0000000003D0*T
        DD(1) = 1.0D0 - FD4
        DD(2) = FD3 + FD5
        DD(3) = DD(2) - FD4
        DD(4) = DD(2) - FD1
        DD(5) = -FD5
        DD(6) = DD(3) - FD2
!
!       Write(6,1011) DD
 1011   Format(' DD= ',6F20.12)
!
      ENDIF
!
!  End of intialization (likely to be called only once)
!
!  Compute phase and frequency of the given tidal constituent
!
      FREQ=0.0D0
      PHASE=0.0D0
      DO I = 1,6
         FREQ =  FREQ + IDOOD(I)*DD(I)
         PHASE = PHASE + IDOOD(I)*D(I)
      ENDDO
!
! Adjust phases so that they fall in the positive range 0 to 360
      PHASE = DMOD(PHASE,360.0D0)
      IF(PHASE.LT.0.0D0) PHASE = PHASE + 360.0D0
!
       OLDCENT = CENT
!
      RETURN
!
      END
!
!  Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!-----------------------------------------------------------------------
!
      SUBROUTINE C_SHELLS (X,K,N)
!+
!  - - - - - - - - -
!   S H E L L S
!  - - - - - - - - -
!
!  This routine is part of the International Earth Rotation and
!  Reference Systems Service (IERS) Conventions software collection.
!
!  The subroutine sorts an array x, of length n, sorting upward,
!  and returns an array k which may be used to key another array
!  to the sorted pattern (i.e., if we had an array f to which x
!  corresponded before sorting, then after calling SHELLS,
!  f(k(1)) will be the element of f corresponding to the
!  smallest x, f(k(2)) the next smallest, and so on).
!
!
!  Given:
!     x              d      array to be sorted (Note 1)
!     n              i      length of the input array x
!
!  Returned:
!     k              i      sorted array that may be used to key another 
!                           array
!  Notes:
!
!  1) See the subroutine ADMINT.F header comments for detailed information.
! 
!  Called:
!     None
!
!  Test case:
!     Not provided for this subroutine.
!
!  References:
!
!     Petit, G. and Luzum, B. (eds.), IERS Conventions (2010),
!     IERS Technical Note No. 36, BKG (2010)
!
!  Revisions:
!  1982 December 29              Revised so that array k is sorted in turn
!                                
!  2009 June   05 B.E. Stetzler    Added header and copyright
!  2009 August 19 B.E. Stetzler    Capitalized all variables for FORTRAN
!                                  77 compatibility
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
!
      INTEGER*4 I,IGAP,IEX,IK,IMAX,IPL,J,K(N),L,N
      REAL*4 SV,X(N)
!
      IGAP = N
!
      DO 1 I = 1,N
 1    K(I) = I
 5    IF(IGAP.LE.1) GO TO 25
!
      IGAP = IGAP/2
      IMAX = N - IGAP
 10   IEX = 0
      DO 20 I = 1,IMAX
      IPL = I + IGAP
      IF(X(I).LE.X(IPL)) GO TO 20
      SV = X(I)
      IK = K(I)
      X(I) = X(IPL)
      K(I) = K(IPL)
      X(IPL) = SV
      K(IPL) = IK
      IEX = IEX + 1
 20   CONTINUE
!
      IF(IEX.GT.0) GO TO 10
      GO TO 5
!
!  Now sort k's (for identical values of x, if any)
!
 25   J = 1
 30   IF(J.GE.N) RETURN
      IF(X(J).EQ.X(J+1)) GO TO 33
      J = J + 1
      GO TO 30
!  Have at least two x's with the same value. See how long this is true
 33   L = J
 35   IF(X(L).NE.X(L+1)) GO TO 38
      L = L + 1
      IF(L.LT.N) GO TO 35
!  j and l are the indices within which x(i) does not change - sort k
 38   IGAP = L - J + 1
 40   IF(IGAP.LE.1) J = L + 1
      IF(IGAP.LE.1) GO TO 30
!
      IGAP = IGAP/2
      IMAX = L-J+1 - IGAP
 45   IEX = 0
!
      DO 50 I=1,IMAX
      IPL = I + IGAP + J - 1
      IF(K(I+J-1).LE.K(IPL)) GO TO 50
      IK = K(I+J-1)
      K(I+J-1) = K(IPL)
      K(IPL) = IK
      IEX = IEX + 1
 50   CONTINUE
      IF(IEX.GT.0) GO TO 45
      GO TO 40
!
      END
!
! Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!
!-----------------------------------------------------------------------
      SUBROUTINE C_SPLINE (NN,X,U,S,A)
!+
!  - - - - - - - - -
!   S P L I N E
!  - - - - - - - - -
!
!  This routine is part of the International Earth Rotation and
!  Reference Systems Service (IERS) Conventions software collection.
!
!  The purpose of the subroutine is to find an array s for the spline
!  interpolator function C_EVAL.
!
!
!  Given: This is a support routine of the main program HARDISP.F.
!     nn             i      number of data points supplied, which may be
!                           negative (Note 1)
!     x              d      array containing x-coordinates where function
!                           is sampled (Note 2)
!     u              d      array containing sample values that are to be
!                           interpolated 
!     a              d      working space array of dimension at least nn
!
!  Returned:
!     s              d      output array of 2nd derivative at sample points 
!
!  Notes:
!
!  1) If the user wishes to force the derivatives at the ends of the series
!     to assume specified values, he or she should put du(1)/dx and du(n)/dx
!     in the variables s1 and s2 and call the subroutine with nn = -(number
!     of terms in the series).  Normally a parabola is fitted through the 
!     1st and last 3 points to find the slopes.  If less than 4 points are
!     supplied, straight lines are fitted.
! 
!  2) The sequence xx(1), xx(2), ... xx(nn) must be strictly increasing.
!
!  Called:
!     None
!
!  Test case:
!     Not provided for this subroutine.
!
!  References:
!
!     Petit, G. and Luzum, B. (eds.), IERS Conventions (2010),
!     IERS Technical Note No. 36, BKG (2010)
!
!  Revisions:
!  2009 June   08 B.E.Stetzler    Added header and copyright
!  2009 August 19 B.E.Stetzler    Capitalized all variables for FORTRAN
!                                 77 compatibility
!  2009 August 26 B.E.Stetzler    Used IMPLICIT NONE and defined all variables
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
      INTEGER*4 I,J,N,N1,NN,NMAX
      PARAMETER (NMAX = 20)
      REAL*4 C,Q,Q1,QN,U1,U2,X1,X2
      REAL*4 X(NMAX),U(NMAX),S(NMAX),A(NMAX)
!
      Q(U1,X1,U2,X2)=(U1/X1**2-U2/X2**2)/(1.0/X1-1.0/X2)
!      
!
      N = IABS(NN)
!
      IF (N.LE.3) THEN
!
!  series too short for cubic spline - use straight lines.
         DO I=1,N
            S(I)=0.0
         ENDDO
         RETURN
      ENDIF
!
      Q1=Q(U(2)-U(1),X(2)-X(1),U(3)-U(1),X(3)-X(1))
      QN=Q(U(N-1)-U(N),X(N-1)-X(N),U(N-2)-U(N),X(N-2)-X(N))
!
      IF (NN.LE.0) THEN
         Q1=S(1)
         QN=S(2)
      ENDIF
!
      S(1)=6.0*((U(2)-U(1))/(X(2)-X(1)) - Q1)
      N1= N - 1
!
      DO I=2,N1
         S(I)= (U(I-1)/(X(I)-X(I-1)) - U(I)*(1.0/(X(I)-X(I-1))          &
     &   + 1.0/(X(I+1)-X(I))) + U(I+1)/(X(I+1)-X(I)))*6.0
      ENDDO
!
      S(N)=6.0*(QN + (U(N1)-U(N))/(X(N)-X(N1)))
      A(1)=2.0*(X(2)-X(1))
      A(2)=1.5*(X(2)-X(1)) + 2.0*(X(3)-X(2))
      S(2)=S(2) - 0.5*S(1)

      DO I=3,N1
         C=(X(I)-X(I-1))/A(I-1)
         A(I)=2.0*(X(I+1)-X(I-1)) - C*(X(I)-X(I-1))
         S(I)=S(I) - C*S(I-1)
      ENDDO
!
      C=(X(N)-X(N1))/A(N1)
      A(N)=(2.0-C)*(X(N)-X(N1))
      S(N)=S(N) - C*S(N1)
!
!  Back substitute
      S(N)= S(N)/A(N)
!
      DO J=1,N1
         I=N-J
         S(I) =(S(I) - (X(I+1)-X(I))*S(I+1))/A(I)
      ENDDO
      RETURN
!
      END
!
! Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!
!-----------------------------------------------------------------------
      REAL FUNCTION C_EVAL (Y,NN,X,U,S)
!+
!  - - - - - - - - - - -
!   E V A L 
!  - - - - - - - - - - -
!
!  This routine is part of the International Earth Rotation and
!  Reference Systems Service (IERS) Conventions software collection.
!
!  This function performs cubic spline interpolation of a given function
!  sampled at unequally spaced intervals.  The subroutine HSPLIN needs
!  to be called beforehand to set up the array s.
! 
!
!  Given:
!     y            d     the coordinate at which a function value is
!                        desired (Note 1)
!     nn           i     number of samples of the original function
!     x            d     array containing sample coordinates x(1),x(2),...
!                        x(nn) (Note 2)
!     s            d     array containing the 2nd derivatives at the sample
!                        points (Note 3)
!
!  Returned:
!     u            d     array containing samples of a function at the
!                        coordinates x(1),x(2),...x(nn)
!
!  Notes:
!
!  1) If y falls outside the range (x(1),x(nn)), the value at the nearest
!     endpoint of the series is used.
!
!  2) The sequence x(1),x(2),...x(nn) must be strictly increasing.
!
!  3) This array is found by the subroutine HSPLIN, which must be called
!     once before beginning this interpolation.
!
!  Called:
!     None
!
!  Test case:
!     
!  Not provided for this function.  This is a support routine of the main
!  program HARDISP.F.
!
!  References:
!
!     Petit, G. and Luzum, B. (eds.), IERS Conventions (2010),
!     IERS Technical Note No. 36, BKG (2010)
!
!  Revisions:
!  2009 June   03 B.E.Stetzler Initial standardization of function
!  2009 August 19 B.E.Stetzler Capitalized all variables for FORTRAN 77
!                               compatibility
!-----------------------------------------------------------------------
!      
      IMPLICIT NONE
      INTEGER K,K1,K2,NN
      REAL*4 DELI,DK,DY,DY1,F1,F2,F3,FF1,FF2,Y
      REAL*4 X(*),U(*),S(*)
!
      NN = IABS(NN)
!
!     If y is out of range, substitute endpoint values
!
      IF (Y.LE.X(1)) THEN
         C_EVAL=U(1)
         RETURN
      ENDIF
!
      IF (Y.GE.X(NN)) THEN
         C_EVAL=U(NN)
         RETURN
      ENDIF
!
!    Locate interval (x(k1),x(k2)) which contains y
      DO 100 K=2,NN
         IF(X(K-1).LT.Y.AND.X(K).GE.Y) THEN
           K1=K-1
           K2=K
         ENDIF
100   CONTINUE
!
!    Evaluate and then interpolate
      DY=X(K2)-Y
      DY1=Y-X(K1)
      DK=X(K2)-X(K1)
      DELI=1.0D0/(6.0D0*DK)
      FF1=S(K1)*DY*DY*DY
      FF2=S(K2)*DY1*DY1*DY1
      F1=(FF1+FF2)*DELI
      F2=DY1*((U(K2)/DK)-(S(K2)*DK)/6.0D0)
      F3= DY*((U(K1)/DK)-(S(K1)*DK)/6.0D0)
      C_EVAL=F1+F2+F3
      RETURN
!
      END
!
! Finished.
!  
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!
!-----------------------------------------------------------------------
      SUBROUTINE C_RECURS(X,N,HC,NF,OM,SCR)
!+
!  - - - - - - - - -
!   R E C U R S
!  - - - - - - - - -
!
!  This routine is part of the International Earth Rotation and
!  Reference Systems Service (IERS) Conventions software collection.
!
!  The purpose of the subroutine is to perform sine and cosine recursion
!  to fill in data x, of length n, for nf sines and cosines with frequencies
!  om. 
!
!  In general, Class 1, 2, and 3 models represent physical effects that
!  act on geodetic parameters while canonical models provide lower-level
!  representations or basic computations that are used by Class 1, 2, or
!  3 models.
! 
!  Status: Canonical model	
! 
!     Class 1 models are those recommended to be used a priori in the
!     reduction of raw space geodetic data in order to determine
!     geodetic parameter estimates.
!     Class 2 models are those that eliminate an observational
!     singularity and are purely conventional in nature.
!     Class 3 models are those that are not required as either Class
!     1 or 2.
!     Canonical models are accepted as is and cannot be classified as a
!     Class 1, 2, or 3 model.
!
!  Given: This is a support routine of the main program HARDISP.F.
!     x              d      data provided from a file given as standard
!                           input from the MAIN program HARDISP.F (Note 1)
!     n              i      length of the data file x
!     hc             d      array containing alternating cosine and sine
!                           coefficients
!     nf             i      number of sine and cosine terms
!     om             d      sine and cosine frequencies (Note 2)  
!
!  Returned:
!     scr            d      scratch array of length 3 times nf which is
!                           returned as the recursion cr
!  Notes:
!
!  1) See the MAIN program HARDISP.F header comments for detailed information.
! 
!  2) The frequencies are normalized so that the Nyquist frequency is pi.
!
!  Called:
!     None
!
!  Test case:
!     Not provided for this subroutine.
!
!  References:
!
!     Petit, G. and Luzum, B. (eds.), IERS Conventions (2010),
!     IERS Technical Note No. 36, BKG (2010)
!
!  Revisions:
!  2009 June 05 B.E. Stetzler    Added header and copyright, used DCOS
!                                and DSIN exclusively, and replaced END 
!                                DO statements with CONTINUE statements
!  2009 August 19 B.E. Stetzler  Capitalized all variables for FORTRAN
!                                77 compatibility
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
      INTEGER*4 I,J,N,NF
      REAL*8 SC,SCR(*)
      REAL*4 X(*),HC(*),OM(*)
!
!  Set up for start of recursion by computing harmonic values
!  at starting point and just before it
!
      DO I = 1,NF
         SCR(3*I-2) = HC(2*I-1)
         SCR(3*I-1) = HC(2*I-1)*COS(OM(I)) -HC(2*I)*SIN(OM(I))
         SCR(3*I) = 2.*DCOS(DBLE(OM(I)))
      ENDDO
!
!  Do recursion over data
      DO I = 1,N
         X(I) = 0.
!  Then do recursive computation for each harmonic
         DO J  = 1,NF
            X(I) = X(I) + SCR(3*J-2)
            SC = SCR(3*J-2)
            SCR(3*J-2) = SCR(3*J)*SC-SCR(3*J-1)
            SCR(3*J-1) = SC
         ENDDO
      ENDDO
      RETURN
!
! Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2008
!  IERS Conventions Center
!
!  ==================================
!  IERS Conventions Software License
!  ==================================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING TERMS AND CONDITIONS
!  WHICH APPLY TO ITS USE.
!
!  1. The Software is provided by the IERS Conventions Center ("the
!     Center").
!
!  2. Permission is granted to anyone to use the Software for any
!     purpose, including commercial applications, free of charge,
!     subject to the conditions and restrictions listed below.
!
!  3. You (the user) may adapt the Software and its algorithms for your
!     own purposes and you may distribute the resulting "derived work"
!     to others, provided that the derived work complies with the
!     following requirements:
!
!     a) Your work shall be clearly identified so that it cannot be
!        mistaken for IERS Conventions software and that it has been
!        neither distributed by nor endorsed by the Center.
!
!     b) Your work (including source code) must contain descriptions of
!        how the derived work is based upon and/or differs from the
!        original Software.
!
!     c) The name(s) of all modified routine(s) that you distribute
!        shall be changed.
! 
!     d) The origin of the IERS Conventions components of your derived
!        work must not be misrepresented; you must not claim that you
!        wrote the original Software.
!
!     e) The source code must be included for all routine(s) that you
!        distribute.  This notice must be reproduced intact in any
!        source distribution. 
!
!  4. In any published work produced by the user and which includes
!     results achieved by using the Software, you shall acknowledge
!     that the Software was used in obtaining those results.
!
!  5. The Software is provided to the user "as is" and the Center makes
!     no warranty as to its use or performance.   The Center does not
!     and cannot warrant the performance or results which the user may
!     obtain by using the Software.  The Center makes no warranties,
!     express or implied, as to non-infringement of third party rights,
!     merchantability, or fitness for any particular purpose.  In no
!     event will the Center be liable to the user for any consequential,
!     incidental, or special damages, including any lost profits or lost
!     savings, even if a Center representative has been advised of such
!     damages, or for any claim by any third party.
!
!  Correspondence concerning IERS Conventions software should be
!  addressed as follows:
!
!                     Gerard Petit
!     Internet email: gpetit[at]bipm.org
!     Postal address: IERS Conventions Center
!                     Time, frequency and gravimetry section, BIPM
!                     Pavillon de Breteuil
!                     92312 Sevres  FRANCE
!
!     or
!
!                     Brian Luzum
!     Internet email: brian.luzum[at]usno.navy.mil
!     Postal address: IERS Conventions Center
!                     Earth Orientation Department
!                     3450 Massachusetts Ave, NW
!                     Washington, DC 20392
!
!
!-----------------------------------------------------------------------
      END
      SUBROUTINE M2K (RPN2K, RS2K, RW2K, TSKIP, R2K)
      IMPLICIT None
!
! 1.1.1 M2K calculates the complete crust fixed to J2000.0 rotation matrix and
!       its first two CT time derivatives using the new IERS2000 CEO-based
!       transformations.
!
! 1.1.3 REFERENCES - IERS Conventions (2003)
!
! 1.2   M2K PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             2. RPN2K(3,3,2)- The Precession/NUTATION PORTION OF
!                              The COMPLETE CRUST FIXED
!                              TO J2000.0 ROTATION MATRIX AND THE CT TIME
!                              DERIVATIVE OF THAT MATRIX. (UNITLESS, 1/SEC)
!             4. RS2K(3,3,3) - The Earth rotation PORTION OF THE COMPLETE CRUST
!                              FIXED TO J2000.0 ROTATION MATRIX AND THE FIRST
!                              TWO CT TIME DERIVATIVES OF THAT MATRIX.
!                              (UNITLESS, 1/SEC, 1/SEC**2)
!             5. RW2K(3,3,2) - THE WOBBLE PORTION OF THE COMPLETE CRUST FIXED TO
!                              J2000.0 ROTATION MATRIX and its first time
!                              derivative. (unitless, 1/sec)
!             6. TSKIP       - Repeat time indicator. If TSKIP = 1, skip
!                              computations becasue they will be identical to
!                              the previous observation (same time).
!
!           OUTPUT VARIABLES:
!             1. R2K(3,3,3)  -  THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                               MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                               (UNITLESS, 1/SEC, 1/SEC**2)
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KM20C  -  THE M2000 UTILITY ROUTINE FLOW CONTROL FLAG.
!              2. KM20D  -  THE M2000 UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
      INCLUDE 'put2s.i'
!       Variables from:
!        1. R2Kput(3,3,3) - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                            MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                            (UNITLESS, 1/SEC, 1/SEC**2)
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 R2K(3,3,3), RPN2K(3,3,2), RS2K(3,3,3), RW2K(3,3,2)
      Real*8 dR2K1(3,3), dR2K2(3,3), dR2K3(3,3), dR2K4(3,3),            &
     &       ddR2K1(3,3), ddR2K2(3,3), ddR2K3(3,3), ddR2K4(3,3),        &
     &       ddR2K11(3,3), ddR2K12(3,3), ddR2K13(3,3)
      Integer*4 TSKIP, I, J, K
!
! 1.2.4 DATA BASE ACCESS -
!         'PUT Variables:
!           1. R2K(3,3,3) - THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                             MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                             (UNITLESS, 1/SEC, 1/SEC**2)
!          ACCESS CODES:
!            2. 'CF2J2K'  -  The data base access code for the complete crust
!                              fixed to J2000 rotation matrix and its first two
!                              time derivatives.
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: MADD3, MADD4, MADD5, MMUL5, PUT4
!
! 1.2.7 CONSTANTS USED - NONE
!
! 1.2.8 PROGRAM VARIABLES -
!          1. R20001(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (dP/dt) (N) (S) (DNP) (W).  (1/SEC)
!          2. R20002(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (dN/dt) (S) (DNP) (W).  (1/SEC)
!          3. R20003(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (dS/dt) (DNP) (W).  (1/SEC)
!          4. R20004(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (S) (DNP) (dW/dt).  (1/SEC)
!          5. R20005(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (dP/dt) (N) (dS/dt) (DNP) (W). (1/SEC**2)
!          6. R20006(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (dN/dt) (dS/dt) (DNP) (W). (1/SEC**2)
!          7. R20007(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (d2S/dt2) (DNP) (W).  (1/SEC**2)
!          8. R20008(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (dS/dt) (DNP) (dW/dt).  (1/SEC**2)
!
! 1.2.9 PROGRAMMER -
!             David Gordon 2003.05.14
!             David Gordon Dec. 2012 PUT's moved to PUT_G
!
      IF (TSKIP .eq. 1) Go To 250
!
!   Compute the complete crust fixed to CEO based J2000.0 rotation matrix.
      CALL MMUL3 (RPN2K(1,1,1), RS2K(1,1,1), RW2K(1,1,1), R2K(1,1,1))
!
!   Compute the first CT time derivative of the complete crust fixed to J2000.0
!   rotation matrix.
!
!   Compute the three terms necessary for the calculation.
      CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,1), RW2K(1,1,1), dR2K1 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,2), RW2K(1,1,1), dR2K2 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,1), RW2K(1,1,2), dR2K3 )
!   Add the three terms to complete the calculation.
      CALL MADD3 ( dR2K1, dR2K2, dR2K3, R2K(1,1,2 ) )
!
!   Compute the second CT time derivative of the complete crust fixed to J2000.0
!   rotation matrix.
!
!   Compute the four terms; three are used twice.
!    (NOTE: Only the second derivative of RS2K is needed, the other
!     second derivatives are insignificant.)
      CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,2), RW2K(1,1,1), ddR2K1 )
      CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,1), RW2K(1,1,2), ddR2K2 )
       CALL MADD2 (ddR2K1, ddR2K2, ddR2K11)
!
!     CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,2), RW2K(1,1,1), ddR2K1 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,3), RW2K(1,1,1), ddR2K3 )
      CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,2), RW2K(1,1,2), ddR2K4 )
       CALL MADD3 (ddR2K1, ddR2K3, ddR2K4, ddR2K12)
!
!     CALL MMUL3 ( RPN2K(1,1,2), RS2K(1,1,1), RW2K(1,1,2), ddR2K2 )
!     CALL MMUL3 ( RPN2K(1,1,1), RS2K(1,1,2), RW2K(1,1,2), ddR2K4 )
       CALL MADD2 (ddR2K2, ddR2K4, ddR2K13)
!
!     Complete the second derivative
      CALL MADD3 ( ddR2K11, ddR2K12, ddR2K13, R2K(1,1,3) )
!
 250   CONTINUE
!
      Do I = 1,3
       Do J = 1,3
        Do K = 1,3
         R2Kput(I,J,K) = R2K(I,J,K)
        Enddo
       Enddo
      Enddo
      
!    PUT the Crust-fixed-to-J2000 rotation matrix into the data base. We do
!     it here for convenience, there really isn't a correct place to do it.
!     96APR02  -DG-
!     CALL PUT4 ('CF2J2K        ', R2K, int2(3), int2(3), int2(3))
!
!   Check KM20D for debug output.
      IF ( KM20D .EQ. 0 )  GO TO 500
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine M2K. " )
      WRITE(6,8)' dR2K1    ', dR2K1
      WRITE(6,8)' dR2K2    ', dR2K2
      WRITE(6,8)' dR2K3    ', dR2K3
      WRITE(6,8)' ddR2K1   ', ddR2K1
      WRITE(6,8)' ddR2K2   ', ddR2K2
      WRITE(6,8)' ddR2K3   ', ddR2K3
      WRITE(6,8)' ddR2K4   ', ddR2K4
      WRITE(6,8)' ddR2K11  ', ddR2K11
      WRITE(6,8)' ddR2K12  ', ddR2K12
      WRITE(6,8)' ddR2K13  ', ddR2K13
    8 FORMAT(A,3D25.16/(9X,3D25.16))
!
      WRITE ( 6, 9200 )  RPN2K, RS2K, RW2K, R2K
 9200 FORMAT (1X, "RPN2K  = ", 3 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RS2K   = ", 9 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RW2K   = ", 6 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "R2K    = ", 9 ( 3 ( D30.16, 10X ), /, 1X ) )
!
!     Normal conclusion.
  500 RETURN
      END
!*********************************************************************
!
      SUBROUTINE MC2K (RNC2K, RPC2K, RSC2K, RW2K, RFR2K, TSKIP, RC2K)
      IMPLICIT None
!
! 1.1.1 MC2K calculates the classical crust fixed to J2000.0 rotation
!       matrix and its first two CT time derivatives using the IERS2003
!       models.
!
! 1.1.3 REFERENCES - IERS Conventions (2003)
!
! 1.2   MC2K  PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!
!           INPUT VARIABLES:
!             1. RNC2K(3,3,2)- THE NUTATION PORTION OF THE COMPLETE CRUST FIXED
!                              TO J2000.0 ROTATION MATRIX AND THE CT TIME
!                              DERIVATIVE OF THAT MATRIX. (UNITLESS, 1/SEC)
!             2. RPC2K(3,3,2)- THE PRECESSION PORTION OF THE COMPLETE CRUST
!                              FIXED TO J2000.0 ROTATION MATRIX AND THE CT TIME
!                              DERIVATIVE OF THAT MATRIX. (UNITLESS, 1/SEC)
!             3. RSC2K(3,3,3)- THE DIURNAL SPIN PORTION OF THE COMPLETE CRUST
!                              FIXED TO J2000.0 ROTATION MATRIX AND THE FIRST
!                              TWO CT TIME DERIVATIVES OF THAT MATRIX.
!                              (UNITLESS, 1/SEC, 1/SEC**2)
!             4. RW2K(3,3,2)-  THE WOBBLE PORTION OF THE COMPLETE CRUST FIXED TO
!                              J2000.0 ROTATION MATRIX and its first time
!                              derivative. (unitless, 1/sec)
!             5. TSKIP      -  Repeat time indicator. If TSKIP = 1, skip
!                              computations becasue they will be identical to
!                              the previous observation (same time).
!
!           OUTPUT VARIABLES:
!             1. RFR2K(3,3)   -  The frame bias rotation matrix
!             2. RC2K(3,3,3)  -  THE COMPLETE CRUST FIXED TO J2000.0 ROTATION
!                                 MATRIX AND ITS FIRST TWO CT TIME DERIVATIVES.
!                                 (UNITLESS, 1/SEC, 1/SEC**2)
!
! 1.2.2 COMMON BLOCKS USED -
!
      INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1. KM20C  -  THE M2000 UTILITY ROUTINE FLOW CONTROL FLAG.
!              2. KM20D  -  THE M2000 UTILITY ROUTINE DEBUG OUTPUT FLAG.
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!     VARIABLES 'FROM':
!             1. CONVDS - THE CONVERSION FACTOR FROM ARCSECONDS TO RADIANS.
!
! 1.2.3 PROGRAM SPECIFICATIONS -
!
      Real*8 RC2K (3,3,3), R2001(3,3), R2002(3,3), R2003(3,3), &
     &       R2004(3,3), R2005(3,3), R2006(3,3),  RFR2K(3,3), &
     &       RNC2K(3,3,2), RPC2K(3,3,2), RSC2K(3,3,3), RW2K(3,3,2), &
     &       R2007(3,3), R2008(3,3),s2001(3,3), RN1(3,3), RN2(3,3), &
     &       RN3(3,3)
      Integer*4 TSKIP
!
      REAL*8 DEPSBI, DPSIBI, EPS0, DRA0
       REAL*8      DAS2R
       PARAMETER ( DAS2R = 4.848136811095359935899141D-6 )
       PARAMETER ( DEPSBI = -0.0068192D0 * DAS2R  )
       PARAMETER ( DPSIBI = -0.041775D0 * DAS2R  )
       PARAMETER ( EPS0 = 84381.448D0 * DAS2R  )
       PARAMETER ( DRA0   = -0.0146D0 * DAS2R  )
!     PARAMETER ( DEPSBI = -0.0068192D0 * CONVDS )
!     PARAMETER ( DPSIBI = -0.041775D0 * CONVDS )
!     PARAMETER ( EPS0 = 84381.448D0 * CONVDS )
!     PARAMETER ( DRA0   = -0.0146D0 * CONVDS )
      INTEGER*4 IFRAME
       DATA IFRAME /0/
       SAVE IFRAME
!
! 1.2.4 DATA BASE ACCESS - None
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVG
!             CALLED SUBROUTINES: MADD3, MADD4, MADD5, MMUL5, PUT4
!
! 1.2.7 CONSTANTS USED - DEPSBI, DPSIBI, EPS0, DRA0
!
! 1.2.8 PROGRAM VARIABLES -
!          1. R2001(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (dP/dt) (N) (S) (DNP) (W).  (1/SEC)
!          2. R2002(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (dN/dt) (S) (DNP) (W).  (1/SEC)
!          3. R2003(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (dS/dt) (DNP) (W).  (1/SEC)
!          4. R2004(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (S) (DNP) (dW/dt).  (1/SEC)
!          5. R2005(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (dP/dt) (N) (dS/dt) (DNP) (W). (1/SEC**2)
!          6. R2006(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (dN/dt) (dS/dt) (DNP) (W). (1/SEC**2)
!          7. R2007(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (d2S/dt2) (DNP) (W).  (1/SEC**2)
!          8. R2008(3,3)  -  THE PRODUCT OF THE ROTATION MATRICES
!                             (P) (N) (dS/dt) (DNP) (dW/dt).  (1/SEC**2)
!
! 1.2.9 PROGRAMMER -
!             David Gordon 2003.07.30 Subroutine created
!
!
        IFRAME = IFRAME + 1
       IF (IFRAME .GT. 1) Go to 10
!   Construct the frame bias rotation matrix.
!    (Needs to be done only once per database and saved.)
        CALL ROTAT (DEPSBI, int2(1), RN1)
        CALL ROTAT (-DPSIBI*DSIN(EPS0), int2(2), RN2)
        CALL ROTAT (-DRA0, int2(3), RN3)
        CALL MMUL3 ( RN3, RN2, RN1, RFR2K )
!        Write(6,1031) RFR2K
!1031  Format(1x,' MC2K/Frame Bias Matrix RFR2K:',(3(/,3E25.15)))
!
  10  Continue
!
      IF (TSKIP .eq. 1) Go To 250
!
!   Compute the complete crust fixed to J2000.0 rotation matrix.
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,1), RSC2K(1,1,1),     &
     &             RW2K(1,1,1), RC2K(1,1,1) )
!
!   Compute the first CT time derivative of the complete crust fixed to J2000.0
!   rotation matrix.
!
!   Compute the four terms necessary for the calculation.
      CALL MMUL5 ( RFR2K, RPC2K(1,1,2), RNC2K(1,1,1), RSC2K(1,1,1),     &
     &             RW2K(1,1,1), R2001 )
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,2), RSC2K(1,1,1),     &
     &             RW2K(1,1,1), R2002 )
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,1), RSC2K(1,1,2),     &
     &             RW2K(1,1,1), R2003 )
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,1), RSC2K(1,1,1),     &
     &             RW2K(1,1,2), R2004 )
!   Add the four terms to complete the calculation.
      CALL MADD4 ( R2001, R2002, R2003, R2004, RC2K (1,1,2 ) )
!
!   Compute the second CT time derivative of the complete crust fixed to J2000.0
!   rotation matrix.
!
!   Compute the four largest terms.
!    (NOTE: Other terms are needed for the complete calculation but those terms
!     are insignificant for the purposes of CALC.
!
      CALL MMUL5 ( RFR2K, RPC2K(1,1,2), RNC2K(1,1,1), RSC2K(1,1,2),     &
     &             RW2K(1,1,1), R2005 )
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,2), RSC2K(1,1,2),     &
     &             RW2K(1,1,1), R2006 )
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,1), RSC2K(1,1,3),     &
     &             RW2K(1,1,1), R2007 )
      CALL MMUL5 ( RFR2K, RPC2K(1,1,1), RNC2K(1,1,1), RSC2K(1,1,2),     &
     &             RW2K(1,1,2), R2008 )
!
!   Add the terms in the correct way to complete the calculation.
!    (NOTE: The matrices R2005, R2006, and R2008 need to be added twice in
!    the  calculation.)
!
      CALL MADD5 ( R2005, R2005, R2006, R2006, R2007, s2001)
      CALL MADD3 (S2001, R2008, R2008, RC2K (1,1,3))
!
 250   CONTINUE
!
!  The classical rotation matrix is not currently saved.
!     CALL PUT4 ( '              ', RC2K , int2(3), int2(3), int2(3))
!
!   Check KM20D for debug output.
      IF ( KM20D .EQ. 0 )  GO TO 500
      WRITE ( 6, 9)
    9 FORMAT (1X, "Debug output for subroutine MC2K. " )
      WRITE(6,8)' R2001  ',R2001
      WRITE(6,8)' R2002  ',R2002
      WRITE(6,8)' R2003  ',R2003
      WRITE(6,8)' R2004  ',R2004
      WRITE(6,8)' R2005  ',R2005
      WRITE(6,8)' R2006  ',R2006
      WRITE(6,8)' R2007  ',R2007
      WRITE(6,8)' R2008  ',R2008
      WRITE(6,8)' S2001  ',S2001
    8 FORMAT(A,3D25.16/(9X,3D25.16))
!
      WRITE ( 6, 9200 )  RFR2K, RPC2K, RNC2K, RSC2K, RW2K, RC2K
 9200 FORMAT (1X, "RFR2K  = ", 3 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RPC2K  = ", 6 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RNC2K  = ", 6 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RSC2K  = ", 9 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RW2K   = ", 6 ( 3 ( D30.16, 10X ), /, 1X ),          &
     &            "RC2K   = ", 9 ( 3 ( D30.16, 10X ), /, 1X ) )
!
!     Normal conclusion.
  500 RETURN
      END
      SUBROUTINE DIRNL ( DATDCT, DUT1AT, EPS, FA2K, FAD2K, UT1,         &
     &           XJD, CT, DUTCAT, CENT,                                 &
     &           RPN2K6, S06,                                           &
     &           ERA2K, DERA2K, pERA2K, RS2K, RS2Km1, RS2Kp1,           &
     &           GAST2K, GMST2K, RSC2K)
      IMPLICIT None
!
! 1.    DIRNL
!
! 1.1   DIRNL PROGRAM SPECIFICATION
!
! 1.1.1 DIRNL is the utility routine which computes the diurnal spin portion of
!       the complete crust fixed to J2000.0 rotation matrix and its first two CT
!       time derivatives. DIRNL also computes the diurnal angular velocity of
!       the Earth, the Greenwich Mean Sidereal Time, and the Greenwich Apparent
!       Siderial Time (GAST) and its CT time derivative.
!
! 1.1.2 RESTRICTIONS - NONE
!
! 1.1.3 REFERENCES - 1) 'THE EXPLANATORY SUPPLEMENT TO THE AMERICAN
!                       EPHEMERIS AND NAUTICAL ALMANAC", P.72-76,
!                    2) AOKI, S. ET AL., "THE NEW DEFINITION OF UNIVERSAL
!                       TIME", ASTRON. ASTROPHYS., ????,1980.
!                    3) McCarthy, D., IERS Technical Note 13, Paris 1992
!                    4) McCarthy, D., IERS Technical Note 32, IERS
!                       Conventions (2003).
!
! 1.2   DIRNL PROGRAM INTERFACE
!
! 1.2.1 CALLING SEQUENCE -
!        INPUT VARIABLES:
!             1. DATDCT   -  THE PARTIAL DERIVATIVE OF ATOMIC TIME WITH
!                            RESPECT TO COORDINATE TIME. (SEC/SEC)
!             2. DUT1AT   -  THE PARTIAL DERIVATIVE OF UT1 TIME WITH
!                            RESPECT TO ATOMIC TIME. (SEC/SEC)
! Not Used??  3. EPS(2)   -  THE TRUE OBLIQUITY OF THE ECLIPTIC AND ITS
!                            CT TIME DERIVATIVE. (RAD, RAD/SEC)
!             4. FA2K(5)  -  The fundamental nutation arguments (see NUTFA)
!             5. FAD2K(5) -  The time derivative of th fundamental
!                            nutation arguments (see NUTFA)
!             6. UT1      -  THE UT1 TIME OF THE DAY. (SEC)
!             7. XJD      -  THE JULIAN DATE AT ZERO HOURS UTC OF THE
!                            DATE IN QUESTION. (DAYS)
!             8. CT       -  Coordinate time, fraction of the day. (days)
!             9. DUTCAT    - Partial derivative of the UTC time with
!                            respect to the atomic time.
!            10. CENT      - Number of Julian centuries elapsed since the
!                            epoch January 1.5, 2000. (centuries)
!            13. RPN2K6(3,3,2)-The Bias Precession Nutation portion of
!                            the complete Fixed to J2000.0 rotation
!                            matrix and its CT time derivative,
!                            consistent with the IERS Conventions
!                            (2010). (unitless, 1/sec)
!            14. S06(2)    - Position of the CEO (Celestial Ephemeris
!                            Origin) on the equator of the CIP, and its
!                            time derivative. (Radians, Radians/sec)
!
!        OUTPUT VARIABLES:
!             3. ERA2K     -  Earth rotation angle (Radians).
!             4. DERA2K    -  Time derivative of Earth rotation angle.
!             5. pERA2K    -  Partial derivative of the Earth rotation
!                             angle (ERA2K) w.r.t. UT1.
!             5. RS2K(3,3,3)- 'New paradigm' diurnal spin rotation
!                             matrix, and its first two CT time
!                             derivatives. (unitless, 1/sec, 1/sec**2)
!             7. GAST2K(2) -  IERS2000 Greenwich apparent sidereal time
!                             and its CT (?) time derivative. (rad, rad/sec)
!             8. GMST2K     - THE GREENWICH MEAN SIDEREAL TIME. (RAD)
!             9. RSC2K(3,3,3)-'Classical' diurnal spin matrix using the
!                             IERS2000 Greenwich apparent sidereal time,
!                             and its first two CT time derivatives.
!                             (unitless, 1/sec, 1/sec**2)
!
      Real*8 DATDCT, DUT1AT, EPS(2), UT1, XJD, CT, DUTCAT, GMST2K(2),   &
     &       ERA2K, DERA2K, RS2K(3,3,3), GAST2K(2), RSC2K(3,3,3),       &
     &       CENT, FA2K(14), FAD2K(14), RPN2K6(3,3,2), S06(2) 
!
! 1.2.2 COMMON BLOCKS USED -
!
      Real*8           PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
      COMMON / CMATH / PI, TWOPI, HALFPI, CONVD, CONVDS, CONVHS, SECDAY
!            VARIABLES 'FROM':
!              1.  CONVHS  -  THE CONVERSION FACTOR OF RADIANS PER TIME-SECOND.
!                             (RAD/TIME-SEC)
           INCLUDE 'ccon.i'
!            VARIABLES 'FROM':
!              1.  KDIUC  -  THE DIURNAL SPIN UTILITY ROUTINE FLOW CONTROL FLAG.
!              2.  KDIUD  -  THE DIURNAL SPIN UTILITY ROUTINE DEBUG OUTPUT FLAG.
!              3.  KNUTC  -  THE NUTATION MODULE FLOW CONTROL FLAG. USED TO
!                            DETERMINE WHETHER OR NOT DPSI SHOULD BE ZEROED.
!
      Real*8 DJ2000, DAYSJ, CENJ
      Real*8 UT1f, F, T, ERA, GST2000, EE2000, XJD2, T2, dT2, GST,      &
     &       dGST, EECT2000,               EE2K, dEE2K, EECT2K,         &
     &       dEECT2K, pERA2K, dERA2K1, EQ_ORS, EO, dEO
      Real*8 ERA2Km1, ERA2Kp1, RS2Km1(3,3,3), RS2Kp1(3,3,3)
      Integer*4 I
!
      DATA  DJ2000 /  2451545.D0 /
!
!
! 1.2.6 SUBROUTINE INTERFACE -
!             CALLER SUBROUTINES: DRIVR
!             CALLED SUBROUTINES: DDROT, DROTT, ROTAT
!
! 1.2.7 CONSTANTS USED - CONVHS, DJ2000
!
! 1.2.7.1 CONSTANTS INITIALIZED IN THIS UTILITY ROUTINE -
!           2. DJ2000    -  THE JULIAN DATE OF THE EPOCH JANUARY 1.5, 2000.
!                           (DJ2000 = 2451545.D0 DAYS)
! 1.2.8 PROGRAM VARIABLES -
!
! 1.2.9 PROGRAMMER
!         770207  DALE MARKHAM
!         770718  PETER DENATALE
!         771128  BRUCE SCHUPLER
!         790201  BRUCE SCHUPLER
!         810804  CHOPO MA
!         870604  SAVITA GOEL
!         890726  Jim Ryan:          Documentation simplified.
!         930901  Norbert Zacharias: Equation of equinoxes GAST update
!        2002.09  Jim Ryan  Integer*4 conversion.
!        2003-2004 D.Gordon Updated for IERS Conventions (2003).
!        Oct.2012 D.Gordon  New code for GMST2K.
!        Sept2013 D.Gordon  New code for GAST2K
!
!  DIRNL Program Structure
!
!   Compute the Earth rotation angle, THETA, for use in the new IERS2000
!   tranformations
       DAYSJ = XJD  -  DJ2000
       UT1f = UT1/86400.D0
       T = UT1f + DAYSJ
       F = DMOD(UT1f,1.D0) + DMOD (XJD,1.D0)
       ERA   =  TWOPI * ( F + 0.7790572732640D0                         &
     &          + 0.00273781191135448D0 * T )
       ERA2K = DMOD (ERA,TWOPI)
       IF (ERA2K .lt. 0.D0) ERA2K = ERA2K + TWOPI
       DERA2K = TWOPI*(DUT1AT + 0.00273781191135448D0*DUTCAT)/86400.D0
!
!  Debug
!     Write(6,340) ERA2K, DERA2K
!
!   Construct the Earth rotation angle matrix and its first two CT
!     time derivatives.
!   Construct the Earth rotation matrix.
      CALL ROTAT ( -ERA2K, int2(3), RS2K(1,1,1))
!   Construct the first CT time derivative of the diurnal spin matrix
      CALL DROTT ( -ERA2K, -DERA2K, int2(3), RS2K(1,1,2))
!   Construct the second CT time derivative of the diurnal spin matrix.
      CALL DDROT ( -ERA2K, DERA2K**2, int2(3), RS2K(1,1,3))
!
!   Compute the partials of ERA2K and DERA2K w.r.t. UT1
       pERA2K = TWOPI * 1.00273781191135448D0/86400.D0
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!   New code for near-field time derivatives:
!    Compute rotation matrices for -1 and +1 second from epoch
!      DAYSJ = XJD  -  DJ2000
!
       UT1f = (UT1-1.D0)/86400.D0
       T = UT1f + DAYSJ
       F = DMOD(UT1f,1.D0) + DMOD (XJD,1.D0)
       ERA = TWOPI * ( F + 0.7790572732640D0                         &
     &     + 0.00273781191135448D0 * T )
       ERA2Km1 = DMOD (ERA,TWOPI)
       IF (ERA2Km1 .lt. 0.D0) ERA2Km1 = ERA2Km1 + TWOPI
      CALL ROTAT ( -ERA2Km1, int2(3), RS2Km1(1,1,1))
      CALL DROTT ( -ERA2Km1, -DERA2K, int2(3), RS2Km1(1,1,2))
      CALL DDROT ( -ERA2Km1, DERA2K**2, int2(3), RS2Km1(1,1,3))
!
       UT1f = (UT1+1.D0)/86400.D0
       T = UT1f + DAYSJ
       F = DMOD(UT1f,1.D0) + DMOD (XJD,1.D0)
       ERA = TWOPI * ( F + 0.7790572732640D0                         &
     &     + 0.00273781191135448D0 * T )
       ERA2Kp1 = DMOD (ERA,TWOPI)
       IF (ERA2Kp1 .lt. 0.D0) ERA2Kp1 = ERA2Kp1 + TWOPI
      CALL ROTAT ( -ERA2Kp1, int2(3), RS2Kp1(1,1,1))
      CALL DROTT ( -ERA2Kp1, -DERA2K, int2(3), RS2Kp1(1,1,2))
      CALL DDROT ( -ERA2Kp1, DERA2K**2, int2(3), RS2Kp1(1,1,3))
!************************************************************************
!
!   Compute the Greenwich Apparent Siderial Time consistent with the
!   IERS 2003 classical transformations.
        T2 = CENT
        dT2 = 1.D0/(36525.D0*86400.D0)
!
!  Greenwich mean siderial time: New code, October 2012.
       GMST2K(1) = ERA2K + ( 0.014506D0 + 4612.15653400D0*T2 +          &
     &        1.39158170D0*T2**2 - 0.00000044D0*T2**3 -                 &
     &        0.000029956D0*T2**4 - .0000000368D0*T2**5 ) * CONVDS 
       GMST2K(2) = dERA2K + ( 4612.15653400D0 +                         &
     &        2.D0*1.39158170D0*T2 - 3.D0*0.00000044D0*T2**2 -          &
     &        4.D0*0.000029956D0*T2**3 - 5.D0*.0000000368D0*T2**4 ) *   &
     &         CONVDS*dT2 
!      WRITE (6,*) ' DIRNL/new GMST2K:  ', GMST2K
!
!  Greenwich apparent siderial time: New code, Sept. 2013.
!    Equation of the origins, from modified SOFA function.
        EO = EQ_ORS( RPN2K6, S06 )
        GAST2K(1) = ERA2K - EO
         dEO = 0.D0  ! need to add this
        GAST2K(2) = dERA2K - dEO
!
!   Construct the IERS2000 classical diurnal spin matrix and its first
!    two CT time derivatives.
!   Construct the diurnal spin matrix.
!!      CALL ROTAT ( -GAST2K(1), int2(3), RSC2K(1,1,1))
!   Construct the first CT time derivative of the diurnal spin matrix
!!      CALL DROTT ( -GAST2K(1), -GAST2K(2), int2(3), RSC2K(1,1,2))
!   Construct the second CT time derivative of the diurnal spin matrix.
!!      CALL DDROT ( -GAST2K(1), GAST2K(2)**2, int2(3), RSC2K(1,1,3))
!
!************************************************************************
!   Check KDIUD for debug output.
      IF ( KDIUD .NE. 0 )  THEN
        WRITE ( 6, 9)
    9   FORMAT (1X, "Debug output for utillity DIRNL." )
    8   FORMAT(A,4D25.16/(7X,5D25.16))
        WRITE(6,8)' DJ2000  ',DJ2000
        WRITE(6,8)' CONVHS  ',CONVHS
       write(6,233)  UT1f,F,T
 233   format (' DIURNL/UT1f,F,T: ', 3E30.20)
       write(6,340)  ERA2K,DERA2K
 340   format(' DIRNL/ERA2K,DERA2K: ',F22.18,E30.20)
       WRITE ( 6, * ) 'DIURNL/EE_PRC: ', GAST2K(1) - ERA2K - EE2K
       Write(6,1024) RS2K
 1024  Format(1x,'DIRNL/RS2K  ',(9(/,3E25.15)))
       write(6,341)  EE2K, dEE2K
 341   format(' DIRNL/EE2K,dEE2K: ',E30.20)
       write(6,342)  GAST2K
 342   format(' DIRNL/GAST2K: ',F22.18,E30.20)
       WRITE ( 6, * ) ' DIRNL/GMST2K:  ', GMST2K
       Write(6,1026) RSC2K
 1026  Format(1x,'DIRNL/RSC2K: ',(9(/,3E25.15)))
       WRITE ( 6, * ) 'DIURNL/pERA2K: ', pERA2K
       WRITE ( 6, * ) 'DIURNL/T2: ', T2
       WRITE ( 6, * ) 'DIURNL/DAYSJ: ', DAYSJ
!
        WRITE ( 6, 9200 )  DATDCT,         DUT1AT,       UT1, XJD,      &
     &                     GAST2K, GMST2K, RS2K
 9200   FORMAT (1X, "DATDCT = ", D30.16, /, 1X,                         &
     &            "DUT1AT = ", D30.16, /, 1X,                           &
     &            "UT1    = ", D30.16, /, 1X,                           &
     &            "XJD    = ", D30.16, /, 1X,                           &
     &            "GAST2K = ", 2 ( D30.16, 10X ), /, 1X,                &
     &            "GMST2K = ", D30.16, /, 1X,                           &
     &            "RS2K   = ", 9 ( 3 ( D30.16, 10X ), /, 1X ) )
!
      ENDIF   ! debug output flag
!
      Return
      END
!*************************************************************************
      SUBROUTINE EECT (T, FA2K, FAD2K, EECT2K, dEECT2K)
      IMPLICIT NONE
!
!  Equation of the equinoxes complementary terms, consistent with
!  IAU 2000 resolutions.
!  Modified form of SOFA subroutine EECT2000.
!
!  Given:
!     XJD, CT       d    TT date (JD = DATE1+DATE2)
!
!  Returned:
!     EECT2K        d    Complementary terms (radians)
!     dEECT2K       d    Time derivative of complementary terms
!                         (radians/sec)
!
!-----------------------------------------------------------------------
!
      REAL*8 EECT2K, dEECT2K
!  2Pi
      REAL*8           D2PI
      PARAMETER ( D2PI = 6.283185307179586476925287D0 )
!  Arcseconds to radians
      REAL*8           DAS2R
      PARAMETER ( DAS2R = 4.848136811095359935899141D-6 )
!  Reference epoch (J2000), JD
      REAL*8           DJ0
      PARAMETER ( DJ0 = 2451545D0 )
!  Days per Julian century
      REAL*8           DJC
      PARAMETER ( DJC = 36525D0 )
!  Time since J2000, in Julian centuries
      REAL*8           T
!  Miscellaneous
      INTEGER I, J
      REAL*8           A, S0, S1, dA, dS0, dS1
      REAL*8           ANMP
!
!  Fundamental arguments
!     DOUBLE PRECISION FA(14)
      REAL*8 FA2K(14), FAD2K(14)
!     COMMON / NFA2K / FA2K, FAD2K
!
!  -----------------------------------------
!  The series for the EE complementary terms
!  -----------------------------------------
!
!  Number of terms in the series
      INTEGER NE0, NE1
      PARAMETER ( NE0=  33, NE1=  1 )
!
!  Coefficients of l,l',F,D,Om,LMe,LVe,LE,LMa,LJu,LSa,LU,LN,pA
      INTEGER KE0 ( 14, NE0 ),                                          &
     &        KE1 ( 14, NE1 )
!
!  Sine and cosine coefficients
      REAL*8           SE0 ( 2, NE0 ),                                  &
     &                 SE1 ( 2, NE1 )
!
!  Argument coefficients for t^0
      DATA ( ( KE0(I,J), I=1,14), J =    1,   10 ) /                    &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KE0(I,J), I=1,14), J =   11,   20 ) / &
     &  1,  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1,  2, -2,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1,  2, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  4, -4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  1, -1,  1,  0, -8, 12,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  2,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0,  2,  0,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0,  2,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KE0(I,J), I=1,14), J =   21,   30 ) / &
     &  0,  0,  2, -2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1, -2,  2, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1, -2,  2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  0,  0,  0,  0,  8,-13,  0,  0,  0,  0,  0, -1,          &
     &  0,  0,  0,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  2,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0,  0, -2,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  1,  2, -2,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0,  0, -2, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  0,  0,  4, -2,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
      DATA ( ( KE0(I,J), I=1,14), J =   31,  NE0 ) / &
     &  0,  0,  2, -2,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0, -2,  0, -3,  0,  0,  0,  0,  0,  0,  0,  0,  0,          &
     &  1,  0, -2,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Argument coefficients for t^1
      DATA ( ( KE1(I,J), I=1,14), J =    1,  NE1 ) /                    &
     &  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0 /
!
!  Sine and cosine coefficients for t^0
      DATA ( ( SE0(I,J), I=1,2), J =    1,   10 ) /                     &
     &            +2640.96D-6,          -0.39D-6,                       &
     &              +63.52D-6,          -0.02D-6,                       &
     &              +11.75D-6,          +0.01D-6,                       &
     &              +11.21D-6,          +0.01D-6,                       &
     &               -4.55D-6,          +0.00D-6,                       &
     &               +2.02D-6,          +0.00D-6,                       &
     &               +1.98D-6,          +0.00D-6,                       &
     &               -1.72D-6,          +0.00D-6,                       &
     &               -1.41D-6,          -0.01D-6,                       &
     &               -1.26D-6,          -0.01D-6 /
      DATA ( ( SE0(I,J), I=1,2), J =   11,   20 ) /                     &
     &               -0.63D-6,          +0.00D-6,                       &
     &               -0.63D-6,          +0.00D-6,                       &
     &               +0.46D-6,          +0.00D-6,                       &
     &               +0.45D-6,          +0.00D-6,                       &
     &               +0.36D-6,          +0.00D-6,                       &
     &               -0.24D-6,          -0.12D-6,                       &
     &               +0.32D-6,          +0.00D-6,                       &
     &               +0.28D-6,          +0.00D-6,                       &
     &               +0.27D-6,          +0.00D-6,                       &
     &               +0.26D-6,          +0.00D-6 /
      DATA ( ( SE0(I,J), I=1,2), J =   21,   30 ) /                     &
     &               -0.21D-6,          +0.00D-6,                       &
     &               +0.19D-6,          +0.00D-6,                       &
     &               +0.18D-6,          +0.00D-6,                       &
     &               -0.10D-6,          +0.05D-6,                       &
     &               +0.15D-6,          +0.00D-6,                       &
     &               -0.14D-6,          +0.00D-6,                       &
     &               +0.14D-6,          +0.00D-6,                       &
     &               -0.14D-6,          +0.00D-6,                       &
     &               +0.14D-6,          +0.00D-6,                       &
     &               +0.13D-6,          +0.00D-6 /
      DATA ( ( SE0(I,J), I=1,2), J =   31,  NE0 ) /                     &
     &               -0.11D-6,          +0.00D-6,                       &
     &               +0.11D-6,          +0.00D-6,                       &
     &               +0.11D-6,          +0.00D-6 /
!
!  Sine and cosine coefficients for t^1
      DATA ( ( SE1(I,J), I=1,2), J =    1,  NE1 ) /                     &
     &               -0.87D-6,          +0.00D-6 /
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!  Interval between fundamental epoch J2000.0 and current date (JC).
!     T = ( ( DATE1-DJ0 ) + DATE2 ) / DJC
!         print *,' EECT2K/T= ', T
!
!
!  Evaluate the EE complementary terms.
      S0 = 0D0
      S1 = 0D0
      dS0 = 0D0
      dS1 = 0D0
!
      DO I = NE0,1,-1
        A = 0.D0
        dA = 0.D0
         DO J=1,14
            A = A + DBLE(KE0(J,I))*FA2K(J)
            dA = dA + DBLE(KE0(J,I))*FAD2K(J)
         END DO
        S0 = S0 + ( SE0(1,I)*SIN(A) + SE0(2,I)*COS(A) )
        dS0 = dS0 + ( SE0(1,I)*COS(A)*dA - SE0(2,I)*SIN(A)*dA )
      END DO
!      print *,' EECT/S0,dS0 ', S0,dS0
!
      DO I = NE1,1,-1
         A = 0.D0
         dA = 0.D0
         DO J=1,14
            A = A + DBLE(KE1(J,I))*FA2K(J)
            dA = dA + DBLE(KE1(J,I))*FAD2K(J)
         END DO
         S1 = S1 + ( SE1(1,I)*SIN(A) + SE1(2,I)*COS(A) )
         dS1 = dS1 + ( SE1(1,I)*COS(A)*dA - SE1(2,I)*SIN(A)*dA )
      END DO
!      print *,' EECT/S1,dS1 ', S1,dS1
!
      EECT2K = ( S0 + S1 * T ) * DAS2R
      dEECT2K = ( dS0 + dS1*T/(36525.D0*86400D0) ) * DAS2R
!      print *,' EECT/EECT2K,dEECT2K ', EECT2K,dEECT2K
!
      RETURN
      END
!**********************************************************************
      DOUBLE PRECISION FUNCTION EQ_ORS ( RNPB, S )
!+
!  - - - - - - - - -
!   Modified version of 'iau_EORS' from SOFA library:
!       -Converted to Fortran 90.
!       -Modifed for Calc 11 inputs.
!       -Renamed Function EQ_ORS.
!  - - - - - - - - -
!
!  Equation of the origins, given the classical NPB matrix and the
!  quantity s.
!
!  This routine is part of the International Astronomical Union's
!  SOFA (Standards of Fundamental Astronomy) software collection.
!
!  Status:  support routine.
!
!  Given:
!     RNPB    d(3,3,2)   classical nutation x precession x bias matrix
!     S       d(2)       the quantity s (the CIO locator)
!
!  Returned:
!     EQ_ORS  d          the equation of the origins in radians.
!
!  Notes:
!
!  1)  The equation of the origins is the distance between the true
!      equinox and the celestial intermediate origin and, equivalently,
!      the difference between Earth rotation angle and Greenwich
!      apparent sidereal time (ERA-GST).  It comprises the precession
!      (since J2000.0) in right ascension plus the equation of the
!      equinoxes (including the small correction terms).
!
!  2)  The algorithm is from Wallace & Capitaine (2006).
!
!  References:
!
!     Capitaine, N. & Wallace, P.T., 2006, Astron.Astrophys. 450, 855
!
!     Wallace, P. & Capitaine, N., 2006, Astron.Astrophys. 459, 981
!
!  This revision:  2008 February 24
!
!  SOFA release 2012-03-01
!
!  Copyright (C) 2012 IAU SOFA Board.  See notes at end.
!
!-----------------------------------------------------------------------
!
      IMPLICIT NONE
!
      DOUBLE PRECISION RNPB(3,3,2), S(2)
!
      DOUBLE PRECISION X, AX, XS, YS, ZS, P, Q
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
!  Evaluate Wallace & Capitaine (2006) expression (16).
      X = RNPB(3,1,1)
      AX = X / ( 1D0 + RNPB(3,3,1) )
      XS = 1D0 - AX*X
      YS = -AX*RNPB(3,2,1)
      ZS = -X
      P = RNPB(1,1,1)*XS + RNPB(1,2,1)*YS + RNPB(1,3,1)*ZS
      Q = RNPB(2,1,1)*XS + RNPB(2,2,1)*YS + RNPB(2,3,1)*ZS
      IF ( P.NE.0D0 .OR. Q.NE.0D0 ) THEN
         EQ_ORS = S(1) - ATAN2 ( Q, P )
      ELSE
         EQ_ORS = S(1)
      END IF
!
!  Finished.
!
!+----------------------------------------------------------------------
!
!  Copyright (C) 2012
!  Standards Of Fundamental Astronomy Board
!  of the International Astronomical Union.
!
!  =====================
!  SOFA Software License
!  =====================
!
!  NOTICE TO USER:
!
!  BY USING THIS SOFTWARE YOU ACCEPT THE FOLLOWING SIX TERMS AND
!  CONDITIONS WHICH APPLY TO ITS USE.
!
!  1. The Software is owned by the IAU SOFA Board ("SOFA").
!
!  2. Permission is granted to anyone to use the SOFA software for any
!     purpose, including commercial applications, free of charge and
!     without payment of royalties, subject to the conditions and
!     restrictions listed below.
!
!  3. You (the user) may copy and distribute SOFA source code to others,
!     and use and adapt its code and algorithms in your own software,
!     on a world-wide, royalty-free basis.  That portion of your
!     distribution that does not consist of intact and unchanged copies
!     of SOFA source code files is a "derived work" that must comply
!     with the following requirements:
!
!     a) Your work shall be marked or carry a statement that it
!        (i) uses routines and computations derived by you from
!        software provided by SOFA under license to you; and
!        (ii) does not itself constitute software provided by and/or
!        endorsed by SOFA.
!
!     b) The source code of your derived work must contain descriptions
!        of how the derived work is based upon, contains and/or differs
!        from the original SOFA software.
!
!     c) The names of all routines in your derived work shall not
!        include the prefix "iau" or "sofa" or trivial modifications
!        thereof such as changes of case.
!
!     d) The origin of the SOFA components of your derived work must
!        not be misrepresented;  you must not claim that you wrote the
!        original software, nor file a patent application for SOFA
!        software or algorithms embedded in the SOFA software.
!
!     e) These requirements must be reproduced intact in any source
!        distribution and shall apply to anyone to whom you have
!        granted a further right to modify the source code of your
!        derived work.
!
!     Note that, as originally distributed, the SOFA software is
!     intended to be a definitive implementation of the IAU standards,
!     and consequently third-party modifications are discouraged.  All
!     variations, no matter how minor, must be explicitly marked as
!     such, as explained above.
!
!  4. You shall not cause the SOFA software to be brought into
!     disrepute, either by misuse, or use for inappropriate tasks, or
!     by inappropriate modification.
!
!  5. The SOFA software is provided "as is" and SOFA makes no warranty
!     as to its use or performance.   SOFA does not and cannot warrant
!     the performance or results which the user may obtain by using the
!     SOFA software.  SOFA makes no warranties, express or implied, as
!     to non-infringement of third party rights, merchantability, or
!     fitness for any particular purpose.  In no event will SOFA be
!     liable to the user for any consequential, incidental, or special
!     damages, including any lost profits or lost savings, even if a
!     SOFA representative has been advised of such damages, or for any
!     claim by any third party.
!
!  6. The provision of any version of the SOFA software under the terms
!     and conditions specified herein does not imply that future
!     versions will also be made available under the same terms and
!     conditions.
!
!  In any published work or commercial product which uses the SOFA
!  software directly, acknowledgement (see www.iausofa.org) is
!  appreciated.
!
!  Correspondence concerning SOFA software should be addressed as
!  follows:
!
!      By email:  sofa@ukho.gov.uk
!      By post:   IAU SOFA Center
!                 HM Nautical Almanac Office
!                 UK Hydrographic Office
!                 Admiralty Way, Taunton
!                 Somerset, TA1 2DN
!                 United Kingdom
!
!-----------------------------------------------------------------------
!
      END
